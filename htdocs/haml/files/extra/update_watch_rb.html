  <div id="fileHeader">
    <h1>update_watch.rb</h1>
    <table class="header-table">
    <tr class="top-aligned-row">
      <td><strong>Path:</strong></td>
      <td>extra/update_watch.rb</td>
    </tr>
    <tr class="top-aligned-row">
      <td><strong>Last Update:</strong></td>
      <td>Mon Oct 12 14:57:00 +0200 2009</td>
    </tr>
    </table>
  </div>
 <!-- banner header -->

  <div id="bodyContent" >
    <h2>Source Code</h2>
    <pre>require 'rubygems'
require 'sinatra'
require 'json'
set :port, 3123
set :environment, :production
enable :lock
Dir.chdir(File.dirname(__FILE__) + &quot;/..&quot;)

post &quot;/&quot; do
  puts &quot;Recieved payload!&quot;
  puts &quot;Rev: #{`git name-rev HEAD`.strip}&quot;
  system %{rake handle_update --trace REF=#{JSON.parse(params[&quot;payload&quot;])[&quot;ref&quot;].inspect}}
end
</pre>
    </div>