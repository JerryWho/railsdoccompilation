  <div id="C00000021">
<div class='banner'>
  <span class="file-title-prefix">Class</span><br />TemplateTest<br/>
  In:
<a href="#" onclick="jsHref('files/test/haml/template_test_rb.html');">test/haml/template_test.rb</a>

Parent:&nbsp;
Test::Unit::TestCase
</div>
 <!-- banner header -->

  <div id="bodyContent" >
      <div id="content">




  <div class="sectiontitle">Methods</div>
  <ul>
  <li><a href="index.html?a=M000804&name=assert_renders_correctly" >assert_renders_correctly</a></li>
  <li><a href="index.html?a=M000801&name=create_base" >create_base</a></li>
  <li><a href="index.html?a=M000803&name=load_result" >load_result</a></li>
  <li><a href="index.html?a=M000802&name=render" >render</a></li>
  <li><a href="index.html?a=M000800&name=setup" >setup</a></li>
  <li><a href="index.html?a=M000808&name=test_action_view_templates_render_correctly" >test_action_view_templates_render_correctly</a></li>
  <li><a href="index.html?a=M000817&name=test_av_block_deprecation_warning" >test_av_block_deprecation_warning</a></li>
  <li><a href="index.html?a=M000835&name=test_cache" >test_cache</a></li>
  <li><a href="index.html?a=M000805&name=test_empty_render_should_remain_empty" >test_empty_render_should_remain_empty</a></li>
  <li><a href="index.html?a=M000818&name=test_escape_html_option_set" >test_escape_html_option_set</a></li>
  <li><a href="index.html?a=M000816&name=test_exceptions_should_work_correctly" >test_exceptions_should_work_correctly</a></li>
  <li><a href="index.html?a=M000812&name=test_form_for_error_return" >test_form_for_error_return</a></li>
  <li><a href="index.html?a=M000813&name=test_form_tag_error_return" >test_form_tag_error_return</a></li>
  <li><a href="index.html?a=M000814&name=test_haml_options" >test_haml_options</a></li>
  <li><a href="index.html?a=M000810&name=test_instance_variables_should_work_inside_attributes" >test_instance_variables_should_work_inside_attributes</a></li>
  <li><a href="index.html?a=M000809&name=test_instance_variables_should_work_inside_templates" >test_instance_variables_should_work_inside_templates</a></li>
  <li><a href="index.html?a=M000826&name=test_rendered_string_is_html_safe" >test_rendered_string_is_html_safe</a></li>
  <li><a href="index.html?a=M000827&name=test_rendered_string_is_html_safe_with_action_view" >test_rendered_string_is_html_safe_with_action_view</a></li>
  <li><a href="index.html?a=M000834&name=test_rjs" >test_rjs</a></li>
  <li><a href="index.html?a=M000811&name=test_template_renders_should_eval" >test_template_renders_should_eval</a></li>
  <li><a href="index.html?a=M000807&name=test_templates_should_render_correctly_with_def_method" >test_templates_should_render_correctly_with_def_method</a></li>
  <li><a href="index.html?a=M000806&name=test_templates_should_render_correctly_with_render_proc" >test_templates_should_render_correctly_with_render_proc</a></li>
  <li><a href="index.html?a=M000815&name=test_with_output_buffer_with_ugly" >test_with_output_buffer_with_ugly</a></li>
  <li><a href="index.html?a=M000828&name=test_xss_html_escaping_with_non_strings" >test_xss_html_escaping_with_non_strings</a></li>
  <li><a href="index.html?a=M000819&name=test_xss_protection" >test_xss_protection</a></li>
  <li><a href="index.html?a=M000822&name=test_xss_protection_in_interpolation" >test_xss_protection_in_interpolation</a></li>
  <li><a href="index.html?a=M000821&name=test_xss_protection_with_bang" >test_xss_protection_with_bang</a></li>
  <li><a href="index.html?a=M000823&name=test_xss_protection_with_bang_in_interpolation" >test_xss_protection_with_bang_in_interpolation</a></li>
  <li><a href="index.html?a=M000829&name=test_xss_protection_with_concat" >test_xss_protection_with_concat</a></li>
  <li><a href="index.html?a=M000830&name=test_xss_protection_with_concat_with_safe_string" >test_xss_protection_with_concat_with_safe_string</a></li>
  <li><a href="index.html?a=M000833&name=test_xss_protection_with_form_for" >test_xss_protection_with_form_for</a></li>
  <li><a href="index.html?a=M000825&name=test_xss_protection_with_mixed_strings_in_interpolation" >test_xss_protection_with_mixed_strings_in_interpolation</a></li>
  <li><a href="index.html?a=M000832&name=test_xss_protection_with_nested_haml_tag" >test_xss_protection_with_nested_haml_tag</a></li>
  <li><a href="index.html?a=M000831&name=test_xss_protection_with_safe_concat" >test_xss_protection_with_safe_concat</a></li>
  <li><a href="index.html?a=M000820&name=test_xss_protection_with_safe_strings" >test_xss_protection_with_safe_strings</a></li>
  <li><a href="index.html?a=M000824&name=test_xss_protection_with_safe_strings_in_interpolation" >test_xss_protection_with_safe_strings_in_interpolation</a></li>
  </ul>




  <div class="sectiontitle">Constants</div>
  <table border='0' cellpadding='5'>
  <tr valign='top'>
    <td class="attr-name">TEMPLATE_PATH</td>
    <td>=</td>
    <td class="attr-value">File.join(File.dirname(__FILE__), &quot;templates&quot;)</td>
  </tr>
  <tr valign='top'>
    <td class="attr-name">TEMPLATES</td>
    <td>=</td>
    <td class="attr-value">%w{         very_basic        standard    helpers     whitespace_handling   original_engine   list        helpful     silent_script         tag_parsing       just_stuff  partials     filters               nuke_outer_whitespace         nuke_inner_whitespace     render_layout }</td>
  </tr>
  </table>


<div class="sectiontitle">Public Instance methods</div>
<div id="M000804" class="method">
  <div id="M000804_title" class="title">
    <b>assert_renders_correctly</b>(name, &amp;render_method)
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000804_source')" id="l_M000804_source">show source</a> ]</p>
  <div id="M000804_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 107</span>
107:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">assert_renders_correctly</span>(<span class="ruby-identifier">name</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">render_method</span>)
108:     <span class="ruby-identifier">old_options</span> = <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Template</span>.<span class="ruby-identifier">options</span>.<span class="ruby-identifier">dup</span>
109:     <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Template</span>.<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:escape_html</span>] = <span class="ruby-keyword kw">false</span>
110:     <span class="ruby-keyword kw">if</span> <span class="ruby-constant">ActionPack</span><span class="ruby-operator">::</span><span class="ruby-constant">VERSION</span><span class="ruby-operator">::</span><span class="ruby-constant">MAJOR</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">2</span> <span class="ruby-operator">||</span>
111:         (<span class="ruby-constant">ActionPack</span><span class="ruby-operator">::</span><span class="ruby-constant">VERSION</span><span class="ruby-operator">::</span><span class="ruby-constant">MAJOR</span> <span class="ruby-operator">==</span> <span class="ruby-value">2</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-constant">ActionPack</span><span class="ruby-operator">::</span><span class="ruby-constant">VERSION</span><span class="ruby-operator">::</span><span class="ruby-constant">MINOR</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">2</span>)
112:       <span class="ruby-identifier">render_method</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">proc</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">name</span><span class="ruby-operator">|</span> <span class="ruby-ivar">@base</span>.<span class="ruby-identifier">render</span>(<span class="ruby-identifier">name</span>) }
113:     <span class="ruby-keyword kw">else</span>
114:       <span class="ruby-identifier">render_method</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">proc</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">name</span><span class="ruby-operator">|</span> <span class="ruby-ivar">@base</span>.<span class="ruby-identifier">render</span>(<span class="ruby-identifier">:file</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">name</span>) }
115:     <span class="ruby-keyword kw">end</span>
116: 
117:     <span class="ruby-identifier">load_result</span>(<span class="ruby-identifier">name</span>).<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;\n&quot;</span>).<span class="ruby-identifier">zip</span>(<span class="ruby-identifier">render_method</span>[<span class="ruby-identifier">name</span>].<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;\n&quot;</span>)).<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">pair</span>, <span class="ruby-identifier">line</span><span class="ruby-operator">|</span>
118:       <span class="ruby-identifier">message</span> = <span class="ruby-node">&quot;template: #{name}\nline:     #{line}&quot;</span>
119:       <span class="ruby-identifier">assert_equal</span>(<span class="ruby-identifier">pair</span>.<span class="ruby-identifier">first</span>, <span class="ruby-identifier">pair</span>.<span class="ruby-identifier">last</span>, <span class="ruby-identifier">message</span>)
120:     <span class="ruby-keyword kw">end</span>
121:   <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Util</span>.<span class="ruby-identifier">av_template_class</span>(<span class="ruby-identifier">:Error</span>) =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
122:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">message</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/Can't run [\w:]+ filter; required (one of|file) ((?:'\w+'(?: or )?)+)(, but none were found| not found)/</span>
123:       <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;\nCouldn't require #{$2}; skipping a test.&quot;</span>
124:     <span class="ruby-keyword kw">else</span>
125:       <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span>
126:     <span class="ruby-keyword kw">end</span>
127:   <span class="ruby-keyword kw">ensure</span>
128:     <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Template</span>.<span class="ruby-identifier">options</span> = <span class="ruby-identifier">old_options</span>
129:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000801" class="method">
  <div id="M000801_title" class="title">
    <b>create_base</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000801_source')" id="l_M000801_source">show source</a> ]</p>
  <div id="M000801_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 60</span>
60:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">create_base</span>
61:     <span class="ruby-identifier">vars</span> = { <span class="ruby-value str">'article'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Article</span>.<span class="ruby-identifier">new</span>, <span class="ruby-value str">'foo'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'value one'</span> }
62:     
63:     <span class="ruby-keyword kw">unless</span> <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Util</span>.<span class="ruby-identifier">has?</span>(<span class="ruby-identifier">:instance_method</span>, <span class="ruby-constant">ActionView</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>, <span class="ruby-identifier">:finder</span>)
64:       <span class="ruby-identifier">base</span> = <span class="ruby-constant">ActionView</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">TEMPLATE_PATH</span>, <span class="ruby-identifier">vars</span>)
65:     <span class="ruby-keyword kw">else</span>
66:       <span class="ruby-comment cmt"># Rails 2.1.0</span>
67:       <span class="ruby-identifier">base</span> = <span class="ruby-constant">ActionView</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">new</span>([], <span class="ruby-identifier">vars</span>)
68:       <span class="ruby-identifier">base</span>.<span class="ruby-identifier">finder</span>.<span class="ruby-identifier">append_view_path</span>(<span class="ruby-constant">TEMPLATE_PATH</span>)
69:     <span class="ruby-keyword kw">end</span>
70:     
71:     <span class="ruby-keyword kw">if</span> <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Util</span>.<span class="ruby-identifier">has?</span>(<span class="ruby-identifier">:private_method</span>, <span class="ruby-identifier">base</span>, <span class="ruby-identifier">:evaluate_assigns</span>)
72:       <span class="ruby-comment cmt"># Rails &lt; 3.0</span>
73:       <span class="ruby-identifier">base</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:evaluate_assigns</span>)
74:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Util</span>.<span class="ruby-identifier">has?</span>(<span class="ruby-identifier">:private_method</span>, <span class="ruby-identifier">base</span>, <span class="ruby-identifier">:_evaluate_assigns_and_ivars</span>)
75:       <span class="ruby-comment cmt"># Rails 2.2</span>
76:       <span class="ruby-identifier">base</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:_evaluate_assigns_and_ivars</span>)
77:     <span class="ruby-keyword kw">end</span>
78: 
79:     <span class="ruby-comment cmt"># This is needed by RJS in (at least) Rails 3</span>
80:     <span class="ruby-identifier">base</span>.<span class="ruby-identifier">instance_variable_set</span>(<span class="ruby-value str">'@template'</span>, <span class="ruby-identifier">base</span>)
81: 
82:     <span class="ruby-comment cmt"># This is used by form_for.</span>
83:     <span class="ruby-comment cmt"># It's usually provided by ActionController::Base.</span>
84:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">base</span>.<span class="ruby-identifier">protect_against_forgery?</span>; <span class="ruby-keyword kw">false</span>; <span class="ruby-keyword kw">end</span>
85: 
86:     <span class="ruby-comment cmt"># In Rails &lt;= 2.1, a fake controller object was needed</span>
87:     <span class="ruby-comment cmt"># to provide the controller path.</span>
88:     <span class="ruby-keyword kw">if</span> <span class="ruby-constant">ActionPack</span><span class="ruby-operator">::</span><span class="ruby-constant">VERSION</span><span class="ruby-operator">::</span><span class="ruby-constant">MAJOR</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">2</span> <span class="ruby-operator">||</span>
89:         (<span class="ruby-constant">ActionPack</span><span class="ruby-operator">::</span><span class="ruby-constant">VERSION</span><span class="ruby-operator">::</span><span class="ruby-constant">MAJOR</span> <span class="ruby-operator">==</span> <span class="ruby-value">2</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-constant">ActionPack</span><span class="ruby-operator">::</span><span class="ruby-constant">VERSION</span><span class="ruby-operator">::</span><span class="ruby-constant">MINOR</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">2</span>)
90:       <span class="ruby-identifier">base</span>.<span class="ruby-identifier">controller</span> = <span class="ruby-constant">DummyController</span>.<span class="ruby-identifier">new</span>
91:     <span class="ruby-keyword kw">end</span>
92: 
93:     <span class="ruby-identifier">base</span>
94:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000803" class="method">
  <div id="M000803_title" class="title">
    <b>load_result</b>(name)
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000803_source')" id="l_M000803_source">show source</a> ]</p>
  <div id="M000803_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 101</span>
101:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">load_result</span>(<span class="ruby-identifier">name</span>)
102:     <span class="ruby-ivar">@result</span> = <span class="ruby-value str">''</span>
103:     <span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>(<span class="ruby-keyword kw">__FILE__</span>) <span class="ruby-operator">+</span> <span class="ruby-node">&quot;/results/#{name}.xhtml&quot;</span>).<span class="ruby-identifier">each_line</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">l</span><span class="ruby-operator">|</span> <span class="ruby-ivar">@result</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">l</span> }
104:     <span class="ruby-ivar">@result</span>
105:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000802" class="method">
  <div id="M000802_title" class="title">
    <b>render</b>(text, opts = {})
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000802_source')" id="l_M000802_source">show source</a> ]</p>
  <div id="M000802_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 96</span>
96:   <span class="ruby-keyword kw">def</span>  <span class="ruby-identifier">render</span><span class="ruby-identifier">render</span>(<span class="ruby-identifier">text</span>, <span class="ruby-identifier">opts</span> = {})
97:     <span class="ruby-keyword kw">return</span> <span class="ruby-ivar">@base</span>.<span class="ruby-identifier">render</span>(<span class="ruby-identifier">:inline</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">text</span>, <span class="ruby-identifier">:type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:haml</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">opts</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">:action_view</span>
98:     <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Engine</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">text</span>, <span class="ruby-identifier">opts</span>).<span class="ruby-identifier">to_html</span>(<span class="ruby-ivar">@base</span>)
99:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000800" class="method">
  <div id="M000800_title" class="title">
    <b>setup</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000800_source')" id="l_M000800_source">show source</a> ]</p>
  <div id="M000800_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 53</span>
53:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">setup</span>
54:     <span class="ruby-ivar">@base</span> = <span class="ruby-identifier">create_base</span>
55: 
56:     <span class="ruby-comment cmt"># filters template uses :sass</span>
57:     <span class="ruby-constant">Sass</span><span class="ruby-operator">::</span><span class="ruby-constant">Plugin</span>.<span class="ruby-identifier">options</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">:line_comments</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>, <span class="ruby-identifier">:style</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:compact</span>)
58:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000808" class="method">
  <div id="M000808_title" class="title">
    <b>test_action_view_templates_render_correctly</b>()
  </div>
  <div class="description">
  <p>
Rails 3.0.0 deprecates the use of yield with a layout for calls to render
:file
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000808_source')" id="l_M000808_source">show source</a> ]</p>
  <div id="M000808_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 159</span>
159:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_action_view_templates_render_correctly</span>
160:       <span class="ruby-identifier">proc</span> = <span class="ruby-identifier">lambda</span> <span class="ruby-keyword kw">do</span>
161:         <span class="ruby-ivar">@base</span>.<span class="ruby-identifier">content_for</span>(<span class="ruby-identifier">:layout</span>) {<span class="ruby-value str">'Lorem ipsum dolor sit amet'</span>}
162:         <span class="ruby-identifier">assert_renders_correctly</span> <span class="ruby-value str">'content_for_layout'</span>
163:       <span class="ruby-keyword kw">end</span>
164: 
165:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@base</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:with_output_buffer</span>)
166:         <span class="ruby-ivar">@base</span>.<span class="ruby-identifier">with_output_buffer</span>(<span class="ruby-value str">&quot;&quot;</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">proc</span>)
167:       <span class="ruby-keyword kw">else</span>
168:         <span class="ruby-identifier">proc</span>.<span class="ruby-identifier">call</span>
169:       <span class="ruby-keyword kw">end</span>
170:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000817" class="method">
  <div id="M000817_title" class="title">
    <b>test_av_block_deprecation_warning</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000817_source')" id="l_M000817_source">show source</a> ]</p>
  <div id="M000817_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 285</span>
285:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_av_block_deprecation_warning</span>
286:       <span class="ruby-identifier">assert_warning</span>(<span class="ruby-regexp re">/^DEPRECATION WARNING: - style block helpers are deprecated\. Please use =\./</span>) <span class="ruby-keyword kw">do</span>
287:         <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;&lt;form action=\&quot;\&quot; method=\&quot;post\&quot;&gt;\n  Title:\n  &lt;input id=\&quot;article_title\&quot; name=\&quot;article[title]\&quot; size=\&quot;30\&quot; type=\&quot;text\&quot; value=\&quot;Hello\&quot; /&gt;\n  Body:\n  &lt;input id=\&quot;article_body\&quot; name=\&quot;article[body]\&quot; size=\&quot;30\&quot; type=\&quot;text\&quot; value=\&quot;World\&quot; /&gt;\n&lt;/form&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;- form_for \#{form_for_calling_convention(:article)}, :url =&gt; '' do |f|\n  Title:\n  = f.text_field :title\n  Body:\n  = f.text_field :body\n&quot;</span>, <span class="ruby-identifier">:action_view</span>)
288:       <span class="ruby-keyword kw">end</span>
289:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000835" class="method">
  <div id="M000835_title" class="title">
    <b>test_cache</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000835_source')" id="l_M000835_source">show source</a> ]</p>
  <div id="M000835_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 419</span>
419:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_cache</span>
420:       <span class="ruby-ivar">@base</span>.<span class="ruby-identifier">controller</span> = <span class="ruby-constant">ActionController</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">new</span>
421:       <span class="ruby-ivar">@base</span>.<span class="ruby-identifier">controller</span>.<span class="ruby-identifier">perform_caching</span> = <span class="ruby-keyword kw">false</span>
422:       <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;Test\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;- cache do\n  Test\n&quot;</span>, <span class="ruby-identifier">:action_view</span>))
423:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000805" class="method">
  <div id="M000805_title" class="title">
    <b>test_empty_render_should_remain_empty</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000805_source')" id="l_M000805_source">show source</a> ]</p>
  <div id="M000805_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 131</span>
131:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_empty_render_should_remain_empty</span>
132:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">''</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">''</span>))
133:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000818" class="method">
  <div id="M000818_title" class="title">
    <b>test_escape_html_option_set</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000818_source')" id="l_M000818_source">show source</a> ]</p>
  <div id="M000818_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 313</span>
313:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_escape_html_option_set</span>
314:       <span class="ruby-identifier">assert</span> <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Template</span>.<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:escape_html</span>]
315:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000816" class="method">
  <div id="M000816_title" class="title">
    <b>test_exceptions_should_work_correctly</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000816_source')" id="l_M000816_source">show source</a> ]</p>
  <div id="M000816_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 251</span>
251:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_exceptions_should_work_correctly</span>
252:     <span class="ruby-keyword kw">begin</span>
253:       <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;- raise 'oops!'&quot;</span>)
254:     <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">Exception</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
255:       <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;oops!&quot;</span>, <span class="ruby-identifier">e</span>.<span class="ruby-identifier">message</span>)
256:       <span class="ruby-identifier">assert_match</span>(<span class="ruby-regexp re">/^\(haml\):1/</span>, <span class="ruby-identifier">e</span>.<span class="ruby-identifier">backtrace</span>[<span class="ruby-value">0</span>])
257:     <span class="ruby-keyword kw">else</span>
258:       <span class="ruby-identifier">assert</span> <span class="ruby-keyword kw">false</span>
259:     <span class="ruby-keyword kw">end</span>
260: 
261:     <span class="ruby-identifier">template</span> = <span class="ruby-value str">&quot;%p\n  %h1 Hello!\n  = \&quot;lots of lines\&quot;\n  = \&quot;even more!\&quot;\n  - raise 'oh no!'\n  %p\n    this is after the exception\n    %strong yes it is!\nho ho ho.\n&quot;</span>
262: 
263:     <span class="ruby-keyword kw">begin</span>
264:       <span class="ruby-identifier">render</span>(<span class="ruby-identifier">template</span>.<span class="ruby-identifier">chomp</span>)
265:     <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">Exception</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
266:       <span class="ruby-identifier">assert_match</span>(<span class="ruby-regexp re">/^\(haml\):5/</span>, <span class="ruby-identifier">e</span>.<span class="ruby-identifier">backtrace</span>[<span class="ruby-value">0</span>])
267:     <span class="ruby-keyword kw">else</span>
268:       <span class="ruby-identifier">assert</span> <span class="ruby-keyword kw">false</span>
269:     <span class="ruby-keyword kw">end</span>
270:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000812" class="method">
  <div id="M000812_title" class="title">
    <b>test_form_for_error_return</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000812_source')" id="l_M000812_source">show source</a> ]</p>
  <div id="M000812_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 197</span>
197:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_form_for_error_return</span>
198:       <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Error</span>) { <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;= form_for :article, @article, :url =&gt; '' do |f|\n  Title:\n  = f.text_field :title\n  Body:\n  = f.text_field :body\n&quot;</span>) }
199:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000813" class="method">
  <div id="M000813_title" class="title">
    <b>test_form_tag_error_return</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000813_source')" id="l_M000813_source">show source</a> ]</p>
  <div id="M000813_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 208</span>
208:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_form_tag_error_return</span>
209:       <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Error</span>) { <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;= form_tag '' do\n  Title:\n  Body:\n&quot;</span>) }
210:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000814" class="method">
  <div id="M000814_title" class="title">
    <b>test_haml_options</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000814_source')" id="l_M000814_source">show source</a> ]</p>
  <div id="M000814_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 218</span>
218:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_haml_options</span>
219:     <span class="ruby-identifier">old_options</span> = <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Template</span>.<span class="ruby-identifier">options</span>.<span class="ruby-identifier">dup</span>
220:     <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Template</span>.<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:suppress_eval</span>] = <span class="ruby-keyword kw">true</span>
221:     <span class="ruby-identifier">old_base</span>, <span class="ruby-ivar">@base</span> = <span class="ruby-ivar">@base</span>, <span class="ruby-identifier">create_base</span>
222:     <span class="ruby-identifier">assert_renders_correctly</span>(<span class="ruby-value str">&quot;eval_suppressed&quot;</span>)
223:   <span class="ruby-keyword kw">ensure</span>
224:     <span class="ruby-ivar">@base</span> = <span class="ruby-identifier">old_base</span>
225:     <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Template</span>.<span class="ruby-identifier">options</span> = <span class="ruby-identifier">old_options</span>
226:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000810" class="method">
  <div id="M000810_title" class="title">
    <b>test_instance_variables_should_work_inside_attributes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000810_source')" id="l_M000810_source">show source</a> ]</p>
  <div id="M000810_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 187</span>
187:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_instance_variables_should_work_inside_attributes</span>
188:     <span class="ruby-ivar">@base</span>.<span class="ruby-identifier">instance_eval</span>(<span class="ruby-value str">&quot;@author = 'hcatlin'&quot;</span>)
189:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p class='hcatlin'&gt;foo&lt;/p&gt;&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p{:class =&gt; @author} foo&quot;</span>).<span class="ruby-identifier">chomp</span>)
190:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000809" class="method">
  <div id="M000809_title" class="title">
    <b>test_instance_variables_should_work_inside_templates</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000809_source')" id="l_M000809_source">show source</a> ]</p>
  <div id="M000809_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 173</span>
173:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_instance_variables_should_work_inside_templates</span>
174:     <span class="ruby-ivar">@base</span>.<span class="ruby-identifier">instance_variable_set</span>(<span class="ruby-value str">&quot;@content_for_layout&quot;</span>, <span class="ruby-value str">'something'</span>)
175:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p&gt;something&lt;/p&gt;&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p= @content_for_layout&quot;</span>).<span class="ruby-identifier">chomp</span>)
176: 
177:     <span class="ruby-ivar">@base</span>.<span class="ruby-identifier">instance_eval</span>(<span class="ruby-value str">&quot;@author = 'Hampton Catlin'&quot;</span>)
178:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;div class='author'&gt;Hampton Catlin&lt;/div&gt;&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;.author= @author&quot;</span>).<span class="ruby-identifier">chomp</span>)
179: 
180:     <span class="ruby-ivar">@base</span>.<span class="ruby-identifier">instance_eval</span>(<span class="ruby-value str">&quot;@author = 'Hampton'&quot;</span>)
181:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;Hampton&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;= @author&quot;</span>).<span class="ruby-identifier">chomp</span>)
182: 
183:     <span class="ruby-ivar">@base</span>.<span class="ruby-identifier">instance_eval</span>(<span class="ruby-value str">&quot;@author = 'Catlin'&quot;</span>)
184:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;Catlin&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;= @author&quot;</span>).<span class="ruby-identifier">chomp</span>)
185:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000826" class="method">
  <div id="M000826_title" class="title">
    <b>test_rendered_string_is_html_safe</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000826_source')" id="l_M000826_source">show source</a> ]</p>
  <div id="M000826_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 345</span>
345:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_rendered_string_is_html_safe</span>
346:       <span class="ruby-identifier">assert</span>(<span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;Foo&quot;</span>).<span class="ruby-identifier">html_safe?</span>)
347:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000827" class="method">
  <div id="M000827_title" class="title">
    <b>test_rendered_string_is_html_safe_with_action_view</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000827_source')" id="l_M000827_source">show source</a> ]</p>
  <div id="M000827_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 349</span>
349:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_rendered_string_is_html_safe_with_action_view</span>
350:       <span class="ruby-identifier">assert</span>(<span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;Foo&quot;</span>, <span class="ruby-identifier">:action_view</span>).<span class="ruby-identifier">html_safe?</span>)
351:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000834" class="method">
  <div id="M000834_title" class="title">
    <b>test_rjs</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000834_source')" id="l_M000834_source">show source</a> ]</p>
  <div id="M000834_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 408</span>
408:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_rjs</span>
409:       <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;window.location.reload();\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;= update_page do |p|\n  - p.reload\n&quot;</span>, <span class="ruby-identifier">:action_view</span>))
410:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000811" class="method">
  <div id="M000811_title" class="title">
    <b>test_template_renders_should_eval</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000811_source')" id="l_M000811_source">show source</a> ]</p>
  <div id="M000811_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 192</span>
192:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_template_renders_should_eval</span>
193:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;2\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;= 1+1&quot;</span>))
194:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000807" class="method">
  <div id="M000807_title" class="title">
    <b>test_templates_should_render_correctly_with_def_method</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000807_source')" id="l_M000807_source">show source</a> ]</p>
  <div id="M000807_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 148</span>
148:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_templates_should_render_correctly_with_def_method</span>
149:     <span class="ruby-identifier">assert_renders_correctly</span>(<span class="ruby-value str">&quot;standard&quot;</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">name</span><span class="ruby-operator">|</span>
150:       <span class="ruby-identifier">engine</span> = <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Engine</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>(<span class="ruby-keyword kw">__FILE__</span>) <span class="ruby-operator">+</span> <span class="ruby-node">&quot;/templates/#{name}.haml&quot;</span>))
151:       <span class="ruby-identifier">engine</span>.<span class="ruby-identifier">def_method</span>(<span class="ruby-ivar">@base</span>, <span class="ruby-value str">&quot;render_standard&quot;</span>)
152:       <span class="ruby-ivar">@base</span>.<span class="ruby-identifier">render_standard</span>
153:     <span class="ruby-keyword kw">end</span>
154:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000806" class="method">
  <div id="M000806_title" class="title">
    <b>test_templates_should_render_correctly_with_render_proc</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000806_source')" id="l_M000806_source">show source</a> ]</p>
  <div id="M000806_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 141</span>
141:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_templates_should_render_correctly_with_render_proc</span>
142:     <span class="ruby-identifier">assert_renders_correctly</span>(<span class="ruby-value str">&quot;standard&quot;</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">name</span><span class="ruby-operator">|</span>
143:       <span class="ruby-identifier">engine</span> = <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Engine</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>(<span class="ruby-keyword kw">__FILE__</span>) <span class="ruby-operator">+</span> <span class="ruby-node">&quot;/templates/#{name}.haml&quot;</span>))
144:       <span class="ruby-identifier">engine</span>.<span class="ruby-identifier">render_proc</span>(<span class="ruby-ivar">@base</span>).<span class="ruby-identifier">call</span>
145:     <span class="ruby-keyword kw">end</span>
146:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000815" class="method">
  <div id="M000815_title" class="title">
    <b>test_with_output_buffer_with_ugly</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000815_source')" id="l_M000815_source">show source</a> ]</p>
  <div id="M000815_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 228</span>
228:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_with_output_buffer_with_ugly</span>
229:     <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Util</span>.<span class="ruby-identifier">has?</span>(<span class="ruby-identifier">:instance_method</span>, <span class="ruby-constant">ActionView</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>, <span class="ruby-identifier">:with_output_buffer</span>)
230:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p&gt;\nfoo\nbaz\n&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p\n  foo\n  -# Parenthesis required due to Rails 3.0 deprecation of block helpers\n  -# that return strings.\n  - (with_output_buffer do\n    bar\n    = \&quot;foo\&quot;.gsub(/./) do |s|\n      - \&quot;flup\&quot;\n  - end; nil)\n  baz\n&quot;</span>, <span class="ruby-identifier">:ugly</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>))
231:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000828" class="method">
  <div id="M000828_title" class="title">
    <b>test_xss_html_escaping_with_non_strings</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000828_source')" id="l_M000828_source">show source</a> ]</p>
  <div id="M000828_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 353</span>
353:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_xss_html_escaping_with_non_strings</span>
354:       <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;4\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;= html_escape(4)&quot;</span>))
355:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000819" class="method">
  <div id="M000819_title" class="title">
    <b>test_xss_protection</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000819_source')" id="l_M000819_source">show source</a> ]</p>
  <div id="M000819_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 317</span>
317:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_xss_protection</span>
318:       <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;Foo &amp;amp; Bar\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">'= &quot;Foo &amp; Bar&quot;'</span>, <span class="ruby-identifier">:action_view</span>))
319:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000822" class="method">
  <div id="M000822_title" class="title">
    <b>test_xss_protection_in_interpolation</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000822_source')" id="l_M000822_source">show source</a> ]</p>
  <div id="M000822_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 329</span>
329:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_xss_protection_in_interpolation</span>
330:       <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;Foo &amp;amp; Bar\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">'Foo #{&quot;&amp;&quot;} Bar'</span>, <span class="ruby-identifier">:action_view</span>))
331:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000821" class="method">
  <div id="M000821_title" class="title">
    <b>test_xss_protection_with_bang</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000821_source')" id="l_M000821_source">show source</a> ]</p>
  <div id="M000821_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 325</span>
325:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_xss_protection_with_bang</span>
326:       <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;Foo &amp; Bar\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">'!= &quot;Foo &amp; Bar&quot;'</span>, <span class="ruby-identifier">:action_view</span>))
327:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000823" class="method">
  <div id="M000823_title" class="title">
    <b>test_xss_protection_with_bang_in_interpolation</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000823_source')" id="l_M000823_source">show source</a> ]</p>
  <div id="M000823_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 333</span>
333:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_xss_protection_with_bang_in_interpolation</span>
334:       <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;Foo &amp; Bar\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">'! Foo #{&quot;&amp;&quot;} Bar'</span>, <span class="ruby-identifier">:action_view</span>))
335:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000829" class="method">
  <div id="M000829_title" class="title">
    <b>test_xss_protection_with_concat</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000829_source')" id="l_M000829_source">show source</a> ]</p>
  <div id="M000829_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 357</span>
357:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_xss_protection_with_concat</span>
358:       <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;Foo &amp;amp; Bar&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">'- concat &quot;Foo &amp; Bar&quot;'</span>, <span class="ruby-identifier">:action_view</span>))
359:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000830" class="method">
  <div id="M000830_title" class="title">
    <b>test_xss_protection_with_concat_with_safe_string</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000830_source')" id="l_M000830_source">show source</a> ]</p>
  <div id="M000830_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 361</span>
361:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_xss_protection_with_concat_with_safe_string</span>
362:       <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;Foo &amp; Bar&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">'- concat(Haml::Util.html_safe(&quot;Foo &amp; Bar&quot;))'</span>, <span class="ruby-identifier">:action_view</span>))
363:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000833" class="method">
  <div id="M000833_title" class="title">
    <b>test_xss_protection_with_form_for</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000833_source')" id="l_M000833_source">show source</a> ]</p>
  <div id="M000833_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 389</span>
389:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_xss_protection_with_form_for</span>
390:       <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;form action=\&quot;\&quot; method=\&quot;post\&quot;&gt;\n  Title:\n  &lt;input id=\&quot;article_title\&quot; name=\&quot;article[title]\&quot; size=\&quot;30\&quot; type=\&quot;text\&quot; value=\&quot;Hello\&quot; /&gt;\n  Body:\n  &lt;input id=\&quot;article_body\&quot; name=\&quot;article[body]\&quot; size=\&quot;30\&quot; type=\&quot;text\&quot; value=\&quot;World\&quot; /&gt;\n&lt;/form&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;\#{rails_block_helper_char} form_for \#{form_for_calling_convention(:article)}, :url =&gt; '' do |f|\n  Title:\n  = f.text_field :title\n  Body:\n  = f.text_field :body\n&quot;</span>, <span class="ruby-identifier">:action_view</span>))
391:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000825" class="method">
  <div id="M000825_title" class="title">
    <b>test_xss_protection_with_mixed_strings_in_interpolation</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000825_source')" id="l_M000825_source">show source</a> ]</p>
  <div id="M000825_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 341</span>
341:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_xss_protection_with_mixed_strings_in_interpolation</span>
342:       <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;Foo &amp; Bar &amp;amp; Baz\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">'Foo #{Haml::Util.html_safe(&quot;&amp;&quot;)} Bar #{&quot;&amp;&quot;} Baz'</span>, <span class="ruby-identifier">:action_view</span>))
343:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000832" class="method">
  <div id="M000832_title" class="title">
    <b>test_xss_protection_with_nested_haml_tag</b>()
  </div>
  <div class="description">
  <p>
Regression
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000832_source')" id="l_M000832_source">show source</a> ]</p>
  <div id="M000832_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 373</span>
373:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_xss_protection_with_nested_haml_tag</span>
374:       <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;div&gt;\n  &lt;ul&gt;\n    &lt;li&gt;Content!&lt;/li&gt;\n  &lt;/ul&gt;\n&lt;/div&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;- haml_tag :div do\n  - haml_tag :ul do\n    - haml_tag :li, \&quot;Content!\&quot;\n&quot;</span>, <span class="ruby-identifier">:action_view</span>))
375:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000831" class="method">
  <div id="M000831_title" class="title">
    <b>test_xss_protection_with_safe_concat</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000831_source')" id="l_M000831_source">show source</a> ]</p>
  <div id="M000831_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 366</span>
366:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_xss_protection_with_safe_concat</span>
367:         <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;Foo &amp; Bar&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">'- safe_concat &quot;Foo &amp; Bar&quot;'</span>, <span class="ruby-identifier">:action_view</span>))
368:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000820" class="method">
  <div id="M000820_title" class="title">
    <b>test_xss_protection_with_safe_strings</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000820_source')" id="l_M000820_source">show source</a> ]</p>
  <div id="M000820_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 321</span>
321:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_xss_protection_with_safe_strings</span>
322:       <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;Foo &amp; Bar\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">'= Haml::Util.html_safe(&quot;Foo &amp; Bar&quot;)'</span>, <span class="ruby-identifier">:action_view</span>))
323:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000824" class="method">
  <div id="M000824_title" class="title">
    <b>test_xss_protection_with_safe_strings_in_interpolation</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000824_source')" id="l_M000824_source">show source</a> ]</p>
  <div id="M000824_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 337</span>
337:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_xss_protection_with_safe_strings_in_interpolation</span>
338:       <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;Foo &amp; Bar\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">'Foo #{Haml::Util.html_safe(&quot;&amp;&quot;)} Bar'</span>, <span class="ruby-identifier">:action_view</span>))
339:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
</div>

  </div>