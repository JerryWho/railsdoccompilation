  <div id="C00000014">
<div class='banner'>
  <span class="file-title-prefix">Class</span><br />TemplateTest<br/>
  In:
<a href="#" onclick="jsHref('files/test/haml/template_test_rb.html');">test/haml/template_test.rb</a>

Parent:&nbsp;
Test::Unit::TestCase
</div>
 <!-- banner header -->

  <div id="bodyContent" >
      <div id="content">




  <div class="sectiontitle">Methods</div>
  <ul>
  <li><a href="index.html?a=M000279&name=assert_renders_correctly" >assert_renders_correctly</a></li>
  <li><a href="index.html?a=M000276&name=create_base" >create_base</a></li>
  <li><a href="index.html?a=M000278&name=load_result" >load_result</a></li>
  <li><a href="index.html?a=M000277&name=render" >render</a></li>
  <li><a href="index.html?a=M000275&name=setup" >setup</a></li>
  <li><a href="index.html?a=M000283&name=test_action_view_templates_render_correctly" >test_action_view_templates_render_correctly</a></li>
  <li><a href="index.html?a=M000280&name=test_empty_render_should_remain_empty" >test_empty_render_should_remain_empty</a></li>
  <li><a href="index.html?a=M000290&name=test_escape_html_option_set" >test_escape_html_option_set</a></li>
  <li><a href="index.html?a=M000289&name=test_exceptions_should_work_correctly" >test_exceptions_should_work_correctly</a></li>
  <li><a href="index.html?a=M000287&name=test_haml_options" >test_haml_options</a></li>
  <li><a href="index.html?a=M000285&name=test_instance_variables_should_work_inside_attributes" >test_instance_variables_should_work_inside_attributes</a></li>
  <li><a href="index.html?a=M000284&name=test_instance_variables_should_work_inside_templates" >test_instance_variables_should_work_inside_templates</a></li>
  <li><a href="index.html?a=M000286&name=test_template_renders_should_eval" >test_template_renders_should_eval</a></li>
  <li><a href="index.html?a=M000282&name=test_templates_should_render_correctly_with_def_method" >test_templates_should_render_correctly_with_def_method</a></li>
  <li><a href="index.html?a=M000281&name=test_templates_should_render_correctly_with_render_proc" >test_templates_should_render_correctly_with_render_proc</a></li>
  <li><a href="index.html?a=M000288&name=test_with_output_buffer_with_ugly" >test_with_output_buffer_with_ugly</a></li>
  <li><a href="index.html?a=M000291&name=test_xss_protection" >test_xss_protection</a></li>
  <li><a href="index.html?a=M000294&name=test_xss_protection_in_interpolation" >test_xss_protection_in_interpolation</a></li>
  <li><a href="index.html?a=M000293&name=test_xss_protection_with_bang" >test_xss_protection_with_bang</a></li>
  <li><a href="index.html?a=M000295&name=test_xss_protection_with_bang_in_interpolation" >test_xss_protection_with_bang_in_interpolation</a></li>
  <li><a href="index.html?a=M000297&name=test_xss_protection_with_mixed_strings_in_interpolation" >test_xss_protection_with_mixed_strings_in_interpolation</a></li>
  <li><a href="index.html?a=M000292&name=test_xss_protection_with_safe_strings" >test_xss_protection_with_safe_strings</a></li>
  <li><a href="index.html?a=M000296&name=test_xss_protection_with_safe_strings_in_interpolation" >test_xss_protection_with_safe_strings_in_interpolation</a></li>
  </ul>




  <div class="sectiontitle">Constants</div>
  <table border='0' cellpadding='5'>
  <tr valign='top'>
    <td class="attr-name">TEMPLATE_PATH</td>
    <td>=</td>
    <td class="attr-value">File.join(File.dirname(__FILE__), &quot;templates&quot;)</td>
  </tr>
  <tr valign='top'>
    <td class="attr-name">TEMPLATES</td>
    <td>=</td>
    <td class="attr-value">%w{         very_basic        standard    helpers     whitespace_handling   original_engine   list        helpful     silent_script         tag_parsing       just_stuff  partials     filters               nuke_outer_whitespace         nuke_inner_whitespace     render_layout }</td>
  </tr>
  </table>


<div class="sectiontitle">Public Instance methods</div>
<div id="M000279" class="method">
  <div id="M000279_title" class="title">
    <b>assert_renders_correctly</b>(name, &amp;render_method)
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000279_source')" id="l_M000279_source">show source</a> ]</p>
  <div id="M000279_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 98</span>
 98:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">assert_renders_correctly</span>(<span class="ruby-identifier">name</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">render_method</span>)
 99:     <span class="ruby-identifier">old_options</span> = <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Template</span>.<span class="ruby-identifier">options</span>.<span class="ruby-identifier">dup</span>
100:     <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Template</span>.<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:escape_html</span>] = <span class="ruby-keyword kw">false</span>
101:     <span class="ruby-keyword kw">if</span> <span class="ruby-constant">ActionPack</span><span class="ruby-operator">::</span><span class="ruby-constant">VERSION</span><span class="ruby-operator">::</span><span class="ruby-constant">MAJOR</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">2</span> <span class="ruby-operator">||</span>
102:         (<span class="ruby-constant">ActionPack</span><span class="ruby-operator">::</span><span class="ruby-constant">VERSION</span><span class="ruby-operator">::</span><span class="ruby-constant">MAJOR</span> <span class="ruby-operator">==</span> <span class="ruby-value">2</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-constant">ActionPack</span><span class="ruby-operator">::</span><span class="ruby-constant">VERSION</span><span class="ruby-operator">::</span><span class="ruby-constant">MINOR</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">2</span>)
103:       <span class="ruby-identifier">render_method</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">proc</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">name</span><span class="ruby-operator">|</span> <span class="ruby-ivar">@base</span>.<span class="ruby-identifier">render</span>(<span class="ruby-identifier">name</span>) }
104:     <span class="ruby-keyword kw">else</span>
105:       <span class="ruby-identifier">render_method</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">proc</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">name</span><span class="ruby-operator">|</span> <span class="ruby-ivar">@base</span>.<span class="ruby-identifier">render</span>(<span class="ruby-identifier">:file</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">name</span>) }
106:     <span class="ruby-keyword kw">end</span>
107: 
108:     <span class="ruby-identifier">load_result</span>(<span class="ruby-identifier">name</span>).<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;\n&quot;</span>).<span class="ruby-identifier">zip</span>(<span class="ruby-identifier">render_method</span>[<span class="ruby-identifier">name</span>].<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;\n&quot;</span>)).<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">pair</span>, <span class="ruby-identifier">line</span><span class="ruby-operator">|</span>
109:       <span class="ruby-identifier">message</span> = <span class="ruby-node">&quot;template: #{name}\nline:     #{line}&quot;</span>
110:       <span class="ruby-identifier">assert_equal</span>(<span class="ruby-identifier">pair</span>.<span class="ruby-identifier">first</span>, <span class="ruby-identifier">pair</span>.<span class="ruby-identifier">last</span>, <span class="ruby-identifier">message</span>)
111:     <span class="ruby-keyword kw">end</span>
112:   <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">ActionView</span><span class="ruby-operator">::</span><span class="ruby-constant">TemplateError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
113:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">message</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/Can't run [\w:]+ filter; required (one of|file) ((?:'\w+'(?: or )?)+)(, but none were found| not found)/</span>
114:       <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;\nCouldn't require #{$2}; skipping a test.&quot;</span>
115:     <span class="ruby-keyword kw">else</span>
116:       <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span>
117:     <span class="ruby-keyword kw">end</span>
118:   <span class="ruby-keyword kw">ensure</span>
119:     <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Template</span>.<span class="ruby-identifier">options</span> = <span class="ruby-identifier">old_options</span>
120:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000276" class="method">
  <div id="M000276_title" class="title">
    <b>create_base</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000276_source')" id="l_M000276_source">show source</a> ]</p>
  <div id="M000276_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 61</span>
61:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">create_base</span>
62:     <span class="ruby-identifier">vars</span> = { <span class="ruby-value str">'article'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Article</span>.<span class="ruby-identifier">new</span>, <span class="ruby-value str">'foo'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'value one'</span> }
63:     
64:     <span class="ruby-keyword kw">unless</span> <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Util</span>.<span class="ruby-identifier">has?</span>(<span class="ruby-identifier">:instance_method</span>, <span class="ruby-constant">ActionView</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>, <span class="ruby-identifier">:finder</span>)
65:       <span class="ruby-identifier">base</span> = <span class="ruby-constant">ActionView</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">TEMPLATE_PATH</span>, <span class="ruby-identifier">vars</span>)
66:     <span class="ruby-keyword kw">else</span>
67:       <span class="ruby-comment cmt"># Rails 2.1.0</span>
68:       <span class="ruby-identifier">base</span> = <span class="ruby-constant">ActionView</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">new</span>([], <span class="ruby-identifier">vars</span>)
69:       <span class="ruby-identifier">base</span>.<span class="ruby-identifier">finder</span>.<span class="ruby-identifier">append_view_path</span>(<span class="ruby-constant">TEMPLATE_PATH</span>)
70:     <span class="ruby-keyword kw">end</span>
71:     
72:     <span class="ruby-keyword kw">if</span> <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Util</span>.<span class="ruby-identifier">has?</span>(<span class="ruby-identifier">:private_method</span>, <span class="ruby-identifier">base</span>, <span class="ruby-identifier">:evaluate_assigns</span>)
73:       <span class="ruby-identifier">base</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:evaluate_assigns</span>)
74:     <span class="ruby-keyword kw">else</span>
75:       <span class="ruby-comment cmt"># Rails 2.2</span>
76:       <span class="ruby-identifier">base</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:_evaluate_assigns_and_ivars</span>)
77:     <span class="ruby-keyword kw">end</span>
78: 
79:     <span class="ruby-comment cmt"># This is used by form_for.</span>
80:     <span class="ruby-comment cmt"># It's usually provided by ActionController::Base.</span>
81:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">base</span>.<span class="ruby-identifier">protect_against_forgery?</span>; <span class="ruby-keyword kw">false</span>; <span class="ruby-keyword kw">end</span>
82: 
83:     <span class="ruby-identifier">base</span>.<span class="ruby-identifier">controller</span> = <span class="ruby-constant">DummyController</span>.<span class="ruby-identifier">new</span>
84:     <span class="ruby-identifier">base</span>
85:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000278" class="method">
  <div id="M000278_title" class="title">
    <b>load_result</b>(name)
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000278_source')" id="l_M000278_source">show source</a> ]</p>
  <div id="M000278_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 92</span>
92:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">load_result</span>(<span class="ruby-identifier">name</span>)
93:     <span class="ruby-ivar">@result</span> = <span class="ruby-value str">''</span>
94:     <span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>(<span class="ruby-keyword kw">__FILE__</span>) <span class="ruby-operator">+</span> <span class="ruby-node">&quot;/results/#{name}.xhtml&quot;</span>).<span class="ruby-identifier">each_line</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">l</span><span class="ruby-operator">|</span> <span class="ruby-ivar">@result</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">l</span> }
95:     <span class="ruby-ivar">@result</span>
96:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000277" class="method">
  <div id="M000277_title" class="title">
    <b>render</b>(text, opts = {})
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000277_source')" id="l_M000277_source">show source</a> ]</p>
  <div id="M000277_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 87</span>
87:   <span class="ruby-keyword kw">def</span>  <span class="ruby-identifier">render</span><span class="ruby-identifier">render</span>(<span class="ruby-identifier">text</span>, <span class="ruby-identifier">opts</span> = {})
88:     <span class="ruby-keyword kw">return</span> <span class="ruby-ivar">@base</span>.<span class="ruby-identifier">render</span>(<span class="ruby-identifier">:inline</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">text</span>, <span class="ruby-identifier">:type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:haml</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">opts</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">:action_view</span>
89:     <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Engine</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">text</span>, <span class="ruby-identifier">opts</span>).<span class="ruby-identifier">to_html</span>(<span class="ruby-ivar">@base</span>)
90:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000275" class="method">
  <div id="M000275_title" class="title">
    <b>setup</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000275_source')" id="l_M000275_source">show source</a> ]</p>
  <div id="M000275_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 54</span>
54:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">setup</span>
55:     <span class="ruby-ivar">@base</span> = <span class="ruby-identifier">create_base</span>
56: 
57:     <span class="ruby-comment cmt"># filters template uses :sass</span>
58:     <span class="ruby-constant">Sass</span><span class="ruby-operator">::</span><span class="ruby-constant">Plugin</span>.<span class="ruby-identifier">options</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">:line_comments</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>, <span class="ruby-identifier">:style</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:compact</span>)
59:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000283" class="method">
  <div id="M000283_title" class="title">
    <b>test_action_view_templates_render_correctly</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000283_source')" id="l_M000283_source">show source</a> ]</p>
  <div id="M000283_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 147</span>
147:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_action_view_templates_render_correctly</span>
148:     <span class="ruby-identifier">proc</span> = <span class="ruby-identifier">lambda</span> <span class="ruby-keyword kw">do</span>
149:       <span class="ruby-ivar">@base</span>.<span class="ruby-identifier">content_for</span>(<span class="ruby-identifier">:layout</span>) {<span class="ruby-value str">'Lorem ipsum dolor sit amet'</span>}
150:       <span class="ruby-identifier">assert_renders_correctly</span> <span class="ruby-value str">'content_for_layout'</span>
151:     <span class="ruby-keyword kw">end</span>
152: 
153:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@base</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:with_output_buffer</span>)
154:       <span class="ruby-ivar">@base</span>.<span class="ruby-identifier">with_output_buffer</span>(<span class="ruby-value str">&quot;&quot;</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">proc</span>)
155:     <span class="ruby-keyword kw">else</span>
156:       <span class="ruby-identifier">proc</span>.<span class="ruby-identifier">call</span>
157:     <span class="ruby-keyword kw">end</span>
158:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000280" class="method">
  <div id="M000280_title" class="title">
    <b>test_empty_render_should_remain_empty</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000280_source')" id="l_M000280_source">show source</a> ]</p>
  <div id="M000280_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 122</span>
122:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_empty_render_should_remain_empty</span>
123:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">''</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">''</span>))
124:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000290" class="method">
  <div id="M000290_title" class="title">
    <b>test_escape_html_option_set</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000290_source')" id="l_M000290_source">show source</a> ]</p>
  <div id="M000290_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 248</span>
248:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_escape_html_option_set</span>
249:       <span class="ruby-identifier">assert</span> <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Template</span>.<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:escape_html</span>]
250:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000289" class="method">
  <div id="M000289_title" class="title">
    <b>test_exceptions_should_work_correctly</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000289_source')" id="l_M000289_source">show source</a> ]</p>
  <div id="M000289_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 213</span>
213:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_exceptions_should_work_correctly</span>
214:     <span class="ruby-keyword kw">begin</span>
215:       <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;- raise 'oops!'&quot;</span>)
216:     <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">Exception</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
217:       <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;oops!&quot;</span>, <span class="ruby-identifier">e</span>.<span class="ruby-identifier">message</span>)
218:       <span class="ruby-identifier">assert_match</span>(<span class="ruby-regexp re">/^\(haml\):1/</span>, <span class="ruby-identifier">e</span>.<span class="ruby-identifier">backtrace</span>[<span class="ruby-value">0</span>])
219:     <span class="ruby-keyword kw">else</span>
220:       <span class="ruby-identifier">assert</span> <span class="ruby-keyword kw">false</span>
221:     <span class="ruby-keyword kw">end</span>
222: 
223:     <span class="ruby-identifier">template</span> = <span class="ruby-value str">&quot;%p\n  %h1 Hello!\n  = \&quot;lots of lines\&quot;\n  = \&quot;even more!\&quot;\n  - raise 'oh no!'\n  %p\n    this is after the exception\n    %strong yes it is!\nho ho ho.\n&quot;</span>
224: 
225:     <span class="ruby-keyword kw">begin</span>
226:       <span class="ruby-identifier">render</span>(<span class="ruby-identifier">template</span>.<span class="ruby-identifier">chomp</span>)
227:     <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">Exception</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
228:       <span class="ruby-identifier">assert_match</span>(<span class="ruby-regexp re">/^\(haml\):5/</span>, <span class="ruby-identifier">e</span>.<span class="ruby-identifier">backtrace</span>[<span class="ruby-value">0</span>])
229:     <span class="ruby-keyword kw">else</span>
230:       <span class="ruby-identifier">assert</span> <span class="ruby-keyword kw">false</span>
231:     <span class="ruby-keyword kw">end</span>
232:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000287" class="method">
  <div id="M000287_title" class="title">
    <b>test_haml_options</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000287_source')" id="l_M000287_source">show source</a> ]</p>
  <div id="M000287_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 183</span>
183:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_haml_options</span>
184:     <span class="ruby-identifier">old_options</span> = <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Template</span>.<span class="ruby-identifier">options</span>.<span class="ruby-identifier">dup</span>
185:     <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Template</span>.<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:suppress_eval</span>] = <span class="ruby-keyword kw">true</span>
186:     <span class="ruby-identifier">old_base</span>, <span class="ruby-ivar">@base</span> = <span class="ruby-ivar">@base</span>, <span class="ruby-identifier">create_base</span>
187:     <span class="ruby-identifier">assert_renders_correctly</span>(<span class="ruby-value str">&quot;eval_suppressed&quot;</span>)
188:   <span class="ruby-keyword kw">ensure</span>
189:     <span class="ruby-ivar">@base</span> = <span class="ruby-identifier">old_base</span>
190:     <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Template</span>.<span class="ruby-identifier">options</span> = <span class="ruby-identifier">old_options</span>
191:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000285" class="method">
  <div id="M000285_title" class="title">
    <b>test_instance_variables_should_work_inside_attributes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000285_source')" id="l_M000285_source">show source</a> ]</p>
  <div id="M000285_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 174</span>
174:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_instance_variables_should_work_inside_attributes</span>
175:     <span class="ruby-ivar">@base</span>.<span class="ruby-identifier">instance_eval</span>(<span class="ruby-value str">&quot;@author = 'hcatlin'&quot;</span>)
176:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p class='hcatlin'&gt;foo&lt;/p&gt;&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p{:class =&gt; @author} foo&quot;</span>).<span class="ruby-identifier">chomp</span>)
177:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000284" class="method">
  <div id="M000284_title" class="title">
    <b>test_instance_variables_should_work_inside_templates</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000284_source')" id="l_M000284_source">show source</a> ]</p>
  <div id="M000284_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 160</span>
160:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_instance_variables_should_work_inside_templates</span>
161:     <span class="ruby-ivar">@base</span>.<span class="ruby-identifier">instance_variable_set</span>(<span class="ruby-value str">&quot;@content_for_layout&quot;</span>, <span class="ruby-value str">'something'</span>)
162:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p&gt;something&lt;/p&gt;&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p= @content_for_layout&quot;</span>).<span class="ruby-identifier">chomp</span>)
163: 
164:     <span class="ruby-ivar">@base</span>.<span class="ruby-identifier">instance_eval</span>(<span class="ruby-value str">&quot;@author = 'Hampton Catlin'&quot;</span>)
165:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;div class='author'&gt;Hampton Catlin&lt;/div&gt;&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;.author= @author&quot;</span>).<span class="ruby-identifier">chomp</span>)
166: 
167:     <span class="ruby-ivar">@base</span>.<span class="ruby-identifier">instance_eval</span>(<span class="ruby-value str">&quot;@author = 'Hampton'&quot;</span>)
168:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;Hampton&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;= @author&quot;</span>).<span class="ruby-identifier">chomp</span>)
169: 
170:     <span class="ruby-ivar">@base</span>.<span class="ruby-identifier">instance_eval</span>(<span class="ruby-value str">&quot;@author = 'Catlin'&quot;</span>)
171:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;Catlin&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;= @author&quot;</span>).<span class="ruby-identifier">chomp</span>)
172:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000286" class="method">
  <div id="M000286_title" class="title">
    <b>test_template_renders_should_eval</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000286_source')" id="l_M000286_source">show source</a> ]</p>
  <div id="M000286_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 179</span>
179:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_template_renders_should_eval</span>
180:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;2\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;= 1+1&quot;</span>))
181:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000282" class="method">
  <div id="M000282_title" class="title">
    <b>test_templates_should_render_correctly_with_def_method</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000282_source')" id="l_M000282_source">show source</a> ]</p>
  <div id="M000282_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 139</span>
139:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_templates_should_render_correctly_with_def_method</span>
140:     <span class="ruby-identifier">assert_renders_correctly</span>(<span class="ruby-value str">&quot;standard&quot;</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">name</span><span class="ruby-operator">|</span>
141:       <span class="ruby-identifier">engine</span> = <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Engine</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>(<span class="ruby-keyword kw">__FILE__</span>) <span class="ruby-operator">+</span> <span class="ruby-node">&quot;/templates/#{name}.haml&quot;</span>))
142:       <span class="ruby-identifier">engine</span>.<span class="ruby-identifier">def_method</span>(<span class="ruby-ivar">@base</span>, <span class="ruby-value str">&quot;render_standard&quot;</span>)
143:       <span class="ruby-ivar">@base</span>.<span class="ruby-identifier">render_standard</span>
144:     <span class="ruby-keyword kw">end</span>
145:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000281" class="method">
  <div id="M000281_title" class="title">
    <b>test_templates_should_render_correctly_with_render_proc</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000281_source')" id="l_M000281_source">show source</a> ]</p>
  <div id="M000281_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 132</span>
132:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_templates_should_render_correctly_with_render_proc</span>
133:     <span class="ruby-identifier">assert_renders_correctly</span>(<span class="ruby-value str">&quot;standard&quot;</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">name</span><span class="ruby-operator">|</span>
134:       <span class="ruby-identifier">engine</span> = <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Engine</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>(<span class="ruby-keyword kw">__FILE__</span>) <span class="ruby-operator">+</span> <span class="ruby-node">&quot;/templates/#{name}.haml&quot;</span>))
135:       <span class="ruby-identifier">engine</span>.<span class="ruby-identifier">render_proc</span>(<span class="ruby-ivar">@base</span>).<span class="ruby-identifier">call</span>
136:     <span class="ruby-keyword kw">end</span>
137:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000288" class="method">
  <div id="M000288_title" class="title">
    <b>test_with_output_buffer_with_ugly</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000288_source')" id="l_M000288_source">show source</a> ]</p>
  <div id="M000288_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 193</span>
193:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_with_output_buffer_with_ugly</span>
194:     <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Util</span>.<span class="ruby-identifier">has?</span>(<span class="ruby-identifier">:instance_method</span>, <span class="ruby-constant">ActionView</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>, <span class="ruby-identifier">:with_output_buffer</span>)
195:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p&gt;\nfoo\nbaz\n&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p\n  foo\n  - with_output_buffer do\n    bar\n    = \&quot;foo\&quot;.gsub(/./) do |s|\n      - s.ord\n  baz\n&quot;</span>, <span class="ruby-identifier">:ugly</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>))
196:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000291" class="method">
  <div id="M000291_title" class="title">
    <b>test_xss_protection</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000291_source')" id="l_M000291_source">show source</a> ]</p>
  <div id="M000291_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 252</span>
252:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_xss_protection</span>
253:       <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;Foo &amp;amp; Bar\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">'= &quot;Foo &amp; Bar&quot;'</span>, <span class="ruby-identifier">:action_view</span>))
254:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000294" class="method">
  <div id="M000294_title" class="title">
    <b>test_xss_protection_in_interpolation</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000294_source')" id="l_M000294_source">show source</a> ]</p>
  <div id="M000294_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 264</span>
264:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_xss_protection_in_interpolation</span>
265:       <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;Foo &amp;amp; Bar\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">'Foo #{&quot;&amp;&quot;} Bar'</span>, <span class="ruby-identifier">:action_view</span>))
266:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000293" class="method">
  <div id="M000293_title" class="title">
    <b>test_xss_protection_with_bang</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000293_source')" id="l_M000293_source">show source</a> ]</p>
  <div id="M000293_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 260</span>
260:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_xss_protection_with_bang</span>
261:       <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;Foo &amp; Bar\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">'!= &quot;Foo &amp; Bar&quot;'</span>, <span class="ruby-identifier">:action_view</span>))
262:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000295" class="method">
  <div id="M000295_title" class="title">
    <b>test_xss_protection_with_bang_in_interpolation</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000295_source')" id="l_M000295_source">show source</a> ]</p>
  <div id="M000295_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 268</span>
268:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_xss_protection_with_bang_in_interpolation</span>
269:       <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;Foo &amp; Bar\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">'! Foo #{&quot;&amp;&quot;} Bar'</span>, <span class="ruby-identifier">:action_view</span>))
270:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000297" class="method">
  <div id="M000297_title" class="title">
    <b>test_xss_protection_with_mixed_strings_in_interpolation</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000297_source')" id="l_M000297_source">show source</a> ]</p>
  <div id="M000297_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 276</span>
276:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_xss_protection_with_mixed_strings_in_interpolation</span>
277:       <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;Foo &amp; Bar &amp;amp; Baz\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">'Foo #{&quot;&amp;&quot;.html_safe!} Bar #{&quot;&amp;&quot;} Baz'</span>, <span class="ruby-identifier">:action_view</span>))
278:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000292" class="method">
  <div id="M000292_title" class="title">
    <b>test_xss_protection_with_safe_strings</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000292_source')" id="l_M000292_source">show source</a> ]</p>
  <div id="M000292_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 256</span>
256:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_xss_protection_with_safe_strings</span>
257:       <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;Foo &amp; Bar\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">'= &quot;Foo &amp; Bar&quot;.html_safe!'</span>, <span class="ruby-identifier">:action_view</span>))
258:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000296" class="method">
  <div id="M000296_title" class="title">
    <b>test_xss_protection_with_safe_strings_in_interpolation</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000296_source')" id="l_M000296_source">show source</a> ]</p>
  <div id="M000296_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 272</span>
272:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_xss_protection_with_safe_strings_in_interpolation</span>
273:       <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;Foo &amp; Bar\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">'Foo #{&quot;&amp;&quot;.html_safe!} Bar'</span>, <span class="ruby-identifier">:action_view</span>))
274:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
</div>

  </div>