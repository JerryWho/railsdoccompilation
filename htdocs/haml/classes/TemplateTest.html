  <div id="C00000009">
<div class='banner'>
  <span class="file-title-prefix">Class</span><br />TemplateTest<br/>
  In:
<a href="#" onclick="jsHref('files/test/haml/template_test_rb.html');">test/haml/template_test.rb</a>

Parent:&nbsp;
Test::Unit::TestCase
</div>
 <!-- banner header -->

  <div id="bodyContent" >
      <div id="content">




  <div class="sectiontitle">Methods</div>
  <ul>
  <li><a href="index.html?a=M000245&name=assert_renders_correctly" >assert_renders_correctly</a></li>
  <li><a href="index.html?a=M000242&name=create_base" >create_base</a></li>
  <li><a href="index.html?a=M000244&name=load_result" >load_result</a></li>
  <li><a href="index.html?a=M000243&name=render" >render</a></li>
  <li><a href="index.html?a=M000241&name=setup" >setup</a></li>
  <li><a href="index.html?a=M000249&name=test_action_view_templates_render_correctly" >test_action_view_templates_render_correctly</a></li>
  <li><a href="index.html?a=M000246&name=test_empty_render_should_remain_empty" >test_empty_render_should_remain_empty</a></li>
  <li><a href="index.html?a=M000256&name=test_escape_html_option_set" >test_escape_html_option_set</a></li>
  <li><a href="index.html?a=M000255&name=test_exceptions_should_work_correctly" >test_exceptions_should_work_correctly</a></li>
  <li><a href="index.html?a=M000253&name=test_haml_options" >test_haml_options</a></li>
  <li><a href="index.html?a=M000251&name=test_instance_variables_should_work_inside_attributes" >test_instance_variables_should_work_inside_attributes</a></li>
  <li><a href="index.html?a=M000250&name=test_instance_variables_should_work_inside_templates" >test_instance_variables_should_work_inside_templates</a></li>
  <li><a href="index.html?a=M000264&name=test_rendered_string_is_html_safe" >test_rendered_string_is_html_safe</a></li>
  <li><a href="index.html?a=M000265&name=test_rendered_string_is_html_safe_with_action_view" >test_rendered_string_is_html_safe_with_action_view</a></li>
  <li><a href="index.html?a=M000252&name=test_template_renders_should_eval" >test_template_renders_should_eval</a></li>
  <li><a href="index.html?a=M000248&name=test_templates_should_render_correctly_with_def_method" >test_templates_should_render_correctly_with_def_method</a></li>
  <li><a href="index.html?a=M000247&name=test_templates_should_render_correctly_with_render_proc" >test_templates_should_render_correctly_with_render_proc</a></li>
  <li><a href="index.html?a=M000254&name=test_with_output_buffer_with_ugly" >test_with_output_buffer_with_ugly</a></li>
  <li><a href="index.html?a=M000266&name=test_xss_html_escaping_with_non_strings" >test_xss_html_escaping_with_non_strings</a></li>
  <li><a href="index.html?a=M000257&name=test_xss_protection" >test_xss_protection</a></li>
  <li><a href="index.html?a=M000260&name=test_xss_protection_in_interpolation" >test_xss_protection_in_interpolation</a></li>
  <li><a href="index.html?a=M000259&name=test_xss_protection_with_bang" >test_xss_protection_with_bang</a></li>
  <li><a href="index.html?a=M000261&name=test_xss_protection_with_bang_in_interpolation" >test_xss_protection_with_bang_in_interpolation</a></li>
  <li><a href="index.html?a=M000263&name=test_xss_protection_with_mixed_strings_in_interpolation" >test_xss_protection_with_mixed_strings_in_interpolation</a></li>
  <li><a href="index.html?a=M000258&name=test_xss_protection_with_safe_strings" >test_xss_protection_with_safe_strings</a></li>
  <li><a href="index.html?a=M000262&name=test_xss_protection_with_safe_strings_in_interpolation" >test_xss_protection_with_safe_strings_in_interpolation</a></li>
  </ul>




  <div class="sectiontitle">Constants</div>
  <table border='0' cellpadding='5'>
  <tr valign='top'>
    <td class="attr-name">TEMPLATE_PATH</td>
    <td>=</td>
    <td class="attr-value">File.join(File.dirname(__FILE__), &quot;templates&quot;)</td>
  </tr>
  <tr valign='top'>
    <td class="attr-name">TEMPLATES</td>
    <td>=</td>
    <td class="attr-value">%w{         very_basic        standard    helpers     whitespace_handling   original_engine   list        helpful     silent_script         tag_parsing       just_stuff  partials     filters               nuke_outer_whitespace         nuke_inner_whitespace     render_layout }</td>
  </tr>
  </table>


<div class="sectiontitle">Public Instance methods</div>
<div id="M000245" class="method">
  <div id="M000245_title" class="title">
    <b>assert_renders_correctly</b>(name, &amp;render_method)
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000245_source')" id="l_M000245_source">show source</a> ]</p>
  <div id="M000245_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 98</span>
 98:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">assert_renders_correctly</span>(<span class="ruby-identifier">name</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">render_method</span>)
 99:     <span class="ruby-identifier">old_options</span> = <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Template</span>.<span class="ruby-identifier">options</span>.<span class="ruby-identifier">dup</span>
100:     <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Template</span>.<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:escape_html</span>] = <span class="ruby-keyword kw">false</span>
101:     <span class="ruby-keyword kw">if</span> <span class="ruby-constant">ActionPack</span><span class="ruby-operator">::</span><span class="ruby-constant">VERSION</span><span class="ruby-operator">::</span><span class="ruby-constant">MAJOR</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">2</span> <span class="ruby-operator">||</span>
102:         (<span class="ruby-constant">ActionPack</span><span class="ruby-operator">::</span><span class="ruby-constant">VERSION</span><span class="ruby-operator">::</span><span class="ruby-constant">MAJOR</span> <span class="ruby-operator">==</span> <span class="ruby-value">2</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-constant">ActionPack</span><span class="ruby-operator">::</span><span class="ruby-constant">VERSION</span><span class="ruby-operator">::</span><span class="ruby-constant">MINOR</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">2</span>)
103:       <span class="ruby-identifier">render_method</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">proc</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">name</span><span class="ruby-operator">|</span> <span class="ruby-ivar">@base</span>.<span class="ruby-identifier">render</span>(<span class="ruby-identifier">name</span>) }
104:     <span class="ruby-keyword kw">else</span>
105:       <span class="ruby-identifier">render_method</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">proc</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">name</span><span class="ruby-operator">|</span> <span class="ruby-ivar">@base</span>.<span class="ruby-identifier">render</span>(<span class="ruby-identifier">:file</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">name</span>) }
106:     <span class="ruby-keyword kw">end</span>
107: 
108:     <span class="ruby-identifier">load_result</span>(<span class="ruby-identifier">name</span>).<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;\n&quot;</span>).<span class="ruby-identifier">zip</span>(<span class="ruby-identifier">render_method</span>[<span class="ruby-identifier">name</span>].<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;\n&quot;</span>)).<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">pair</span>, <span class="ruby-identifier">line</span><span class="ruby-operator">|</span>
109:       <span class="ruby-identifier">message</span> = <span class="ruby-node">&quot;template: #{name}\nline:     #{line}&quot;</span>
110:       <span class="ruby-identifier">assert_equal</span>(<span class="ruby-identifier">pair</span>.<span class="ruby-identifier">first</span>, <span class="ruby-identifier">pair</span>.<span class="ruby-identifier">last</span>, <span class="ruby-identifier">message</span>)
111:     <span class="ruby-keyword kw">end</span>
112:   <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">ActionView</span><span class="ruby-operator">::</span><span class="ruby-constant">TemplateError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
113:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">message</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/Can't run [\w:]+ filter; required (one of|file) ((?:'\w+'(?: or )?)+)(, but none were found| not found)/</span>
114:       <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;\nCouldn't require #{$2}; skipping a test.&quot;</span>
115:     <span class="ruby-keyword kw">else</span>
116:       <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span>
117:     <span class="ruby-keyword kw">end</span>
118:   <span class="ruby-keyword kw">ensure</span>
119:     <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Template</span>.<span class="ruby-identifier">options</span> = <span class="ruby-identifier">old_options</span>
120:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000242" class="method">
  <div id="M000242_title" class="title">
    <b>create_base</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000242_source')" id="l_M000242_source">show source</a> ]</p>
  <div id="M000242_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 61</span>
61:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">create_base</span>
62:     <span class="ruby-identifier">vars</span> = { <span class="ruby-value str">'article'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Article</span>.<span class="ruby-identifier">new</span>, <span class="ruby-value str">'foo'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'value one'</span> }
63:     
64:     <span class="ruby-keyword kw">unless</span> <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Util</span>.<span class="ruby-identifier">has?</span>(<span class="ruby-identifier">:instance_method</span>, <span class="ruby-constant">ActionView</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>, <span class="ruby-identifier">:finder</span>)
65:       <span class="ruby-identifier">base</span> = <span class="ruby-constant">ActionView</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">TEMPLATE_PATH</span>, <span class="ruby-identifier">vars</span>)
66:     <span class="ruby-keyword kw">else</span>
67:       <span class="ruby-comment cmt"># Rails 2.1.0</span>
68:       <span class="ruby-identifier">base</span> = <span class="ruby-constant">ActionView</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">new</span>([], <span class="ruby-identifier">vars</span>)
69:       <span class="ruby-identifier">base</span>.<span class="ruby-identifier">finder</span>.<span class="ruby-identifier">append_view_path</span>(<span class="ruby-constant">TEMPLATE_PATH</span>)
70:     <span class="ruby-keyword kw">end</span>
71:     
72:     <span class="ruby-keyword kw">if</span> <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Util</span>.<span class="ruby-identifier">has?</span>(<span class="ruby-identifier">:private_method</span>, <span class="ruby-identifier">base</span>, <span class="ruby-identifier">:evaluate_assigns</span>)
73:       <span class="ruby-identifier">base</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:evaluate_assigns</span>)
74:     <span class="ruby-keyword kw">else</span>
75:       <span class="ruby-comment cmt"># Rails 2.2</span>
76:       <span class="ruby-identifier">base</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:_evaluate_assigns_and_ivars</span>)
77:     <span class="ruby-keyword kw">end</span>
78: 
79:     <span class="ruby-comment cmt"># This is used by form_for.</span>
80:     <span class="ruby-comment cmt"># It's usually provided by ActionController::Base.</span>
81:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">base</span>.<span class="ruby-identifier">protect_against_forgery?</span>; <span class="ruby-keyword kw">false</span>; <span class="ruby-keyword kw">end</span>
82: 
83:     <span class="ruby-identifier">base</span>.<span class="ruby-identifier">controller</span> = <span class="ruby-constant">DummyController</span>.<span class="ruby-identifier">new</span>
84:     <span class="ruby-identifier">base</span>
85:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000244" class="method">
  <div id="M000244_title" class="title">
    <b>load_result</b>(name)
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000244_source')" id="l_M000244_source">show source</a> ]</p>
  <div id="M000244_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 92</span>
92:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">load_result</span>(<span class="ruby-identifier">name</span>)
93:     <span class="ruby-ivar">@result</span> = <span class="ruby-value str">''</span>
94:     <span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>(<span class="ruby-keyword kw">__FILE__</span>) <span class="ruby-operator">+</span> <span class="ruby-node">&quot;/results/#{name}.xhtml&quot;</span>).<span class="ruby-identifier">each_line</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">l</span><span class="ruby-operator">|</span> <span class="ruby-ivar">@result</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">l</span> }
95:     <span class="ruby-ivar">@result</span>
96:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000243" class="method">
  <div id="M000243_title" class="title">
    <b>render</b>(text, opts = {})
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000243_source')" id="l_M000243_source">show source</a> ]</p>
  <div id="M000243_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 87</span>
87:   <span class="ruby-keyword kw">def</span>  <span class="ruby-identifier">render</span><span class="ruby-identifier">render</span>(<span class="ruby-identifier">text</span>, <span class="ruby-identifier">opts</span> = {})
88:     <span class="ruby-keyword kw">return</span> <span class="ruby-ivar">@base</span>.<span class="ruby-identifier">render</span>(<span class="ruby-identifier">:inline</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">text</span>, <span class="ruby-identifier">:type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:haml</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">opts</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">:action_view</span>
89:     <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Engine</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">text</span>, <span class="ruby-identifier">opts</span>).<span class="ruby-identifier">to_html</span>(<span class="ruby-ivar">@base</span>)
90:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000241" class="method">
  <div id="M000241_title" class="title">
    <b>setup</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000241_source')" id="l_M000241_source">show source</a> ]</p>
  <div id="M000241_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 54</span>
54:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">setup</span>
55:     <span class="ruby-ivar">@base</span> = <span class="ruby-identifier">create_base</span>
56: 
57:     <span class="ruby-comment cmt"># filters template uses :sass</span>
58:     <span class="ruby-constant">Sass</span><span class="ruby-operator">::</span><span class="ruby-constant">Plugin</span>.<span class="ruby-identifier">options</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">:line_comments</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>, <span class="ruby-identifier">:style</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:compact</span>)
59:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000249" class="method">
  <div id="M000249_title" class="title">
    <b>test_action_view_templates_render_correctly</b>()
  </div>
  <div class="description">
  <p>
Rails 3.0.0 deprecates the use of yield with a layout for calls to render
:file
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000249_source')" id="l_M000249_source">show source</a> ]</p>
  <div id="M000249_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 150</span>
150:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_action_view_templates_render_correctly</span>
151:       <span class="ruby-identifier">proc</span> = <span class="ruby-identifier">lambda</span> <span class="ruby-keyword kw">do</span>
152:         <span class="ruby-ivar">@base</span>.<span class="ruby-identifier">content_for</span>(<span class="ruby-identifier">:layout</span>) {<span class="ruby-value str">'Lorem ipsum dolor sit amet'</span>}
153:         <span class="ruby-identifier">assert_renders_correctly</span> <span class="ruby-value str">'content_for_layout'</span>
154:       <span class="ruby-keyword kw">end</span>
155: 
156:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@base</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:with_output_buffer</span>)
157:         <span class="ruby-ivar">@base</span>.<span class="ruby-identifier">with_output_buffer</span>(<span class="ruby-value str">&quot;&quot;</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">proc</span>)
158:       <span class="ruby-keyword kw">else</span>
159:         <span class="ruby-identifier">proc</span>.<span class="ruby-identifier">call</span>
160:       <span class="ruby-keyword kw">end</span>
161:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000246" class="method">
  <div id="M000246_title" class="title">
    <b>test_empty_render_should_remain_empty</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000246_source')" id="l_M000246_source">show source</a> ]</p>
  <div id="M000246_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 122</span>
122:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_empty_render_should_remain_empty</span>
123:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">''</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">''</span>))
124:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000256" class="method">
  <div id="M000256_title" class="title">
    <b>test_escape_html_option_set</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000256_source')" id="l_M000256_source">show source</a> ]</p>
  <div id="M000256_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 255</span>
255:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_escape_html_option_set</span>
256:       <span class="ruby-identifier">assert</span> <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Template</span>.<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:escape_html</span>]
257:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000255" class="method">
  <div id="M000255_title" class="title">
    <b>test_exceptions_should_work_correctly</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000255_source')" id="l_M000255_source">show source</a> ]</p>
  <div id="M000255_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 217</span>
217:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_exceptions_should_work_correctly</span>
218:     <span class="ruby-keyword kw">begin</span>
219:       <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;- raise 'oops!'&quot;</span>)
220:     <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">Exception</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
221:       <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;oops!&quot;</span>, <span class="ruby-identifier">e</span>.<span class="ruby-identifier">message</span>)
222:       <span class="ruby-identifier">assert_match</span>(<span class="ruby-regexp re">/^\(haml\):1/</span>, <span class="ruby-identifier">e</span>.<span class="ruby-identifier">backtrace</span>[<span class="ruby-value">0</span>])
223:     <span class="ruby-keyword kw">else</span>
224:       <span class="ruby-identifier">assert</span> <span class="ruby-keyword kw">false</span>
225:     <span class="ruby-keyword kw">end</span>
226: 
227:     <span class="ruby-identifier">template</span> = <span class="ruby-value str">&quot;%p\n  %h1 Hello!\n  = \&quot;lots of lines\&quot;\n  = \&quot;even more!\&quot;\n  - raise 'oh no!'\n  %p\n    this is after the exception\n    %strong yes it is!\nho ho ho.\n&quot;</span>
228: 
229:     <span class="ruby-keyword kw">begin</span>
230:       <span class="ruby-identifier">render</span>(<span class="ruby-identifier">template</span>.<span class="ruby-identifier">chomp</span>)
231:     <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">Exception</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
232:       <span class="ruby-identifier">assert_match</span>(<span class="ruby-regexp re">/^\(haml\):5/</span>, <span class="ruby-identifier">e</span>.<span class="ruby-identifier">backtrace</span>[<span class="ruby-value">0</span>])
233:     <span class="ruby-keyword kw">else</span>
234:       <span class="ruby-identifier">assert</span> <span class="ruby-keyword kw">false</span>
235:     <span class="ruby-keyword kw">end</span>
236:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000253" class="method">
  <div id="M000253_title" class="title">
    <b>test_haml_options</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000253_source')" id="l_M000253_source">show source</a> ]</p>
  <div id="M000253_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 187</span>
187:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_haml_options</span>
188:     <span class="ruby-identifier">old_options</span> = <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Template</span>.<span class="ruby-identifier">options</span>.<span class="ruby-identifier">dup</span>
189:     <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Template</span>.<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:suppress_eval</span>] = <span class="ruby-keyword kw">true</span>
190:     <span class="ruby-identifier">old_base</span>, <span class="ruby-ivar">@base</span> = <span class="ruby-ivar">@base</span>, <span class="ruby-identifier">create_base</span>
191:     <span class="ruby-identifier">assert_renders_correctly</span>(<span class="ruby-value str">&quot;eval_suppressed&quot;</span>)
192:   <span class="ruby-keyword kw">ensure</span>
193:     <span class="ruby-ivar">@base</span> = <span class="ruby-identifier">old_base</span>
194:     <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Template</span>.<span class="ruby-identifier">options</span> = <span class="ruby-identifier">old_options</span>
195:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000251" class="method">
  <div id="M000251_title" class="title">
    <b>test_instance_variables_should_work_inside_attributes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000251_source')" id="l_M000251_source">show source</a> ]</p>
  <div id="M000251_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 178</span>
178:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_instance_variables_should_work_inside_attributes</span>
179:     <span class="ruby-ivar">@base</span>.<span class="ruby-identifier">instance_eval</span>(<span class="ruby-value str">&quot;@author = 'hcatlin'&quot;</span>)
180:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p class='hcatlin'&gt;foo&lt;/p&gt;&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p{:class =&gt; @author} foo&quot;</span>).<span class="ruby-identifier">chomp</span>)
181:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000250" class="method">
  <div id="M000250_title" class="title">
    <b>test_instance_variables_should_work_inside_templates</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000250_source')" id="l_M000250_source">show source</a> ]</p>
  <div id="M000250_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 164</span>
164:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_instance_variables_should_work_inside_templates</span>
165:     <span class="ruby-ivar">@base</span>.<span class="ruby-identifier">instance_variable_set</span>(<span class="ruby-value str">&quot;@content_for_layout&quot;</span>, <span class="ruby-value str">'something'</span>)
166:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p&gt;something&lt;/p&gt;&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p= @content_for_layout&quot;</span>).<span class="ruby-identifier">chomp</span>)
167: 
168:     <span class="ruby-ivar">@base</span>.<span class="ruby-identifier">instance_eval</span>(<span class="ruby-value str">&quot;@author = 'Hampton Catlin'&quot;</span>)
169:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;div class='author'&gt;Hampton Catlin&lt;/div&gt;&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;.author= @author&quot;</span>).<span class="ruby-identifier">chomp</span>)
170: 
171:     <span class="ruby-ivar">@base</span>.<span class="ruby-identifier">instance_eval</span>(<span class="ruby-value str">&quot;@author = 'Hampton'&quot;</span>)
172:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;Hampton&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;= @author&quot;</span>).<span class="ruby-identifier">chomp</span>)
173: 
174:     <span class="ruby-ivar">@base</span>.<span class="ruby-identifier">instance_eval</span>(<span class="ruby-value str">&quot;@author = 'Catlin'&quot;</span>)
175:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;Catlin&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;= @author&quot;</span>).<span class="ruby-identifier">chomp</span>)
176:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000264" class="method">
  <div id="M000264_title" class="title">
    <b>test_rendered_string_is_html_safe</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000264_source')" id="l_M000264_source">show source</a> ]</p>
  <div id="M000264_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 287</span>
287:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_rendered_string_is_html_safe</span>
288:       <span class="ruby-identifier">assert</span>(<span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;Foo&quot;</span>).<span class="ruby-identifier">html_safe?</span>)
289:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000265" class="method">
  <div id="M000265_title" class="title">
    <b>test_rendered_string_is_html_safe_with_action_view</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000265_source')" id="l_M000265_source">show source</a> ]</p>
  <div id="M000265_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 291</span>
291:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_rendered_string_is_html_safe_with_action_view</span>
292:       <span class="ruby-identifier">assert</span>(<span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;Foo&quot;</span>, <span class="ruby-identifier">:action_view</span>).<span class="ruby-identifier">html_safe?</span>)
293:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000252" class="method">
  <div id="M000252_title" class="title">
    <b>test_template_renders_should_eval</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000252_source')" id="l_M000252_source">show source</a> ]</p>
  <div id="M000252_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 183</span>
183:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_template_renders_should_eval</span>
184:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;2\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;= 1+1&quot;</span>))
185:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000248" class="method">
  <div id="M000248_title" class="title">
    <b>test_templates_should_render_correctly_with_def_method</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000248_source')" id="l_M000248_source">show source</a> ]</p>
  <div id="M000248_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 139</span>
139:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_templates_should_render_correctly_with_def_method</span>
140:     <span class="ruby-identifier">assert_renders_correctly</span>(<span class="ruby-value str">&quot;standard&quot;</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">name</span><span class="ruby-operator">|</span>
141:       <span class="ruby-identifier">engine</span> = <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Engine</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>(<span class="ruby-keyword kw">__FILE__</span>) <span class="ruby-operator">+</span> <span class="ruby-node">&quot;/templates/#{name}.haml&quot;</span>))
142:       <span class="ruby-identifier">engine</span>.<span class="ruby-identifier">def_method</span>(<span class="ruby-ivar">@base</span>, <span class="ruby-value str">&quot;render_standard&quot;</span>)
143:       <span class="ruby-ivar">@base</span>.<span class="ruby-identifier">render_standard</span>
144:     <span class="ruby-keyword kw">end</span>
145:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000247" class="method">
  <div id="M000247_title" class="title">
    <b>test_templates_should_render_correctly_with_render_proc</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000247_source')" id="l_M000247_source">show source</a> ]</p>
  <div id="M000247_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 132</span>
132:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_templates_should_render_correctly_with_render_proc</span>
133:     <span class="ruby-identifier">assert_renders_correctly</span>(<span class="ruby-value str">&quot;standard&quot;</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">name</span><span class="ruby-operator">|</span>
134:       <span class="ruby-identifier">engine</span> = <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Engine</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>(<span class="ruby-keyword kw">__FILE__</span>) <span class="ruby-operator">+</span> <span class="ruby-node">&quot;/templates/#{name}.haml&quot;</span>))
135:       <span class="ruby-identifier">engine</span>.<span class="ruby-identifier">render_proc</span>(<span class="ruby-ivar">@base</span>).<span class="ruby-identifier">call</span>
136:     <span class="ruby-keyword kw">end</span>
137:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000254" class="method">
  <div id="M000254_title" class="title">
    <b>test_with_output_buffer_with_ugly</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000254_source')" id="l_M000254_source">show source</a> ]</p>
  <div id="M000254_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 197</span>
197:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_with_output_buffer_with_ugly</span>
198:     <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Util</span>.<span class="ruby-identifier">has?</span>(<span class="ruby-identifier">:instance_method</span>, <span class="ruby-constant">ActionView</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>, <span class="ruby-identifier">:with_output_buffer</span>)
199:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p&gt;\nfoo\nbaz\n&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p\n  foo\n  - with_output_buffer do\n    bar\n    = \&quot;foo\&quot;.gsub(/./) do |s|\n      - \&quot;flup\&quot;\n  baz\n&quot;</span>, <span class="ruby-identifier">:ugly</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>))
200:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000266" class="method">
  <div id="M000266_title" class="title">
    <b>test_xss_html_escaping_with_non_strings</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000266_source')" id="l_M000266_source">show source</a> ]</p>
  <div id="M000266_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 295</span>
295:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_xss_html_escaping_with_non_strings</span>
296:       <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;4\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;= html_escape(4)&quot;</span>))
297:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000257" class="method">
  <div id="M000257_title" class="title">
    <b>test_xss_protection</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000257_source')" id="l_M000257_source">show source</a> ]</p>
  <div id="M000257_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 259</span>
259:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_xss_protection</span>
260:       <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;Foo &amp;amp; Bar\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">'= &quot;Foo &amp; Bar&quot;'</span>, <span class="ruby-identifier">:action_view</span>))
261:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000260" class="method">
  <div id="M000260_title" class="title">
    <b>test_xss_protection_in_interpolation</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000260_source')" id="l_M000260_source">show source</a> ]</p>
  <div id="M000260_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 271</span>
271:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_xss_protection_in_interpolation</span>
272:       <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;Foo &amp;amp; Bar\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">'Foo #{&quot;&amp;&quot;} Bar'</span>, <span class="ruby-identifier">:action_view</span>))
273:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000259" class="method">
  <div id="M000259_title" class="title">
    <b>test_xss_protection_with_bang</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000259_source')" id="l_M000259_source">show source</a> ]</p>
  <div id="M000259_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 267</span>
267:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_xss_protection_with_bang</span>
268:       <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;Foo &amp; Bar\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">'!= &quot;Foo &amp; Bar&quot;'</span>, <span class="ruby-identifier">:action_view</span>))
269:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000261" class="method">
  <div id="M000261_title" class="title">
    <b>test_xss_protection_with_bang_in_interpolation</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000261_source')" id="l_M000261_source">show source</a> ]</p>
  <div id="M000261_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 275</span>
275:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_xss_protection_with_bang_in_interpolation</span>
276:       <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;Foo &amp; Bar\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">'! Foo #{&quot;&amp;&quot;} Bar'</span>, <span class="ruby-identifier">:action_view</span>))
277:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000263" class="method">
  <div id="M000263_title" class="title">
    <b>test_xss_protection_with_mixed_strings_in_interpolation</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000263_source')" id="l_M000263_source">show source</a> ]</p>
  <div id="M000263_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 283</span>
283:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_xss_protection_with_mixed_strings_in_interpolation</span>
284:       <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;Foo &amp; Bar &amp;amp; Baz\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">'Foo #{&quot;&amp;&quot;.html_safe!} Bar #{&quot;&amp;&quot;} Baz'</span>, <span class="ruby-identifier">:action_view</span>))
285:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000258" class="method">
  <div id="M000258_title" class="title">
    <b>test_xss_protection_with_safe_strings</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000258_source')" id="l_M000258_source">show source</a> ]</p>
  <div id="M000258_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 263</span>
263:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_xss_protection_with_safe_strings</span>
264:       <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;Foo &amp; Bar\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">'= &quot;Foo &amp; Bar&quot;.html_safe!'</span>, <span class="ruby-identifier">:action_view</span>))
265:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000262" class="method">
  <div id="M000262_title" class="title">
    <b>test_xss_protection_with_safe_strings_in_interpolation</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000262_source')" id="l_M000262_source">show source</a> ]</p>
  <div id="M000262_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 279</span>
279:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_xss_protection_with_safe_strings_in_interpolation</span>
280:       <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;Foo &amp; Bar\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">'Foo #{&quot;&amp;&quot;.html_safe!} Bar'</span>, <span class="ruby-identifier">:action_view</span>))
281:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
</div>

  </div>