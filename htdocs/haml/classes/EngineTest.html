  <div id="C00000003">
<div class='banner'>
  <span class="file-title-prefix">Class</span><br />EngineTest<br/>
  In:
<a href="#" onclick="jsHref('files/test/haml/engine_test_rb.html');">test/haml/engine_test.rb</a>

Parent:&nbsp;
Test::Unit::TestCase
</div>
 <!-- banner header -->

  <div id="bodyContent" >
      <div id="content">




  <div class="sectiontitle">Methods</div>
  <ul>
  <li><a href="index.html?a=M000034&name=engine" >engine</a></li>
  <li><a href="index.html?a=M000033&name=render" >render</a></li>
  <li><a href="index.html?a=M000058&name=test_ampersand_equals_inline_should_escape" >test_ampersand_equals_inline_should_escape</a></li>
  <li><a href="index.html?a=M000057&name=test_ampersand_equals_should_escape" >test_ampersand_equals_should_escape</a></li>
  <li><a href="index.html?a=M000059&name=test_ampersand_equals_should_escape_before_preserve" >test_ampersand_equals_should_escape_before_preserve</a></li>
  <li><a href="index.html?a=M000108&name=test_arbitrary_output_option" >test_arbitrary_output_option</a></li>
  <li><a href="index.html?a=M000049&name=test_attr_hashes_not_modified" >test_attr_hashes_not_modified</a></li>
  <li><a href="index.html?a=M000076&name=test_attr_wrapper" >test_attr_wrapper</a></li>
  <li><a href="index.html?a=M000036&name=test_attributes_should_render_correctly" >test_attributes_should_render_correctly</a></li>
  <li><a href="index.html?a=M000077&name=test_attrs_parsed_correctly" >test_attrs_parsed_correctly</a></li>
  <li><a href="index.html?a=M000106&name=test_auto_preserve_unless_ugly" >test_auto_preserve_unless_ugly</a></li>
  <li><a href="index.html?a=M000091&name=test_balanced_conditional_comments" >test_balanced_conditional_comments</a></li>
  <li><a href="index.html?a=M000061&name=test_bang_equals_inline_should_not_escape" >test_bang_equals_inline_should_not_escape</a></li>
  <li><a href="index.html?a=M000060&name=test_bang_equals_should_not_escape" >test_bang_equals_should_not_escape</a></li>
  <li><a href="index.html?a=M000053&name=test_boolean_attributes" >test_boolean_attributes</a></li>
  <li><a href="index.html?a=M000056&name=test_both_case_indentation_work_with_deeply_nested_code" >test_both_case_indentation_work_with_deeply_nested_code</a></li>
  <li><a href="index.html?a=M000055&name=test_both_whitespace_nukes_work_together" >test_both_whitespace_nukes_work_together</a></li>
  <li><a href="index.html?a=M000089&name=test_compile_error" >test_compile_error</a></li>
  <li><a href="index.html?a=M000078&name=test_correct_parsing_with_brackets" >test_correct_parsing_with_brackets</a></li>
  <li><a href="index.html?a=M000051&name=test_cr_newline" >test_cr_newline</a></li>
  <li><a href="index.html?a=M000102&name=test_def_method_locals" >test_def_method_locals</a></li>
  <li><a href="index.html?a=M000101&name=test_def_method_with_module" >test_def_method_with_module</a></li>
  <li><a href="index.html?a=M000075&name=test_doctypes" >test_doctypes</a></li>
  <li><a href="index.html?a=M000043&name=test_double_equals" >test_double_equals</a></li>
  <li><a href="index.html?a=M000044&name=test_double_equals_in_the_middle_of_a_string" >test_double_equals_in_the_middle_of_a_string</a></li>
  <li><a href="index.html?a=M000063&name=test_dynamic_attributes_should_be_escaped" >test_dynamic_attributes_should_be_escaped</a></li>
  <li><a href="index.html?a=M000048&name=test_dynamic_attributes_with_empty_attr" >test_dynamic_attributes_with_empty_attr</a></li>
  <li><a href="index.html?a=M000084&name=test_dynamic_attrs_shouldnt_register_as_literal_values" >test_dynamic_attrs_shouldnt_register_as_literal_values</a></li>
  <li><a href="index.html?a=M000085&name=test_dynamic_attrs_with_self_closed_tag" >test_dynamic_attrs_with_self_closed_tag</a></li>
  <li><a href="index.html?a=M000079&name=test_empty_attrs" >test_empty_attrs</a></li>
  <li><a href="index.html?a=M000092&name=test_empty_filter" >test_empty_filter</a></li>
  <li><a href="index.html?a=M000035&name=test_empty_render_should_remain_empty" >test_empty_render_should_remain_empty</a></li>
  <li><a href="index.html?a=M000050&name=test_end_of_file_multiline" >test_end_of_file_multiline</a></li>
  <li><a href="index.html?a=M000065&name=test_escaped_inline_string_interpolation" >test_escaped_inline_string_interpolation</a></li>
  <li><a href="index.html?a=M000067&name=test_escaped_string_interpolation" >test_escaped_string_interpolation</a></li>
  <li><a href="index.html?a=M000088&name=test_exception" >test_exception</a></li>
  <li><a href="index.html?a=M000087&name=test_exception_line" >test_exception_line</a></li>
  <li><a href="index.html?a=M000086&name=test_exceptions" >test_exceptions</a></li>
  <li><a href="index.html?a=M000073&name=test_filename_and_line" >test_filename_and_line</a></li>
  <li><a href="index.html?a=M000115&name=test_html5_doctype" >test_html5_doctype</a></li>
  <li><a href="index.html?a=M000111&name=test_html_doesnt_add_slash_to_self_closing_tags" >test_html_doesnt_add_slash_to_self_closing_tags</a></li>
  <li><a href="index.html?a=M000113&name=test_html_has_different_doctype" >test_html_has_different_doctype</a></li>
  <li><a href="index.html?a=M000109&name=test_html_has_no_self_closing_tags" >test_html_has_no_self_closing_tags</a></li>
  <li><a href="index.html?a=M000112&name=test_html_ignores_xml_prolog_declaration" >test_html_ignores_xml_prolog_declaration</a></li>
  <li><a href="index.html?a=M000110&name=test_html_renders_empty_node_with_closing_tag" >test_html_renders_empty_node_with_closing_tag</a></li>
  <li><a href="index.html?a=M000070&name=test_inline_scripts_should_respect_escape_html_option" >test_inline_scripts_should_respect_escape_html_option</a></li>
  <li><a href="index.html?a=M000094&name=test_local_assigns_dont_modify_class" >test_local_assigns_dont_modify_class</a></li>
  <li><a href="index.html?a=M000083&name=test_locals" >test_locals</a></li>
  <li><a href="index.html?a=M000042&name=test_multi_render" >test_multi_render</a></li>
  <li><a href="index.html?a=M000080&name=test_nil_attrs" >test_nil_attrs</a></li>
  <li><a href="index.html?a=M000082&name=test_nil_class_with_syntactic_class" >test_nil_class_with_syntactic_class</a></li>
  <li><a href="index.html?a=M000081&name=test_nil_id_with_syntactic_id" >test_nil_id_with_syntactic_id</a></li>
  <li><a href="index.html?a=M000038&name=test_nil_should_render_empty_tag" >test_nil_should_render_empty_tag</a></li>
  <li><a href="index.html?a=M000045&name=test_nil_tag_value_should_render_as_empty" >test_nil_tag_value_should_render_as_empty</a></li>
  <li><a href="index.html?a=M000097&name=test_non_literal_attributes" >test_non_literal_attributes</a></li>
  <li><a href="index.html?a=M000096&name=test_object_ref_before_attrs" >test_object_ref_before_attrs</a></li>
  <li><a href="index.html?a=M000095&name=test_object_ref_with_nil_id" >test_object_ref_with_nil_id</a></li>
  <li><a href="index.html?a=M000040&name=test_one_liner_should_be_one_line" >test_one_liner_should_be_one_line</a></li>
  <li><a href="index.html?a=M000041&name=test_one_liner_with_newline_shouldnt_be_one_line" >test_one_liner_with_newline_shouldnt_be_one_line</a></li>
  <li><a href="index.html?a=M000103&name=test_render_proc_locals" >test_render_proc_locals</a></li>
  <li><a href="index.html?a=M000104&name=test_render_proc_with_binding" >test_render_proc_with_binding</a></li>
  <li><a href="index.html?a=M000098&name=test_render_should_accept_a_binding_as_scope" >test_render_should_accept_a_binding_as_scope</a></li>
  <li><a href="index.html?a=M000037&name=test_ruby_code_should_work_inside_attributes" >test_ruby_code_should_work_inside_attributes</a></li>
  <li><a href="index.html?a=M000071&name=test_script_ending_in_comment_should_render_when_html_is_escaped" >test_script_ending_in_comment_should_render_when_html_is_escaped</a></li>
  <li><a href="index.html?a=M000072&name=test_script_with_if_shouldnt_output" >test_script_with_if_shouldnt_output</a></li>
  <li><a href="index.html?a=M000069&name=test_scripts_should_respect_escape_html_option" >test_scripts_should_respect_escape_html_option</a></li>
  <li><a href="index.html?a=M000062&name=test_static_attributes_should_be_escaped" >test_static_attributes_should_be_escaped</a></li>
  <li><a href="index.html?a=M000047&name=test_static_attributes_with_empty_attr" >test_static_attributes_with_empty_attr</a></li>
  <li><a href="index.html?a=M000074&name=test_stop_eval" >test_stop_eval</a></li>
  <li><a href="index.html?a=M000064&name=test_string_interpolation_should_be_esaped" >test_string_interpolation_should_be_esaped</a></li>
  <li><a href="index.html?a=M000039&name=test_strings_should_get_stripped_inside_tags" >test_strings_should_get_stripped_inside_tags</a></li>
  <li><a href="index.html?a=M000046&name=test_tag_with_failed_if_should_render_as_empty" >test_tag_with_failed_if_should_render_as_empty</a></li>
  <li><a href="index.html?a=M000052&name=test_textareas" >test_textareas</a></li>
  <li><a href="index.html?a=M000093&name=test_ugly_filter" >test_ugly_filter</a></li>
  <li><a href="index.html?a=M000105&name=test_ugly_true" >test_ugly_true</a></li>
  <li><a href="index.html?a=M000090&name=test_unbalanced_brackets" >test_unbalanced_brackets</a></li>
  <li><a href="index.html?a=M000066&name=test_unescaped_inline_string_interpolation" >test_unescaped_inline_string_interpolation</a></li>
  <li><a href="index.html?a=M000068&name=test_unescaped_string_interpolation" >test_unescaped_string_interpolation</a></li>
  <li><a href="index.html?a=M000054&name=test_whitespace_nuke_with_both_newlines" >test_whitespace_nuke_with_both_newlines</a></li>
  <li><a href="index.html?a=M000107&name=test_xhtml_output_option" >test_xhtml_output_option</a></li>
  <li><a href="index.html?a=M000114&name=test_xml_prolog_and_doctype_dont_result_in_a_leading_whitespace_in_html" >test_xml_prolog_and_doctype_dont_result_in_a_leading_whitespace_in_html</a></li>
  <li><a href="index.html?a=M000099&name=test_yield_should_work_with_binding" >test_yield_should_work_with_binding</a></li>
  <li><a href="index.html?a=M000100&name=test_yield_should_work_with_def_method" >test_yield_should_work_with_def_method</a></li>
  </ul>




  <div class="sectiontitle">Constants</div>
  <table border='0' cellpadding='5'>
  <tr valign='top'>
    <td class="attr-name">EXCEPTION_MAP</td>
    <td>=</td>
    <td class="attr-value">{     &quot;!!!\n  a&quot; =&gt; &quot;Illegal nesting: nesting within a header command is illegal.&quot;,     &quot;a\n  b&quot; =&gt; &quot;Illegal nesting: nesting within plain text is illegal.&quot;,     &quot;/ a\n  b&quot; =&gt; &quot;Illegal nesting: nesting within a tag that already has content is illegal.&quot;,     &quot;% a&quot; =&gt; 'Invalid tag: &quot;% a&quot;.',     &quot;%p a\n  b&quot; =&gt; &quot;Illegal nesting: content can't be both given on the same line as %p and nested within it.&quot;,     &quot;%p=&quot; =&gt; &quot;There's no Ruby code for = to evaluate.&quot;,     &quot;%p~&quot; =&gt; &quot;There's no Ruby code for ~ to evaluate.&quot;,     &quot;~&quot; =&gt; &quot;There's no Ruby code for ~ to evaluate.&quot;,     &quot;=&quot; =&gt; &quot;There's no Ruby code for = to evaluate.&quot;,     &quot;%p/\n  a&quot; =&gt; &quot;Illegal nesting: nesting within a self-closing tag is illegal.&quot;,     &quot;%p\n\ta&quot; =&gt; &lt;&lt;END.strip, A tab character was used for indentation. Haml must be indented using two spaces. Are you sure you have soft tabs enabled in your editor? END .strip,     &quot;%p\n a&quot; =&gt; &quot;1 space was used for indentation. Haml must be indented using two spaces.&quot;,     &quot;%p\n   a&quot; =&gt; &quot;3 spaces were used for indentation. Haml must be indented using two spaces.&quot;,     &quot;%p\n    a&quot; =&gt; &quot;4 spaces were used for indentation. Haml must be indented using two spaces.&quot;,     &quot;:a\n  b&quot; =&gt; ['Filter &quot;a&quot; is not defined.', 1],     &quot;:a= b&quot; =&gt; 'Invalid filter name &quot;:a= b&quot;.',     &quot;.&quot; =&gt; &quot;Illegal element: classes and ids must have values.&quot;,     &quot;.#&quot; =&gt; &quot;Illegal element: classes and ids must have values.&quot;,     &quot;.{} a&quot; =&gt; &quot;Illegal element: classes and ids must have values.&quot;,     &quot;.= a&quot; =&gt; &quot;Illegal element: classes and ids must have values.&quot;,     &quot;%p..a&quot; =&gt; &quot;Illegal element: classes and ids must have values.&quot;,     &quot;%a/ b&quot; =&gt; &quot;Self-closing tags can't have content.&quot;,     &quot; %p foo&quot; =&gt; &quot;Indenting at the beginning of the document is illegal.&quot;,     &quot;  %p foo&quot; =&gt; &quot;Indenting at the beginning of the document is illegal.&quot;,     &quot;- end&quot; =&gt; &quot;You don't need to use \&quot;- end\&quot; in Haml. Use indentation instead:\n- if foo?\n  %strong Foo!\n- else\n  Not foo.&quot;,     &quot; \n\t\n %p foo&quot; =&gt; [&quot;Indenting at the beginning of the document is illegal.&quot;, 3],      # Regression tests     &quot;- raise 'foo'\n\n\n\nbar&quot; =&gt; [&quot;foo&quot;, 1],     &quot;= 'foo'\n-raise 'foo'&quot; =&gt; [&quot;foo&quot;, 2],     &quot;\n\n\n- raise 'foo'&quot; =&gt; [&quot;foo&quot;, 4],     &quot;foo\n\n\n  bar&quot; =&gt; [&quot;Illegal nesting: nesting within plain text is illegal.&quot;, 4],     &quot;%p/\n\n  bar&quot; =&gt; [&quot;Illegal nesting: nesting within a self-closing tag is illegal.&quot;, 3],     &quot;%p foo\n\n  bar&quot; =&gt; [&quot;Illegal nesting: content can't be both given on the same line as %p and nested within it.&quot;, 3],     &quot;/ foo\n\n  bar&quot; =&gt; [&quot;Illegal nesting: nesting within a tag that already has content is illegal.&quot;, 3],     &quot;!!!\n\n  bar&quot; =&gt; [&quot;Illegal nesting: nesting within a header command is illegal.&quot;, 3],     &quot;foo\n\n\n\tbar&quot; =&gt; [&lt;&lt;END.strip, 4], A tab character was used for indentation. Haml must be indented using two spaces. Are you sure you have soft tabs enabled in your editor? END .strip, 4],     &quot;foo\n:ruby\n  1\n  2\n  3\n- raise 'foo'&quot; =&gt; [&quot;foo&quot;, 6],   }</td>
  </tr>
  <tr valign='top'>
    <td>&nbsp;</td>
    <td colspan="2" class="attr-desc">
A map of erroneous <a href="index.html?a=C00000016&name=Haml">Haml</a>
documents to the error messages they should produce. The error messages may
be arrays; if so, the second element should be the line number that should
be reported for the error. If this isn&#8217;t provided, the tests will
assume the line number should be the last line of the document.

</td>
  </tr>
  <tr valign='top'>
    <td class="attr-name">User</td>
    <td>=</td>
    <td class="attr-value">Struct.new('User', :id)</td>
  </tr>
  </table>


<div class="sectiontitle">Public Instance methods</div>
<div id="M000034" class="method">
  <div id="M000034_title" class="title">
    <b>engine</b>(text, options = {})
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000034_source')" id="l_M000034_source">show source</a> ]</p>
  <div id="M000034_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 66</span>
66:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">engine</span>(<span class="ruby-identifier">text</span>, <span class="ruby-identifier">options</span> = {})
67:     <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:filename</span>]
68:       <span class="ruby-comment cmt"># use caller method name as fake filename. useful for debugging</span>
69:       <span class="ruby-identifier">i</span> = <span class="ruby-value">-1</span>
70:       <span class="ruby-identifier">caller</span>[<span class="ruby-identifier">i</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>] <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/`(.+?)'/</span> <span class="ruby-keyword kw">until</span> <span class="ruby-identifier">$1</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">$1</span>.<span class="ruby-identifier">index</span>(<span class="ruby-value str">'test_'</span>) <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
71:       <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:filename</span>] = <span class="ruby-node">&quot;(#{$1})&quot;</span>
72:     <span class="ruby-keyword kw">end</span>
73:     <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Engine</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">text</span>, <span class="ruby-identifier">options</span>)
74:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000033" class="method">
  <div id="M000033_title" class="title">
    <b>render</b>(text, options = {}, &amp;block)
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000033_source')" id="l_M000033_source">show source</a> ]</p>
  <div id="M000033_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 60</span>
60:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">render</span>(<span class="ruby-identifier">text</span>, <span class="ruby-identifier">options</span> = {}, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
61:     <span class="ruby-identifier">scope</span>  = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">:scope</span>)  <span class="ruby-operator">||</span> <span class="ruby-constant">Object</span>.<span class="ruby-identifier">new</span>
62:     <span class="ruby-identifier">locals</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">:locals</span>) <span class="ruby-operator">||</span> {}
63:     <span class="ruby-identifier">engine</span>(<span class="ruby-identifier">text</span>, <span class="ruby-identifier">options</span>).<span class="ruby-identifier">to_html</span>(<span class="ruby-identifier">scope</span>, <span class="ruby-identifier">locals</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
64:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000058" class="method">
  <div id="M000058_title" class="title">
    <b>test_ampersand_equals_inline_should_escape</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000058_source')" id="l_M000058_source">show source</a> ]</p>
  <div id="M000058_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 259</span>
259:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_ampersand_equals_inline_should_escape</span>
260:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p&gt;foo &amp;amp; bar&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p&amp;= 'foo &amp; bar'&quot;</span>, <span class="ruby-identifier">:escape_html</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">false</span>))
261:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000057" class="method">
  <div id="M000057_title" class="title">
    <b>test_ampersand_equals_should_escape</b>()
  </div>
  <div class="description">
  <p>
HTML escaping tests
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000057_source')" id="l_M000057_source">show source</a> ]</p>
  <div id="M000057_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 255</span>
255:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_ampersand_equals_should_escape</span>
256:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p&gt;\n  foo &amp;amp; bar\n&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p\n  &amp;= 'foo &amp; bar'&quot;</span>, <span class="ruby-identifier">:escape_html</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">false</span>))
257:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000059" class="method">
  <div id="M000059_title" class="title">
    <b>test_ampersand_equals_should_escape_before_preserve</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000059_source')" id="l_M000059_source">show source</a> ]</p>
  <div id="M000059_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 263</span>
263:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_ampersand_equals_should_escape_before_preserve</span>
264:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;textarea&gt;foo&amp;#x000A;bar&lt;/textarea&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">'%textarea&amp;= &quot;foo\nbar&quot;'</span>, <span class="ruby-identifier">:escape_html</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">false</span>))
265:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000108" class="method">
  <div id="M000108_title" class="title">
    <b>test_arbitrary_output_option</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000108_source')" id="l_M000108_source">show source</a> ]</p>
  <div id="M000108_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 633</span>
633:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_arbitrary_output_option</span>
634:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Error</span>, <span class="ruby-value str">&quot;Invalid output format :html1&quot;</span>) { <span class="ruby-identifier">engine</span>(<span class="ruby-value str">&quot;%br&quot;</span>, <span class="ruby-identifier">:format</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:html1</span>) }
635:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000049" class="method">
  <div id="M000049_title" class="title">
    <b>test_attr_hashes_not_modified</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000049_source')" id="l_M000049_source">show source</a> ]</p>
  <div id="M000049_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 140</span>
140:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_attr_hashes_not_modified</span>
141:     <span class="ruby-identifier">hash</span> = {<span class="ruby-identifier">:color</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'red'</span>}
142:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;div color='red'&gt;&lt;/div&gt;\n&lt;div class='special' color='red'&gt;&lt;/div&gt;\n&lt;div color='red'&gt;&lt;/div&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%div{hash}\n.special{hash}\n%div{hash}\n&quot;</span>, <span class="ruby-identifier">:locals</span> =<span class="ruby-operator">&gt;</span> {<span class="ruby-identifier">:hash</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">hash</span>}))
143:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-identifier">hash</span>, {<span class="ruby-identifier">:color</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'red'</span>})
144:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000076" class="method">
  <div id="M000076_title" class="title">
    <b>test_attr_wrapper</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000076_source')" id="l_M000076_source">show source</a> ]</p>
  <div id="M000076_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 400</span>
400:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_attr_wrapper</span>
401:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p strange=*attrs*&gt;&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p{ :strange =&gt; 'attrs'}&quot;</span>, <span class="ruby-identifier">:attr_wrapper</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'*'</span>))
402:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p escaped='quo\&quot;te'&gt;&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p{ :escaped =&gt; 'quo\&quot;te'}&quot;</span>, <span class="ruby-identifier">:attr_wrapper</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'&quot;'</span>))
403:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p escaped=\&quot;quo'te\&quot;&gt;&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p{ :escaped =&gt; 'quo\\'te'}&quot;</span>, <span class="ruby-identifier">:attr_wrapper</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'&quot;'</span>))
404:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p escaped=\&quot;q'uo&amp;quot;te\&quot;&gt;&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p{ :escaped =&gt; 'q\\'uo\&quot;te'}&quot;</span>, <span class="ruby-identifier">:attr_wrapper</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'&quot;'</span>))
405:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;utf-8\&quot; ?&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;!!! XML&quot;</span>, <span class="ruby-identifier">:attr_wrapper</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'&quot;'</span>))
406:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000036" class="method">
  <div id="M000036_title" class="title">
    <b>test_attributes_should_render_correctly</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000036_source')" id="l_M000036_source">show source</a> ]</p>
  <div id="M000036_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 80</span>
80:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_attributes_should_render_correctly</span>
81:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;div class='atlantis' style='ugly'&gt;&lt;/div&gt;&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;.atlantis{:style =&gt; 'ugly'}&quot;</span>).<span class="ruby-identifier">chomp</span>)
82:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000077" class="method">
  <div id="M000077_title" class="title">
    <b>test_attrs_parsed_correctly</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000077_source')" id="l_M000077_source">show source</a> ]</p>
  <div id="M000077_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 408</span>
408:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_attrs_parsed_correctly</span>
409:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p boom=&gt;biddly='bar =&amp;gt; baz'&gt;&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p{'boom=&gt;biddly' =&gt; 'bar =&gt; baz'}&quot;</span>))
410:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p foo,bar='baz, qux'&gt;&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p{'foo,bar' =&gt; 'baz, qux'}&quot;</span>))
411:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p escaped='quo&amp;#x000A;te'&gt;&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p{ :escaped =&gt; \&quot;quo\\nte\&quot;}&quot;</span>))
412:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p escaped='quo4te'&gt;&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p{ :escaped =&gt; \&quot;quo\#{2 + 2}te\&quot;}&quot;</span>))
413:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000106" class="method">
  <div id="M000106_title" class="title">
    <b>test_auto_preserve_unless_ugly</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000106_source')" id="l_M000106_source">show source</a> ]</p>
  <div id="M000106_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 621</span>
621:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_auto_preserve_unless_ugly</span>
622:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;pre&gt;foo&amp;#x000A;bar&lt;/pre&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">'%pre=&quot;foo\nbar&quot;'</span>))
623:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;pre&gt;foo\nbar&lt;/pre&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%pre\n  foo\n  bar&quot;</span>))
624:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;pre&gt;foo\nbar&lt;/pre&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">'%pre=&quot;foo\nbar&quot;'</span>, <span class="ruby-identifier">:ugly</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>))
625:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;pre&gt;foo\nbar&lt;/pre&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%pre\n  foo\n  bar&quot;</span>, <span class="ruby-identifier">:ugly</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>))
626:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000091" class="method">
  <div id="M000091_title" class="title">
    <b>test_balanced_conditional_comments</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000091_source')" id="l_M000091_source">show source</a> ]</p>
  <div id="M000091_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 521</span>
521:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_balanced_conditional_comments</span>
522:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;!--[if !(IE 6)|(IE 7)]&gt; Bracket: ] &lt;![endif]--&gt;\n&quot;</span>,
523:                  <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;/[if !(IE 6)|(IE 7)] Bracket: ]&quot;</span>))
524:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000061" class="method">
  <div id="M000061_title" class="title">
    <b>test_bang_equals_inline_should_not_escape</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000061_source')" id="l_M000061_source">show source</a> ]</p>
  <div id="M000061_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 271</span>
271:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_bang_equals_inline_should_not_escape</span>
272:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p&gt;foo &amp; bar&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p!= 'foo &amp; bar'&quot;</span>, <span class="ruby-identifier">:escape_html</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>))
273:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000060" class="method">
  <div id="M000060_title" class="title">
    <b>test_bang_equals_should_not_escape</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000060_source')" id="l_M000060_source">show source</a> ]</p>
  <div id="M000060_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 267</span>
267:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_bang_equals_should_not_escape</span>
268:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p&gt;\n  foo &amp; bar\n&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p\n  != 'foo &amp; bar'&quot;</span>, <span class="ruby-identifier">:escape_html</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>))
269:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000053" class="method">
  <div id="M000053_title" class="title">
    <b>test_boolean_attributes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000053_source')" id="l_M000053_source">show source</a> ]</p>
  <div id="M000053_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 184</span>
184:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_boolean_attributes</span>
185:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p bar baz='true' foo='bar'&gt;&lt;/p&gt;\n&quot;</span>,
186:                  <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p{:foo =&gt; 'bar', :bar =&gt; true, :baz =&gt; 'true'}&quot;</span>, <span class="ruby-identifier">:format</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:html4</span>))
187:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p bar='bar' baz='true' foo='bar'&gt;&lt;/p&gt;\n&quot;</span>,
188:                  <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p{:foo =&gt; 'bar', :bar =&gt; true, :baz =&gt; 'true'}&quot;</span>, <span class="ruby-identifier">:format</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:xhtml</span>))
189: 
190:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p baz='false' foo='bar'&gt;&lt;/p&gt;\n&quot;</span>,
191:                  <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p{:foo =&gt; 'bar', :bar =&gt; false, :baz =&gt; 'false'}&quot;</span>, <span class="ruby-identifier">:format</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:html4</span>))
192:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p baz='false' foo='bar'&gt;&lt;/p&gt;\n&quot;</span>,
193:                  <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p{:foo =&gt; 'bar', :bar =&gt; false, :baz =&gt; 'false'}&quot;</span>, <span class="ruby-identifier">:format</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:xhtml</span>))
194:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000056" class="method">
  <div id="M000056_title" class="title">
    <b>test_both_case_indentation_work_with_deeply_nested_code</b>()
  </div>
  <div class="description">
  <p>
Mostly a regression test
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000056_source')" id="l_M000056_source">show source</a> ]</p>
  <div id="M000056_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 224</span>
224:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_both_case_indentation_work_with_deeply_nested_code</span>
225:     <span class="ruby-identifier">result</span> = <span class="ruby-value str">&quot;&lt;h2&gt;\n  other\n&lt;/h2&gt;\n&quot;</span>
226:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-identifier">result</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;- case 'other'\n- when 'test'\n  %h2\n    hi\n- when 'other'\n  %h2\n    other\n&quot;</span>))
227:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-identifier">result</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;- case 'other'\n  - when 'test'\n    %h2\n      hi\n  - when 'other'\n    %h2\n      other\n&quot;</span>))
228:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000055" class="method">
  <div id="M000055_title" class="title">
    <b>test_both_whitespace_nukes_work_together</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000055_source')" id="l_M000055_source">show source</a> ]</p>
  <div id="M000055_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 211</span>
211:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_both_whitespace_nukes_work_together</span>
212:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p&gt;&lt;q&gt;Foo\n  Bar&lt;/q&gt;&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p\n  %q&gt;&lt;= \&quot;Foo\\\\nBar\&quot;\n&quot;</span>))
213:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000089" class="method">
  <div id="M000089_title" class="title">
    <b>test_compile_error</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000089_source')" id="l_M000089_source">show source</a> ]</p>
  <div id="M000089_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 506</span>
506:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_compile_error</span>
507:     <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;a\nb\n- fee)\nc&quot;</span>)
508:   <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">Exception</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
509:     <span class="ruby-identifier">assert_match</span>(<span class="ruby-regexp re">/\(test_compile_error\):3: syntax error/i</span>, <span class="ruby-identifier">e</span>.<span class="ruby-identifier">message</span>)
510:   <span class="ruby-keyword kw">else</span>
511:     <span class="ruby-identifier">assert</span>(<span class="ruby-keyword kw">false</span>,
512:            <span class="ruby-value str">'&quot;a\nb\n- fee)\nc&quot; doesn\'t produce an exception!'</span>)
513:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000078" class="method">
  <div id="M000078_title" class="title">
    <b>test_correct_parsing_with_brackets</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000078_source')" id="l_M000078_source">show source</a> ]</p>
  <div id="M000078_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 415</span>
415:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_correct_parsing_with_brackets</span>
416:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p class='foo'&gt;{tada} foo&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p{:class =&gt; 'foo'} {tada} foo&quot;</span>))
417:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p class='foo'&gt;deep {nested { things }}&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p{:class =&gt; 'foo'} deep {nested { things }}&quot;</span>))
418:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p class='bar foo'&gt;{a { d&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p{{:class =&gt; 'foo'}, :class =&gt; 'bar'} {a { d&quot;</span>))
419:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p foo='bar'&gt;a}&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p{:foo =&gt; 'bar'} a}&quot;</span>))
420:     
421:     <span class="ruby-identifier">foo</span> = []
422:     <span class="ruby-identifier">foo</span>[<span class="ruby-value">0</span>] = <span class="ruby-constant">Struct</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">'Foo'</span>, <span class="ruby-identifier">:id</span>).<span class="ruby-identifier">new</span>
423:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p class='struct_foo' id='struct_foo_new'&gt;New User]&lt;/p&gt;\n&quot;</span>,
424:                  <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p[foo[0]] New User]&quot;</span>, <span class="ruby-identifier">:locals</span> =<span class="ruby-operator">&gt;</span> {<span class="ruby-identifier">:foo</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">foo</span>}))
425:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p class='prefix_struct_foo' id='prefix_struct_foo_new'&gt;New User]&lt;/p&gt;\n&quot;</span>,
426:                  <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p[foo[0], :prefix] New User]&quot;</span>, <span class="ruby-identifier">:locals</span> =<span class="ruby-operator">&gt;</span> {<span class="ruby-identifier">:foo</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">foo</span>}))
427: 
428:     <span class="ruby-identifier">foo</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">id</span> = <span class="ruby-value">1</span>
429:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p class='struct_foo' id='struct_foo_1'&gt;New User]&lt;/p&gt;\n&quot;</span>,
430:                  <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p[foo[0]] New User]&quot;</span>, <span class="ruby-identifier">:locals</span> =<span class="ruby-operator">&gt;</span> {<span class="ruby-identifier">:foo</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">foo</span>}))
431:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p class='prefix_struct_foo' id='prefix_struct_foo_1'&gt;New User]&lt;/p&gt;\n&quot;</span>,
432:                  <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p[foo[0], :prefix] New User]&quot;</span>, <span class="ruby-identifier">:locals</span> =<span class="ruby-operator">&gt;</span> {<span class="ruby-identifier">:foo</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">foo</span>}))
433:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000051" class="method">
  <div id="M000051_title" class="title">
    <b>test_cr_newline</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000051_source')" id="l_M000051_source">show source</a> ]</p>
  <div id="M000051_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 160</span>
160:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_cr_newline</span>
161:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p&gt;foo&lt;/p&gt;\n&lt;p&gt;bar&lt;/p&gt;\n&lt;p&gt;baz&lt;/p&gt;\n&lt;p&gt;boom&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p foo\r%p bar\r\n%p baz\n\r%p boom&quot;</span>))
162:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000102" class="method">
  <div id="M000102_title" class="title">
    <b>test_def_method_locals</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000102_source')" id="l_M000102_source">show source</a> ]</p>
  <div id="M000102_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 595</span>
595:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_def_method_locals</span>
596:     <span class="ruby-identifier">obj</span> = <span class="ruby-constant">Object</span>.<span class="ruby-identifier">new</span>
597:     <span class="ruby-identifier">engine</span>(<span class="ruby-value str">&quot;%p= foo\n.bar{:baz =&gt; baz}= boom&quot;</span>).<span class="ruby-identifier">def_method</span>(<span class="ruby-identifier">obj</span>, <span class="ruby-identifier">:render</span>, <span class="ruby-identifier">:foo</span>, <span class="ruby-identifier">:baz</span>, <span class="ruby-identifier">:boom</span>)
598:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p&gt;1&lt;/p&gt;\n&lt;div baz='2' class='bar'&gt;3&lt;/div&gt;\n&quot;</span>, <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">render</span>(<span class="ruby-identifier">:foo</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">:baz</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">2</span>, <span class="ruby-identifier">:boom</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">3</span>))
599:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000101" class="method">
  <div id="M000101_title" class="title">
    <b>test_def_method_with_module</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000101_source')" id="l_M000101_source">show source</a> ]</p>
  <div id="M000101_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 590</span>
590:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_def_method_with_module</span>
591:     <span class="ruby-identifier">engine</span>(<span class="ruby-value str">&quot;= yield\n= upcase&quot;</span>).<span class="ruby-identifier">def_method</span>(<span class="ruby-constant">String</span>, <span class="ruby-identifier">:render_haml</span>)
592:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;12\nFOO\n&quot;</span>, <span class="ruby-value str">&quot;foo&quot;</span>.<span class="ruby-identifier">render_haml</span> { <span class="ruby-value">12</span> })
593:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000075" class="method">
  <div id="M000075_title" class="title">
    <b>test_doctypes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000075_source')" id="l_M000075_source">show source</a> ]</p>
  <div id="M000075_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 375</span>
375:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_doctypes</span>
376:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">'&lt;!DOCTYPE html&gt;'</span>,
377:       <span class="ruby-identifier">render</span>(<span class="ruby-value str">'!!!'</span>, <span class="ruby-identifier">:format</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:html5</span>).<span class="ruby-identifier">strip</span>)
378:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">'&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;'</span>,
379:       <span class="ruby-identifier">render</span>(<span class="ruby-value str">'!!! strict'</span>).<span class="ruby-identifier">strip</span>)
380:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">'&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Frameset//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-frameset.dtd&quot;&gt;'</span>,
381:       <span class="ruby-identifier">render</span>(<span class="ruby-value str">'!!! frameset'</span>).<span class="ruby-identifier">strip</span>)
382:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">'&lt;!DOCTYPE html PUBLIC &quot;-//WAPFORUM//DTD XHTML Mobile 1.2//EN&quot; &quot;http://www.openmobilealliance.org/tech/DTD/xhtml-mobile12.dtd&quot;&gt;'</span>,
383:       <span class="ruby-identifier">render</span>(<span class="ruby-value str">'!!! mobile'</span>).<span class="ruby-identifier">strip</span>)
384:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">'&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML Basic 1.1//EN&quot; &quot;http://www.w3.org/TR/xhtml-basic/xhtml-basic11.dtd&quot;&gt;'</span>,
385:       <span class="ruby-identifier">render</span>(<span class="ruby-value str">'!!! basic'</span>).<span class="ruby-identifier">strip</span>)
386:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">'&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;'</span>,
387:       <span class="ruby-identifier">render</span>(<span class="ruby-value str">'!!! transitional'</span>).<span class="ruby-identifier">strip</span>)
388:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">'&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;'</span>,
389:       <span class="ruby-identifier">render</span>(<span class="ruby-value str">'!!!'</span>).<span class="ruby-identifier">strip</span>)
390:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">'&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD HTML 4.01//EN&quot; &quot;http://www.w3.org/TR/html4/strict.dtd&quot;&gt;'</span>,
391:       <span class="ruby-identifier">render</span>(<span class="ruby-value str">'!!! strict'</span>, <span class="ruby-identifier">:format</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:html4</span>).<span class="ruby-identifier">strip</span>)
392:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">'&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD HTML 4.01 Frameset//EN&quot; &quot;http://www.w3.org/TR/html4/frameset.dtd&quot;&gt;'</span>,
393:       <span class="ruby-identifier">render</span>(<span class="ruby-value str">'!!! frameset'</span>, <span class="ruby-identifier">:format</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:html4</span>).<span class="ruby-identifier">strip</span>)
394:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">'&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot; &quot;http://www.w3.org/TR/html4/loose.dtd&quot;&gt;'</span>,
395:       <span class="ruby-identifier">render</span>(<span class="ruby-value str">'!!! transitional'</span>, <span class="ruby-identifier">:format</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:html4</span>).<span class="ruby-identifier">strip</span>)
396:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">'&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot; &quot;http://www.w3.org/TR/html4/loose.dtd&quot;&gt;'</span>,
397:       <span class="ruby-identifier">render</span>(<span class="ruby-value str">'!!!'</span>, <span class="ruby-identifier">:format</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:html4</span>).<span class="ruby-identifier">strip</span>)
398:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000043" class="method">
  <div id="M000043_title" class="title">
    <b>test_double_equals</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000043_source')" id="l_M000043_source">show source</a> ]</p>
  <div id="M000043_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 114</span>
114:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_double_equals</span>
115:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p&gt;Hello World&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">'%p== Hello #{who}'</span>, <span class="ruby-identifier">:locals</span> =<span class="ruby-operator">&gt;</span> {<span class="ruby-identifier">:who</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'World'</span>}))
116:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p&gt;\n  Hello World\n&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p\n  == Hello \#{who}&quot;</span>, <span class="ruby-identifier">:locals</span> =<span class="ruby-operator">&gt;</span> {<span class="ruby-identifier">:who</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'World'</span>}))
117:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000044" class="method">
  <div id="M000044_title" class="title">
    <b>test_double_equals_in_the_middle_of_a_string</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000044_source')" id="l_M000044_source">show source</a> ]</p>
  <div id="M000044_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 119</span>
119:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_double_equals_in_the_middle_of_a_string</span>
120:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;\&quot;title 'Title'. \&quot;\n&quot;</span>,
121:                  <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;== \&quot;title '\#{\&quot;Title\&quot;}'. \&quot;&quot;</span>))
122:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000063" class="method">
  <div id="M000063_title" class="title">
    <b>test_dynamic_attributes_should_be_escaped</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000063_source')" id="l_M000063_source">show source</a> ]</p>
  <div id="M000063_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 286</span>
286:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_dynamic_attributes_should_be_escaped</span>
287:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;img alt='' src='&amp;amp;foo.png' /&gt;\n&quot;</span>,
288:                  <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%img{:width =&gt; nil, :src =&gt; '&amp;foo.png', :alt =&gt; String.new}&quot;</span>))
289:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p alt='' src='&amp;amp;foo.png'&gt;foo&lt;/p&gt;\n&quot;</span>,
290:                  <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p{:width =&gt; nil, :src =&gt; '&amp;foo.png', :alt =&gt; String.new} foo&quot;</span>))
291:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;div alt='' src='&amp;amp;foo.png'&gt;foo&lt;/div&gt;\n&quot;</span>,
292:                  <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%div{:width =&gt; nil, :src =&gt; '&amp;foo.png', :alt =&gt; String.new}= 'foo'&quot;</span>))
293:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;img alt='' src='foo&amp;#x000A;.png' /&gt;\n&quot;</span>,
294:                  <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%img{:width =&gt; nil, :src =&gt; \&quot;foo\\n.png\&quot;, :alt =&gt; String.new}&quot;</span>))
295:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000048" class="method">
  <div id="M000048_title" class="title">
    <b>test_dynamic_attributes_with_empty_attr</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000048_source')" id="l_M000048_source">show source</a> ]</p>
  <div id="M000048_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 136</span>
136:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_dynamic_attributes_with_empty_attr</span>
137:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;img alt='' src='/foo.png' /&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%img{:width =&gt; nil, :src =&gt; '/foo.png', :alt =&gt; String.new}&quot;</span>))
138:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000084" class="method">
  <div id="M000084_title" class="title">
    <b>test_dynamic_attrs_shouldnt_register_as_literal_values</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000084_source')" id="l_M000084_source">show source</a> ]</p>
  <div id="M000084_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 462</span>
462:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_dynamic_attrs_shouldnt_register_as_literal_values</span>
463:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p a='b2c'&gt;&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">'%p{:a =&gt; &quot;b#{1 + 1}c&quot;}'</span>))
464:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p a='b2c'&gt;&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p{:a =&gt; 'b' + (1 + 1).to_s + 'c'}&quot;</span>))
465:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000085" class="method">
  <div id="M000085_title" class="title">
    <b>test_dynamic_attrs_with_self_closed_tag</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000085_source')" id="l_M000085_source">show source</a> ]</p>
  <div id="M000085_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 467</span>
467:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_dynamic_attrs_with_self_closed_tag</span>
468:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;a b='2' /&gt;\nc\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%a{'b' =&gt; 1 + 1}/\n= 'c'\n&quot;</span>))
469:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000079" class="method">
  <div id="M000079_title" class="title">
    <b>test_empty_attrs</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000079_source')" id="l_M000079_source">show source</a> ]</p>
  <div id="M000079_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 435</span>
435:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_empty_attrs</span>
436:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p attr=''&gt;empty&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p{ :attr =&gt; '' } empty&quot;</span>))
437:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p attr=''&gt;empty&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p{ :attr =&gt; x } empty&quot;</span>, <span class="ruby-identifier">:locals</span> =<span class="ruby-operator">&gt;</span> {<span class="ruby-identifier">:x</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">''</span>}))
438:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000092" class="method">
  <div id="M000092_title" class="title">
    <b>test_empty_filter</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000092_source')" id="l_M000092_source">show source</a> ]</p>
  <div id="M000092_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 526</span>
526:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_empty_filter</span>
527:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;script type='text/javascript'&gt;\n  //&lt;![CDATA[\n    \n  //]]&gt;\n&lt;/script&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">':javascript'</span>))
528:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000035" class="method">
  <div id="M000035_title" class="title">
    <b>test_empty_render_should_remain_empty</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000035_source')" id="l_M000035_source">show source</a> ]</p>
  <div id="M000035_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 76</span>
76:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_empty_render_should_remain_empty</span>
77:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">''</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">''</span>))
78:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000050" class="method">
  <div id="M000050_title" class="title">
    <b>test_end_of_file_multiline</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000050_source')" id="l_M000050_source">show source</a> ]</p>
  <div id="M000050_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 156</span>
156:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_end_of_file_multiline</span>
157:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p&gt;0&lt;/p&gt;\n&lt;p&gt;1&lt;/p&gt;\n&lt;p&gt;2&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;- for i in (0...3)\n  %p= |\n   i |&quot;</span>))
158:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000065" class="method">
  <div id="M000065_title" class="title">
    <b>test_escaped_inline_string_interpolation</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000065_source')" id="l_M000065_source">show source</a> ]</p>
  <div id="M000065_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 302</span>
302:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_escaped_inline_string_interpolation</span>
303:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p&gt;4&amp;amp;3&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p&amp;== \#{2+2}&amp;\#{2+1}&quot;</span>, <span class="ruby-identifier">:escape_html</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>))
304:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p&gt;4&amp;amp;3&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p&amp;== \#{2+2}&amp;\#{2+1}&quot;</span>, <span class="ruby-identifier">:escape_html</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">false</span>))
305:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000067" class="method">
  <div id="M000067_title" class="title">
    <b>test_escaped_string_interpolation</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000067_source')" id="l_M000067_source">show source</a> ]</p>
  <div id="M000067_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 312</span>
312:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_escaped_string_interpolation</span>
313:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p&gt;\n  4&amp;amp;3\n&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p\n  &amp;== \#{2+2}&amp;\#{2+1}&quot;</span>, <span class="ruby-identifier">:escape_html</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>))
314:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p&gt;\n  4&amp;amp;3\n&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p\n  &amp;== \#{2+2}&amp;\#{2+1}&quot;</span>, <span class="ruby-identifier">:escape_html</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">false</span>))
315:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000088" class="method">
  <div id="M000088_title" class="title">
    <b>test_exception</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000088_source')" id="l_M000088_source">show source</a> ]</p>
  <div id="M000088_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 497</span>
497:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_exception</span>
498:     <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p\n  hi\n  %a= undefined\n= 12&quot;</span>)
499:   <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">Exception</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
500:     <span class="ruby-identifier">assert_match</span>(<span class="ruby-value str">&quot;(test_exception):3&quot;</span>, <span class="ruby-identifier">e</span>.<span class="ruby-identifier">backtrace</span>[<span class="ruby-value">0</span>])
501:   <span class="ruby-keyword kw">else</span>
502:     <span class="ruby-comment cmt"># Test failed... should have raised an exception</span>
503:     <span class="ruby-identifier">assert</span>(<span class="ruby-keyword kw">false</span>)
504:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000087" class="method">
  <div id="M000087_title" class="title">
    <b>test_exception_line</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000087_source')" id="l_M000087_source">show source</a> ]</p>
  <div id="M000087_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 489</span>
489:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_exception_line</span>
490:     <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;a\nb\n!!!\n  c\nd&quot;</span>)
491:   <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">SyntaxError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
492:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;(test_exception_line):4&quot;</span>, <span class="ruby-identifier">e</span>.<span class="ruby-identifier">backtrace</span>[<span class="ruby-value">0</span>])
493:   <span class="ruby-keyword kw">else</span>
494:     <span class="ruby-identifier">assert</span>(<span class="ruby-keyword kw">false</span>, <span class="ruby-value str">'&quot;a\nb\n!!!\n  c\nd&quot; doesn\'t produce an exception'</span>)
495:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000086" class="method">
  <div id="M000086_title" class="title">
    <b>test_exceptions</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000086_source')" id="l_M000086_source">show source</a> ]</p>
  <div id="M000086_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 471</span>
471:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_exceptions</span>
472:     <span class="ruby-constant">EXCEPTION_MAP</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span><span class="ruby-operator">|</span>
473:       <span class="ruby-keyword kw">begin</span>
474:         <span class="ruby-identifier">render</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">:filename</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;(exception test for #{key.inspect})&quot;</span>)
475:       <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">Exception</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">err</span>
476:         <span class="ruby-identifier">value</span> = [<span class="ruby-identifier">value</span>] <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)
477:         <span class="ruby-identifier">expected_message</span>, <span class="ruby-identifier">line_no</span> = <span class="ruby-identifier">value</span>
478:         <span class="ruby-identifier">line_no</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">key</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;\n&quot;</span>).<span class="ruby-identifier">length</span>
479:         <span class="ruby-identifier">line_reported</span> = <span class="ruby-identifier">err</span>.<span class="ruby-identifier">backtrace</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/\(.+\):/</span>, <span class="ruby-value str">''</span>).<span class="ruby-identifier">to_i</span>
480: 
481:         <span class="ruby-identifier">assert_equal</span>(<span class="ruby-identifier">expected_message</span>, <span class="ruby-identifier">err</span>.<span class="ruby-identifier">message</span>, <span class="ruby-node">&quot;Line: #{key}&quot;</span>)
482:         <span class="ruby-identifier">assert_equal</span>(<span class="ruby-identifier">line_no</span>, <span class="ruby-identifier">line_reported</span>, <span class="ruby-node">&quot;Line: #{key}&quot;</span>)
483:       <span class="ruby-keyword kw">else</span>
484:         <span class="ruby-identifier">assert</span>(<span class="ruby-keyword kw">false</span>, <span class="ruby-node">&quot;Exception not raised for\n#{key}&quot;</span>)
485:       <span class="ruby-keyword kw">end</span>
486:     <span class="ruby-keyword kw">end</span>
487:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000073" class="method">
  <div id="M000073_title" class="title">
    <b>test_filename_and_line</b>()
  </div>
  <div class="description">
  <p>
Options tests
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000073_source')" id="l_M000073_source">show source</a> ]</p>
  <div id="M000073_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 350</span>
350:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_filename_and_line</span>
351:     <span class="ruby-keyword kw">begin</span>
352:       <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;\n\n = abc&quot;</span>, <span class="ruby-identifier">:filename</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'test'</span>, <span class="ruby-identifier">:line</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">2</span>)
353:     <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">Exception</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
354:       <span class="ruby-identifier">assert_kind_of</span> <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">SyntaxError</span>, <span class="ruby-identifier">e</span>
355:       <span class="ruby-identifier">assert_match</span>(<span class="ruby-regexp re">/test:4/</span>, <span class="ruby-identifier">e</span>.<span class="ruby-identifier">backtrace</span>.<span class="ruby-identifier">first</span>)
356:     <span class="ruby-keyword kw">end</span>
357: 
358:     <span class="ruby-keyword kw">begin</span>
359:       <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;\n\n= 123\n\n= nil[]&quot;</span>, <span class="ruby-identifier">:filename</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'test'</span>, <span class="ruby-identifier">:line</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">2</span>)
360:     <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">Exception</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
361:       <span class="ruby-identifier">assert_kind_of</span> <span class="ruby-constant">NoMethodError</span>, <span class="ruby-identifier">e</span>
362:       <span class="ruby-identifier">assert_match</span>(<span class="ruby-regexp re">/test:6/</span>, <span class="ruby-identifier">e</span>.<span class="ruby-identifier">backtrace</span>.<span class="ruby-identifier">first</span>)
363:     <span class="ruby-keyword kw">end</span>
364:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000115" class="method">
  <div id="M000115_title" class="title">
    <b>test_html5_doctype</b>()
  </div>
  <div class="description">
  <p>
HTML5
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000115_source')" id="l_M000115_source">show source</a> ]</p>
  <div id="M000115_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 670</span>
670:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_html5_doctype</span>
671:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">%{&lt;!DOCTYPE html&gt;\n}</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">'!!!'</span>, <span class="ruby-identifier">:format</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:html5</span>)
672:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000111" class="method">
  <div id="M000111_title" class="title">
    <b>test_html_doesnt_add_slash_to_self_closing_tags</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000111_source')" id="l_M000111_source">show source</a> ]</p>
  <div id="M000111_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 648</span>
648:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_html_doesnt_add_slash_to_self_closing_tags</span>
649:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;&lt;a&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%a/&quot;</span>, <span class="ruby-identifier">:format</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:html4</span>)
650:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;&lt;a foo='2'&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%a{:foo =&gt; 1 + 1}/&quot;</span>, <span class="ruby-identifier">:format</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:html4</span>)
651:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;&lt;meta&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%meta&quot;</span>, <span class="ruby-identifier">:format</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:html4</span>)
652:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;&lt;meta foo='2'&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%meta{:foo =&gt; 1 + 1}&quot;</span>, <span class="ruby-identifier">:format</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:html4</span>)
653:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000113" class="method">
  <div id="M000113_title" class="title">
    <b>test_html_has_different_doctype</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000113_source')" id="l_M000113_source">show source</a> ]</p>
  <div id="M000113_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 659</span>
659:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_html_has_different_doctype</span>
660:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">%{&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot; &quot;http://www.w3.org/TR/html4/loose.dtd&quot;&gt;\n}</span>,
661:     <span class="ruby-identifier">render</span>(<span class="ruby-value str">'!!!'</span>, <span class="ruby-identifier">:format</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:html4</span>)
662:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000109" class="method">
  <div id="M000109_title" class="title">
    <b>test_html_has_no_self_closing_tags</b>()
  </div>
  <div class="description">
  <p>
HTML 4.0
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000109_source')" id="l_M000109_source">show source</a> ]</p>
  <div id="M000109_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 639</span>
639:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_html_has_no_self_closing_tags</span>
640:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;&lt;p&gt;\n  &lt;br&gt;\n&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p\n  %br&quot;</span>, <span class="ruby-identifier">:format</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:html4</span>)
641:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;&lt;br&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%br/&quot;</span>, <span class="ruby-identifier">:format</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:html4</span>)
642:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000112" class="method">
  <div id="M000112_title" class="title">
    <b>test_html_ignores_xml_prolog_declaration</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000112_source')" id="l_M000112_source">show source</a> ]</p>
  <div id="M000112_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 655</span>
655:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_html_ignores_xml_prolog_declaration</span>
656:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">'!!! XML'</span>, <span class="ruby-identifier">:format</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:html4</span>)
657:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000110" class="method">
  <div id="M000110_title" class="title">
    <b>test_html_renders_empty_node_with_closing_tag</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000110_source')" id="l_M000110_source">show source</a> ]</p>
  <div id="M000110_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 644</span>
644:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_html_renders_empty_node_with_closing_tag</span>
645:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;&lt;div class='foo'&gt;&lt;/div&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;.foo&quot;</span>, <span class="ruby-identifier">:format</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:html4</span>)
646:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000070" class="method">
  <div id="M000070_title" class="title">
    <b>test_inline_scripts_should_respect_escape_html_option</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000070_source')" id="l_M000070_source">show source</a> ]</p>
  <div id="M000070_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 327</span>
327:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_inline_scripts_should_respect_escape_html_option</span>
328:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p&gt;foo &amp;amp; bar&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p= 'foo &amp; bar'&quot;</span>, <span class="ruby-identifier">:escape_html</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>))
329:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p&gt;foo &amp; bar&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p= 'foo &amp; bar'&quot;</span>, <span class="ruby-identifier">:escape_html</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">false</span>))
330:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000094" class="method">
  <div id="M000094_title" class="title">
    <b>test_local_assigns_dont_modify_class</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000094_source')" id="l_M000094_source">show source</a> ]</p>
  <div id="M000094_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 545</span>
545:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_local_assigns_dont_modify_class</span>
546:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;bar\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;= foo&quot;</span>, <span class="ruby-identifier">:locals</span> =<span class="ruby-operator">&gt;</span> {<span class="ruby-identifier">:foo</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'bar'</span>}))
547:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-keyword kw">nil</span>, <span class="ruby-keyword kw">defined?</span>(<span class="ruby-identifier">foo</span>))
548:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000083" class="method">
  <div id="M000083_title" class="title">
    <b>test_locals</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000083_source')" id="l_M000083_source">show source</a> ]</p>
  <div id="M000083_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 458</span>
458:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_locals</span>
459:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p&gt;Paragraph!&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p= text&quot;</span>, <span class="ruby-identifier">:locals</span> =<span class="ruby-operator">&gt;</span> { <span class="ruby-identifier">:text</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Paragraph!&quot;</span> }))
460:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000042" class="method">
  <div id="M000042_title" class="title">
    <b>test_multi_render</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000042_source')" id="l_M000042_source">show source</a> ]</p>
  <div id="M000042_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 107</span>
107:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_multi_render</span>
108:     <span class="ruby-identifier">engine</span> = <span class="ruby-identifier">engine</span>(<span class="ruby-value str">&quot;%strong Hi there!&quot;</span>)
109:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;strong&gt;Hi there!&lt;/strong&gt;\n&quot;</span>, <span class="ruby-identifier">engine</span>.<span class="ruby-identifier">to_html</span>)
110:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;strong&gt;Hi there!&lt;/strong&gt;\n&quot;</span>, <span class="ruby-identifier">engine</span>.<span class="ruby-identifier">to_html</span>)
111:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;strong&gt;Hi there!&lt;/strong&gt;\n&quot;</span>, <span class="ruby-identifier">engine</span>.<span class="ruby-identifier">to_html</span>)
112:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000080" class="method">
  <div id="M000080_title" class="title">
    <b>test_nil_attrs</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000080_source')" id="l_M000080_source">show source</a> ]</p>
  <div id="M000080_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 440</span>
440:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_nil_attrs</span>
441:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p&gt;nil&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p{ :attr =&gt; nil } nil&quot;</span>))
442:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p&gt;nil&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p{ :attr =&gt; x } nil&quot;</span>, <span class="ruby-identifier">:locals</span> =<span class="ruby-operator">&gt;</span> {<span class="ruby-identifier">:x</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>}))
443:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000082" class="method">
  <div id="M000082_title" class="title">
    <b>test_nil_class_with_syntactic_class</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000082_source')" id="l_M000082_source">show source</a> ]</p>
  <div id="M000082_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 451</span>
451:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_nil_class_with_syntactic_class</span>
452:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p class='foo'&gt;nil&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p.foo{:class =&gt; nil} nil&quot;</span>))
453:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p class='bar foo'&gt;nil&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p.bar.foo{:class =&gt; nil} nil&quot;</span>))
454:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p class='bar foo'&gt;nil&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p.foo{{:class =&gt; 'bar'}, :class =&gt; nil} nil&quot;</span>))
455:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p class='bar foo'&gt;nil&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p.foo{{:class =&gt; nil}, :class =&gt; 'bar'} nil&quot;</span>))
456:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000081" class="method">
  <div id="M000081_title" class="title">
    <b>test_nil_id_with_syntactic_id</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000081_source')" id="l_M000081_source">show source</a> ]</p>
  <div id="M000081_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 445</span>
445:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_nil_id_with_syntactic_id</span>
446:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p id='foo'&gt;nil&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p#foo{:id =&gt; nil} nil&quot;</span>))
447:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p id='foo_bar'&gt;nil&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p#foo{{:id =&gt; 'bar'}, :id =&gt; nil} nil&quot;</span>))
448:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p id='foo_bar'&gt;nil&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p#foo{{:id =&gt; nil}, :id =&gt; 'bar'} nil&quot;</span>))
449:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000038" class="method">
  <div id="M000038_title" class="title">
    <b>test_nil_should_render_empty_tag</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000038_source')" id="l_M000038_source">show source</a> ]</p>
  <div id="M000038_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 89</span>
89:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_nil_should_render_empty_tag</span>
90:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;div class='no_attributes'&gt;&lt;/div&gt;&quot;</span>,
91:                  <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;.no_attributes{:nil =&gt; nil}&quot;</span>).<span class="ruby-identifier">chomp</span>)
92:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000045" class="method">
  <div id="M000045_title" class="title">
    <b>test_nil_tag_value_should_render_as_empty</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000045_source')" id="l_M000045_source">show source</a> ]</p>
  <div id="M000045_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 124</span>
124:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_nil_tag_value_should_render_as_empty</span>
125:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p&gt;&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p= nil&quot;</span>))
126:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000097" class="method">
  <div id="M000097_title" class="title">
    <b>test_non_literal_attributes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000097_source')" id="l_M000097_source">show source</a> ]</p>
  <div id="M000097_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 562</span>
562:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_non_literal_attributes</span>
563:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p a1='foo' a2='bar' a3='baz' /&gt;\n&quot;</span>,
564:                  <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p{a2, a1, :a3 =&gt; 'baz'}/&quot;</span>,
565:                         <span class="ruby-identifier">:locals</span> =<span class="ruby-operator">&gt;</span> {<span class="ruby-identifier">:a1</span> =<span class="ruby-operator">&gt;</span> {<span class="ruby-identifier">:a1</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'foo'</span>}, <span class="ruby-identifier">:a2</span> =<span class="ruby-operator">&gt;</span> {<span class="ruby-identifier">:a2</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'bar'</span>}}))
566:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000096" class="method">
  <div id="M000096_title" class="title">
    <b>test_object_ref_before_attrs</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000096_source')" id="l_M000096_source">show source</a> ]</p>
  <div id="M000096_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 556</span>
556:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_object_ref_before_attrs</span>
557:     <span class="ruby-identifier">user</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">new</span> <span class="ruby-value">42</span>
558:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p class='struct_user' id='struct_user_42' style='width: 100px;'&gt;New User&lt;/p&gt;\n&quot;</span>,
559:                  <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p[user]{:style =&gt; 'width: 100px;'} New User&quot;</span>, <span class="ruby-identifier">:locals</span> =<span class="ruby-operator">&gt;</span> {<span class="ruby-identifier">:user</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">user</span>}))
560:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000095" class="method">
  <div id="M000095_title" class="title">
    <b>test_object_ref_with_nil_id</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000095_source')" id="l_M000095_source">show source</a> ]</p>
  <div id="M000095_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 550</span>
550:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_object_ref_with_nil_id</span>
551:     <span class="ruby-identifier">user</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">new</span>
552:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p class='struct_user' id='struct_user_new'&gt;New User&lt;/p&gt;\n&quot;</span>,
553:                  <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p[user] New User&quot;</span>, <span class="ruby-identifier">:locals</span> =<span class="ruby-operator">&gt;</span> {<span class="ruby-identifier">:user</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">user</span>}))
554:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000040" class="method">
  <div id="M000040_title" class="title">
    <b>test_one_liner_should_be_one_line</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000040_source')" id="l_M000040_source">show source</a> ]</p>
  <div id="M000040_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 99</span>
 99:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_one_liner_should_be_one_line</span>
100:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p&gt;Hello&lt;/p&gt;&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">'%p Hello'</span>).<span class="ruby-identifier">chomp</span>)
101:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000041" class="method">
  <div id="M000041_title" class="title">
    <b>test_one_liner_with_newline_shouldnt_be_one_line</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000041_source')" id="l_M000041_source">show source</a> ]</p>
  <div id="M000041_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 103</span>
103:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_one_liner_with_newline_shouldnt_be_one_line</span>
104:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p&gt;\n  foo\n  bar\n&lt;/p&gt;&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">'%p= &quot;foo\nbar&quot;'</span>).<span class="ruby-identifier">chomp</span>)
105:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000103" class="method">
  <div id="M000103_title" class="title">
    <b>test_render_proc_locals</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000103_source')" id="l_M000103_source">show source</a> ]</p>
  <div id="M000103_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 601</span>
601:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_render_proc_locals</span>
602:     <span class="ruby-identifier">proc</span> = <span class="ruby-identifier">engine</span>(<span class="ruby-value str">&quot;%p= foo\n.bar{:baz =&gt; baz}= boom&quot;</span>).<span class="ruby-identifier">render_proc</span>(<span class="ruby-constant">Object</span>.<span class="ruby-identifier">new</span>, <span class="ruby-identifier">:foo</span>, <span class="ruby-identifier">:baz</span>, <span class="ruby-identifier">:boom</span>)
603:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p&gt;1&lt;/p&gt;\n&lt;div baz='2' class='bar'&gt;3&lt;/div&gt;\n&quot;</span>, <span class="ruby-identifier">proc</span>[<span class="ruby-identifier">:foo</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">:baz</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">2</span>, <span class="ruby-identifier">:boom</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">3</span>])
604:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000104" class="method">
  <div id="M000104_title" class="title">
    <b>test_render_proc_with_binding</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000104_source')" id="l_M000104_source">show source</a> ]</p>
  <div id="M000104_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 606</span>
606:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_render_proc_with_binding</span>
607:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;FOO\n&quot;</span>, <span class="ruby-identifier">engine</span>(<span class="ruby-value str">&quot;= upcase&quot;</span>).<span class="ruby-identifier">render_proc</span>(<span class="ruby-value str">&quot;foo&quot;</span>.<span class="ruby-identifier">instance_eval</span>{<span class="ruby-identifier">binding</span>}).<span class="ruby-identifier">call</span>)
608:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000098" class="method">
  <div id="M000098_title" class="title">
    <b>test_render_should_accept_a_binding_as_scope</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000098_source')" id="l_M000098_source">show source</a> ]</p>
  <div id="M000098_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 568</span>
568:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_render_should_accept_a_binding_as_scope</span>
569:     <span class="ruby-identifier">string</span> = <span class="ruby-value str">&quot;This is a string!&quot;</span>
570:     <span class="ruby-identifier">string</span>.<span class="ruby-identifier">instance_variable_set</span>(<span class="ruby-value str">&quot;@var&quot;</span>, <span class="ruby-value str">&quot;Instance variable&quot;</span>)
571:     <span class="ruby-identifier">b</span> = <span class="ruby-identifier">string</span>.<span class="ruby-identifier">instance_eval</span> <span class="ruby-keyword kw">do</span>
572:       <span class="ruby-identifier">var</span> = <span class="ruby-value str">&quot;Local variable&quot;</span>
573:       <span class="ruby-identifier">binding</span>
574:     <span class="ruby-keyword kw">end</span>
575: 
576:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p&gt;THIS IS A STRING!&lt;/p&gt;\n&lt;p&gt;Instance variable&lt;/p&gt;\n&lt;p&gt;Local variable&lt;/p&gt;\n&quot;</span>,
577:                  <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p= upcase\n%p= @var\n%p= var&quot;</span>, <span class="ruby-identifier">:scope</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">b</span>))
578:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000037" class="method">
  <div id="M000037_title" class="title">
    <b>test_ruby_code_should_work_inside_attributes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000037_source')" id="l_M000037_source">show source</a> ]</p>
  <div id="M000037_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 84</span>
84:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_ruby_code_should_work_inside_attributes</span>
85:     <span class="ruby-identifier">author</span> = <span class="ruby-value str">'hcatlin'</span>
86:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p class='3'&gt;foo&lt;/p&gt;&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p{:class =&gt; 1+2} foo&quot;</span>).<span class="ruby-identifier">chomp</span>)
87:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000071" class="method">
  <div id="M000071_title" class="title">
    <b>test_script_ending_in_comment_should_render_when_html_is_escaped</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000071_source')" id="l_M000071_source">show source</a> ]</p>
  <div id="M000071_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 332</span>
332:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_script_ending_in_comment_should_render_when_html_is_escaped</span>
333:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;foo&amp;amp;bar\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;= 'foo&amp;bar' #comment&quot;</span>, <span class="ruby-identifier">:escape_html</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>))
334:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000072" class="method">
  <div id="M000072_title" class="title">
    <b>test_script_with_if_shouldnt_output</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000072_source')" id="l_M000072_source">show source</a> ]</p>
  <div id="M000072_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 336</span>
336:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_script_with_if_shouldnt_output</span>
337:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p&gt;foo&lt;/p&gt;\n&lt;p&gt;&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p= \&quot;foo\&quot;\n%p= \&quot;bar\&quot; if false\n&quot;</span>))
338:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000069" class="method">
  <div id="M000069_title" class="title">
    <b>test_scripts_should_respect_escape_html_option</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000069_source')" id="l_M000069_source">show source</a> ]</p>
  <div id="M000069_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 322</span>
322:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_scripts_should_respect_escape_html_option</span>
323:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p&gt;\n  foo &amp;amp; bar\n&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p\n  = 'foo &amp; bar'&quot;</span>, <span class="ruby-identifier">:escape_html</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>))
324:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p&gt;\n  foo &amp; bar\n&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p\n  = 'foo &amp; bar'&quot;</span>, <span class="ruby-identifier">:escape_html</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">false</span>))
325:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000062" class="method">
  <div id="M000062_title" class="title">
    <b>test_static_attributes_should_be_escaped</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000062_source')" id="l_M000062_source">show source</a> ]</p>
  <div id="M000062_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 275</span>
275:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_static_attributes_should_be_escaped</span>
276:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;img class='atlantis' style='ugly&amp;amp;stupid' /&gt;\n&quot;</span>,
277:                  <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%img.atlantis{:style =&gt; 'ugly&amp;stupid'}&quot;</span>))
278:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;div class='atlantis' style='ugly&amp;amp;stupid'&gt;foo&lt;/div&gt;\n&quot;</span>,
279:                  <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;.atlantis{:style =&gt; 'ugly&amp;stupid'} foo&quot;</span>))
280:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p class='atlantis' style='ugly&amp;amp;stupid'&gt;foo&lt;/p&gt;\n&quot;</span>,
281:                 <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p.atlantis{:style =&gt; 'ugly&amp;stupid'}= 'foo'&quot;</span>))
282:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p class='atlantis' style='ugly&amp;#x000A;stupid'&gt;&lt;/p&gt;\n&quot;</span>,
283:                 <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p.atlantis{:style =&gt; \&quot;ugly\\nstupid\&quot;}&quot;</span>))
284:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000047" class="method">
  <div id="M000047_title" class="title">
    <b>test_static_attributes_with_empty_attr</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000047_source')" id="l_M000047_source">show source</a> ]</p>
  <div id="M000047_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 132</span>
132:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_static_attributes_with_empty_attr</span>
133:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;img alt='' src='/foo.png' /&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%img{:src =&gt; '/foo.png', :alt =&gt; ''}&quot;</span>))
134:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000074" class="method">
  <div id="M000074_title" class="title">
    <b>test_stop_eval</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000074_source')" id="l_M000074_source">show source</a> ]</p>
  <div id="M000074_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 366</span>
366:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_stop_eval</span>
367:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;= 'Hello'&quot;</span>, <span class="ruby-identifier">:suppress_eval</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>))
368:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;- haml_concat 'foo'&quot;</span>, <span class="ruby-identifier">:suppress_eval</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>))
369:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;div id='foo' yes='no' /&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;#foo{:yes =&gt; 'no'}/&quot;</span>, <span class="ruby-identifier">:suppress_eval</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>))
370:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;div id='foo' /&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;#foo{:yes =&gt; 'no', :call =&gt; a_function() }/&quot;</span>, <span class="ruby-identifier">:suppress_eval</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>))
371:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;div /&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%div[1]/&quot;</span>, <span class="ruby-identifier">:suppress_eval</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>))
372:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;:ruby\n  Kernel.puts 'hello'&quot;</span>, <span class="ruby-identifier">:suppress_eval</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>))
373:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000064" class="method">
  <div id="M000064_title" class="title">
    <b>test_string_interpolation_should_be_esaped</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000064_source')" id="l_M000064_source">show source</a> ]</p>
  <div id="M000064_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 297</span>
297:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_string_interpolation_should_be_esaped</span>
298:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p&gt;4&amp;amp;3&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p== \#{2+2}&amp;\#{2+1}&quot;</span>, <span class="ruby-identifier">:escape_html</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>))
299:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p&gt;4&amp;3&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p== \#{2+2}&amp;\#{2+1}&quot;</span>, <span class="ruby-identifier">:escape_html</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">false</span>))
300:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000039" class="method">
  <div id="M000039_title" class="title">
    <b>test_strings_should_get_stripped_inside_tags</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000039_source')" id="l_M000039_source">show source</a> ]</p>
  <div id="M000039_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 94</span>
94:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_strings_should_get_stripped_inside_tags</span>
95:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;div class='stripped'&gt;This should have no spaces in front of it&lt;/div&gt;&quot;</span>,
96:                  <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;.stripped    This should have no spaces in front of it&quot;</span>).<span class="ruby-identifier">chomp</span>)
97:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000046" class="method">
  <div id="M000046_title" class="title">
    <b>test_tag_with_failed_if_should_render_as_empty</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000046_source')" id="l_M000046_source">show source</a> ]</p>
  <div id="M000046_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 128</span>
128:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_tag_with_failed_if_should_render_as_empty</span>
129:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p&gt;&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p= 'Hello' if false&quot;</span>))
130:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000052" class="method">
  <div id="M000052_title" class="title">
    <b>test_textareas</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000052_source')" id="l_M000052_source">show source</a> ]</p>
  <div id="M000052_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 164</span>
164:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_textareas</span>
165:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;textarea&gt;Foo&amp;#x000A;  bar&amp;#x000A;   baz&lt;/textarea&gt;\n&quot;</span>,
166:                  <span class="ruby-identifier">render</span>(<span class="ruby-value str">'%textarea= &quot;Foo\n  bar\n   baz&quot;'</span>))
167: 
168:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;pre&gt;Foo&amp;#x000A;  bar&amp;#x000A;   baz&lt;/pre&gt;\n&quot;</span>,
169:                  <span class="ruby-identifier">render</span>(<span class="ruby-value str">'%pre= &quot;Foo\n  bar\n   baz&quot;'</span>))
170: 
171:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-node">&quot;&lt;textarea&gt;#{'a' * 100}&lt;/textarea&gt;\n&quot;</span>,
172:                  <span class="ruby-identifier">render</span>(<span class="ruby-node">&quot;%textarea #{'a' * 100}&quot;</span>))
173: 
174:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p&gt;\n  &lt;textarea&gt;Foo\n  Bar\n  Baz&lt;/textarea&gt;\n&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p\n  %textarea\n    Foo\n    Bar\n    Baz\n&quot;</span>))
175:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000093" class="method">
  <div id="M000093_title" class="title">
    <b>test_ugly_filter</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000093_source')" id="l_M000093_source">show source</a> ]</p>
  <div id="M000093_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 537</span>
537:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_ugly_filter</span>
538:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;#foo {\n  bar: baz; }\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;:sass\n  #foo\n    bar: baz&quot;</span>, <span class="ruby-identifier">:ugly</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>))
539:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000105" class="method">
  <div id="M000105_title" class="title">
    <b>test_ugly_true</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000105_source')" id="l_M000105_source">show source</a> ]</p>
  <div id="M000105_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 610</span>
610:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_ugly_true</span>
611:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;div id='outer'&gt;\n&lt;div id='inner'&gt;\n&lt;p&gt;hello world&lt;/p&gt;\n&lt;/div&gt;\n&lt;/div&gt;\n&quot;</span>,
612:                  <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;#outer\n  #inner\n    %p hello world&quot;</span>, <span class="ruby-identifier">:ugly</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>))
613: 
614:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-node">&quot;&lt;p&gt;#{'s' * 75}&lt;/p&gt;\n&quot;</span>,
615:                  <span class="ruby-identifier">render</span>(<span class="ruby-node">&quot;%p #{'s' * 75}&quot;</span>, <span class="ruby-identifier">:ugly</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>))
616: 
617:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-node">&quot;&lt;p&gt;#{'s' * 75}&lt;/p&gt;\n&quot;</span>,
618:                  <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p= 's' * 75&quot;</span>, <span class="ruby-identifier">:ugly</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>))
619:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000090" class="method">
  <div id="M000090_title" class="title">
    <b>test_unbalanced_brackets</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000090_source')" id="l_M000090_source">show source</a> ]</p>
  <div id="M000090_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 515</span>
515:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_unbalanced_brackets</span>
516:     <span class="ruby-identifier">render</span>(<span class="ruby-value str">'== #{1 + 5} foo #{6 + 7 bar #{8 + 9}'</span>)
517:   <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">SyntaxError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
518:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;Unbalanced brackets.&quot;</span>, <span class="ruby-identifier">e</span>.<span class="ruby-identifier">message</span>)
519:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000066" class="method">
  <div id="M000066_title" class="title">
    <b>test_unescaped_inline_string_interpolation</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000066_source')" id="l_M000066_source">show source</a> ]</p>
  <div id="M000066_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 307</span>
307:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_unescaped_inline_string_interpolation</span>
308:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p&gt;4&amp;3&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p!== \#{2+2}&amp;\#{2+1}&quot;</span>, <span class="ruby-identifier">:escape_html</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>))
309:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p&gt;4&amp;3&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p!== \#{2+2}&amp;\#{2+1}&quot;</span>, <span class="ruby-identifier">:escape_html</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">false</span>))
310:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000068" class="method">
  <div id="M000068_title" class="title">
    <b>test_unescaped_string_interpolation</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000068_source')" id="l_M000068_source">show source</a> ]</p>
  <div id="M000068_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 317</span>
317:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_unescaped_string_interpolation</span>
318:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p&gt;\n  4&amp;3\n&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p\n  !== \#{2+2}&amp;\#{2+1}&quot;</span>, <span class="ruby-identifier">:escape_html</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>))
319:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p&gt;\n  4&amp;3\n&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p\n  !== \#{2+2}&amp;\#{2+1}&quot;</span>, <span class="ruby-identifier">:escape_html</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">false</span>))
320:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000054" class="method">
  <div id="M000054_title" class="title">
    <b>test_whitespace_nuke_with_both_newlines</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000054_source')" id="l_M000054_source">show source</a> ]</p>
  <div id="M000054_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 196</span>
196:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_whitespace_nuke_with_both_newlines</span>
197:     <span class="ruby-comment cmt"># Regression test</span>
198:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p&gt;foo&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">'%p&lt;= &quot;\nfoo\n&quot;'</span>))
199:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;p&gt;\n  &lt;p&gt;foo&lt;/p&gt;\n&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p\n  %p&lt;= \&quot;\\\\nfoo\\\\n\&quot;\n&quot;</span>))
200:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000107" class="method">
  <div id="M000107_title" class="title">
    <b>test_xhtml_output_option</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000107_source')" id="l_M000107_source">show source</a> ]</p>
  <div id="M000107_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 628</span>
628:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_xhtml_output_option</span>
629:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;&lt;p&gt;\n  &lt;br /&gt;\n&lt;/p&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%p\n  %br&quot;</span>, <span class="ruby-identifier">:format</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:xhtml</span>)
630:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;&lt;a /&gt;\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;%a/&quot;</span>, <span class="ruby-identifier">:format</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:xhtml</span>)
631:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000114" class="method">
  <div id="M000114_title" class="title">
    <b>test_xml_prolog_and_doctype_dont_result_in_a_leading_whitespace_in_html</b>()
  </div>
  <div class="description">
  <p>
because anything before the doctype triggers quirks mode in IE
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000114_source')" id="l_M000114_source">show source</a> ]</p>
  <div id="M000114_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 665</span>
665:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_xml_prolog_and_doctype_dont_result_in_a_leading_whitespace_in_html</span>
666:     <span class="ruby-identifier">assert_no_match</span>(<span class="ruby-regexp re">/^\s+/</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;!!! xml\n!!!&quot;</span>, <span class="ruby-identifier">:format</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:html4</span>))
667:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000099" class="method">
  <div id="M000099_title" class="title">
    <b>test_yield_should_work_with_binding</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000099_source')" id="l_M000099_source">show source</a> ]</p>
  <div id="M000099_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 580</span>
580:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_yield_should_work_with_binding</span>
581:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;12\nFOO\n&quot;</span>, <span class="ruby-identifier">render</span>(<span class="ruby-value str">&quot;= yield\n= upcase&quot;</span>, <span class="ruby-identifier">:scope</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;foo&quot;</span>.<span class="ruby-identifier">instance_eval</span>{<span class="ruby-identifier">binding</span>}) { <span class="ruby-value">12</span> })
582:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000100" class="method">
  <div id="M000100_title" class="title">
    <b>test_yield_should_work_with_def_method</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000100_source')" id="l_M000100_source">show source</a> ]</p>
  <div id="M000100_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File test/haml/engine_test.rb, line 584</span>
584:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_yield_should_work_with_def_method</span>
585:     <span class="ruby-identifier">s</span> = <span class="ruby-value str">&quot;foo&quot;</span>
586:     <span class="ruby-identifier">engine</span>(<span class="ruby-value str">&quot;= yield\n= upcase&quot;</span>).<span class="ruby-identifier">def_method</span>(<span class="ruby-identifier">s</span>, <span class="ruby-identifier">:render</span>)
587:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;12\nFOO\n&quot;</span>, <span class="ruby-identifier">s</span>.<span class="ruby-identifier">render</span> { <span class="ruby-value">12</span> })
588:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
</div>

  </div>