  <div id="C00000078">
<div class='banner'>
  <span class="file-title-prefix">Module</span><br />Helpers<br/>
  In:
<a href="#" onclick="jsHref('files/lib/haml/helpers/action_view_extensions_rb.html');">lib/haml/helpers/action_view_extensions.rb</a>
<a href="#" onclick="jsHref('files/lib/haml/helpers/xss_mods_rb.html');">lib/haml/helpers/xss_mods.rb</a>
<a href="#" onclick="jsHref('files/lib/haml/helpers_rb.html');">lib/haml/helpers.rb</a>
<a href="#" onclick="jsHref('files/test/haml/helper_test_rb.html');">test/haml/helper_test.rb</a>
<a href="#" onclick="jsHref('files/test/haml/template_test_rb.html');">test/haml/template_test.rb</a>

</div>
 <!-- banner header -->

  <div id="bodyContent" >
      <div id="content">

  <div class="description"><p>
This module contains various helpful methods to make it easier to do
various tasks. {<a
href="index.html?a=C00000078&name=Haml::Helpers">Haml::Helpers</a>} is
automatically included in the context that a <a
href="index.html?a=C00000072&name=Haml">Haml</a> template is parsed in, so
all these methods are at your disposal from within the template.
</p>
</div>



  <div class="sectiontitle">Methods</div>
  <ul>
  <li><a href="index.html?a=M001139&name=action_view?" >action_view?</a></li>
  <li><a href="index.html?a=M001160&name=block_is_haml?" >block_is_haml?</a></li>
  <li><a href="index.html?a=M001153&name=capture_haml" >capture_haml</a></li>
  <li><a href="index.html?a=M001158&name=escape_once" >escape_once</a></li>
  <li><a href="index.html?a=M001142&name=find_and_preserve" >find_and_preserve</a></li>
  <li><a href="index.html?a=M001144&name=flatten" >flatten</a></li>
  <li><a href="index.html?a=M001154&name=haml_concat" >haml_concat</a></li>
  <li><a href="index.html?a=M001155&name=haml_indent" >haml_indent</a></li>
  <li><a href="index.html?a=M001156&name=haml_tag" >haml_tag</a></li>
  <li><a href="index.html?a=M001146&name=html_attrs" >html_attrs</a></li>
  <li><a href="index.html?a=M001157&name=html_escape" >html_escape</a></li>
  <li><a href="index.html?a=M001140&name=init_haml_helpers" >init_haml_helpers</a></li>
  <li><a href="index.html?a=M001159&name=is_haml?" >is_haml?</a></li>
  <li><a href="index.html?a=M001145&name=list_of" >list_of</a></li>
  <li><a href="index.html?a=M001141&name=non_haml" >non_haml</a></li>
  <li><a href="index.html?a=M001151&name=precede" >precede</a></li>
  <li><a href="index.html?a=M001143&name=preserve" >preserve</a></li>
  <li><a href="index.html?a=M001161&name=something_that_uses_haml_concat" >something_that_uses_haml_concat</a></li>
  <li><a href="index.html?a=M001152&name=succeed" >succeed</a></li>
  <li><a href="index.html?a=M001150&name=surround" >surround</a></li>
  <li><a href="index.html?a=M001148&name=tab_down" >tab_down</a></li>
  <li><a href="index.html?a=M001147&name=tab_up" >tab_up</a></li>
  <li><a href="index.html?a=M001162&name=test_partial" >test_partial</a></li>
  <li><a href="index.html?a=M001149&name=with_tabs" >with_tabs</a></li>
  </ul>

<div class="sectiontitle">Included Modules</div>
<ul>
  <li><a href="#" onclick="jsHref('classes/Haml/Helpers/ActionViewExtensions.html');">ActionViewExtensions</a></li>
</ul>


  <div class="sectiontitle">Classes and Modules</div>
  Module "<a href="#" onclick="jsHref('classes/Haml/Helpers/ActionViewExtensions.html');" class="link">Haml::Helpers::ActionViewExtensions</a>"<br />
Module "<a href="#" onclick="jsHref('classes/Haml/Helpers/XssMods.html');" class="link">Haml::Helpers::XssMods</a>"<br />
Class "<a href="#" onclick="jsHref('classes/Haml/Helpers/ErrorReturn.html');" class="link">Haml::Helpers::ErrorReturn</a>"<br />


  <div class="sectiontitle">Constants</div>
  <table border='0' cellpadding='5'>
  <tr valign='top'>
    <td class="attr-name">HTML_ESCAPE</td>
    <td>=</td>
    <td class="attr-value">{ '&amp;'=&gt;'&amp;amp;', '&lt;'=&gt;'&amp;lt;', '&gt;'=&gt;'&amp;gt;', '&quot;'=&gt;'&amp;quot;', &quot;'&quot;=&gt;'&amp;#039;', }</td>
  </tr>
  <tr valign='top'>
    <td>&nbsp;</td>
    <td colspan="2" class="attr-desc">
Characters that need to be escaped to <a
href="index.html?a=C00000105&name=HTML">HTML</a> entities from user input

</td>
  </tr>
  </table>


<div class="sectiontitle">Public Class methods</div>
<div id="M001139" class="method">
  <div id="M001139_title" class="title">
    <b>action_view?</b>()
  </div>
  <div class="description">
  <p>
@return [Boolean] Whether or not <a
href="index.html?a=C00000185&name=ActionView">ActionView</a> is loaded
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001139_source')" id="l_M001139_source">show source</a> ]</p>
  <div id="M001139_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File lib/haml/helpers.rb, line 54</span>
54:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">action_view?</span>
55:       <span class="ruby-ivar">@@action_view_defined</span>
56:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div class="sectiontitle">Public Instance methods</div>
<div id="M001160" class="method">
  <div id="M001160_title" class="title">
    <b>block_is_haml?</b>(block)
  </div>
  <div class="description">
  <p>
Returns whether or not `block` is defined directly in a <a
href="index.html?a=C00000072&name=Haml">Haml</a> template.
</p>
<p>
@param block [Proc] A Ruby block @return [Boolean] Whether or not `block`
is defined directly in a <a
href="index.html?a=C00000072&name=Haml">Haml</a> template
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001160_source')" id="l_M001160_source">show source</a> ]</p>
  <div id="M001160_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File lib/haml/helpers.rb, line 539</span>
539:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">block_is_haml?</span>(<span class="ruby-identifier">block</span>)
540:       <span class="ruby-identifier">eval</span>(<span class="ruby-value str">'_hamlout'</span>, <span class="ruby-identifier">block</span>.<span class="ruby-identifier">binding</span>)
541:       <span class="ruby-keyword kw">true</span>
542:     <span class="ruby-keyword kw">rescue</span>
543:       <span class="ruby-keyword kw">false</span>
544:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001153" class="method">
  <div id="M001153_title" class="title">
    <b>capture_haml</b>(*args, &amp;block)
  </div>
  <div class="description">
  <p>
Captures the result of a block of <a
href="index.html?a=C00000072&name=Haml">Haml</a> code, gets rid of the
excess indentation, and returns it as a string. For example, after the
following,
</p>
<pre>
    .foo
      - foo = capture_haml(13) do |a|
        %p= a
</pre>
<p>
the local variable `foo` would be assigned to
`&quot;&lt;p&gt;13&lt;/p&gt;\n&quot;`.
</p>
<p>
@param args [Array] Arguments to pass into the block @yield [args] A block
of <a href="index.html?a=C00000072&name=Haml">Haml</a> code that will be
converted to a string @yieldparam args [Array] `args`
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001153_source')" id="l_M001153_source">show source</a> ]</p>
  <div id="M001153_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File lib/haml/helpers.rb, line 338</span>
338:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">capture_haml</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
339:       <span class="ruby-identifier">buffer</span> = <span class="ruby-identifier">eval</span>(<span class="ruby-value str">'_hamlout'</span>, <span class="ruby-identifier">block</span>.<span class="ruby-identifier">binding</span>) <span class="ruby-keyword kw">rescue</span> <span class="ruby-identifier">haml_buffer</span>
340:       <span class="ruby-identifier">with_haml_buffer</span>(<span class="ruby-identifier">buffer</span>) <span class="ruby-keyword kw">do</span>
341:         <span class="ruby-identifier">position</span> = <span class="ruby-identifier">haml_buffer</span>.<span class="ruby-identifier">buffer</span>.<span class="ruby-identifier">length</span>
342: 
343:         <span class="ruby-identifier">haml_buffer</span>.<span class="ruby-identifier">capture_position</span> = <span class="ruby-identifier">position</span>
344:         <span class="ruby-identifier">block</span>.<span class="ruby-identifier">call</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
345: 
346:         <span class="ruby-identifier">captured</span> = <span class="ruby-identifier">haml_buffer</span>.<span class="ruby-identifier">buffer</span>.<span class="ruby-identifier">slice!</span>(<span class="ruby-identifier">position</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>)
347:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">captured</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">haml_buffer</span>.<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:ugly</span>]
348:         <span class="ruby-identifier">captured</span> = <span class="ruby-identifier">captured</span>.<span class="ruby-identifier">split</span>(<span class="ruby-regexp re">/^/</span>)
349: 
350:         <span class="ruby-identifier">min_tabs</span> = <span class="ruby-keyword kw">nil</span>
351:         <span class="ruby-identifier">captured</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span>
352:           <span class="ruby-identifier">tabs</span> = <span class="ruby-identifier">line</span>.<span class="ruby-identifier">index</span>(<span class="ruby-regexp re">/[^ ]/</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">line</span>.<span class="ruby-identifier">length</span>
353:           <span class="ruby-identifier">min_tabs</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">tabs</span>
354:           <span class="ruby-identifier">min_tabs</span> = <span class="ruby-identifier">min_tabs</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">tabs</span> <span class="ruby-value">? </span><span class="ruby-identifier">tabs</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">min_tabs</span>
355:         <span class="ruby-keyword kw">end</span>
356: 
357:         <span class="ruby-identifier">captured</span>.<span class="ruby-identifier">map</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span>
358:           <span class="ruby-identifier">line</span>[<span class="ruby-identifier">min_tabs</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>]
359:         <span class="ruby-keyword kw">end</span>.<span class="ruby-identifier">join</span>
360:       <span class="ruby-keyword kw">end</span>
361:     <span class="ruby-keyword kw">ensure</span>
362:       <span class="ruby-identifier">haml_buffer</span>.<span class="ruby-identifier">capture_position</span> = <span class="ruby-keyword kw">nil</span>
363:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001158" class="method">
  <div id="M001158_title" class="title">
    <b>escape_once</b>(text)
  </div>
  <div class="description">
  <p>
Escapes <a href="index.html?a=C00000105&name=HTML">HTML</a> entities in
`text`, but without escaping an ampersand that is already part of an
escaped entity.
</p>
<p>
@param text [String] The string to sanitize @return [String] The sanitized
string
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001158_source')" id="l_M001158_source">show source</a> ]</p>
  <div id="M001158_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File lib/haml/helpers.rb, line 518</span>
518:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">escape_once</span>(<span class="ruby-identifier">text</span>)
519:       <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Util</span>.<span class="ruby-identifier">silence_warnings</span> <span class="ruby-keyword kw">do</span>
520:         <span class="ruby-identifier">text</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/[\&quot;&gt;&lt;]|&amp;(?!(?:[a-zA-Z]+|(#\d+));)/n</span>) {<span class="ruby-operator">|</span><span class="ruby-identifier">s</span><span class="ruby-operator">|</span> <span class="ruby-constant">HTML_ESCAPE</span>[<span class="ruby-identifier">s</span>]}
521:       <span class="ruby-keyword kw">end</span>
522:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001142" class="method">
  <div id="M001142_title" class="title">
    <b>find_and_preserve</b>(input = nil, tags = haml_buffer.options[:preserve], &amp;block)
  </div>
  <div class="description">
  <p>
Uses \{<a href="index.html?a=M001143&name=preserve">preserve</a>} to
convert any newlines inside whitespace-sensitive tags into the <a
href="index.html?a=C00000105&name=HTML">HTML</a> entities for endlines.
</p>
<p>
@param tags [Array&lt;String&gt;] Tags that should have newlines escaped
</p>
<p>
@overload <a
href="index.html?a=M001142&name=find_and_preserve">find_and_preserve</a>(input,
tags = haml_buffer.options[:preserve])
</p>
<pre>
  Escapes newlines within a string.

  @param input [String] The string within which to escape newlines
</pre>
<p>
@overload <a
href="index.html?a=M001142&name=find_and_preserve">find_and_preserve</a>(tags
= haml_buffer.options[:preserve])
</p>
<pre>
  Escapes newlines within a block of Haml code.

  @yield The block within which to escape newlines
</pre>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001142_source')" id="l_M001142_source">show source</a> ]</p>
  <div id="M001142_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File lib/haml/helpers.rb, line 109</span>
109:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">find_and_preserve</span>(<span class="ruby-identifier">input</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">tags</span> = <span class="ruby-identifier">haml_buffer</span>.<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:preserve</span>], <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
110:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">find_and_preserve</span>(<span class="ruby-identifier">capture_haml</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>), <span class="ruby-identifier">input</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">tags</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block</span>
111:       <span class="ruby-identifier">input</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-node">/&lt;(#{tags.map(&amp;Regexp.method(:escape)).join('|')})([^&gt;]*)&gt;(.*?)(&lt;\/\1&gt;)/i</span><span class="ruby-identifier">m</span>) <span class="ruby-keyword kw">do</span>
112:         <span class="ruby-node">&quot;&lt;#{$1}#{$2}&gt;#{preserve($3)}&lt;/#{$1}&gt;&quot;</span>
113:       <span class="ruby-keyword kw">end</span>
114:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001144" class="method">
  <div id="M001144_title" class="title">
    <b>flatten</b>(input = nil, &amp;block)
  </div>
  <div class="description">
  <p>
Alias for <a href="index.html?a=M001143&name=preserve">preserve</a>
</p>
  </div>
</div>
<div id="M001154" class="method">
  <div id="M001154_title" class="title">
    <b>haml_concat</b>(text = &quot;&quot;)
  </div>
  <div class="description">
  <p>
Outputs text directly to the <a
href="index.html?a=C00000072&name=Haml">Haml</a> buffer, with the proper
indentation.
</p>
<p>
@param text [to_s] The text to output
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001154_source')" id="l_M001154_source">show source</a> ]</p>
  <div id="M001154_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File lib/haml/helpers.rb, line 368</span>
368:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">haml_concat</span>(<span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;&quot;</span>)
369:       <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">haml_buffer</span>.<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:ugly</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">haml_indent</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
370:         <span class="ruby-identifier">haml_buffer</span>.<span class="ruby-identifier">buffer</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">haml_indent</span> <span class="ruby-operator">&lt;&lt;</span>
371:           <span class="ruby-identifier">text</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-value str">&quot;\n&quot;</span>, <span class="ruby-value str">&quot;\n&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">haml_indent</span>) <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;\n&quot;</span>
372:       <span class="ruby-keyword kw">else</span>
373:         <span class="ruby-identifier">haml_buffer</span>.<span class="ruby-identifier">buffer</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">text</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;\n&quot;</span>
374:       <span class="ruby-keyword kw">end</span>
375:       <span class="ruby-constant">ErrorReturn</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;haml_concat&quot;</span>)
376:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001155" class="method">
  <div id="M001155_title" class="title">
    <b>haml_indent</b>()
  </div>
  <div class="description">
  <p>
@return [String] The indentation string for the current line
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001155_source')" id="l_M001155_source">show source</a> ]</p>
  <div id="M001155_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File lib/haml/helpers.rb, line 379</span>
379:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">haml_indent</span>
380:       <span class="ruby-value str">'  '</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">haml_buffer</span>.<span class="ruby-identifier">tabulation</span>
381:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001156" class="method">
  <div id="M001156_title" class="title">
    <b>haml_tag</b>(name, *rest, &amp;block)
  </div>
  <div class="description">
  <p>
Creates an <a href="index.html?a=C00000105&name=HTML">HTML</a> tag with the
given name and optionally text and attributes. Can take a block that will
run between the opening and closing tags. If the block is a <a
href="index.html?a=C00000072&name=Haml">Haml</a> block or outputs text
using \{haml_concat}, the text will be properly indented.
</p>
<p>
`name` can be a string using the standard <a
href="index.html?a=C00000072&name=Haml">Haml</a> class/id shorthand (e.g.
&quot;spanfoo.bar&quot;, &quot;foo&quot;). Just like standard <a
href="index.html?a=C00000072&name=Haml">Haml</a> tags, these class and id
values will be merged with manually-specified attributes.
</p>
<p>
`flags` is a list of symbol flags like those that can be put at the end of
a <a href="index.html?a=C00000072&name=Haml">Haml</a> tag (`:/`, `:&lt;`,
and `:&gt;`). Currently, only `:/` and `:&lt;` are supported.
</p>
<p>
`<a href="index.html?a=M001156&name=haml_tag">haml_tag</a>` outputs
directly to the buffer; its return value should not be used. If you need to
get the results as a string, use \{capture_haml\}.
</p>
<p>
For example,
</p>
<pre>
    haml_tag :table do
      haml_tag :tr do
        haml_tag 'td.cell' do
          haml_tag :strong, &quot;strong!&quot;
          haml_concat &quot;data&quot;
        end
        haml_tag :td do
          haml_concat &quot;more_data&quot;
        end
      end
    end
</pre>
<p>
outputs
</p>
<pre>
    &lt;table&gt;
      &lt;tr&gt;
        &lt;td class='cell'&gt;
          &lt;strong&gt;
            strong!
          &lt;/strong&gt;
          data
        &lt;/td&gt;
        &lt;td&gt;
          more_data
        &lt;/td&gt;
      &lt;/tr&gt;
    &lt;/table&gt;
</pre>
<p>
@param name [to_s] The name of the tag @param flags [Array&lt;Symbol&gt;]
<a href="index.html?a=C00000072&name=Haml">Haml</a> end-of-tag flags
</p>
<p>
@overload <a href="index.html?a=M001156&name=haml_tag">haml_tag</a>(name,
*flags, attributes = {})
</p>
<pre>
  @yield The block of Haml code within the tag
</pre>
<p>
@overload <a href="index.html?a=M001156&name=haml_tag">haml_tag</a>(name,
text, *flags, attributes = {})
</p>
<pre>
  @param text [#to_s] The text within the tag
</pre>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001156_source')" id="l_M001156_source">show source</a> ]</p>
  <div id="M001156_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File lib/haml/helpers.rb, line 440</span>
440:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">haml_tag</span>(<span class="ruby-identifier">name</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">rest</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
441:       <span class="ruby-identifier">ret</span> = <span class="ruby-constant">ErrorReturn</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;haml_tag&quot;</span>)
442: 
443:       <span class="ruby-identifier">text</span> = <span class="ruby-identifier">rest</span>.<span class="ruby-identifier">shift</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-keyword kw">unless</span> [<span class="ruby-constant">Symbol</span>, <span class="ruby-constant">Hash</span>, <span class="ruby-constant">NilClass</span>].<span class="ruby-identifier">any?</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span> <span class="ruby-identifier">rest</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-identifier">t</span>}
444:       <span class="ruby-identifier">flags</span> = []
445:       <span class="ruby-identifier">flags</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">rest</span>.<span class="ruby-identifier">shift</span> <span class="ruby-keyword kw">while</span> <span class="ruby-identifier">rest</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">Symbol</span>
446:       <span class="ruby-identifier">name</span>, <span class="ruby-identifier">attrs</span> = <span class="ruby-identifier">merge_name_and_attributes</span>(<span class="ruby-identifier">name</span>.<span class="ruby-identifier">to_s</span>, <span class="ruby-identifier">rest</span>.<span class="ruby-identifier">shift</span> <span class="ruby-operator">||</span> {})
447: 
448:       <span class="ruby-identifier">attributes</span> = <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Precompiler</span>.<span class="ruby-identifier">build_attributes</span>(<span class="ruby-identifier">haml_buffer</span>.<span class="ruby-identifier">html?</span>,
449:                                                       <span class="ruby-identifier">haml_buffer</span>.<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:attr_wrapper</span>],
450:                                                       <span class="ruby-identifier">attrs</span>)
451: 
452:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">text</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">block</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">haml_buffer</span>.<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:autoclose</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">name</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">flags</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">:/</span>))
453:         <span class="ruby-identifier">haml_concat</span> <span class="ruby-node">&quot;&lt;#{name}#{attributes} /&gt;&quot;</span>
454:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">ret</span>
455:       <span class="ruby-keyword kw">end</span>
456: 
457:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">flags</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">:/</span>)
458:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;Self-closing tags can't have content.&quot;</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">text</span>
459:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;Illegal nesting: nesting within a self-closing tag is illegal.&quot;</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block</span>
460:       <span class="ruby-keyword kw">end</span>
461: 
462:       <span class="ruby-identifier">tag</span> = <span class="ruby-node">&quot;&lt;#{name}#{attributes}&gt;&quot;</span>
463:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block</span>.<span class="ruby-identifier">nil?</span>
464:         <span class="ruby-identifier">text</span> = <span class="ruby-identifier">text</span>.<span class="ruby-identifier">to_s</span>
465:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">text</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-value str">&quot;\n&quot;</span>)
466:           <span class="ruby-identifier">haml_concat</span> <span class="ruby-identifier">tag</span>
467:           <span class="ruby-identifier">tab_up</span>
468:           <span class="ruby-identifier">haml_concat</span> <span class="ruby-identifier">text</span>
469:           <span class="ruby-identifier">tab_down</span>
470:           <span class="ruby-identifier">haml_concat</span> <span class="ruby-node">&quot;&lt;/#{name}&gt;&quot;</span>
471:         <span class="ruby-keyword kw">else</span>
472:           <span class="ruby-identifier">tag</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">text</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;&lt;/#{name}&gt;&quot;</span>
473:           <span class="ruby-identifier">haml_concat</span> <span class="ruby-identifier">tag</span>
474:         <span class="ruby-keyword kw">end</span>
475:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">ret</span>
476:       <span class="ruby-keyword kw">end</span>
477: 
478:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">text</span>
479:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span>.<span class="ruby-identifier">new</span>(<span class="ruby-node">&quot;Illegal nesting: content can't be both given to haml_tag :#{name} and nested within it.&quot;</span>)
480:       <span class="ruby-keyword kw">end</span>
481: 
482:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">flags</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">:&lt;</span>)
483:         <span class="ruby-identifier">tag</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">capture_haml</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>).<span class="ruby-identifier">strip</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;&lt;/#{name}&gt;&quot;</span>
484:         <span class="ruby-identifier">haml_concat</span> <span class="ruby-identifier">tag</span>
485:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">ret</span>
486:       <span class="ruby-keyword kw">end</span>
487: 
488:       <span class="ruby-identifier">haml_concat</span> <span class="ruby-identifier">tag</span>
489:       <span class="ruby-identifier">tab_up</span>
490:       <span class="ruby-identifier">block</span>.<span class="ruby-identifier">call</span>
491:       <span class="ruby-identifier">tab_down</span>
492:       <span class="ruby-identifier">haml_concat</span> <span class="ruby-node">&quot;&lt;/#{name}&gt;&quot;</span>
493: 
494:       <span class="ruby-identifier">ret</span>
495:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001146" class="method">
  <div id="M001146_title" class="title">
    <b>html_attrs</b>(lang = 'en-US')
  </div>
  <div class="description">
  <p>
Returns a hash containing default assignments for the `xmlns`, `lang`, and
`xml:lang` attributes of the `html` <a
href="index.html?a=C00000105&name=HTML">HTML</a> element. For example,
</p>
<pre>
    %html{html_attrs}
</pre>
<p>
becomes
</p>
<pre>
    &lt;html xmlns='http://www.w3.org/1999/xhtml' xml:lang='en-US' lang='en-US'&gt;
</pre>
<p>
@param lang [String] The value of `xml:lang` and `lang` @return [{to_s
=&gt; String}] The attribute hash
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001146_source')" id="l_M001146_source">show source</a> ]</p>
  <div id="M001146_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File lib/haml/helpers.rb, line 197</span>
197:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">html_attrs</span>(<span class="ruby-identifier">lang</span> = <span class="ruby-value str">'en-US'</span>)
198:       {<span class="ruby-identifier">:xmlns</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;http://www.w3.org/1999/xhtml&quot;</span>, <span class="ruby-value str">'xml:lang'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">lang</span>, <span class="ruby-identifier">:lang</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">lang</span>}
199:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001157" class="method">
  <div id="M001157_title" class="title">
    <b>html_escape</b>(text)
  </div>
  <div class="description">
  <p>
Returns a copy of `text` with ampersands, angle brackets and quotes escaped
into <a href="index.html?a=C00000105&name=HTML">HTML</a> entities.
</p>
<p>
Note that if <a
href="index.html?a=C00000185&name=ActionView">ActionView</a> is loaded and
XSS protection is enabled (as is the default for Rails 3.0+, and optional
for version 2.3.5+), this won&#8217;t escape text declared as
&quot;safe&quot;.
</p>
<p>
@param text [String] The string to sanitize @return [String] The sanitized
string
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001157_source')" id="l_M001157_source">show source</a> ]</p>
  <div id="M001157_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File lib/haml/helpers.rb, line 509</span>
509:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">html_escape</span>(<span class="ruby-identifier">text</span>)
510:       <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Util</span>.<span class="ruby-identifier">silence_warnings</span> {<span class="ruby-identifier">text</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/[\&quot;&gt;&lt;&amp;]/n</span>) {<span class="ruby-operator">|</span><span class="ruby-identifier">s</span><span class="ruby-operator">|</span> <span class="ruby-constant">HTML_ESCAPE</span>[<span class="ruby-identifier">s</span>]}}
511:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001140" class="method">
  <div id="M001140_title" class="title">
    <b>init_haml_helpers</b>()
  </div>
  <div class="description">
  <p>
Note: this does *<b>not</b>* need to be called when using <a
href="index.html?a=C00000072&name=Haml">Haml</a> helpers normally in Rails.
</p>
<p>
Initializes the current object as though it were in the same context as a
normal <a href="index.html?a=C00000185&name=ActionView">ActionView</a>
instance using <a href="index.html?a=C00000072&name=Haml">Haml</a>. This is
useful if you want to use the helpers in a context other than the normal
setup with <a href="index.html?a=C00000185&name=ActionView">ActionView</a>.
For example:
</p>
<pre>
    context = Object.new
    class &lt;&lt; context
      include Haml::Helpers
    end
    context.init_haml_helpers
    context.haml_tag :p, &quot;Stuff&quot;
</pre>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001140_source')" id="l_M001140_source">show source</a> ]</p>
  <div id="M001140_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File lib/haml/helpers.rb, line 74</span>
74:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">init_haml_helpers</span>
75:       <span class="ruby-ivar">@haml_buffer</span> = <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Buffer</span>.<span class="ruby-identifier">new</span>(<span class="ruby-ivar">@haml_buffer</span>, <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Engine</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">''</span>).<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:options_for_buffer</span>))
76:       <span class="ruby-keyword kw">nil</span>
77:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001159" class="method">
  <div id="M001159_title" class="title">
    <b>is_haml?</b>()
  </div>
  <div class="description">
  <p>
Returns whether or not the current template is a <a
href="index.html?a=C00000072&name=Haml">Haml</a> template.
</p>
<p>
This function, unlike other {<a
href="index.html?a=C00000078&name=Haml::Helpers">Haml::Helpers</a>}
functions, also works in other `<a
href="index.html?a=C00000185&name=ActionView">ActionView</a>` templates,
where it will always return false.
</p>
<p>
@return [Boolean] Whether or not the current template is a <a
href="index.html?a=C00000072&name=Haml">Haml</a> template
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001159_source')" id="l_M001159_source">show source</a> ]</p>
  <div id="M001159_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File lib/haml/helpers.rb, line 531</span>
531:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">is_haml?</span>
532:       <span class="ruby-operator">!</span><span class="ruby-ivar">@haml_buffer</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@haml_buffer</span>.<span class="ruby-identifier">active?</span>
533:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001145" class="method">
  <div id="M001145_title" class="title">
    <b>list_of</b>(enum, &amp;block)
  </div>
  <div class="description">
  <p>
Takes an `Enumerable` object and a block and iterates over the enum,
yielding each element to a <a
href="index.html?a=C00000072&name=Haml">Haml</a> block and putting the
result into `&lt;li&gt;` elements. This creates a list of the results of
the block. For example:
</p>
<pre>
    = list_of([['hello'], ['yall']]) do |i|
      = i[0]
</pre>
<p>
Produces:
</p>
<pre>
    &lt;li&gt;hello&lt;/li&gt;
    &lt;li&gt;yall&lt;/li&gt;
</pre>
<p>
And
</p>
<pre>
    = list_of({:title =&gt; 'All the stuff', :description =&gt; 'A book about all the stuff.'}) do |key, val|
      %h3= key.humanize
      %p= val
</pre>
<p>
Produces:
</p>
<pre>
    &lt;li&gt;
      &lt;h3&gt;Title&lt;/h3&gt;
      &lt;p&gt;All the stuff&lt;/p&gt;
    &lt;/li&gt;
    &lt;li&gt;
      &lt;h3&gt;Description&lt;/h3&gt;
      &lt;p&gt;A book about all the stuff.&lt;/p&gt;
    &lt;/li&gt;
</pre>
<p>
@param enum [Enumerable] The list of objects to iterate over @yield [item]
A block which contains <a href="index.html?a=C00000072&name=Haml">Haml</a>
code that goes within list items @yieldparam item An element of `enum`
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001145_source')" id="l_M001145_source">show source</a> ]</p>
  <div id="M001145_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File lib/haml/helpers.rb, line 169</span>
169:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">list_of</span>(<span class="ruby-identifier">enum</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
170:       <span class="ruby-identifier">to_return</span> = <span class="ruby-identifier">enum</span>.<span class="ruby-identifier">collect</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span>
171:         <span class="ruby-identifier">result</span> = <span class="ruby-identifier">capture_haml</span>(<span class="ruby-identifier">i</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
172: 
173:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">result</span>.<span class="ruby-identifier">count</span>(<span class="ruby-value str">&quot;\n&quot;</span>) <span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>
174:           <span class="ruby-identifier">result</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-value str">&quot;\n&quot;</span>, <span class="ruby-value str">&quot;\n  &quot;</span>)
175:           <span class="ruby-identifier">result</span> = <span class="ruby-node">&quot;\n  #{result.strip}\n&quot;</span>
176:         <span class="ruby-keyword kw">else</span>
177:           <span class="ruby-identifier">result</span>.<span class="ruby-identifier">strip!</span>
178:         <span class="ruby-keyword kw">end</span>
179: 
180:         <span class="ruby-node">&quot;&lt;li&gt;#{result}&lt;/li&gt;&quot;</span>
181:       <span class="ruby-keyword kw">end</span>
182:       <span class="ruby-identifier">to_return</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;\n&quot;</span>)
183:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001141" class="method">
  <div id="M001141_title" class="title">
    <b>non_haml</b>() {|| ...}
  </div>
  <div class="description">
  <p>
Runs a block of code in a non-<a
href="index.html?a=C00000072&name=Haml">Haml</a> context (i.e. \{is_haml?}
will return false).
</p>
<p>
This is mainly useful for rendering sub-templates such as partials in a
non-<a href="index.html?a=C00000072&name=Haml">Haml</a> language,
particularly where helpers may behave differently when run from <a
href="index.html?a=C00000072&name=Haml">Haml</a>.
</p>
<p>
Note that this is automatically applied to Rails partials.
</p>
<p>
@yield A block which won&#8217;t register as <a
href="index.html?a=C00000072&name=Haml">Haml</a>
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001141_source')" id="l_M001141_source">show source</a> ]</p>
  <div id="M001141_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File lib/haml/helpers.rb, line 88</span>
88:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">non_haml</span>
89:       <span class="ruby-identifier">was_active</span> = <span class="ruby-ivar">@haml_buffer</span>.<span class="ruby-identifier">active?</span>
90:       <span class="ruby-ivar">@haml_buffer</span>.<span class="ruby-identifier">active</span> = <span class="ruby-keyword kw">false</span>
91:       <span class="ruby-keyword kw">yield</span>
92:     <span class="ruby-keyword kw">ensure</span>
93:       <span class="ruby-ivar">@haml_buffer</span>.<span class="ruby-identifier">active</span> = <span class="ruby-identifier">was_active</span>
94:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001151" class="method">
  <div id="M001151_title" class="title">
    <b>precede</b>(str, &amp;block)
  </div>
  <div class="description">
  <p>
Prepends a string to the beginning of a <a
href="index.html?a=C00000072&name=Haml">Haml</a> block, with no whitespace
between. For example:
</p>
<pre>
    = precede '*' do
      %span.small Not really
</pre>
<p>
Produces:
</p>
<pre>
    *&lt;span class='small'&gt;Not really&lt;/span&gt;
</pre>
<p>
@param str [String] The string to add before the <a
href="index.html?a=C00000072&name=Haml">Haml</a> @yield A block of <a
href="index.html?a=C00000072&name=Haml">Haml</a> to prepend to
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001151_source')" id="l_M001151_source">show source</a> ]</p>
  <div id="M001151_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File lib/haml/helpers.rb, line 301</span>
301:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">precede</span>(<span class="ruby-identifier">str</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
302:       <span class="ruby-node">&quot;#{str}#{capture_haml(&amp;block).chomp}\n&quot;</span>
303:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001143" class="method">
  <div id="M001143_title" class="title">
    <b>preserve</b>(input = nil, &amp;block)
  </div>
  <div class="description">
  <p>
Takes any string, finds all the newlines, and converts them to <a
href="index.html?a=C00000105&name=HTML">HTML</a> entities so they&#8217;ll
render correctly in whitespace-sensitive tags without screwing up the
indentation.
</p>
<p>
@overload perserve(input)
</p>
<pre>
  Escapes newlines within a string.

  @param input [String] The string within which to escape all newlines
</pre>
<p>
@overload perserve
</p>
<pre>
  Escapes newlines within a block of Haml code.

  @yield The block within which to escape newlines
</pre>
  </div>
<div class="aka">
  This method is also aliased as
  <a href="index.html?a=M001144&name=flatten">flatten</a>
</div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001143_source')" id="l_M001143_source">show source</a> ]</p>
  <div id="M001143_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File lib/haml/helpers.rb, line 128</span>
128:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">preserve</span>(<span class="ruby-identifier">input</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
129:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">preserve</span>(<span class="ruby-identifier">capture_haml</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block</span>
130:       <span class="ruby-identifier">input</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">chomp</span>(<span class="ruby-value str">&quot;\n&quot;</span>).<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/\n/</span>, <span class="ruby-value str">'&amp;#x000A;'</span>).<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/\r/</span>, <span class="ruby-value str">''</span>)
131:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001161" class="method">
  <div id="M001161_title" class="title">
    <b>something_that_uses_haml_concat</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001161_source')" id="l_M001161_source">show source</a> ]</p>
  <div id="M001161_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File test/haml/helper_test.rb, line 11</span>
11:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">something_that_uses_haml_concat</span>
12:     <span class="ruby-identifier">haml_concat</span>(<span class="ruby-value str">'foo'</span>).<span class="ruby-identifier">to_s</span>
13:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001152" class="method">
  <div id="M001152_title" class="title">
    <b>succeed</b>(str, &amp;block)
  </div>
  <div class="description">
  <p>
Appends a string to the end of a <a
href="index.html?a=C00000072&name=Haml">Haml</a> block, with no whitespace
between. For example:
</p>
<pre>
    click
    = succeed '.' do
      %a{:href=&gt;&quot;thing&quot;} here
</pre>
<p>
Produces:
</p>
<pre>
    click
    &lt;a href='thing'&gt;here&lt;/a&gt;.
</pre>
<p>
@param str [String] The string to add after the <a
href="index.html?a=C00000072&name=Haml">Haml</a> @yield A block of <a
href="index.html?a=C00000072&name=Haml">Haml</a> to append to
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001152_source')" id="l_M001152_source">show source</a> ]</p>
  <div id="M001152_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File lib/haml/helpers.rb, line 320</span>
320:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">succeed</span>(<span class="ruby-identifier">str</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
321:       <span class="ruby-node">&quot;#{capture_haml(&amp;block).chomp}#{str}\n&quot;</span>
322:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001150" class="method">
  <div id="M001150_title" class="title">
    <b>surround</b>(front, back = front, &amp;block)
  </div>
  <div class="description">
  <p>
Surrounds a block of <a href="index.html?a=C00000072&name=Haml">Haml</a>
code with strings, with no whitespace in between. For example:
</p>
<pre>
    = surround '(', ')' do
      %a{:href =&gt; &quot;food&quot;} chicken
</pre>
<p>
Produces:
</p>
<pre>
    (&lt;a href='food'&gt;chicken&lt;/a&gt;)
</pre>
<p>
and
</p>
<pre>
    = surround '*' do
      %strong angry
</pre>
<p>
Produces:
</p>
<pre>
    *&lt;strong&gt;angry&lt;/strong&gt;*
</pre>
<p>
@param front [String] The string to add before the <a
href="index.html?a=C00000072&name=Haml">Haml</a> @param back [String] The
string to add after the <a href="index.html?a=C00000072&name=Haml">Haml</a>
@yield A block of <a href="index.html?a=C00000072&name=Haml">Haml</a> to
surround
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001150_source')" id="l_M001150_source">show source</a> ]</p>
  <div id="M001150_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File lib/haml/helpers.rb, line 282</span>
282:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">surround</span>(<span class="ruby-identifier">front</span>, <span class="ruby-identifier">back</span> = <span class="ruby-identifier">front</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
283:       <span class="ruby-identifier">output</span> = <span class="ruby-identifier">capture_haml</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
284: 
285:       <span class="ruby-node">&quot;#{front}#{output.chomp}#{back}\n&quot;</span>
286:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001148" class="method">
  <div id="M001148_title" class="title">
    <b>tab_down</b>(i = 1)
  </div>
  <div class="description">
  <p>
Decrements the number of tabs the buffer automatically adds to the lines of
the template.
</p>
<p>
@param i [Fixnum] The number of tabs by which to decrease the indentation
@see <a href="index.html?a=M001147&name=tab_up">tab_up</a>
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001148_source')" id="l_M001148_source">show source</a> ]</p>
  <div id="M001148_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File lib/haml/helpers.rb, line 228</span>
228:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">tab_down</span>(<span class="ruby-identifier">i</span> = <span class="ruby-value">1</span>)
229:       <span class="ruby-identifier">haml_buffer</span>.<span class="ruby-identifier">tabulation</span> <span class="ruby-operator">-=</span> <span class="ruby-identifier">i</span>
230:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001147" class="method">
  <div id="M001147_title" class="title">
    <b>tab_up</b>(i = 1)
  </div>
  <div class="description">
  <p>
Increments the number of tabs the buffer automatically adds to the lines of
the template. For example:
</p>
<pre>
    %h1 foo
    - tab_up
    %p bar
    - tab_down
    %strong baz
</pre>
<p>
Produces:
</p>
<pre>
    &lt;h1&gt;foo&lt;/h1&gt;
      &lt;p&gt;bar&lt;/p&gt;
    &lt;strong&gt;baz&lt;/strong&gt;
</pre>
<p>
@param i [Fixnum] The number of tabs by which to increase the indentation
@see <a href="index.html?a=M001148&name=tab_down">tab_down</a>
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001147_source')" id="l_M001147_source">show source</a> ]</p>
  <div id="M001147_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File lib/haml/helpers.rb, line 219</span>
219:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">tab_up</span>(<span class="ruby-identifier">i</span> = <span class="ruby-value">1</span>)
220:       <span class="ruby-identifier">haml_buffer</span>.<span class="ruby-identifier">tabulation</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">i</span>
221:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001162" class="method">
  <div id="M001162_title" class="title">
    <b>test_partial</b>(name, locals = {})
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001162_source')" id="l_M001162_source">show source</a> ]</p>
  <div id="M001162_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File test/haml/template_test.rb, line 17</span>
17:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_partial</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">locals</span> = {})
18:     <span class="ruby-constant">Haml</span><span class="ruby-operator">::</span><span class="ruby-constant">Engine</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-constant">TemplateTest</span><span class="ruby-operator">::</span><span class="ruby-constant">TEMPLATE_PATH</span>, <span class="ruby-node">&quot;_#{name}.haml&quot;</span>))).<span class="ruby-identifier">render</span>(<span class="ruby-keyword kw">self</span>, <span class="ruby-identifier">locals</span>)
19:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001149" class="method">
  <div id="M001149_title" class="title">
    <b>with_tabs</b>(i) {|| ...}
  </div>
  <div class="description">
  <p>
Sets the number of tabs the buffer automatically adds to the lines of the
template, but only for the duration of the block. For example:
</p>
<pre>
    %h1 foo
    - with_tabs(2) do
      %p bar
    %strong baz
</pre>
<p>
Produces:
</p>
<pre>
    &lt;h1&gt;foo&lt;/h1&gt;
        &lt;p&gt;bar&lt;/p&gt;
    &lt;strong&gt;baz&lt;/strong&gt;
</pre>
<p>
@param i [Fixnum] The number of tabs to use @yield A block in which the
indentation will be `i` spaces
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001149_source')" id="l_M001149_source">show source</a> ]</p>
  <div id="M001149_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File lib/haml/helpers.rb, line 251</span>
251:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">with_tabs</span>(<span class="ruby-identifier">i</span>)
252:       <span class="ruby-identifier">old_tabs</span> = <span class="ruby-identifier">haml_buffer</span>.<span class="ruby-identifier">tabulation</span>
253:       <span class="ruby-identifier">haml_buffer</span>.<span class="ruby-identifier">tabulation</span> = <span class="ruby-identifier">i</span>
254:       <span class="ruby-keyword kw">yield</span>
255:     <span class="ruby-keyword kw">ensure</span>
256:       <span class="ruby-identifier">haml_buffer</span>.<span class="ruby-identifier">tabulation</span> = <span class="ruby-identifier">old_tabs</span>
257:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
</div>

  </div>