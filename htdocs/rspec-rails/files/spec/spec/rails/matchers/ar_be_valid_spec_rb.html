  <div id="fileHeader">
    <h1>ar_be_valid_spec.rb</h1>
    <table class="header-table">
    <tr class="top-aligned-row">
      <td><strong>Path:</strong></td>
      <td>spec/spec/rails/matchers/ar_be_valid_spec.rb</td>
    </tr>
    <tr class="top-aligned-row">
      <td><strong>Last Update:</strong></td>
      <td>Mon Dec 29 13:13:00 +0100 2008</td>
    </tr>
    </table>
  </div>
 <!-- banner header -->

  <div id="bodyContent" >
    <h2>Source Code</h2>
    <pre>require File.dirname(__FILE__) + '/../../../spec_helper'

describe &quot;be_valid&quot; do
  class CanBeValid
    def initialize(valid)
      @valid = valid
    end
    def valid?; @valid end
  end

  it &quot;should behave like normal be_valid matcher&quot; do
    CanBeValid.new(true).should be_valid
    CanBeValid.new(false).should_not be_valid
  end

  class CanHaveErrors
    def initialize(errors)
      @valid = !errors
      @errors = ActiveRecord::Errors.new self
      @errors.add :name, &quot;is too short&quot;
    end
    attr_reader :errors
    def valid?; @valid end

    def self.human_attribute_name(ignore)
      &quot;Name&quot;
    end
  end

  it &quot;should show errors in the output if they're available&quot; do
    lambda { 
      CanHaveErrors.new(true).should be_valid
    }.should fail_with(/Name is too short/)
  end
end
</pre>
    </div>