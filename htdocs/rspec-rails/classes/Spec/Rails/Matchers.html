  <div id="C00000025">
<div class='banner'>
  <span class="file-title-prefix">Module</span><br />Matchers<br/>
  In:
<a href="#" onclick="jsHref('files/lib/spec/rails/matchers/redirect_to_rb.html');">lib/spec/rails/matchers/redirect_to.rb</a>
<a href="#" onclick="jsHref('files/lib/spec/rails/matchers/have_text_rb.html');">lib/spec/rails/matchers/have_text.rb</a>
<a href="#" onclick="jsHref('files/lib/spec/rails/matchers/ar_be_valid_rb.html');">lib/spec/rails/matchers/ar_be_valid.rb</a>
<a href="#" onclick="jsHref('files/lib/spec/rails/matchers/render_template_rb.html');">lib/spec/rails/matchers/render_template.rb</a>
<a href="#" onclick="jsHref('files/lib/spec/rails/matchers/include_text_rb.html');">lib/spec/rails/matchers/include_text.rb</a>
<a href="#" onclick="jsHref('files/lib/spec/rails/matchers/assert_select_rb.html');">lib/spec/rails/matchers/assert_select.rb</a>
<a href="#" onclick="jsHref('files/lib/spec/rails/matchers_rb.html');">lib/spec/rails/matchers.rb</a>

</div>
 <!-- banner header -->

  <div id="bodyContent" >
      <div id="content">

  <div class="description"><p>
Spec::Rails::Expectations::Matchers provides several expectation matchers
intended to work with Rails components like models and responses. For
example:
</p>
<pre>
  response.should redirect_to(&quot;some/url&quot;) #redirect_to(url) is the matcher.
</pre>
<p>
In addition to those you see below, the arbitrary predicate feature of
RSpec makes the following available as well:
</p>
<pre>
  response.should be_success #passes if response.success?
  response.should be_redirect #passes if response.redirect?
</pre>
<p>
Note that many of these matchers are part of a wrapper of
<tt>assert_select</tt>, so the documentation comes straight from that with
some slight modifications. <tt>assert_select</tt> is a <a
href="index.html?a=C00000059&name=Test::Unit">Test::Unit</a> extension
originally contributed to the Rails community as a plugin by Assaf Arkin
and eventually shipped as part of Rails.
</p>
<p>
For more info on <tt>assert_select</tt>, see the relevant Rails
documentation.
</p>
</div>



  <div class="sectiontitle">Methods</div>
  <ul>
  <li><a href="index.html?a=M000019&name=be_valid" >be_valid</a></li>
  <li><a href="index.html?a=M000025&name=have_rjs" >have_rjs</a></li>
  <li><a href="index.html?a=M000022&name=have_tag" >have_tag</a></li>
  <li><a href="index.html?a=M000018&name=have_text" >have_text</a></li>
  <li><a href="index.html?a=M000021&name=include_text" >include_text</a></li>
  <li><a href="index.html?a=M000017&name=redirect_to" >redirect_to</a></li>
  <li><a href="index.html?a=M000020&name=render_template" >render_template</a></li>
  <li><a href="index.html?a=M000026&name=send_email" >send_email</a></li>
  <li><a href="index.html?a=M000027&name=with_encoded" >with_encoded</a></li>
  <li><a href="index.html?a=M000023&name=with_tag" >with_tag</a></li>
  <li><a href="index.html?a=M000024&name=without_tag" >without_tag</a></li>
  </ul>






<div class="sectiontitle">Public Instance methods</div>
<div id="M000019" class="method">
  <div id="M000019_title" class="title">
    <b>be_valid</b>()
  </div>
  <div class="description">
  <p>
:call-seq:
</p>
<pre>
  response.should be_valid
  response.should_not be_valid
</pre>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000019_source')" id="l_M000019_source">show source</a> ]</p>
  <div id="M000019_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File lib/spec/rails/matchers/ar_be_valid.rb, line 39</span>
39:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">be_valid</span>
40:           <span class="ruby-constant">ArBeValid</span>.<span class="ruby-identifier">new</span>
41:         <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000025" class="method">
  <div id="M000025_title" class="title">
    <b>response.should have_rjs(*args, &block)<br />
</b>
  </div>
  <div class="description">
  <p>
wrapper for assert_select_rjs
</p>
<p>
see documentation for assert_select_rjs at <a
href="http://api.rubyonrails.org"
target="_blank">http://api.rubyonrails.org</a>/
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000025_source')" id="l_M000025_source">show source</a> ]</p>
  <div id="M000025_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File lib/spec/rails/matchers/assert_select.rb, line 146</span>
146:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">have_rjs</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
147:         <span class="ruby-constant">AssertSelect</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">:assert_select_rjs</span>, <span class="ruby-keyword kw">self</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
148:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000022" class="method">
  <div id="M000022_title" class="title">
    <b>response.should have_tag(*args, &block)<br />
string.should have_tag(*args, &block)<br />
</b>
  </div>
  <div class="description">
  <p>
wrapper for assert_select with additional support for using css selectors
to set expectation on Strings. Use this in helper specs, for example, to
set expectations on the results of helper methods. Also allow specification
of how the response is parsed using the options :xml and :strict options.
By default, these options are set to false.
</p>
<h2>Examples</h2>
<pre>
  # in a controller spec
  response.should have_tag(&quot;div&quot;, &quot;some text&quot;)

  # to force xml and/or strict parsing of the response
  response.should have_tag(&quot;div&quot;, &quot;some text&quot;, :xml =&gt; true)
  response.should have_tag(&quot;div&quot;, &quot;some text&quot;, :strict =&gt; true)
  response.should have_tag(&quot;div&quot;, &quot;some text&quot;, :xml =&gt; true, :strict =&gt; false)

  # in a helper spec (person_address_tag is a method in the helper)
  person_address_tag.should have_tag(&quot;input#person_address&quot;)
</pre>
<p>
see documentation for assert_select at <a href="http://api.rubyonrails.org"
target="_blank">http://api.rubyonrails.org</a>/
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000022_source')" id="l_M000022_source">show source</a> ]</p>
  <div id="M000022_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File lib/spec/rails/matchers/assert_select.rb, line 112</span>
112:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">have_tag</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
113:         <span class="ruby-ivar">@__current_scope_for_assert_select</span> = <span class="ruby-constant">AssertSelect</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">:assert_select</span>, <span class="ruby-keyword kw">self</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
114:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000018" class="method">
  <div id="M000018_title" class="title">
    <b>response.should have_text(expected)<br />
response.should_not have_text(expected)<br />
</b>
  </div>
  <div class="description">
  <p>
Accepts a String or a Regexp, matching a String using == and a Regexp using
=~.
</p>
<p>
If response_or_text has a body, then that is used as to match against else
it uses response_or_text
</p>
<p>
Use this instead of <tt>response.should <a
href="index.html?a=M000022&name=have_tag">have_tag</a>()</tt> when you want
to match the whole string or whole body
</p>
<h2>Examples</h2>
<pre>
  response.should have_text(&quot;This is the expected text&quot;)
</pre>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000018_source')" id="l_M000018_source">show source</a> ]</p>
  <div id="M000018_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File lib/spec/rails/matchers/have_text.rb, line 51</span>
51:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">have_text</span>(<span class="ruby-identifier">text</span>)
52:         <span class="ruby-constant">HaveText</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">text</span>)
53:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000021" class="method">
  <div id="M000021_title" class="title">
    <b>response.should include_text(expected)<br />
response.should_not include_text(expected)<br />
</b>
  </div>
  <div class="description">
  <p>
Accepts a String, matching using include?
</p>
<p>
Use this instead of <tt>response.should <a
href="index.html?a=M000018&name=have_text">have_text</a>()</tt> when you
either don&#8217;t know or don&#8217;t care where on the page this text
appears.
</p>
<h2>Examples</h2>
<pre>
  response.should include_text(&quot;This text will be in the actual string&quot;)
</pre>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000021_source')" id="l_M000021_source">show source</a> ]</p>
  <div id="M000021_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File lib/spec/rails/matchers/include_text.rb, line 48</span>
48:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">include_text</span>(<span class="ruby-identifier">text</span>)
49:         <span class="ruby-constant">IncludeText</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">text</span>)
50:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000017" class="method">
  <div id="M000017_title" class="title">
    <b>response.should redirect_to(url)<br />
response.should redirect_to(:action => action_name)<br />
response.should redirect_to(:controller => controller_name, :action => action_name)<br />
response.should_not redirect_to(url)<br />
response.should_not redirect_to(:action => action_name)<br />
response.should_not redirect_to(:controller => controller_name, :action => action_name)<br />
</b>
  </div>
  <div class="description">
  <p>
Passes if the response is a redirect to the url, action or
controller/action. Useful in controller specs (integration or isolation
mode).
</p>
<h2>Examples</h2>
<pre>
  response.should redirect_to(&quot;path/to/action&quot;)
  response.should redirect_to(&quot;http://test.host/path/to/action&quot;)
  response.should redirect_to(:action =&gt; 'list')
</pre>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000017_source')" id="l_M000017_source">show source</a> ]</p>
  <div id="M000017_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File lib/spec/rails/matchers/redirect_to.rb, line 120</span>
120:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">redirect_to</span>(<span class="ruby-identifier">opts</span>)
121:         <span class="ruby-constant">RedirectTo</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">request</span>, <span class="ruby-identifier">opts</span>)
122:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000020" class="method">
  <div id="M000020_title" class="title">
    <b>response.should render_template(template)<br />
response.should_not render_template(template)<br />
</b>
  </div>
  <div class="description">
  <p>
For use in controller code examples (integration or isolation mode).
</p>
<p>
Passes if the specified template (view file) is rendered by the response.
This file can be any view file, including a partial. However if it is a
partial it must be rendered directly i.e. you can&#8217;t detect that a
partial has been rendered as part of a view using <a
href="index.html?a=M000020&name=render_template">render_template</a>. For
that you should use a message expectation (mock) instead:
</p>
<pre>
  controller.should_receive(:render).with(:partial =&gt; 'path/to/partial')
</pre>
<p>
<tt>template</tt> can include the controller path. It can also include an
optional extension, which you only need to use when there is ambiguity.
</p>
<p>
Note that partials must be spelled with the preceding underscore.
</p>
<h2>Examples</h2>
<pre>
  response.should render_template('list')
  response.should render_template('same_controller/list')
  response.should render_template('other_controller/list')

  # with extensions
  response.should render_template('list.rjs')
  response.should render_template('list.haml')
  response.should render_template('same_controller/list.rjs')
  response.should render_template('other_controller/list.rjs')

  # partials
  response.should render_template('_a_partial')
  response.should render_template('same_controller/_a_partial')
  response.should render_template('other_controller/_a_partial')
</pre>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000020_source')" id="l_M000020_source">show source</a> ]</p>
  <div id="M000020_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File lib/spec/rails/matchers/render_template.rb, line 117</span>
117:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">render_template</span>(<span class="ruby-identifier">path</span>)
118:         <span class="ruby-constant">RenderTemplate</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">path</span>.<span class="ruby-identifier">to_s</span>, <span class="ruby-ivar">@controller</span>)
119:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000026" class="method">
  <div id="M000026_title" class="title">
    <b>response.should send_email(*args, &block)<br />
</b>
  </div>
  <div class="description">
  <p>
wrapper for assert_select_email
</p>
<p>
see documentation for assert_select_email at <a
href="http://api.rubyonrails.org"
target="_blank">http://api.rubyonrails.org</a>/
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000026_source')" id="l_M000026_source">show source</a> ]</p>
  <div id="M000026_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File lib/spec/rails/matchers/assert_select.rb, line 156</span>
156:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">send_email</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
157:         <span class="ruby-constant">AssertSelect</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">:assert_select_email</span>, <span class="ruby-keyword kw">self</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
158:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000027" class="method">
  <div id="M000027_title" class="title">
    <b>with_encoded</b>(*args, &amp;block)
  </div>
  <div class="description">
  <p>
wrapper for assert_select_encoded
</p>
<p>
see documentation for assert_select_encoded at <a
href="http://api.rubyonrails.org"
target="_blank">http://api.rubyonrails.org</a>/
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000027_source')" id="l_M000027_source">show source</a> ]</p>
  <div id="M000027_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File lib/spec/rails/matchers/assert_select.rb, line 163</span>
163:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">with_encoded</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
164:         <span class="ruby-identifier">should</span> <span class="ruby-constant">AssertSelect</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">:assert_select_encoded</span>, <span class="ruby-keyword kw">self</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
165:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000023" class="method">
  <div id="M000023_title" class="title">
    <b>with_tag</b>(*args, &amp;block)
  </div>
  <div class="description">
  <p>
wrapper for a nested assert_select
</p>
<pre>
  response.should have_tag(&quot;div#form&quot;) do
    with_tag(&quot;input#person_name[name=?]&quot;, &quot;person[name]&quot;)
  end
</pre>
<p>
see documentation for assert_select at <a href="http://api.rubyonrails.org"
target="_blank">http://api.rubyonrails.org</a>/
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000023_source')" id="l_M000023_source">show source</a> ]</p>
  <div id="M000023_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File lib/spec/rails/matchers/assert_select.rb, line 123</span>
123:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">with_tag</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
124:         <span class="ruby-identifier">args</span> = <span class="ruby-identifier">prepare_args</span>(<span class="ruby-identifier">args</span>, <span class="ruby-ivar">@__current_scope_for_assert_select</span>)
125:         <span class="ruby-ivar">@__current_scope_for_assert_select</span>.<span class="ruby-identifier">should</span> <span class="ruby-identifier">have_tag</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
126:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000024" class="method">
  <div id="M000024_title" class="title">
    <b>without_tag</b>(*args, &amp;block)
  </div>
  <div class="description">
  <p>
wrapper for a nested assert_select with false
</p>
<pre>
  response.should have_tag(&quot;div#1&quot;) do
    without_tag(&quot;span&quot;, &quot;some text that shouldn't be there&quot;)
  end
</pre>
<p>
see documentation for assert_select at <a href="http://api.rubyonrails.org"
target="_blank">http://api.rubyonrails.org</a>/
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000024_source')" id="l_M000024_source">show source</a> ]</p>
  <div id="M000024_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File lib/spec/rails/matchers/assert_select.rb, line 135</span>
135:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">without_tag</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
136:         <span class="ruby-identifier">args</span> = <span class="ruby-identifier">prepare_args</span>(<span class="ruby-identifier">args</span>, <span class="ruby-ivar">@__current_scope_for_assert_select</span>)
137:         <span class="ruby-ivar">@__current_scope_for_assert_select</span>.<span class="ruby-identifier">should_not</span> <span class="ruby-identifier">have_tag</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
138:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
</div>

  </div>