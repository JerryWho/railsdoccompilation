<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta name="Content-Type" content="text/html; charset=utf-8" />
<title>Module: ActionView::Helpers::CaptureHelper</title>
<link rel="stylesheet" href="../../css/style.css" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="../../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '../..';
  if (relpath != '') relpath += '/';
</script>
<script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>

  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="../../_index.html">Index (C)</a> &raquo; 
    <span class='title'><span class='object_link'><a href="../../ActionView.html" title="ActionView (module)">ActionView</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Helpers.html" title="ActionView::Helpers (module)">Helpers</a></span></span>
     &raquo; 
    <span class="title">CaptureHelper</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  <a id="class_list_link" href="#">Class List</a>
  <a id="method_list_link" href="#">Method List</a>
  <a id ="file_list_link" href="#">File List</a>
</div>

      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><h1>Module: ActionView::Helpers::CaptureHelper
  
  
  
</h1>

<dl class="box">
  
  
    
  
    
  
  
    <dt class="r1">Included in:</dt>
    <dd class="r1"><span class='object_link'><a href="../Helpers.html" title="ActionView::Helpers (module)">ActionView::Helpers</a></span>, <span class='object_link'><a href="InstanceTagMethods.html" title="ActionView::Helpers::InstanceTagMethods (module)">InstanceTagMethods</a></span>, <span class='object_link'><a href="TagHelper.html" title="ActionView::Helpers::TagHelper (module)">TagHelper</a></span></dd>
    
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">actionpack/lib/action_view/helpers/capture_helper.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>
CaptureHelper exposes methods to let you extract generated markup which can
be used in other parts of a template or layout file.
</p>
<p>
It provides a method to capture blocks into variables through capture and a
way to capture a block of markup for use in a layout through content_for.
</p>


  </div>
</div>
<div class="tags">
  
</div>


  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#capture-instance_method" title="#capture (instance method)">- (Object) <strong>capture</strong>(*args) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
The capture method allows you to extract part of a template into a
variable.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#content_for-instance_method" title="#content_for (instance method)">- (Object) <strong>content_for</strong>(name, content = nil, &amp;block) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Calling content_for stores a block of markup in an identifier for later
use.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#content_for%3F-instance_method" title="#content_for? (instance method)">- (Boolean) <strong>content_for?</strong>(name) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
content_for? simply checks whether any content has been captured yet using
content_for Useful to render parts of your layout differently based on what
is in your views.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#flush_output_buffer-instance_method" title="#flush_output_buffer (instance method)">- (Object) <strong>flush_output_buffer</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Add the output buffer to the response body and start a new one.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#with_output_buffer-instance_method" title="#with_output_buffer (instance method)">- (Object) <strong>with_output_buffer</strong>(buf = nil) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Use an alternate output buffer for the duration of the block.
</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="capture-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>capture</strong>(*args) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
The capture method allows you to extract part of a template into a
variable. You can then use this variable anywhere in your templates or
layout.
</p>
<h4>Examples</h4>
<p>
The capture method can be used in ERb templates&#8230;
</p>
<pre class="code">
  &lt;% @greeting = capture do %&gt;
    Welcome to my shiny new web page!  The date and time is
    &lt;%= Time.now %&gt;
  &lt;% end %&gt;
</pre>
<p>
&#8230;and Builder (RXML) templates.
</p>
<pre class="code">
  <span class='ivar'>@timestamp</span> <span class='op'>=</span> <span class='id capture'>capture</span> <span class='kw'>do</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>The current timestamp is </span><span class='embexpr_beg'>#{</span><span class='const'>Time</span><span class='period'>.</span><span class='id now'>now</span><span class='rbrace'>}</span><span class='tstring_content'>.</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
</pre>
<p>
You can then use that variable anywhere else.  For example:
</p>
<pre class="code">
  &lt;html&gt;
  &lt;head&gt;&lt;title&gt;&lt;%= @greeting %&gt;&lt;/title&gt;&lt;/head&gt;
  &lt;body&gt;
  &lt;b&gt;&lt;%= @greeting %&gt;&lt;/b&gt;
  &lt;/body&gt;&lt;/html&gt;</pre>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


37
38
39
40
41
42
43</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'actionpack/lib/action_view/helpers/capture_helper.rb', line 37</span>

<span class='kw'>def</span> <span class='id capture'>capture</span><span class='lparen'>(</span><span class='op'>*</span><span class='id args'>args</span><span class='rparen'>)</span>
  <span class='id value'>value</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id buffer'>buffer</span> <span class='op'>=</span> <span class='id with_output_buffer'>with_output_buffer</span> <span class='lbrace'>{</span> <span class='id value'>value</span> <span class='op'>=</span> <span class='kw'>yield</span><span class='lparen'>(</span><span class='op'>*</span><span class='id args'>args</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
  <span class='kw'>if</span> <span class='id string'>string</span> <span class='op'>=</span> <span class='id buffer'>buffer</span><span class='period'>.</span><span class='id presence'>presence</span> <span class='op'>||</span> <span class='id value'>value</span> <span class='kw'>and</span> <span class='id string'>string</span><span class='period'>.</span><span class='id is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>String</span><span class='rparen'>)</span>
    <span class='const'>NonConcattingString</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span><span class='id string'>string</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="content_for-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>content_for</strong>(name, content = nil, &amp;block) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Calling content_for stores a block of markup in an identifier for later
use. You can make subsequent calls to the stored content in other
templates, helper modules or the layout by passing the identifier as an
argument to <tt>content_for</tt>.
</p>
<p>
Note: <tt>yield</tt> can still be used to retrieve the stored content, but
calling <tt>yield</tt> doesn&#8217;t work in helper modules, while
<tt>content_for</tt> does.
</p>
<h4>Examples</h4>
<pre class="code">
  &lt;% content_for :not_authorized do %&gt;
    alert('You are not authorized to do that!')
  &lt;% end %&gt;
</pre>
<p>
You can then use <tt>content_for :not_authorized</tt> anywhere in your
templates.
</p>
<pre class="code">
  &lt;%= content_for :not_authorized if current_user.nil? %&gt;
</pre>
<p>
This is equivalent to:
</p>
<pre class="code">
  &lt;%= yield :not_authorized if current_user.nil? %&gt;
</pre>
<p>
<tt>content_for</tt>, however, can also be used in helper modules.
</p>
<pre class="code">
  <span class='kw'>module</span> <span class='const'>StorageHelper</span>
    <span class='kw'>def</span> <span class='id stored_content'>stored_content</span>
      <span class='id content_for'>content_for</span><span class='lparen'>(</span><span class='symbol'>:storage</span><span class='rparen'>)</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Your storage is empty</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
</pre>
<p>
This helper works just like normal helpers.
</p>
<pre class="code">
  &lt;%= stored_content %&gt;
</pre>
<p>
You can use the <tt>yield</tt> syntax alongside an existing call to
<tt>yield</tt> in a layout.  For example:
</p>
<pre class="code">
  &lt;%# This is the layout %&gt;
  &lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; xml:lang=&quot;en&quot; lang=&quot;en&quot;&gt;
  &lt;head&gt;
    &lt;title&gt;My Website&lt;/title&gt;
    &lt;%= yield :script %&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;%= yield %&gt;
  &lt;/body&gt;
  &lt;/html&gt;
</pre>
<p>
And now, we&#8217;ll create a view that has a <tt>content_for</tt> call
that creates the <tt>script</tt> identifier.
</p>
<pre class="code">
  &lt;%# This is our view %&gt;
  Please login!

  &lt;% content_for :script do %&gt;
    &lt;script type=&quot;text/javascript&quot;&gt;alert('You are not authorized to view this page!')&lt;/script&gt;
  &lt;% end %&gt;
</pre>
<p>
Then, in another view, you could to do something like this:
</p>
<pre class="code">
  &lt;%= link_to 'Logout', :action =&gt; 'logout', :remote =&gt; true %&gt;

  &lt;% content_for :script do %&gt;
    &lt;%= javascript_include_tag :defaults %&gt;
  &lt;% end %&gt;
</pre>
<p>
That will place <tt>script</tt> tags for Prototype, Scriptaculous, and
application.js (if it exists) on the page; this technique is useful if
you&#8217;ll only be using these scripts in a few views.
</p>
<p>
Note that content_for concatenates the blocks it is given for a particular
identifier in order. For example:
</p>
<pre class="code">
  &lt;% content_for :navigation do %&gt;
    &lt;li&gt;&lt;%= link_to 'Home', :action =&gt; 'index' %&gt;&lt;/li&gt;
  &lt;% end %&gt;

  &lt;%#  Add some other content, or use a different template: %&gt;

  &lt;% content_for :navigation do %&gt;
    &lt;li&gt;&lt;%= link_to 'Login', :action =&gt; 'login' %&gt;&lt;/li&gt;
  &lt;% end %&gt;
</pre>
<p>
Then, in another template or layout, this code would render both links in
order:
</p>
<pre class="code">
  &lt;ul&gt;&lt;%= content_for :navigation %&gt;&lt;/ul&gt;
</pre>
<p>
Lastly, simple content can be passed as a parameter:
</p>
<pre class="code">
  &lt;% content_for :script, javascript_include_tag(:defaults) %&gt;
</pre>
<p>
WARNING: content_for is ignored in caches. So you shouldn&#8217;t use it
for elements that will be fragment cached.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


135
136
137
138
139</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'actionpack/lib/action_view/helpers/capture_helper.rb', line 135</span>

<span class='kw'>def</span> <span class='id content_for'>content_for</span><span class='lparen'>(</span><span class='id name'>name</span><span class='comma'>,</span> <span class='id content'>content</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id block'>block</span><span class='rparen'>)</span>
  <span class='id content'>content</span> <span class='op'>=</span> <span class='id capture'>capture</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id block'>block</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id block_given?'>block_given?</span>
  <span class='ivar'>@_content_for</span><span class='lbracket'>[</span><span class='id name'>name</span><span class='rbracket'>]</span> <span class='op'>&lt;&lt;</span> <span class='id content'>content</span> <span class='kw'>if</span> <span class='id content'>content</span>
  <span class='ivar'>@_content_for</span><span class='lbracket'>[</span><span class='id name'>name</span><span class='rbracket'>]</span> <span class='kw'>unless</span> <span class='id content'>content</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="content_for?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>content_for?</strong>(name) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
content_for? simply checks whether any content has been captured yet using
content_for Useful to render parts of your layout differently based on what
is in your views.
</p>
<h4>Examples</h4>
<p>
Perhaps you will use different css in you layout if no content_for
:right_column
</p>
<pre class="code">
  &lt;%# This is the layout %&gt;
  &lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; xml:lang=&quot;en&quot; lang=&quot;en&quot;&gt;
  &lt;head&gt;
    &lt;title&gt;My Website&lt;/title&gt;
    &lt;%= yield :script %&gt;
  &lt;/head&gt;
  &lt;body class=&quot;&lt;%= content_for?(:right_col) ? 'one-column' : 'two-column' %&gt;&quot;&gt;
    &lt;%= yield %&gt;
    &lt;%= yield :right_col %&gt;
  &lt;/body&gt;
  &lt;/html&gt;</pre>


  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


159
160
161</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'actionpack/lib/action_view/helpers/capture_helper.rb', line 159</span>

<span class='kw'>def</span> <span class='id content_for?'>content_for?</span><span class='lparen'>(</span><span class='id name'>name</span><span class='rparen'>)</span>
  <span class='ivar'>@_content_for</span><span class='lbracket'>[</span><span class='id name'>name</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id present?'>present?</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="flush_output_buffer-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>flush_output_buffer</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Add the output buffer to the response body and start a new one.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


178
179
180
181
182
183
184</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'actionpack/lib/action_view/helpers/capture_helper.rb', line 178</span>

<span class='kw'>def</span> <span class='id flush_output_buffer'>flush_output_buffer</span> <span class='comment'>#:nodoc:
</span>  <span class='kw'>if</span> <span class='id output_buffer'>output_buffer</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id output_buffer'>output_buffer</span><span class='period'>.</span><span class='id empty?'>empty?</span>
    <span class='id response'>response</span><span class='period'>.</span><span class='id body_parts'>body_parts</span> <span class='op'>&lt;&lt;</span> <span class='id output_buffer'>output_buffer</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id output_buffer'>output_buffer</span> <span class='op'>=</span> <span class='id output_buffer'>output_buffer</span><span class='lbracket'>[</span><span class='int'>0</span><span class='comma'>,</span><span class='int'>0</span><span class='rbracket'>]</span>
    <span class='kw'>nil</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="with_output_buffer-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>with_output_buffer</strong>(buf = nil) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Use an alternate output buffer for the duration of the block. Defaults to a
new empty string.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


165
166
167
168
169
170
171
172
173
174
175</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'actionpack/lib/action_view/helpers/capture_helper.rb', line 165</span>

<span class='kw'>def</span> <span class='id with_output_buffer'>with_output_buffer</span><span class='lparen'>(</span><span class='id buf'>buf</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span> <span class='comment'>#:nodoc:
</span>  <span class='kw'>unless</span> <span class='id buf'>buf</span>
    <span class='id buf'>buf</span> <span class='op'>=</span> <span class='const'>ActionView</span><span class='op'>::</span><span class='const'>OutputBuffer</span><span class='period'>.</span><span class='id new'>new</span>
    <span class='id buf'>buf</span><span class='period'>.</span><span class='id force_encoding'>force_encoding</span><span class='lparen'>(</span><span class='id output_buffer'>output_buffer</span><span class='period'>.</span><span class='id encoding'>encoding</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id output_buffer'>output_buffer</span><span class='period'>.</span><span class='id respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:encoding</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='id buf'>buf</span><span class='period'>.</span><span class='id respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:force_encoding</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id output_buffer'>output_buffer</span><span class='comma'>,</span> <span class='id old_buffer'>old_buffer</span> <span class='op'>=</span> <span class='id buf'>buf</span><span class='comma'>,</span> <span class='id output_buffer'>output_buffer</span>
  <span class='kw'>yield</span>
  <span class='id output_buffer'>output_buffer</span>
<span class='kw'>ensure</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id output_buffer'>output_buffer</span> <span class='op'>=</span> <span class='id old_buffer'>old_buffer</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>
    
    <div id="footer">
  Generated on Thu Nov  4 20:04:02 2010 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.6.1 (ruby-1.9.2).
</div>

  </body>
</html>