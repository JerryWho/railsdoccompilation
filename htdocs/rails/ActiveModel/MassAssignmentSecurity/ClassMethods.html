<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta name="Content-Type" content="text/html; charset=utf-8" />
<title>Module: ActiveModel::MassAssignmentSecurity::ClassMethods</title>
<link rel="stylesheet" href="../../css/style.css" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="../../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '../..';
  if (relpath != '') relpath += '/';
</script>
<script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>

  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="../../_index.html">Index (C)</a> &raquo; 
    <span class='title'><span class='object_link'><a href="../../ActiveModel.html" title="ActiveModel (module)">ActiveModel</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../MassAssignmentSecurity.html" title="ActiveModel::MassAssignmentSecurity (module)">MassAssignmentSecurity</a></span></span>
     &raquo; 
    <span class="title">ClassMethods</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  <a id="class_list_link" href="#">Class List</a>
  <a id="method_list_link" href="#">Method List</a>
  <a id ="file_list_link" href="#">File List</a>
</div>

      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><h1>Module: ActiveModel::MassAssignmentSecurity::ClassMethods
  
  
  
</h1>

<dl class="box">
  
  
    
  
    
  
  
  
    <dt class="r1 last">Defined in:</dt>
    <dd class="r1 last">activemodel/lib/active_model/mass_assignment_security.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>
Mass assignment security provides an interface for protecting attributes
from end-user assignment. For more complex permissions, mass assignment
security may be handled outside the model by extending a non-ActiveRecord
class, such as a controller, with this behavior.
</p>
<p>
For example, a logged in user may need to assign additional attributes
depending on their role:
</p>
<p>
class AccountsController < ApplicationController
</p>
<pre class="code">
  include ActiveModel::MassAssignmentSecurity

  attr_accessible :first_name, :last_name

  def self.admin_accessible_attributes
    accessible_attributes + [ :plan_id ]
  end

  def update
    ...
    @account.update_attributes(account_params)
    ...
  end

  protected

  def account_params
    sanitize_for_mass_assignment(params[:account])
  end

  def mass_assignment_authorizer
    admin ? admin_accessible_attributes : super
  end
</pre>
<p>
end
</p>


  </div>
</div>
<div class="tags">
  
</div>


  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#accessible_attributes-instance_method" title="#accessible_attributes (instance method)">- (Object) <strong>accessible_attributes</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#active_authorizer-instance_method" title="#active_authorizer (instance method)">- (Object) <strong>active_authorizer</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#attr_accessible-instance_method" title="#attr_accessible (instance method)">- (Object) <strong>attr_accessible</strong>(*names) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Specifies a white list of model attributes that can be set via
mass-assignment.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#attr_protected-instance_method" title="#attr_protected (instance method)">- (Object) <strong>attr_protected</strong>(*names) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Attributes named in this macro are protected from mass-assignment whenever
attributes are sanitized before assignment.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#attributes_protected_by_default-instance_method" title="#attributes_protected_by_default (instance method)">- (Object) <strong>attributes_protected_by_default</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#protected_attributes-instance_method" title="#protected_attributes (instance method)">- (Object) <strong>protected_attributes</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  



  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="accessible_attributes-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>accessible_attributes</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


137
138
139</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activemodel/lib/active_model/mass_assignment_security.rb', line 137</span>

<span class='kw'>def</span> <span class='id accessible_attributes'>accessible_attributes</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id _accessible_attributes'>_accessible_attributes</span> <span class='op'>||=</span> <span class='const'>WhiteList</span><span class='period'>.</span><span class='id new'>new</span><span class='period'>.</span><span class='id tap'>tap</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id w'>w</span><span class='op'>|</span> <span class='id w'>w</span><span class='period'>.</span><span class='id logger'>logger</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id logger'>logger</span> <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:logger</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="active_authorizer-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>active_authorizer</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


141
142
143</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activemodel/lib/active_model/mass_assignment_security.rb', line 141</span>

<span class='kw'>def</span> <span class='id active_authorizer'>active_authorizer</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id _active_authorizer'>_active_authorizer</span> <span class='op'>||=</span> <span class='id protected_attributes'>protected_attributes</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="attr_accessible-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>attr_accessible</strong>(*names) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Specifies a white list of model attributes that can be set via
mass-assignment.
</p>
<p>
This is the opposite of the <tt>attr_protected</tt> macro: Mass-assignment
will only set attributes in this list, to assign to the rest of attributes
you can use direct writer methods. This is meant to protect sensitive
attributes from being overwritten by malicious users tampering with URLs or
forms. If you&#8217;d rather start from an all-open default and restrict
attributes as needed, have a look at <tt>attr_protected</tt>.
</p>
<pre class="code">
  <span class='kw'>class</span> <span class='const'>Customer</span>
    <span class='id include'>include</span> <span class='const'>ActiveModel</span><span class='op'>::</span><span class='const'>MassAssignmentSecurity</span>

    <span class='id attr_accessor'>attr_accessor</span> <span class='symbol'>:name</span><span class='comma'>,</span> <span class='symbol'>:credit_rating</span>
    <span class='id attr_accessible'>attr_accessible</span> <span class='symbol'>:name</span>

    <span class='kw'>def</span> <span class='id attributes='>attributes=</span><span class='lparen'>(</span><span class='id values'>values</span><span class='rparen'>)</span>
      <span class='id sanitize_for_mass_assignment'>sanitize_for_mass_assignment</span><span class='lparen'>(</span><span class='id values'>values</span><span class='rparen'>)</span><span class='period'>.</span><span class='id each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id k'>k</span><span class='comma'>,</span> <span class='id v'>v</span><span class='op'>|</span>
        <span class='id send'>send</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id k'>k</span><span class='rbrace'>}</span><span class='tstring_content'>=</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id v'>v</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id customer'>customer</span> <span class='op'>=</span> <span class='const'>Customer</span><span class='period'>.</span><span class='id new'>new</span>
  <span class='id customer'>customer</span><span class='period'>.</span><span class='id attributes'>attributes</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='symbol'>:name</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>David</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='symbol'>:credit_rating</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Excellent</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>
  <span class='id customer'>customer</span><span class='period'>.</span><span class='id name'>name</span>          <span class='comment'># =&gt; &quot;David&quot;
</span>  <span class='id customer'>customer</span><span class='period'>.</span><span class='id credit_rating'>credit_rating</span> <span class='comment'># =&gt; nil
</span>
  <span class='id customer'>customer</span><span class='period'>.</span><span class='id credit_rating'>credit_rating</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Average</span><span class='tstring_end'>&quot;</span></span>
  <span class='id customer'>customer</span><span class='period'>.</span><span class='id credit_rating'>credit_rating</span> <span class='comment'># =&gt; &quot;Average&quot;
</span></pre>
<p>
Note that using <tt>Hash#except</tt> or <tt>Hash#slice</tt> in place of
<tt>attr_accessible</tt> to sanitize attributes won&#8217;t provide
sufficient protection.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


126
127
128
129</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activemodel/lib/active_model/mass_assignment_security.rb', line 126</span>

<span class='kw'>def</span> <span class='id attr_accessible'>attr_accessible</span><span class='lparen'>(</span><span class='op'>*</span><span class='id names'>names</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id _accessible_attributes'>_accessible_attributes</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id accessible_attributes'>accessible_attributes</span> <span class='op'>+</span> <span class='id names'>names</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id _active_authorizer'>_active_authorizer</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id _accessible_attributes'>_accessible_attributes</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="attr_protected-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>attr_protected</strong>(*names) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Attributes named in this macro are protected from mass-assignment whenever
attributes are sanitized before assignment.
</p>
<p>
Mass-assignment to these attributes will simply be ignored, to assign to
them you can use direct writer methods. This is meant to protect sensitive
attributes from being overwritten by malicious users tampering with URLs or
forms.
</p>
<h2>Example</h2>
<pre class="code">
  <span class='kw'>class</span> <span class='const'>Customer</span>
    <span class='id include'>include</span> <span class='const'>ActiveModel</span><span class='op'>::</span><span class='const'>MassAssignmentSecurity</span>

    <span class='id attr_accessor'>attr_accessor</span> <span class='symbol'>:name</span><span class='comma'>,</span> <span class='symbol'>:credit_rating</span>
    <span class='id attr_protected'>attr_protected</span> <span class='symbol'>:credit_rating</span>

    <span class='kw'>def</span> <span class='id attributes='>attributes=</span><span class='lparen'>(</span><span class='id values'>values</span><span class='rparen'>)</span>
      <span class='id sanitize_for_mass_assignment'>sanitize_for_mass_assignment</span><span class='lparen'>(</span><span class='id values'>values</span><span class='rparen'>)</span><span class='period'>.</span><span class='id each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id k'>k</span><span class='comma'>,</span> <span class='id v'>v</span><span class='op'>|</span>
        <span class='id send'>send</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id k'>k</span><span class='rbrace'>}</span><span class='tstring_content'>=</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id v'>v</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id customer'>customer</span> <span class='op'>=</span> <span class='const'>Customer</span><span class='period'>.</span><span class='id new'>new</span>
  <span class='id customer'>customer</span><span class='period'>.</span><span class='id attributes'>attributes</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>name</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>David</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>credit_rating</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Excellent</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>
  <span class='id customer'>customer</span><span class='period'>.</span><span class='id name'>name</span>          <span class='comment'># =&gt; &quot;David&quot;
</span>  <span class='id customer'>customer</span><span class='period'>.</span><span class='id credit_rating'>credit_rating</span> <span class='comment'># =&gt; nil
</span>
  <span class='id customer'>customer</span><span class='period'>.</span><span class='id credit_rating'>credit_rating</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Average</span><span class='tstring_end'>&quot;</span></span>
  <span class='id customer'>customer</span><span class='period'>.</span><span class='id credit_rating'>credit_rating</span> <span class='comment'># =&gt; &quot;Average&quot;
</span></pre>
<p>
To start from an all-closed default and enable attributes as needed, have a
look at <tt>attr_accessible</tt>.
</p>
<p>
Note that using <tt>Hash#except</tt> or <tt>Hash#slice</tt> in place of
<tt>attr_protected</tt> to sanitize attributes won&#8217;t provide
sufficient protection.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


87
88
89
90</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activemodel/lib/active_model/mass_assignment_security.rb', line 87</span>

<span class='kw'>def</span> <span class='id attr_protected'>attr_protected</span><span class='lparen'>(</span><span class='op'>*</span><span class='id names'>names</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id _protected_attributes'>_protected_attributes</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id protected_attributes'>protected_attributes</span> <span class='op'>+</span> <span class='id names'>names</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id _active_authorizer'>_active_authorizer</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id _protected_attributes'>_protected_attributes</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="attributes_protected_by_default-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>attributes_protected_by_default</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


145
146
147</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activemodel/lib/active_model/mass_assignment_security.rb', line 145</span>

<span class='kw'>def</span> <span class='id attributes_protected_by_default'>attributes_protected_by_default</span>
  <span class='lbracket'>[</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="protected_attributes-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>protected_attributes</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


131
132
133
134
135</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activemodel/lib/active_model/mass_assignment_security.rb', line 131</span>

<span class='kw'>def</span> <span class='id protected_attributes'>protected_attributes</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id _protected_attributes'>_protected_attributes</span> <span class='op'>||=</span> <span class='const'>BlackList</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span><span class='id attributes_protected_by_default'>attributes_protected_by_default</span><span class='rparen'>)</span><span class='period'>.</span><span class='id tap'>tap</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id w'>w</span><span class='op'>|</span>
    <span class='id w'>w</span><span class='period'>.</span><span class='id logger'>logger</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id logger'>logger</span> <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:logger</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>
    
    <div id="footer">
  Generated on Thu Nov  4 20:04:18 2010 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.6.1 (ruby-1.9.2).
</div>

  </body>
</html>