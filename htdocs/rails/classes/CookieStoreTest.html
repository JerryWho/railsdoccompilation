  <div id="C00000508">
<div class='banner'>
  <span class="file-title-prefix">Class</span><br />CookieStoreTest<br/>
  In:
<a href="#" onclick="jsHref('files/actionpack/test/controller/session/cookie_store_test_rb.html');">actionpack/test/controller/session/cookie_store_test.rb</a>

Parent:&nbsp;
ActionController::IntegrationTest
</div>
 <!-- banner header -->

  <div id="bodyContent" >
      <div id="content">




  <div class="sectiontitle">Methods</div>
  <ul>
  <li><a href="index.html?a=M003007&name=setup" >setup</a></li>
  <li><a href="index.html?a=M003015&name=test_close_raises_when_data_overflows" >test_close_raises_when_data_overflows</a></li>
  <li><a href="index.html?a=M003014&name=test_disregards_tampered_sessions" >test_disregards_tampered_sessions</a></li>
  <li><a href="index.html?a=M003016&name=test_doesnt_write_session_cookie_if_session_is_not_accessed" >test_doesnt_write_session_cookie_if_session_is_not_accessed</a></li>
  <li><a href="index.html?a=M003017&name=test_doesnt_write_session_cookie_if_session_is_unchanged" >test_doesnt_write_session_cookie_if_session_is_unchanged</a></li>
  <li><a href="index.html?a=M003013&name=test_getting_session_id" >test_getting_session_id</a></li>
  <li><a href="index.html?a=M003012&name=test_getting_session_value" >test_getting_session_value</a></li>
  <li><a href="index.html?a=M003019&name=test_persistent_session_id" >test_persistent_session_id</a></li>
  <li><a href="index.html?a=M003009&name=test_raises_argument_error_if_missing_secret" >test_raises_argument_error_if_missing_secret</a></li>
  <li><a href="index.html?a=M003008&name=test_raises_argument_error_if_missing_session_key" >test_raises_argument_error_if_missing_session_key</a></li>
  <li><a href="index.html?a=M003010&name=test_raises_argument_error_if_secret_is_probably_insecure" >test_raises_argument_error_if_secret_is_probably_insecure</a></li>
  <li><a href="index.html?a=M003011&name=test_setting_session_value" >test_setting_session_value</a></li>
  <li><a href="index.html?a=M003018&name=test_setting_session_value_after_session_reset" >test_setting_session_value_after_session_reset</a></li>
  </ul>



  <div class="sectiontitle">Classes and Modules</div>
  Class "<a href="#" onclick="jsHref('classes/CookieStoreTest/TestController.html');" class="link">CookieStoreTest::TestController</a>"<br />


  <div class="sectiontitle">Constants</div>
  <table border='0' cellpadding='5'>
  <tr valign='top'>
    <td class="attr-name">SessionKey</td>
    <td>=</td>
    <td class="attr-value">'_myapp_session'</td>
  </tr>
  <tr valign='top'>
    <td class="attr-name">SessionSecret</td>
    <td>=</td>
    <td class="attr-value">'b3c631c314c0bbca50c1b2843150fe33'</td>
  </tr>
  <tr valign='top'>
    <td class="attr-name">DispatcherApp</td>
    <td>=</td>
    <td class="attr-value">ActionController::Dispatcher.new</td>
  </tr>
  <tr valign='top'>
    <td class="attr-name">CookieStoreApp</td>
    <td>=</td>
    <td class="attr-value">ActionController::Session::CookieStore.new(DispatcherApp, :key =&gt; SessionKey, :secret =&gt; SessionSecret)</td>
  </tr>
  <tr valign='top'>
    <td class="attr-name">Verifier</td>
    <td>=</td>
    <td class="attr-value">ActiveSupport::MessageVerifier.new(SessionSecret, 'SHA1')</td>
  </tr>
  <tr valign='top'>
    <td class="attr-name">SignedBar</td>
    <td>=</td>
    <td class="attr-value">&quot;BAh7BjoIZm9vIghiYXI%3D--fef868465920f415f2c0652d6910d3af288a0367&quot;</td>
  </tr>
  </table>


<div class="sectiontitle">Public Instance methods</div>
<div id="M003007" class="method">
  <div id="M003007_title" class="title">
    <b>setup</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003007_source')" id="l_M003007_source">show source</a> ]</p>
  <div id="M003007_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/session/cookie_store_test.rb, line 50</span>
50:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">setup</span>
51:     <span class="ruby-ivar">@integration_session</span> = <span class="ruby-identifier">open_session</span>(<span class="ruby-constant">CookieStoreApp</span>)
52:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003015" class="method">
  <div id="M003015_title" class="title">
    <b>test_close_raises_when_data_overflows</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003015_source')" id="l_M003015_source">show source</a> ]</p>
  <div id="M003015_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/session/cookie_store_test.rb, line 136</span>
136:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_close_raises_when_data_overflows</span>
137:     <span class="ruby-identifier">with_test_route_set</span> <span class="ruby-keyword kw">do</span>
138:       <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActionController</span><span class="ruby-operator">::</span><span class="ruby-constant">Session</span><span class="ruby-operator">::</span><span class="ruby-constant">CookieStore</span><span class="ruby-operator">::</span><span class="ruby-constant">CookieOverflow</span>) {
139:         <span class="ruby-identifier">get</span> <span class="ruby-value str">'/raise_data_overflow'</span>
140:       }
141:     <span class="ruby-keyword kw">end</span>
142:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003014" class="method">
  <div id="M003014_title" class="title">
    <b>test_disregards_tampered_sessions</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003014_source')" id="l_M003014_source">show source</a> ]</p>
  <div id="M003014_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/session/cookie_store_test.rb, line 127</span>
127:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_disregards_tampered_sessions</span>
128:     <span class="ruby-identifier">with_test_route_set</span> <span class="ruby-keyword kw">do</span>
129:       <span class="ruby-identifier">cookies</span>[<span class="ruby-constant">SessionKey</span>] = <span class="ruby-value str">&quot;BAh7BjoIZm9vIghiYXI%3D--123456780&quot;</span>
130:       <span class="ruby-identifier">get</span> <span class="ruby-value str">'/get_session_value'</span>
131:       <span class="ruby-identifier">assert_response</span> <span class="ruby-identifier">:success</span>
132:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'foo: nil'</span>, <span class="ruby-identifier">response</span>.<span class="ruby-identifier">body</span>
133:     <span class="ruby-keyword kw">end</span>
134:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003016" class="method">
  <div id="M003016_title" class="title">
    <b>test_doesnt_write_session_cookie_if_session_is_not_accessed</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003016_source')" id="l_M003016_source">show source</a> ]</p>
  <div id="M003016_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/session/cookie_store_test.rb, line 144</span>
144:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_doesnt_write_session_cookie_if_session_is_not_accessed</span>
145:     <span class="ruby-identifier">with_test_route_set</span> <span class="ruby-keyword kw">do</span>
146:       <span class="ruby-identifier">get</span> <span class="ruby-value str">'/no_session_access'</span>
147:       <span class="ruby-identifier">assert_response</span> <span class="ruby-identifier">:success</span>
148:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;&quot;</span>, <span class="ruby-identifier">headers</span>[<span class="ruby-value str">'Set-Cookie'</span>]
149:     <span class="ruby-keyword kw">end</span>
150:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003017" class="method">
  <div id="M003017_title" class="title">
    <b>test_doesnt_write_session_cookie_if_session_is_unchanged</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003017_source')" id="l_M003017_source">show source</a> ]</p>
  <div id="M003017_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/session/cookie_store_test.rb, line 152</span>
152:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_doesnt_write_session_cookie_if_session_is_unchanged</span>
153:     <span class="ruby-identifier">with_test_route_set</span> <span class="ruby-keyword kw">do</span>
154:       <span class="ruby-identifier">cookies</span>[<span class="ruby-constant">SessionKey</span>] = <span class="ruby-value str">&quot;BAh7BjoIZm9vIghiYXI%3D--&quot;</span> <span class="ruby-operator">+</span>
155:         <span class="ruby-value str">&quot;fef868465920f415f2c0652d6910d3af288a0367&quot;</span>
156:       <span class="ruby-identifier">get</span> <span class="ruby-value str">'/no_session_access'</span>
157:       <span class="ruby-identifier">assert_response</span> <span class="ruby-identifier">:success</span>
158:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;&quot;</span>, <span class="ruby-identifier">headers</span>[<span class="ruby-value str">'Set-Cookie'</span>]
159:     <span class="ruby-keyword kw">end</span>
160:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003013" class="method">
  <div id="M003013_title" class="title">
    <b>test_getting_session_id</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003013_source')" id="l_M003013_source">show source</a> ]</p>
  <div id="M003013_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/session/cookie_store_test.rb, line 113</span>
113:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_getting_session_id</span>
114:     <span class="ruby-identifier">with_test_route_set</span> <span class="ruby-keyword kw">do</span>
115:       <span class="ruby-identifier">cookies</span>[<span class="ruby-constant">SessionKey</span>] = <span class="ruby-constant">SignedBar</span>
116:       <span class="ruby-identifier">get</span> <span class="ruby-value str">'/persistent_session_id'</span>
117:       <span class="ruby-identifier">assert_response</span> <span class="ruby-identifier">:success</span>
118:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">response</span>.<span class="ruby-identifier">body</span>.<span class="ruby-identifier">size</span>, <span class="ruby-value">32</span>
119:       <span class="ruby-identifier">session_id</span> = <span class="ruby-identifier">response</span>.<span class="ruby-identifier">body</span>
120: 
121:       <span class="ruby-identifier">get</span> <span class="ruby-value str">'/get_session_id'</span>
122:       <span class="ruby-identifier">assert_response</span> <span class="ruby-identifier">:success</span>
123:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-node">&quot;foo: \&quot;bar\&quot;; id: #{session_id}&quot;</span>, <span class="ruby-identifier">response</span>.<span class="ruby-identifier">body</span>
124:     <span class="ruby-keyword kw">end</span>
125:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003012" class="method">
  <div id="M003012_title" class="title">
    <b>test_getting_session_value</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003012_source')" id="l_M003012_source">show source</a> ]</p>
  <div id="M003012_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/session/cookie_store_test.rb, line 104</span>
104:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_getting_session_value</span>
105:     <span class="ruby-identifier">with_test_route_set</span> <span class="ruby-keyword kw">do</span>
106:       <span class="ruby-identifier">cookies</span>[<span class="ruby-constant">SessionKey</span>] = <span class="ruby-constant">SignedBar</span>
107:       <span class="ruby-identifier">get</span> <span class="ruby-value str">'/get_session_value'</span>
108:       <span class="ruby-identifier">assert_response</span> <span class="ruby-identifier">:success</span>
109:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'foo: &quot;bar&quot;'</span>, <span class="ruby-identifier">response</span>.<span class="ruby-identifier">body</span>
110:    <span class="ruby-keyword kw">end</span>
111:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003019" class="method">
  <div id="M003019_title" class="title">
    <b>test_persistent_session_id</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003019_source')" id="l_M003019_source">show source</a> ]</p>
  <div id="M003019_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/session/cookie_store_test.rb, line 181</span>
181:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_persistent_session_id</span>
182:     <span class="ruby-identifier">with_test_route_set</span> <span class="ruby-keyword kw">do</span>
183:       <span class="ruby-identifier">cookies</span>[<span class="ruby-constant">SessionKey</span>] = <span class="ruby-constant">SignedBar</span>
184:       <span class="ruby-identifier">get</span> <span class="ruby-value str">'/persistent_session_id'</span>
185:       <span class="ruby-identifier">assert_response</span> <span class="ruby-identifier">:success</span>
186:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">response</span>.<span class="ruby-identifier">body</span>.<span class="ruby-identifier">size</span>, <span class="ruby-value">32</span>
187:       <span class="ruby-identifier">session_id</span> = <span class="ruby-identifier">response</span>.<span class="ruby-identifier">body</span>
188:       <span class="ruby-identifier">get</span> <span class="ruby-value str">'/persistent_session_id'</span>
189:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">session_id</span>, <span class="ruby-identifier">response</span>.<span class="ruby-identifier">body</span>
190:       <span class="ruby-identifier">reset!</span>
191:       <span class="ruby-identifier">get</span> <span class="ruby-value str">'/persistent_session_id'</span>
192:       <span class="ruby-identifier">assert_not_equal</span> <span class="ruby-identifier">session_id</span>, <span class="ruby-identifier">response</span>.<span class="ruby-identifier">body</span>
193:     <span class="ruby-keyword kw">end</span>
194:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003009" class="method">
  <div id="M003009_title" class="title">
    <b>test_raises_argument_error_if_missing_secret</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003009_source')" id="l_M003009_source">show source</a> ]</p>
  <div id="M003009_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/session/cookie_store_test.rb, line 66</span>
66:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_raises_argument_error_if_missing_secret</span>
67:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ArgumentError</span>, <span class="ruby-keyword kw">nil</span>.<span class="ruby-identifier">inspect</span>) {
68:       <span class="ruby-constant">ActionController</span><span class="ruby-operator">::</span><span class="ruby-constant">Session</span><span class="ruby-operator">::</span><span class="ruby-constant">CookieStore</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword kw">nil</span>,
69:        <span class="ruby-identifier">:key</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">SessionKey</span>, <span class="ruby-identifier">:secret</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>)
70:     }
71: 
72:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ArgumentError</span>, <span class="ruby-value str">''</span>.<span class="ruby-identifier">inspect</span>) {
73:       <span class="ruby-constant">ActionController</span><span class="ruby-operator">::</span><span class="ruby-constant">Session</span><span class="ruby-operator">::</span><span class="ruby-constant">CookieStore</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword kw">nil</span>,
74:        <span class="ruby-identifier">:key</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">SessionKey</span>, <span class="ruby-identifier">:secret</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">''</span>)
75:     }
76:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003008" class="method">
  <div id="M003008_title" class="title">
    <b>test_raises_argument_error_if_missing_session_key</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003008_source')" id="l_M003008_source">show source</a> ]</p>
  <div id="M003008_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/session/cookie_store_test.rb, line 54</span>
54:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_raises_argument_error_if_missing_session_key</span>
55:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ArgumentError</span>, <span class="ruby-keyword kw">nil</span>.<span class="ruby-identifier">inspect</span>) {
56:       <span class="ruby-constant">ActionController</span><span class="ruby-operator">::</span><span class="ruby-constant">Session</span><span class="ruby-operator">::</span><span class="ruby-constant">CookieStore</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword kw">nil</span>,
57:         <span class="ruby-identifier">:key</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">:secret</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">SessionSecret</span>)
58:     }
59: 
60:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ArgumentError</span>, <span class="ruby-value str">''</span>.<span class="ruby-identifier">inspect</span>) {
61:       <span class="ruby-constant">ActionController</span><span class="ruby-operator">::</span><span class="ruby-constant">Session</span><span class="ruby-operator">::</span><span class="ruby-constant">CookieStore</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword kw">nil</span>,
62:         <span class="ruby-identifier">:key</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">''</span>, <span class="ruby-identifier">:secret</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">SessionSecret</span>)
63:     }
64:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003010" class="method">
  <div id="M003010_title" class="title">
    <b>test_raises_argument_error_if_secret_is_probably_insecure</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003010_source')" id="l_M003010_source">show source</a> ]</p>
  <div id="M003010_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/session/cookie_store_test.rb, line 78</span>
78:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_raises_argument_error_if_secret_is_probably_insecure</span>
79:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ArgumentError</span>, <span class="ruby-value str">&quot;password&quot;</span>.<span class="ruby-identifier">inspect</span>) {
80:       <span class="ruby-constant">ActionController</span><span class="ruby-operator">::</span><span class="ruby-constant">Session</span><span class="ruby-operator">::</span><span class="ruby-constant">CookieStore</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword kw">nil</span>,
81:        <span class="ruby-identifier">:key</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">SessionKey</span>, <span class="ruby-identifier">:secret</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;password&quot;</span>)
82:     }
83: 
84:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ArgumentError</span>, <span class="ruby-value str">&quot;secret&quot;</span>.<span class="ruby-identifier">inspect</span>) {
85:       <span class="ruby-constant">ActionController</span><span class="ruby-operator">::</span><span class="ruby-constant">Session</span><span class="ruby-operator">::</span><span class="ruby-constant">CookieStore</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword kw">nil</span>,
86:        <span class="ruby-identifier">:key</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">SessionKey</span>, <span class="ruby-identifier">:secret</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;secret&quot;</span>)
87:     }
88: 
89:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ArgumentError</span>, <span class="ruby-value str">&quot;12345678901234567890123456789&quot;</span>.<span class="ruby-identifier">inspect</span>) {
90:       <span class="ruby-constant">ActionController</span><span class="ruby-operator">::</span><span class="ruby-constant">Session</span><span class="ruby-operator">::</span><span class="ruby-constant">CookieStore</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword kw">nil</span>,
91:        <span class="ruby-identifier">:key</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">SessionKey</span>, <span class="ruby-identifier">:secret</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;12345678901234567890123456789&quot;</span>)
92:     }
93:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003011" class="method">
  <div id="M003011_title" class="title">
    <b>test_setting_session_value</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003011_source')" id="l_M003011_source">show source</a> ]</p>
  <div id="M003011_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/session/cookie_store_test.rb, line 95</span>
 95:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_setting_session_value</span>
 96:     <span class="ruby-identifier">with_test_route_set</span> <span class="ruby-keyword kw">do</span>
 97:       <span class="ruby-identifier">get</span> <span class="ruby-value str">'/set_session_value'</span>
 98:       <span class="ruby-identifier">assert_response</span> <span class="ruby-identifier">:success</span>
 99:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-node">&quot;_myapp_session=#{response.body}; path=/; HttpOnly&quot;</span>,
100:         <span class="ruby-identifier">headers</span>[<span class="ruby-value str">'Set-Cookie'</span>]
101:    <span class="ruby-keyword kw">end</span>
102:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003018" class="method">
  <div id="M003018_title" class="title">
    <b>test_setting_session_value_after_session_reset</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003018_source')" id="l_M003018_source">show source</a> ]</p>
  <div id="M003018_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/session/cookie_store_test.rb, line 162</span>
162:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_setting_session_value_after_session_reset</span>
163:     <span class="ruby-identifier">with_test_route_set</span> <span class="ruby-keyword kw">do</span>
164:       <span class="ruby-identifier">get</span> <span class="ruby-value str">'/set_session_value'</span>
165:       <span class="ruby-identifier">assert_response</span> <span class="ruby-identifier">:success</span>
166:       <span class="ruby-identifier">session_payload</span> = <span class="ruby-identifier">response</span>.<span class="ruby-identifier">body</span>
167:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-node">&quot;_myapp_session=#{response.body}; path=/; HttpOnly&quot;</span>,
168:         <span class="ruby-identifier">headers</span>[<span class="ruby-value str">'Set-Cookie'</span>]
169: 
170:       <span class="ruby-identifier">get</span> <span class="ruby-value str">'/call_reset_session'</span>
171:       <span class="ruby-identifier">assert_response</span> <span class="ruby-identifier">:success</span>
172:       <span class="ruby-identifier">assert_not_equal</span> [], <span class="ruby-identifier">headers</span>[<span class="ruby-value str">'Set-Cookie'</span>]
173:       <span class="ruby-identifier">assert_not_equal</span> <span class="ruby-identifier">session_payload</span>, <span class="ruby-identifier">cookies</span>[<span class="ruby-constant">SessionKey</span>]
174: 
175:       <span class="ruby-identifier">get</span> <span class="ruby-value str">'/get_session_value'</span>
176:       <span class="ruby-identifier">assert_response</span> <span class="ruby-identifier">:success</span>
177:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'foo: nil'</span>, <span class="ruby-identifier">response</span>.<span class="ruby-identifier">body</span>
178:     <span class="ruby-keyword kw">end</span>
179:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
</div>

  </div>