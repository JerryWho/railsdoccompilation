  <div id="C00000210">
<div class='banner'>
  <span class="file-title-prefix">Class</span><br />ColumnDefinitionTest<br/>
  In:
<a href="#" onclick="jsHref('files/activerecord/test/cases/column_definition_test_rb.html');">activerecord/test/cases/column_definition_test.rb</a>

Parent:&nbsp;
ActiveRecord::TestCase
</div>
 <!-- banner header -->

  <div id="bodyContent" >
      <div id="content">




  <div class="sectiontitle">Methods</div>
  <ul>
  <li><a href="index.html?a=M001389&name=setup" >setup</a></li>
  <li><a href="index.html?a=M001395&name=test_has_default_should_return_false_for_blog_and_test_data_types" >test_has_default_should_return_false_for_blog_and_test_data_types</a></li>
  <li><a href="index.html?a=M001391&name=test_should_include_default_clause_when_default_is_present" >test_should_include_default_clause_when_default_is_present</a></li>
  <li><a href="index.html?a=M001390&name=test_should_not_include_default_clause_when_default_is_null" >test_should_not_include_default_clause_when_default_is_null</a></li>
  <li><a href="index.html?a=M001394&name=test_should_not_set_default_for_blob_and_text_data_types" >test_should_not_set_default_for_blob_and_text_data_types</a></li>
  <li><a href="index.html?a=M001393&name=test_should_set_default_for_mysql_binary_data_types" >test_should_set_default_for_mysql_binary_data_types</a></li>
  <li><a href="index.html?a=M001392&name=test_should_specify_not_null_if_null_option_is_false" >test_should_specify_not_null_if_null_option_is_false</a></li>
  </ul>






<div class="sectiontitle">Public Instance methods</div>
<div id="M001389" class="method">
  <div id="M001389_title" class="title">
    <b>setup</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001389_source')" id="l_M001389_source">show source</a> ]</p>
  <div id="M001389_source" class="dyn-source">
<pre>
   <span class="ruby-comment cmt"># File activerecord/test/cases/column_definition_test.rb, line 4</span>
4:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">setup</span>
5:     <span class="ruby-ivar">@adapter</span> = <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">ConnectionAdapters</span><span class="ruby-operator">::</span><span class="ruby-constant">AbstractAdapter</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword kw">nil</span>)
6:     <span class="ruby-keyword kw">def</span> <span class="ruby-ivar">@adapter</span>.<span class="ruby-identifier">native_database_types</span>
7:       {<span class="ruby-identifier">:string</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;varchar&quot;</span>}
8:     <span class="ruby-keyword kw">end</span>
9:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001395" class="method">
  <div id="M001395_title" class="title">
    <b>test_has_default_should_return_false_for_blog_and_test_data_types</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001395_source')" id="l_M001395_source">show source</a> ]</p>
  <div id="M001395_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/column_definition_test.rb, line 62</span>
62:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_has_default_should_return_false_for_blog_and_test_data_types</span>
63:       <span class="ruby-identifier">blob_column</span> = <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">ConnectionAdapters</span><span class="ruby-operator">::</span><span class="ruby-constant">MysqlColumn</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span>, <span class="ruby-keyword kw">nil</span>, <span class="ruby-value str">&quot;blob&quot;</span>)
64:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">blob_column</span>.<span class="ruby-identifier">has_default?</span>
65: 
66:       <span class="ruby-identifier">text_column</span> = <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">ConnectionAdapters</span><span class="ruby-operator">::</span><span class="ruby-constant">MysqlColumn</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span>, <span class="ruby-keyword kw">nil</span>, <span class="ruby-value str">&quot;text&quot;</span>)
67:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">text_column</span>.<span class="ruby-identifier">has_default?</span>
68:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001391" class="method">
  <div id="M001391_title" class="title">
    <b>test_should_include_default_clause_when_default_is_present</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001391_source')" id="l_M001391_source">show source</a> ]</p>
  <div id="M001391_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/column_definition_test.rb, line 21</span>
21:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_include_default_clause_when_default_is_present</span>
22:     <span class="ruby-identifier">column</span> = <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">ConnectionAdapters</span><span class="ruby-operator">::</span><span class="ruby-constant">Column</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span>, <span class="ruby-value str">&quot;Hello&quot;</span>, <span class="ruby-value str">&quot;varchar(20)&quot;</span>)
23:     <span class="ruby-identifier">column_def</span> = <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">ConnectionAdapters</span><span class="ruby-operator">::</span><span class="ruby-constant">ColumnDefinition</span>.<span class="ruby-identifier">new</span>(
24:       <span class="ruby-ivar">@adapter</span>, <span class="ruby-identifier">column</span>.<span class="ruby-identifier">name</span>, <span class="ruby-value str">&quot;string&quot;</span>,
25:       <span class="ruby-identifier">column</span>.<span class="ruby-identifier">limit</span>, <span class="ruby-identifier">column</span>.<span class="ruby-identifier">precision</span>, <span class="ruby-identifier">column</span>.<span class="ruby-identifier">scale</span>, <span class="ruby-identifier">column</span>.<span class="ruby-identifier">default</span>, <span class="ruby-identifier">column</span>.<span class="ruby-identifier">null</span>)
26:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">%Q{title varchar(20) DEFAULT 'Hello'}</span>, <span class="ruby-identifier">column_def</span>.<span class="ruby-identifier">to_sql</span>
27:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001390" class="method">
  <div id="M001390_title" class="title">
    <b>test_should_not_include_default_clause_when_default_is_null</b>()
  </div>
  <div class="description">
  <p>
Avoid column definitions in create table statements like: `title`
varchar(255) DEFAULT NULL
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001390_source')" id="l_M001390_source">show source</a> ]</p>
  <div id="M001390_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/column_definition_test.rb, line 13</span>
13:   <span class="ruby-keyword kw">def</span>  <span class="ruby-identifier">test_should_not_include_default_clause_when_default_is_null</span><span class="ruby-identifier">test_should_not_include_default_clause_when_default_is_null</span>
14:     <span class="ruby-identifier">column</span> = <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">ConnectionAdapters</span><span class="ruby-operator">::</span><span class="ruby-constant">Column</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span>, <span class="ruby-keyword kw">nil</span>, <span class="ruby-value str">&quot;varchar(20)&quot;</span>)
15:     <span class="ruby-identifier">column_def</span> = <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">ConnectionAdapters</span><span class="ruby-operator">::</span><span class="ruby-constant">ColumnDefinition</span>.<span class="ruby-identifier">new</span>(
16:       <span class="ruby-ivar">@adapter</span>, <span class="ruby-identifier">column</span>.<span class="ruby-identifier">name</span>, <span class="ruby-value str">&quot;string&quot;</span>,
17:       <span class="ruby-identifier">column</span>.<span class="ruby-identifier">limit</span>, <span class="ruby-identifier">column</span>.<span class="ruby-identifier">precision</span>, <span class="ruby-identifier">column</span>.<span class="ruby-identifier">scale</span>, <span class="ruby-identifier">column</span>.<span class="ruby-identifier">default</span>, <span class="ruby-identifier">column</span>.<span class="ruby-identifier">null</span>)
18:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;title varchar(20)&quot;</span>, <span class="ruby-identifier">column_def</span>.<span class="ruby-identifier">to_sql</span>
19:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001394" class="method">
  <div id="M001394_title" class="title">
    <b>test_should_not_set_default_for_blob_and_text_data_types</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001394_source')" id="l_M001394_source">show source</a> ]</p>
  <div id="M001394_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/column_definition_test.rb, line 46</span>
46:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_not_set_default_for_blob_and_text_data_types</span>
47:       <span class="ruby-identifier">assert_raise</span> <span class="ruby-constant">ArgumentError</span> <span class="ruby-keyword kw">do</span>
48:         <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">ConnectionAdapters</span><span class="ruby-operator">::</span><span class="ruby-constant">MysqlColumn</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span>, <span class="ruby-value str">&quot;a&quot;</span>, <span class="ruby-value str">&quot;blob&quot;</span>)
49:       <span class="ruby-keyword kw">end</span>
50: 
51:       <span class="ruby-identifier">assert_raise</span> <span class="ruby-constant">ArgumentError</span> <span class="ruby-keyword kw">do</span>
52:         <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">ConnectionAdapters</span><span class="ruby-operator">::</span><span class="ruby-constant">MysqlColumn</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span>, <span class="ruby-value str">&quot;Hello&quot;</span>, <span class="ruby-value str">&quot;text&quot;</span>)
53:       <span class="ruby-keyword kw">end</span>
54: 
55:       <span class="ruby-identifier">text_column</span> = <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">ConnectionAdapters</span><span class="ruby-operator">::</span><span class="ruby-constant">MysqlColumn</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span>, <span class="ruby-keyword kw">nil</span>, <span class="ruby-value str">&quot;text&quot;</span>)
56:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">text_column</span>.<span class="ruby-identifier">default</span>
57: 
58:       <span class="ruby-identifier">not_null_text_column</span> = <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">ConnectionAdapters</span><span class="ruby-operator">::</span><span class="ruby-constant">MysqlColumn</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span>, <span class="ruby-keyword kw">nil</span>, <span class="ruby-value str">&quot;text&quot;</span>, <span class="ruby-keyword kw">false</span>)
59:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;&quot;</span>, <span class="ruby-identifier">not_null_text_column</span>.<span class="ruby-identifier">default</span>
60:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001393" class="method">
  <div id="M001393_title" class="title">
    <b>test_should_set_default_for_mysql_binary_data_types</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001393_source')" id="l_M001393_source">show source</a> ]</p>
  <div id="M001393_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/column_definition_test.rb, line 38</span>
38:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_set_default_for_mysql_binary_data_types</span>
39:       <span class="ruby-identifier">binary_column</span> = <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">ConnectionAdapters</span><span class="ruby-operator">::</span><span class="ruby-constant">MysqlColumn</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span>, <span class="ruby-value str">&quot;a&quot;</span>, <span class="ruby-value str">&quot;binary(1)&quot;</span>)
40:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;a&quot;</span>, <span class="ruby-identifier">binary_column</span>.<span class="ruby-identifier">default</span>
41: 
42:       <span class="ruby-identifier">varbinary_column</span> = <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">ConnectionAdapters</span><span class="ruby-operator">::</span><span class="ruby-constant">MysqlColumn</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span>, <span class="ruby-value str">&quot;a&quot;</span>, <span class="ruby-value str">&quot;varbinary(1)&quot;</span>)
43:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;a&quot;</span>, <span class="ruby-identifier">varbinary_column</span>.<span class="ruby-identifier">default</span>
44:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001392" class="method">
  <div id="M001392_title" class="title">
    <b>test_should_specify_not_null_if_null_option_is_false</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001392_source')" id="l_M001392_source">show source</a> ]</p>
  <div id="M001392_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/column_definition_test.rb, line 29</span>
29:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_specify_not_null_if_null_option_is_false</span>
30:     <span class="ruby-identifier">column</span> = <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">ConnectionAdapters</span><span class="ruby-operator">::</span><span class="ruby-constant">Column</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span>, <span class="ruby-value str">&quot;Hello&quot;</span>, <span class="ruby-value str">&quot;varchar(20)&quot;</span>, <span class="ruby-keyword kw">false</span>)
31:     <span class="ruby-identifier">column_def</span> = <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">ConnectionAdapters</span><span class="ruby-operator">::</span><span class="ruby-constant">ColumnDefinition</span>.<span class="ruby-identifier">new</span>(
32:       <span class="ruby-ivar">@adapter</span>, <span class="ruby-identifier">column</span>.<span class="ruby-identifier">name</span>, <span class="ruby-value str">&quot;string&quot;</span>,
33:       <span class="ruby-identifier">column</span>.<span class="ruby-identifier">limit</span>, <span class="ruby-identifier">column</span>.<span class="ruby-identifier">precision</span>, <span class="ruby-identifier">column</span>.<span class="ruby-identifier">scale</span>, <span class="ruby-identifier">column</span>.<span class="ruby-identifier">default</span>, <span class="ruby-identifier">column</span>.<span class="ruby-identifier">null</span>)
34:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">%Q{title varchar(20) DEFAULT 'Hello' NOT NULL}</span>, <span class="ruby-identifier">column_def</span>.<span class="ruby-identifier">to_sql</span>
35:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
</div>

  </div>