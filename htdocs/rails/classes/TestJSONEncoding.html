  <div id="C00000318">
<div class='banner'>
  <span class="file-title-prefix">Class</span><br />TestJSONEncoding<br/>
  In:
<a href="#" onclick="jsHref('files/activesupport/test/json/encoding_test_rb.html');">activesupport/test/json/encoding_test.rb</a>

Parent:&nbsp;
Test::Unit::TestCase
</div>
 <!-- banner header -->

  <div id="bodyContent" >
      <div id="content">




  <div class="sectiontitle">Methods</div>
  <ul>
  <li><a href="index.html?a=M001876&name=object_keys" >object_keys</a></li>
  <li><a href="index.html?a=M001870&name=test_exception_raised_when_encoding_circular_reference" >test_exception_raised_when_encoding_circular_reference</a></li>
  <li><a href="index.html?a=M001868&name=test_hash_encoding" >test_hash_encoding</a></li>
  <li><a href="index.html?a=M001871&name=test_hash_key_identifiers_are_always_quoted" >test_hash_key_identifiers_are_always_quoted</a></li>
  <li><a href="index.html?a=M001873&name=test_hash_should_allow_key_filtering_with_except" >test_hash_should_allow_key_filtering_with_except</a></li>
  <li><a href="index.html?a=M001872&name=test_hash_should_allow_key_filtering_with_only" >test_hash_should_allow_key_filtering_with_only</a></li>
  <li><a href="index.html?a=M001875&name=test_nested_hash_with_float" >test_nested_hash_with_float</a></li>
  <li><a href="index.html?a=M001874&name=test_time_to_json_includes_local_offset" >test_time_to_json_includes_local_offset</a></li>
  <li><a href="index.html?a=M001869&name=test_utf8_string_encoded_properly_when_kcode_is_utf8" >test_utf8_string_encoded_properly_when_kcode_is_utf8</a></li>
  <li><a href="index.html?a=M001877&name=with_env_tz" >with_env_tz</a></li>
  </ul>



  <div class="sectiontitle">Classes and Modules</div>
  Class "<a href="#" onclick="jsHref('classes/TestJSONEncoding/Custom.html');" class="link">TestJSONEncoding::Custom</a>"<br />
Class "<a href="#" onclick="jsHref('classes/TestJSONEncoding/Foo.html');" class="link">TestJSONEncoding::Foo</a>"<br />


  <div class="sectiontitle">Constants</div>
  <table border='0' cellpadding='5'>
  <tr valign='top'>
    <td class="attr-name">TrueTests</td>
    <td>=</td>
    <td class="attr-value">[[ true,  %(true)  ]]</td>
  </tr>
  <tr valign='top'>
    <td class="attr-name">FalseTests</td>
    <td>=</td>
    <td class="attr-value">[[ false, %(false) ]]</td>
  </tr>
  <tr valign='top'>
    <td class="attr-name">NilTests</td>
    <td>=</td>
    <td class="attr-value">[[ nil,   %(null)  ]]</td>
  </tr>
  <tr valign='top'>
    <td class="attr-name">NumericTests</td>
    <td>=</td>
    <td class="attr-value">[[ 1,     %(1)     ],                    [ 2.5,   %(2.5)   ]]</td>
  </tr>
  <tr valign='top'>
    <td class="attr-name">StringTests</td>
    <td>=</td>
    <td class="attr-value">[[ 'this is the &lt;string&gt;',     %(&quot;this is the \\u003Cstring\\u003E&quot;)],                    [ 'a &quot;string&quot; with quotes &amp; an ampersand', %(&quot;a \\&quot;string\\&quot; with quotes \\u0026 an ampersand&quot;) ],                    [ 'http://test.host/posts/1', %(&quot;http://test.host/posts/1&quot;)]]</td>
  </tr>
  <tr valign='top'>
    <td class="attr-name">ArrayTests</td>
    <td>=</td>
    <td class="attr-value">[[ ['a', 'b', 'c'],          %([\&quot;a\&quot;,\&quot;b\&quot;,\&quot;c\&quot;])          ],                    [ [1, 'a', :b, nil, false], %([1,\&quot;a\&quot;,\&quot;b\&quot;,null,false]) ]]</td>
  </tr>
  <tr valign='top'>
    <td class="attr-name">SymbolTests</td>
    <td>=</td>
    <td class="attr-value">[[ :a,     %(&quot;a&quot;)    ],                    [ :this,  %(&quot;this&quot;) ],                    [ :&quot;a b&quot;, %(&quot;a b&quot;)  ]]</td>
  </tr>
  <tr valign='top'>
    <td class="attr-name">ObjectTests</td>
    <td>=</td>
    <td class="attr-value">[[ Foo.new(1, 2), %({\&quot;a\&quot;:1,\&quot;b\&quot;:2}) ]]</td>
  </tr>
  <tr valign='top'>
    <td class="attr-name">CustomTests</td>
    <td>=</td>
    <td class="attr-value">[[ Custom.new, '&quot;custom&quot;' ]]</td>
  </tr>
  <tr valign='top'>
    <td class="attr-name">VariableTests</td>
    <td>=</td>
    <td class="attr-value">[[ ActiveSupport::JSON::Variable.new('foo'), 'foo'],                    [ ActiveSupport::JSON::Variable.new('alert(&quot;foo&quot;)'), 'alert(&quot;foo&quot;)']]</td>
  </tr>
  <tr valign='top'>
    <td class="attr-name">RegexpTests</td>
    <td>=</td>
    <td class="attr-value">[[ /^a/, '/^a/' ], [/^\w{1,2}[a-z]+/ix, '/^\\w{1,2}[a-z]+/ix']]</td>
  </tr>
  <tr valign='top'>
    <td class="attr-name">DateTests</td>
    <td>=</td>
    <td class="attr-value">[[ Date.new(2005,2,1), %(&quot;2005/02/01&quot;) ]]</td>
  </tr>
  <tr valign='top'>
    <td class="attr-name">TimeTests</td>
    <td>=</td>
    <td class="attr-value">[[ Time.utc(2005,2,1,15,15,10), %(&quot;2005/02/01 15:15:10 +0000&quot;) ]]</td>
  </tr>
  <tr valign='top'>
    <td class="attr-name">DateTimeTests</td>
    <td>=</td>
    <td class="attr-value">[[ DateTime.civil(2005,2,1,15,15,10), %(&quot;2005/02/01 15:15:10 +0000&quot;) ]]</td>
  </tr>
  <tr valign='top'>
    <td class="attr-name">StandardDateTests</td>
    <td>=</td>
    <td class="attr-value">[[ Date.new(2005,2,1), %(&quot;2005-02-01&quot;) ]]</td>
  </tr>
  <tr valign='top'>
    <td class="attr-name">StandardTimeTests</td>
    <td>=</td>
    <td class="attr-value">[[ Time.utc(2005,2,1,15,15,10), %(&quot;2005-02-01T15:15:10Z&quot;) ]]</td>
  </tr>
  <tr valign='top'>
    <td class="attr-name">StandardDateTimeTests</td>
    <td>=</td>
    <td class="attr-value">[[ DateTime.civil(2005,2,1,15,15,10), %(&quot;2005-02-01T15:15:10+00:00&quot;) ]]</td>
  </tr>
  <tr valign='top'>
    <td class="attr-name">StandardStringTests</td>
    <td>=</td>
    <td class="attr-value">[[ 'this is the &lt;string&gt;', %(&quot;this is the &lt;string&gt;&quot;)]]</td>
  </tr>
  </table>


<div class="sectiontitle">Public Instance methods</div>
<div id="M001870" class="method">
  <div id="M001870_title" class="title">
    <b>test_exception_raised_when_encoding_circular_reference</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001870_source')" id="l_M001870_source">show source</a> ]</p>
  <div id="M001870_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activesupport/test/json/encoding_test.rb, line 87</span>
87:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_exception_raised_when_encoding_circular_reference</span>
88:     <span class="ruby-identifier">a</span> = [<span class="ruby-value">1</span>]
89:     <span class="ruby-identifier">a</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">a</span>
90:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActiveSupport</span><span class="ruby-operator">::</span><span class="ruby-constant">JSON</span><span class="ruby-operator">::</span><span class="ruby-constant">Encoding</span><span class="ruby-operator">::</span><span class="ruby-constant">CircularReferenceError</span>) { <span class="ruby-constant">ActiveSupport</span><span class="ruby-operator">::</span><span class="ruby-constant">JSON</span>.<span class="ruby-identifier">encode</span>(<span class="ruby-identifier">a</span>) }
91:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001868" class="method">
  <div id="M001868_title" class="title">
    <b>test_hash_encoding</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001868_source')" id="l_M001868_source">show source</a> ]</p>
  <div id="M001868_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activesupport/test/json/encoding_test.rb, line 65</span>
65:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_hash_encoding</span>
66:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">%({\&quot;a\&quot;:\&quot;b\&quot;})</span>, <span class="ruby-constant">ActiveSupport</span><span class="ruby-operator">::</span><span class="ruby-constant">JSON</span>.<span class="ruby-identifier">encode</span>(<span class="ruby-identifier">:a</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:b</span>)
67:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">%({\&quot;a\&quot;:1})</span>,     <span class="ruby-constant">ActiveSupport</span><span class="ruby-operator">::</span><span class="ruby-constant">JSON</span>.<span class="ruby-identifier">encode</span>(<span class="ruby-value str">'a'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>)
68:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">%({\&quot;a\&quot;:[1,2]})</span>, <span class="ruby-constant">ActiveSupport</span><span class="ruby-operator">::</span><span class="ruby-constant">JSON</span>.<span class="ruby-identifier">encode</span>(<span class="ruby-value str">'a'</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value">1</span>,<span class="ruby-value">2</span>])
69:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">%({&quot;1&quot;:2})</span>,       <span class="ruby-constant">ActiveSupport</span><span class="ruby-operator">::</span><span class="ruby-constant">JSON</span>.<span class="ruby-identifier">encode</span>(<span class="ruby-value">1</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">2</span>)
70: 
71:     <span class="ruby-identifier">sorted_json</span> = <span class="ruby-value str">'{'</span> <span class="ruby-operator">+</span> <span class="ruby-constant">ActiveSupport</span><span class="ruby-operator">::</span><span class="ruby-constant">JSON</span>.<span class="ruby-identifier">encode</span>(<span class="ruby-identifier">:a</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:b</span>, <span class="ruby-identifier">:c</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:d</span>)[<span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">-2</span>].<span class="ruby-identifier">split</span>(<span class="ruby-value str">','</span>).<span class="ruby-identifier">sort</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">','</span>) <span class="ruby-operator">+</span> <span class="ruby-value str">'}'</span>
72:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">%({\&quot;a\&quot;:\&quot;b\&quot;,\&quot;c\&quot;:\&quot;d\&quot;})</span>, <span class="ruby-identifier">sorted_json</span>
73:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001871" class="method">
  <div id="M001871_title" class="title">
    <b>test_hash_key_identifiers_are_always_quoted</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001871_source')" id="l_M001871_source">show source</a> ]</p>
  <div id="M001871_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activesupport/test/json/encoding_test.rb, line 93</span>
93:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_hash_key_identifiers_are_always_quoted</span>
94:     <span class="ruby-identifier">values</span> = {<span class="ruby-value">0</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>, <span class="ruby-value">1</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">:_</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:_</span>, <span class="ruby-value str">&quot;$&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;$&quot;</span>, <span class="ruby-value str">&quot;a&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;a&quot;</span>, <span class="ruby-identifier">:A</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:A</span>, <span class="ruby-identifier">:A0</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:A0</span>, <span class="ruby-value str">&quot;A0B&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;A0B&quot;</span>}
95:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-node">%w( &quot;$&quot; &quot;A&quot; &quot;A0&quot; &quot;A0B&quot; &quot;_&quot; &quot;a&quot; &quot;0&quot; &quot;1&quot; )</span>.<span class="ruby-identifier">sort</span>, <span class="ruby-identifier">object_keys</span>(<span class="ruby-constant">ActiveSupport</span><span class="ruby-operator">::</span><span class="ruby-constant">JSON</span>.<span class="ruby-identifier">encode</span>(<span class="ruby-identifier">values</span>))
96:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001873" class="method">
  <div id="M001873_title" class="title">
    <b>test_hash_should_allow_key_filtering_with_except</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001873_source')" id="l_M001873_source">show source</a> ]</p>
  <div id="M001873_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activesupport/test/json/encoding_test.rb, line 102</span>
102:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_hash_should_allow_key_filtering_with_except</span>
103:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">%({&quot;b&quot;:2})</span>, <span class="ruby-constant">ActiveSupport</span><span class="ruby-operator">::</span><span class="ruby-constant">JSON</span>.<span class="ruby-identifier">encode</span>({<span class="ruby-value str">'foo'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'bar'</span>, <span class="ruby-identifier">:b</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">2</span>, <span class="ruby-identifier">:c</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">3</span>}, <span class="ruby-identifier">:except</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">'foo'</span>, <span class="ruby-identifier">:c</span>])
104:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001872" class="method">
  <div id="M001872_title" class="title">
    <b>test_hash_should_allow_key_filtering_with_only</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001872_source')" id="l_M001872_source">show source</a> ]</p>
  <div id="M001872_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activesupport/test/json/encoding_test.rb, line 98</span>
 98:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_hash_should_allow_key_filtering_with_only</span>
 99:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">%({&quot;a&quot;:1})</span>, <span class="ruby-constant">ActiveSupport</span><span class="ruby-operator">::</span><span class="ruby-constant">JSON</span>.<span class="ruby-identifier">encode</span>({<span class="ruby-value str">'a'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">:b</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">2</span>, <span class="ruby-identifier">:c</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">3</span>}, <span class="ruby-identifier">:only</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'a'</span>)
100:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001875" class="method">
  <div id="M001875_title" class="title">
    <b>test_nested_hash_with_float</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001875_source')" id="l_M001875_source">show source</a> ]</p>
  <div id="M001875_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activesupport/test/json/encoding_test.rb, line 115</span>
115:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_nested_hash_with_float</span>
116:     <span class="ruby-identifier">assert_nothing_raised</span> <span class="ruby-keyword kw">do</span>
117:       <span class="ruby-identifier">hash</span> = {
118:         <span class="ruby-value str">&quot;CHI&quot;</span> =<span class="ruby-operator">&gt;</span> {
119:           <span class="ruby-identifier">:dislay_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;chicago&quot;</span>,
120:           <span class="ruby-identifier">:latitude</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">123.234</span>
121:         }
122:       }
123:       <span class="ruby-identifier">result</span> = <span class="ruby-constant">ActiveSupport</span><span class="ruby-operator">::</span><span class="ruby-constant">JSON</span>.<span class="ruby-identifier">encode</span>(<span class="ruby-identifier">hash</span>)
124:     <span class="ruby-keyword kw">end</span>
125:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001874" class="method">
  <div id="M001874_title" class="title">
    <b>test_time_to_json_includes_local_offset</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001874_source')" id="l_M001874_source">show source</a> ]</p>
  <div id="M001874_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activesupport/test/json/encoding_test.rb, line 106</span>
106:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_time_to_json_includes_local_offset</span>
107:     <span class="ruby-constant">ActiveSupport</span>.<span class="ruby-identifier">use_standard_json_time_format</span> = <span class="ruby-keyword kw">true</span>
108:     <span class="ruby-identifier">with_env_tz</span> <span class="ruby-value str">'US/Eastern'</span> <span class="ruby-keyword kw">do</span>
109:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">%(&quot;2005-02-01T15:15:10-05:00&quot;)</span>, <span class="ruby-constant">ActiveSupport</span><span class="ruby-operator">::</span><span class="ruby-constant">JSON</span>.<span class="ruby-identifier">encode</span>(<span class="ruby-constant">Time</span>.<span class="ruby-identifier">local</span>(<span class="ruby-value">2005</span>,<span class="ruby-value">2</span>,<span class="ruby-value">1</span>,<span class="ruby-value">15</span>,<span class="ruby-value">15</span>,<span class="ruby-value">10</span>))
110:     <span class="ruby-keyword kw">end</span>
111:   <span class="ruby-keyword kw">ensure</span>
112:     <span class="ruby-constant">ActiveSupport</span>.<span class="ruby-identifier">use_standard_json_time_format</span> = <span class="ruby-keyword kw">false</span>
113:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001869" class="method">
  <div id="M001869_title" class="title">
    <b>test_utf8_string_encoded_properly_when_kcode_is_utf8</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001869_source')" id="l_M001869_source">show source</a> ]</p>
  <div id="M001869_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activesupport/test/json/encoding_test.rb, line 75</span>
75:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_utf8_string_encoded_properly_when_kcode_is_utf8</span>
76:     <span class="ruby-identifier">with_kcode</span> <span class="ruby-value str">'UTF8'</span> <span class="ruby-keyword kw">do</span>
77:       <span class="ruby-identifier">result</span> = <span class="ruby-constant">ActiveSupport</span><span class="ruby-operator">::</span><span class="ruby-constant">JSON</span>.<span class="ruby-identifier">encode</span>(<span class="ruby-value str">'€2.99'</span>)
78:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'&quot;\\u20ac2.99&quot;'</span>, <span class="ruby-identifier">result</span>
79:       <span class="ruby-identifier">assert_equal</span>(<span class="ruby-constant">Encoding</span><span class="ruby-operator">::</span><span class="ruby-constant">UTF_8</span>, <span class="ruby-identifier">result</span>.<span class="ruby-identifier">encoding</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">result</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:encoding</span>)
80: 
81:       <span class="ruby-identifier">result</span> = <span class="ruby-constant">ActiveSupport</span><span class="ruby-operator">::</span><span class="ruby-constant">JSON</span>.<span class="ruby-identifier">encode</span>(<span class="ruby-value str">'✎☺'</span>)
82:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'&quot;\\u270e\\u263a&quot;'</span>, <span class="ruby-identifier">result</span>
83:       <span class="ruby-identifier">assert_equal</span>(<span class="ruby-constant">Encoding</span><span class="ruby-operator">::</span><span class="ruby-constant">UTF_8</span>, <span class="ruby-identifier">result</span>.<span class="ruby-identifier">encoding</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">result</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:encoding</span>)
84:     <span class="ruby-keyword kw">end</span>
85:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div class="sectiontitle">Protected Instance methods</div>
<div id="M001876" class="method">
  <div id="M001876_title" class="title">
    <b>object_keys</b>(json_object)
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001876_source')" id="l_M001876_source">show source</a> ]</p>
  <div id="M001876_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activesupport/test/json/encoding_test.rb, line 129</span>
129:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">object_keys</span>(<span class="ruby-identifier">json_object</span>)
130:       <span class="ruby-identifier">json_object</span>[<span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">-2</span>].<span class="ruby-identifier">scan</span>(<span class="ruby-regexp re">/([^{}:,\s]+):/</span>).<span class="ruby-identifier">flatten</span>.<span class="ruby-identifier">sort</span>
131:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001877" class="method">
  <div id="M001877_title" class="title">
    <b>with_env_tz</b>(new_tz = 'US/Eastern') {|| ...}
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001877_source')" id="l_M001877_source">show source</a> ]</p>
  <div id="M001877_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activesupport/test/json/encoding_test.rb, line 133</span>
133:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">with_env_tz</span>(<span class="ruby-identifier">new_tz</span> = <span class="ruby-value str">'US/Eastern'</span>)
134:       <span class="ruby-identifier">old_tz</span>, <span class="ruby-constant">ENV</span>[<span class="ruby-value str">'TZ'</span>] = <span class="ruby-constant">ENV</span>[<span class="ruby-value str">'TZ'</span>], <span class="ruby-identifier">new_tz</span>
135:       <span class="ruby-keyword kw">yield</span>
136:     <span class="ruby-keyword kw">ensure</span>
137:       <span class="ruby-identifier">old_tz</span> <span class="ruby-value">? </span><span class="ruby-constant">ENV</span>[<span class="ruby-value str">'TZ'</span>] = <span class="ruby-identifier">old_tz</span> <span class="ruby-operator">:</span> <span class="ruby-constant">ENV</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value str">'TZ'</span>)
138:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
</div>

  </div>