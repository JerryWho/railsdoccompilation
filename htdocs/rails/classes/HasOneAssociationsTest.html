  <div id="C00000240">
<div class='banner'>
  <span class="file-title-prefix">Class</span><br />HasOneAssociationsTest<br/>
  In:
<a href="#" onclick="jsHref('files/activerecord/test/cases/associations/has_one_associations_test_rb.html');">activerecord/test/cases/associations/has_one_associations_test.rb</a>

Parent:&nbsp;
ActiveRecord::TestCase
</div>
 <!-- banner header -->

  <div id="bodyContent" >
      <div id="content">




  <div class="sectiontitle">Methods</div>
  <ul>
  <li><a href="index.html?a=M001435&name=setup" >setup</a></li>
  <li><a href="index.html?a=M001466&name=test_assignment_before_child_saved" >test_assignment_before_child_saved</a></li>
  <li><a href="index.html?a=M001450&name=test_assignment_without_replacement" >test_assignment_without_replacement</a></li>
  <li><a href="index.html?a=M001451&name=test_assignment_without_replacement_on_create" >test_assignment_without_replacement_on_create</a></li>
  <li><a href="index.html?a=M001448&name=test_association_change_calls_destroy" >test_association_change_calls_destroy</a></li>
  <li><a href="index.html?a=M001447&name=test_association_changecalls_delete" >test_association_changecalls_delete</a></li>
  <li><a href="index.html?a=M001459&name=test_build" >test_build</a></li>
  <li><a href="index.html?a=M001457&name=test_build_association_twice_without_saving_affects_nothing" >test_build_association_twice_without_saving_affects_nothing</a></li>
  <li><a href="index.html?a=M001440&name=test_can_marshal_has_one_association_with_nil_target" >test_can_marshal_has_one_association_with_nil_target</a></li>
  <li><a href="index.html?a=M001468&name=test_cant_save_readonly_association" >test_cant_save_readonly_association</a></li>
  <li><a href="index.html?a=M001461&name=test_create" >test_create</a></li>
  <li><a href="index.html?a=M001458&name=test_create_association" >test_create_association</a></li>
  <li><a href="index.html?a=M001462&name=test_create_before_save" >test_create_before_save</a></li>
  <li><a href="index.html?a=M001452&name=test_dependence" >test_dependence</a></li>
  <li><a href="index.html?a=M001463&name=test_dependence_with_missing_association" >test_dependence_with_missing_association</a></li>
  <li><a href="index.html?a=M001464&name=test_dependence_with_missing_association_and_nullify" >test_dependence_with_missing_association_and_nullify</a></li>
  <li><a href="index.html?a=M001454&name=test_dependence_with_nil_associate" >test_dependence_with_nil_associate</a></li>
  <li><a href="index.html?a=M001453&name=test_exclusive_dependence" >test_exclusive_dependence</a></li>
  <li><a href="index.html?a=M001460&name=test_failing_build_association" >test_failing_build_association</a></li>
  <li><a href="index.html?a=M001456&name=test_failing_build_association" >test_failing_build_association</a></li>
  <li><a href="index.html?a=M001439&name=test_finding_using_primary_key" >test_finding_using_primary_key</a></li>
  <li><a href="index.html?a=M001465&name=test_finding_with_interpolated_condition" >test_finding_with_interpolated_condition</a></li>
  <li><a href="index.html?a=M001436&name=test_has_one" >test_has_one</a></li>
  <li><a href="index.html?a=M001437&name=test_has_one_cache_nils" >test_has_one_cache_nils</a></li>
  <li><a href="index.html?a=M001469&name=test_has_one_proxy_should_not_respond_to_private_methods" >test_has_one_proxy_should_not_respond_to_private_methods</a></li>
  <li><a href="index.html?a=M001470&name=test_has_one_proxy_should_respond_to_private_methods_via_send" >test_has_one_proxy_should_respond_to_private_methods_via_send</a></li>
  <li><a href="index.html?a=M001444&name=test_natural_assignment" >test_natural_assignment</a></li>
  <li><a href="index.html?a=M001449&name=test_natural_assignment_to_already_associated_record" >test_natural_assignment_to_already_associated_record</a></li>
  <li><a href="index.html?a=M001445&name=test_natural_assignment_to_nil" >test_natural_assignment_to_nil</a></li>
  <li><a href="index.html?a=M001446&name=test_nullification_on_association_change" >test_nullification_on_association_change</a></li>
  <li><a href="index.html?a=M001441&name=test_proxy_assignment" >test_proxy_assignment</a></li>
  <li><a href="index.html?a=M001471&name=test_save_of_record_with_loaded_has_one" >test_save_of_record_with_loaded_has_one</a></li>
  <li><a href="index.html?a=M001467&name=test_save_still_works_after_accessing_nil_has_one" >test_save_still_works_after_accessing_nil_has_one</a></li>
  <li><a href="index.html?a=M001455&name=test_succesful_build_association" >test_succesful_build_association</a></li>
  <li><a href="index.html?a=M001442&name=test_triple_equality" >test_triple_equality</a></li>
  <li><a href="index.html?a=M001443&name=test_type_mismatch" >test_type_mismatch</a></li>
  <li><a href="index.html?a=M001438&name=test_with_select" >test_with_select</a></li>
  </ul>






<div class="sectiontitle">Public Instance methods</div>
<div id="M001435" class="method">
  <div id="M001435_title" class="title">
    <b>setup</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001435_source')" id="l_M001435_source">show source</a> ]</p>
  <div id="M001435_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_associations_test.rb, line 9</span>
 9:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">setup</span>
10:     <span class="ruby-constant">Account</span>.<span class="ruby-identifier">destroyed_account_ids</span>.<span class="ruby-identifier">clear</span>
11:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001466" class="method">
  <div id="M001466_title" class="title">
    <b>test_assignment_before_child_saved</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001466_source')" id="l_M001466_source">show source</a> ]</p>
  <div id="M001466_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_associations_test.rb, line 260</span>
260:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_assignment_before_child_saved</span>
261:     <span class="ruby-identifier">firm</span> = <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">1</span>)
262:     <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">account</span> = <span class="ruby-identifier">a</span> = <span class="ruby-constant">Account</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;credit_limit&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1000</span>)
263:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">a</span>.<span class="ruby-identifier">new_record?</span>
264:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">a</span>, <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">account</span>
265:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">a</span>, <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">account</span>
266:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">a</span>, <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">account</span>(<span class="ruby-keyword kw">true</span>)
267:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001450" class="method">
  <div id="M001450_title" class="title">
    <b>test_assignment_without_replacement</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001450_source')" id="l_M001450_source">show source</a> ]</p>
  <div id="M001450_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_associations_test.rb, line 110</span>
110:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_assignment_without_replacement</span>
111:     <span class="ruby-identifier">apple</span> = <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Apple&quot;</span>)
112:     <span class="ruby-identifier">citibank</span> = <span class="ruby-constant">Account</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;credit_limit&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">10</span>)
113:     <span class="ruby-identifier">apple</span>.<span class="ruby-identifier">account</span> = <span class="ruby-identifier">citibank</span>
114:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">apple</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">citibank</span>.<span class="ruby-identifier">firm_id</span>
115: 
116:     <span class="ruby-identifier">hsbc</span> = <span class="ruby-identifier">apple</span>.<span class="ruby-identifier">build_account</span>({ <span class="ruby-identifier">:credit_limit</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">20</span>}, <span class="ruby-keyword kw">false</span>)
117:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">apple</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">hsbc</span>.<span class="ruby-identifier">firm_id</span>
118:     <span class="ruby-identifier">hsbc</span>.<span class="ruby-identifier">save</span>
119:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">apple</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">citibank</span>.<span class="ruby-identifier">firm_id</span>
120: 
121:     <span class="ruby-identifier">nykredit</span> = <span class="ruby-identifier">apple</span>.<span class="ruby-identifier">create_account</span>({ <span class="ruby-identifier">:credit_limit</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">30</span>}, <span class="ruby-keyword kw">false</span>)
122:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">apple</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">nykredit</span>.<span class="ruby-identifier">firm_id</span>
123:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">apple</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">citibank</span>.<span class="ruby-identifier">firm_id</span>
124:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">apple</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">hsbc</span>.<span class="ruby-identifier">firm_id</span>
125:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001451" class="method">
  <div id="M001451_title" class="title">
    <b>test_assignment_without_replacement_on_create</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001451_source')" id="l_M001451_source">show source</a> ]</p>
  <div id="M001451_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_associations_test.rb, line 127</span>
127:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_assignment_without_replacement_on_create</span>
128:     <span class="ruby-identifier">apple</span> = <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Apple&quot;</span>)
129:     <span class="ruby-identifier">citibank</span> = <span class="ruby-constant">Account</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;credit_limit&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">10</span>)
130:     <span class="ruby-identifier">apple</span>.<span class="ruby-identifier">account</span> = <span class="ruby-identifier">citibank</span>
131:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">apple</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">citibank</span>.<span class="ruby-identifier">firm_id</span>
132: 
133:     <span class="ruby-identifier">hsbc</span> = <span class="ruby-identifier">apple</span>.<span class="ruby-identifier">create_account</span>({<span class="ruby-identifier">:credit_limit</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">10</span>}, <span class="ruby-keyword kw">false</span>)
134:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">apple</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">hsbc</span>.<span class="ruby-identifier">firm_id</span>
135:     <span class="ruby-identifier">hsbc</span>.<span class="ruby-identifier">save</span>
136:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">apple</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">citibank</span>.<span class="ruby-identifier">firm_id</span>
137:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001448" class="method">
  <div id="M001448_title" class="title">
    <b>test_association_change_calls_destroy</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001448_source')" id="l_M001448_source">show source</a> ]</p>
  <div id="M001448_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_associations_test.rb, line 95</span>
95:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_association_change_calls_destroy</span>
96:     <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">account</span> = <span class="ruby-constant">Account</span>.<span class="ruby-identifier">new</span>
97:     <span class="ruby-identifier">assert_equal</span> [<span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">id</span>], <span class="ruby-constant">Account</span>.<span class="ruby-identifier">destroyed_account_ids</span>[<span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">id</span>]
98:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001447" class="method">
  <div id="M001447_title" class="title">
    <b>test_association_changecalls_delete</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001447_source')" id="l_M001447_source">show source</a> ]</p>
  <div id="M001447_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_associations_test.rb, line 90</span>
90:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_association_changecalls_delete</span>
91:     <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">deletable_account</span> = <span class="ruby-constant">Account</span>.<span class="ruby-identifier">new</span>
92:     <span class="ruby-identifier">assert_equal</span> [], <span class="ruby-constant">Account</span>.<span class="ruby-identifier">destroyed_account_ids</span>[<span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">id</span>]
93:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001459" class="method">
  <div id="M001459_title" class="title">
    <b>test_build</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001459_source')" id="l_M001459_source">show source</a> ]</p>
  <div id="M001459_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_associations_test.rb, line 204</span>
204:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_build</span>
205:     <span class="ruby-identifier">firm</span> = <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;GlobalMegaCorp&quot;</span>)
206:     <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">save</span>
207: 
208:     <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">account</span> = <span class="ruby-identifier">account</span> = <span class="ruby-constant">Account</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;credit_limit&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1000</span>)
209:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">account</span>, <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">account</span>
210:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">account</span>.<span class="ruby-identifier">save</span>
211:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">account</span>, <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">account</span>
212:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001457" class="method">
  <div id="M001457_title" class="title">
    <b>test_build_association_twice_without_saving_affects_nothing</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001457_source')" id="l_M001457_source">show source</a> ]</p>
  <div id="M001457_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_associations_test.rb, line 189</span>
189:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_build_association_twice_without_saving_affects_nothing</span>
190:     <span class="ruby-identifier">count_of_account</span> = <span class="ruby-constant">Account</span>.<span class="ruby-identifier">count</span>
191:     <span class="ruby-identifier">firm</span> = <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>)
192:     <span class="ruby-identifier">account1</span> = <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">build_account</span>(<span class="ruby-value str">&quot;credit_limit&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1000</span>)
193:     <span class="ruby-identifier">account2</span> = <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">build_account</span>(<span class="ruby-value str">&quot;credit_limit&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">2000</span>)
194: 
195:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">count_of_account</span>, <span class="ruby-constant">Account</span>.<span class="ruby-identifier">count</span>
196:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001440" class="method">
  <div id="M001440_title" class="title">
    <b>test_can_marshal_has_one_association_with_nil_target</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001440_source')" id="l_M001440_source">show source</a> ]</p>
  <div id="M001440_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_associations_test.rb, line 39</span>
39:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_can_marshal_has_one_association_with_nil_target</span>
40:     <span class="ruby-identifier">firm</span> = <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">new</span>
41:     <span class="ruby-identifier">assert_nothing_raised</span> <span class="ruby-keyword kw">do</span>
42:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">attributes</span>, <span class="ruby-constant">Marshal</span>.<span class="ruby-identifier">load</span>(<span class="ruby-constant">Marshal</span>.<span class="ruby-identifier">dump</span>(<span class="ruby-identifier">firm</span>)).<span class="ruby-identifier">attributes</span>
43:     <span class="ruby-keyword kw">end</span>
44: 
45:     <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">account</span>
46:     <span class="ruby-identifier">assert_nothing_raised</span> <span class="ruby-keyword kw">do</span>
47:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">attributes</span>, <span class="ruby-constant">Marshal</span>.<span class="ruby-identifier">load</span>(<span class="ruby-constant">Marshal</span>.<span class="ruby-identifier">dump</span>(<span class="ruby-identifier">firm</span>)).<span class="ruby-identifier">attributes</span>
48:     <span class="ruby-keyword kw">end</span>
49:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001468" class="method">
  <div id="M001468_title" class="title">
    <b>test_cant_save_readonly_association</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001468_source')" id="l_M001468_source">show source</a> ]</p>
  <div id="M001468_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_associations_test.rb, line 278</span>
278:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_cant_save_readonly_association</span>
279:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">ReadOnlyRecord</span>) { <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">readonly_account</span>.<span class="ruby-identifier">save!</span>  }
280:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">readonly_account</span>.<span class="ruby-identifier">readonly?</span>
281:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001461" class="method">
  <div id="M001461_title" class="title">
    <b>test_create</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001461_source')" id="l_M001461_source">show source</a> ]</p>
  <div id="M001461_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_associations_test.rb, line 225</span>
225:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_create</span>
226:     <span class="ruby-identifier">firm</span> = <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;GlobalMegaCorp&quot;</span>)
227:     <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">save</span>
228:     <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">account</span> = <span class="ruby-identifier">account</span> = <span class="ruby-constant">Account</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;credit_limit&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1000</span>)
229:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">account</span>, <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">account</span>
230:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001458" class="method">
  <div id="M001458_title" class="title">
    <b>test_create_association</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001458_source')" id="l_M001458_source">show source</a> ]</p>
  <div id="M001458_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_associations_test.rb, line 198</span>
198:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_create_association</span>
199:     <span class="ruby-identifier">firm</span> = <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;GlobalMegaCorp&quot;</span>)
200:     <span class="ruby-identifier">account</span> = <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">create_account</span>(<span class="ruby-identifier">:credit_limit</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1000</span>)
201:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">account</span>, <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">reload</span>.<span class="ruby-identifier">account</span>
202:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001462" class="method">
  <div id="M001462_title" class="title">
    <b>test_create_before_save</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001462_source')" id="l_M001462_source">show source</a> ]</p>
  <div id="M001462_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_associations_test.rb, line 232</span>
232:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_create_before_save</span>
233:     <span class="ruby-identifier">firm</span> = <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;GlobalMegaCorp&quot;</span>)
234:     <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">account</span> = <span class="ruby-identifier">account</span> = <span class="ruby-constant">Account</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;credit_limit&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1000</span>)
235:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">account</span>, <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">account</span>
236:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001452" class="method">
  <div id="M001452_title" class="title">
    <b>test_dependence</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001452_source')" id="l_M001452_source">show source</a> ]</p>
  <div id="M001452_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_associations_test.rb, line 139</span>
139:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_dependence</span>
140:     <span class="ruby-identifier">num_accounts</span> = <span class="ruby-constant">Account</span>.<span class="ruby-identifier">count</span>
141: 
142:     <span class="ruby-identifier">firm</span> = <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">1</span>)
143:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">firm</span>.<span class="ruby-identifier">account</span>.<span class="ruby-identifier">nil?</span>
144:     <span class="ruby-identifier">account_id</span> = <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">account</span>.<span class="ruby-identifier">id</span>
145:     <span class="ruby-identifier">assert_equal</span> [], <span class="ruby-constant">Account</span>.<span class="ruby-identifier">destroyed_account_ids</span>[<span class="ruby-identifier">firm</span>.<span class="ruby-identifier">id</span>]
146: 
147:     <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">destroy</span>
148:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">num_accounts</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>, <span class="ruby-constant">Account</span>.<span class="ruby-identifier">count</span>
149:     <span class="ruby-identifier">assert_equal</span> [<span class="ruby-identifier">account_id</span>], <span class="ruby-constant">Account</span>.<span class="ruby-identifier">destroyed_account_ids</span>[<span class="ruby-identifier">firm</span>.<span class="ruby-identifier">id</span>]
150:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001463" class="method">
  <div id="M001463_title" class="title">
    <b>test_dependence_with_missing_association</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001463_source')" id="l_M001463_source">show source</a> ]</p>
  <div id="M001463_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_associations_test.rb, line 238</span>
238:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_dependence_with_missing_association</span>
239:     <span class="ruby-constant">Account</span>.<span class="ruby-identifier">destroy_all</span>
240:     <span class="ruby-identifier">firm</span> = <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">1</span>)
241:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">account</span>.<span class="ruby-identifier">nil?</span>
242:     <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">destroy</span>
243:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001464" class="method">
  <div id="M001464_title" class="title">
    <b>test_dependence_with_missing_association_and_nullify</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001464_source')" id="l_M001464_source">show source</a> ]</p>
  <div id="M001464_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_associations_test.rb, line 245</span>
245:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_dependence_with_missing_association_and_nullify</span>
246:     <span class="ruby-constant">Account</span>.<span class="ruby-identifier">destroy_all</span>
247:     <span class="ruby-identifier">firm</span> = <span class="ruby-constant">DependentFirm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>)
248:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">account</span>.<span class="ruby-identifier">nil?</span>
249:     <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">destroy</span>
250:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001454" class="method">
  <div id="M001454_title" class="title">
    <b>test_dependence_with_nil_associate</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001454_source')" id="l_M001454_source">show source</a> ]</p>
  <div id="M001454_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_associations_test.rb, line 165</span>
165:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_dependence_with_nil_associate</span>
166:     <span class="ruby-identifier">firm</span> = <span class="ruby-constant">DependentFirm</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'nullify'</span>)
167:     <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">save!</span>
168:     <span class="ruby-identifier">assert_nothing_raised</span> { <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">destroy</span> }
169:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001453" class="method">
  <div id="M001453_title" class="title">
    <b>test_exclusive_dependence</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001453_source')" id="l_M001453_source">show source</a> ]</p>
  <div id="M001453_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_associations_test.rb, line 152</span>
152:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_exclusive_dependence</span>
153:     <span class="ruby-identifier">num_accounts</span> = <span class="ruby-constant">Account</span>.<span class="ruby-identifier">count</span>
154: 
155:     <span class="ruby-identifier">firm</span> = <span class="ruby-constant">ExclusivelyDependentFirm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">9</span>)
156:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">firm</span>.<span class="ruby-identifier">account</span>.<span class="ruby-identifier">nil?</span>
157:     <span class="ruby-identifier">account_id</span> = <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">account</span>.<span class="ruby-identifier">id</span>
158:     <span class="ruby-identifier">assert_equal</span> [], <span class="ruby-constant">Account</span>.<span class="ruby-identifier">destroyed_account_ids</span>[<span class="ruby-identifier">firm</span>.<span class="ruby-identifier">id</span>]
159: 
160:     <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">destroy</span>
161:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">num_accounts</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>, <span class="ruby-constant">Account</span>.<span class="ruby-identifier">count</span>
162:     <span class="ruby-identifier">assert_equal</span> [], <span class="ruby-constant">Account</span>.<span class="ruby-identifier">destroyed_account_ids</span>[<span class="ruby-identifier">firm</span>.<span class="ruby-identifier">id</span>]
163:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001460" class="method">
  <div id="M001460_title" class="title">
    <b>test_failing_build_association</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001460_source')" id="l_M001460_source">show source</a> ]</p>
  <div id="M001460_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_associations_test.rb, line 214</span>
214:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_failing_build_association</span>
215:     <span class="ruby-identifier">firm</span> = <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;GlobalMegaCorp&quot;</span>)
216:     <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">save</span>
217: 
218:     <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">account</span> = <span class="ruby-identifier">account</span> = <span class="ruby-constant">Account</span>.<span class="ruby-identifier">new</span>
219:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">account</span>, <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">account</span>
220:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">account</span>.<span class="ruby-identifier">save</span>
221:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">account</span>, <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">account</span>
222:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;can't be empty&quot;</span>, <span class="ruby-identifier">account</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-value str">&quot;credit_limit&quot;</span>)
223:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001456" class="method">
  <div id="M001456_title" class="title">
    <b>test_failing_build_association</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001456_source')" id="l_M001456_source">show source</a> ]</p>
  <div id="M001456_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_associations_test.rb, line 180</span>
180:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_failing_build_association</span>
181:     <span class="ruby-identifier">firm</span> = <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;GlobalMegaCorp&quot;</span>)
182:     <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">save</span>
183: 
184:     <span class="ruby-identifier">account</span> = <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">build_account</span>
185:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">account</span>.<span class="ruby-identifier">save</span>
186:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;can't be empty&quot;</span>, <span class="ruby-identifier">account</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-value str">&quot;credit_limit&quot;</span>)
187:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001439" class="method">
  <div id="M001439_title" class="title">
    <b>test_finding_using_primary_key</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001439_source')" id="l_M001439_source">show source</a> ]</p>
  <div id="M001439_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_associations_test.rb, line 32</span>
32:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_finding_using_primary_key</span>
33:     <span class="ruby-identifier">firm</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>)
34:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-constant">Account</span>.<span class="ruby-identifier">find_by_firm_id</span>(<span class="ruby-identifier">firm</span>.<span class="ruby-identifier">id</span>), <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">account</span>
35:     <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">firm_id</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:rails_core</span>).<span class="ruby-identifier">id</span>
36:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">accounts</span>(<span class="ruby-identifier">:rails_core_account</span>), <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">account_using_primary_key</span>
37:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001465" class="method">
  <div id="M001465_title" class="title">
    <b>test_finding_with_interpolated_condition</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001465_source')" id="l_M001465_source">show source</a> ]</p>
  <div id="M001465_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_associations_test.rb, line 252</span>
252:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_finding_with_interpolated_condition</span>
253:     <span class="ruby-identifier">firm</span> = <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>)
254:     <span class="ruby-identifier">superior</span> = <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'SuperiorCo'</span>)
255:     <span class="ruby-identifier">superior</span>.<span class="ruby-identifier">rating</span> = <span class="ruby-value">10</span>
256:     <span class="ruby-identifier">superior</span>.<span class="ruby-identifier">save</span>
257:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">10</span>, <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients_with_interpolated_conditions</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">rating</span>
258:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001436" class="method">
  <div id="M001436_title" class="title">
    <b>test_has_one</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001436_source')" id="l_M001436_source">show source</a> ]</p>
  <div id="M001436_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_associations_test.rb, line 13</span>
13:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_has_one</span>
14:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">account</span>, <span class="ruby-constant">Account</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">1</span>)
15:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-constant">Account</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">1</span>).<span class="ruby-identifier">credit_limit</span>, <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">account</span>.<span class="ruby-identifier">credit_limit</span>
16:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001437" class="method">
  <div id="M001437_title" class="title">
    <b>test_has_one_cache_nils</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001437_source')" id="l_M001437_source">show source</a> ]</p>
  <div id="M001437_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_associations_test.rb, line 18</span>
18:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_has_one_cache_nils</span>
19:     <span class="ruby-identifier">firm</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:another_firm</span>)
20:     <span class="ruby-identifier">assert_queries</span>(<span class="ruby-value">1</span>) { <span class="ruby-identifier">assert_nil</span> <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">account</span> }
21:     <span class="ruby-identifier">assert_queries</span>(<span class="ruby-value">0</span>) { <span class="ruby-identifier">assert_nil</span> <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">account</span> }
22: 
23:     <span class="ruby-identifier">firms</span> = <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>, <span class="ruby-identifier">:include</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:account</span>)
24:     <span class="ruby-identifier">assert_queries</span>(<span class="ruby-value">0</span>) { <span class="ruby-identifier">firms</span>.<span class="ruby-identifier">each</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">:account</span>) }
25:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001469" class="method">
  <div id="M001469_title" class="title">
    <b>test_has_one_proxy_should_not_respond_to_private_methods</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001469_source')" id="l_M001469_source">show source</a> ]</p>
  <div id="M001469_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_associations_test.rb, line 283</span>
283:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_has_one_proxy_should_not_respond_to_private_methods</span>
284:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">NoMethodError</span>) { <span class="ruby-identifier">accounts</span>(<span class="ruby-identifier">:signals37</span>).<span class="ruby-identifier">private_method</span> }
285:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">NoMethodError</span>) { <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">account</span>.<span class="ruby-identifier">private_method</span> }
286:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001470" class="method">
  <div id="M001470_title" class="title">
    <b>test_has_one_proxy_should_respond_to_private_methods_via_send</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001470_source')" id="l_M001470_source">show source</a> ]</p>
  <div id="M001470_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_associations_test.rb, line 288</span>
288:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_has_one_proxy_should_respond_to_private_methods_via_send</span>
289:     <span class="ruby-identifier">accounts</span>(<span class="ruby-identifier">:signals37</span>).<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:private_method</span>)
290:     <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">account</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:private_method</span>)
291:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001444" class="method">
  <div id="M001444_title" class="title">
    <b>test_natural_assignment</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001444_source')" id="l_M001444_source">show source</a> ]</p>
  <div id="M001444_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_associations_test.rb, line 66</span>
66:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_natural_assignment</span>
67:     <span class="ruby-identifier">apple</span> = <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Apple&quot;</span>)
68:     <span class="ruby-identifier">citibank</span> = <span class="ruby-constant">Account</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;credit_limit&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">10</span>)
69:     <span class="ruby-identifier">apple</span>.<span class="ruby-identifier">account</span> = <span class="ruby-identifier">citibank</span>
70:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">apple</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">citibank</span>.<span class="ruby-identifier">firm_id</span>
71:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001449" class="method">
  <div id="M001449_title" class="title">
    <b>test_natural_assignment_to_already_associated_record</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001449_source')" id="l_M001449_source">show source</a> ]</p>
  <div id="M001449_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_associations_test.rb, line 100</span>
100:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_natural_assignment_to_already_associated_record</span>
101:     <span class="ruby-identifier">company</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>)
102:     <span class="ruby-identifier">account</span> = <span class="ruby-identifier">accounts</span>(<span class="ruby-identifier">:signals37</span>)
103:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">company</span>.<span class="ruby-identifier">account</span>, <span class="ruby-identifier">account</span>
104:     <span class="ruby-identifier">company</span>.<span class="ruby-identifier">account</span> = <span class="ruby-identifier">account</span>
105:     <span class="ruby-identifier">company</span>.<span class="ruby-identifier">reload</span>
106:     <span class="ruby-identifier">account</span>.<span class="ruby-identifier">reload</span>
107:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">company</span>.<span class="ruby-identifier">account</span>, <span class="ruby-identifier">account</span>
108:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001445" class="method">
  <div id="M001445_title" class="title">
    <b>test_natural_assignment_to_nil</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001445_source')" id="l_M001445_source">show source</a> ]</p>
  <div id="M001445_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_associations_test.rb, line 73</span>
73:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_natural_assignment_to_nil</span>
74:     <span class="ruby-identifier">old_account_id</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">account</span>.<span class="ruby-identifier">id</span>
75:     <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">account</span> = <span class="ruby-keyword kw">nil</span>
76:     <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">save</span>
77:     <span class="ruby-identifier">assert_nil</span> <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">account</span>
78:     <span class="ruby-comment cmt"># account is dependent, therefore is destroyed when reference to owner is lost</span>
79:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">RecordNotFound</span>) { <span class="ruby-constant">Account</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">old_account_id</span>) }
80:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001446" class="method">
  <div id="M001446_title" class="title">
    <b>test_nullification_on_association_change</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001446_source')" id="l_M001446_source">show source</a> ]</p>
  <div id="M001446_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_associations_test.rb, line 82</span>
82:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_nullification_on_association_change</span>
83:     <span class="ruby-identifier">firm</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:rails_core</span>)
84:     <span class="ruby-identifier">old_account_id</span> = <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">account</span>.<span class="ruby-identifier">id</span>
85:     <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">account</span> = <span class="ruby-constant">Account</span>.<span class="ruby-identifier">new</span>
86:     <span class="ruby-comment cmt"># account is dependent with nullify, therefore its firm_id should be nil</span>
87:     <span class="ruby-identifier">assert_nil</span> <span class="ruby-constant">Account</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">old_account_id</span>).<span class="ruby-identifier">firm_id</span>
88:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001441" class="method">
  <div id="M001441_title" class="title">
    <b>test_proxy_assignment</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001441_source')" id="l_M001441_source">show source</a> ]</p>
  <div id="M001441_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_associations_test.rb, line 51</span>
51:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_proxy_assignment</span>
52:     <span class="ruby-identifier">company</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>)
53:     <span class="ruby-identifier">assert_nothing_raised</span> { <span class="ruby-identifier">company</span>.<span class="ruby-identifier">account</span> = <span class="ruby-identifier">company</span>.<span class="ruby-identifier">account</span> }
54:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001471" class="method">
  <div id="M001471_title" class="title">
    <b>test_save_of_record_with_loaded_has_one</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001471_source')" id="l_M001471_source">show source</a> ]</p>
  <div id="M001471_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_associations_test.rb, line 293</span>
293:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_save_of_record_with_loaded_has_one</span>
294:     <span class="ruby-ivar">@firm</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>)
295:     <span class="ruby-identifier">assert_not_nil</span> <span class="ruby-ivar">@firm</span>.<span class="ruby-identifier">account</span>
296: 
297:     <span class="ruby-identifier">assert_nothing_raised</span> <span class="ruby-keyword kw">do</span>
298:       <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-ivar">@firm</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">save!</span>
299:       <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-ivar">@firm</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">:include</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:account</span>).<span class="ruby-identifier">save!</span>
300:     <span class="ruby-keyword kw">end</span>
301: 
302:     <span class="ruby-ivar">@firm</span>.<span class="ruby-identifier">account</span>.<span class="ruby-identifier">destroy</span>
303: 
304:     <span class="ruby-identifier">assert_nothing_raised</span> <span class="ruby-keyword kw">do</span>
305:       <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-ivar">@firm</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">save!</span>
306:       <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-ivar">@firm</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">:include</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:account</span>).<span class="ruby-identifier">save!</span>
307:     <span class="ruby-keyword kw">end</span>
308:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001467" class="method">
  <div id="M001467_title" class="title">
    <b>test_save_still_works_after_accessing_nil_has_one</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001467_source')" id="l_M001467_source">show source</a> ]</p>
  <div id="M001467_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_associations_test.rb, line 269</span>
269:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_save_still_works_after_accessing_nil_has_one</span>
270:     <span class="ruby-identifier">jp</span> = <span class="ruby-constant">Company</span>.<span class="ruby-identifier">new</span> <span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'Jaded Pixel'</span>
271:     <span class="ruby-identifier">jp</span>.<span class="ruby-identifier">dummy_account</span>.<span class="ruby-identifier">nil?</span>
272: 
273:     <span class="ruby-identifier">assert_nothing_raised</span> <span class="ruby-keyword kw">do</span>
274:       <span class="ruby-identifier">jp</span>.<span class="ruby-identifier">save!</span>
275:     <span class="ruby-keyword kw">end</span>
276:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001455" class="method">
  <div id="M001455_title" class="title">
    <b>test_succesful_build_association</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001455_source')" id="l_M001455_source">show source</a> ]</p>
  <div id="M001455_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_associations_test.rb, line 171</span>
171:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_succesful_build_association</span>
172:     <span class="ruby-identifier">firm</span> = <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;GlobalMegaCorp&quot;</span>)
173:     <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">save</span>
174: 
175:     <span class="ruby-identifier">account</span> = <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">build_account</span>(<span class="ruby-value str">&quot;credit_limit&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1000</span>)
176:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">account</span>.<span class="ruby-identifier">save</span>
177:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">account</span>, <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">account</span>
178:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001442" class="method">
  <div id="M001442_title" class="title">
    <b>test_triple_equality</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001442_source')" id="l_M001442_source">show source</a> ]</p>
  <div id="M001442_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_associations_test.rb, line 56</span>
56:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_triple_equality</span>
57:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">Account</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">account</span>
58:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">account</span> <span class="ruby-operator">===</span> <span class="ruby-constant">Account</span>
59:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001443" class="method">
  <div id="M001443_title" class="title">
    <b>test_type_mismatch</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001443_source')" id="l_M001443_source">show source</a> ]</p>
  <div id="M001443_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_associations_test.rb, line 61</span>
61:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_type_mismatch</span>
62:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">AssociationTypeMismatch</span>) { <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">account</span> = <span class="ruby-value">1</span> }
63:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">AssociationTypeMismatch</span>) { <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">account</span> = <span class="ruby-constant">Project</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">1</span>) }
64:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001438" class="method">
  <div id="M001438_title" class="title">
    <b>test_with_select</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001438_source')" id="l_M001438_source">show source</a> ]</p>
  <div id="M001438_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_associations_test.rb, line 27</span>
27:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_with_select</span>
28:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">1</span>).<span class="ruby-identifier">account_with_select</span>.<span class="ruby-identifier">attributes</span>.<span class="ruby-identifier">size</span>, <span class="ruby-value">2</span>
29:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">1</span>, <span class="ruby-identifier">:include</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:account_with_select</span>).<span class="ruby-identifier">account_with_select</span>.<span class="ruby-identifier">attributes</span>.<span class="ruby-identifier">size</span>, <span class="ruby-value">2</span>
30:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
</div>

  </div>