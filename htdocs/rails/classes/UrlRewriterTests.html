  <div id="C00000896">
<div class='banner'>
  <span class="file-title-prefix">Class</span><br />UrlRewriterTests<br/>
  In:
<a href="#" onclick="jsHref('files/actionpack/test/controller/url_rewriter_test_rb.html');">actionpack/test/controller/url_rewriter_test.rb</a>

Parent:&nbsp;
ActionController::TestCase
</div>
 <!-- banner header -->

  <div id="bodyContent" >
      <div id="content">




  <div class="sectiontitle">Methods</div>
  <ul>
  <li><a href="index.html?a=M006187&name=setup" >setup</a></li>
  <li><a href="index.html?a=M006192&name=test_anchor" >test_anchor</a></li>
  <li><a href="index.html?a=M006194&name=test_anchor_should_be_cgi_escaped" >test_anchor_should_be_cgi_escaped</a></li>
  <li><a href="index.html?a=M006193&name=test_anchor_should_call_to_param" >test_anchor_should_call_to_param</a></li>
  <li><a href="index.html?a=M006195&name=test_overwrite_params" >test_overwrite_params</a></li>
  <li><a href="index.html?a=M006196&name=test_overwrite_removes_original" >test_overwrite_removes_original</a></li>
  <li><a href="index.html?a=M006188&name=test_port" >test_port</a></li>
  <li><a href="index.html?a=M006189&name=test_protocol_with_and_without_separator" >test_protocol_with_and_without_separator</a></li>
  <li><a href="index.html?a=M006197&name=test_to_str" >test_to_str</a></li>
  <li><a href="index.html?a=M006198&name=test_trailing_slash" >test_trailing_slash</a></li>
  <li><a href="index.html?a=M006190&name=test_user_name_and_password" >test_user_name_and_password</a></li>
  <li><a href="index.html?a=M006191&name=test_user_name_and_password_with_escape_codes" >test_user_name_and_password_with_escape_codes</a></li>
  </ul>






<div class="sectiontitle">Public Instance methods</div>
<div id="M006187" class="method">
  <div id="M006187_title" class="title">
    <b>setup</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006187_source')" id="l_M006187_source">show source</a> ]</p>
  <div id="M006187_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/url_rewriter_test.rb, line 6</span>
 6:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">setup</span>
 7:     <span class="ruby-ivar">@request</span> = <span class="ruby-constant">ActionController</span><span class="ruby-operator">::</span><span class="ruby-constant">TestRequest</span>.<span class="ruby-identifier">new</span>
 8:     <span class="ruby-ivar">@params</span> = {}
 9:     <span class="ruby-ivar">@rewriter</span> = <span class="ruby-constant">ActionController</span><span class="ruby-operator">::</span><span class="ruby-constant">UrlRewriter</span>.<span class="ruby-identifier">new</span>(<span class="ruby-ivar">@request</span>, <span class="ruby-ivar">@params</span>)
10:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006192" class="method">
  <div id="M006192_title" class="title">
    <b>test_anchor</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006192_source')" id="l_M006192_source">show source</a> ]</p>
  <div id="M006192_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/url_rewriter_test.rb, line 42</span>
42:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_anchor</span>
43:     <span class="ruby-identifier">assert_equal</span>(
44:       <span class="ruby-value str">'http://test.host/c/a/i#anchor'</span>,
45:       <span class="ruby-ivar">@rewriter</span>.<span class="ruby-identifier">rewrite</span>(<span class="ruby-identifier">:controller</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'c'</span>, <span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'a'</span>, <span class="ruby-identifier">:id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'i'</span>, <span class="ruby-identifier">:anchor</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'anchor'</span>)
46:     )
47:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006194" class="method">
  <div id="M006194_title" class="title">
    <b>test_anchor_should_be_cgi_escaped</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006194_source')" id="l_M006194_source">show source</a> ]</p>
  <div id="M006194_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/url_rewriter_test.rb, line 56</span>
56:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_anchor_should_be_cgi_escaped</span>
57:     <span class="ruby-identifier">assert_equal</span>(
58:       <span class="ruby-value str">'http://test.host/c/a/i#anc%2Fhor'</span>,
59:       <span class="ruby-ivar">@rewriter</span>.<span class="ruby-identifier">rewrite</span>(<span class="ruby-identifier">:controller</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'c'</span>, <span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'a'</span>, <span class="ruby-identifier">:id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'i'</span>, <span class="ruby-identifier">:anchor</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Struct</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">:to_param</span>).<span class="ruby-identifier">new</span>(<span class="ruby-value str">'anc/hor'</span>))
60:     )
61:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006193" class="method">
  <div id="M006193_title" class="title">
    <b>test_anchor_should_call_to_param</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006193_source')" id="l_M006193_source">show source</a> ]</p>
  <div id="M006193_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/url_rewriter_test.rb, line 49</span>
49:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_anchor_should_call_to_param</span>
50:     <span class="ruby-identifier">assert_equal</span>(
51:       <span class="ruby-value str">'http://test.host/c/a/i#anchor'</span>,
52:       <span class="ruby-ivar">@rewriter</span>.<span class="ruby-identifier">rewrite</span>(<span class="ruby-identifier">:controller</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'c'</span>, <span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'a'</span>, <span class="ruby-identifier">:id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'i'</span>, <span class="ruby-identifier">:anchor</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Struct</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">:to_param</span>).<span class="ruby-identifier">new</span>(<span class="ruby-value str">'anchor'</span>))
53:     )
54:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006195" class="method">
  <div id="M006195_title" class="title">
    <b>test_overwrite_params</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006195_source')" id="l_M006195_source">show source</a> ]</p>
  <div id="M006195_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/url_rewriter_test.rb, line 63</span>
63:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_overwrite_params</span>
64:     <span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:controller</span>] = <span class="ruby-value str">'hi'</span>
65:     <span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:action</span>] = <span class="ruby-value str">'bye'</span>
66:     <span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:id</span>] = <span class="ruby-value str">'2'</span>
67: 
68:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'/hi/hi/2'</span>, <span class="ruby-ivar">@rewriter</span>.<span class="ruby-identifier">rewrite</span>(<span class="ruby-identifier">:only_path</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>, <span class="ruby-identifier">:overwrite_params</span> =<span class="ruby-operator">&gt;</span> {<span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'hi'</span>})
69:     <span class="ruby-identifier">u</span> = <span class="ruby-ivar">@rewriter</span>.<span class="ruby-identifier">rewrite</span>(<span class="ruby-identifier">:only_path</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">false</span>, <span class="ruby-identifier">:overwrite_params</span> =<span class="ruby-operator">&gt;</span> {<span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'hi'</span>})
70:     <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp re">%r(/hi/hi/2$)</span>, <span class="ruby-identifier">u</span>
71:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006196" class="method">
  <div id="M006196_title" class="title">
    <b>test_overwrite_removes_original</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006196_source')" id="l_M006196_source">show source</a> ]</p>
  <div id="M006196_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/url_rewriter_test.rb, line 73</span>
73:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_overwrite_removes_original</span>
74:     <span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:controller</span>] = <span class="ruby-value str">'search'</span>
75:     <span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:action</span>] = <span class="ruby-value str">'list'</span>
76:     <span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:list_page</span>] = <span class="ruby-value">1</span>
77: 
78:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'/search/list?list_page=2'</span>, <span class="ruby-ivar">@rewriter</span>.<span class="ruby-identifier">rewrite</span>(<span class="ruby-identifier">:only_path</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>, <span class="ruby-identifier">:overwrite_params</span> =<span class="ruby-operator">&gt;</span> {<span class="ruby-value str">&quot;list_page&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">2</span>})
79:     <span class="ruby-identifier">u</span> = <span class="ruby-ivar">@rewriter</span>.<span class="ruby-identifier">rewrite</span>(<span class="ruby-identifier">:only_path</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">false</span>, <span class="ruby-identifier">:overwrite_params</span> =<span class="ruby-operator">&gt;</span> {<span class="ruby-identifier">:list_page</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">2</span>})
80:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'http://test.host/search/list?list_page=2'</span>, <span class="ruby-identifier">u</span>
81:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006188" class="method">
  <div id="M006188_title" class="title">
    <b>test_port</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006188_source')" id="l_M006188_source">show source</a> ]</p>
  <div id="M006188_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/url_rewriter_test.rb, line 12</span>
12:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_port</span>
13:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">'http://test.host:1271/c/a/i'</span>,
14:       <span class="ruby-ivar">@rewriter</span>.<span class="ruby-identifier">rewrite</span>(<span class="ruby-identifier">:controller</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'c'</span>, <span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'a'</span>, <span class="ruby-identifier">:id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'i'</span>, <span class="ruby-identifier">:port</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1271</span>)
15:     )
16:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006189" class="method">
  <div id="M006189_title" class="title">
    <b>test_protocol_with_and_without_separator</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006189_source')" id="l_M006189_source">show source</a> ]</p>
  <div id="M006189_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/url_rewriter_test.rb, line 18</span>
18:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_protocol_with_and_without_separator</span>
19:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">'https://test.host/c/a/i'</span>,
20:       <span class="ruby-ivar">@rewriter</span>.<span class="ruby-identifier">rewrite</span>(<span class="ruby-identifier">:protocol</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'https'</span>, <span class="ruby-identifier">:controller</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'c'</span>, <span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'a'</span>, <span class="ruby-identifier">:id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'i'</span>)
21:     )
22: 
23:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">'https://test.host/c/a/i'</span>,
24:       <span class="ruby-ivar">@rewriter</span>.<span class="ruby-identifier">rewrite</span>(<span class="ruby-identifier">:protocol</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'https://'</span>, <span class="ruby-identifier">:controller</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'c'</span>, <span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'a'</span>, <span class="ruby-identifier">:id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'i'</span>)
25:     )
26:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006197" class="method">
  <div id="M006197_title" class="title">
    <b>test_to_str</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006197_source')" id="l_M006197_source">show source</a> ]</p>
  <div id="M006197_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/url_rewriter_test.rb, line 83</span>
83:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_to_str</span>
84:     <span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:controller</span>] = <span class="ruby-value str">'hi'</span>
85:     <span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:action</span>] = <span class="ruby-value str">'bye'</span>
86:     <span class="ruby-ivar">@request</span>.<span class="ruby-identifier">parameters</span>[<span class="ruby-identifier">:id</span>] = <span class="ruby-value str">'2'</span>
87: 
88:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'http://, test.host, /, hi, bye, {&quot;id&quot;=&gt;&quot;2&quot;}'</span>, <span class="ruby-ivar">@rewriter</span>.<span class="ruby-identifier">to_str</span>
89:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006198" class="method">
  <div id="M006198_title" class="title">
    <b>test_trailing_slash</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006198_source')" id="l_M006198_source">show source</a> ]</p>
  <div id="M006198_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/url_rewriter_test.rb, line 91</span>
91:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_trailing_slash</span>
92:     <span class="ruby-identifier">options</span> = {<span class="ruby-identifier">:controller</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'foo'</span>, <span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'bar'</span>, <span class="ruby-identifier">:id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'3'</span>, <span class="ruby-identifier">:only_path</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>}
93:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'/foo/bar/3'</span>, <span class="ruby-ivar">@rewriter</span>.<span class="ruby-identifier">rewrite</span>(<span class="ruby-identifier">options</span>)
94:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'/foo/bar/3?query=string'</span>, <span class="ruby-ivar">@rewriter</span>.<span class="ruby-identifier">rewrite</span>(<span class="ruby-identifier">options</span>.<span class="ruby-identifier">merge</span>({<span class="ruby-identifier">:query</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'string'</span>}))
95:     <span class="ruby-identifier">options</span>.<span class="ruby-identifier">update</span>({<span class="ruby-identifier">:trailing_slash</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>})
96:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'/foo/bar/3/'</span>, <span class="ruby-ivar">@rewriter</span>.<span class="ruby-identifier">rewrite</span>(<span class="ruby-identifier">options</span>)
97:     <span class="ruby-identifier">options</span>.<span class="ruby-identifier">update</span>({<span class="ruby-identifier">:query</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'string'</span>})
98:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'/foo/bar/3/?query=string'</span>, <span class="ruby-ivar">@rewriter</span>.<span class="ruby-identifier">rewrite</span>(<span class="ruby-identifier">options</span>)
99:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006190" class="method">
  <div id="M006190_title" class="title">
    <b>test_user_name_and_password</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006190_source')" id="l_M006190_source">show source</a> ]</p>
  <div id="M006190_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/url_rewriter_test.rb, line 28</span>
28:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_user_name_and_password</span>
29:     <span class="ruby-identifier">assert_equal</span>(
30:       <span class="ruby-value str">'http://david:secret@test.host/c/a/i'</span>,
31:       <span class="ruby-ivar">@rewriter</span>.<span class="ruby-identifier">rewrite</span>(<span class="ruby-identifier">:user</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;david&quot;</span>, <span class="ruby-identifier">:password</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;secret&quot;</span>, <span class="ruby-identifier">:controller</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'c'</span>, <span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'a'</span>, <span class="ruby-identifier">:id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'i'</span>)
32:     )
33:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006191" class="method">
  <div id="M006191_title" class="title">
    <b>test_user_name_and_password_with_escape_codes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006191_source')" id="l_M006191_source">show source</a> ]</p>
  <div id="M006191_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/url_rewriter_test.rb, line 35</span>
35:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_user_name_and_password_with_escape_codes</span>
36:     <span class="ruby-identifier">assert_equal</span>(
37:       <span class="ruby-value str">'http://openid.aol.com%2Fnextangler:one+two%3F@test.host/c/a/i'</span>,
38:       <span class="ruby-ivar">@rewriter</span>.<span class="ruby-identifier">rewrite</span>(<span class="ruby-identifier">:user</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;openid.aol.com/nextangler&quot;</span>, <span class="ruby-identifier">:password</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;one two?&quot;</span>, <span class="ruby-identifier">:controller</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'c'</span>, <span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'a'</span>, <span class="ruby-identifier">:id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'i'</span>)
39:     )
40:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
</div>

  </div>