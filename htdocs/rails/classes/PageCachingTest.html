  <div id="C00000622">
<div class='banner'>
  <span class="file-title-prefix">Class</span><br />PageCachingTest<br/>
  In:
<a href="#" onclick="jsHref('files/actionpack/test/controller/caching_test_rb.html');">actionpack/test/controller/caching_test.rb</a>

Parent:&nbsp;
ActionController::TestCase
</div>
 <!-- banner header -->

  <div id="bodyContent" >
      <div id="content">




  <div class="sectiontitle">Methods</div>
  <ul>
  <li><a href="index.html?a=M004002&name=setup" >setup</a></li>
  <li><a href="index.html?a=M004003&name=teardown" >teardown</a></li>
  <li><a href="index.html?a=M004011&name=test_page_caching_conditional_options" >test_page_caching_conditional_options</a></li>
  <li><a href="index.html?a=M004004&name=test_page_caching_resources_saves_to_correct_path_with_extension_even_if_default_route" >test_page_caching_resources_saves_to_correct_path_with_extension_even_if_default_route</a></li>
  <li><a href="index.html?a=M004005&name=test_should_cache_get_with_ok_status" >test_should_cache_get_with_ok_status</a></li>
  <li><a href="index.html?a=M004010&name=test_should_cache_ok_at_custom_path" >test_should_cache_ok_at_custom_path</a></li>
  <li><a href="index.html?a=M004006&name=test_should_cache_with_custom_path" >test_should_cache_with_custom_path</a></li>
  <li><a href="index.html?a=M004009&name=test_should_cache_with_trailing_slash_on_url" >test_should_cache_with_trailing_slash_on_url</a></li>
  <li><a href="index.html?a=M004008&name=test_should_cache_without_trailing_slash_on_url" >test_should_cache_without_trailing_slash_on_url</a></li>
  <li><a href="index.html?a=M004007&name=test_should_expire_cache_with_custom_path" >test_should_expire_cache_with_custom_path</a></li>
  </ul>






<div class="sectiontitle">Public Instance methods</div>
<div id="M004002" class="method">
  <div id="M004002_title" class="title">
    <b>setup</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M004002_source')" id="l_M004002_source">show source</a> ]</p>
  <div id="M004002_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/caching_test.rb, line 51</span>
51:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">setup</span>
52:     <span class="ruby-constant">ActionController</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">perform_caching</span> = <span class="ruby-keyword kw">true</span>
53: 
54:     <span class="ruby-constant">ActionController</span><span class="ruby-operator">::</span><span class="ruby-constant">Routing</span><span class="ruby-operator">::</span><span class="ruby-constant">Routes</span>.<span class="ruby-identifier">draw</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">map</span><span class="ruby-operator">|</span>
55:       <span class="ruby-identifier">map</span>.<span class="ruby-identifier">main</span> <span class="ruby-value str">''</span>, <span class="ruby-identifier">:controller</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'posts'</span>, <span class="ruby-identifier">:format</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>
56:       <span class="ruby-identifier">map</span>.<span class="ruby-identifier">formatted_posts</span> <span class="ruby-value str">'posts.:format'</span>, <span class="ruby-identifier">:controller</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'posts'</span>
57:       <span class="ruby-identifier">map</span>.<span class="ruby-identifier">resources</span> <span class="ruby-identifier">:posts</span>
58:       <span class="ruby-identifier">map</span>.<span class="ruby-identifier">connect</span> <span class="ruby-value str">':controller/:action/:id'</span>
59:     <span class="ruby-keyword kw">end</span>
60: 
61:     <span class="ruby-ivar">@request</span> = <span class="ruby-constant">ActionController</span><span class="ruby-operator">::</span><span class="ruby-constant">TestRequest</span>.<span class="ruby-identifier">new</span>
62:     <span class="ruby-ivar">@request</span>.<span class="ruby-identifier">host</span> = <span class="ruby-value str">'hostname.com'</span>
63: 
64:     <span class="ruby-ivar">@response</span>   = <span class="ruby-constant">ActionController</span><span class="ruby-operator">::</span><span class="ruby-constant">TestResponse</span>.<span class="ruby-identifier">new</span>
65:     <span class="ruby-ivar">@controller</span> = <span class="ruby-constant">PageCachingTestController</span>.<span class="ruby-identifier">new</span>
66: 
67:     <span class="ruby-ivar">@params</span> = {<span class="ruby-identifier">:controller</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'posts'</span>, <span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'index'</span>, <span class="ruby-identifier">:only_path</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>, <span class="ruby-identifier">:skip_relative_url_root</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>}
68:     <span class="ruby-ivar">@rewriter</span> = <span class="ruby-constant">ActionController</span><span class="ruby-operator">::</span><span class="ruby-constant">UrlRewriter</span>.<span class="ruby-identifier">new</span>(<span class="ruby-ivar">@request</span>, <span class="ruby-ivar">@params</span>)
69: 
70:     <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">rm_rf</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>(<span class="ruby-constant">FILE_STORE_PATH</span>))
71:     <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">mkdir_p</span>(<span class="ruby-constant">FILE_STORE_PATH</span>)
72:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M004003" class="method">
  <div id="M004003_title" class="title">
    <b>teardown</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M004003_source')" id="l_M004003_source">show source</a> ]</p>
  <div id="M004003_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/caching_test.rb, line 74</span>
74:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">teardown</span>
75:     <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">rm_rf</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>(<span class="ruby-constant">FILE_STORE_PATH</span>))
76:     <span class="ruby-constant">ActionController</span><span class="ruby-operator">::</span><span class="ruby-constant">Routing</span><span class="ruby-operator">::</span><span class="ruby-constant">Routes</span>.<span class="ruby-identifier">clear!</span>
77:     <span class="ruby-constant">ActionController</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">perform_caching</span> = <span class="ruby-keyword kw">false</span>
78:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M004011" class="method">
  <div id="M004011_title" class="title">
    <b>test_page_caching_conditional_options</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M004011_source')" id="l_M004011_source">show source</a> ]</p>
  <div id="M004011_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/caching_test.rb, line 135</span>
135:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_page_caching_conditional_options</span>
136:     <span class="ruby-identifier">get</span> <span class="ruby-identifier">:ok</span>, <span class="ruby-identifier">:format=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">'json'</span>
137:     <span class="ruby-identifier">assert_page_not_cached</span> <span class="ruby-identifier">:ok</span>
138:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M004004" class="method">
  <div id="M004004_title" class="title">
    <b>test_page_caching_resources_saves_to_correct_path_with_extension_even_if_default_route</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M004004_source')" id="l_M004004_source">show source</a> ]</p>
  <div id="M004004_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/caching_test.rb, line 80</span>
80:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_page_caching_resources_saves_to_correct_path_with_extension_even_if_default_route</span>
81:     <span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:format</span>] = <span class="ruby-value str">'rss'</span>
82:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'/posts.rss'</span>, <span class="ruby-ivar">@rewriter</span>.<span class="ruby-identifier">rewrite</span>(<span class="ruby-ivar">@params</span>)
83:     <span class="ruby-ivar">@params</span>[<span class="ruby-identifier">:format</span>] = <span class="ruby-keyword kw">nil</span>
84:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'/'</span>, <span class="ruby-ivar">@rewriter</span>.<span class="ruby-identifier">rewrite</span>(<span class="ruby-ivar">@params</span>)
85:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M004005" class="method">
  <div id="M004005_title" class="title">
    <b>test_should_cache_get_with_ok_status</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M004005_source')" id="l_M004005_source">show source</a> ]</p>
  <div id="M004005_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/caching_test.rb, line 87</span>
87:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_cache_get_with_ok_status</span>
88:     <span class="ruby-identifier">get</span> <span class="ruby-identifier">:ok</span>
89:     <span class="ruby-identifier">assert_response</span> <span class="ruby-identifier">:ok</span>
90:     <span class="ruby-identifier">assert_page_cached</span> <span class="ruby-identifier">:ok</span>, <span class="ruby-value str">&quot;get with ok status should have been cached&quot;</span>
91:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M004010" class="method">
  <div id="M004010_title" class="title">
    <b>test_should_cache_ok_at_custom_path</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M004010_source')" id="l_M004010_source">show source</a> ]</p>
  <div id="M004010_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/caching_test.rb, line 116</span>
116:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_cache_ok_at_custom_path</span>
117:     <span class="ruby-ivar">@request</span>.<span class="ruby-identifier">stubs</span>(<span class="ruby-identifier">:path</span>).<span class="ruby-identifier">returns</span>(<span class="ruby-value str">&quot;/index.html&quot;</span>)
118:     <span class="ruby-identifier">get</span> <span class="ruby-identifier">:ok</span>
119:     <span class="ruby-identifier">assert_response</span> <span class="ruby-identifier">:ok</span>
120:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exist?</span>(<span class="ruby-node">&quot;#{FILE_STORE_PATH}/index.html&quot;</span>)
121:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M004006" class="method">
  <div id="M004006_title" class="title">
    <b>test_should_cache_with_custom_path</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M004006_source')" id="l_M004006_source">show source</a> ]</p>
  <div id="M004006_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/caching_test.rb, line 93</span>
93:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_cache_with_custom_path</span>
94:     <span class="ruby-identifier">get</span> <span class="ruby-identifier">:custom_path</span>
95:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exist?</span>(<span class="ruby-node">&quot;#{FILE_STORE_PATH}/index.html&quot;</span>)
96:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M004009" class="method">
  <div id="M004009_title" class="title">
    <b>test_should_cache_with_trailing_slash_on_url</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M004009_source')" id="l_M004009_source">show source</a> ]</p>
  <div id="M004009_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/caching_test.rb, line 111</span>
111:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_cache_with_trailing_slash_on_url</span>
112:     <span class="ruby-ivar">@controller</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">cache_page</span> <span class="ruby-value str">'cached content'</span>, <span class="ruby-value str">'/page_caching_test/trailing_slash/'</span>
113:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exist?</span>(<span class="ruby-node">&quot;#{FILE_STORE_PATH}/page_caching_test/trailing_slash.html&quot;</span>)
114:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M004008" class="method">
  <div id="M004008_title" class="title">
    <b>test_should_cache_without_trailing_slash_on_url</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M004008_source')" id="l_M004008_source">show source</a> ]</p>
  <div id="M004008_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/caching_test.rb, line 106</span>
106:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_cache_without_trailing_slash_on_url</span>
107:     <span class="ruby-ivar">@controller</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">cache_page</span> <span class="ruby-value str">'cached content'</span>, <span class="ruby-value str">'/page_caching_test/trailing_slash'</span>
108:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exist?</span>(<span class="ruby-node">&quot;#{FILE_STORE_PATH}/page_caching_test/trailing_slash.html&quot;</span>)
109:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M004007" class="method">
  <div id="M004007_title" class="title">
    <b>test_should_expire_cache_with_custom_path</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M004007_source')" id="l_M004007_source">show source</a> ]</p>
  <div id="M004007_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/caching_test.rb, line 98</span>
 98:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_expire_cache_with_custom_path</span>
 99:     <span class="ruby-identifier">get</span> <span class="ruby-identifier">:custom_path</span>
100:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exist?</span>(<span class="ruby-node">&quot;#{FILE_STORE_PATH}/index.html&quot;</span>)
101: 
102:     <span class="ruby-identifier">get</span> <span class="ruby-identifier">:expire_custom_path</span>
103:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-constant">File</span>.<span class="ruby-identifier">exist?</span>(<span class="ruby-node">&quot;#{FILE_STORE_PATH}/index.html&quot;</span>)
104:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
</div>

  </div>