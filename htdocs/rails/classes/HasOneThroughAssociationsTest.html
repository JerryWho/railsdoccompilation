  <div id="C00000856">
<div class='banner'>
  <span class="file-title-prefix">Class</span><br />HasOneThroughAssociationsTest<br/>
  In:
<a href="#" onclick="jsHref('files/activerecord/test/cases/associations/has_one_through_associations_test_rb.html');">activerecord/test/cases/associations/has_one_through_associations_test.rb</a>

Parent:&nbsp;
ActiveRecord::TestCase
</div>
 <!-- banner header -->

  <div id="bodyContent" >
      <div id="content">




  <div class="sectiontitle">Methods</div>
  <ul>
  <li><a href="index.html?a=M005643&name=has_one_through_to_has_many" >has_one_through_to_has_many</a></li>
  <li><a href="index.html?a=M005634&name=setup" >setup</a></li>
  <li><a href="index.html?a=M005652&name=test_assigning_association_correctly_assigns_target" >test_assigning_association_correctly_assigns_target</a></li>
  <li><a href="index.html?a=M005655&name=test_assigning_to_has_one_through_preserves_decorated_join_record" >test_assigning_to_has_one_through_preserves_decorated_join_record</a></li>
  <li><a href="index.html?a=M005638&name=test_creating_association_builds_through_record_for_new" >test_creating_association_builds_through_record_for_new</a></li>
  <li><a href="index.html?a=M005637&name=test_creating_association_creates_through_record" >test_creating_association_creates_through_record</a></li>
  <li><a href="index.html?a=M005647&name=test_eager_has_one_through_polymorphic_with_source_type" >test_eager_has_one_through_polymorphic_with_source_type</a></li>
  <li><a href="index.html?a=M005644&name=test_has_one_through_eager_loading" >test_has_one_through_eager_loading</a></li>
  <li><a href="index.html?a=M005645&name=test_has_one_through_eager_loading_through_polymorphic" >test_has_one_through_eager_loading_through_polymorphic</a></li>
  <li><a href="index.html?a=M005649&name=test_has_one_through_nonpreload_eager_loading_through_polymorphic" >test_has_one_through_nonpreload_eager_loading_through_polymorphic</a></li>
  <li><a href="index.html?a=M005650&name=test_has_one_through_nonpreload_eager_loading_through_polymorphic_with_more_than_one_through_record" >test_has_one_through_nonpreload_eager_loading_through_polymorphic_with_more_than_one_through_record</a></li>
  <li><a href="index.html?a=M005648&name=test_has_one_through_nonpreload_eagerloading" >test_has_one_through_nonpreload_eagerloading</a></li>
  <li><a href="index.html?a=M005642&name=test_has_one_through_polymorphic" >test_has_one_through_polymorphic</a></li>
  <li><a href="index.html?a=M005646&name=test_has_one_through_polymorphic_with_source_type" >test_has_one_through_polymorphic_with_source_type</a></li>
  <li><a href="index.html?a=M005653&name=test_has_one_through_proxy_should_not_respond_to_private_methods" >test_has_one_through_proxy_should_not_respond_to_private_methods</a></li>
  <li><a href="index.html?a=M005654&name=test_has_one_through_proxy_should_respond_to_private_methods_via_send" >test_has_one_through_proxy_should_respond_to_private_methods_via_send</a></li>
  <li><a href="index.html?a=M005636&name=test_has_one_through_with_has_many" >test_has_one_through_with_has_many</a></li>
  <li><a href="index.html?a=M005635&name=test_has_one_through_with_has_one" >test_has_one_through_with_has_one</a></li>
  <li><a href="index.html?a=M005657&name=test_preloading_has_one_through_on_belongs_to" >test_preloading_has_one_through_on_belongs_to</a></li>
  <li><a href="index.html?a=M005656&name=test_reassigning_has_one_through" >test_reassigning_has_one_through</a></li>
  <li><a href="index.html?a=M005639&name=test_replace_target_record" >test_replace_target_record</a></li>
  <li><a href="index.html?a=M005640&name=test_replacing_target_record_deletes_old_association" >test_replacing_target_record_deletes_old_association</a></li>
  <li><a href="index.html?a=M005658&name=test_save_of_record_with_loaded_has_one_through" >test_save_of_record_with_loaded_has_one_through</a></li>
  <li><a href="index.html?a=M005641&name=test_set_record_to_nil_should_delete_association" >test_set_record_to_nil_should_delete_association</a></li>
  <li><a href="index.html?a=M005651&name=test_uninitialized_has_one_through_should_return_nil_for_unsaved_record" >test_uninitialized_has_one_through_should_return_nil_for_unsaved_record</a></li>
  </ul>






<div class="sectiontitle">Public Instance methods</div>
<div id="M005643" class="method">
  <div id="M005643_title" class="title">
    <b>has_one_through_to_has_many</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005643_source')" id="l_M005643_source">show source</a> ]</p>
  <div id="M005643_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_through_associations_test.rb, line 68</span>
68:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">has_one_through_to_has_many</span>
69:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-ivar">@member</span>.<span class="ruby-identifier">fellow_members</span>.<span class="ruby-identifier">size</span>
70:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005634" class="method">
  <div id="M005634_title" class="title">
    <b>setup</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005634_source')" id="l_M005634_source">show source</a> ]</p>
  <div id="M005634_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_through_associations_test.rb, line 13</span>
13:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">setup</span>
14:     <span class="ruby-ivar">@member</span> = <span class="ruby-identifier">members</span>(<span class="ruby-identifier">:groucho</span>)
15:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005652" class="method">
  <div id="M005652_title" class="title">
    <b>test_assigning_association_correctly_assigns_target</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005652_source')" id="l_M005652_source">show source</a> ]</p>
  <div id="M005652_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_through_associations_test.rb, line 128</span>
128:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_assigning_association_correctly_assigns_target</span>
129:     <span class="ruby-identifier">new_member</span> = <span class="ruby-constant">Member</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Chris&quot;</span>)
130:     <span class="ruby-identifier">new_member</span>.<span class="ruby-identifier">club</span> = <span class="ruby-identifier">new_club</span> = <span class="ruby-constant">Club</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;LRUG&quot;</span>)
131:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">new_club</span>, <span class="ruby-identifier">new_member</span>.<span class="ruby-identifier">club</span>.<span class="ruby-identifier">target</span>
132:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005655" class="method">
  <div id="M005655_title" class="title">
    <b>test_assigning_to_has_one_through_preserves_decorated_join_record</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005655_source')" id="l_M005655_source">show source</a> ]</p>
  <div id="M005655_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_through_associations_test.rb, line 144</span>
144:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_assigning_to_has_one_through_preserves_decorated_join_record</span>
145:     <span class="ruby-ivar">@organization</span> = <span class="ruby-identifier">organizations</span>(<span class="ruby-identifier">:nsa</span>)
146:     <span class="ruby-identifier">assert_difference</span> <span class="ruby-value str">'MemberDetail.count'</span>, <span class="ruby-value">1</span> <span class="ruby-keyword kw">do</span>
147:       <span class="ruby-ivar">@member_detail</span> = <span class="ruby-constant">MemberDetail</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">:extra_data</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'Extra'</span>)
148:       <span class="ruby-ivar">@member</span>.<span class="ruby-identifier">member_detail</span> = <span class="ruby-ivar">@member_detail</span>
149:       <span class="ruby-ivar">@member</span>.<span class="ruby-identifier">organization</span> = <span class="ruby-ivar">@organization</span>
150:     <span class="ruby-keyword kw">end</span>
151:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-ivar">@organization</span>, <span class="ruby-ivar">@member</span>.<span class="ruby-identifier">organization</span>
152:     <span class="ruby-identifier">assert</span> <span class="ruby-ivar">@organization</span>.<span class="ruby-identifier">members</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-ivar">@member</span>)
153:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'Extra'</span>, <span class="ruby-ivar">@member</span>.<span class="ruby-identifier">member_detail</span>.<span class="ruby-identifier">extra_data</span>
154:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005638" class="method">
  <div id="M005638_title" class="title">
    <b>test_creating_association_builds_through_record_for_new</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005638_source')" id="l_M005638_source">show source</a> ]</p>
  <div id="M005638_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_through_associations_test.rb, line 32</span>
32:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_creating_association_builds_through_record_for_new</span>
33:     <span class="ruby-identifier">new_member</span> = <span class="ruby-constant">Member</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Jane&quot;</span>)
34:     <span class="ruby-identifier">new_member</span>.<span class="ruby-identifier">club</span> = <span class="ruby-identifier">clubs</span>(<span class="ruby-identifier">:moustache_club</span>)
35:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">new_member</span>.<span class="ruby-identifier">current_membership</span>
36:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">clubs</span>(<span class="ruby-identifier">:moustache_club</span>), <span class="ruby-identifier">new_member</span>.<span class="ruby-identifier">current_membership</span>.<span class="ruby-identifier">club</span>
37:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">clubs</span>(<span class="ruby-identifier">:moustache_club</span>), <span class="ruby-identifier">new_member</span>.<span class="ruby-identifier">club</span>
38:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">new_member</span>.<span class="ruby-identifier">save</span>
39:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">clubs</span>(<span class="ruby-identifier">:moustache_club</span>), <span class="ruby-identifier">new_member</span>.<span class="ruby-identifier">club</span>
40:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005637" class="method">
  <div id="M005637_title" class="title">
    <b>test_creating_association_creates_through_record</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005637_source')" id="l_M005637_source">show source</a> ]</p>
  <div id="M005637_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_through_associations_test.rb, line 25</span>
25:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_creating_association_creates_through_record</span>
26:     <span class="ruby-identifier">new_member</span> = <span class="ruby-constant">Member</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Chris&quot;</span>)
27:     <span class="ruby-identifier">new_member</span>.<span class="ruby-identifier">club</span> = <span class="ruby-constant">Club</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;LRUG&quot;</span>)
28:     <span class="ruby-identifier">assert_not_nil</span> <span class="ruby-identifier">new_member</span>.<span class="ruby-identifier">current_membership</span>
29:     <span class="ruby-identifier">assert_not_nil</span> <span class="ruby-identifier">new_member</span>.<span class="ruby-identifier">club</span>
30:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005647" class="method">
  <div id="M005647_title" class="title">
    <b>test_eager_has_one_through_polymorphic_with_source_type</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005647_source')" id="l_M005647_source">show source</a> ]</p>
  <div id="M005647_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_through_associations_test.rb, line 92</span>
92:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_eager_has_one_through_polymorphic_with_source_type</span>
93:     <span class="ruby-identifier">clubs</span> = <span class="ruby-constant">Club</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>, <span class="ruby-identifier">:include</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:sponsored_member</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;name = ?&quot;</span>,<span class="ruby-value str">&quot;Moustache and Eyebrow Fancier Club&quot;</span>])
94:     <span class="ruby-comment cmt"># Only the eyebrow fanciers club has a sponsored_member</span>
95:     <span class="ruby-identifier">assert_not_nil</span> <span class="ruby-identifier">assert_no_queries</span> {<span class="ruby-identifier">clubs</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">sponsored_member</span>}
96:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005644" class="method">
  <div id="M005644_title" class="title">
    <b>test_has_one_through_eager_loading</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005644_source')" id="l_M005644_source">show source</a> ]</p>
  <div id="M005644_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_through_associations_test.rb, line 72</span>
72:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_has_one_through_eager_loading</span>
73:     <span class="ruby-identifier">members</span> = <span class="ruby-identifier">assert_queries</span>(<span class="ruby-value">3</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-comment cmt">#base table, through table, clubs table</span>
74:       <span class="ruby-constant">Member</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>, <span class="ruby-identifier">:include</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:club</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;name = ?&quot;</span>, <span class="ruby-value str">&quot;Groucho Marx&quot;</span>])
75:     <span class="ruby-keyword kw">end</span>
76:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">members</span>.<span class="ruby-identifier">size</span>
77:     <span class="ruby-identifier">assert_not_nil</span> <span class="ruby-identifier">assert_no_queries</span> {<span class="ruby-identifier">members</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">club</span>}
78:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005645" class="method">
  <div id="M005645_title" class="title">
    <b>test_has_one_through_eager_loading_through_polymorphic</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005645_source')" id="l_M005645_source">show source</a> ]</p>
  <div id="M005645_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_through_associations_test.rb, line 80</span>
80:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_has_one_through_eager_loading_through_polymorphic</span>
81:     <span class="ruby-identifier">members</span> = <span class="ruby-identifier">assert_queries</span>(<span class="ruby-value">3</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-comment cmt">#base table, through table, clubs table</span>
82:       <span class="ruby-constant">Member</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>, <span class="ruby-identifier">:include</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:sponsor_club</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;name = ?&quot;</span>, <span class="ruby-value str">&quot;Groucho Marx&quot;</span>])
83:     <span class="ruby-keyword kw">end</span>
84:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">members</span>.<span class="ruby-identifier">size</span>
85:     <span class="ruby-identifier">assert_not_nil</span> <span class="ruby-identifier">assert_no_queries</span> {<span class="ruby-identifier">members</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">sponsor_club</span>}    
86:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005649" class="method">
  <div id="M005649_title" class="title">
    <b>test_has_one_through_nonpreload_eager_loading_through_polymorphic</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005649_source')" id="l_M005649_source">show source</a> ]</p>
  <div id="M005649_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_through_associations_test.rb, line 106</span>
106:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_has_one_through_nonpreload_eager_loading_through_polymorphic</span>
107:     <span class="ruby-identifier">members</span> = <span class="ruby-identifier">assert_queries</span>(<span class="ruby-value">1</span>) <span class="ruby-keyword kw">do</span>
108:       <span class="ruby-constant">Member</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>, <span class="ruby-identifier">:include</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:sponsor_club</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;members.name = ?&quot;</span>, <span class="ruby-value str">&quot;Groucho Marx&quot;</span>], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'clubs.name'</span>) <span class="ruby-comment cmt">#force fallback</span>
109:     <span class="ruby-keyword kw">end</span>
110:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">members</span>.<span class="ruby-identifier">size</span>
111:     <span class="ruby-identifier">assert_not_nil</span> <span class="ruby-identifier">assert_no_queries</span> {<span class="ruby-identifier">members</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">sponsor_club</span>}
112:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005650" class="method">
  <div id="M005650_title" class="title">
    <b>test_has_one_through_nonpreload_eager_loading_through_polymorphic_with_more_than_one_through_record</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005650_source')" id="l_M005650_source">show source</a> ]</p>
  <div id="M005650_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_through_associations_test.rb, line 114</span>
114:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_has_one_through_nonpreload_eager_loading_through_polymorphic_with_more_than_one_through_record</span>
115:     <span class="ruby-constant">Sponsor</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">:sponsor_club</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">clubs</span>(<span class="ruby-identifier">:crazy_club</span>), <span class="ruby-identifier">:sponsorable</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">members</span>(<span class="ruby-identifier">:groucho</span>)).<span class="ruby-identifier">save!</span>
116:     <span class="ruby-identifier">members</span> = <span class="ruby-identifier">assert_queries</span>(<span class="ruby-value">1</span>) <span class="ruby-keyword kw">do</span>
117:       <span class="ruby-constant">Member</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>, <span class="ruby-identifier">:include</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:sponsor_club</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;members.name = ?&quot;</span>, <span class="ruby-value str">&quot;Groucho Marx&quot;</span>], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'clubs.name DESC'</span>) <span class="ruby-comment cmt">#force fallback</span>
118:     <span class="ruby-keyword kw">end</span>
119:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">members</span>.<span class="ruby-identifier">size</span>
120:     <span class="ruby-identifier">assert_not_nil</span> <span class="ruby-identifier">assert_no_queries</span> { <span class="ruby-identifier">members</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">sponsor_club</span> }
121:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">clubs</span>(<span class="ruby-identifier">:crazy_club</span>), <span class="ruby-identifier">members</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">sponsor_club</span>
122:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005648" class="method">
  <div id="M005648_title" class="title">
    <b>test_has_one_through_nonpreload_eagerloading</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005648_source')" id="l_M005648_source">show source</a> ]</p>
  <div id="M005648_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_through_associations_test.rb, line 98</span>
 98:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_has_one_through_nonpreload_eagerloading</span>
 99:     <span class="ruby-identifier">members</span> = <span class="ruby-identifier">assert_queries</span>(<span class="ruby-value">1</span>) <span class="ruby-keyword kw">do</span>
100:       <span class="ruby-constant">Member</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>, <span class="ruby-identifier">:include</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:club</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;members.name = ?&quot;</span>, <span class="ruby-value str">&quot;Groucho Marx&quot;</span>], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'clubs.name'</span>) <span class="ruby-comment cmt">#force fallback</span>
101:     <span class="ruby-keyword kw">end</span>
102:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">members</span>.<span class="ruby-identifier">size</span>
103:     <span class="ruby-identifier">assert_not_nil</span> <span class="ruby-identifier">assert_no_queries</span> {<span class="ruby-identifier">members</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">club</span>}
104:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005642" class="method">
  <div id="M005642_title" class="title">
    <b>test_has_one_through_polymorphic</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005642_source')" id="l_M005642_source">show source</a> ]</p>
  <div id="M005642_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_through_associations_test.rb, line 64</span>
64:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_has_one_through_polymorphic</span>
65:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">clubs</span>(<span class="ruby-identifier">:moustache_club</span>), <span class="ruby-ivar">@member</span>.<span class="ruby-identifier">sponsor_club</span>
66:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005646" class="method">
  <div id="M005646_title" class="title">
    <b>test_has_one_through_polymorphic_with_source_type</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005646_source')" id="l_M005646_source">show source</a> ]</p>
  <div id="M005646_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_through_associations_test.rb, line 88</span>
88:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_has_one_through_polymorphic_with_source_type</span>
89:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">members</span>(<span class="ruby-identifier">:groucho</span>), <span class="ruby-identifier">clubs</span>(<span class="ruby-identifier">:moustache_club</span>).<span class="ruby-identifier">sponsored_member</span>
90:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005653" class="method">
  <div id="M005653_title" class="title">
    <b>test_has_one_through_proxy_should_not_respond_to_private_methods</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005653_source')" id="l_M005653_source">show source</a> ]</p>
  <div id="M005653_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_through_associations_test.rb, line 134</span>
134:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_has_one_through_proxy_should_not_respond_to_private_methods</span>
135:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">NoMethodError</span>) { <span class="ruby-identifier">clubs</span>(<span class="ruby-identifier">:moustache_club</span>).<span class="ruby-identifier">private_method</span> }
136:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">NoMethodError</span>) { <span class="ruby-ivar">@member</span>.<span class="ruby-identifier">club</span>.<span class="ruby-identifier">private_method</span> }
137:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005654" class="method">
  <div id="M005654_title" class="title">
    <b>test_has_one_through_proxy_should_respond_to_private_methods_via_send</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005654_source')" id="l_M005654_source">show source</a> ]</p>
  <div id="M005654_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_through_associations_test.rb, line 139</span>
139:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_has_one_through_proxy_should_respond_to_private_methods_via_send</span>
140:     <span class="ruby-identifier">clubs</span>(<span class="ruby-identifier">:moustache_club</span>).<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:private_method</span>)
141:     <span class="ruby-ivar">@member</span>.<span class="ruby-identifier">club</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:private_method</span>)
142:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005636" class="method">
  <div id="M005636_title" class="title">
    <b>test_has_one_through_with_has_many</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005636_source')" id="l_M005636_source">show source</a> ]</p>
  <div id="M005636_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_through_associations_test.rb, line 21</span>
21:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_has_one_through_with_has_many</span>
22:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">clubs</span>(<span class="ruby-identifier">:moustache_club</span>), <span class="ruby-ivar">@member</span>.<span class="ruby-identifier">favourite_club</span>
23:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005635" class="method">
  <div id="M005635_title" class="title">
    <b>test_has_one_through_with_has_one</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005635_source')" id="l_M005635_source">show source</a> ]</p>
  <div id="M005635_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_through_associations_test.rb, line 17</span>
17:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_has_one_through_with_has_one</span>
18:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">clubs</span>(<span class="ruby-identifier">:boring_club</span>), <span class="ruby-ivar">@member</span>.<span class="ruby-identifier">club</span>
19:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005657" class="method">
  <div id="M005657_title" class="title">
    <b>test_preloading_has_one_through_on_belongs_to</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005657_source')" id="l_M005657_source">show source</a> ]</p>
  <div id="M005657_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_through_associations_test.rb, line 179</span>
179:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_preloading_has_one_through_on_belongs_to</span>
180:     <span class="ruby-identifier">assert_not_nil</span> <span class="ruby-ivar">@member</span>.<span class="ruby-identifier">member_type</span>
181:     <span class="ruby-ivar">@organization</span> = <span class="ruby-identifier">organizations</span>(<span class="ruby-identifier">:nsa</span>)
182:     <span class="ruby-ivar">@member_detail</span> = <span class="ruby-constant">MemberDetail</span>.<span class="ruby-identifier">new</span>
183:     <span class="ruby-ivar">@member</span>.<span class="ruby-identifier">member_detail</span> = <span class="ruby-ivar">@member_detail</span>
184:     <span class="ruby-ivar">@member</span>.<span class="ruby-identifier">organization</span> = <span class="ruby-ivar">@organization</span>
185:     <span class="ruby-ivar">@member_details</span> = <span class="ruby-identifier">assert_queries</span>(<span class="ruby-value">3</span>) <span class="ruby-keyword kw">do</span>
186:       <span class="ruby-constant">MemberDetail</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>, <span class="ruby-identifier">:include</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:member_type</span>)
187:     <span class="ruby-keyword kw">end</span>
188:     <span class="ruby-ivar">@new_detail</span> = <span class="ruby-ivar">@member_details</span>[<span class="ruby-value">0</span>]
189:     <span class="ruby-identifier">assert</span> <span class="ruby-ivar">@new_detail</span>.<span class="ruby-identifier">loaded_member_type?</span>
190:     <span class="ruby-identifier">assert_not_nil</span> <span class="ruby-identifier">assert_no_queries</span> { <span class="ruby-ivar">@new_detail</span>.<span class="ruby-identifier">member_type</span> }
191:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005656" class="method">
  <div id="M005656_title" class="title">
    <b>test_reassigning_has_one_through</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005656_source')" id="l_M005656_source">show source</a> ]</p>
  <div id="M005656_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_through_associations_test.rb, line 156</span>
156:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_reassigning_has_one_through</span>
157:     <span class="ruby-ivar">@organization</span> = <span class="ruby-identifier">organizations</span>(<span class="ruby-identifier">:nsa</span>)
158:     <span class="ruby-ivar">@new_organization</span> = <span class="ruby-identifier">organizations</span>(<span class="ruby-identifier">:discordians</span>)
159: 
160:     <span class="ruby-identifier">assert_difference</span> <span class="ruby-value str">'MemberDetail.count'</span>, <span class="ruby-value">1</span> <span class="ruby-keyword kw">do</span>
161:       <span class="ruby-ivar">@member_detail</span> = <span class="ruby-constant">MemberDetail</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">:extra_data</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'Extra'</span>)
162:       <span class="ruby-ivar">@member</span>.<span class="ruby-identifier">member_detail</span> = <span class="ruby-ivar">@member_detail</span>
163:       <span class="ruby-ivar">@member</span>.<span class="ruby-identifier">organization</span> = <span class="ruby-ivar">@organization</span>
164:     <span class="ruby-keyword kw">end</span>
165:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-ivar">@organization</span>, <span class="ruby-ivar">@member</span>.<span class="ruby-identifier">organization</span>
166:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'Extra'</span>, <span class="ruby-ivar">@member</span>.<span class="ruby-identifier">member_detail</span>.<span class="ruby-identifier">extra_data</span>
167:     <span class="ruby-identifier">assert</span> <span class="ruby-ivar">@organization</span>.<span class="ruby-identifier">members</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-ivar">@member</span>)
168:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@new_organization</span>.<span class="ruby-identifier">members</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-ivar">@member</span>)
169: 
170:     <span class="ruby-identifier">assert_no_difference</span> <span class="ruby-value str">'MemberDetail.count'</span> <span class="ruby-keyword kw">do</span>
171:       <span class="ruby-ivar">@member</span>.<span class="ruby-identifier">organization</span> = <span class="ruby-ivar">@new_organization</span>
172:     <span class="ruby-keyword kw">end</span>
173:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-ivar">@new_organization</span>, <span class="ruby-ivar">@member</span>.<span class="ruby-identifier">organization</span>
174:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'Extra'</span>, <span class="ruby-ivar">@member</span>.<span class="ruby-identifier">member_detail</span>.<span class="ruby-identifier">extra_data</span>
175:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@organization</span>.<span class="ruby-identifier">members</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-ivar">@member</span>)
176:     <span class="ruby-identifier">assert</span> <span class="ruby-ivar">@new_organization</span>.<span class="ruby-identifier">members</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-ivar">@member</span>)
177:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005639" class="method">
  <div id="M005639_title" class="title">
    <b>test_replace_target_record</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005639_source')" id="l_M005639_source">show source</a> ]</p>
  <div id="M005639_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_through_associations_test.rb, line 42</span>
42:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_replace_target_record</span>
43:     <span class="ruby-identifier">new_club</span> = <span class="ruby-constant">Club</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Marx Bros&quot;</span>)
44:     <span class="ruby-ivar">@member</span>.<span class="ruby-identifier">club</span> = <span class="ruby-identifier">new_club</span>
45:     <span class="ruby-ivar">@member</span>.<span class="ruby-identifier">reload</span>
46:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">new_club</span>, <span class="ruby-ivar">@member</span>.<span class="ruby-identifier">club</span>
47:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005640" class="method">
  <div id="M005640_title" class="title">
    <b>test_replacing_target_record_deletes_old_association</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005640_source')" id="l_M005640_source">show source</a> ]</p>
  <div id="M005640_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_through_associations_test.rb, line 49</span>
49:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_replacing_target_record_deletes_old_association</span>
50:     <span class="ruby-identifier">assert_no_difference</span> <span class="ruby-value str">&quot;Membership.count&quot;</span> <span class="ruby-keyword kw">do</span>
51:       <span class="ruby-identifier">new_club</span> = <span class="ruby-constant">Club</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Bananarama&quot;</span>)
52:       <span class="ruby-ivar">@member</span>.<span class="ruby-identifier">club</span> = <span class="ruby-identifier">new_club</span>
53:       <span class="ruby-ivar">@member</span>.<span class="ruby-identifier">reload</span>      
54:     <span class="ruby-keyword kw">end</span>
55:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005658" class="method">
  <div id="M005658_title" class="title">
    <b>test_save_of_record_with_loaded_has_one_through</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005658_source')" id="l_M005658_source">show source</a> ]</p>
  <div id="M005658_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_through_associations_test.rb, line 193</span>
193:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_save_of_record_with_loaded_has_one_through</span>
194:     <span class="ruby-ivar">@club</span> = <span class="ruby-ivar">@member</span>.<span class="ruby-identifier">club</span>
195:     <span class="ruby-identifier">assert_not_nil</span> <span class="ruby-ivar">@club</span>.<span class="ruby-identifier">sponsored_member</span>
196: 
197:     <span class="ruby-identifier">assert_nothing_raised</span> <span class="ruby-keyword kw">do</span>
198:       <span class="ruby-constant">Club</span>.<span class="ruby-identifier">find</span>(<span class="ruby-ivar">@club</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">save!</span>
199:       <span class="ruby-constant">Club</span>.<span class="ruby-identifier">find</span>(<span class="ruby-ivar">@club</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">:include</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:sponsored_member</span>).<span class="ruby-identifier">save!</span>
200:     <span class="ruby-keyword kw">end</span>
201: 
202:     <span class="ruby-ivar">@club</span>.<span class="ruby-identifier">sponsor</span>.<span class="ruby-identifier">destroy</span>
203: 
204:     <span class="ruby-identifier">assert_nothing_raised</span> <span class="ruby-keyword kw">do</span>
205:       <span class="ruby-constant">Club</span>.<span class="ruby-identifier">find</span>(<span class="ruby-ivar">@club</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">save!</span>
206:       <span class="ruby-constant">Club</span>.<span class="ruby-identifier">find</span>(<span class="ruby-ivar">@club</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">:include</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:sponsored_member</span>).<span class="ruby-identifier">save!</span>
207:     <span class="ruby-keyword kw">end</span>
208:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005641" class="method">
  <div id="M005641_title" class="title">
    <b>test_set_record_to_nil_should_delete_association</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005641_source')" id="l_M005641_source">show source</a> ]</p>
  <div id="M005641_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_through_associations_test.rb, line 57</span>
57:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_set_record_to_nil_should_delete_association</span>
58:     <span class="ruby-ivar">@member</span>.<span class="ruby-identifier">club</span> = <span class="ruby-keyword kw">nil</span>
59:     <span class="ruby-ivar">@member</span>.<span class="ruby-identifier">reload</span>
60:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-keyword kw">nil</span>, <span class="ruby-ivar">@member</span>.<span class="ruby-identifier">current_membership</span>
61:     <span class="ruby-identifier">assert_nil</span> <span class="ruby-ivar">@member</span>.<span class="ruby-identifier">club</span>
62:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005651" class="method">
  <div id="M005651_title" class="title">
    <b>test_uninitialized_has_one_through_should_return_nil_for_unsaved_record</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005651_source')" id="l_M005651_source">show source</a> ]</p>
  <div id="M005651_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_one_through_associations_test.rb, line 124</span>
124:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_uninitialized_has_one_through_should_return_nil_for_unsaved_record</span>
125:     <span class="ruby-identifier">assert_nil</span> <span class="ruby-constant">Member</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">club</span>
126:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
</div>

  </div>