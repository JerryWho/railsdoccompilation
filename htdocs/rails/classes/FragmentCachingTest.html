  <div id="C00000889">
<div class='banner'>
  <span class="file-title-prefix">Class</span><br />FragmentCachingTest<br/>
  In:
<a href="#" onclick="jsHref('files/actionpack/test/controller/caching_test_rb.html');">actionpack/test/controller/caching_test.rb</a>

Parent:&nbsp;
ActionController::TestCase
</div>
 <!-- banner header -->

  <div id="bodyContent" >
      <div id="content">




  <div class="sectiontitle">Methods</div>
  <ul>
  <li><a href="index.html?a=M006661&name=setup" >setup</a></li>
  <li><a href="index.html?a=M006670&name=test_expire_fragment_with_regexp" >test_expire_fragment_with_regexp</a></li>
  <li><a href="index.html?a=M006669&name=test_expire_fragment_with_simple_key" >test_expire_fragment_with_simple_key</a></li>
  <li><a href="index.html?a=M006662&name=test_fragment_cache_key" >test_fragment_cache_key</a></li>
  <li><a href="index.html?a=M006666&name=test_fragment_exist_with_caching_disabled" >test_fragment_exist_with_caching_disabled</a></li>
  <li><a href="index.html?a=M006665&name=test_fragment_exist_with_caching_enabled" >test_fragment_exist_with_caching_enabled</a></li>
  <li><a href="index.html?a=M006672&name=test_fragment_for" >test_fragment_for</a></li>
  <li><a href="index.html?a=M006671&name=test_fragment_for_with_disabled_caching" >test_fragment_for_with_disabled_caching</a></li>
  <li><a href="index.html?a=M006673&name=test_html_safety" >test_html_safety</a></li>
  <li><a href="index.html?a=M006664&name=test_read_fragment_with_caching_disabled" >test_read_fragment_with_caching_disabled</a></li>
  <li><a href="index.html?a=M006663&name=test_read_fragment_with_caching_enabled" >test_read_fragment_with_caching_enabled</a></li>
  <li><a href="index.html?a=M006668&name=test_write_fragment_with_caching_disabled" >test_write_fragment_with_caching_disabled</a></li>
  <li><a href="index.html?a=M006667&name=test_write_fragment_with_caching_enabled" >test_write_fragment_with_caching_enabled</a></li>
  </ul>






<div class="sectiontitle">Public Instance methods</div>
<div id="M006661" class="method">
  <div id="M006661_title" class="title">
    <b>setup</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006661_source')" id="l_M006661_source">show source</a> ]</p>
  <div id="M006661_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/caching_test.rb, line 525</span>
525:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">setup</span>
526:     <span class="ruby-constant">ActionController</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">perform_caching</span> = <span class="ruby-keyword kw">true</span>
527:     <span class="ruby-ivar">@store</span> = <span class="ruby-constant">ActiveSupport</span><span class="ruby-operator">::</span><span class="ruby-constant">Cache</span><span class="ruby-operator">::</span><span class="ruby-constant">MemoryStore</span>.<span class="ruby-identifier">new</span>
528:     <span class="ruby-constant">ActionController</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">cache_store</span> = <span class="ruby-ivar">@store</span>
529:     <span class="ruby-ivar">@controller</span> = <span class="ruby-constant">FragmentCachingTestController</span>.<span class="ruby-identifier">new</span>
530:     <span class="ruby-ivar">@params</span> = {<span class="ruby-identifier">:controller</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'posts'</span>, <span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'index'</span>}
531:     <span class="ruby-ivar">@request</span> = <span class="ruby-constant">ActionController</span><span class="ruby-operator">::</span><span class="ruby-constant">TestRequest</span>.<span class="ruby-identifier">new</span>
532:     <span class="ruby-ivar">@response</span> = <span class="ruby-constant">ActionController</span><span class="ruby-operator">::</span><span class="ruby-constant">TestResponse</span>.<span class="ruby-identifier">new</span>
533:     <span class="ruby-ivar">@controller</span>.<span class="ruby-identifier">params</span> = <span class="ruby-ivar">@params</span>
534:     <span class="ruby-ivar">@controller</span>.<span class="ruby-identifier">request</span> = <span class="ruby-ivar">@request</span>
535:     <span class="ruby-ivar">@controller</span>.<span class="ruby-identifier">response</span> = <span class="ruby-ivar">@response</span>
536:     <span class="ruby-ivar">@controller</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:initialize_current_url</span>)
537:     <span class="ruby-ivar">@controller</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:initialize_template_class</span>, <span class="ruby-ivar">@response</span>)
538:     <span class="ruby-ivar">@controller</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:assign_shortcuts</span>, <span class="ruby-ivar">@request</span>, <span class="ruby-ivar">@response</span>)
539:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006670" class="method">
  <div id="M006670_title" class="title">
    <b>test_expire_fragment_with_regexp</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006670_source')" id="l_M006670_source">show source</a> ]</p>
  <div id="M006670_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/caching_test.rb, line 590</span>
590:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_expire_fragment_with_regexp</span>
591:     <span class="ruby-ivar">@store</span>.<span class="ruby-identifier">write</span>(<span class="ruby-value str">'views/name'</span>, <span class="ruby-value str">'value'</span>)
592:     <span class="ruby-ivar">@store</span>.<span class="ruby-identifier">write</span>(<span class="ruby-value str">'views/another_name'</span>, <span class="ruby-value str">'another_value'</span>)
593:     <span class="ruby-ivar">@store</span>.<span class="ruby-identifier">write</span>(<span class="ruby-value str">'views/primalgrasp'</span>, <span class="ruby-value str">'will not expire ;-)'</span>)
594: 
595:     <span class="ruby-ivar">@controller</span>.<span class="ruby-identifier">expire_fragment</span> <span class="ruby-regexp re">/name/</span>
596: 
597:     <span class="ruby-identifier">assert_nil</span> <span class="ruby-ivar">@store</span>.<span class="ruby-identifier">read</span>(<span class="ruby-value str">'views/name'</span>)
598:     <span class="ruby-identifier">assert_nil</span> <span class="ruby-ivar">@store</span>.<span class="ruby-identifier">read</span>(<span class="ruby-value str">'views/another_name'</span>)
599:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'will not expire ;-)'</span>, <span class="ruby-ivar">@store</span>.<span class="ruby-identifier">read</span>(<span class="ruby-value str">'views/primalgrasp'</span>)
600:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006669" class="method">
  <div id="M006669_title" class="title">
    <b>test_expire_fragment_with_simple_key</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006669_source')" id="l_M006669_source">show source</a> ]</p>
  <div id="M006669_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/caching_test.rb, line 584</span>
584:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_expire_fragment_with_simple_key</span>
585:     <span class="ruby-ivar">@store</span>.<span class="ruby-identifier">write</span>(<span class="ruby-value str">'views/name'</span>, <span class="ruby-value str">'value'</span>)
586:     <span class="ruby-ivar">@controller</span>.<span class="ruby-identifier">expire_fragment</span> <span class="ruby-value str">'name'</span>
587:     <span class="ruby-identifier">assert_nil</span> <span class="ruby-ivar">@store</span>.<span class="ruby-identifier">read</span>(<span class="ruby-value str">'views/name'</span>)
588:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006662" class="method">
  <div id="M006662_title" class="title">
    <b>test_fragment_cache_key</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006662_source')" id="l_M006662_source">show source</a> ]</p>
  <div id="M006662_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/caching_test.rb, line 541</span>
541:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_fragment_cache_key</span>
542:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'views/what a key'</span>, <span class="ruby-ivar">@controller</span>.<span class="ruby-identifier">fragment_cache_key</span>(<span class="ruby-value str">'what a key'</span>)
543:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;views/test.host/fragment_caching_test/some_action&quot;</span>,
544:                   <span class="ruby-ivar">@controller</span>.<span class="ruby-identifier">fragment_cache_key</span>(<span class="ruby-identifier">:controller</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'fragment_caching_test'</span>,<span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'some_action'</span>)
545:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006666" class="method">
  <div id="M006666_title" class="title">
    <b>test_fragment_exist_with_caching_disabled</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006666_source')" id="l_M006666_source">show source</a> ]</p>
  <div id="M006666_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/caching_test.rb, line 564</span>
564:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_fragment_exist_with_caching_disabled</span>
565:     <span class="ruby-constant">ActionController</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">perform_caching</span> = <span class="ruby-keyword kw">false</span>
566:     <span class="ruby-ivar">@store</span>.<span class="ruby-identifier">write</span>(<span class="ruby-value str">'views/name'</span>, <span class="ruby-value str">'value'</span>)
567:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@controller</span>.<span class="ruby-identifier">fragment_exist?</span>(<span class="ruby-value str">'name'</span>)
568:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@controller</span>.<span class="ruby-identifier">fragment_exist?</span>(<span class="ruby-value str">'other_name'</span>)
569:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006665" class="method">
  <div id="M006665_title" class="title">
    <b>test_fragment_exist_with_caching_enabled</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006665_source')" id="l_M006665_source">show source</a> ]</p>
  <div id="M006665_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/caching_test.rb, line 558</span>
558:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_fragment_exist_with_caching_enabled</span>
559:     <span class="ruby-ivar">@store</span>.<span class="ruby-identifier">write</span>(<span class="ruby-value str">'views/name'</span>, <span class="ruby-value str">'value'</span>)
560:     <span class="ruby-identifier">assert</span> <span class="ruby-ivar">@controller</span>.<span class="ruby-identifier">fragment_exist?</span>(<span class="ruby-value str">'name'</span>)
561:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@controller</span>.<span class="ruby-identifier">fragment_exist?</span>(<span class="ruby-value str">'other_name'</span>)
562:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006672" class="method">
  <div id="M006672_title" class="title">
    <b>test_fragment_for</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006672_source')" id="l_M006672_source">show source</a> ]</p>
  <div id="M006672_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/caching_test.rb, line 615</span>
615:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_fragment_for</span>
616:     <span class="ruby-ivar">@store</span>.<span class="ruby-identifier">write</span>(<span class="ruby-value str">'views/expensive'</span>, <span class="ruby-value str">'fragment content'</span>)
617:     <span class="ruby-identifier">fragment_computed</span> = <span class="ruby-keyword kw">false</span>
618: 
619:     <span class="ruby-identifier">buffer</span> = <span class="ruby-value str">'generated till now -&gt; '</span>.<span class="ruby-identifier">html_safe</span>
620:     <span class="ruby-ivar">@controller</span>.<span class="ruby-identifier">fragment_for</span>(<span class="ruby-identifier">buffer</span>, <span class="ruby-value str">'expensive'</span>) { <span class="ruby-identifier">fragment_computed</span> = <span class="ruby-keyword kw">true</span> }
621: 
622:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">fragment_computed</span>
623:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'generated till now -&gt; fragment content'</span>, <span class="ruby-identifier">buffer</span>
624:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006671" class="method">
  <div id="M006671_title" class="title">
    <b>test_fragment_for_with_disabled_caching</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006671_source')" id="l_M006671_source">show source</a> ]</p>
  <div id="M006671_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/caching_test.rb, line 602</span>
602:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_fragment_for_with_disabled_caching</span>
603:     <span class="ruby-constant">ActionController</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">perform_caching</span> = <span class="ruby-keyword kw">false</span>
604: 
605:     <span class="ruby-ivar">@store</span>.<span class="ruby-identifier">write</span>(<span class="ruby-value str">'views/expensive'</span>, <span class="ruby-value str">'fragment content'</span>)
606:     <span class="ruby-identifier">fragment_computed</span> = <span class="ruby-keyword kw">false</span>
607: 
608:     <span class="ruby-identifier">buffer</span> = <span class="ruby-value str">'generated till now -&gt; '</span>.<span class="ruby-identifier">html_safe</span>
609:     <span class="ruby-ivar">@controller</span>.<span class="ruby-identifier">fragment_for</span>(<span class="ruby-identifier">buffer</span>, <span class="ruby-value str">'expensive'</span>) { <span class="ruby-identifier">fragment_computed</span> = <span class="ruby-keyword kw">true</span> }
610: 
611:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">fragment_computed</span>
612:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'generated till now -&gt; '</span>, <span class="ruby-identifier">buffer</span>
613:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006673" class="method">
  <div id="M006673_title" class="title">
    <b>test_html_safety</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006673_source')" id="l_M006673_source">show source</a> ]</p>
  <div id="M006673_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/caching_test.rb, line 626</span>
626:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_html_safety</span>
627:     <span class="ruby-identifier">assert_nil</span> <span class="ruby-ivar">@store</span>.<span class="ruby-identifier">read</span>(<span class="ruby-value str">'views/name'</span>)
628:     <span class="ruby-identifier">content</span> = <span class="ruby-value str">'value'</span>.<span class="ruby-identifier">html_safe</span>
629:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">content</span>, <span class="ruby-ivar">@controller</span>.<span class="ruby-identifier">write_fragment</span>(<span class="ruby-value str">'name'</span>, <span class="ruby-identifier">content</span>)
630: 
631:     <span class="ruby-identifier">cached</span> = <span class="ruby-ivar">@store</span>.<span class="ruby-identifier">read</span>(<span class="ruby-value str">'views/name'</span>)
632:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">content</span>, <span class="ruby-identifier">cached</span>
633:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-constant">String</span>, <span class="ruby-identifier">cached</span>.<span class="ruby-identifier">class</span>
634: 
635:     <span class="ruby-identifier">html_safe</span> = <span class="ruby-ivar">@controller</span>.<span class="ruby-identifier">read_fragment</span>(<span class="ruby-value str">'name'</span>)
636:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">content</span>, <span class="ruby-identifier">html_safe</span>
637:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">html_safe</span>.<span class="ruby-identifier">html_safe?</span>
638:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006664" class="method">
  <div id="M006664_title" class="title">
    <b>test_read_fragment_with_caching_disabled</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006664_source')" id="l_M006664_source">show source</a> ]</p>
  <div id="M006664_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/caching_test.rb, line 552</span>
552:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_read_fragment_with_caching_disabled</span>
553:     <span class="ruby-constant">ActionController</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">perform_caching</span> = <span class="ruby-keyword kw">false</span>
554:     <span class="ruby-ivar">@store</span>.<span class="ruby-identifier">write</span>(<span class="ruby-value str">'views/name'</span>, <span class="ruby-value str">'value'</span>)
555:     <span class="ruby-identifier">assert_nil</span> <span class="ruby-ivar">@controller</span>.<span class="ruby-identifier">read_fragment</span>(<span class="ruby-value str">'name'</span>)
556:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006663" class="method">
  <div id="M006663_title" class="title">
    <b>test_read_fragment_with_caching_enabled</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006663_source')" id="l_M006663_source">show source</a> ]</p>
  <div id="M006663_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/caching_test.rb, line 547</span>
547:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_read_fragment_with_caching_enabled</span>
548:     <span class="ruby-ivar">@store</span>.<span class="ruby-identifier">write</span>(<span class="ruby-value str">'views/name'</span>, <span class="ruby-value str">'value'</span>)
549:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'value'</span>, <span class="ruby-ivar">@controller</span>.<span class="ruby-identifier">read_fragment</span>(<span class="ruby-value str">'name'</span>)
550:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006668" class="method">
  <div id="M006668_title" class="title">
    <b>test_write_fragment_with_caching_disabled</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006668_source')" id="l_M006668_source">show source</a> ]</p>
  <div id="M006668_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/caching_test.rb, line 577</span>
577:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_write_fragment_with_caching_disabled</span>
578:     <span class="ruby-identifier">assert_nil</span> <span class="ruby-ivar">@store</span>.<span class="ruby-identifier">read</span>(<span class="ruby-value str">'views/name'</span>)
579:     <span class="ruby-constant">ActionController</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">perform_caching</span> = <span class="ruby-keyword kw">false</span>
580:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'value'</span>, <span class="ruby-ivar">@controller</span>.<span class="ruby-identifier">write_fragment</span>(<span class="ruby-value str">'name'</span>, <span class="ruby-value str">'value'</span>)
581:     <span class="ruby-identifier">assert_nil</span> <span class="ruby-ivar">@store</span>.<span class="ruby-identifier">read</span>(<span class="ruby-value str">'views/name'</span>)
582:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006667" class="method">
  <div id="M006667_title" class="title">
    <b>test_write_fragment_with_caching_enabled</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006667_source')" id="l_M006667_source">show source</a> ]</p>
  <div id="M006667_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/caching_test.rb, line 571</span>
571:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_write_fragment_with_caching_enabled</span>
572:     <span class="ruby-identifier">assert_nil</span> <span class="ruby-ivar">@store</span>.<span class="ruby-identifier">read</span>(<span class="ruby-value str">'views/name'</span>)
573:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'value'</span>, <span class="ruby-ivar">@controller</span>.<span class="ruby-identifier">write_fragment</span>(<span class="ruby-value str">'name'</span>, <span class="ruby-value str">'value'</span>)
574:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'value'</span>, <span class="ruby-ivar">@store</span>.<span class="ruby-identifier">read</span>(<span class="ruby-value str">'views/name'</span>)
575:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
</div>

  </div>