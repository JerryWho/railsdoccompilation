  <div id="C00000563">
<div class='banner'>
  <span class="file-title-prefix">Class</span><br />AttributeMethodsTest<br/>
  In:
<a href="#" onclick="jsHref('files/activerecord/test/cases/attribute_methods_test_rb.html');">activerecord/test/cases/attribute_methods_test.rb</a>

Parent:&nbsp;
ActiveRecord::TestCase
</div>
 <!-- banner header -->

  <div id="bodyContent" >
      <div id="content">




  <div class="sectiontitle">Methods</div>
  <ul>
  <li><a href="index.html?a=M003895&name=setup" >setup</a></li>
  <li><a href="index.html?a=M003896&name=teardown" >teardown</a></li>
  <li><a href="index.html?a=M003910&name=test_accessing_cached_attributes_caches_the_converted_values_and_nothing_else" >test_accessing_cached_attributes_caches_the_converted_values_and_nothing_else</a></li>
  <li><a href="index.html?a=M003922&name=test_bulk_update_respects_access_control" >test_bulk_update_respects_access_control</a></li>
  <li><a href="index.html?a=M003898&name=test_declared_attribute_method_affects_respond_to_and_method_missing" >test_declared_attribute_method_affects_respond_to_and_method_missing</a></li>
  <li><a href="index.html?a=M003908&name=test_declaring_attributes_as_cached_adds_them_to_the_attributes_cached_by_default" >test_declaring_attributes_as_cached_adds_them_to_the_attributes_cached_by_default</a></li>
  <li><a href="index.html?a=M003904&name=test_defined_kernel_methods_implemented_in_model" >test_defined_kernel_methods_implemented_in_model</a></li>
  <li><a href="index.html?a=M003905&name=test_defined_kernel_methods_implemented_in_model_abstract_subclass" >test_defined_kernel_methods_implemented_in_model_abstract_subclass</a></li>
  <li><a href="index.html?a=M003902&name=test_kernel_methods_not_implemented_in_activerecord" >test_kernel_methods_not_implemented_in_activerecord</a></li>
  <li><a href="index.html?a=M003897&name=test_match_attribute_method_query_returns_match_data" >test_match_attribute_method_query_returns_match_data</a></li>
  <li><a href="index.html?a=M003907&name=test_only_time_related_columns_are_meant_to_be_cached_by_default" >test_only_time_related_columns_are_meant_to_be_cached_by_default</a></li>
  <li><a href="index.html?a=M003903&name=test_primary_key_implemented" >test_primary_key_implemented</a></li>
  <li><a href="index.html?a=M003921&name=test_question_attributes_respect_access_control" >test_question_attributes_respect_access_control</a></li>
  <li><a href="index.html?a=M003906&name=test_raises_dangerous_attribute_error_when_defining_activerecord_method_in_model" >test_raises_dangerous_attribute_error_when_defining_activerecord_method_in_model</a></li>
  <li><a href="index.html?a=M003919&name=test_read_attributes_respect_access_control" >test_read_attributes_respect_access_control</a></li>
  <li><a href="index.html?a=M003917&name=test_setting_time_zone_aware_attribute_in_current_time_zone" >test_setting_time_zone_aware_attribute_in_current_time_zone</a></li>
  <li><a href="index.html?a=M003913&name=test_setting_time_zone_aware_attribute_in_other_time_zone" >test_setting_time_zone_aware_attribute_in_other_time_zone</a></li>
  <li><a href="index.html?a=M003916&name=test_setting_time_zone_aware_attribute_interprets_time_zone_unaware_string_in_time_zone" >test_setting_time_zone_aware_attribute_interprets_time_zone_unaware_string_in_time_zone</a></li>
  <li><a href="index.html?a=M003915&name=test_setting_time_zone_aware_attribute_to_blank_string_returns_nil" >test_setting_time_zone_aware_attribute_to_blank_string_returns_nil</a></li>
  <li><a href="index.html?a=M003912&name=test_setting_time_zone_aware_attribute_to_utc" >test_setting_time_zone_aware_attribute_to_utc</a></li>
  <li><a href="index.html?a=M003914&name=test_setting_time_zone_aware_attribute_with_string" >test_setting_time_zone_aware_attribute_with_string</a></li>
  <li><a href="index.html?a=M003918&name=test_setting_time_zone_conversion_for_attributes_should_write_value_on_class_variable" >test_setting_time_zone_conversion_for_attributes_should_write_value_on_class_variable</a></li>
  <li><a href="index.html?a=M003899&name=test_should_unserialize_attributes_for_frozen_records" >test_should_unserialize_attributes_for_frozen_records</a></li>
  <li><a href="index.html?a=M003911&name=test_time_attributes_are_retrieved_in_current_time_zone" >test_time_attributes_are_retrieved_in_current_time_zone</a></li>
  <li><a href="index.html?a=M003909&name=test_time_related_columns_are_actually_cached" >test_time_related_columns_are_actually_cached</a></li>
  <li><a href="index.html?a=M003900&name=test_typecast_attribute_from_select_to_false" >test_typecast_attribute_from_select_to_false</a></li>
  <li><a href="index.html?a=M003901&name=test_typecast_attribute_from_select_to_true" >test_typecast_attribute_from_select_to_true</a></li>
  <li><a href="index.html?a=M003920&name=test_write_attributes_respect_access_control" >test_write_attributes_respect_access_control</a></li>
  </ul>






<div class="sectiontitle">Public Instance methods</div>
<div id="M003895" class="method">
  <div id="M003895_title" class="title">
    <b>setup</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003895_source')" id="l_M003895_source">show source</a> ]</p>
  <div id="M003895_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/attribute_methods_test.rb, line 7</span>
 7:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">setup</span>
 8:     <span class="ruby-ivar">@old_suffixes</span> = <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:attribute_method_suffixes</span>).<span class="ruby-identifier">dup</span>
 9:     <span class="ruby-ivar">@target</span> = <span class="ruby-constant">Class</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>)
10:     <span class="ruby-ivar">@target</span>.<span class="ruby-identifier">table_name</span> = <span class="ruby-value str">'topics'</span>
11:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003896" class="method">
  <div id="M003896_title" class="title">
    <b>teardown</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003896_source')" id="l_M003896_source">show source</a> ]</p>
  <div id="M003896_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/attribute_methods_test.rb, line 13</span>
13:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">teardown</span>
14:     <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:attribute_method_suffixes</span>).<span class="ruby-identifier">clear</span>
15:     <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">attribute_method_suffix</span> <span class="ruby-operator">*</span><span class="ruby-ivar">@old_suffixes</span>
16:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003910" class="method">
  <div id="M003910_title" class="title">
    <b>test_accessing_cached_attributes_caches_the_converted_values_and_nothing_else</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003910_source')" id="l_M003910_source">show source</a> ]</p>
  <div id="M003910_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/attribute_methods_test.rb, line 130</span>
130:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_accessing_cached_attributes_caches_the_converted_values_and_nothing_else</span>
131:     <span class="ruby-identifier">t</span> = <span class="ruby-identifier">topics</span>(<span class="ruby-identifier">:first</span>)
132:     <span class="ruby-identifier">cache</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">instance_variable_get</span> <span class="ruby-value str">&quot;@attributes_cache&quot;</span>
133: 
134:     <span class="ruby-identifier">assert_not_nil</span> <span class="ruby-identifier">cache</span>
135:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">cache</span>.<span class="ruby-identifier">empty?</span>
136: 
137:     <span class="ruby-identifier">all_columns</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">columns</span>.<span class="ruby-identifier">map</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">:name</span>)
138:     <span class="ruby-identifier">cached_columns</span> = <span class="ruby-identifier">time_related_columns_on_topic</span>
139:     <span class="ruby-identifier">uncached_columns</span> =  <span class="ruby-identifier">all_columns</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">cached_columns</span>
140: 
141:     <span class="ruby-identifier">all_columns</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">attr_name</span><span class="ruby-operator">|</span>
142:       <span class="ruby-identifier">attribute_gets_cached</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">cache_attribute?</span>(<span class="ruby-identifier">attr_name</span>)
143:       <span class="ruby-identifier">val</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">send</span> <span class="ruby-identifier">attr_name</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">attr_name</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;type&quot;</span>
144:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">attribute_gets_cached</span>
145:         <span class="ruby-identifier">assert</span> <span class="ruby-identifier">cached_columns</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">attr_name</span>)
146:         <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">val</span>, <span class="ruby-identifier">cache</span>[<span class="ruby-identifier">attr_name</span>]
147:       <span class="ruby-keyword kw">else</span>
148:         <span class="ruby-identifier">assert</span> <span class="ruby-identifier">uncached_columns</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">attr_name</span>)
149:         <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">cache</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">attr_name</span>)
150:       <span class="ruby-keyword kw">end</span>
151:     <span class="ruby-keyword kw">end</span>
152:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003922" class="method">
  <div id="M003922_title" class="title">
    <b>test_bulk_update_respects_access_control</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003922_source')" id="l_M003922_source">show source</a> ]</p>
  <div id="M003922_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/attribute_methods_test.rb, line 273</span>
273:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_bulk_update_respects_access_control</span>
274:     <span class="ruby-identifier">privatize</span>(<span class="ruby-value str">&quot;title=(value)&quot;</span>)
275: 
276:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">UnknownAttributeError</span>) { <span class="ruby-identifier">topic</span> = <span class="ruby-ivar">@target</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Rants about pants&quot;</span>) }
277:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">UnknownAttributeError</span>) { <span class="ruby-ivar">@target</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">attributes</span> = { <span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Ants in pants&quot;</span> } }
278:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003898" class="method">
  <div id="M003898_title" class="title">
    <b>test_declared_attribute_method_affects_respond_to_and_method_missing</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003898_source')" id="l_M003898_source">show source</a> ]</p>
  <div id="M003898_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/attribute_methods_test.rb, line 33</span>
33:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_declared_attribute_method_affects_respond_to_and_method_missing</span>
34:     <span class="ruby-identifier">topic</span> = <span class="ruby-ivar">@target</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'Budget'</span>)
35:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">topic</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value str">'title'</span>)
36:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'Budget'</span>, <span class="ruby-identifier">topic</span>.<span class="ruby-identifier">title</span>
37:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">topic</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value str">'title_hello_world'</span>)
38:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">NoMethodError</span>) { <span class="ruby-identifier">topic</span>.<span class="ruby-identifier">title_hello_world</span> }
39: 
40:     <span class="ruby-node">%w(_hello_world _it! _candidate= able?)</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">suffix</span><span class="ruby-operator">|</span>
41:       <span class="ruby-ivar">@target</span>.<span class="ruby-identifier">class_eval</span> <span class="ruby-node">&quot;def attribute#{suffix}(*args) args end&quot;</span>
42:       <span class="ruby-ivar">@target</span>.<span class="ruby-identifier">attribute_method_suffix</span> <span class="ruby-identifier">suffix</span>
43: 
44:       <span class="ruby-identifier">meth</span> = <span class="ruby-node">&quot;title#{suffix}&quot;</span>
45:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">topic</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">meth</span>)
46:       <span class="ruby-identifier">assert_equal</span> [<span class="ruby-value str">'title'</span>], <span class="ruby-identifier">topic</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">meth</span>)
47:       <span class="ruby-identifier">assert_equal</span> [<span class="ruby-value str">'title'</span>, <span class="ruby-value str">'a'</span>], <span class="ruby-identifier">topic</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">meth</span>, <span class="ruby-value str">'a'</span>)
48:       <span class="ruby-identifier">assert_equal</span> [<span class="ruby-value str">'title'</span>, <span class="ruby-value">1</span>, <span class="ruby-value">2</span>, <span class="ruby-value">3</span>], <span class="ruby-identifier">topic</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">meth</span>, <span class="ruby-value">1</span>, <span class="ruby-value">2</span>, <span class="ruby-value">3</span>)
49:     <span class="ruby-keyword kw">end</span>
50:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003908" class="method">
  <div id="M003908_title" class="title">
    <b>test_declaring_attributes_as_cached_adds_them_to_the_attributes_cached_by_default</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003908_source')" id="l_M003908_source">show source</a> ]</p>
  <div id="M003908_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/attribute_methods_test.rb, line 114</span>
114:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_declaring_attributes_as_cached_adds_them_to_the_attributes_cached_by_default</span>
115:     <span class="ruby-identifier">default_attributes</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">cached_attributes</span>
116:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">cache_attributes</span> <span class="ruby-identifier">:replies_count</span>
117:     <span class="ruby-identifier">expected</span> = <span class="ruby-identifier">default_attributes</span> <span class="ruby-operator">+</span> [<span class="ruby-value str">&quot;replies_count&quot;</span>]
118:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">sort</span>, <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">cached_attributes</span>.<span class="ruby-identifier">sort</span>
119:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">instance_variable_set</span> <span class="ruby-value str">&quot;@cached_attributes&quot;</span>, <span class="ruby-keyword kw">nil</span>
120:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003904" class="method">
  <div id="M003904_title" class="title">
    <b>test_defined_kernel_methods_implemented_in_model</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003904_source')" id="l_M003904_source">show source</a> ]</p>
  <div id="M003904_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/attribute_methods_test.rb, line 81</span>
81:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_defined_kernel_methods_implemented_in_model</span>
82:     <span class="ruby-node">%w(test name display y)</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">method</span><span class="ruby-operator">|</span>
83:       <span class="ruby-identifier">klass</span> = <span class="ruby-constant">Class</span>.<span class="ruby-identifier">new</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
84:       <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">class_eval</span> <span class="ruby-node">&quot;def #{method}() 'defined #{method}' end&quot;</span>
85:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">instance_method_already_implemented?</span>(<span class="ruby-identifier">method</span>), <span class="ruby-node">&quot;##{method} is not defined&quot;</span>
86:     <span class="ruby-keyword kw">end</span>
87:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003905" class="method">
  <div id="M003905_title" class="title">
    <b>test_defined_kernel_methods_implemented_in_model_abstract_subclass</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003905_source')" id="l_M003905_source">show source</a> ]</p>
  <div id="M003905_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/attribute_methods_test.rb, line 89</span>
89:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_defined_kernel_methods_implemented_in_model_abstract_subclass</span>
90:     <span class="ruby-node">%w(test name display y)</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">method</span><span class="ruby-operator">|</span>
91:       <span class="ruby-identifier">abstract</span> = <span class="ruby-constant">Class</span>.<span class="ruby-identifier">new</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
92:       <span class="ruby-identifier">abstract</span>.<span class="ruby-identifier">class_eval</span> <span class="ruby-node">&quot;def #{method}() 'defined #{method}' end&quot;</span>
93:       <span class="ruby-identifier">abstract</span>.<span class="ruby-identifier">abstract_class</span> = <span class="ruby-keyword kw">true</span>
94:       <span class="ruby-identifier">klass</span> = <span class="ruby-constant">Class</span>.<span class="ruby-identifier">new</span> <span class="ruby-identifier">abstract</span>
95:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">instance_method_already_implemented?</span>(<span class="ruby-identifier">method</span>), <span class="ruby-node">&quot;##{method} is not defined&quot;</span>
96:     <span class="ruby-keyword kw">end</span>
97:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003902" class="method">
  <div id="M003902_title" class="title">
    <b>test_kernel_methods_not_implemented_in_activerecord</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003902_source')" id="l_M003902_source">show source</a> ]</p>
  <div id="M003902_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/attribute_methods_test.rb, line 71</span>
71:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_kernel_methods_not_implemented_in_activerecord</span>
72:     <span class="ruby-node">%w(test name display y)</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">method</span><span class="ruby-operator">|</span>
73:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">instance_method_already_implemented?</span>(<span class="ruby-identifier">method</span>), <span class="ruby-node">&quot;##{method} is defined&quot;</span>
74:     <span class="ruby-keyword kw">end</span>
75:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003897" class="method">
  <div id="M003897_title" class="title">
    <b>test_match_attribute_method_query_returns_match_data</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003897_source')" id="l_M003897_source">show source</a> ]</p>
  <div id="M003897_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/attribute_methods_test.rb, line 18</span>
18:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_match_attribute_method_query_returns_match_data</span>
19:     <span class="ruby-identifier">assert_not_nil</span> <span class="ruby-identifier">md</span> = <span class="ruby-ivar">@target</span>.<span class="ruby-identifier">match_attribute_method?</span>(<span class="ruby-value str">'title='</span>)
20:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'title'</span>, <span class="ruby-identifier">md</span>.<span class="ruby-identifier">pre_match</span>
21:     <span class="ruby-identifier">assert_equal</span> [<span class="ruby-value str">'='</span>], <span class="ruby-identifier">md</span>.<span class="ruby-identifier">captures</span>
22: 
23:     <span class="ruby-node">%w(_hello_world ist! _maybe?)</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">suffix</span><span class="ruby-operator">|</span>
24:       <span class="ruby-ivar">@target</span>.<span class="ruby-identifier">class_eval</span> <span class="ruby-node">&quot;def attribute#{suffix}(*args) args end&quot;</span>
25:       <span class="ruby-ivar">@target</span>.<span class="ruby-identifier">attribute_method_suffix</span> <span class="ruby-identifier">suffix</span>
26: 
27:       <span class="ruby-identifier">assert_not_nil</span> <span class="ruby-identifier">md</span> = <span class="ruby-ivar">@target</span>.<span class="ruby-identifier">match_attribute_method?</span>(<span class="ruby-node">&quot;title#{suffix}&quot;</span>)
28:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'title'</span>, <span class="ruby-identifier">md</span>.<span class="ruby-identifier">pre_match</span>
29:       <span class="ruby-identifier">assert_equal</span> [<span class="ruby-identifier">suffix</span>], <span class="ruby-identifier">md</span>.<span class="ruby-identifier">captures</span>
30:     <span class="ruby-keyword kw">end</span>
31:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003907" class="method">
  <div id="M003907_title" class="title">
    <b>test_only_time_related_columns_are_meant_to_be_cached_by_default</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003907_source')" id="l_M003907_source">show source</a> ]</p>
  <div id="M003907_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/attribute_methods_test.rb, line 109</span>
109:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_only_time_related_columns_are_meant_to_be_cached_by_default</span>
110:     <span class="ruby-identifier">expected</span> = <span class="ruby-node">%w(datetime timestamp time date)</span>.<span class="ruby-identifier">sort</span>
111:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">expected</span>, <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">attribute_types_cached_by_default</span>.<span class="ruby-identifier">map</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">:to_s</span>).<span class="ruby-identifier">sort</span>
112:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003903" class="method">
  <div id="M003903_title" class="title">
    <b>test_primary_key_implemented</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003903_source')" id="l_M003903_source">show source</a> ]</p>
  <div id="M003903_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/attribute_methods_test.rb, line 77</span>
77:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_primary_key_implemented</span>
78:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">Class</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>).<span class="ruby-identifier">instance_method_already_implemented?</span>(<span class="ruby-value str">'id'</span>)
79:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003921" class="method">
  <div id="M003921_title" class="title">
    <b>test_question_attributes_respect_access_control</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003921_source')" id="l_M003921_source">show source</a> ]</p>
  <div id="M003921_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/attribute_methods_test.rb, line 263</span>
263:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_question_attributes_respect_access_control</span>
264:     <span class="ruby-identifier">privatize</span>(<span class="ruby-value str">&quot;title?&quot;</span>)
265: 
266:     <span class="ruby-identifier">topic</span> = <span class="ruby-ivar">@target</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Isaac Newton's pants&quot;</span>)
267:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">topic</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:title?</span>)
268:     <span class="ruby-identifier">exception</span> = <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">NoMethodError</span>) { <span class="ruby-identifier">topic</span>.<span class="ruby-identifier">title?</span> }
269:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;Attempt to call private method&quot;</span>, <span class="ruby-identifier">exception</span>.<span class="ruby-identifier">message</span>
270:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">topic</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:title?</span>)
271:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003906" class="method">
  <div id="M003906_title" class="title">
    <b>test_raises_dangerous_attribute_error_when_defining_activerecord_method_in_model</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003906_source')" id="l_M003906_source">show source</a> ]</p>
  <div id="M003906_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/attribute_methods_test.rb, line 99</span>
 99:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_raises_dangerous_attribute_error_when_defining_activerecord_method_in_model</span>
100:     <span class="ruby-node">%w(save create_or_update)</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">method</span><span class="ruby-operator">|</span>
101:       <span class="ruby-identifier">klass</span> = <span class="ruby-constant">Class</span>.<span class="ruby-identifier">new</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
102:       <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">class_eval</span> <span class="ruby-node">&quot;def #{method}() 'defined #{method}' end&quot;</span>
103:       <span class="ruby-identifier">assert_raise</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">DangerousAttributeError</span> <span class="ruby-keyword kw">do</span>
104:         <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">instance_method_already_implemented?</span>(<span class="ruby-identifier">method</span>)
105:       <span class="ruby-keyword kw">end</span>
106:     <span class="ruby-keyword kw">end</span>
107:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003919" class="method">
  <div id="M003919_title" class="title">
    <b>test_read_attributes_respect_access_control</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003919_source')" id="l_M003919_source">show source</a> ]</p>
  <div id="M003919_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/attribute_methods_test.rb, line 243</span>
243:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_read_attributes_respect_access_control</span>
244:     <span class="ruby-identifier">privatize</span>(<span class="ruby-value str">&quot;title&quot;</span>)
245: 
246:     <span class="ruby-identifier">topic</span> = <span class="ruby-ivar">@target</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;The pros and cons of programming naked.&quot;</span>)
247:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">topic</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:title</span>)
248:     <span class="ruby-identifier">exception</span> = <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">NoMethodError</span>) { <span class="ruby-identifier">topic</span>.<span class="ruby-identifier">title</span> }
249:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;Attempt to call private method&quot;</span>, <span class="ruby-identifier">exception</span>.<span class="ruby-identifier">message</span>
250:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;I'm private&quot;</span>, <span class="ruby-identifier">topic</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:title</span>)
251:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003917" class="method">
  <div id="M003917_title" class="title">
    <b>test_setting_time_zone_aware_attribute_in_current_time_zone</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003917_source')" id="l_M003917_source">show source</a> ]</p>
  <div id="M003917_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/attribute_methods_test.rb, line 224</span>
224:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_setting_time_zone_aware_attribute_in_current_time_zone</span>
225:     <span class="ruby-identifier">utc_time</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">utc</span>(<span class="ruby-value">2008</span>, <span class="ruby-value">1</span>, <span class="ruby-value">1</span>)
226:     <span class="ruby-identifier">in_time_zone</span> <span class="ruby-value str">&quot;Pacific Time (US &amp; Canada)&quot;</span> <span class="ruby-keyword kw">do</span>
227:       <span class="ruby-identifier">record</span>   = <span class="ruby-ivar">@target</span>.<span class="ruby-identifier">new</span>
228:       <span class="ruby-identifier">record</span>.<span class="ruby-identifier">written_on</span> = <span class="ruby-identifier">utc_time</span>.<span class="ruby-identifier">in_time_zone</span>
229:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">utc_time</span>, <span class="ruby-identifier">record</span>.<span class="ruby-identifier">written_on</span>
230:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-constant">ActiveSupport</span><span class="ruby-operator">::</span><span class="ruby-constant">TimeZone</span>[<span class="ruby-value str">&quot;Pacific Time (US &amp; Canada)&quot;</span>], <span class="ruby-identifier">record</span>.<span class="ruby-identifier">written_on</span>.<span class="ruby-identifier">time_zone</span>
231:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-constant">Time</span>.<span class="ruby-identifier">utc</span>(<span class="ruby-value">2007</span>, <span class="ruby-value">12</span>, <span class="ruby-value">31</span>, <span class="ruby-value">16</span>), <span class="ruby-identifier">record</span>.<span class="ruby-identifier">written_on</span>.<span class="ruby-identifier">time</span>
232:     <span class="ruby-keyword kw">end</span>
233:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003913" class="method">
  <div id="M003913_title" class="title">
    <b>test_setting_time_zone_aware_attribute_in_other_time_zone</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003913_source')" id="l_M003913_source">show source</a> ]</p>
  <div id="M003913_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/attribute_methods_test.rb, line 177</span>
177:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_setting_time_zone_aware_attribute_in_other_time_zone</span>
178:     <span class="ruby-identifier">utc_time</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">utc</span>(<span class="ruby-value">2008</span>, <span class="ruby-value">1</span>, <span class="ruby-value">1</span>)
179:     <span class="ruby-identifier">cst_time</span> = <span class="ruby-identifier">utc_time</span>.<span class="ruby-identifier">in_time_zone</span>(<span class="ruby-value str">&quot;Central Time (US &amp; Canada)&quot;</span>)
180:     <span class="ruby-identifier">in_time_zone</span> <span class="ruby-value str">&quot;Pacific Time (US &amp; Canada)&quot;</span> <span class="ruby-keyword kw">do</span>
181:       <span class="ruby-identifier">record</span>   = <span class="ruby-ivar">@target</span>.<span class="ruby-identifier">new</span>
182:       <span class="ruby-identifier">record</span>.<span class="ruby-identifier">written_on</span> = <span class="ruby-identifier">cst_time</span>
183:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">utc_time</span>, <span class="ruby-identifier">record</span>.<span class="ruby-identifier">written_on</span>
184:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-constant">ActiveSupport</span><span class="ruby-operator">::</span><span class="ruby-constant">TimeZone</span>[<span class="ruby-value str">&quot;Pacific Time (US &amp; Canada)&quot;</span>], <span class="ruby-identifier">record</span>.<span class="ruby-identifier">written_on</span>.<span class="ruby-identifier">time_zone</span>
185:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-constant">Time</span>.<span class="ruby-identifier">utc</span>(<span class="ruby-value">2007</span>, <span class="ruby-value">12</span>, <span class="ruby-value">31</span>, <span class="ruby-value">16</span>), <span class="ruby-identifier">record</span>.<span class="ruby-identifier">written_on</span>.<span class="ruby-identifier">time</span>
186:     <span class="ruby-keyword kw">end</span>
187:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003916" class="method">
  <div id="M003916_title" class="title">
    <b>test_setting_time_zone_aware_attribute_interprets_time_zone_unaware_string_in_time_zone</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003916_source')" id="l_M003916_source">show source</a> ]</p>
  <div id="M003916_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/attribute_methods_test.rb, line 211</span>
211:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_setting_time_zone_aware_attribute_interprets_time_zone_unaware_string_in_time_zone</span>
212:     <span class="ruby-identifier">time_string</span> = <span class="ruby-value str">'Tue Jan 01 00:00:00 2008'</span>
213:     (<span class="ruby-value">-11</span><span class="ruby-operator">..</span><span class="ruby-value">13</span>).<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">timezone_offset</span><span class="ruby-operator">|</span>
214:       <span class="ruby-identifier">in_time_zone</span> <span class="ruby-identifier">timezone_offset</span> <span class="ruby-keyword kw">do</span>
215:         <span class="ruby-identifier">record</span>   = <span class="ruby-ivar">@target</span>.<span class="ruby-identifier">new</span>
216:         <span class="ruby-identifier">record</span>.<span class="ruby-identifier">written_on</span> = <span class="ruby-identifier">time_string</span>
217:         <span class="ruby-identifier">assert_equal</span> <span class="ruby-constant">Time</span>.<span class="ruby-identifier">zone</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">time_string</span>), <span class="ruby-identifier">record</span>.<span class="ruby-identifier">written_on</span>
218:         <span class="ruby-identifier">assert_equal</span> <span class="ruby-constant">ActiveSupport</span><span class="ruby-operator">::</span><span class="ruby-constant">TimeZone</span>[<span class="ruby-identifier">timezone_offset</span>], <span class="ruby-identifier">record</span>.<span class="ruby-identifier">written_on</span>.<span class="ruby-identifier">time_zone</span>
219:         <span class="ruby-identifier">assert_equal</span> <span class="ruby-constant">Time</span>.<span class="ruby-identifier">utc</span>(<span class="ruby-value">2008</span>, <span class="ruby-value">1</span>, <span class="ruby-value">1</span>), <span class="ruby-identifier">record</span>.<span class="ruby-identifier">written_on</span>.<span class="ruby-identifier">time</span>
220:       <span class="ruby-keyword kw">end</span>
221:     <span class="ruby-keyword kw">end</span>
222:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003915" class="method">
  <div id="M003915_title" class="title">
    <b>test_setting_time_zone_aware_attribute_to_blank_string_returns_nil</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003915_source')" id="l_M003915_source">show source</a> ]</p>
  <div id="M003915_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/attribute_methods_test.rb, line 203</span>
203:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_setting_time_zone_aware_attribute_to_blank_string_returns_nil</span>
204:     <span class="ruby-identifier">in_time_zone</span> <span class="ruby-value str">&quot;Pacific Time (US &amp; Canada)&quot;</span> <span class="ruby-keyword kw">do</span>
205:       <span class="ruby-identifier">record</span>   = <span class="ruby-ivar">@target</span>.<span class="ruby-identifier">new</span>
206:       <span class="ruby-identifier">record</span>.<span class="ruby-identifier">written_on</span> = <span class="ruby-value str">' '</span>
207:       <span class="ruby-identifier">assert_nil</span> <span class="ruby-identifier">record</span>.<span class="ruby-identifier">written_on</span>
208:     <span class="ruby-keyword kw">end</span>
209:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003912" class="method">
  <div id="M003912_title" class="title">
    <b>test_setting_time_zone_aware_attribute_to_utc</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003912_source')" id="l_M003912_source">show source</a> ]</p>
  <div id="M003912_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/attribute_methods_test.rb, line 166</span>
166:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_setting_time_zone_aware_attribute_to_utc</span>
167:     <span class="ruby-identifier">in_time_zone</span> <span class="ruby-value str">&quot;Pacific Time (US &amp; Canada)&quot;</span> <span class="ruby-keyword kw">do</span>
168:       <span class="ruby-identifier">utc_time</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">utc</span>(<span class="ruby-value">2008</span>, <span class="ruby-value">1</span>, <span class="ruby-value">1</span>)
169:       <span class="ruby-identifier">record</span>   = <span class="ruby-ivar">@target</span>.<span class="ruby-identifier">new</span>
170:       <span class="ruby-identifier">record</span>.<span class="ruby-identifier">written_on</span> = <span class="ruby-identifier">utc_time</span>
171:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">utc_time</span>, <span class="ruby-identifier">record</span>.<span class="ruby-identifier">written_on</span>
172:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-constant">ActiveSupport</span><span class="ruby-operator">::</span><span class="ruby-constant">TimeZone</span>[<span class="ruby-value str">&quot;Pacific Time (US &amp; Canada)&quot;</span>], <span class="ruby-identifier">record</span>.<span class="ruby-identifier">written_on</span>.<span class="ruby-identifier">time_zone</span>
173:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-constant">Time</span>.<span class="ruby-identifier">utc</span>(<span class="ruby-value">2007</span>, <span class="ruby-value">12</span>, <span class="ruby-value">31</span>, <span class="ruby-value">16</span>), <span class="ruby-identifier">record</span>.<span class="ruby-identifier">written_on</span>.<span class="ruby-identifier">time</span>
174:     <span class="ruby-keyword kw">end</span>
175:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003914" class="method">
  <div id="M003914_title" class="title">
    <b>test_setting_time_zone_aware_attribute_with_string</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003914_source')" id="l_M003914_source">show source</a> ]</p>
  <div id="M003914_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/attribute_methods_test.rb, line 189</span>
189:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_setting_time_zone_aware_attribute_with_string</span>
190:     <span class="ruby-identifier">utc_time</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">utc</span>(<span class="ruby-value">2008</span>, <span class="ruby-value">1</span>, <span class="ruby-value">1</span>)
191:     (<span class="ruby-value">-11</span><span class="ruby-operator">..</span><span class="ruby-value">13</span>).<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">timezone_offset</span><span class="ruby-operator">|</span>
192:       <span class="ruby-identifier">time_string</span> = <span class="ruby-identifier">utc_time</span>.<span class="ruby-identifier">in_time_zone</span>(<span class="ruby-identifier">timezone_offset</span>).<span class="ruby-identifier">to_s</span>
193:       <span class="ruby-identifier">in_time_zone</span> <span class="ruby-value str">&quot;Pacific Time (US &amp; Canada)&quot;</span> <span class="ruby-keyword kw">do</span>
194:         <span class="ruby-identifier">record</span>   = <span class="ruby-ivar">@target</span>.<span class="ruby-identifier">new</span>
195:         <span class="ruby-identifier">record</span>.<span class="ruby-identifier">written_on</span> = <span class="ruby-identifier">time_string</span>
196:         <span class="ruby-identifier">assert_equal</span> <span class="ruby-constant">Time</span>.<span class="ruby-identifier">zone</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">time_string</span>), <span class="ruby-identifier">record</span>.<span class="ruby-identifier">written_on</span>
197:         <span class="ruby-identifier">assert_equal</span> <span class="ruby-constant">ActiveSupport</span><span class="ruby-operator">::</span><span class="ruby-constant">TimeZone</span>[<span class="ruby-value str">&quot;Pacific Time (US &amp; Canada)&quot;</span>], <span class="ruby-identifier">record</span>.<span class="ruby-identifier">written_on</span>.<span class="ruby-identifier">time_zone</span>
198:         <span class="ruby-identifier">assert_equal</span> <span class="ruby-constant">Time</span>.<span class="ruby-identifier">utc</span>(<span class="ruby-value">2007</span>, <span class="ruby-value">12</span>, <span class="ruby-value">31</span>, <span class="ruby-value">16</span>), <span class="ruby-identifier">record</span>.<span class="ruby-identifier">written_on</span>.<span class="ruby-identifier">time</span>
199:       <span class="ruby-keyword kw">end</span>
200:     <span class="ruby-keyword kw">end</span>
201:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003918" class="method">
  <div id="M003918_title" class="title">
    <b>test_setting_time_zone_conversion_for_attributes_should_write_value_on_class_variable</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003918_source')" id="l_M003918_source">show source</a> ]</p>
  <div id="M003918_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/attribute_methods_test.rb, line 235</span>
235:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_setting_time_zone_conversion_for_attributes_should_write_value_on_class_variable</span>
236:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">skip_time_zone_conversion_for_attributes</span> = [<span class="ruby-identifier">:field_a</span>]
237:     <span class="ruby-constant">Minimalistic</span>.<span class="ruby-identifier">skip_time_zone_conversion_for_attributes</span> = [<span class="ruby-identifier">:field_b</span>]
238:     
239:     <span class="ruby-identifier">assert_equal</span> [<span class="ruby-identifier">:field_a</span>], <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">skip_time_zone_conversion_for_attributes</span> 
240:     <span class="ruby-identifier">assert_equal</span> [<span class="ruby-identifier">:field_b</span>], <span class="ruby-constant">Minimalistic</span>.<span class="ruby-identifier">skip_time_zone_conversion_for_attributes</span> 
241:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003899" class="method">
  <div id="M003899_title" class="title">
    <b>test_should_unserialize_attributes_for_frozen_records</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003899_source')" id="l_M003899_source">show source</a> ]</p>
  <div id="M003899_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/attribute_methods_test.rb, line 52</span>
52:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_unserialize_attributes_for_frozen_records</span>
53:     <span class="ruby-identifier">myobj</span> = {<span class="ruby-identifier">:value1</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:value2</span>}
54:     <span class="ruby-identifier">topic</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">myobj</span>)
55:     <span class="ruby-identifier">topic</span>.<span class="ruby-identifier">freeze</span>
56:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">myobj</span>, <span class="ruby-identifier">topic</span>.<span class="ruby-identifier">content</span>
57:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003911" class="method">
  <div id="M003911_title" class="title">
    <b>test_time_attributes_are_retrieved_in_current_time_zone</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003911_source')" id="l_M003911_source">show source</a> ]</p>
  <div id="M003911_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/attribute_methods_test.rb, line 154</span>
154:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_time_attributes_are_retrieved_in_current_time_zone</span>
155:     <span class="ruby-identifier">in_time_zone</span> <span class="ruby-value str">&quot;Pacific Time (US &amp; Canada)&quot;</span> <span class="ruby-keyword kw">do</span>
156:       <span class="ruby-identifier">utc_time</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">utc</span>(<span class="ruby-value">2008</span>, <span class="ruby-value">1</span>, <span class="ruby-value">1</span>)
157:       <span class="ruby-identifier">record</span>   = <span class="ruby-ivar">@target</span>.<span class="ruby-identifier">new</span>
158:       <span class="ruby-identifier">record</span>[<span class="ruby-identifier">:written_on</span>] = <span class="ruby-identifier">utc_time</span>
159:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">utc_time</span>, <span class="ruby-identifier">record</span>.<span class="ruby-identifier">written_on</span> <span class="ruby-comment cmt"># record.written on is equal to (i.e., simultaneous with) utc_time</span>
160:       <span class="ruby-identifier">assert_kind_of</span> <span class="ruby-constant">ActiveSupport</span><span class="ruby-operator">::</span><span class="ruby-constant">TimeWithZone</span>, <span class="ruby-identifier">record</span>.<span class="ruby-identifier">written_on</span> <span class="ruby-comment cmt"># but is a TimeWithZone</span>
161:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-constant">ActiveSupport</span><span class="ruby-operator">::</span><span class="ruby-constant">TimeZone</span>[<span class="ruby-value str">&quot;Pacific Time (US &amp; Canada)&quot;</span>], <span class="ruby-identifier">record</span>.<span class="ruby-identifier">written_on</span>.<span class="ruby-identifier">time_zone</span> <span class="ruby-comment cmt"># and is in the current Time.zone</span>
162:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-constant">Time</span>.<span class="ruby-identifier">utc</span>(<span class="ruby-value">2007</span>, <span class="ruby-value">12</span>, <span class="ruby-value">31</span>, <span class="ruby-value">16</span>), <span class="ruby-identifier">record</span>.<span class="ruby-identifier">written_on</span>.<span class="ruby-identifier">time</span> <span class="ruby-comment cmt"># and represents time values adjusted accordingly</span>
163:     <span class="ruby-keyword kw">end</span>
164:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003909" class="method">
  <div id="M003909_title" class="title">
    <b>test_time_related_columns_are_actually_cached</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003909_source')" id="l_M003909_source">show source</a> ]</p>
  <div id="M003909_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/attribute_methods_test.rb, line 122</span>
122:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_time_related_columns_are_actually_cached</span>
123:     <span class="ruby-identifier">column_types</span> = <span class="ruby-node">%w(datetime timestamp time date)</span>.<span class="ruby-identifier">map</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">:to_sym</span>)
124:     <span class="ruby-identifier">column_names</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">columns</span>.<span class="ruby-identifier">select</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span> <span class="ruby-identifier">column_types</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">c</span>.<span class="ruby-identifier">type</span>) }.<span class="ruby-identifier">map</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">:name</span>)
125: 
126:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">column_names</span>.<span class="ruby-identifier">sort</span>, <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">cached_attributes</span>.<span class="ruby-identifier">sort</span>
127:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">time_related_columns_on_topic</span>.<span class="ruby-identifier">sort</span>, <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">cached_attributes</span>.<span class="ruby-identifier">sort</span>
128:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003900" class="method">
  <div id="M003900_title" class="title">
    <b>test_typecast_attribute_from_select_to_false</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003900_source')" id="l_M003900_source">show source</a> ]</p>
  <div id="M003900_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/attribute_methods_test.rb, line 59</span>
59:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_typecast_attribute_from_select_to_false</span>
60:     <span class="ruby-identifier">topic</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'Budget'</span>)
61:     <span class="ruby-identifier">topic</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:select</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;topics.*, 1=2 as is_test&quot;</span>)
62:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">topic</span>.<span class="ruby-identifier">is_test?</span>
63:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003901" class="method">
  <div id="M003901_title" class="title">
    <b>test_typecast_attribute_from_select_to_true</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003901_source')" id="l_M003901_source">show source</a> ]</p>
  <div id="M003901_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/attribute_methods_test.rb, line 65</span>
65:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_typecast_attribute_from_select_to_true</span>
66:     <span class="ruby-identifier">topic</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'Budget'</span>)
67:     <span class="ruby-identifier">topic</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:select</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;topics.*, 2=2 as is_test&quot;</span>)
68:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">topic</span>.<span class="ruby-identifier">is_test?</span>
69:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003920" class="method">
  <div id="M003920_title" class="title">
    <b>test_write_attributes_respect_access_control</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003920_source')" id="l_M003920_source">show source</a> ]</p>
  <div id="M003920_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/attribute_methods_test.rb, line 253</span>
253:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_write_attributes_respect_access_control</span>
254:     <span class="ruby-identifier">privatize</span>(<span class="ruby-value str">&quot;title=(value)&quot;</span>)
255: 
256:     <span class="ruby-identifier">topic</span> = <span class="ruby-ivar">@target</span>.<span class="ruby-identifier">new</span>
257:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">topic</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:title=</span>)
258:     <span class="ruby-identifier">exception</span> = <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">NoMethodError</span>) { <span class="ruby-identifier">topic</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;Pants&quot;</span>}
259:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;Attempt to call private method&quot;</span>, <span class="ruby-identifier">exception</span>.<span class="ruby-identifier">message</span>
260:     <span class="ruby-identifier">topic</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:title=</span>, <span class="ruby-value str">&quot;Very large pants&quot;</span>)
261:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
</div>

  </div>