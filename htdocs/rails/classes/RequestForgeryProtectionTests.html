  <div id="C00001342">
<div class='banner'>
  <span class="file-title-prefix">Module</span><br />RequestForgeryProtectionTests<br/>
  In:
<a href="#" onclick="jsHref('files/actionpack/test/controller/request_forgery_protection_test_rb.html');">actionpack/test/controller/request_forgery_protection_test.rb</a>

</div>
 <!-- banner header -->

  <div id="bodyContent" >
      <div id="content">

  <div class="description"><p>
common test methods
</p>
</div>



  <div class="sectiontitle">Methods</div>
  <ul>
  <li><a href="index.html?a=M008184&name=teardown" >teardown</a></li>
  <li><a href="index.html?a=M008195&name=test_should_allow_api_formatted_delete_without_token" >test_should_allow_api_formatted_delete_without_token</a></li>
  <li><a href="index.html?a=M008193&name=test_should_allow_api_formatted_post_without_token" >test_should_allow_api_formatted_post_without_token</a></li>
  <li><a href="index.html?a=M008208&name=test_should_allow_delete_with_token" >test_should_allow_delete_with_token</a></li>
  <li><a href="index.html?a=M008211&name=test_should_allow_delete_with_xml" >test_should_allow_delete_with_xml</a></li>
  <li><a href="index.html?a=M008188&name=test_should_allow_get" >test_should_allow_get</a></li>
  <li><a href="index.html?a=M008206&name=test_should_allow_post_with_token" >test_should_allow_post_with_token</a></li>
  <li><a href="index.html?a=M008209&name=test_should_allow_post_with_xml" >test_should_allow_post_with_xml</a></li>
  <li><a href="index.html?a=M008189&name=test_should_allow_post_without_token_on_unsafe_action" >test_should_allow_post_without_token_on_unsafe_action</a></li>
  <li><a href="index.html?a=M008207&name=test_should_allow_put_with_token" >test_should_allow_put_with_token</a></li>
  <li><a href="index.html?a=M008210&name=test_should_allow_put_with_xml" >test_should_allow_put_with_xml</a></li>
  <li><a href="index.html?a=M008204&name=test_should_allow_xhr_delete_without_token" >test_should_allow_xhr_delete_without_token</a></li>
  <li><a href="index.html?a=M008205&name=test_should_allow_xhr_post_with_encoded_form_content_type_without_token" >test_should_allow_xhr_post_with_encoded_form_content_type_without_token</a></li>
  <li><a href="index.html?a=M008202&name=test_should_allow_xhr_post_without_token" >test_should_allow_xhr_post_without_token</a></li>
  <li><a href="index.html?a=M008203&name=test_should_allow_xhr_put_without_token" >test_should_allow_xhr_put_without_token</a></li>
  <li><a href="index.html?a=M008201&name=test_should_not_allow_api_formatted_delete_sent_as_multipart_form_without_token" >test_should_not_allow_api_formatted_delete_sent_as_multipart_form_without_token</a></li>
  <li><a href="index.html?a=M008198&name=test_should_not_allow_api_formatted_delete_sent_as_url_encoded_form_without_token" >test_should_not_allow_api_formatted_delete_sent_as_url_encoded_form_without_token</a></li>
  <li><a href="index.html?a=M008199&name=test_should_not_allow_api_formatted_post_sent_as_multipart_form_without_token" >test_should_not_allow_api_formatted_post_sent_as_multipart_form_without_token</a></li>
  <li><a href="index.html?a=M008196&name=test_should_not_allow_api_formatted_post_sent_as_url_encoded_form_without_token" >test_should_not_allow_api_formatted_post_sent_as_url_encoded_form_without_token</a></li>
  <li><a href="index.html?a=M008200&name=test_should_not_allow_api_formatted_put_sent_as_multipart_form_without_token" >test_should_not_allow_api_formatted_put_sent_as_multipart_form_without_token</a></li>
  <li><a href="index.html?a=M008197&name=test_should_not_allow_api_formatted_put_sent_as_url_encoded_form_without_token" >test_should_not_allow_api_formatted_put_sent_as_url_encoded_form_without_token</a></li>
  <li><a href="index.html?a=M008194&name=test_should_not_allow_api_formatted_put_without_token" >test_should_not_allow_api_formatted_put_without_token</a></li>
  <li><a href="index.html?a=M008192&name=test_should_not_allow_html_delete_without_token" >test_should_not_allow_html_delete_without_token</a></li>
  <li><a href="index.html?a=M008190&name=test_should_not_allow_html_post_without_token" >test_should_not_allow_html_post_without_token</a></li>
  <li><a href="index.html?a=M008191&name=test_should_not_allow_html_put_without_token" >test_should_not_allow_html_put_without_token</a></li>
  <li><a href="index.html?a=M008186&name=test_should_render_button_to_with_token_tag" >test_should_render_button_to_with_token_tag</a></li>
  <li><a href="index.html?a=M008185&name=test_should_render_form_with_token_tag" >test_should_render_form_with_token_tag</a></li>
  <li><a href="index.html?a=M008187&name=test_should_render_remote_form_with_only_one_token_parameter" >test_should_render_remote_form_with_only_one_token_parameter</a></li>
  </ul>






<div class="sectiontitle">Public Instance methods</div>
<div id="M008184" class="method">
  <div id="M008184_title" class="title">
    <b>teardown</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M008184_source')" id="l_M008184_source">show source</a> ]</p>
  <div id="M008184_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/request_forgery_protection_test.rb, line 50</span>
50:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">teardown</span>
51:     <span class="ruby-constant">ActionController</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">request_forgery_protection_token</span> = <span class="ruby-keyword kw">nil</span>
52:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M008195" class="method">
  <div id="M008195_title" class="title">
    <b>test_should_allow_api_formatted_delete_without_token</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M008195_source')" id="l_M008195_source">show source</a> ]</p>
  <div id="M008195_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/request_forgery_protection_test.rb, line 107</span>
107:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_allow_api_formatted_delete_without_token</span>
108:     <span class="ruby-identifier">assert_nothing_raised</span> <span class="ruby-keyword kw">do</span>
109:       <span class="ruby-identifier">delete</span> <span class="ruby-identifier">:index</span>, <span class="ruby-identifier">:format</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'xml'</span>
110:     <span class="ruby-keyword kw">end</span>
111:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M008193" class="method">
  <div id="M008193_title" class="title">
    <b>test_should_allow_api_formatted_post_without_token</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M008193_source')" id="l_M008193_source">show source</a> ]</p>
  <div id="M008193_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/request_forgery_protection_test.rb, line 95</span>
95:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_allow_api_formatted_post_without_token</span>
96:     <span class="ruby-identifier">assert_nothing_raised</span> <span class="ruby-keyword kw">do</span>
97:       <span class="ruby-identifier">post</span> <span class="ruby-identifier">:index</span>, <span class="ruby-identifier">:format</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'xml'</span>
98:     <span class="ruby-keyword kw">end</span>
99:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M008208" class="method">
  <div id="M008208_title" class="title">
    <b>test_should_allow_delete_with_token</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M008208_source')" id="l_M008208_source">show source</a> ]</p>
  <div id="M008208_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/request_forgery_protection_test.rb, line 182</span>
182:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_allow_delete_with_token</span>
183:     <span class="ruby-identifier">delete</span> <span class="ruby-identifier">:index</span>, <span class="ruby-identifier">:authenticity_token</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@token</span>
184:     <span class="ruby-identifier">assert_response</span> <span class="ruby-identifier">:success</span>
185:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M008211" class="method">
  <div id="M008211_title" class="title">
    <b>test_should_allow_delete_with_xml</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M008211_source')" id="l_M008211_source">show source</a> ]</p>
  <div id="M008211_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/request_forgery_protection_test.rb, line 199</span>
199:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_allow_delete_with_xml</span>
200:     <span class="ruby-ivar">@request</span>.<span class="ruby-identifier">env</span>[<span class="ruby-value str">'CONTENT_TYPE'</span>] = <span class="ruby-constant">Mime</span><span class="ruby-operator">::</span><span class="ruby-constant">XML</span>.<span class="ruby-identifier">to_s</span>
201:     <span class="ruby-identifier">delete</span> <span class="ruby-identifier">:index</span>, <span class="ruby-identifier">:format</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'xml'</span>
202:     <span class="ruby-identifier">assert_response</span> <span class="ruby-identifier">:success</span>
203:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M008188" class="method">
  <div id="M008188_title" class="title">
    <b>test_should_allow_get</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M008188_source')" id="l_M008188_source">show source</a> ]</p>
  <div id="M008188_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/request_forgery_protection_test.rb, line 70</span>
70:    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_allow_get</span>
71:      <span class="ruby-identifier">get</span> <span class="ruby-identifier">:index</span>
72:      <span class="ruby-identifier">assert_response</span> <span class="ruby-identifier">:success</span>
73:    <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M008206" class="method">
  <div id="M008206_title" class="title">
    <b>test_should_allow_post_with_token</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M008206_source')" id="l_M008206_source">show source</a> ]</p>
  <div id="M008206_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/request_forgery_protection_test.rb, line 172</span>
172:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_allow_post_with_token</span>
173:     <span class="ruby-identifier">post</span> <span class="ruby-identifier">:index</span>, <span class="ruby-identifier">:authenticity_token</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@token</span>
174:     <span class="ruby-identifier">assert_response</span> <span class="ruby-identifier">:success</span>
175:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M008209" class="method">
  <div id="M008209_title" class="title">
    <b>test_should_allow_post_with_xml</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M008209_source')" id="l_M008209_source">show source</a> ]</p>
  <div id="M008209_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/request_forgery_protection_test.rb, line 187</span>
187:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_allow_post_with_xml</span>
188:     <span class="ruby-ivar">@request</span>.<span class="ruby-identifier">env</span>[<span class="ruby-value str">'CONTENT_TYPE'</span>] = <span class="ruby-constant">Mime</span><span class="ruby-operator">::</span><span class="ruby-constant">XML</span>.<span class="ruby-identifier">to_s</span>
189:     <span class="ruby-identifier">post</span> <span class="ruby-identifier">:index</span>, <span class="ruby-identifier">:format</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'xml'</span>
190:     <span class="ruby-identifier">assert_response</span> <span class="ruby-identifier">:success</span>
191:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M008189" class="method">
  <div id="M008189_title" class="title">
    <b>test_should_allow_post_without_token_on_unsafe_action</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M008189_source')" id="l_M008189_source">show source</a> ]</p>
  <div id="M008189_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/request_forgery_protection_test.rb, line 75</span>
75:    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_allow_post_without_token_on_unsafe_action</span>
76:      <span class="ruby-identifier">post</span> <span class="ruby-identifier">:unsafe</span>
77:      <span class="ruby-identifier">assert_response</span> <span class="ruby-identifier">:success</span>
78:    <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M008207" class="method">
  <div id="M008207_title" class="title">
    <b>test_should_allow_put_with_token</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M008207_source')" id="l_M008207_source">show source</a> ]</p>
  <div id="M008207_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/request_forgery_protection_test.rb, line 177</span>
177:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_allow_put_with_token</span>
178:     <span class="ruby-identifier">put</span> <span class="ruby-identifier">:index</span>, <span class="ruby-identifier">:authenticity_token</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@token</span>
179:     <span class="ruby-identifier">assert_response</span> <span class="ruby-identifier">:success</span>
180:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M008210" class="method">
  <div id="M008210_title" class="title">
    <b>test_should_allow_put_with_xml</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M008210_source')" id="l_M008210_source">show source</a> ]</p>
  <div id="M008210_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/request_forgery_protection_test.rb, line 193</span>
193:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_allow_put_with_xml</span>
194:     <span class="ruby-ivar">@request</span>.<span class="ruby-identifier">env</span>[<span class="ruby-value str">'CONTENT_TYPE'</span>] = <span class="ruby-constant">Mime</span><span class="ruby-operator">::</span><span class="ruby-constant">XML</span>.<span class="ruby-identifier">to_s</span>
195:     <span class="ruby-identifier">put</span> <span class="ruby-identifier">:index</span>, <span class="ruby-identifier">:format</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'xml'</span>
196:     <span class="ruby-identifier">assert_response</span> <span class="ruby-identifier">:success</span>
197:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M008204" class="method">
  <div id="M008204_title" class="title">
    <b>test_should_allow_xhr_delete_without_token</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M008204_source')" id="l_M008204_source">show source</a> ]</p>
  <div id="M008204_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/request_forgery_protection_test.rb, line 163</span>
163:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_allow_xhr_delete_without_token</span>
164:     <span class="ruby-identifier">assert_nothing_raised</span> { <span class="ruby-identifier">xhr</span> <span class="ruby-identifier">:delete</span>, <span class="ruby-identifier">:index</span> }
165:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M008205" class="method">
  <div id="M008205_title" class="title">
    <b>test_should_allow_xhr_post_with_encoded_form_content_type_without_token</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M008205_source')" id="l_M008205_source">show source</a> ]</p>
  <div id="M008205_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/request_forgery_protection_test.rb, line 167</span>
167:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_allow_xhr_post_with_encoded_form_content_type_without_token</span>
168:     <span class="ruby-ivar">@request</span>.<span class="ruby-identifier">env</span>[<span class="ruby-value str">'CONTENT_TYPE'</span>] = <span class="ruby-constant">Mime</span><span class="ruby-operator">::</span><span class="ruby-constant">URL_ENCODED_FORM</span>.<span class="ruby-identifier">to_s</span>
169:     <span class="ruby-identifier">assert_nothing_raised</span> { <span class="ruby-identifier">xhr</span> <span class="ruby-identifier">:post</span>, <span class="ruby-identifier">:index</span> }
170:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M008202" class="method">
  <div id="M008202_title" class="title">
    <b>test_should_allow_xhr_post_without_token</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M008202_source')" id="l_M008202_source">show source</a> ]</p>
  <div id="M008202_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/request_forgery_protection_test.rb, line 155</span>
155:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_allow_xhr_post_without_token</span>
156:     <span class="ruby-identifier">assert_nothing_raised</span> { <span class="ruby-identifier">xhr</span> <span class="ruby-identifier">:post</span>, <span class="ruby-identifier">:index</span> }
157:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M008203" class="method">
  <div id="M008203_title" class="title">
    <b>test_should_allow_xhr_put_without_token</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M008203_source')" id="l_M008203_source">show source</a> ]</p>
  <div id="M008203_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/request_forgery_protection_test.rb, line 159</span>
159:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_allow_xhr_put_without_token</span>
160:     <span class="ruby-identifier">assert_nothing_raised</span> { <span class="ruby-identifier">xhr</span> <span class="ruby-identifier">:put</span>, <span class="ruby-identifier">:index</span> }
161:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M008201" class="method">
  <div id="M008201_title" class="title">
    <b>test_should_not_allow_api_formatted_delete_sent_as_multipart_form_without_token</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M008201_source')" id="l_M008201_source">show source</a> ]</p>
  <div id="M008201_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/request_forgery_protection_test.rb, line 148</span>
148:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_not_allow_api_formatted_delete_sent_as_multipart_form_without_token</span>
149:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActionController</span><span class="ruby-operator">::</span><span class="ruby-constant">InvalidAuthenticityToken</span>) <span class="ruby-keyword kw">do</span>
150:       <span class="ruby-ivar">@request</span>.<span class="ruby-identifier">env</span>[<span class="ruby-value str">'CONTENT_TYPE'</span>] = <span class="ruby-constant">Mime</span><span class="ruby-operator">::</span><span class="ruby-constant">MULTIPART_FORM</span>.<span class="ruby-identifier">to_s</span>
151:       <span class="ruby-identifier">delete</span> <span class="ruby-identifier">:index</span>, <span class="ruby-identifier">:format</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'xml'</span>
152:     <span class="ruby-keyword kw">end</span>
153:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M008198" class="method">
  <div id="M008198_title" class="title">
    <b>test_should_not_allow_api_formatted_delete_sent_as_url_encoded_form_without_token</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M008198_source')" id="l_M008198_source">show source</a> ]</p>
  <div id="M008198_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/request_forgery_protection_test.rb, line 127</span>
127:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_not_allow_api_formatted_delete_sent_as_url_encoded_form_without_token</span>
128:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActionController</span><span class="ruby-operator">::</span><span class="ruby-constant">InvalidAuthenticityToken</span>) <span class="ruby-keyword kw">do</span>
129:       <span class="ruby-ivar">@request</span>.<span class="ruby-identifier">env</span>[<span class="ruby-value str">'CONTENT_TYPE'</span>] = <span class="ruby-constant">Mime</span><span class="ruby-operator">::</span><span class="ruby-constant">URL_ENCODED_FORM</span>.<span class="ruby-identifier">to_s</span>
130:       <span class="ruby-identifier">delete</span> <span class="ruby-identifier">:index</span>, <span class="ruby-identifier">:format</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'xml'</span>
131:     <span class="ruby-keyword kw">end</span>
132:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M008199" class="method">
  <div id="M008199_title" class="title">
    <b>test_should_not_allow_api_formatted_post_sent_as_multipart_form_without_token</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M008199_source')" id="l_M008199_source">show source</a> ]</p>
  <div id="M008199_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/request_forgery_protection_test.rb, line 134</span>
134:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_not_allow_api_formatted_post_sent_as_multipart_form_without_token</span>
135:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActionController</span><span class="ruby-operator">::</span><span class="ruby-constant">InvalidAuthenticityToken</span>) <span class="ruby-keyword kw">do</span>
136:       <span class="ruby-ivar">@request</span>.<span class="ruby-identifier">env</span>[<span class="ruby-value str">'CONTENT_TYPE'</span>] = <span class="ruby-constant">Mime</span><span class="ruby-operator">::</span><span class="ruby-constant">MULTIPART_FORM</span>.<span class="ruby-identifier">to_s</span>
137:       <span class="ruby-identifier">post</span> <span class="ruby-identifier">:index</span>, <span class="ruby-identifier">:format</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'xml'</span>
138:     <span class="ruby-keyword kw">end</span>
139:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M008196" class="method">
  <div id="M008196_title" class="title">
    <b>test_should_not_allow_api_formatted_post_sent_as_url_encoded_form_without_token</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M008196_source')" id="l_M008196_source">show source</a> ]</p>
  <div id="M008196_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/request_forgery_protection_test.rb, line 113</span>
113:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_not_allow_api_formatted_post_sent_as_url_encoded_form_without_token</span>
114:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActionController</span><span class="ruby-operator">::</span><span class="ruby-constant">InvalidAuthenticityToken</span>) <span class="ruby-keyword kw">do</span>
115:       <span class="ruby-ivar">@request</span>.<span class="ruby-identifier">env</span>[<span class="ruby-value str">'CONTENT_TYPE'</span>] = <span class="ruby-constant">Mime</span><span class="ruby-operator">::</span><span class="ruby-constant">URL_ENCODED_FORM</span>.<span class="ruby-identifier">to_s</span>
116:       <span class="ruby-identifier">post</span> <span class="ruby-identifier">:index</span>, <span class="ruby-identifier">:format</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'xml'</span>
117:     <span class="ruby-keyword kw">end</span>
118:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M008200" class="method">
  <div id="M008200_title" class="title">
    <b>test_should_not_allow_api_formatted_put_sent_as_multipart_form_without_token</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M008200_source')" id="l_M008200_source">show source</a> ]</p>
  <div id="M008200_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/request_forgery_protection_test.rb, line 141</span>
141:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_not_allow_api_formatted_put_sent_as_multipart_form_without_token</span>
142:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActionController</span><span class="ruby-operator">::</span><span class="ruby-constant">InvalidAuthenticityToken</span>) <span class="ruby-keyword kw">do</span>
143:       <span class="ruby-ivar">@request</span>.<span class="ruby-identifier">env</span>[<span class="ruby-value str">'CONTENT_TYPE'</span>] = <span class="ruby-constant">Mime</span><span class="ruby-operator">::</span><span class="ruby-constant">MULTIPART_FORM</span>.<span class="ruby-identifier">to_s</span>
144:       <span class="ruby-identifier">put</span> <span class="ruby-identifier">:index</span>, <span class="ruby-identifier">:format</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'xml'</span>
145:     <span class="ruby-keyword kw">end</span>
146:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M008197" class="method">
  <div id="M008197_title" class="title">
    <b>test_should_not_allow_api_formatted_put_sent_as_url_encoded_form_without_token</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M008197_source')" id="l_M008197_source">show source</a> ]</p>
  <div id="M008197_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/request_forgery_protection_test.rb, line 120</span>
120:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_not_allow_api_formatted_put_sent_as_url_encoded_form_without_token</span>
121:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActionController</span><span class="ruby-operator">::</span><span class="ruby-constant">InvalidAuthenticityToken</span>) <span class="ruby-keyword kw">do</span>
122:       <span class="ruby-ivar">@request</span>.<span class="ruby-identifier">env</span>[<span class="ruby-value str">'CONTENT_TYPE'</span>] = <span class="ruby-constant">Mime</span><span class="ruby-operator">::</span><span class="ruby-constant">URL_ENCODED_FORM</span>.<span class="ruby-identifier">to_s</span>
123:       <span class="ruby-identifier">put</span> <span class="ruby-identifier">:index</span>, <span class="ruby-identifier">:format</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'xml'</span>
124:     <span class="ruby-keyword kw">end</span>
125:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M008194" class="method">
  <div id="M008194_title" class="title">
    <b>test_should_not_allow_api_formatted_put_without_token</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M008194_source')" id="l_M008194_source">show source</a> ]</p>
  <div id="M008194_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/request_forgery_protection_test.rb, line 101</span>
101:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_not_allow_api_formatted_put_without_token</span>
102:     <span class="ruby-identifier">assert_nothing_raised</span> <span class="ruby-keyword kw">do</span>
103:       <span class="ruby-identifier">put</span> <span class="ruby-identifier">:index</span>, <span class="ruby-identifier">:format</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'xml'</span>
104:     <span class="ruby-keyword kw">end</span>
105:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M008192" class="method">
  <div id="M008192_title" class="title">
    <b>test_should_not_allow_html_delete_without_token</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M008192_source')" id="l_M008192_source">show source</a> ]</p>
  <div id="M008192_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/request_forgery_protection_test.rb, line 90</span>
90:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_not_allow_html_delete_without_token</span>
91:     <span class="ruby-ivar">@request</span>.<span class="ruby-identifier">env</span>[<span class="ruby-value str">'CONTENT_TYPE'</span>] = <span class="ruby-constant">Mime</span><span class="ruby-operator">::</span><span class="ruby-constant">URL_ENCODED_FORM</span>.<span class="ruby-identifier">to_s</span>
92:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActionController</span><span class="ruby-operator">::</span><span class="ruby-constant">InvalidAuthenticityToken</span>) { <span class="ruby-identifier">delete</span> <span class="ruby-identifier">:index</span>, <span class="ruby-identifier">:format</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:html</span> }
93:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M008190" class="method">
  <div id="M008190_title" class="title">
    <b>test_should_not_allow_html_post_without_token</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M008190_source')" id="l_M008190_source">show source</a> ]</p>
  <div id="M008190_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/request_forgery_protection_test.rb, line 80</span>
80:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_not_allow_html_post_without_token</span>
81:     <span class="ruby-ivar">@request</span>.<span class="ruby-identifier">env</span>[<span class="ruby-value str">'CONTENT_TYPE'</span>] = <span class="ruby-constant">Mime</span><span class="ruby-operator">::</span><span class="ruby-constant">URL_ENCODED_FORM</span>.<span class="ruby-identifier">to_s</span>
82:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActionController</span><span class="ruby-operator">::</span><span class="ruby-constant">InvalidAuthenticityToken</span>) { <span class="ruby-identifier">post</span> <span class="ruby-identifier">:index</span>, <span class="ruby-identifier">:format</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:html</span> }
83:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M008191" class="method">
  <div id="M008191_title" class="title">
    <b>test_should_not_allow_html_put_without_token</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M008191_source')" id="l_M008191_source">show source</a> ]</p>
  <div id="M008191_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/request_forgery_protection_test.rb, line 85</span>
85:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_not_allow_html_put_without_token</span>
86:     <span class="ruby-ivar">@request</span>.<span class="ruby-identifier">env</span>[<span class="ruby-value str">'CONTENT_TYPE'</span>] = <span class="ruby-constant">Mime</span><span class="ruby-operator">::</span><span class="ruby-constant">URL_ENCODED_FORM</span>.<span class="ruby-identifier">to_s</span>
87:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActionController</span><span class="ruby-operator">::</span><span class="ruby-constant">InvalidAuthenticityToken</span>) { <span class="ruby-identifier">put</span> <span class="ruby-identifier">:index</span>, <span class="ruby-identifier">:format</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:html</span> }
88:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M008186" class="method">
  <div id="M008186_title" class="title">
    <b>test_should_render_button_to_with_token_tag</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M008186_source')" id="l_M008186_source">show source</a> ]</p>
  <div id="M008186_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/request_forgery_protection_test.rb, line 60</span>
60:    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_render_button_to_with_token_tag</span>
61:      <span class="ruby-identifier">get</span> <span class="ruby-identifier">:show_button</span>
62:      <span class="ruby-identifier">assert_select</span> <span class="ruby-value str">'form&gt;div&gt;input[name=?][value=?]'</span>, <span class="ruby-value str">'authenticity_token'</span>, <span class="ruby-ivar">@token</span>
63:    <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M008185" class="method">
  <div id="M008185_title" class="title">
    <b>test_should_render_form_with_token_tag</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M008185_source')" id="l_M008185_source">show source</a> ]</p>
  <div id="M008185_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/request_forgery_protection_test.rb, line 55</span>
55:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_render_form_with_token_tag</span>
56:      <span class="ruby-identifier">get</span> <span class="ruby-identifier">:index</span>
57:      <span class="ruby-identifier">assert_select</span> <span class="ruby-value str">'form&gt;div&gt;input[name=?][value=?]'</span>, <span class="ruby-value str">'authenticity_token'</span>, <span class="ruby-ivar">@token</span>
58:    <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M008187" class="method">
  <div id="M008187_title" class="title">
    <b>test_should_render_remote_form_with_only_one_token_parameter</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M008187_source')" id="l_M008187_source">show source</a> ]</p>
  <div id="M008187_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/request_forgery_protection_test.rb, line 65</span>
65:    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_render_remote_form_with_only_one_token_parameter</span>
66:      <span class="ruby-identifier">get</span> <span class="ruby-identifier">:remote_form</span>
67:      <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-ivar">@response</span>.<span class="ruby-identifier">body</span>.<span class="ruby-identifier">scan</span>(<span class="ruby-ivar">@token</span>).<span class="ruby-identifier">size</span>
68:    <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
</div>

  </div>