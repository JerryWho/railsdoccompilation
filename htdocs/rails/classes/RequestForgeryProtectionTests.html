  <div id="C00001280">
<div class='banner'>
  <span class="file-title-prefix">Module</span><br />RequestForgeryProtectionTests<br/>
  In:
<a href="#" onclick="jsHref('files/actionpack/test/controller/request_forgery_protection_test_rb.html');">actionpack/test/controller/request_forgery_protection_test.rb</a>

</div>
 <!-- banner header -->

  <div id="bodyContent" >
      <div id="content">

  <div class="description"><p>
common test methods
</p>
</div>



  <div class="sectiontitle">Methods</div>
  <ul>
  <li><a href="index.html?a=M008275&name=teardown" >teardown</a></li>
  <li><a href="index.html?a=M008286&name=test_should_allow_api_formatted_delete_without_token" >test_should_allow_api_formatted_delete_without_token</a></li>
  <li><a href="index.html?a=M008284&name=test_should_allow_api_formatted_post_without_token" >test_should_allow_api_formatted_post_without_token</a></li>
  <li><a href="index.html?a=M008299&name=test_should_allow_delete_with_token" >test_should_allow_delete_with_token</a></li>
  <li><a href="index.html?a=M008302&name=test_should_allow_delete_with_xml" >test_should_allow_delete_with_xml</a></li>
  <li><a href="index.html?a=M008279&name=test_should_allow_get" >test_should_allow_get</a></li>
  <li><a href="index.html?a=M008297&name=test_should_allow_post_with_token" >test_should_allow_post_with_token</a></li>
  <li><a href="index.html?a=M008300&name=test_should_allow_post_with_xml" >test_should_allow_post_with_xml</a></li>
  <li><a href="index.html?a=M008280&name=test_should_allow_post_without_token_on_unsafe_action" >test_should_allow_post_without_token_on_unsafe_action</a></li>
  <li><a href="index.html?a=M008298&name=test_should_allow_put_with_token" >test_should_allow_put_with_token</a></li>
  <li><a href="index.html?a=M008301&name=test_should_allow_put_with_xml" >test_should_allow_put_with_xml</a></li>
  <li><a href="index.html?a=M008295&name=test_should_allow_xhr_delete_without_token" >test_should_allow_xhr_delete_without_token</a></li>
  <li><a href="index.html?a=M008296&name=test_should_allow_xhr_post_with_encoded_form_content_type_without_token" >test_should_allow_xhr_post_with_encoded_form_content_type_without_token</a></li>
  <li><a href="index.html?a=M008293&name=test_should_allow_xhr_post_without_token" >test_should_allow_xhr_post_without_token</a></li>
  <li><a href="index.html?a=M008294&name=test_should_allow_xhr_put_without_token" >test_should_allow_xhr_put_without_token</a></li>
  <li><a href="index.html?a=M008292&name=test_should_not_allow_api_formatted_delete_sent_as_multipart_form_without_token" >test_should_not_allow_api_formatted_delete_sent_as_multipart_form_without_token</a></li>
  <li><a href="index.html?a=M008289&name=test_should_not_allow_api_formatted_delete_sent_as_url_encoded_form_without_token" >test_should_not_allow_api_formatted_delete_sent_as_url_encoded_form_without_token</a></li>
  <li><a href="index.html?a=M008290&name=test_should_not_allow_api_formatted_post_sent_as_multipart_form_without_token" >test_should_not_allow_api_formatted_post_sent_as_multipart_form_without_token</a></li>
  <li><a href="index.html?a=M008287&name=test_should_not_allow_api_formatted_post_sent_as_url_encoded_form_without_token" >test_should_not_allow_api_formatted_post_sent_as_url_encoded_form_without_token</a></li>
  <li><a href="index.html?a=M008291&name=test_should_not_allow_api_formatted_put_sent_as_multipart_form_without_token" >test_should_not_allow_api_formatted_put_sent_as_multipart_form_without_token</a></li>
  <li><a href="index.html?a=M008288&name=test_should_not_allow_api_formatted_put_sent_as_url_encoded_form_without_token" >test_should_not_allow_api_formatted_put_sent_as_url_encoded_form_without_token</a></li>
  <li><a href="index.html?a=M008285&name=test_should_not_allow_api_formatted_put_without_token" >test_should_not_allow_api_formatted_put_without_token</a></li>
  <li><a href="index.html?a=M008283&name=test_should_not_allow_html_delete_without_token" >test_should_not_allow_html_delete_without_token</a></li>
  <li><a href="index.html?a=M008281&name=test_should_not_allow_html_post_without_token" >test_should_not_allow_html_post_without_token</a></li>
  <li><a href="index.html?a=M008282&name=test_should_not_allow_html_put_without_token" >test_should_not_allow_html_put_without_token</a></li>
  <li><a href="index.html?a=M008277&name=test_should_render_button_to_with_token_tag" >test_should_render_button_to_with_token_tag</a></li>
  <li><a href="index.html?a=M008276&name=test_should_render_form_with_token_tag" >test_should_render_form_with_token_tag</a></li>
  <li><a href="index.html?a=M008278&name=test_should_render_remote_form_with_only_one_token_parameter" >test_should_render_remote_form_with_only_one_token_parameter</a></li>
  </ul>






<div class="sectiontitle">Public Instance methods</div>
<div id="M008275" class="method">
  <div id="M008275_title" class="title">
    <b>teardown</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M008275_source')" id="l_M008275_source">show source</a> ]</p>
  <div id="M008275_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/request_forgery_protection_test.rb, line 57</span>
57:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">teardown</span>
58:     <span class="ruby-constant">ActionController</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">request_forgery_protection_token</span> = <span class="ruby-keyword kw">nil</span>
59:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M008286" class="method">
  <div id="M008286_title" class="title">
    <b>test_should_allow_api_formatted_delete_without_token</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M008286_source')" id="l_M008286_source">show source</a> ]</p>
  <div id="M008286_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/request_forgery_protection_test.rb, line 114</span>
114:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_allow_api_formatted_delete_without_token</span>
115:     <span class="ruby-identifier">assert_nothing_raised</span> <span class="ruby-keyword kw">do</span>
116:       <span class="ruby-identifier">delete</span> <span class="ruby-identifier">:index</span>, <span class="ruby-identifier">:format</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'xml'</span>
117:     <span class="ruby-keyword kw">end</span>
118:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M008284" class="method">
  <div id="M008284_title" class="title">
    <b>test_should_allow_api_formatted_post_without_token</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M008284_source')" id="l_M008284_source">show source</a> ]</p>
  <div id="M008284_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/request_forgery_protection_test.rb, line 102</span>
102:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_allow_api_formatted_post_without_token</span>
103:     <span class="ruby-identifier">assert_nothing_raised</span> <span class="ruby-keyword kw">do</span>
104:       <span class="ruby-identifier">post</span> <span class="ruby-identifier">:index</span>, <span class="ruby-identifier">:format</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'xml'</span>
105:     <span class="ruby-keyword kw">end</span>
106:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M008299" class="method">
  <div id="M008299_title" class="title">
    <b>test_should_allow_delete_with_token</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M008299_source')" id="l_M008299_source">show source</a> ]</p>
  <div id="M008299_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/request_forgery_protection_test.rb, line 189</span>
189:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_allow_delete_with_token</span>
190:     <span class="ruby-identifier">delete</span> <span class="ruby-identifier">:index</span>, <span class="ruby-identifier">:authenticity_token</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@token</span>
191:     <span class="ruby-identifier">assert_response</span> <span class="ruby-identifier">:success</span>
192:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M008302" class="method">
  <div id="M008302_title" class="title">
    <b>test_should_allow_delete_with_xml</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M008302_source')" id="l_M008302_source">show source</a> ]</p>
  <div id="M008302_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/request_forgery_protection_test.rb, line 206</span>
206:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_allow_delete_with_xml</span>
207:     <span class="ruby-ivar">@request</span>.<span class="ruby-identifier">env</span>[<span class="ruby-value str">'CONTENT_TYPE'</span>] = <span class="ruby-constant">Mime</span><span class="ruby-operator">::</span><span class="ruby-constant">XML</span>.<span class="ruby-identifier">to_s</span>
208:     <span class="ruby-identifier">delete</span> <span class="ruby-identifier">:index</span>, <span class="ruby-identifier">:format</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'xml'</span>
209:     <span class="ruby-identifier">assert_response</span> <span class="ruby-identifier">:success</span>
210:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M008279" class="method">
  <div id="M008279_title" class="title">
    <b>test_should_allow_get</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M008279_source')" id="l_M008279_source">show source</a> ]</p>
  <div id="M008279_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/request_forgery_protection_test.rb, line 77</span>
77:    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_allow_get</span>
78:      <span class="ruby-identifier">get</span> <span class="ruby-identifier">:index</span>
79:      <span class="ruby-identifier">assert_response</span> <span class="ruby-identifier">:success</span>
80:    <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M008297" class="method">
  <div id="M008297_title" class="title">
    <b>test_should_allow_post_with_token</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M008297_source')" id="l_M008297_source">show source</a> ]</p>
  <div id="M008297_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/request_forgery_protection_test.rb, line 179</span>
179:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_allow_post_with_token</span>
180:     <span class="ruby-identifier">post</span> <span class="ruby-identifier">:index</span>, <span class="ruby-identifier">:authenticity_token</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@token</span>
181:     <span class="ruby-identifier">assert_response</span> <span class="ruby-identifier">:success</span>
182:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M008300" class="method">
  <div id="M008300_title" class="title">
    <b>test_should_allow_post_with_xml</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M008300_source')" id="l_M008300_source">show source</a> ]</p>
  <div id="M008300_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/request_forgery_protection_test.rb, line 194</span>
194:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_allow_post_with_xml</span>
195:     <span class="ruby-ivar">@request</span>.<span class="ruby-identifier">env</span>[<span class="ruby-value str">'CONTENT_TYPE'</span>] = <span class="ruby-constant">Mime</span><span class="ruby-operator">::</span><span class="ruby-constant">XML</span>.<span class="ruby-identifier">to_s</span>
196:     <span class="ruby-identifier">post</span> <span class="ruby-identifier">:index</span>, <span class="ruby-identifier">:format</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'xml'</span>
197:     <span class="ruby-identifier">assert_response</span> <span class="ruby-identifier">:success</span>
198:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M008280" class="method">
  <div id="M008280_title" class="title">
    <b>test_should_allow_post_without_token_on_unsafe_action</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M008280_source')" id="l_M008280_source">show source</a> ]</p>
  <div id="M008280_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/request_forgery_protection_test.rb, line 82</span>
82:    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_allow_post_without_token_on_unsafe_action</span>
83:      <span class="ruby-identifier">post</span> <span class="ruby-identifier">:unsafe</span>
84:      <span class="ruby-identifier">assert_response</span> <span class="ruby-identifier">:success</span>
85:    <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M008298" class="method">
  <div id="M008298_title" class="title">
    <b>test_should_allow_put_with_token</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M008298_source')" id="l_M008298_source">show source</a> ]</p>
  <div id="M008298_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/request_forgery_protection_test.rb, line 184</span>
184:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_allow_put_with_token</span>
185:     <span class="ruby-identifier">put</span> <span class="ruby-identifier">:index</span>, <span class="ruby-identifier">:authenticity_token</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@token</span>
186:     <span class="ruby-identifier">assert_response</span> <span class="ruby-identifier">:success</span>
187:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M008301" class="method">
  <div id="M008301_title" class="title">
    <b>test_should_allow_put_with_xml</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M008301_source')" id="l_M008301_source">show source</a> ]</p>
  <div id="M008301_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/request_forgery_protection_test.rb, line 200</span>
200:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_allow_put_with_xml</span>
201:     <span class="ruby-ivar">@request</span>.<span class="ruby-identifier">env</span>[<span class="ruby-value str">'CONTENT_TYPE'</span>] = <span class="ruby-constant">Mime</span><span class="ruby-operator">::</span><span class="ruby-constant">XML</span>.<span class="ruby-identifier">to_s</span>
202:     <span class="ruby-identifier">put</span> <span class="ruby-identifier">:index</span>, <span class="ruby-identifier">:format</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'xml'</span>
203:     <span class="ruby-identifier">assert_response</span> <span class="ruby-identifier">:success</span>
204:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M008295" class="method">
  <div id="M008295_title" class="title">
    <b>test_should_allow_xhr_delete_without_token</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M008295_source')" id="l_M008295_source">show source</a> ]</p>
  <div id="M008295_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/request_forgery_protection_test.rb, line 170</span>
170:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_allow_xhr_delete_without_token</span>
171:     <span class="ruby-identifier">assert_nothing_raised</span> { <span class="ruby-identifier">xhr</span> <span class="ruby-identifier">:delete</span>, <span class="ruby-identifier">:index</span> }
172:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M008296" class="method">
  <div id="M008296_title" class="title">
    <b>test_should_allow_xhr_post_with_encoded_form_content_type_without_token</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M008296_source')" id="l_M008296_source">show source</a> ]</p>
  <div id="M008296_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/request_forgery_protection_test.rb, line 174</span>
174:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_allow_xhr_post_with_encoded_form_content_type_without_token</span>
175:     <span class="ruby-ivar">@request</span>.<span class="ruby-identifier">env</span>[<span class="ruby-value str">'CONTENT_TYPE'</span>] = <span class="ruby-constant">Mime</span><span class="ruby-operator">::</span><span class="ruby-constant">URL_ENCODED_FORM</span>.<span class="ruby-identifier">to_s</span>
176:     <span class="ruby-identifier">assert_nothing_raised</span> { <span class="ruby-identifier">xhr</span> <span class="ruby-identifier">:post</span>, <span class="ruby-identifier">:index</span> }
177:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M008293" class="method">
  <div id="M008293_title" class="title">
    <b>test_should_allow_xhr_post_without_token</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M008293_source')" id="l_M008293_source">show source</a> ]</p>
  <div id="M008293_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/request_forgery_protection_test.rb, line 162</span>
162:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_allow_xhr_post_without_token</span>
163:     <span class="ruby-identifier">assert_nothing_raised</span> { <span class="ruby-identifier">xhr</span> <span class="ruby-identifier">:post</span>, <span class="ruby-identifier">:index</span> }
164:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M008294" class="method">
  <div id="M008294_title" class="title">
    <b>test_should_allow_xhr_put_without_token</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M008294_source')" id="l_M008294_source">show source</a> ]</p>
  <div id="M008294_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/request_forgery_protection_test.rb, line 166</span>
166:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_allow_xhr_put_without_token</span>
167:     <span class="ruby-identifier">assert_nothing_raised</span> { <span class="ruby-identifier">xhr</span> <span class="ruby-identifier">:put</span>, <span class="ruby-identifier">:index</span> }
168:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M008292" class="method">
  <div id="M008292_title" class="title">
    <b>test_should_not_allow_api_formatted_delete_sent_as_multipart_form_without_token</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M008292_source')" id="l_M008292_source">show source</a> ]</p>
  <div id="M008292_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/request_forgery_protection_test.rb, line 155</span>
155:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_not_allow_api_formatted_delete_sent_as_multipart_form_without_token</span>
156:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActionController</span><span class="ruby-operator">::</span><span class="ruby-constant">InvalidAuthenticityToken</span>) <span class="ruby-keyword kw">do</span>
157:       <span class="ruby-ivar">@request</span>.<span class="ruby-identifier">env</span>[<span class="ruby-value str">'CONTENT_TYPE'</span>] = <span class="ruby-constant">Mime</span><span class="ruby-operator">::</span><span class="ruby-constant">MULTIPART_FORM</span>.<span class="ruby-identifier">to_s</span>
158:       <span class="ruby-identifier">delete</span> <span class="ruby-identifier">:index</span>, <span class="ruby-identifier">:format</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'xml'</span>
159:     <span class="ruby-keyword kw">end</span>
160:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M008289" class="method">
  <div id="M008289_title" class="title">
    <b>test_should_not_allow_api_formatted_delete_sent_as_url_encoded_form_without_token</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M008289_source')" id="l_M008289_source">show source</a> ]</p>
  <div id="M008289_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/request_forgery_protection_test.rb, line 134</span>
134:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_not_allow_api_formatted_delete_sent_as_url_encoded_form_without_token</span>
135:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActionController</span><span class="ruby-operator">::</span><span class="ruby-constant">InvalidAuthenticityToken</span>) <span class="ruby-keyword kw">do</span>
136:       <span class="ruby-ivar">@request</span>.<span class="ruby-identifier">env</span>[<span class="ruby-value str">'CONTENT_TYPE'</span>] = <span class="ruby-constant">Mime</span><span class="ruby-operator">::</span><span class="ruby-constant">URL_ENCODED_FORM</span>.<span class="ruby-identifier">to_s</span>
137:       <span class="ruby-identifier">delete</span> <span class="ruby-identifier">:index</span>, <span class="ruby-identifier">:format</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'xml'</span>
138:     <span class="ruby-keyword kw">end</span>
139:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M008290" class="method">
  <div id="M008290_title" class="title">
    <b>test_should_not_allow_api_formatted_post_sent_as_multipart_form_without_token</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M008290_source')" id="l_M008290_source">show source</a> ]</p>
  <div id="M008290_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/request_forgery_protection_test.rb, line 141</span>
141:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_not_allow_api_formatted_post_sent_as_multipart_form_without_token</span>
142:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActionController</span><span class="ruby-operator">::</span><span class="ruby-constant">InvalidAuthenticityToken</span>) <span class="ruby-keyword kw">do</span>
143:       <span class="ruby-ivar">@request</span>.<span class="ruby-identifier">env</span>[<span class="ruby-value str">'CONTENT_TYPE'</span>] = <span class="ruby-constant">Mime</span><span class="ruby-operator">::</span><span class="ruby-constant">MULTIPART_FORM</span>.<span class="ruby-identifier">to_s</span>
144:       <span class="ruby-identifier">post</span> <span class="ruby-identifier">:index</span>, <span class="ruby-identifier">:format</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'xml'</span>
145:     <span class="ruby-keyword kw">end</span>
146:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M008287" class="method">
  <div id="M008287_title" class="title">
    <b>test_should_not_allow_api_formatted_post_sent_as_url_encoded_form_without_token</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M008287_source')" id="l_M008287_source">show source</a> ]</p>
  <div id="M008287_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/request_forgery_protection_test.rb, line 120</span>
120:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_not_allow_api_formatted_post_sent_as_url_encoded_form_without_token</span>
121:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActionController</span><span class="ruby-operator">::</span><span class="ruby-constant">InvalidAuthenticityToken</span>) <span class="ruby-keyword kw">do</span>
122:       <span class="ruby-ivar">@request</span>.<span class="ruby-identifier">env</span>[<span class="ruby-value str">'CONTENT_TYPE'</span>] = <span class="ruby-constant">Mime</span><span class="ruby-operator">::</span><span class="ruby-constant">URL_ENCODED_FORM</span>.<span class="ruby-identifier">to_s</span>
123:       <span class="ruby-identifier">post</span> <span class="ruby-identifier">:index</span>, <span class="ruby-identifier">:format</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'xml'</span>
124:     <span class="ruby-keyword kw">end</span>
125:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M008291" class="method">
  <div id="M008291_title" class="title">
    <b>test_should_not_allow_api_formatted_put_sent_as_multipart_form_without_token</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M008291_source')" id="l_M008291_source">show source</a> ]</p>
  <div id="M008291_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/request_forgery_protection_test.rb, line 148</span>
148:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_not_allow_api_formatted_put_sent_as_multipart_form_without_token</span>
149:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActionController</span><span class="ruby-operator">::</span><span class="ruby-constant">InvalidAuthenticityToken</span>) <span class="ruby-keyword kw">do</span>
150:       <span class="ruby-ivar">@request</span>.<span class="ruby-identifier">env</span>[<span class="ruby-value str">'CONTENT_TYPE'</span>] = <span class="ruby-constant">Mime</span><span class="ruby-operator">::</span><span class="ruby-constant">MULTIPART_FORM</span>.<span class="ruby-identifier">to_s</span>
151:       <span class="ruby-identifier">put</span> <span class="ruby-identifier">:index</span>, <span class="ruby-identifier">:format</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'xml'</span>
152:     <span class="ruby-keyword kw">end</span>
153:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M008288" class="method">
  <div id="M008288_title" class="title">
    <b>test_should_not_allow_api_formatted_put_sent_as_url_encoded_form_without_token</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M008288_source')" id="l_M008288_source">show source</a> ]</p>
  <div id="M008288_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/request_forgery_protection_test.rb, line 127</span>
127:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_not_allow_api_formatted_put_sent_as_url_encoded_form_without_token</span>
128:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActionController</span><span class="ruby-operator">::</span><span class="ruby-constant">InvalidAuthenticityToken</span>) <span class="ruby-keyword kw">do</span>
129:       <span class="ruby-ivar">@request</span>.<span class="ruby-identifier">env</span>[<span class="ruby-value str">'CONTENT_TYPE'</span>] = <span class="ruby-constant">Mime</span><span class="ruby-operator">::</span><span class="ruby-constant">URL_ENCODED_FORM</span>.<span class="ruby-identifier">to_s</span>
130:       <span class="ruby-identifier">put</span> <span class="ruby-identifier">:index</span>, <span class="ruby-identifier">:format</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'xml'</span>
131:     <span class="ruby-keyword kw">end</span>
132:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M008285" class="method">
  <div id="M008285_title" class="title">
    <b>test_should_not_allow_api_formatted_put_without_token</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M008285_source')" id="l_M008285_source">show source</a> ]</p>
  <div id="M008285_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/request_forgery_protection_test.rb, line 108</span>
108:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_not_allow_api_formatted_put_without_token</span>
109:     <span class="ruby-identifier">assert_nothing_raised</span> <span class="ruby-keyword kw">do</span>
110:       <span class="ruby-identifier">put</span> <span class="ruby-identifier">:index</span>, <span class="ruby-identifier">:format</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'xml'</span>
111:     <span class="ruby-keyword kw">end</span>
112:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M008283" class="method">
  <div id="M008283_title" class="title">
    <b>test_should_not_allow_html_delete_without_token</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M008283_source')" id="l_M008283_source">show source</a> ]</p>
  <div id="M008283_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/request_forgery_protection_test.rb, line 97</span>
 97:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_not_allow_html_delete_without_token</span>
 98:     <span class="ruby-ivar">@request</span>.<span class="ruby-identifier">env</span>[<span class="ruby-value str">'CONTENT_TYPE'</span>] = <span class="ruby-constant">Mime</span><span class="ruby-operator">::</span><span class="ruby-constant">URL_ENCODED_FORM</span>.<span class="ruby-identifier">to_s</span>
 99:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActionController</span><span class="ruby-operator">::</span><span class="ruby-constant">InvalidAuthenticityToken</span>) { <span class="ruby-identifier">delete</span> <span class="ruby-identifier">:index</span>, <span class="ruby-identifier">:format</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:html</span> }
100:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M008281" class="method">
  <div id="M008281_title" class="title">
    <b>test_should_not_allow_html_post_without_token</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M008281_source')" id="l_M008281_source">show source</a> ]</p>
  <div id="M008281_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/request_forgery_protection_test.rb, line 87</span>
87:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_not_allow_html_post_without_token</span>
88:     <span class="ruby-ivar">@request</span>.<span class="ruby-identifier">env</span>[<span class="ruby-value str">'CONTENT_TYPE'</span>] = <span class="ruby-constant">Mime</span><span class="ruby-operator">::</span><span class="ruby-constant">URL_ENCODED_FORM</span>.<span class="ruby-identifier">to_s</span>
89:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActionController</span><span class="ruby-operator">::</span><span class="ruby-constant">InvalidAuthenticityToken</span>) { <span class="ruby-identifier">post</span> <span class="ruby-identifier">:index</span>, <span class="ruby-identifier">:format</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:html</span> }
90:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M008282" class="method">
  <div id="M008282_title" class="title">
    <b>test_should_not_allow_html_put_without_token</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M008282_source')" id="l_M008282_source">show source</a> ]</p>
  <div id="M008282_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/request_forgery_protection_test.rb, line 92</span>
92:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_not_allow_html_put_without_token</span>
93:     <span class="ruby-ivar">@request</span>.<span class="ruby-identifier">env</span>[<span class="ruby-value str">'CONTENT_TYPE'</span>] = <span class="ruby-constant">Mime</span><span class="ruby-operator">::</span><span class="ruby-constant">URL_ENCODED_FORM</span>.<span class="ruby-identifier">to_s</span>
94:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActionController</span><span class="ruby-operator">::</span><span class="ruby-constant">InvalidAuthenticityToken</span>) { <span class="ruby-identifier">put</span> <span class="ruby-identifier">:index</span>, <span class="ruby-identifier">:format</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:html</span> }
95:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M008277" class="method">
  <div id="M008277_title" class="title">
    <b>test_should_render_button_to_with_token_tag</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M008277_source')" id="l_M008277_source">show source</a> ]</p>
  <div id="M008277_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/request_forgery_protection_test.rb, line 67</span>
67:    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_render_button_to_with_token_tag</span>
68:      <span class="ruby-identifier">get</span> <span class="ruby-identifier">:show_button</span>
69:      <span class="ruby-identifier">assert_select</span> <span class="ruby-value str">'form&gt;div&gt;input[name=?][value=?]'</span>, <span class="ruby-value str">'authenticity_token'</span>, <span class="ruby-ivar">@token</span>
70:    <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M008276" class="method">
  <div id="M008276_title" class="title">
    <b>test_should_render_form_with_token_tag</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M008276_source')" id="l_M008276_source">show source</a> ]</p>
  <div id="M008276_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/request_forgery_protection_test.rb, line 62</span>
62:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_render_form_with_token_tag</span>
63:      <span class="ruby-identifier">get</span> <span class="ruby-identifier">:index</span>
64:      <span class="ruby-identifier">assert_select</span> <span class="ruby-value str">'form&gt;div&gt;input[name=?][value=?]'</span>, <span class="ruby-value str">'authenticity_token'</span>, <span class="ruby-ivar">@token</span>
65:    <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M008278" class="method">
  <div id="M008278_title" class="title">
    <b>test_should_render_remote_form_with_only_one_token_parameter</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M008278_source')" id="l_M008278_source">show source</a> ]</p>
  <div id="M008278_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/request_forgery_protection_test.rb, line 72</span>
72:    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_render_remote_form_with_only_one_token_parameter</span>
73:      <span class="ruby-identifier">get</span> <span class="ruby-identifier">:remote_form</span>
74:      <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-ivar">@response</span>.<span class="ruby-identifier">body</span>.<span class="ruby-identifier">scan</span>(<span class="ruby-ivar">@token</span>).<span class="ruby-identifier">size</span>
75:    <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
</div>

  </div>