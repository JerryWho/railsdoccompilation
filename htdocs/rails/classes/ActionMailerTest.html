  <div id="C00000347">
<div class='banner'>
  <span class="file-title-prefix">Class</span><br />ActionMailerTest<br/>
  In:
<a href="#" onclick="jsHref('files/actionmailer/test/mail_service_test_rb.html');">actionmailer/test/mail_service_test.rb</a>

Parent:&nbsp;
Test::Unit::TestCase
</div>
 <!-- banner header -->

  <div id="bodyContent" >
      <div id="content">




  <div class="sectiontitle">Methods</div>
  <ul>
  <li><a href="index.html?a=M002266&name=encode" >encode</a></li>
  <li><a href="index.html?a=M002267&name=new_mail" >new_mail</a></li>
  <li><a href="index.html?a=M002268&name=setup" >setup</a></li>
  <li><a href="index.html?a=M002269&name=teardown" >teardown</a></li>
  <li><a href="index.html?a=M002300&name=test_attachment_using_content_location" >test_attachment_using_content_location</a></li>
  <li><a href="index.html?a=M002272&name=test_attachment_with_custom_header" >test_attachment_with_custom_header</a></li>
  <li><a href="index.html?a=M002301&name=test_attachment_with_text_type" >test_attachment_with_text_type</a></li>
  <li><a href="index.html?a=M002332&name=test_body_is_stored_as_an_ivar" >test_body_is_stored_as_an_ivar</a></li>
  <li><a href="index.html?a=M002276&name=test_cancelled_account" >test_cancelled_account</a></li>
  <li><a href="index.html?a=M002277&name=test_cc_bcc" >test_cc_bcc</a></li>
  <li><a href="index.html?a=M002329&name=test_custom_content_type_attributes" >test_custom_content_type_attributes</a></li>
  <li><a href="index.html?a=M002274&name=test_custom_template" >test_custom_template</a></li>
  <li><a href="index.html?a=M002275&name=test_custom_templating_extension" >test_custom_templating_extension</a></li>
  <li><a href="index.html?a=M002299&name=test_decode_attachment_without_charset" >test_decode_attachment_without_charset</a></li>
  <li><a href="index.html?a=M002322&name=test_decode_encoded_attachment_filename" >test_decode_encoded_attachment_filename</a></li>
  <li><a href="index.html?a=M002304&name=test_decode_message_with_incorrect_charset" >test_decode_message_with_incorrect_charset</a></li>
  <li><a href="index.html?a=M002324&name=test_decode_message_with_unknown_charset" >test_decode_message_with_unknown_charset</a></li>
  <li><a href="index.html?a=M002303&name=test_decode_message_without_content_type" >test_decode_message_without_content_type</a></li>
  <li><a href="index.html?a=M002302&name=test_decode_part_without_content_type" >test_decode_part_without_content_type</a></li>
  <li><a href="index.html?a=M002327&name=test_deliver_with_mail_object" >test_deliver_with_mail_object</a></li>
  <li><a href="index.html?a=M002284&name=test_deliveries_array" >test_deliveries_array</a></li>
  <li><a href="index.html?a=M002288&name=test_delivery_logs_sent_mail" >test_delivery_logs_sent_mail</a></li>
  <li><a href="index.html?a=M002286&name=test_doesnt_raise_errors_when_raise_delivery_errors_is_false" >test_doesnt_raise_errors_when_raise_delivery_errors_is_false</a></li>
  <li><a href="index.html?a=M002325&name=test_empty_header_values_omitted" >test_empty_header_values_omitted</a></li>
  <li><a href="index.html?a=M002308&name=test_explicitly_multipart_messages" >test_explicitly_multipart_messages</a></li>
  <li><a href="index.html?a=M002309&name=test_explicitly_multipart_with_content_type" >test_explicitly_multipart_with_content_type</a></li>
  <li><a href="index.html?a=M002310&name=test_explicitly_multipart_with_invalid_content_type" >test_explicitly_multipart_with_invalid_content_type</a></li>
  <li><a href="index.html?a=M002294&name=test_extended_headers" >test_extended_headers</a></li>
  <li><a href="index.html?a=M002279&name=test_from_with_name_for_smtp" >test_from_with_name_for_smtp</a></li>
  <li><a href="index.html?a=M002278&name=test_from_without_name_for_smtp" >test_from_without_name_for_smtp</a></li>
  <li><a href="index.html?a=M002320&name=test_headers_removed_on_smtp_delivery" >test_headers_removed_on_smtp_delivery</a></li>
  <li><a href="index.html?a=M002326&name=test_headers_with_nonalpha_chars" >test_headers_with_nonalpha_chars</a></li>
  <li><a href="index.html?a=M002316&name=test_html_mail" >test_html_mail</a></li>
  <li><a href="index.html?a=M002317&name=test_html_mail_with_underscores" >test_html_mail_with_underscores</a></li>
  <li><a href="index.html?a=M002311&name=test_implicitly_multipart_messages" >test_implicitly_multipart_messages</a></li>
  <li><a href="index.html?a=M002314&name=test_implicitly_multipart_messages_run_from_another_location_with_a_rails_root" >test_implicitly_multipart_messages_run_from_another_location_with_a_rails_root</a></li>
  <li><a href="index.html?a=M002315&name=test_implicitly_multipart_messages_with_charset" >test_implicitly_multipart_messages_with_charset</a></li>
  <li><a href="index.html?a=M002312&name=test_implicitly_multipart_messages_with_custom_order" >test_implicitly_multipart_messages_with_custom_order</a></li>
  <li><a href="index.html?a=M002307&name=test_implicitly_multipart_with_utf8" >test_implicitly_multipart_with_utf8</a></li>
  <li><a href="index.html?a=M002313&name=test_implicitly_path_when_running_from_none_rails_root" >test_implicitly_path_when_running_from_none_rails_root</a></li>
  <li><a href="index.html?a=M002283&name=test_instances_are_nil" >test_instances_are_nil</a></li>
  <li><a href="index.html?a=M002281&name=test_iso_charset" >test_iso_charset</a></li>
  <li><a href="index.html?a=M002305&name=test_multipart_with_mime_version" >test_multipart_with_mime_version</a></li>
  <li><a href="index.html?a=M002328&name=test_multipart_with_template_path_with_dots" >test_multipart_with_template_path_with_dots</a></li>
  <li><a href="index.html?a=M002306&name=test_multipart_with_utf8_subject" >test_multipart_with_utf8_subject</a></li>
  <li><a href="index.html?a=M002296&name=test_multiple_utf8_recipients" >test_multiple_utf8_recipients</a></li>
  <li><a href="index.html?a=M002270&name=test_nested_parts" >test_nested_parts</a></li>
  <li><a href="index.html?a=M002271&name=test_nested_parts_with_body" >test_nested_parts_with_body</a></li>
  <li><a href="index.html?a=M002285&name=test_perform_deliveries_flag" >test_perform_deliveries_flag</a></li>
  <li><a href="index.html?a=M002287&name=test_performs_delivery_via_sendmail" >test_performs_delivery_via_sendmail</a></li>
  <li><a href="index.html?a=M002298&name=test_receive_attachments" >test_receive_attachments</a></li>
  <li><a href="index.html?a=M002297&name=test_receive_decodes_base64_encoded_mail" >test_receive_decodes_base64_encoded_mail</a></li>
  <li><a href="index.html?a=M002321&name=test_recursive_multipart_processing" >test_recursive_multipart_processing</a></li>
  <li><a href="index.html?a=M002280&name=test_reply_to" >test_reply_to</a></li>
  <li><a href="index.html?a=M002330&name=test_return_path_with_create" >test_return_path_with_create</a></li>
  <li><a href="index.html?a=M002331&name=test_return_path_with_deliver" >test_return_path_with_deliver</a></li>
  <li><a href="index.html?a=M002273&name=test_signed_up" >test_signed_up</a></li>
  <li><a href="index.html?a=M002334&name=test_starttls_is_disabled_if_not_supported" >test_starttls_is_disabled_if_not_supported</a></li>
  <li><a href="index.html?a=M002333&name=test_starttls_is_enabled_if_supported" >test_starttls_is_enabled_if_supported</a></li>
  <li><a href="index.html?a=M002335&name=test_starttls_is_not_enabled" >test_starttls_is_not_enabled</a></li>
  <li><a href="index.html?a=M002282&name=test_unencoded_subject" >test_unencoded_subject</a></li>
  <li><a href="index.html?a=M002291&name=test_unquote_7bit_body" >test_unquote_7bit_body</a></li>
  <li><a href="index.html?a=M002290&name=test_unquote_7bit_subject" >test_unquote_7bit_subject</a></li>
  <li><a href="index.html?a=M002293&name=test_unquote_base64_body" >test_unquote_base64_body</a></li>
  <li><a href="index.html?a=M002292&name=test_unquote_quoted_printable_body" >test_unquote_quoted_printable_body</a></li>
  <li><a href="index.html?a=M002289&name=test_unquote_quoted_printable_subject" >test_unquote_quoted_printable_subject</a></li>
  <li><a href="index.html?a=M002295&name=test_utf8_body_is_not_quoted" >test_utf8_body_is_not_quoted</a></li>
  <li><a href="index.html?a=M002318&name=test_various_newlines" >test_various_newlines</a></li>
  <li><a href="index.html?a=M002319&name=test_various_newlines_multipart" >test_various_newlines_multipart</a></li>
  <li><a href="index.html?a=M002323&name=test_wrong_mail_header" >test_wrong_mail_header</a></li>
  </ul>

<div class="sectiontitle">Included Modules</div>
<ul>
  <li><a href="#" onclick="jsHref('');">ActionMailer::Quoting</a></li>
</ul>





<div class="sectiontitle">Public Instance methods</div>
<div id="M002266" class="method">
  <div id="M002266_title" class="title">
    <b>encode</b>( text, charset=&quot;utf-8&quot; )
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002266_source')" id="l_M002266_source">show source</a> ]</p>
  <div id="M002266_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 306</span>
306:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">encode</span>( <span class="ruby-identifier">text</span>, <span class="ruby-identifier">charset</span>=<span class="ruby-value str">&quot;utf-8&quot;</span> )
307:     <span class="ruby-identifier">quoted_printable</span>( <span class="ruby-identifier">text</span>, <span class="ruby-identifier">charset</span> )
308:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002267" class="method">
  <div id="M002267_title" class="title">
    <b>new_mail</b>( charset=&quot;utf-8&quot; )
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002267_source')" id="l_M002267_source">show source</a> ]</p>
  <div id="M002267_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 310</span>
310:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">new_mail</span>( <span class="ruby-identifier">charset</span>=<span class="ruby-value str">&quot;utf-8&quot;</span> )
311:     <span class="ruby-identifier">mail</span> = <span class="ruby-constant">TMail</span><span class="ruby-operator">::</span><span class="ruby-constant">Mail</span>.<span class="ruby-identifier">new</span>
312:     <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">mime_version</span> = <span class="ruby-value str">&quot;1.0&quot;</span>
313:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">charset</span>
314:       <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">set_content_type</span> <span class="ruby-value str">&quot;text&quot;</span>, <span class="ruby-value str">&quot;plain&quot;</span>, { <span class="ruby-value str">&quot;charset&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">charset</span> }
315:     <span class="ruby-keyword kw">end</span>
316:     <span class="ruby-identifier">mail</span>
317:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002268" class="method">
  <div id="M002268_title" class="title">
    <b>setup</b>()
  </div>
  <div class="description">
  <p>
Replacing logger work around for mocha bug. Should be fixed in mocha 0.3.3
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002268_source')" id="l_M002268_source">show source</a> ]</p>
  <div id="M002268_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 320</span>
320:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">setup</span>
321:     <span class="ruby-identifier">set_delivery_method</span> <span class="ruby-identifier">:test</span>
322:     <span class="ruby-constant">ActionMailer</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">perform_deliveries</span> = <span class="ruby-keyword kw">true</span>
323:     <span class="ruby-constant">ActionMailer</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">raise_delivery_errors</span> = <span class="ruby-keyword kw">true</span>
324:     <span class="ruby-constant">ActionMailer</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">deliveries</span> = []
325: 
326:     <span class="ruby-ivar">@original_logger</span> = <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">logger</span>
327:     <span class="ruby-ivar">@recipient</span> = <span class="ruby-value str">'test@localhost'</span>
328:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002269" class="method">
  <div id="M002269_title" class="title">
    <b>teardown</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002269_source')" id="l_M002269_source">show source</a> ]</p>
  <div id="M002269_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 330</span>
330:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">teardown</span>
331:     <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">logger</span> = <span class="ruby-ivar">@original_logger</span>
332:     <span class="ruby-identifier">restore_delivery_method</span>
333:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002300" class="method">
  <div id="M002300_title" class="title">
    <b>test_attachment_using_content_location</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002300_source')" id="l_M002300_source">show source</a> ]</p>
  <div id="M002300_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 767</span>
767:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_attachment_using_content_location</span>
768:     <span class="ruby-identifier">fixture</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>(<span class="ruby-keyword kw">__FILE__</span>) <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;/fixtures/raw_email12&quot;</span>)
769:     <span class="ruby-identifier">mail</span> = <span class="ruby-constant">TMail</span><span class="ruby-operator">::</span><span class="ruby-constant">Mail</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">fixture</span>)
770:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">attachments</span>.<span class="ruby-identifier">length</span>
771:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;Photo25.jpg&quot;</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">attachments</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">original_filename</span>
772:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002272" class="method">
  <div id="M002272_title" class="title">
    <b>test_attachment_with_custom_header</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002272_source')" id="l_M002272_source">show source</a> ]</p>
  <div id="M002272_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 363</span>
363:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_attachment_with_custom_header</span>
364:     <span class="ruby-identifier">created</span> = <span class="ruby-keyword kw">nil</span>
365:     <span class="ruby-identifier">assert_nothing_raised</span> { <span class="ruby-identifier">created</span> = <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">create_attachment_with_custom_header</span>(<span class="ruby-ivar">@recipient</span>)}
366:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;&lt;test@test.com&gt;&quot;</span>, <span class="ruby-identifier">created</span>.<span class="ruby-identifier">parts</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">header</span>[<span class="ruby-value str">'content-id'</span>].<span class="ruby-identifier">to_s</span>
367:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002301" class="method">
  <div id="M002301_title" class="title">
    <b>test_attachment_with_text_type</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002301_source')" id="l_M002301_source">show source</a> ]</p>
  <div id="M002301_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 774</span>
774:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_attachment_with_text_type</span>
775:     <span class="ruby-identifier">fixture</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>(<span class="ruby-keyword kw">__FILE__</span>) <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;/fixtures/raw_email13&quot;</span>)
776:     <span class="ruby-identifier">mail</span> = <span class="ruby-constant">TMail</span><span class="ruby-operator">::</span><span class="ruby-constant">Mail</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">fixture</span>)
777:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">has_attachments?</span>
778:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">attachments</span>.<span class="ruby-identifier">length</span>
779:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;hello.rb&quot;</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">attachments</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">original_filename</span>
780:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002332" class="method">
  <div id="M002332_title" class="title">
    <b>test_body_is_stored_as_an_ivar</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002332_source')" id="l_M002332_source">show source</a> ]</p>
  <div id="M002332_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 1007</span>
1007:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_body_is_stored_as_an_ivar</span>
1008:     <span class="ruby-identifier">mail</span> = <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">create_body_ivar</span>(<span class="ruby-ivar">@recipient</span>)
1009:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;body: foo\nbar: baz&quot;</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">body</span>
1010:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002276" class="method">
  <div id="M002276_title" class="title">
    <b>test_cancelled_account</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002276_source')" id="l_M002276_source">show source</a> ]</p>
  <div id="M002276_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 426</span>
426:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_cancelled_account</span>
427:     <span class="ruby-identifier">expected</span> = <span class="ruby-identifier">new_mail</span>
428:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">to</span>      = <span class="ruby-ivar">@recipient</span>
429:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">subject</span> = <span class="ruby-node">&quot;[Cancelled] Goodbye #{@recipient}&quot;</span>
430:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">body</span>    = <span class="ruby-node">&quot;Goodbye, Mr. #{@recipient}&quot;</span>
431:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">from</span>    = <span class="ruby-value str">&quot;system@loudthinking.com&quot;</span>
432:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">date</span>    = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">local</span>(<span class="ruby-value">2004</span>, <span class="ruby-value">12</span>, <span class="ruby-value">12</span>)
433: 
434:     <span class="ruby-identifier">created</span> = <span class="ruby-keyword kw">nil</span>
435:     <span class="ruby-identifier">assert_nothing_raised</span> { <span class="ruby-identifier">created</span> = <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">create_cancelled_account</span>(<span class="ruby-ivar">@recipient</span>) }
436:     <span class="ruby-identifier">assert_not_nil</span> <span class="ruby-identifier">created</span>
437:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">encoded</span>, <span class="ruby-identifier">created</span>.<span class="ruby-identifier">encoded</span>
438: 
439:     <span class="ruby-identifier">assert_nothing_raised</span> { <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">deliver_cancelled_account</span>(<span class="ruby-ivar">@recipient</span>) }
440:     <span class="ruby-identifier">assert_not_nil</span> <span class="ruby-constant">ActionMailer</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">deliveries</span>.<span class="ruby-identifier">first</span>
441:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">encoded</span>, <span class="ruby-constant">ActionMailer</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">deliveries</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">encoded</span>
442:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002277" class="method">
  <div id="M002277_title" class="title">
    <b>test_cc_bcc</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002277_source')" id="l_M002277_source">show source</a> ]</p>
  <div id="M002277_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 444</span>
444:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_cc_bcc</span>
445:     <span class="ruby-identifier">expected</span> = <span class="ruby-identifier">new_mail</span>
446:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">to</span>      = <span class="ruby-ivar">@recipient</span>
447:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">subject</span> = <span class="ruby-value str">&quot;testing bcc/cc&quot;</span>
448:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">body</span>    = <span class="ruby-value str">&quot;Nothing to see here.&quot;</span>
449:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">from</span>    = <span class="ruby-value str">&quot;system@loudthinking.com&quot;</span>
450:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">cc</span>      = <span class="ruby-value str">&quot;nobody@loudthinking.com&quot;</span>
451:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">bcc</span>     = <span class="ruby-value str">&quot;root@loudthinking.com&quot;</span>
452:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">date</span>    = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">local</span> <span class="ruby-value">2004</span>, <span class="ruby-value">12</span>, <span class="ruby-value">12</span>
453: 
454:     <span class="ruby-identifier">created</span> = <span class="ruby-keyword kw">nil</span>
455:     <span class="ruby-identifier">assert_nothing_raised</span> <span class="ruby-keyword kw">do</span>
456:       <span class="ruby-identifier">created</span> = <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">create_cc_bcc</span> <span class="ruby-ivar">@recipient</span>
457:     <span class="ruby-keyword kw">end</span>
458:     <span class="ruby-identifier">assert_not_nil</span> <span class="ruby-identifier">created</span>
459:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">encoded</span>, <span class="ruby-identifier">created</span>.<span class="ruby-identifier">encoded</span>
460: 
461:     <span class="ruby-identifier">assert_nothing_raised</span> <span class="ruby-keyword kw">do</span>
462:       <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">deliver_cc_bcc</span> <span class="ruby-ivar">@recipient</span>
463:     <span class="ruby-keyword kw">end</span>
464: 
465:     <span class="ruby-identifier">assert_not_nil</span> <span class="ruby-constant">ActionMailer</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">deliveries</span>.<span class="ruby-identifier">first</span>
466:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">encoded</span>, <span class="ruby-constant">ActionMailer</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">deliveries</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">encoded</span>
467:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002329" class="method">
  <div id="M002329_title" class="title">
    <b>test_custom_content_type_attributes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002329_source')" id="l_M002329_source">show source</a> ]</p>
  <div id="M002329_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 989</span>
989:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_custom_content_type_attributes</span>
990:     <span class="ruby-identifier">mail</span> = <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">create_custom_content_type_attributes</span>
991:     <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp re">%r{format=flowed}</span>, <span class="ruby-identifier">mail</span>[<span class="ruby-value str">'content-type'</span>].<span class="ruby-identifier">to_s</span>
992:     <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp re">%r{charset=utf-8}</span>, <span class="ruby-identifier">mail</span>[<span class="ruby-value str">'content-type'</span>].<span class="ruby-identifier">to_s</span>
993:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002274" class="method">
  <div id="M002274_title" class="title">
    <b>test_custom_template</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002274_source')" id="l_M002274_source">show source</a> ]</p>
  <div id="M002274_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 389</span>
389:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_custom_template</span>
390:     <span class="ruby-identifier">expected</span> = <span class="ruby-identifier">new_mail</span>
391:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">to</span>      = <span class="ruby-ivar">@recipient</span>
392:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">subject</span> = <span class="ruby-node">&quot;[Signed up] Welcome #{@recipient}&quot;</span>
393:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">body</span>    = <span class="ruby-node">&quot;Hello there, \n\nMr. #{@recipient}&quot;</span>
394:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">from</span>    = <span class="ruby-value str">&quot;system@loudthinking.com&quot;</span>
395:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">date</span>    = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">local</span>(<span class="ruby-value">2004</span>, <span class="ruby-value">12</span>, <span class="ruby-value">12</span>)
396: 
397:     <span class="ruby-identifier">created</span> = <span class="ruby-keyword kw">nil</span>
398:     <span class="ruby-identifier">assert_nothing_raised</span> { <span class="ruby-identifier">created</span> = <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">create_custom_template</span>(<span class="ruby-ivar">@recipient</span>) }
399:     <span class="ruby-identifier">assert_not_nil</span> <span class="ruby-identifier">created</span>
400:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">encoded</span>, <span class="ruby-identifier">created</span>.<span class="ruby-identifier">encoded</span>
401:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002275" class="method">
  <div id="M002275_title" class="title">
    <b>test_custom_templating_extension</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002275_source')" id="l_M002275_source">show source</a> ]</p>
  <div id="M002275_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 403</span>
403:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_custom_templating_extension</span>
404:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">ActionView</span><span class="ruby-operator">::</span><span class="ruby-constant">Template</span>.<span class="ruby-identifier">template_handler_extensions</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-value str">&quot;haml&quot;</span>), <span class="ruby-value str">&quot;haml extension was not registered&quot;</span>
405: 
406:     <span class="ruby-comment cmt"># N.b., custom_templating_extension.text.plain.haml is expected to be in fixtures/test_mailer directory</span>
407:     <span class="ruby-identifier">expected</span> = <span class="ruby-identifier">new_mail</span>
408:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">to</span>      = <span class="ruby-ivar">@recipient</span>
409:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">subject</span> = <span class="ruby-node">&quot;[Signed up] Welcome #{@recipient}&quot;</span>
410:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">body</span>    = <span class="ruby-node">&quot;Hello there, \n\nMr. #{@recipient}&quot;</span>
411:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">from</span>    = <span class="ruby-value str">&quot;system@loudthinking.com&quot;</span>
412:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">date</span>    = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">local</span>(<span class="ruby-value">2004</span>, <span class="ruby-value">12</span>, <span class="ruby-value">12</span>)
413: 
414:     <span class="ruby-comment cmt"># Stub the render method so no alternative renderers need be present.</span>
415:     <span class="ruby-constant">ActionView</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">any_instance</span>.<span class="ruby-identifier">stubs</span>(<span class="ruby-identifier">:render</span>).<span class="ruby-identifier">returns</span>(<span class="ruby-node">&quot;Hello there, \n\nMr. #{@recipient}&quot;</span>)
416: 
417:     <span class="ruby-comment cmt"># Now that the template is registered, there should be one part. The text/plain part.</span>
418:     <span class="ruby-identifier">created</span> = <span class="ruby-keyword kw">nil</span>
419:     <span class="ruby-identifier">assert_nothing_raised</span> { <span class="ruby-identifier">created</span> = <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">create_custom_templating_extension</span>(<span class="ruby-ivar">@recipient</span>) }
420:     <span class="ruby-identifier">assert_not_nil</span> <span class="ruby-identifier">created</span>
421:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-identifier">created</span>.<span class="ruby-identifier">parts</span>.<span class="ruby-identifier">length</span>
422:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'text/plain'</span>, <span class="ruby-identifier">created</span>.<span class="ruby-identifier">parts</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">content_type</span>
423:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'text/html'</span>, <span class="ruby-identifier">created</span>.<span class="ruby-identifier">parts</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">content_type</span>
424:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002299" class="method">
  <div id="M002299_title" class="title">
    <b>test_decode_attachment_without_charset</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002299_source')" id="l_M002299_source">show source</a> ]</p>
  <div id="M002299_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 760</span>
760:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_decode_attachment_without_charset</span>
761:     <span class="ruby-identifier">fixture</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>(<span class="ruby-keyword kw">__FILE__</span>) <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;/fixtures/raw_email3&quot;</span>)
762:     <span class="ruby-identifier">mail</span> = <span class="ruby-constant">TMail</span><span class="ruby-operator">::</span><span class="ruby-constant">Mail</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">fixture</span>)
763:     <span class="ruby-identifier">attachment</span> = <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">attachments</span>.<span class="ruby-identifier">last</span>
764:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1026</span>, <span class="ruby-identifier">attachment</span>.<span class="ruby-identifier">read</span>.<span class="ruby-identifier">length</span>
765:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002322" class="method">
  <div id="M002322_title" class="title">
    <b>test_decode_encoded_attachment_filename</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002322_source')" id="l_M002322_source">show source</a> ]</p>
  <div id="M002322_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 938</span>
938:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_decode_encoded_attachment_filename</span>
939:     <span class="ruby-identifier">fixture</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>(<span class="ruby-keyword kw">__FILE__</span>) <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;/fixtures/raw_email8&quot;</span>)
940:     <span class="ruby-identifier">mail</span> = <span class="ruby-constant">TMail</span><span class="ruby-operator">::</span><span class="ruby-constant">Mail</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">fixture</span>)
941:     <span class="ruby-identifier">attachment</span> = <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">attachments</span>.<span class="ruby-identifier">last</span>
942: 
943:     <span class="ruby-identifier">expected</span> = <span class="ruby-value str">&quot;01 Quien Te Dij\212at. Pitbull.mp3&quot;</span>
944:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">force_encoding</span>(<span class="ruby-constant">Encoding</span><span class="ruby-operator">::</span><span class="ruby-constant">ASCII_8BIT</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:force_encoding</span>)
945: 
946:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">expected</span>, <span class="ruby-identifier">attachment</span>.<span class="ruby-identifier">original_filename</span>
947:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002304" class="method">
  <div id="M002304_title" class="title">
    <b>test_decode_message_with_incorrect_charset</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002304_source')" id="l_M002304_source">show source</a> ]</p>
  <div id="M002304_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 794</span>
794:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_decode_message_with_incorrect_charset</span>
795:     <span class="ruby-identifier">fixture</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>(<span class="ruby-keyword kw">__FILE__</span>) <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;/fixtures/raw_email6&quot;</span>)
796:     <span class="ruby-identifier">mail</span> = <span class="ruby-constant">TMail</span><span class="ruby-operator">::</span><span class="ruby-constant">Mail</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">fixture</span>)
797:     <span class="ruby-identifier">assert_nothing_raised</span> { <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">body</span> }
798:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002324" class="method">
  <div id="M002324_title" class="title">
    <b>test_decode_message_with_unknown_charset</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002324_source')" id="l_M002324_source">show source</a> ]</p>
  <div id="M002324_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 954</span>
954:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_decode_message_with_unknown_charset</span>
955:     <span class="ruby-identifier">fixture</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>(<span class="ruby-keyword kw">__FILE__</span>) <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;/fixtures/raw_email10&quot;</span>)
956:     <span class="ruby-identifier">mail</span> = <span class="ruby-constant">TMail</span><span class="ruby-operator">::</span><span class="ruby-constant">Mail</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">fixture</span>)
957:     <span class="ruby-identifier">assert_nothing_raised</span> { <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">body</span> }
958:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002303" class="method">
  <div id="M002303_title" class="title">
    <b>test_decode_message_without_content_type</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002303_source')" id="l_M002303_source">show source</a> ]</p>
  <div id="M002303_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 788</span>
788:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_decode_message_without_content_type</span>
789:     <span class="ruby-identifier">fixture</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>(<span class="ruby-keyword kw">__FILE__</span>) <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;/fixtures/raw_email5&quot;</span>)
790:     <span class="ruby-identifier">mail</span> = <span class="ruby-constant">TMail</span><span class="ruby-operator">::</span><span class="ruby-constant">Mail</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">fixture</span>)
791:     <span class="ruby-identifier">assert_nothing_raised</span> { <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">body</span> }
792:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002302" class="method">
  <div id="M002302_title" class="title">
    <b>test_decode_part_without_content_type</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002302_source')" id="l_M002302_source">show source</a> ]</p>
  <div id="M002302_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 782</span>
782:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_decode_part_without_content_type</span>
783:     <span class="ruby-identifier">fixture</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>(<span class="ruby-keyword kw">__FILE__</span>) <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;/fixtures/raw_email4&quot;</span>)
784:     <span class="ruby-identifier">mail</span> = <span class="ruby-constant">TMail</span><span class="ruby-operator">::</span><span class="ruby-constant">Mail</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">fixture</span>)
785:     <span class="ruby-identifier">assert_nothing_raised</span> { <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">body</span> }
786:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002327" class="method">
  <div id="M002327_title" class="title">
    <b>test_deliver_with_mail_object</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002327_source')" id="l_M002327_source">show source</a> ]</p>
  <div id="M002327_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 976</span>
976:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_deliver_with_mail_object</span>
977:     <span class="ruby-identifier">mail</span> = <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">create_headers_with_nonalpha_chars</span>(<span class="ruby-ivar">@recipient</span>)
978:     <span class="ruby-identifier">assert_nothing_raised</span> { <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">deliver</span>(<span class="ruby-identifier">mail</span>) }
979:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">deliveries</span>.<span class="ruby-identifier">length</span>
980:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002284" class="method">
  <div id="M002284_title" class="title">
    <b>test_deliveries_array</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002284_source')" id="l_M002284_source">show source</a> ]</p>
  <div id="M002284_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 571</span>
571:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_deliveries_array</span>
572:     <span class="ruby-identifier">assert_not_nil</span> <span class="ruby-constant">ActionMailer</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">deliveries</span>
573:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-constant">ActionMailer</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">deliveries</span>.<span class="ruby-identifier">size</span>
574:     <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">deliver_signed_up</span>(<span class="ruby-ivar">@recipient</span>)
575:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-constant">ActionMailer</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">deliveries</span>.<span class="ruby-identifier">size</span>
576:     <span class="ruby-identifier">assert_not_nil</span> <span class="ruby-constant">ActionMailer</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">deliveries</span>.<span class="ruby-identifier">first</span>
577:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002288" class="method">
  <div id="M002288_title" class="title">
    <b>test_delivery_logs_sent_mail</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002288_source')" id="l_M002288_source">show source</a> ]</p>
  <div id="M002288_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 603</span>
603:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_delivery_logs_sent_mail</span>
604:     <span class="ruby-identifier">mail</span> = <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">create_signed_up</span>(<span class="ruby-ivar">@recipient</span>)
605:     <span class="ruby-identifier">logger</span> = <span class="ruby-identifier">mock</span>()
606:     <span class="ruby-identifier">logger</span>.<span class="ruby-identifier">expects</span>(<span class="ruby-identifier">:info</span>).<span class="ruby-identifier">with</span>(<span class="ruby-node">&quot;Sent mail to #{@recipient}&quot;</span>)
607:     <span class="ruby-identifier">logger</span>.<span class="ruby-identifier">expects</span>(<span class="ruby-identifier">:debug</span>).<span class="ruby-identifier">with</span>() <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">logged_text</span><span class="ruby-operator">|</span>
608:       <span class="ruby-identifier">logged_text</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/\[Signed up\] Welcome/</span>
609:     <span class="ruby-keyword kw">end</span>
610:     <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">logger</span> = <span class="ruby-identifier">logger</span>
611:     <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">deliver_signed_up</span>(<span class="ruby-ivar">@recipient</span>)
612:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002286" class="method">
  <div id="M002286_title" class="title">
    <b>test_doesnt_raise_errors_when_raise_delivery_errors_is_false</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002286_source')" id="l_M002286_source">show source</a> ]</p>
  <div id="M002286_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 588</span>
588:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_doesnt_raise_errors_when_raise_delivery_errors_is_false</span>
589:     <span class="ruby-constant">ActionMailer</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">raise_delivery_errors</span> = <span class="ruby-keyword kw">false</span>
590:     <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">any_instance</span>.<span class="ruby-identifier">expects</span>(<span class="ruby-identifier">:perform_delivery_test</span>).<span class="ruby-identifier">raises</span>(<span class="ruby-constant">Exception</span>)
591:     <span class="ruby-identifier">assert_nothing_raised</span> { <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">deliver_signed_up</span>(<span class="ruby-ivar">@recipient</span>) }
592:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002325" class="method">
  <div id="M002325_title" class="title">
    <b>test_empty_header_values_omitted</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002325_source')" id="l_M002325_source">show source</a> ]</p>
  <div id="M002325_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 960</span>
960:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_empty_header_values_omitted</span>
961:     <span class="ruby-identifier">result</span> = <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">create_unnamed_attachment</span>(<span class="ruby-ivar">@recipient</span>).<span class="ruby-identifier">encoded</span>
962:     <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp re">%r{Content-Type: application/octet-stream[^;]}</span>, <span class="ruby-identifier">result</span>
963:     <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp re">%r{Content-Disposition: attachment[^;]}</span>, <span class="ruby-identifier">result</span>
964:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002308" class="method">
  <div id="M002308_title" class="title">
    <b>test_explicitly_multipart_messages</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002308_source')" id="l_M002308_source">show source</a> ]</p>
  <div id="M002308_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 815</span>
815:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_explicitly_multipart_messages</span>
816:     <span class="ruby-identifier">mail</span> = <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">create_explicitly_multipart_example</span>(<span class="ruby-ivar">@recipient</span>)
817:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">3</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">parts</span>.<span class="ruby-identifier">length</span>
818:     <span class="ruby-identifier">assert_nil</span> <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">content_type</span>
819:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;text/plain&quot;</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">parts</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">content_type</span>
820: 
821:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;text/html&quot;</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">parts</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">content_type</span>
822:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;iso-8859-1&quot;</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">parts</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">sub_header</span>(<span class="ruby-value str">&quot;content-type&quot;</span>, <span class="ruby-value str">&quot;charset&quot;</span>)
823:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;inline&quot;</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">parts</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">content_disposition</span>
824: 
825:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;image/jpeg&quot;</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">parts</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">content_type</span>
826:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;attachment&quot;</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">parts</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">content_disposition</span>
827:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;foo.jpg&quot;</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">parts</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">sub_header</span>(<span class="ruby-value str">&quot;content-disposition&quot;</span>, <span class="ruby-value str">&quot;filename&quot;</span>)
828:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;foo.jpg&quot;</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">parts</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">sub_header</span>(<span class="ruby-value str">&quot;content-type&quot;</span>, <span class="ruby-value str">&quot;name&quot;</span>)
829:     <span class="ruby-identifier">assert_nil</span> <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">parts</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">sub_header</span>(<span class="ruby-value str">&quot;content-type&quot;</span>, <span class="ruby-value str">&quot;charset&quot;</span>)
830:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002309" class="method">
  <div id="M002309_title" class="title">
    <b>test_explicitly_multipart_with_content_type</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002309_source')" id="l_M002309_source">show source</a> ]</p>
  <div id="M002309_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 832</span>
832:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_explicitly_multipart_with_content_type</span>
833:     <span class="ruby-identifier">mail</span> = <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">create_explicitly_multipart_example</span>(<span class="ruby-ivar">@recipient</span>, <span class="ruby-value str">&quot;multipart/alternative&quot;</span>)
834:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">3</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">parts</span>.<span class="ruby-identifier">length</span>
835:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;multipart/alternative&quot;</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">content_type</span>
836:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002310" class="method">
  <div id="M002310_title" class="title">
    <b>test_explicitly_multipart_with_invalid_content_type</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002310_source')" id="l_M002310_source">show source</a> ]</p>
  <div id="M002310_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 838</span>
838:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_explicitly_multipart_with_invalid_content_type</span>
839:     <span class="ruby-identifier">mail</span> = <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">create_explicitly_multipart_example</span>(<span class="ruby-ivar">@recipient</span>, <span class="ruby-value str">&quot;text/xml&quot;</span>)
840:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">3</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">parts</span>.<span class="ruby-identifier">length</span>
841:     <span class="ruby-identifier">assert_nil</span> <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">content_type</span>
842:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002294" class="method">
  <div id="M002294_title" class="title">
    <b>test_extended_headers</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002294_source')" id="l_M002294_source">show source</a> ]</p>
  <div id="M002294_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 687</span>
687:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_extended_headers</span>
688:     <span class="ruby-ivar">@recipient</span> = <span class="ruby-value str">&quot;Grytyr &lt;test@localhost&gt;&quot;</span>
689: 
690:     <span class="ruby-identifier">expected</span> = <span class="ruby-identifier">new_mail</span> <span class="ruby-value str">&quot;iso-8859-1&quot;</span>
691:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">to</span>      = <span class="ruby-identifier">quote_address_if_necessary</span> <span class="ruby-ivar">@recipient</span>, <span class="ruby-value str">&quot;iso-8859-1&quot;</span>
692:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">subject</span> = <span class="ruby-value str">&quot;testing extended headers&quot;</span>
693:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">body</span>    = <span class="ruby-value str">&quot;Nothing to see here.&quot;</span>
694:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">from</span>    = <span class="ruby-identifier">quote_address_if_necessary</span> <span class="ruby-value str">&quot;Grytyr &lt;stian1@example.net&gt;&quot;</span>, <span class="ruby-value str">&quot;iso-8859-1&quot;</span>
695:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">cc</span>      = <span class="ruby-identifier">quote_address_if_necessary</span> <span class="ruby-value str">&quot;Grytyr &lt;stian2@example.net&gt;&quot;</span>, <span class="ruby-value str">&quot;iso-8859-1&quot;</span>
696:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">bcc</span>     = <span class="ruby-identifier">quote_address_if_necessary</span> <span class="ruby-value str">&quot;Grytyr &lt;stian3@example.net&gt;&quot;</span>, <span class="ruby-value str">&quot;iso-8859-1&quot;</span>
697:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">date</span>    = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">local</span> <span class="ruby-value">2004</span>, <span class="ruby-value">12</span>, <span class="ruby-value">12</span>
698: 
699:     <span class="ruby-identifier">created</span> = <span class="ruby-keyword kw">nil</span>
700:     <span class="ruby-identifier">assert_nothing_raised</span> <span class="ruby-keyword kw">do</span>
701:       <span class="ruby-identifier">created</span> = <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">create_extended_headers</span> <span class="ruby-ivar">@recipient</span>
702:     <span class="ruby-keyword kw">end</span>
703: 
704:     <span class="ruby-identifier">assert_not_nil</span> <span class="ruby-identifier">created</span>
705:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">encoded</span>, <span class="ruby-identifier">created</span>.<span class="ruby-identifier">encoded</span>
706: 
707:     <span class="ruby-identifier">assert_nothing_raised</span> <span class="ruby-keyword kw">do</span>
708:       <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">deliver_extended_headers</span> <span class="ruby-ivar">@recipient</span>
709:     <span class="ruby-keyword kw">end</span>
710: 
711:     <span class="ruby-identifier">assert_not_nil</span> <span class="ruby-constant">ActionMailer</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">deliveries</span>.<span class="ruby-identifier">first</span>
712:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">encoded</span>, <span class="ruby-constant">ActionMailer</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">deliveries</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">encoded</span>
713:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002279" class="method">
  <div id="M002279_title" class="title">
    <b>test_from_with_name_for_smtp</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002279_source')" id="l_M002279_source">show source</a> ]</p>
  <div id="M002279_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 480</span>
480:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_from_with_name_for_smtp</span>
481:     <span class="ruby-constant">ActionMailer</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">delivery_method</span> = <span class="ruby-identifier">:smtp</span>
482:     <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">deliver_from_with_name</span>
483: 
484:     <span class="ruby-identifier">mail</span> = <span class="ruby-constant">MockSMTP</span>.<span class="ruby-identifier">deliveries</span>.<span class="ruby-identifier">first</span>
485:     <span class="ruby-identifier">assert_not_nil</span> <span class="ruby-identifier">mail</span>
486:     <span class="ruby-identifier">mail</span>, <span class="ruby-identifier">from</span>, <span class="ruby-identifier">to</span> = <span class="ruby-identifier">mail</span>
487: 
488:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'system@loudthinking.com'</span>, <span class="ruby-identifier">from</span>.<span class="ruby-identifier">to_s</span>
489:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002278" class="method">
  <div id="M002278_title" class="title">
    <b>test_from_without_name_for_smtp</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002278_source')" id="l_M002278_source">show source</a> ]</p>
  <div id="M002278_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 469</span>
469:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_from_without_name_for_smtp</span>
470:     <span class="ruby-constant">ActionMailer</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">delivery_method</span> = <span class="ruby-identifier">:smtp</span>
471:     <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">deliver_from_without_name</span>
472: 
473:     <span class="ruby-identifier">mail</span> = <span class="ruby-constant">MockSMTP</span>.<span class="ruby-identifier">deliveries</span>.<span class="ruby-identifier">first</span>
474:     <span class="ruby-identifier">assert_not_nil</span> <span class="ruby-identifier">mail</span>
475:     <span class="ruby-identifier">mail</span>, <span class="ruby-identifier">from</span>, <span class="ruby-identifier">to</span> = <span class="ruby-identifier">mail</span>
476: 
477:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'system@loudthinking.com'</span>, <span class="ruby-identifier">from</span>.<span class="ruby-identifier">to_s</span>
478:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002320" class="method">
  <div id="M002320_title" class="title">
    <b>test_headers_removed_on_smtp_delivery</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002320_source')" id="l_M002320_source">show source</a> ]</p>
  <div id="M002320_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 921</span>
921:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_headers_removed_on_smtp_delivery</span>
922:     <span class="ruby-constant">ActionMailer</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">delivery_method</span> = <span class="ruby-identifier">:smtp</span>
923:     <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">deliver_cc_bcc</span>(<span class="ruby-ivar">@recipient</span>)
924:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">MockSMTP</span>.<span class="ruby-identifier">deliveries</span>[<span class="ruby-value">0</span>][<span class="ruby-value">2</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-value str">&quot;root@loudthinking.com&quot;</span>)
925:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">MockSMTP</span>.<span class="ruby-identifier">deliveries</span>[<span class="ruby-value">0</span>][<span class="ruby-value">2</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-value str">&quot;nobody@loudthinking.com&quot;</span>)
926:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">MockSMTP</span>.<span class="ruby-identifier">deliveries</span>[<span class="ruby-value">0</span>][<span class="ruby-value">2</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-ivar">@recipient</span>)
927:     <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp re">%r{^Cc: nobody@loudthinking.com}</span>, <span class="ruby-constant">MockSMTP</span>.<span class="ruby-identifier">deliveries</span>[<span class="ruby-value">0</span>][<span class="ruby-value">0</span>]
928:     <span class="ruby-identifier">assert_match</span> <span class="ruby-node">%r{^To: #{@recipient}}</span>, <span class="ruby-constant">MockSMTP</span>.<span class="ruby-identifier">deliveries</span>[<span class="ruby-value">0</span>][<span class="ruby-value">0</span>]
929:     <span class="ruby-identifier">assert_no_match</span> <span class="ruby-regexp re">%r{^Bcc: root@loudthinking.com}</span>, <span class="ruby-constant">MockSMTP</span>.<span class="ruby-identifier">deliveries</span>[<span class="ruby-value">0</span>][<span class="ruby-value">0</span>]
930:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002326" class="method">
  <div id="M002326_title" class="title">
    <b>test_headers_with_nonalpha_chars</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002326_source')" id="l_M002326_source">show source</a> ]</p>
  <div id="M002326_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 966</span>
966:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_headers_with_nonalpha_chars</span>
967:     <span class="ruby-identifier">mail</span> = <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">create_headers_with_nonalpha_chars</span>(<span class="ruby-ivar">@recipient</span>)
968:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">mail</span>.<span class="ruby-identifier">from_addrs</span>.<span class="ruby-identifier">empty?</span>
969:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">mail</span>.<span class="ruby-identifier">cc_addrs</span>.<span class="ruby-identifier">empty?</span>
970:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">mail</span>.<span class="ruby-identifier">bcc_addrs</span>.<span class="ruby-identifier">empty?</span>
971:     <span class="ruby-identifier">assert_match</span>(<span class="ruby-regexp re">/:/</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">from_addrs</span>.<span class="ruby-identifier">to_s</span>)
972:     <span class="ruby-identifier">assert_match</span>(<span class="ruby-regexp re">/:/</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">cc_addrs</span>.<span class="ruby-identifier">to_s</span>)
973:     <span class="ruby-identifier">assert_match</span>(<span class="ruby-regexp re">/:/</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">bcc_addrs</span>.<span class="ruby-identifier">to_s</span>)
974:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002316" class="method">
  <div id="M002316_title" class="title">
    <b>test_html_mail</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002316_source')" id="l_M002316_source">show source</a> ]</p>
  <div id="M002316_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 899</span>
899:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_html_mail</span>
900:     <span class="ruby-identifier">mail</span> = <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">create_html_mail</span>(<span class="ruby-ivar">@recipient</span>)
901:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;text/html&quot;</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">content_type</span>
902:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002317" class="method">
  <div id="M002317_title" class="title">
    <b>test_html_mail_with_underscores</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002317_source')" id="l_M002317_source">show source</a> ]</p>
  <div id="M002317_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 904</span>
904:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_html_mail_with_underscores</span>
905:     <span class="ruby-identifier">mail</span> = <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">create_html_mail_with_underscores</span>(<span class="ruby-ivar">@recipient</span>)
906:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">%{&lt;a href=&quot;http://google.com&quot; target=&quot;_blank&quot;&gt;_Google&lt;/a&gt;}</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">body</span>
907:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002311" class="method">
  <div id="M002311_title" class="title">
    <b>test_implicitly_multipart_messages</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002311_source')" id="l_M002311_source">show source</a> ]</p>
  <div id="M002311_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 844</span>
844:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_implicitly_multipart_messages</span>
845:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">ActionView</span><span class="ruby-operator">::</span><span class="ruby-constant">Template</span>.<span class="ruby-identifier">template_handler_extensions</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-value str">&quot;bak&quot;</span>), <span class="ruby-value str">&quot;bak extension was not registered&quot;</span>
846: 
847:     <span class="ruby-identifier">mail</span> = <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">create_implicitly_multipart_example</span>(<span class="ruby-ivar">@recipient</span>)
848:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">3</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">parts</span>.<span class="ruby-identifier">length</span>
849:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;1.0&quot;</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">mime_version</span>
850:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;multipart/alternative&quot;</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">content_type</span>
851:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;text/yaml&quot;</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">parts</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">content_type</span>
852:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;utf-8&quot;</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">parts</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">sub_header</span>(<span class="ruby-value str">&quot;content-type&quot;</span>, <span class="ruby-value str">&quot;charset&quot;</span>)
853:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;text/plain&quot;</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">parts</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">content_type</span>
854:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;utf-8&quot;</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">parts</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">sub_header</span>(<span class="ruby-value str">&quot;content-type&quot;</span>, <span class="ruby-value str">&quot;charset&quot;</span>)
855:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;text/html&quot;</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">parts</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">content_type</span>
856:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;utf-8&quot;</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">parts</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">sub_header</span>(<span class="ruby-value str">&quot;content-type&quot;</span>, <span class="ruby-value str">&quot;charset&quot;</span>)
857:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002314" class="method">
  <div id="M002314_title" class="title">
    <b>test_implicitly_multipart_messages_run_from_another_location_with_a_rails_root</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002314_source')" id="l_M002314_source">show source</a> ]</p>
  <div id="M002314_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 880</span>
880:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_implicitly_multipart_messages_run_from_another_location_with_a_rails_root</span>
881:     <span class="ruby-identifier">with_a_rails_root</span> <span class="ruby-keyword kw">do</span>
882:       <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">chdir</span> <span class="ruby-value str">&quot;/&quot;</span> <span class="ruby-keyword kw">do</span>
883:         <span class="ruby-identifier">mail</span> = <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">create_implicitly_multipart_example</span>(<span class="ruby-ivar">@recipient</span>)
884:         <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">3</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">parts</span>.<span class="ruby-identifier">length</span>
885:       <span class="ruby-keyword kw">end</span>
886:     <span class="ruby-keyword kw">end</span>
887:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002315" class="method">
  <div id="M002315_title" class="title">
    <b>test_implicitly_multipart_messages_with_charset</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002315_source')" id="l_M002315_source">show source</a> ]</p>
  <div id="M002315_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 889</span>
889:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_implicitly_multipart_messages_with_charset</span>
890:     <span class="ruby-identifier">mail</span> = <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">create_implicitly_multipart_example</span>(<span class="ruby-ivar">@recipient</span>, <span class="ruby-value str">'iso-8859-1'</span>)
891: 
892:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;multipart/alternative&quot;</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">header</span>[<span class="ruby-value str">'content-type'</span>].<span class="ruby-identifier">body</span>
893: 
894:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'iso-8859-1'</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">parts</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">sub_header</span>(<span class="ruby-value str">&quot;content-type&quot;</span>, <span class="ruby-value str">&quot;charset&quot;</span>)
895:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'iso-8859-1'</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">parts</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">sub_header</span>(<span class="ruby-value str">&quot;content-type&quot;</span>, <span class="ruby-value str">&quot;charset&quot;</span>)
896:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'iso-8859-1'</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">parts</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">sub_header</span>(<span class="ruby-value str">&quot;content-type&quot;</span>, <span class="ruby-value str">&quot;charset&quot;</span>)
897:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002312" class="method">
  <div id="M002312_title" class="title">
    <b>test_implicitly_multipart_messages_with_custom_order</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002312_source')" id="l_M002312_source">show source</a> ]</p>
  <div id="M002312_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 859</span>
859:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_implicitly_multipart_messages_with_custom_order</span>
860:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">ActionView</span><span class="ruby-operator">::</span><span class="ruby-constant">Template</span>.<span class="ruby-identifier">template_handler_extensions</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-value str">&quot;bak&quot;</span>), <span class="ruby-value str">&quot;bak extension was not registered&quot;</span>
861: 
862:     <span class="ruby-identifier">mail</span> = <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">create_implicitly_multipart_example</span>(<span class="ruby-ivar">@recipient</span>, <span class="ruby-keyword kw">nil</span>, [<span class="ruby-value str">&quot;text/yaml&quot;</span>, <span class="ruby-value str">&quot;text/plain&quot;</span>])
863:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">3</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">parts</span>.<span class="ruby-identifier">length</span>
864:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;text/html&quot;</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">parts</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">content_type</span>
865:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;text/plain&quot;</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">parts</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">content_type</span>
866:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;text/yaml&quot;</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">parts</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">content_type</span>
867:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002307" class="method">
  <div id="M002307_title" class="title">
    <b>test_implicitly_multipart_with_utf8</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002307_source')" id="l_M002307_source">show source</a> ]</p>
  <div id="M002307_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 810</span>
810:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_implicitly_multipart_with_utf8</span>
811:     <span class="ruby-identifier">mail</span> = <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">create_implicitly_multipart_with_utf8</span>
812:     <span class="ruby-identifier">assert_match</span>(<span class="ruby-regexp re">/\nSubject: =\?utf-8\?Q\?Foo_.*?\?=/</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">encoded</span>)
813:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002313" class="method">
  <div id="M002313_title" class="title">
    <b>test_implicitly_path_when_running_from_none_rails_root</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002313_source')" id="l_M002313_source">show source</a> ]</p>
  <div id="M002313_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 869</span>
869:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_implicitly_path_when_running_from_none_rails_root</span>
870:     <span class="ruby-identifier">exected_path</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">expand_path</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>(<span class="ruby-keyword kw">__FILE__</span>), <span class="ruby-value str">&quot;fixtures&quot;</span>, <span class="ruby-value str">&quot;test_mailer&quot;</span>))
871:     <span class="ruby-identifier">with_a_rails_root</span> <span class="ruby-keyword kw">do</span>
872:       <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">chdir</span> <span class="ruby-value str">&quot;/&quot;</span> <span class="ruby-keyword kw">do</span>
873:         <span class="ruby-identifier">template_path</span> = <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">allocate</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:template_path</span>)
874:         <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">exected_path</span>, <span class="ruby-constant">File</span>.<span class="ruby-identifier">expand_path</span>(<span class="ruby-identifier">template_path</span>)
875:       <span class="ruby-keyword kw">end</span>
876:     <span class="ruby-keyword kw">end</span>
877:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002283" class="method">
  <div id="M002283_title" class="title">
    <b>test_instances_are_nil</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002283_source')" id="l_M002283_source">show source</a> ]</p>
  <div id="M002283_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 566</span>
566:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_instances_are_nil</span>
567:     <span class="ruby-identifier">assert_nil</span> <span class="ruby-constant">ActionMailer</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">new</span>
568:     <span class="ruby-identifier">assert_nil</span> <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">new</span>
569:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002281" class="method">
  <div id="M002281_title" class="title">
    <b>test_iso_charset</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002281_source')" id="l_M002281_source">show source</a> ]</p>
  <div id="M002281_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 516</span>
516:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_iso_charset</span>
517:     <span class="ruby-identifier">expected</span> = <span class="ruby-identifier">new_mail</span>( <span class="ruby-value str">&quot;iso-8859-1&quot;</span> )
518:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">to</span>      = <span class="ruby-ivar">@recipient</span>
519:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">subject</span> = <span class="ruby-identifier">encode</span> <span class="ruby-value str">&quot;testing is charsets&quot;</span>, <span class="ruby-value str">&quot;iso-8859-1&quot;</span>
520:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">body</span>    = <span class="ruby-value str">&quot;Nothing to see here.&quot;</span>
521:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">from</span>    = <span class="ruby-value str">&quot;system@loudthinking.com&quot;</span>
522:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">cc</span>      = <span class="ruby-value str">&quot;nobody@loudthinking.com&quot;</span>
523:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">bcc</span>     = <span class="ruby-value str">&quot;root@loudthinking.com&quot;</span>
524:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">date</span>    = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">local</span> <span class="ruby-value">2004</span>, <span class="ruby-value">12</span>, <span class="ruby-value">12</span>
525: 
526:     <span class="ruby-identifier">created</span> = <span class="ruby-keyword kw">nil</span>
527:     <span class="ruby-identifier">assert_nothing_raised</span> <span class="ruby-keyword kw">do</span>
528:       <span class="ruby-identifier">created</span> = <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">create_iso_charset</span> <span class="ruby-ivar">@recipient</span>
529:     <span class="ruby-keyword kw">end</span>
530:     <span class="ruby-identifier">assert_not_nil</span> <span class="ruby-identifier">created</span>
531:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">encoded</span>, <span class="ruby-identifier">created</span>.<span class="ruby-identifier">encoded</span>
532: 
533:     <span class="ruby-identifier">assert_nothing_raised</span> <span class="ruby-keyword kw">do</span>
534:       <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">deliver_iso_charset</span> <span class="ruby-ivar">@recipient</span>
535:     <span class="ruby-keyword kw">end</span>
536: 
537:     <span class="ruby-identifier">assert_not_nil</span> <span class="ruby-constant">ActionMailer</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">deliveries</span>.<span class="ruby-identifier">first</span>
538:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">encoded</span>, <span class="ruby-constant">ActionMailer</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">deliveries</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">encoded</span>
539:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002305" class="method">
  <div id="M002305_title" class="title">
    <b>test_multipart_with_mime_version</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002305_source')" id="l_M002305_source">show source</a> ]</p>
  <div id="M002305_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 800</span>
800:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_multipart_with_mime_version</span>
801:     <span class="ruby-identifier">mail</span> = <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">create_multipart_with_mime_version</span>(<span class="ruby-ivar">@recipient</span>)
802:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;1.1&quot;</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">mime_version</span>
803:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002328" class="method">
  <div id="M002328_title" class="title">
    <b>test_multipart_with_template_path_with_dots</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002328_source')" id="l_M002328_source">show source</a> ]</p>
  <div id="M002328_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 982</span>
982:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_multipart_with_template_path_with_dots</span>
983:     <span class="ruby-identifier">mail</span> = <span class="ruby-constant">FunkyPathMailer</span>.<span class="ruby-identifier">create_multipart_with_template_path_with_dots</span>(<span class="ruby-ivar">@recipient</span>)
984:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">parts</span>.<span class="ruby-identifier">length</span>
985:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'text/plain'</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">parts</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">content_type</span>
986:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'utf-8'</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">parts</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">charset</span>
987:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002306" class="method">
  <div id="M002306_title" class="title">
    <b>test_multipart_with_utf8_subject</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002306_source')" id="l_M002306_source">show source</a> ]</p>
  <div id="M002306_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 805</span>
805:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_multipart_with_utf8_subject</span>
806:     <span class="ruby-identifier">mail</span> = <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">create_multipart_with_utf8_subject</span>(<span class="ruby-ivar">@recipient</span>)
807:     <span class="ruby-identifier">assert_match</span>(<span class="ruby-regexp re">/\nSubject: =\?utf-8\?Q\?Foo_.*?\?=/</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">encoded</span>)
808:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002296" class="method">
  <div id="M002296_title" class="title">
    <b>test_multiple_utf8_recipients</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002296_source')" id="l_M002296_source">show source</a> ]</p>
  <div id="M002296_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 730</span>
730:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_multiple_utf8_recipients</span>
731:     <span class="ruby-ivar">@recipient</span> = [<span class="ruby-value str">&quot;\&quot;Foo  \&quot; &lt;extended@example.net&gt;&quot;</span>, <span class="ruby-value str">&quot;\&quot;Example Recipient\&quot; &lt;me@example.com&gt;&quot;</span>]
732:     <span class="ruby-identifier">expected</span> = <span class="ruby-identifier">new_mail</span> <span class="ruby-value str">&quot;utf-8&quot;</span>
733:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">to</span>      = <span class="ruby-identifier">quote_address_if_necessary</span> <span class="ruby-ivar">@recipient</span>, <span class="ruby-value str">&quot;utf-8&quot;</span>
734:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">subject</span> = <span class="ruby-value str">&quot;testing utf-8 body&quot;</span>
735:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">body</span>    = <span class="ruby-value str">&quot; blah&quot;</span>
736:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">from</span>    = <span class="ruby-identifier">quote_address_if_necessary</span> <span class="ruby-ivar">@recipient</span>.<span class="ruby-identifier">first</span>, <span class="ruby-value str">&quot;utf-8&quot;</span>
737:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">cc</span>      = <span class="ruby-identifier">quote_address_if_necessary</span> <span class="ruby-ivar">@recipient</span>, <span class="ruby-value str">&quot;utf-8&quot;</span>
738:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">bcc</span>     = <span class="ruby-identifier">quote_address_if_necessary</span> <span class="ruby-ivar">@recipient</span>, <span class="ruby-value str">&quot;utf-8&quot;</span>
739:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">date</span>    = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">local</span> <span class="ruby-value">2004</span>, <span class="ruby-value">12</span>, <span class="ruby-value">12</span>
740: 
741:     <span class="ruby-identifier">created</span> = <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">create_utf8_body</span> <span class="ruby-ivar">@recipient</span>
742:     <span class="ruby-identifier">assert_match</span>(<span class="ruby-regexp re">/From:\ =\?utf\-8\?Q\?Foo_=C3=A1=C3=AB=C3=B4_=C3=AE=C3=BC\?=\ &lt;extended@example\.net&gt;/</span>, <span class="ruby-identifier">created</span>.<span class="ruby-identifier">encoded</span>)
743:     <span class="ruby-identifier">assert_match</span>(<span class="ruby-regexp re">/To:\ =\?utf\-8\?Q\?Foo_=C3=A1=C3=AB=C3=B4_=C3=AE=C3=BC\?=\ &lt;extended@example\.net&gt;/</span>, <span class="ruby-identifier">created</span>.<span class="ruby-identifier">encoded</span>)
744:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002270" class="method">
  <div id="M002270_title" class="title">
    <b>test_nested_parts</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002270_source')" id="l_M002270_source">show source</a> ]</p>
  <div id="M002270_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 335</span>
335:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_nested_parts</span>
336:     <span class="ruby-identifier">created</span> = <span class="ruby-keyword kw">nil</span>
337:     <span class="ruby-identifier">assert_nothing_raised</span> { <span class="ruby-identifier">created</span> = <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">create_nested_multipart</span>(<span class="ruby-ivar">@recipient</span>)}
338:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>,<span class="ruby-identifier">created</span>.<span class="ruby-identifier">parts</span>.<span class="ruby-identifier">size</span>
339:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>,<span class="ruby-identifier">created</span>.<span class="ruby-identifier">parts</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">parts</span>.<span class="ruby-identifier">size</span>
340: 
341:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;multipart/mixed&quot;</span>, <span class="ruby-identifier">created</span>.<span class="ruby-identifier">content_type</span>
342:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;multipart/alternative&quot;</span>, <span class="ruby-identifier">created</span>.<span class="ruby-identifier">parts</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">content_type</span>
343:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;bar&quot;</span>, <span class="ruby-identifier">created</span>.<span class="ruby-identifier">parts</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">header</span>[<span class="ruby-value str">'foo'</span>].<span class="ruby-identifier">to_s</span>
344:     <span class="ruby-identifier">assert_nil</span> <span class="ruby-identifier">created</span>.<span class="ruby-identifier">parts</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">charset</span>
345:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;text/plain&quot;</span>, <span class="ruby-identifier">created</span>.<span class="ruby-identifier">parts</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">parts</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">content_type</span>
346:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;text/html&quot;</span>, <span class="ruby-identifier">created</span>.<span class="ruby-identifier">parts</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">parts</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">content_type</span>
347:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;application/octet-stream&quot;</span>, <span class="ruby-identifier">created</span>.<span class="ruby-identifier">parts</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">content_type</span>
348:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002271" class="method">
  <div id="M002271_title" class="title">
    <b>test_nested_parts_with_body</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002271_source')" id="l_M002271_source">show source</a> ]</p>
  <div id="M002271_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 350</span>
350:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_nested_parts_with_body</span>
351:     <span class="ruby-identifier">created</span> = <span class="ruby-keyword kw">nil</span>
352:     <span class="ruby-identifier">assert_nothing_raised</span> { <span class="ruby-identifier">created</span> = <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">create_nested_multipart_with_body</span>(<span class="ruby-ivar">@recipient</span>)}
353:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>,<span class="ruby-identifier">created</span>.<span class="ruby-identifier">parts</span>.<span class="ruby-identifier">size</span>
354:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>,<span class="ruby-identifier">created</span>.<span class="ruby-identifier">parts</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">parts</span>.<span class="ruby-identifier">size</span>
355: 
356:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;multipart/mixed&quot;</span>, <span class="ruby-identifier">created</span>.<span class="ruby-identifier">content_type</span>
357:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;multipart/alternative&quot;</span>, <span class="ruby-identifier">created</span>.<span class="ruby-identifier">parts</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">content_type</span>
358:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;Nothing to see here.&quot;</span>, <span class="ruby-identifier">created</span>.<span class="ruby-identifier">parts</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">parts</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">body</span>
359:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;text/plain&quot;</span>, <span class="ruby-identifier">created</span>.<span class="ruby-identifier">parts</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">parts</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">content_type</span>
360:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;text/html&quot;</span>, <span class="ruby-identifier">created</span>.<span class="ruby-identifier">parts</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">parts</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">content_type</span>
361:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002285" class="method">
  <div id="M002285_title" class="title">
    <b>test_perform_deliveries_flag</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002285_source')" id="l_M002285_source">show source</a> ]</p>
  <div id="M002285_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 579</span>
579:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_perform_deliveries_flag</span>
580:     <span class="ruby-constant">ActionMailer</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">perform_deliveries</span> = <span class="ruby-keyword kw">false</span>
581:     <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">deliver_signed_up</span>(<span class="ruby-ivar">@recipient</span>)
582:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-constant">ActionMailer</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">deliveries</span>.<span class="ruby-identifier">size</span>
583:     <span class="ruby-constant">ActionMailer</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">perform_deliveries</span> = <span class="ruby-keyword kw">true</span>
584:     <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">deliver_signed_up</span>(<span class="ruby-ivar">@recipient</span>)
585:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-constant">ActionMailer</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">deliveries</span>.<span class="ruby-identifier">size</span>
586:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002287" class="method">
  <div id="M002287_title" class="title">
    <b>test_performs_delivery_via_sendmail</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002287_source')" id="l_M002287_source">show source</a> ]</p>
  <div id="M002287_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 594</span>
594:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_performs_delivery_via_sendmail</span>
595:     <span class="ruby-identifier">sm</span> = <span class="ruby-identifier">mock</span>()
596:     <span class="ruby-identifier">sm</span>.<span class="ruby-identifier">expects</span>(<span class="ruby-identifier">:print</span>).<span class="ruby-identifier">with</span>(<span class="ruby-identifier">anything</span>)
597:     <span class="ruby-identifier">sm</span>.<span class="ruby-identifier">expects</span>(<span class="ruby-identifier">:flush</span>)
598:     <span class="ruby-constant">IO</span>.<span class="ruby-identifier">expects</span>(<span class="ruby-identifier">:popen</span>).<span class="ruby-identifier">once</span>.<span class="ruby-identifier">with</span>(<span class="ruby-value str">'/usr/sbin/sendmail -i -t'</span>, <span class="ruby-value str">'w+'</span>).<span class="ruby-identifier">yields</span>(<span class="ruby-identifier">sm</span>)
599:     <span class="ruby-constant">ActionMailer</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">delivery_method</span> = <span class="ruby-identifier">:sendmail</span>
600:     <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">deliver_signed_up</span>(<span class="ruby-ivar">@recipient</span>)
601:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002298" class="method">
  <div id="M002298_title" class="title">
    <b>test_receive_attachments</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002298_source')" id="l_M002298_source">show source</a> ]</p>
  <div id="M002298_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 752</span>
752:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_receive_attachments</span>
753:     <span class="ruby-identifier">fixture</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>(<span class="ruby-keyword kw">__FILE__</span>) <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;/fixtures/raw_email2&quot;</span>)
754:     <span class="ruby-identifier">mail</span> = <span class="ruby-constant">TMail</span><span class="ruby-operator">::</span><span class="ruby-constant">Mail</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">fixture</span>)
755:     <span class="ruby-identifier">attachment</span> = <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">attachments</span>.<span class="ruby-identifier">last</span>
756:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;smime.p7s&quot;</span>, <span class="ruby-identifier">attachment</span>.<span class="ruby-identifier">original_filename</span>
757:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;application/pkcs7-signature&quot;</span>, <span class="ruby-identifier">attachment</span>.<span class="ruby-identifier">content_type</span>
758:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002297" class="method">
  <div id="M002297_title" class="title">
    <b>test_receive_decodes_base64_encoded_mail</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002297_source')" id="l_M002297_source">show source</a> ]</p>
  <div id="M002297_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 746</span>
746:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_receive_decodes_base64_encoded_mail</span>
747:     <span class="ruby-identifier">fixture</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>(<span class="ruby-keyword kw">__FILE__</span>) <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;/fixtures/raw_email&quot;</span>)
748:     <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">receive</span>(<span class="ruby-identifier">fixture</span>)
749:     <span class="ruby-identifier">assert_match</span>(<span class="ruby-regexp re">/Jamis/</span>, <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">received_body</span>)
750:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002321" class="method">
  <div id="M002321_title" class="title">
    <b>test_recursive_multipart_processing</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002321_source')" id="l_M002321_source">show source</a> ]</p>
  <div id="M002321_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 932</span>
932:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_recursive_multipart_processing</span>
933:     <span class="ruby-identifier">fixture</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>(<span class="ruby-keyword kw">__FILE__</span>) <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;/fixtures/raw_email7&quot;</span>)
934:     <span class="ruby-identifier">mail</span> = <span class="ruby-constant">TMail</span><span class="ruby-operator">::</span><span class="ruby-constant">Mail</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">fixture</span>)
935:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;This is the first part.\n\nAttachment: test.rb\nAttachment: test.pdf\n\n\nAttachment: smime.p7s\n&quot;</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">body</span>
936:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002280" class="method">
  <div id="M002280_title" class="title">
    <b>test_reply_to</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002280_source')" id="l_M002280_source">show source</a> ]</p>
  <div id="M002280_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 491</span>
491:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_reply_to</span>
492:     <span class="ruby-identifier">expected</span> = <span class="ruby-identifier">new_mail</span>
493: 
494:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">to</span>       = <span class="ruby-ivar">@recipient</span>
495:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">subject</span>  = <span class="ruby-value str">&quot;testing reply_to&quot;</span>
496:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">body</span>     = <span class="ruby-value str">&quot;Nothing to see here.&quot;</span>
497:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">from</span>     = <span class="ruby-value str">&quot;system@loudthinking.com&quot;</span>
498:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">reply_to</span> = <span class="ruby-value str">&quot;atraver@gmail.com&quot;</span>
499:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">date</span>     = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">local</span> <span class="ruby-value">2008</span>, <span class="ruby-value">5</span>, <span class="ruby-value">23</span>
500: 
501:     <span class="ruby-identifier">created</span> = <span class="ruby-keyword kw">nil</span>
502:     <span class="ruby-identifier">assert_nothing_raised</span> <span class="ruby-keyword kw">do</span>
503:       <span class="ruby-identifier">created</span> = <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">create_different_reply_to</span> <span class="ruby-ivar">@recipient</span>
504:     <span class="ruby-keyword kw">end</span>
505:     <span class="ruby-identifier">assert_not_nil</span> <span class="ruby-identifier">created</span>
506:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">encoded</span>, <span class="ruby-identifier">created</span>.<span class="ruby-identifier">encoded</span>
507: 
508:     <span class="ruby-identifier">assert_nothing_raised</span> <span class="ruby-keyword kw">do</span>
509:       <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">deliver_different_reply_to</span> <span class="ruby-ivar">@recipient</span>
510:     <span class="ruby-keyword kw">end</span>
511: 
512:     <span class="ruby-identifier">assert_not_nil</span> <span class="ruby-constant">ActionMailer</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">deliveries</span>.<span class="ruby-identifier">first</span>
513:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">encoded</span>, <span class="ruby-constant">ActionMailer</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">deliveries</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">encoded</span>
514:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002330" class="method">
  <div id="M002330_title" class="title">
    <b>test_return_path_with_create</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002330_source')" id="l_M002330_source">show source</a> ]</p>
  <div id="M002330_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 995</span>
995:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_return_path_with_create</span>
996:     <span class="ruby-identifier">mail</span> = <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">create_return_path</span>
997:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;&lt;another@somewhere.test&gt;&quot;</span>, <span class="ruby-identifier">mail</span>[<span class="ruby-value str">'return-path'</span>].<span class="ruby-identifier">to_s</span>
998:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002331" class="method">
  <div id="M002331_title" class="title">
    <b>test_return_path_with_deliver</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002331_source')" id="l_M002331_source">show source</a> ]</p>
  <div id="M002331_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 1000</span>
1000:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_return_path_with_deliver</span>
1001:     <span class="ruby-constant">ActionMailer</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">delivery_method</span> = <span class="ruby-identifier">:smtp</span>
1002:     <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">deliver_return_path</span>
1003:     <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp re">%r{^Return-Path: &lt;another@somewhere.test&gt;}</span>, <span class="ruby-constant">MockSMTP</span>.<span class="ruby-identifier">deliveries</span>[<span class="ruby-value">0</span>][<span class="ruby-value">0</span>]
1004:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;another@somewhere.test&quot;</span>, <span class="ruby-constant">MockSMTP</span>.<span class="ruby-identifier">deliveries</span>[<span class="ruby-value">0</span>][<span class="ruby-value">1</span>].<span class="ruby-identifier">to_s</span>
1005:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002273" class="method">
  <div id="M002273_title" class="title">
    <b>test_signed_up</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002273_source')" id="l_M002273_source">show source</a> ]</p>
  <div id="M002273_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 369</span>
369:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_signed_up</span>
370:     <span class="ruby-constant">Time</span>.<span class="ruby-identifier">stubs</span>(<span class="ruby-identifier">:now</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>)
371: 
372:     <span class="ruby-identifier">expected</span> = <span class="ruby-identifier">new_mail</span>
373:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">to</span>      = <span class="ruby-ivar">@recipient</span>
374:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">subject</span> = <span class="ruby-node">&quot;[Signed up] Welcome #{@recipient}&quot;</span>
375:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">body</span>    = <span class="ruby-node">&quot;Hello there, \n\nMr. #{@recipient}&quot;</span>
376:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">from</span>    = <span class="ruby-value str">&quot;system@loudthinking.com&quot;</span>
377:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">date</span>    = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>
378: 
379:     <span class="ruby-identifier">created</span> = <span class="ruby-keyword kw">nil</span>
380:     <span class="ruby-identifier">assert_nothing_raised</span> { <span class="ruby-identifier">created</span> = <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">create_signed_up</span>(<span class="ruby-ivar">@recipient</span>) }
381:     <span class="ruby-identifier">assert_not_nil</span> <span class="ruby-identifier">created</span>
382:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">encoded</span>, <span class="ruby-identifier">created</span>.<span class="ruby-identifier">encoded</span>
383: 
384:     <span class="ruby-identifier">assert_nothing_raised</span> { <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">deliver_signed_up</span>(<span class="ruby-ivar">@recipient</span>) }
385:     <span class="ruby-identifier">assert_not_nil</span> <span class="ruby-constant">ActionMailer</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">deliveries</span>.<span class="ruby-identifier">first</span>
386:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">encoded</span>, <span class="ruby-constant">ActionMailer</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">deliveries</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">encoded</span>
387:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002334" class="method">
  <div id="M002334_title" class="title">
    <b>test_starttls_is_disabled_if_not_supported</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002334_source')" id="l_M002334_source">show source</a> ]</p>
  <div id="M002334_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 1020</span>
1020:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_starttls_is_disabled_if_not_supported</span>
1021:     <span class="ruby-constant">ActionMailer</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">smtp_settings</span>[<span class="ruby-identifier">:enable_starttls_auto</span>] = <span class="ruby-keyword kw">true</span>
1022:     <span class="ruby-constant">MockSMTP</span>.<span class="ruby-identifier">any_instance</span>.<span class="ruby-identifier">expects</span>(<span class="ruby-identifier">:respond_to?</span>).<span class="ruby-identifier">with</span>(<span class="ruby-identifier">:enable_starttls_auto</span>).<span class="ruby-identifier">returns</span>(<span class="ruby-keyword kw">false</span>)
1023:     <span class="ruby-constant">MockSMTP</span>.<span class="ruby-identifier">any_instance</span>.<span class="ruby-identifier">expects</span>(<span class="ruby-identifier">:enable_starttls_auto</span>).<span class="ruby-identifier">never</span>
1024:     <span class="ruby-constant">ActionMailer</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">delivery_method</span> = <span class="ruby-identifier">:smtp</span>
1025:     <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">deliver_signed_up</span>(<span class="ruby-ivar">@recipient</span>)
1026:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002333" class="method">
  <div id="M002333_title" class="title">
    <b>test_starttls_is_enabled_if_supported</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002333_source')" id="l_M002333_source">show source</a> ]</p>
  <div id="M002333_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 1012</span>
1012:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_starttls_is_enabled_if_supported</span>
1013:     <span class="ruby-constant">ActionMailer</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">smtp_settings</span>[<span class="ruby-identifier">:enable_starttls_auto</span>] = <span class="ruby-keyword kw">true</span>
1014:     <span class="ruby-constant">MockSMTP</span>.<span class="ruby-identifier">any_instance</span>.<span class="ruby-identifier">expects</span>(<span class="ruby-identifier">:respond_to?</span>).<span class="ruby-identifier">with</span>(<span class="ruby-identifier">:enable_starttls_auto</span>).<span class="ruby-identifier">returns</span>(<span class="ruby-keyword kw">true</span>)
1015:     <span class="ruby-constant">MockSMTP</span>.<span class="ruby-identifier">any_instance</span>.<span class="ruby-identifier">expects</span>(<span class="ruby-identifier">:enable_starttls_auto</span>)
1016:     <span class="ruby-constant">ActionMailer</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">delivery_method</span> = <span class="ruby-identifier">:smtp</span>
1017:     <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">deliver_signed_up</span>(<span class="ruby-ivar">@recipient</span>)
1018:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002335" class="method">
  <div id="M002335_title" class="title">
    <b>test_starttls_is_not_enabled</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002335_source')" id="l_M002335_source">show source</a> ]</p>
  <div id="M002335_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 1028</span>
1028:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_starttls_is_not_enabled</span>
1029:     <span class="ruby-constant">ActionMailer</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">smtp_settings</span>[<span class="ruby-identifier">:enable_starttls_auto</span>] = <span class="ruby-keyword kw">false</span>
1030:     <span class="ruby-constant">MockSMTP</span>.<span class="ruby-identifier">any_instance</span>.<span class="ruby-identifier">expects</span>(<span class="ruby-identifier">:respond_to?</span>).<span class="ruby-identifier">never</span>
1031:     <span class="ruby-constant">MockSMTP</span>.<span class="ruby-identifier">any_instance</span>.<span class="ruby-identifier">expects</span>(<span class="ruby-identifier">:enable_starttls_auto</span>).<span class="ruby-identifier">never</span>
1032:     <span class="ruby-constant">ActionMailer</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">delivery_method</span> = <span class="ruby-identifier">:smtp</span>
1033:     <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">deliver_signed_up</span>(<span class="ruby-ivar">@recipient</span>)
1034:   <span class="ruby-keyword kw">ensure</span>
1035:     <span class="ruby-constant">ActionMailer</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">smtp_settings</span>[<span class="ruby-identifier">:enable_starttls_auto</span>] = <span class="ruby-keyword kw">true</span>
1036:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002282" class="method">
  <div id="M002282_title" class="title">
    <b>test_unencoded_subject</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002282_source')" id="l_M002282_source">show source</a> ]</p>
  <div id="M002282_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 541</span>
541:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_unencoded_subject</span>
542:     <span class="ruby-identifier">expected</span> = <span class="ruby-identifier">new_mail</span>
543:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">to</span>      = <span class="ruby-ivar">@recipient</span>
544:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">subject</span> = <span class="ruby-value str">&quot;testing unencoded subject&quot;</span>
545:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">body</span>    = <span class="ruby-value str">&quot;Nothing to see here.&quot;</span>
546:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">from</span>    = <span class="ruby-value str">&quot;system@loudthinking.com&quot;</span>
547:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">cc</span>      = <span class="ruby-value str">&quot;nobody@loudthinking.com&quot;</span>
548:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">bcc</span>     = <span class="ruby-value str">&quot;root@loudthinking.com&quot;</span>
549:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">date</span>    = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">local</span> <span class="ruby-value">2004</span>, <span class="ruby-value">12</span>, <span class="ruby-value">12</span>
550: 
551:     <span class="ruby-identifier">created</span> = <span class="ruby-keyword kw">nil</span>
552:     <span class="ruby-identifier">assert_nothing_raised</span> <span class="ruby-keyword kw">do</span>
553:       <span class="ruby-identifier">created</span> = <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">create_unencoded_subject</span> <span class="ruby-ivar">@recipient</span>
554:     <span class="ruby-keyword kw">end</span>
555:     <span class="ruby-identifier">assert_not_nil</span> <span class="ruby-identifier">created</span>
556:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">encoded</span>, <span class="ruby-identifier">created</span>.<span class="ruby-identifier">encoded</span>
557: 
558:     <span class="ruby-identifier">assert_nothing_raised</span> <span class="ruby-keyword kw">do</span>
559:       <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">deliver_unencoded_subject</span> <span class="ruby-ivar">@recipient</span>
560:     <span class="ruby-keyword kw">end</span>
561: 
562:     <span class="ruby-identifier">assert_not_nil</span> <span class="ruby-constant">ActionMailer</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">deliveries</span>.<span class="ruby-identifier">first</span>
563:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">encoded</span>, <span class="ruby-constant">ActionMailer</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">deliveries</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">encoded</span>
564:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002291" class="method">
  <div id="M002291_title" class="title">
    <b>test_unquote_7bit_body</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002291_source')" id="l_M002291_source">show source</a> ]</p>
  <div id="M002291_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 642</span>
642:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_unquote_7bit_body</span>
643:     <span class="ruby-identifier">msg</span> = <span class="ruby-value str">&quot;From: me@example.com\nSubject: subject\nContent-Type: text/plain; charset=iso-8859-1\nContent-Transfer-Encoding: 7bit\n\nThe=3Dbody\n&quot;</span>
644:     <span class="ruby-identifier">mail</span> = <span class="ruby-constant">TMail</span><span class="ruby-operator">::</span><span class="ruby-constant">Mail</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">msg</span>)
645:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;The=3Dbody&quot;</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">body</span>.<span class="ruby-identifier">strip</span>
646:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;The=3Dbody&quot;</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">quoted_body</span>.<span class="ruby-identifier">strip</span>
647:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002290" class="method">
  <div id="M002290_title" class="title">
    <b>test_unquote_7bit_subject</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002290_source')" id="l_M002290_source">show source</a> ]</p>
  <div id="M002290_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 628</span>
628:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_unquote_7bit_subject</span>
629:     <span class="ruby-identifier">msg</span> = <span class="ruby-value str">&quot;From: me@example.com\nSubject: this == working?\nContent-Type: text/plain; charset=iso-8859-1\n\nThe body\n&quot;</span>
630:     <span class="ruby-identifier">mail</span> = <span class="ruby-constant">TMail</span><span class="ruby-operator">::</span><span class="ruby-constant">Mail</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">msg</span>)
631:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;this == working?&quot;</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">subject</span>
632:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;this == working?&quot;</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">quoted_subject</span>
633:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002293" class="method">
  <div id="M002293_title" class="title">
    <b>test_unquote_base64_body</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002293_source')" id="l_M002293_source">show source</a> ]</p>
  <div id="M002293_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 672</span>
672:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_unquote_base64_body</span>
673:     <span class="ruby-identifier">msg</span> = <span class="ruby-value str">&quot;From: me@example.com\nSubject: subject\nContent-Type: text/plain; charset=iso-8859-1\nContent-Transfer-Encoding: base64\n\nVGhlIGJvZHk=\n&quot;</span>
674:     <span class="ruby-identifier">mail</span> = <span class="ruby-constant">TMail</span><span class="ruby-operator">::</span><span class="ruby-constant">Mail</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">msg</span>)
675:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;The body&quot;</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">body</span>.<span class="ruby-identifier">strip</span>
676:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;VGhlIGJvZHk=&quot;</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">quoted_body</span>.<span class="ruby-identifier">strip</span>
677:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002292" class="method">
  <div id="M002292_title" class="title">
    <b>test_unquote_quoted_printable_body</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002292_source')" id="l_M002292_source">show source</a> ]</p>
  <div id="M002292_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 657</span>
657:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_unquote_quoted_printable_body</span>
658:     <span class="ruby-identifier">msg</span> = <span class="ruby-value str">&quot;From: me@example.com\nSubject: subject\nContent-Type: text/plain; charset=iso-8859-1\nContent-Transfer-Encoding: quoted-printable\n\nThe=3Dbody\n&quot;</span>
659:     <span class="ruby-identifier">mail</span> = <span class="ruby-constant">TMail</span><span class="ruby-operator">::</span><span class="ruby-constant">Mail</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">msg</span>)
660:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;The=body&quot;</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">body</span>.<span class="ruby-identifier">strip</span>
661:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;The=3Dbody&quot;</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">quoted_body</span>.<span class="ruby-identifier">strip</span>
662:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002289" class="method">
  <div id="M002289_title" class="title">
    <b>test_unquote_quoted_printable_subject</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002289_source')" id="l_M002289_source">show source</a> ]</p>
  <div id="M002289_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 614</span>
614:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_unquote_quoted_printable_subject</span>
615:     <span class="ruby-identifier">msg</span> = <span class="ruby-value str">&quot;From: me@example.com\nSubject: =?utf-8?Q?testing_testing_=D6=A4?=\nContent-Type: text/plain; charset=iso-8859-1\n\nThe body\n&quot;</span>
616:     <span class="ruby-identifier">mail</span> = <span class="ruby-constant">TMail</span><span class="ruby-operator">::</span><span class="ruby-constant">Mail</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">msg</span>)
617:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;testing testing \326\244&quot;</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">subject</span>
618:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;=?utf-8?Q?testing_testing_=D6=A4?=&quot;</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">quoted_subject</span>
619:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002295" class="method">
  <div id="M002295_title" class="title">
    <b>test_utf8_body_is_not_quoted</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002295_source')" id="l_M002295_source">show source</a> ]</p>
  <div id="M002295_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 715</span>
715:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_utf8_body_is_not_quoted</span>
716:     <span class="ruby-ivar">@recipient</span> = <span class="ruby-value str">&quot;Foo   &lt;extended@example.net&gt;&quot;</span>
717:     <span class="ruby-identifier">expected</span> = <span class="ruby-identifier">new_mail</span> <span class="ruby-value str">&quot;utf-8&quot;</span>
718:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">to</span>      = <span class="ruby-identifier">quote_address_if_necessary</span> <span class="ruby-ivar">@recipient</span>, <span class="ruby-value str">&quot;utf-8&quot;</span>
719:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">subject</span> = <span class="ruby-value str">&quot;testing utf-8 body&quot;</span>
720:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">body</span>    = <span class="ruby-value str">&quot; blah&quot;</span>
721:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">from</span>    = <span class="ruby-identifier">quote_address_if_necessary</span> <span class="ruby-ivar">@recipient</span>, <span class="ruby-value str">&quot;utf-8&quot;</span>
722:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">cc</span>      = <span class="ruby-identifier">quote_address_if_necessary</span> <span class="ruby-ivar">@recipient</span>, <span class="ruby-value str">&quot;utf-8&quot;</span>
723:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">bcc</span>     = <span class="ruby-identifier">quote_address_if_necessary</span> <span class="ruby-ivar">@recipient</span>, <span class="ruby-value str">&quot;utf-8&quot;</span>
724:     <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">date</span>    = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">local</span> <span class="ruby-value">2004</span>, <span class="ruby-value">12</span>, <span class="ruby-value">12</span>
725: 
726:     <span class="ruby-identifier">created</span> = <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">create_utf8_body</span> <span class="ruby-ivar">@recipient</span>
727:     <span class="ruby-identifier">assert_match</span>(<span class="ruby-regexp re">/ blah/</span>, <span class="ruby-identifier">created</span>.<span class="ruby-identifier">encoded</span>)
728:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002318" class="method">
  <div id="M002318_title" class="title">
    <b>test_various_newlines</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002318_source')" id="l_M002318_source">show source</a> ]</p>
  <div id="M002318_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 909</span>
909:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_various_newlines</span>
910:     <span class="ruby-identifier">mail</span> = <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">create_various_newlines</span>(<span class="ruby-ivar">@recipient</span>)
911:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;line #1\nline #2\nline #3\nline #4\n\n&quot;</span> <span class="ruby-operator">+</span>
912:                  <span class="ruby-value str">&quot;line #5\n\nline#6\n\nline #7&quot;</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">body</span>)
913:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002319" class="method">
  <div id="M002319_title" class="title">
    <b>test_various_newlines_multipart</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002319_source')" id="l_M002319_source">show source</a> ]</p>
  <div id="M002319_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 915</span>
915:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_various_newlines_multipart</span>
916:     <span class="ruby-identifier">mail</span> = <span class="ruby-constant">TestMailer</span>.<span class="ruby-identifier">create_various_newlines_multipart</span>(<span class="ruby-ivar">@recipient</span>)
917:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;line #1\nline #2\nline #3\nline #4\n\n&quot;</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">parts</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">body</span>
918:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;&lt;p&gt;line #1&lt;/p&gt;\n&lt;p&gt;line #2&lt;/p&gt;\n&lt;p&gt;line #3&lt;/p&gt;\n&lt;p&gt;line #4&lt;/p&gt;\n\n&quot;</span>, <span class="ruby-identifier">mail</span>.<span class="ruby-identifier">parts</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">body</span>
919:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002323" class="method">
  <div id="M002323_title" class="title">
    <b>test_wrong_mail_header</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002323_source')" id="l_M002323_source">show source</a> ]</p>
  <div id="M002323_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionmailer/test/mail_service_test.rb, line 949</span>
949:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_wrong_mail_header</span>
950:     <span class="ruby-identifier">fixture</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>(<span class="ruby-keyword kw">__FILE__</span>) <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;/fixtures/raw_email9&quot;</span>)
951:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">TMail</span><span class="ruby-operator">::</span><span class="ruby-constant">SyntaxError</span>) { <span class="ruby-constant">TMail</span><span class="ruby-operator">::</span><span class="ruby-constant">Mail</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">fixture</span>) }
952:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
</div>

  </div>