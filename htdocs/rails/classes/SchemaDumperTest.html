  <div id="C00000277">
<div class='banner'>
  <span class="file-title-prefix">Class</span><br />SchemaDumperTest<br/>
  In:
<a href="#" onclick="jsHref('files/activerecord/test/cases/schema_dumper_test_rb.html');">activerecord/test/cases/schema_dumper_test.rb</a>

Parent:&nbsp;
ActiveRecord::TestCase
</div>
 <!-- banner header -->

  <div id="bodyContent" >
      <div id="content">




  <div class="sectiontitle">Methods</div>
  <ul>
  <li><a href="index.html?a=M001571&name=assert_line_up" >assert_line_up</a></li>
  <li><a href="index.html?a=M001572&name=column_definition_lines" >column_definition_lines</a></li>
  <li><a href="index.html?a=M001567&name=standard_dump" >standard_dump</a></li>
  <li><a href="index.html?a=M001574&name=test_arguments_line_up" >test_arguments_line_up</a></li>
  <li><a href="index.html?a=M001575&name=test_no_dump_errors" >test_no_dump_errors</a></li>
  <li><a href="index.html?a=M001568&name=test_schema_dump" >test_schema_dump</a></li>
  <li><a href="index.html?a=M001569&name=test_schema_dump_excludes_sqlite_sequence" >test_schema_dump_excludes_sqlite_sequence</a></li>
  <li><a href="index.html?a=M001580&name=test_schema_dump_illegal_ignored_table_value" >test_schema_dump_illegal_ignored_table_value</a></li>
  <li><a href="index.html?a=M001570&name=test_schema_dump_includes_camelcase_table_name" >test_schema_dump_includes_camelcase_table_name</a></li>
  <li><a href="index.html?a=M001585&name=test_schema_dump_includes_decimal_options" >test_schema_dump_includes_decimal_options</a></li>
  <li><a href="index.html?a=M001584&name=test_schema_dump_includes_length_for_mysql_blob_and_text_fields" >test_schema_dump_includes_length_for_mysql_blob_and_text_fields</a></li>
  <li><a href="index.html?a=M001577&name=test_schema_dump_includes_limit_constraint_for_integer_columns" >test_schema_dump_includes_limit_constraint_for_integer_columns</a></li>
  <li><a href="index.html?a=M001576&name=test_schema_dump_includes_not_null_columns" >test_schema_dump_includes_not_null_columns</a></li>
  <li><a href="index.html?a=M001586&name=test_schema_dump_includes_xml_shorthand_definition" >test_schema_dump_includes_xml_shorthand_definition</a></li>
  <li><a href="index.html?a=M001587&name=test_schema_dump_keeps_id_column_when_id_is_false_and_id_column_added" >test_schema_dump_keeps_id_column_when_id_is_false_and_id_column_added</a></li>
  <li><a href="index.html?a=M001582&name=test_schema_dump_should_honor_nonstandard_primary_keys" >test_schema_dump_should_honor_nonstandard_primary_keys</a></li>
  <li><a href="index.html?a=M001583&name=test_schema_dump_should_not_add_default_value_for_mysql_text_field" >test_schema_dump_should_not_add_default_value_for_mysql_text_field</a></li>
  <li><a href="index.html?a=M001579&name=test_schema_dump_with_regexp_ignored_table" >test_schema_dump_with_regexp_ignored_table</a></li>
  <li><a href="index.html?a=M001578&name=test_schema_dump_with_string_ignored_table" >test_schema_dump_with_string_ignored_table</a></li>
  <li><a href="index.html?a=M001581&name=test_schema_dumps_index_columns_in_right_order" >test_schema_dumps_index_columns_in_right_order</a></li>
  <li><a href="index.html?a=M001573&name=test_types_line_up" >test_types_line_up</a></li>
  </ul>






<div class="sectiontitle">Public Instance methods</div>
<div id="M001571" class="method">
  <div id="M001571_title" class="title">
    <b>assert_line_up</b>(lines, pattern, required = false)
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001571_source')" id="l_M001571_source">show source</a> ]</p>
  <div id="M001571_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/schema_dumper_test.rb, line 30</span>
30:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">assert_line_up</span>(<span class="ruby-identifier">lines</span>, <span class="ruby-identifier">pattern</span>, <span class="ruby-identifier">required</span> = <span class="ruby-keyword kw">false</span>)
31:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">assert</span>(<span class="ruby-keyword kw">true</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">lines</span>.<span class="ruby-identifier">empty?</span>
32:     <span class="ruby-identifier">matches</span> = <span class="ruby-identifier">lines</span>.<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span> <span class="ruby-identifier">line</span>.<span class="ruby-identifier">match</span>(<span class="ruby-identifier">pattern</span>) }
33:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">matches</span>.<span class="ruby-identifier">all?</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">required</span>
34:     <span class="ruby-identifier">matches</span>.<span class="ruby-identifier">compact!</span>
35:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">assert</span>(<span class="ruby-keyword kw">true</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">matches</span>.<span class="ruby-identifier">empty?</span>
36:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">matches</span>.<span class="ruby-identifier">map</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">match</span><span class="ruby-operator">|</span> <span class="ruby-identifier">match</span>.<span class="ruby-identifier">offset</span>(<span class="ruby-value">0</span>).<span class="ruby-identifier">first</span> }.<span class="ruby-identifier">uniq</span>.<span class="ruby-identifier">length</span>
37:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001572" class="method">
  <div id="M001572_title" class="title">
    <b>column_definition_lines</b>(output = standard_dump)
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001572_source')" id="l_M001572_source">show source</a> ]</p>
  <div id="M001572_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/schema_dumper_test.rb, line 39</span>
39:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">column_definition_lines</span>(<span class="ruby-identifier">output</span> = <span class="ruby-identifier">standard_dump</span>)
40:     <span class="ruby-identifier">output</span>.<span class="ruby-identifier">scan</span>(<span class="ruby-regexp re">/^( *)create_table.*?\n(.*?)^\1end/</span><span class="ruby-identifier">m</span>).<span class="ruby-identifier">map</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">m</span><span class="ruby-operator">|</span> <span class="ruby-identifier">m</span>.<span class="ruby-identifier">last</span>.<span class="ruby-identifier">split</span>(<span class="ruby-regexp re">/\n/</span>) }
41:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001567" class="method">
  <div id="M001567_title" class="title">
    <b>standard_dump</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001567_source')" id="l_M001567_source">show source</a> ]</p>
  <div id="M001567_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/schema_dumper_test.rb, line 6</span>
 6:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">standard_dump</span>
 7:     <span class="ruby-identifier">stream</span> = <span class="ruby-constant">StringIO</span>.<span class="ruby-identifier">new</span>
 8:     <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">SchemaDumper</span>.<span class="ruby-identifier">ignore_tables</span> = []
 9:     <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">SchemaDumper</span>.<span class="ruby-identifier">dump</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">connection</span>, <span class="ruby-identifier">stream</span>)
10:     <span class="ruby-identifier">stream</span>.<span class="ruby-identifier">string</span>
11:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001574" class="method">
  <div id="M001574_title" class="title">
    <b>test_arguments_line_up</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001574_source')" id="l_M001574_source">show source</a> ]</p>
  <div id="M001574_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/schema_dumper_test.rb, line 57</span>
57:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_arguments_line_up</span>
58:     <span class="ruby-identifier">column_definition_lines</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">column_set</span><span class="ruby-operator">|</span>
59:       <span class="ruby-identifier">assert_line_up</span>(<span class="ruby-identifier">column_set</span>, <span class="ruby-regexp re">/:default =&gt; /</span>)
60:       <span class="ruby-identifier">assert_line_up</span>(<span class="ruby-identifier">column_set</span>, <span class="ruby-regexp re">/:limit =&gt; /</span>)
61:       <span class="ruby-identifier">assert_line_up</span>(<span class="ruby-identifier">column_set</span>, <span class="ruby-regexp re">/:null =&gt; /</span>)
62:     <span class="ruby-keyword kw">end</span>
63:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001575" class="method">
  <div id="M001575_title" class="title">
    <b>test_no_dump_errors</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001575_source')" id="l_M001575_source">show source</a> ]</p>
  <div id="M001575_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/schema_dumper_test.rb, line 65</span>
65:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_no_dump_errors</span>
66:     <span class="ruby-identifier">output</span> = <span class="ruby-identifier">standard_dump</span>
67:     <span class="ruby-identifier">assert_no_match</span> <span class="ruby-regexp re">%r{\# Could not dump table}</span>, <span class="ruby-identifier">output</span>
68:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001568" class="method">
  <div id="M001568_title" class="title">
    <b>test_schema_dump</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001568_source')" id="l_M001568_source">show source</a> ]</p>
  <div id="M001568_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/schema_dumper_test.rb, line 13</span>
13:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_schema_dump</span>
14:     <span class="ruby-identifier">output</span> = <span class="ruby-identifier">standard_dump</span>
15:     <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp re">%r{create_table &quot;accounts&quot;}</span>, <span class="ruby-identifier">output</span>
16:     <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp re">%r{create_table &quot;authors&quot;}</span>, <span class="ruby-identifier">output</span>
17:     <span class="ruby-identifier">assert_no_match</span> <span class="ruby-regexp re">%r{create_table &quot;schema_migrations&quot;}</span>, <span class="ruby-identifier">output</span>
18:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001569" class="method">
  <div id="M001569_title" class="title">
    <b>test_schema_dump_excludes_sqlite_sequence</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001569_source')" id="l_M001569_source">show source</a> ]</p>
  <div id="M001569_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/schema_dumper_test.rb, line 20</span>
20:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_schema_dump_excludes_sqlite_sequence</span>
21:     <span class="ruby-identifier">output</span> = <span class="ruby-identifier">standard_dump</span>
22:     <span class="ruby-identifier">assert_no_match</span> <span class="ruby-regexp re">%r{create_table &quot;sqlite_sequence&quot;}</span>, <span class="ruby-identifier">output</span>
23:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001580" class="method">
  <div id="M001580_title" class="title">
    <b>test_schema_dump_illegal_ignored_table_value</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001580_source')" id="l_M001580_source">show source</a> ]</p>
  <div id="M001580_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/schema_dumper_test.rb, line 147</span>
147:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_schema_dump_illegal_ignored_table_value</span>
148:     <span class="ruby-identifier">stream</span> = <span class="ruby-constant">StringIO</span>.<span class="ruby-identifier">new</span>
149:     <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">SchemaDumper</span>.<span class="ruby-identifier">ignore_tables</span> = [<span class="ruby-value">5</span>]
150:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">StandardError</span>) <span class="ruby-keyword kw">do</span>
151:       <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">SchemaDumper</span>.<span class="ruby-identifier">dump</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">connection</span>, <span class="ruby-identifier">stream</span>)
152:     <span class="ruby-keyword kw">end</span>
153:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001570" class="method">
  <div id="M001570_title" class="title">
    <b>test_schema_dump_includes_camelcase_table_name</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001570_source')" id="l_M001570_source">show source</a> ]</p>
  <div id="M001570_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/schema_dumper_test.rb, line 25</span>
25:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_schema_dump_includes_camelcase_table_name</span>
26:     <span class="ruby-identifier">output</span> = <span class="ruby-identifier">standard_dump</span>
27:     <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp re">%r{create_table &quot;CamelCase&quot;}</span>, <span class="ruby-identifier">output</span>
28:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001585" class="method">
  <div id="M001585_title" class="title">
    <b>test_schema_dump_includes_decimal_options</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001585_source')" id="l_M001585_source">show source</a> ]</p>
  <div id="M001585_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/schema_dumper_test.rb, line 186</span>
186:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_schema_dump_includes_decimal_options</span>
187:     <span class="ruby-identifier">stream</span> = <span class="ruby-constant">StringIO</span>.<span class="ruby-identifier">new</span>
188:     <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">SchemaDumper</span>.<span class="ruby-identifier">ignore_tables</span> = [<span class="ruby-regexp re">/^[^n]/</span>]
189:     <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">SchemaDumper</span>.<span class="ruby-identifier">dump</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">connection</span>, <span class="ruby-identifier">stream</span>)
190:     <span class="ruby-identifier">output</span> = <span class="ruby-identifier">stream</span>.<span class="ruby-identifier">string</span>
191:     <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp re">%r{:precision =&gt; 3,[[:space:]]+:scale =&gt; 2,[[:space:]]+:default =&gt; 2.78}</span>, <span class="ruby-identifier">output</span>
192:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001584" class="method">
  <div id="M001584_title" class="title">
    <b>test_schema_dump_includes_length_for_mysql_blob_and_text_fields</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001584_source')" id="l_M001584_source">show source</a> ]</p>
  <div id="M001584_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/schema_dumper_test.rb, line 173</span>
173:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_schema_dump_includes_length_for_mysql_blob_and_text_fields</span>
174:       <span class="ruby-identifier">output</span> = <span class="ruby-identifier">standard_dump</span>
175:       <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp re">%r{t.binary\s+&quot;tiny_blob&quot;,\s+:limit =&gt; 255$}</span>, <span class="ruby-identifier">output</span>
176:       <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp re">%r{t.binary\s+&quot;normal_blob&quot;$}</span>, <span class="ruby-identifier">output</span>
177:       <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp re">%r{t.binary\s+&quot;medium_blob&quot;,\s+:limit =&gt; 16777215$}</span>, <span class="ruby-identifier">output</span>
178:       <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp re">%r{t.binary\s+&quot;long_blob&quot;,\s+:limit =&gt; 2147483647$}</span>, <span class="ruby-identifier">output</span>
179:       <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp re">%r{t.text\s+&quot;tiny_text&quot;,\s+:limit =&gt; 255$}</span>, <span class="ruby-identifier">output</span>
180:       <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp re">%r{t.text\s+&quot;normal_text&quot;$}</span>, <span class="ruby-identifier">output</span>
181:       <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp re">%r{t.text\s+&quot;medium_text&quot;,\s+:limit =&gt; 16777215$}</span>, <span class="ruby-identifier">output</span>
182:       <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp re">%r{t.text\s+&quot;long_text&quot;,\s+:limit =&gt; 2147483647$}</span>, <span class="ruby-identifier">output</span>
183:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001577" class="method">
  <div id="M001577_title" class="title">
    <b>test_schema_dump_includes_limit_constraint_for_integer_columns</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001577_source')" id="l_M001577_source">show source</a> ]</p>
  <div id="M001577_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/schema_dumper_test.rb, line 79</span>
 79:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_schema_dump_includes_limit_constraint_for_integer_columns</span>
 80:     <span class="ruby-identifier">stream</span> = <span class="ruby-constant">StringIO</span>.<span class="ruby-identifier">new</span>
 81: 
 82:     <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">SchemaDumper</span>.<span class="ruby-identifier">ignore_tables</span> = [<span class="ruby-regexp re">/^(?!integer_limits)/</span>]
 83:     <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">SchemaDumper</span>.<span class="ruby-identifier">dump</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">connection</span>, <span class="ruby-identifier">stream</span>)
 84:     <span class="ruby-identifier">output</span> = <span class="ruby-identifier">stream</span>.<span class="ruby-identifier">string</span>
 85: 
 86:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">current_adapter?</span>(<span class="ruby-identifier">:PostgreSQLAdapter</span>)
 87:       <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp re">%r{c_int_1.*:limit =&gt; 2}</span>, <span class="ruby-identifier">output</span>
 88:       <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp re">%r{c_int_2.*:limit =&gt; 2}</span>, <span class="ruby-identifier">output</span>
 89: 
 90:       <span class="ruby-comment cmt"># int 3 is 4 bytes in postgresql</span>
 91:       <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp re">%r{c_int_3.*}</span>, <span class="ruby-identifier">output</span>
 92:       <span class="ruby-identifier">assert_no_match</span> <span class="ruby-regexp re">%r{c_int_3.*:limit}</span>, <span class="ruby-identifier">output</span>
 93: 
 94:       <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp re">%r{c_int_4.*}</span>, <span class="ruby-identifier">output</span>
 95:       <span class="ruby-identifier">assert_no_match</span> <span class="ruby-regexp re">%r{c_int_4.*:limit}</span>, <span class="ruby-identifier">output</span>
 96:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">current_adapter?</span>(<span class="ruby-identifier">:MysqlAdapter</span>)
 97:       <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp re">%r{c_int_1.*:limit =&gt; 1}</span>, <span class="ruby-identifier">output</span>
 98:       <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp re">%r{c_int_2.*:limit =&gt; 2}</span>, <span class="ruby-identifier">output</span>
 99:       <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp re">%r{c_int_3.*:limit =&gt; 3}</span>, <span class="ruby-identifier">output</span>
100: 
101:       <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp re">%r{c_int_4.*}</span>, <span class="ruby-identifier">output</span>
102:       <span class="ruby-identifier">assert_no_match</span> <span class="ruby-regexp re">%r{c_int_4.*:limit}</span>, <span class="ruby-identifier">output</span>
103:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">current_adapter?</span>(<span class="ruby-identifier">:SQLiteAdapter</span>)
104:       <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp re">%r{c_int_1.*:limit =&gt; 1}</span>, <span class="ruby-identifier">output</span>
105:       <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp re">%r{c_int_2.*:limit =&gt; 2}</span>, <span class="ruby-identifier">output</span>
106:       <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp re">%r{c_int_3.*:limit =&gt; 3}</span>, <span class="ruby-identifier">output</span>
107:       <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp re">%r{c_int_4.*:limit =&gt; 4}</span>, <span class="ruby-identifier">output</span>
108:     <span class="ruby-keyword kw">end</span>
109:     <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp re">%r{c_int_without_limit.*}</span>, <span class="ruby-identifier">output</span>
110:     <span class="ruby-identifier">assert_no_match</span> <span class="ruby-regexp re">%r{c_int_without_limit.*:limit}</span>, <span class="ruby-identifier">output</span>
111: 
112:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">current_adapter?</span>(<span class="ruby-identifier">:SQLiteAdapter</span>)
113:       <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp re">%r{c_int_5.*:limit =&gt; 5}</span>, <span class="ruby-identifier">output</span>
114:       <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp re">%r{c_int_6.*:limit =&gt; 6}</span>, <span class="ruby-identifier">output</span>
115:       <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp re">%r{c_int_7.*:limit =&gt; 7}</span>, <span class="ruby-identifier">output</span>
116:       <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp re">%r{c_int_8.*:limit =&gt; 8}</span>, <span class="ruby-identifier">output</span>
117:     <span class="ruby-keyword kw">else</span>
118:       <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp re">%r{c_int_5.*:limit =&gt; 8}</span>, <span class="ruby-identifier">output</span>
119:       <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp re">%r{c_int_6.*:limit =&gt; 8}</span>, <span class="ruby-identifier">output</span>
120:       <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp re">%r{c_int_7.*:limit =&gt; 8}</span>, <span class="ruby-identifier">output</span>
121:       <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp re">%r{c_int_8.*:limit =&gt; 8}</span>, <span class="ruby-identifier">output</span>
122:     <span class="ruby-keyword kw">end</span>
123:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001576" class="method">
  <div id="M001576_title" class="title">
    <b>test_schema_dump_includes_not_null_columns</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001576_source')" id="l_M001576_source">show source</a> ]</p>
  <div id="M001576_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/schema_dumper_test.rb, line 70</span>
70:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_schema_dump_includes_not_null_columns</span>
71:     <span class="ruby-identifier">stream</span> = <span class="ruby-constant">StringIO</span>.<span class="ruby-identifier">new</span>
72: 
73:     <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">SchemaDumper</span>.<span class="ruby-identifier">ignore_tables</span> = [<span class="ruby-regexp re">/^[^r]/</span>]
74:     <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">SchemaDumper</span>.<span class="ruby-identifier">dump</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">connection</span>, <span class="ruby-identifier">stream</span>)
75:     <span class="ruby-identifier">output</span> = <span class="ruby-identifier">stream</span>.<span class="ruby-identifier">string</span>
76:     <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp re">%r{:null =&gt; false}</span>, <span class="ruby-identifier">output</span>
77:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001586" class="method">
  <div id="M001586_title" class="title">
    <b>test_schema_dump_includes_xml_shorthand_definition</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001586_source')" id="l_M001586_source">show source</a> ]</p>
  <div id="M001586_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/schema_dumper_test.rb, line 195</span>
195:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_schema_dump_includes_xml_shorthand_definition</span>
196:       <span class="ruby-identifier">output</span> = <span class="ruby-identifier">standard_dump</span>
197:       <span class="ruby-keyword kw">if</span> <span class="ruby-regexp re">%r{create_table &quot;postgresql_xml_data_type&quot;}</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">output</span>
198:         <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp re">%r{t.xml &quot;data&quot;}</span>, <span class="ruby-identifier">output</span>
199:       <span class="ruby-keyword kw">end</span>
200:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001587" class="method">
  <div id="M001587_title" class="title">
    <b>test_schema_dump_keeps_id_column_when_id_is_false_and_id_column_added</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001587_source')" id="l_M001587_source">show source</a> ]</p>
  <div id="M001587_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/schema_dumper_test.rb, line 203</span>
203:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_schema_dump_keeps_id_column_when_id_is_false_and_id_column_added</span>
204:     <span class="ruby-identifier">output</span> = <span class="ruby-identifier">standard_dump</span>
205:     <span class="ruby-identifier">match</span> = <span class="ruby-identifier">output</span>.<span class="ruby-identifier">match</span>(<span class="ruby-regexp re">%r{create_table &quot;goofy_string_id&quot;(.*)do.*\n(.*)\n}</span>)
206:     <span class="ruby-identifier">assert_not_nil</span>(<span class="ruby-identifier">match</span>, <span class="ruby-value str">&quot;goofy_string_id table not found&quot;</span>)
207:     <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp re">%r(:id =&gt; false)</span>, <span class="ruby-identifier">match</span>[<span class="ruby-value">1</span>], <span class="ruby-value str">&quot;no table id not preserved&quot;</span>
208:     <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp re">%r{t.string[[:space:]]+&quot;id&quot;,[[:space:]]+:null =&gt; false$}</span>, <span class="ruby-identifier">match</span>[<span class="ruby-value">2</span>], <span class="ruby-value str">&quot;non-primary key id column not preserved&quot;</span>
209:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001582" class="method">
  <div id="M001582_title" class="title">
    <b>test_schema_dump_should_honor_nonstandard_primary_keys</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001582_source')" id="l_M001582_source">show source</a> ]</p>
  <div id="M001582_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/schema_dumper_test.rb, line 160</span>
160:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_schema_dump_should_honor_nonstandard_primary_keys</span>
161:     <span class="ruby-identifier">output</span> = <span class="ruby-identifier">standard_dump</span>
162:     <span class="ruby-identifier">match</span> = <span class="ruby-identifier">output</span>.<span class="ruby-identifier">match</span>(<span class="ruby-regexp re">%r{create_table &quot;movies&quot;(.*)do}</span>)
163:     <span class="ruby-identifier">assert_not_nil</span>(<span class="ruby-identifier">match</span>, <span class="ruby-value str">&quot;nonstandardpk table not found&quot;</span>)
164:     <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp re">%r(:primary_key =&gt; &quot;movieid&quot;)</span>, <span class="ruby-identifier">match</span>[<span class="ruby-value">1</span>], <span class="ruby-value str">&quot;non-standard primary key not preserved&quot;</span>
165:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001583" class="method">
  <div id="M001583_title" class="title">
    <b>test_schema_dump_should_not_add_default_value_for_mysql_text_field</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001583_source')" id="l_M001583_source">show source</a> ]</p>
  <div id="M001583_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/schema_dumper_test.rb, line 168</span>
168:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_schema_dump_should_not_add_default_value_for_mysql_text_field</span>
169:       <span class="ruby-identifier">output</span> = <span class="ruby-identifier">standard_dump</span>
170:       <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp re">%r{t.text\s+&quot;body&quot;,\s+:null =&gt; false$}</span>, <span class="ruby-identifier">output</span>
171:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001579" class="method">
  <div id="M001579_title" class="title">
    <b>test_schema_dump_with_regexp_ignored_table</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001579_source')" id="l_M001579_source">show source</a> ]</p>
  <div id="M001579_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/schema_dumper_test.rb, line 136</span>
136:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_schema_dump_with_regexp_ignored_table</span>
137:     <span class="ruby-identifier">stream</span> = <span class="ruby-constant">StringIO</span>.<span class="ruby-identifier">new</span>
138: 
139:     <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">SchemaDumper</span>.<span class="ruby-identifier">ignore_tables</span> = [<span class="ruby-regexp re">/^account/</span>]
140:     <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">SchemaDumper</span>.<span class="ruby-identifier">dump</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">connection</span>, <span class="ruby-identifier">stream</span>)
141:     <span class="ruby-identifier">output</span> = <span class="ruby-identifier">stream</span>.<span class="ruby-identifier">string</span>
142:     <span class="ruby-identifier">assert_no_match</span> <span class="ruby-regexp re">%r{create_table &quot;accounts&quot;}</span>, <span class="ruby-identifier">output</span>
143:     <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp re">%r{create_table &quot;authors&quot;}</span>, <span class="ruby-identifier">output</span>
144:     <span class="ruby-identifier">assert_no_match</span> <span class="ruby-regexp re">%r{create_table &quot;schema_migrations&quot;}</span>, <span class="ruby-identifier">output</span>
145:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001578" class="method">
  <div id="M001578_title" class="title">
    <b>test_schema_dump_with_string_ignored_table</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001578_source')" id="l_M001578_source">show source</a> ]</p>
  <div id="M001578_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/schema_dumper_test.rb, line 125</span>
125:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_schema_dump_with_string_ignored_table</span>
126:     <span class="ruby-identifier">stream</span> = <span class="ruby-constant">StringIO</span>.<span class="ruby-identifier">new</span>
127: 
128:     <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">SchemaDumper</span>.<span class="ruby-identifier">ignore_tables</span> = [<span class="ruby-value str">'accounts'</span>]
129:     <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">SchemaDumper</span>.<span class="ruby-identifier">dump</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">connection</span>, <span class="ruby-identifier">stream</span>)
130:     <span class="ruby-identifier">output</span> = <span class="ruby-identifier">stream</span>.<span class="ruby-identifier">string</span>
131:     <span class="ruby-identifier">assert_no_match</span> <span class="ruby-regexp re">%r{create_table &quot;accounts&quot;}</span>, <span class="ruby-identifier">output</span>
132:     <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp re">%r{create_table &quot;authors&quot;}</span>, <span class="ruby-identifier">output</span>
133:     <span class="ruby-identifier">assert_no_match</span> <span class="ruby-regexp re">%r{create_table &quot;schema_migrations&quot;}</span>, <span class="ruby-identifier">output</span>
134:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001581" class="method">
  <div id="M001581_title" class="title">
    <b>test_schema_dumps_index_columns_in_right_order</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001581_source')" id="l_M001581_source">show source</a> ]</p>
  <div id="M001581_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/schema_dumper_test.rb, line 155</span>
155:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_schema_dumps_index_columns_in_right_order</span>
156:     <span class="ruby-identifier">index_definition</span> = <span class="ruby-identifier">standard_dump</span>.<span class="ruby-identifier">split</span>(<span class="ruby-regexp re">/\n/</span>).<span class="ruby-identifier">grep</span>(<span class="ruby-regexp re">/add_index.*companies/</span>).<span class="ruby-identifier">first</span>.<span class="ruby-identifier">strip</span>
157:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'add_index &quot;companies&quot;, [&quot;firm_id&quot;, &quot;type&quot;, &quot;rating&quot;, &quot;ruby_type&quot;], :name =&gt; &quot;company_index&quot;'</span>, <span class="ruby-identifier">index_definition</span>
158:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001573" class="method">
  <div id="M001573_title" class="title">
    <b>test_types_line_up</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001573_source')" id="l_M001573_source">show source</a> ]</p>
  <div id="M001573_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/schema_dumper_test.rb, line 43</span>
43:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_types_line_up</span>
44:     <span class="ruby-identifier">column_definition_lines</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">column_set</span><span class="ruby-operator">|</span>
45:       <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">column_set</span>.<span class="ruby-identifier">empty?</span>
46: 
47:       <span class="ruby-identifier">lengths</span> = <span class="ruby-identifier">column_set</span>.<span class="ruby-identifier">map</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">column</span><span class="ruby-operator">|</span>
48:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">match</span> = <span class="ruby-identifier">column</span>.<span class="ruby-identifier">match</span>(<span class="ruby-regexp re">/t\.(?:integer|decimal|float|datetime|timestamp|time|date|text|binary|string|boolean)\s+&quot;/</span>)
49:           <span class="ruby-identifier">match</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">length</span>
50:         <span class="ruby-keyword kw">end</span>
51:       <span class="ruby-keyword kw">end</span>
52: 
53:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">lengths</span>.<span class="ruby-identifier">uniq</span>.<span class="ruby-identifier">length</span>
54:     <span class="ruby-keyword kw">end</span>
55:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
</div>

  </div>