  <div id="C00000881">
<div class='banner'>
  <span class="file-title-prefix">Class</span><br />HasManyAssociationsTest<br/>
  In:
<a href="#" onclick="jsHref('files/activerecord/test/cases/associations/has_many_associations_test_rb.html');">activerecord/test/cases/associations/has_many_associations_test.rb</a>

Parent:&nbsp;
ActiveRecord::TestCase
</div>
 <!-- banner header -->

  <div id="bodyContent" >
      <div id="content">




  <div class="sectiontitle">Methods</div>
  <ul>
  <li><a href="index.html?a=M006078&name=before_destroy" >before_destroy</a></li>
  <li><a href="index.html?a=M005980&name=force_signal37_to_load_all_clients_of_firm" >force_signal37_to_load_all_clients_of_firm</a></li>
  <li><a href="index.html?a=M005979&name=setup" >setup</a></li>
  <li><a href="index.html?a=M006025&name=test_adding" >test_adding</a></li>
  <li><a href="index.html?a=M006032&name=test_adding_a_collection" >test_adding_a_collection</a></li>
  <li><a href="index.html?a=M006031&name=test_adding_a_mismatch_class" >test_adding_a_mismatch_class</a></li>
  <li><a href="index.html?a=M006082&name=test_adding_array_and_collection" >test_adding_array_and_collection</a></li>
  <li><a href="index.html?a=M006026&name=test_adding_using_create" >test_adding_using_create</a></li>
  <li><a href="index.html?a=M006091&name=test_assign_ids_ignoring_blanks" >test_assign_ids_ignoring_blanks</a></li>
  <li><a href="index.html?a=M006114&name=test_association_proxy_transaction_method_starts_transaction_in_association_class" >test_association_proxy_transaction_method_starts_transaction_in_association_class</a></li>
  <li><a href="index.html?a=M006010&name=test_belongs_to_sanity" >test_belongs_to_sanity</a></li>
  <li><a href="index.html?a=M006033&name=test_build" >test_build</a></li>
  <li><a href="index.html?a=M006037&name=test_build_followed_by_save_does_not_load_target" >test_build_followed_by_save_does_not_load_target</a></li>
  <li><a href="index.html?a=M006036&name=test_build_many" >test_build_many</a></li>
  <li><a href="index.html?a=M006040&name=test_build_many_via_block" >test_build_many_via_block</a></li>
  <li><a href="index.html?a=M006039&name=test_build_via_block" >test_build_via_block</a></li>
  <li><a href="index.html?a=M006038&name=test_build_without_loading_association" >test_build_without_loading_association</a></li>
  <li><a href="index.html?a=M006106&name=test_calling_first_or_last_on_association_should_not_load_association" >test_calling_first_or_last_on_association_should_not_load_association</a></li>
  <li><a href="index.html?a=M006108&name=test_calling_first_or_last_on_existing_record_with_build_should_load_association" >test_calling_first_or_last_on_existing_record_with_build_should_load_association</a></li>
  <li><a href="index.html?a=M006109&name=test_calling_first_or_last_on_existing_record_with_create_should_not_load_association" >test_calling_first_or_last_on_existing_record_with_create_should_not_load_association</a></li>
  <li><a href="index.html?a=M006107&name=test_calling_first_or_last_on_loaded_association_should_not_fetch_with_query" >test_calling_first_or_last_on_loaded_association_should_not_fetch_with_query</a></li>
  <li><a href="index.html?a=M006110&name=test_calling_first_or_last_on_new_record_should_not_run_queries" >test_calling_first_or_last_on_new_record_should_not_run_queries</a></li>
  <li><a href="index.html?a=M006111&name=test_calling_first_or_last_with_find_options_on_loaded_association_should_fetch_with_query" >test_calling_first_or_last_with_find_options_on_loaded_association_should_fetch_with_query</a></li>
  <li><a href="index.html?a=M006112&name=test_calling_first_or_last_with_integer_on_association_should_load_association" >test_calling_first_or_last_with_integer_on_association_should_load_association</a></li>
  <li><a href="index.html?a=M005999&name=test_cant_save_has_many_readonly_association" >test_cant_save_has_many_readonly_association</a></li>
  <li><a href="index.html?a=M006056&name=test_clearing_a_dependent_association_collection" >test_clearing_a_dependent_association_collection</a></li>
  <li><a href="index.html?a=M006054&name=test_clearing_an_association_collection" >test_clearing_an_association_collection</a></li>
  <li><a href="index.html?a=M006057&name=test_clearing_an_exclusively_dependent_association_collection" >test_clearing_an_exclusively_dependent_association_collection</a></li>
  <li><a href="index.html?a=M006055&name=test_clearing_updates_counter_cache" >test_clearing_updates_counter_cache</a></li>
  <li><a href="index.html?a=M006064&name=test_clearing_without_initial_access" >test_clearing_without_initial_access</a></li>
  <li><a href="index.html?a=M006034&name=test_collection_size_after_building" >test_collection_size_after_building</a></li>
  <li><a href="index.html?a=M006035&name=test_collection_size_twice_for_regressions" >test_collection_size_twice_for_regressions</a></li>
  <li><a href="index.html?a=M005982&name=test_counting" >test_counting</a></li>
  <li><a href="index.html?a=M006009&name=test_counting_non_existant_items_using_sql" >test_counting_non_existant_items_using_sql</a></li>
  <li><a href="index.html?a=M006008&name=test_counting_using_sql" >test_counting_using_sql</a></li>
  <li><a href="index.html?a=M005987&name=test_counting_with_association_limit" >test_counting_with_association_limit</a></li>
  <li><a href="index.html?a=M005986&name=test_counting_with_column_name_and_hash" >test_counting_with_column_name_and_hash</a></li>
  <li><a href="index.html?a=M005981&name=test_counting_with_counter_sql" >test_counting_with_counter_sql</a></li>
  <li><a href="index.html?a=M005983&name=test_counting_with_empty_hash_conditions" >test_counting_with_empty_hash_conditions</a></li>
  <li><a href="index.html?a=M005984&name=test_counting_with_single_conditions" >test_counting_with_single_conditions</a></li>
  <li><a href="index.html?a=M005985&name=test_counting_with_single_hash" >test_counting_with_single_hash</a></li>
  <li><a href="index.html?a=M006042&name=test_create" >test_create</a></li>
  <li><a href="index.html?a=M006044&name=test_create_followed_by_save_does_not_load_target" >test_create_followed_by_save_does_not_load_target</a></li>
  <li><a href="index.html?a=M006043&name=test_create_many" >test_create_many</a></li>
  <li><a href="index.html?a=M006030&name=test_create_with_bang_on_habtm_when_parent_is_new_raises" >test_create_with_bang_on_habtm_when_parent_is_new_raises</a></li>
  <li><a href="index.html?a=M006029&name=test_create_with_bang_on_has_many_raises_when_record_not_saved" >test_create_with_bang_on_has_many_raises_when_record_not_saved</a></li>
  <li><a href="index.html?a=M006027&name=test_create_with_bang_on_has_many_when_parent_is_new_raises" >test_create_with_bang_on_has_many_when_parent_is_new_raises</a></li>
  <li><a href="index.html?a=M006041&name=test_create_without_loading_association" >test_create_without_loading_association</a></li>
  <li><a href="index.html?a=M006117&name=test_creating_using_primary_key" >test_creating_using_primary_key</a></li>
  <li><a href="index.html?a=M006061&name=test_creation_respects_hash_condition" >test_creation_respects_hash_condition</a></li>
  <li><a href="index.html?a=M006052&name=test_delete_all" >test_delete_all</a></li>
  <li><a href="index.html?a=M006053&name=test_delete_all_with_not_yet_loaded_association_collection" >test_delete_all_with_not_yet_loaded_association_collection</a></li>
  <li><a href="index.html?a=M006047&name=test_deleting" >test_deleting</a></li>
  <li><a href="index.html?a=M006051&name=test_deleting_a_collection" >test_deleting_a_collection</a></li>
  <li><a href="index.html?a=M006065&name=test_deleting_a_item_which_is_not_in_the_collection" >test_deleting_a_item_which_is_not_in_the_collection</a></li>
  <li><a href="index.html?a=M006048&name=test_deleting_before_save" >test_deleting_before_save</a></li>
  <li><a href="index.html?a=M006067&name=test_deleting_self_type_mismatch" >test_deleting_self_type_mismatch</a></li>
  <li><a href="index.html?a=M006066&name=test_deleting_type_mismatch" >test_deleting_type_mismatch</a></li>
  <li><a href="index.html?a=M006049&name=test_deleting_updates_counter_cache" >test_deleting_updates_counter_cache</a></li>
  <li><a href="index.html?a=M006050&name=test_deleting_updates_counter_cache_without_dependent_destroy" >test_deleting_updates_counter_cache_without_dependent_destroy</a></li>
  <li><a href="index.html?a=M006073&name=test_dependence" >test_dependence</a></li>
  <li><a href="index.html?a=M006074&name=test_dependence_for_associations_with_hash_condition" >test_dependence_for_associations_with_hash_condition</a></li>
  <li><a href="index.html?a=M006079&name=test_dependence_on_account" >test_dependence_on_account</a></li>
  <li><a href="index.html?a=M006077&name=test_dependence_with_transaction_support_on_failure" >test_dependence_with_transaction_support_on_failure</a></li>
  <li><a href="index.html?a=M006058&name=test_dependent_association_respects_optional_conditions_on_delete" >test_dependent_association_respects_optional_conditions_on_delete</a></li>
  <li><a href="index.html?a=M006060&name=test_dependent_association_respects_optional_hash_conditions_on_delete" >test_dependent_association_respects_optional_hash_conditions_on_delete</a></li>
  <li><a href="index.html?a=M006059&name=test_dependent_association_respects_optional_sanitized_conditions_on_delete" >test_dependent_association_respects_optional_sanitized_conditions_on_delete</a></li>
  <li><a href="index.html?a=M006062&name=test_dependent_delete_and_destroy_with_belongs_to" >test_dependent_delete_and_destroy_with_belongs_to</a></li>
  <li><a href="index.html?a=M006080&name=test_depends_and_nullify" >test_depends_and_nullify</a></li>
  <li><a href="index.html?a=M006072&name=test_destroy_all" >test_destroy_all</a></li>
  <li><a href="index.html?a=M006075&name=test_destroy_dependent_when_deleted_from_association" >test_destroy_dependent_when_deleted_from_association</a></li>
  <li><a href="index.html?a=M006068&name=test_destroying" >test_destroying</a></li>
  <li><a href="index.html?a=M006071&name=test_destroying_a_collection" >test_destroying_a_collection</a></li>
  <li><a href="index.html?a=M006069&name=test_destroying_by_fixnum_id" >test_destroying_by_fixnum_id</a></li>
  <li><a href="index.html?a=M006070&name=test_destroying_by_string_id" >test_destroying_by_string_id</a></li>
  <li><a href="index.html?a=M005997&name=test_dynamic_find_all_limit_should_override_association_limit" >test_dynamic_find_all_limit_should_override_association_limit</a></li>
  <li><a href="index.html?a=M006099&name=test_dynamic_find_all_order_should_override_association_limit_for_through" >test_dynamic_find_all_order_should_override_association_limit_for_through</a></li>
  <li><a href="index.html?a=M005995&name=test_dynamic_find_all_order_should_override_association_order" >test_dynamic_find_all_order_should_override_association_order</a></li>
  <li><a href="index.html?a=M006097&name=test_dynamic_find_all_order_should_override_association_order_for_through" >test_dynamic_find_all_order_should_override_association_order_for_through</a></li>
  <li><a href="index.html?a=M005996&name=test_dynamic_find_all_should_respect_association_limit" >test_dynamic_find_all_should_respect_association_limit</a></li>
  <li><a href="index.html?a=M006098&name=test_dynamic_find_all_should_respect_association_limit_for_through" >test_dynamic_find_all_should_respect_association_limit_for_through</a></li>
  <li><a href="index.html?a=M005994&name=test_dynamic_find_all_should_respect_association_order" >test_dynamic_find_all_should_respect_association_order</a></li>
  <li><a href="index.html?a=M006096&name=test_dynamic_find_all_should_respect_association_order_for_through" >test_dynamic_find_all_should_respect_association_order_for_through</a></li>
  <li><a href="index.html?a=M005998&name=test_dynamic_find_all_should_respect_readonly_access" >test_dynamic_find_all_should_respect_readonly_access</a></li>
  <li><a href="index.html?a=M005991&name=test_dynamic_find_last_without_specified_order" >test_dynamic_find_last_without_specified_order</a></li>
  <li><a href="index.html?a=M005993&name=test_dynamic_find_order_should_override_association_order" >test_dynamic_find_order_should_override_association_order</a></li>
  <li><a href="index.html?a=M006095&name=test_dynamic_find_order_should_override_association_order_for_through" >test_dynamic_find_order_should_override_association_order_for_through</a></li>
  <li><a href="index.html?a=M005992&name=test_dynamic_find_should_respect_association_order" >test_dynamic_find_should_respect_association_order</a></li>
  <li><a href="index.html?a=M006094&name=test_dynamic_find_should_respect_association_order_for_through" >test_dynamic_find_should_respect_association_order_for_through</a></li>
  <li><a href="index.html?a=M006013&name=test_find_all" >test_find_all</a></li>
  <li><a href="index.html?a=M006100&name=test_find_all_include_over_the_same_table_for_through" >test_find_all_include_over_the_same_table_for_through</a></li>
  <li><a href="index.html?a=M006017&name=test_find_all_sanitized" >test_find_all_sanitized</a></li>
  <li><a href="index.html?a=M006020&name=test_find_all_with_include_and_conditions" >test_find_all_with_include_and_conditions</a></li>
  <li><a href="index.html?a=M006083&name=test_find_all_without_conditions" >test_find_all_without_conditions</a></li>
  <li><a href="index.html?a=M006014&name=test_find_each" >test_find_each</a></li>
  <li><a href="index.html?a=M006015&name=test_find_each_with_conditions" >test_find_each_with_conditions</a></li>
  <li><a href="index.html?a=M006018&name=test_find_first" >test_find_first</a></li>
  <li><a href="index.html?a=M006019&name=test_find_first_sanitized" >test_find_first_sanitized</a></li>
  <li><a href="index.html?a=M006022&name=test_find_grouped" >test_find_grouped</a></li>
  <li><a href="index.html?a=M006011&name=test_find_ids" >test_find_ids</a></li>
  <li><a href="index.html?a=M006016&name=test_find_in_batches" >test_find_in_batches</a></li>
  <li><a href="index.html?a=M006021&name=test_find_in_collection" >test_find_in_collection</a></li>
  <li><a href="index.html?a=M005990&name=test_find_many_with_merged_options" >test_find_many_with_merged_options</a></li>
  <li><a href="index.html?a=M006046&name=test_find_or_create" >test_find_or_create</a></li>
  <li><a href="index.html?a=M006045&name=test_find_or_initialize" >test_find_or_initialize</a></li>
  <li><a href="index.html?a=M006023&name=test_find_scoped_grouped" >test_find_scoped_grouped</a></li>
  <li><a href="index.html?a=M006024&name=test_find_scoped_grouped_having" >test_find_scoped_grouped_having</a></li>
  <li><a href="index.html?a=M006012&name=test_find_string_ids_when_using_finder_sql" >test_find_string_ids_when_using_finder_sql</a></li>
  <li><a href="index.html?a=M005989&name=test_find_with_blank_conditions" >test_find_with_blank_conditions</a></li>
  <li><a href="index.html?a=M005988&name=test_finding" >test_finding</a></li>
  <li><a href="index.html?a=M006001&name=test_finding_default_orders" >test_finding_default_orders</a></li>
  <li><a href="index.html?a=M006006&name=test_finding_using_primary_key" >test_finding_using_primary_key</a></li>
  <li><a href="index.html?a=M006007&name=test_finding_using_sql" >test_finding_using_sql</a></li>
  <li><a href="index.html?a=M006004&name=test_finding_with_condition" >test_finding_with_condition</a></li>
  <li><a href="index.html?a=M006005&name=test_finding_with_condition_hash" >test_finding_with_condition_hash</a></li>
  <li><a href="index.html?a=M006002&name=test_finding_with_different_class_name_and_order" >test_finding_with_different_class_name_and_order</a></li>
  <li><a href="index.html?a=M006003&name=test_finding_with_foreign_key" >test_finding_with_foreign_key</a></li>
  <li><a href="index.html?a=M006087&name=test_get_ids" >test_get_ids</a></li>
  <li><a href="index.html?a=M006088&name=test_get_ids_for_loaded_associations" >test_get_ids_for_loaded_associations</a></li>
  <li><a href="index.html?a=M006092&name=test_get_ids_for_through" >test_get_ids_for_through</a></li>
  <li><a href="index.html?a=M006089&name=test_get_ids_for_unloaded_associations_does_not_load_them" >test_get_ids_for_unloaded_associations_does_not_load_them</a></li>
  <li><a href="index.html?a=M006090&name=test_get_ids_for_unloaded_finder_sql_associations_loads_them" >test_get_ids_for_unloaded_finder_sql_associations_loads_them</a></li>
  <li><a href="index.html?a=M006101&name=test_has_many_through_respects_hash_conditions" >test_has_many_through_respects_hash_conditions</a></li>
  <li><a href="index.html?a=M006103&name=test_include_checks_if_record_exists_if_target_not_loaded" >test_include_checks_if_record_exists_if_target_not_loaded</a></li>
  <li><a href="index.html?a=M006104&name=test_include_loads_collection_if_target_uses_finder_sql" >test_include_loads_collection_if_target_uses_finder_sql</a></li>
  <li><a href="index.html?a=M006105&name=test_include_returns_false_for_non_matching_record_to_verify_scoping" >test_include_returns_false_for_non_matching_record_to_verify_scoping</a></li>
  <li><a href="index.html?a=M006102&name=test_include_uses_array_include_after_loaded" >test_include_uses_array_include_after_loaded</a></li>
  <li><a href="index.html?a=M006081&name=test_included_in_collection" >test_included_in_collection</a></li>
  <li><a href="index.html?a=M006063&name=test_invalid_belongs_to_dependent_option_raises_exception" >test_invalid_belongs_to_dependent_option_raises_exception</a></li>
  <li><a href="index.html?a=M006113&name=test_joins_with_namespaced_model_should_use_correct_type" >test_joins_with_namespaced_model_should_use_correct_type</a></li>
  <li><a href="index.html?a=M006093&name=test_modifying_a_through_a_has_many_should_raise" >test_modifying_a_through_a_has_many_should_raise</a></li>
  <li><a href="index.html?a=M006028&name=test_regular_create_on_has_many_when_parent_is_new_raises" >test_regular_create_on_has_many_when_parent_is_new_raises</a></li>
  <li><a href="index.html?a=M006084&name=test_replace_with_less" >test_replace_with_less</a></li>
  <li><a href="index.html?a=M006085&name=test_replace_with_less_and_dependent_nullify" >test_replace_with_less_and_dependent_nullify</a></li>
  <li><a href="index.html?a=M006086&name=test_replace_with_new" >test_replace_with_new</a></li>
  <li><a href="index.html?a=M006116&name=test_respond_to_private_class_methods" >test_respond_to_private_class_methods</a></li>
  <li><a href="index.html?a=M006115&name=test_sending_new_to_association_proxy_should_have_same_effect_as_calling_new" >test_sending_new_to_association_proxy_should_have_same_effect_as_calling_new</a></li>
  <li><a href="index.html?a=M006076&name=test_three_levels_of_dependence" >test_three_levels_of_dependence</a></li>
  <li><a href="index.html?a=M006000&name=test_triple_equality" >test_triple_equality</a></li>
  </ul>






<div class="sectiontitle">Public Instance methods</div>
<div id="M006078" class="method">
  <div id="M006078_title" class="title">
    <b>before_destroy</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006078_source')" id="l_M006078_source">show source</a> ]</p>
  <div id="M006078_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 807</span>
807:                                  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">before_destroy</span>() <span class="ruby-identifier">raise</span> <span class="ruby-value str">&quot;Trigger rollback&quot;</span> <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005980" class="method">
  <div id="M005980_title" class="title">
    <b>force_signal37_to_load_all_clients_of_firm</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005980_source')" id="l_M005980_source">show source</a> ]</p>
  <div id="M005980_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 24</span>
24:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">force_signal37_to_load_all_clients_of_firm</span>
25:     <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span> }
26:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005979" class="method">
  <div id="M005979_title" class="title">
    <b>setup</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005979_source')" id="l_M005979_source">show source</a> ]</p>
  <div id="M005979_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 20</span>
20:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">setup</span>
21:     <span class="ruby-constant">Client</span>.<span class="ruby-identifier">destroyed_client_ids</span>.<span class="ruby-identifier">clear</span>
22:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006025" class="method">
  <div id="M006025_title" class="title">
    <b>test_adding</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006025_source')" id="l_M006025_source">show source</a> ]</p>
  <div id="M006025_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 313</span>
313:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_adding</span>
314:     <span class="ruby-identifier">force_signal37_to_load_all_clients_of_firm</span>
315:     <span class="ruby-identifier">natural</span> = <span class="ruby-constant">Client</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Natural Company&quot;</span>)
316:     <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">natural</span>
317:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">size</span> <span class="ruby-comment cmt"># checking via the collection</span>
318:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>(<span class="ruby-keyword kw">true</span>).<span class="ruby-identifier">size</span> <span class="ruby-comment cmt"># checking using the db</span>
319:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">natural</span>, <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">last</span>
320:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006032" class="method">
  <div id="M006032_title" class="title">
    <b>test_adding_a_collection</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006032_source')" id="l_M006032_source">show source</a> ]</p>
  <div id="M006032_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 363</span>
363:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_adding_a_collection</span>
364:     <span class="ruby-identifier">force_signal37_to_load_all_clients_of_firm</span>
365:     <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">concat</span>([<span class="ruby-constant">Client</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Natural Company&quot;</span>), <span class="ruby-constant">Client</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Apple&quot;</span>)])
366:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">3</span>, <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">size</span>
367:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">3</span>, <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>(<span class="ruby-keyword kw">true</span>).<span class="ruby-identifier">size</span>
368:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006031" class="method">
  <div id="M006031_title" class="title">
    <b>test_adding_a_mismatch_class</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006031_source')" id="l_M006031_source">show source</a> ]</p>
  <div id="M006031_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 357</span>
357:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_adding_a_mismatch_class</span>
358:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">AssociationTypeMismatch</span>) { <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-keyword kw">nil</span> }
359:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">AssociationTypeMismatch</span>) { <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value">1</span> }
360:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">AssociationTypeMismatch</span>) { <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">1</span>) }
361:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006082" class="method">
  <div id="M006082_title" class="title">
    <b>test_adding_array_and_collection</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006082_source')" id="l_M006082_source">show source</a> ]</p>
  <div id="M006082_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 840</span>
840:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_adding_array_and_collection</span>
841:     <span class="ruby-identifier">assert_nothing_raised</span> { <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>).<span class="ruby-identifier">clients</span> <span class="ruby-operator">+</span> <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>).<span class="ruby-identifier">last</span>.<span class="ruby-identifier">clients</span> }
842:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006026" class="method">
  <div id="M006026_title" class="title">
    <b>test_adding_using_create</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006026_source')" id="l_M006026_source">show source</a> ]</p>
  <div id="M006026_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 322</span>
322:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_adding_using_create</span>
323:     <span class="ruby-identifier">first_firm</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>)
324:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-identifier">first_firm</span>.<span class="ruby-identifier">plain_clients</span>.<span class="ruby-identifier">size</span>
325:     <span class="ruby-identifier">natural</span> = <span class="ruby-identifier">first_firm</span>.<span class="ruby-identifier">plain_clients</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Natural Company&quot;</span>)
326:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">3</span>, <span class="ruby-identifier">first_firm</span>.<span class="ruby-identifier">plain_clients</span>.<span class="ruby-identifier">length</span>
327:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">3</span>, <span class="ruby-identifier">first_firm</span>.<span class="ruby-identifier">plain_clients</span>.<span class="ruby-identifier">size</span>
328:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006091" class="method">
  <div id="M006091_title" class="title">
    <b>test_assign_ids_ignoring_blanks</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006091_source')" id="l_M006091_source">show source</a> ]</p>
  <div id="M006091_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 899</span>
899:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_assign_ids_ignoring_blanks</span>
900:     <span class="ruby-identifier">firm</span> = <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'Apple'</span>)
901:     <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">client_ids</span> = [<span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_client</span>).<span class="ruby-identifier">id</span>, <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:second_client</span>).<span class="ruby-identifier">id</span>, <span class="ruby-value str">''</span>]
902:     <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">save!</span>
903: 
904:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>(<span class="ruby-keyword kw">true</span>).<span class="ruby-identifier">size</span>
905:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:second_client</span>))
906:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006114" class="method">
  <div id="M006114_title" class="title">
    <b>test_association_proxy_transaction_method_starts_transaction_in_association_class</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006114_source')" id="l_M006114_source">show source</a> ]</p>
  <div id="M006114_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 1098</span>
1098:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_association_proxy_transaction_method_starts_transaction_in_association_class</span>
1099:     <span class="ruby-constant">Comment</span>.<span class="ruby-identifier">expects</span>(<span class="ruby-identifier">:transaction</span>)
1100:     <span class="ruby-constant">Post</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>).<span class="ruby-identifier">comments</span>.<span class="ruby-identifier">transaction</span> <span class="ruby-keyword kw">do</span>
1101:       <span class="ruby-comment cmt"># nothing</span>
1102:     <span class="ruby-keyword kw">end</span>
1103:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006010" class="method">
  <div id="M006010_title" class="title">
    <b>test_belongs_to_sanity</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006010_source')" id="l_M006010_source">show source</a> ]</p>
  <div id="M006010_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 167</span>
167:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_belongs_to_sanity</span>
168:     <span class="ruby-identifier">c</span> = <span class="ruby-constant">Client</span>.<span class="ruby-identifier">new</span>
169:     <span class="ruby-identifier">assert_nil</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">firm</span>
170: 
171:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">firm</span>
172:       <span class="ruby-identifier">assert</span> <span class="ruby-keyword kw">false</span>, <span class="ruby-value str">&quot;belongs_to failed if check&quot;</span>
173:     <span class="ruby-keyword kw">end</span>
174: 
175:     <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">firm</span>
176:     <span class="ruby-keyword kw">else</span>
177:       <span class="ruby-identifier">assert</span> <span class="ruby-keyword kw">false</span>,  <span class="ruby-value str">&quot;belongs_to failed unless check&quot;</span>
178:     <span class="ruby-keyword kw">end</span>
179:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006033" class="method">
  <div id="M006033_title" class="title">
    <b>test_build</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006033_source')" id="l_M006033_source">show source</a> ]</p>
  <div id="M006033_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 370</span>
370:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_build</span>
371:     <span class="ruby-identifier">company</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>)
372:     <span class="ruby-identifier">new_client</span> = <span class="ruby-identifier">assert_no_queries</span> { <span class="ruby-identifier">company</span>.<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">build</span>(<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Another Client&quot;</span>) }
373:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">company</span>.<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">loaded?</span>
374: 
375:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;Another Client&quot;</span>, <span class="ruby-identifier">new_client</span>.<span class="ruby-identifier">name</span>
376:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">new_client</span>.<span class="ruby-identifier">new_record?</span>
377:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">new_client</span>, <span class="ruby-identifier">company</span>.<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">last</span>
378:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006037" class="method">
  <div id="M006037_title" class="title">
    <b>test_build_followed_by_save_does_not_load_target</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006037_source')" id="l_M006037_source">show source</a> ]</p>
  <div id="M006037_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 405</span>
405:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_build_followed_by_save_does_not_load_target</span>
406:     <span class="ruby-identifier">new_client</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">build</span>(<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Another Client&quot;</span>)
407:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">save</span>
408:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">loaded?</span>
409:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006036" class="method">
  <div id="M006036_title" class="title">
    <b>test_build_many</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006036_source')" id="l_M006036_source">show source</a> ]</p>
  <div id="M006036_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 399</span>
399:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_build_many</span>
400:     <span class="ruby-identifier">company</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>)
401:     <span class="ruby-identifier">new_clients</span> = <span class="ruby-identifier">assert_no_queries</span> { <span class="ruby-identifier">company</span>.<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">build</span>([{<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Another Client&quot;</span>}, {<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Another Client II&quot;</span>}]) }
402:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-identifier">new_clients</span>.<span class="ruby-identifier">size</span>
403:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006040" class="method">
  <div id="M006040_title" class="title">
    <b>test_build_many_via_block</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006040_source')" id="l_M006040_source">show source</a> ]</p>
  <div id="M006040_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 435</span>
435:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_build_many_via_block</span>
436:     <span class="ruby-identifier">company</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>)
437:     <span class="ruby-identifier">new_clients</span> = <span class="ruby-identifier">assert_no_queries</span> <span class="ruby-keyword kw">do</span>
438:       <span class="ruby-identifier">company</span>.<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">build</span>([{<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Another Client&quot;</span>}, {<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Another Client II&quot;</span>}]) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">client</span><span class="ruby-operator">|</span>
439:         <span class="ruby-identifier">client</span>.<span class="ruby-identifier">name</span> = <span class="ruby-value str">&quot;changed&quot;</span>
440:       <span class="ruby-keyword kw">end</span>
441:     <span class="ruby-keyword kw">end</span>
442: 
443:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-identifier">new_clients</span>.<span class="ruby-identifier">size</span>
444:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;changed&quot;</span>, <span class="ruby-identifier">new_clients</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">name</span>
445:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;changed&quot;</span>, <span class="ruby-identifier">new_clients</span>.<span class="ruby-identifier">last</span>.<span class="ruby-identifier">name</span>
446:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006039" class="method">
  <div id="M006039_title" class="title">
    <b>test_build_via_block</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006039_source')" id="l_M006039_source">show source</a> ]</p>
  <div id="M006039_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 425</span>
425:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_build_via_block</span>
426:     <span class="ruby-identifier">company</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>)
427:     <span class="ruby-identifier">new_client</span> = <span class="ruby-identifier">assert_no_queries</span> { <span class="ruby-identifier">company</span>.<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">build</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">client</span><span class="ruby-operator">|</span> <span class="ruby-identifier">client</span>.<span class="ruby-identifier">name</span> = <span class="ruby-value str">&quot;Another Client&quot;</span> } }
428:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">company</span>.<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">loaded?</span>
429: 
430:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;Another Client&quot;</span>, <span class="ruby-identifier">new_client</span>.<span class="ruby-identifier">name</span>
431:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">new_client</span>.<span class="ruby-identifier">new_record?</span>
432:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">new_client</span>, <span class="ruby-identifier">company</span>.<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">last</span>
433:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006038" class="method">
  <div id="M006038_title" class="title">
    <b>test_build_without_loading_association</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006038_source')" id="l_M006038_source">show source</a> ]</p>
  <div id="M006038_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 411</span>
411:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_build_without_loading_association</span>
412:     <span class="ruby-identifier">first_topic</span> = <span class="ruby-identifier">topics</span>(<span class="ruby-identifier">:first</span>)
413:     <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">column_names</span>
414: 
415:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">first_topic</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">length</span>
416: 
417:     <span class="ruby-identifier">assert_no_queries</span> <span class="ruby-keyword kw">do</span>
418:       <span class="ruby-identifier">first_topic</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">build</span>(<span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Not saved&quot;</span>, <span class="ruby-identifier">:content</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Superstars&quot;</span>)
419:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-identifier">first_topic</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">size</span>
420:     <span class="ruby-keyword kw">end</span>
421: 
422:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-identifier">first_topic</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">to_ary</span>.<span class="ruby-identifier">size</span>
423:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006106" class="method">
  <div id="M006106_title" class="title">
    <b>test_calling_first_or_last_on_association_should_not_load_association</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006106_source')" id="l_M006106_source">show source</a> ]</p>
  <div id="M006106_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 1003</span>
1003:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_calling_first_or_last_on_association_should_not_load_association</span>
1004:     <span class="ruby-identifier">firm</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>)
1005:     <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">first</span>
1006:     <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">last</span>
1007:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">loaded?</span>
1008:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006108" class="method">
  <div id="M006108_title" class="title">
    <b>test_calling_first_or_last_on_existing_record_with_build_should_load_association</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006108_source')" id="l_M006108_source">show source</a> ]</p>
  <div id="M006108_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 1023</span>
1023:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_calling_first_or_last_on_existing_record_with_build_should_load_association</span>
1024:     <span class="ruby-identifier">firm</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>)
1025:     <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">build</span>(<span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'Foo'</span>)
1026:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">loaded?</span>
1027: 
1028:     <span class="ruby-identifier">assert_queries</span> <span class="ruby-value">1</span> <span class="ruby-keyword kw">do</span>
1029:       <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">first</span>
1030:       <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">last</span>
1031:     <span class="ruby-keyword kw">end</span>
1032: 
1033:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">loaded?</span>
1034:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006109" class="method">
  <div id="M006109_title" class="title">
    <b>test_calling_first_or_last_on_existing_record_with_create_should_not_load_association</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006109_source')" id="l_M006109_source">show source</a> ]</p>
  <div id="M006109_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 1036</span>
1036:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_calling_first_or_last_on_existing_record_with_create_should_not_load_association</span>
1037:     <span class="ruby-identifier">firm</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>)
1038:     <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'Foo'</span>)
1039:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">loaded?</span>
1040: 
1041:     <span class="ruby-identifier">assert_queries</span> <span class="ruby-value">2</span> <span class="ruby-keyword kw">do</span>
1042:       <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">first</span>
1043:       <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">last</span>
1044:     <span class="ruby-keyword kw">end</span>
1045: 
1046:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">loaded?</span>
1047:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006107" class="method">
  <div id="M006107_title" class="title">
    <b>test_calling_first_or_last_on_loaded_association_should_not_fetch_with_query</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006107_source')" id="l_M006107_source">show source</a> ]</p>
  <div id="M006107_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 1010</span>
1010:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_calling_first_or_last_on_loaded_association_should_not_fetch_with_query</span>
1011:     <span class="ruby-identifier">firm</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>)
1012:     <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">class</span> <span class="ruby-comment cmt"># force load target</span>
1013:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">loaded?</span>
1014: 
1015:     <span class="ruby-identifier">assert_no_queries</span> <span class="ruby-keyword kw">do</span>
1016:       <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">first</span>
1017:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">first</span>(<span class="ruby-value">2</span>).<span class="ruby-identifier">size</span>
1018:       <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">last</span>
1019:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">last</span>(<span class="ruby-value">2</span>).<span class="ruby-identifier">size</span>
1020:     <span class="ruby-keyword kw">end</span>
1021:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006110" class="method">
  <div id="M006110_title" class="title">
    <b>test_calling_first_or_last_on_new_record_should_not_run_queries</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006110_source')" id="l_M006110_source">show source</a> ]</p>
  <div id="M006110_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 1049</span>
1049:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_calling_first_or_last_on_new_record_should_not_run_queries</span>
1050:     <span class="ruby-identifier">firm</span> = <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">new</span>
1051: 
1052:     <span class="ruby-identifier">assert_no_queries</span> <span class="ruby-keyword kw">do</span>
1053:       <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">first</span>
1054:       <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">last</span>
1055:     <span class="ruby-keyword kw">end</span>
1056:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006111" class="method">
  <div id="M006111_title" class="title">
    <b>test_calling_first_or_last_with_find_options_on_loaded_association_should_fetch_with_query</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006111_source')" id="l_M006111_source">show source</a> ]</p>
  <div id="M006111_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 1058</span>
1058:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_calling_first_or_last_with_find_options_on_loaded_association_should_fetch_with_query</span>
1059:     <span class="ruby-identifier">firm</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>)
1060:     <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">class</span> <span class="ruby-comment cmt"># force load target</span>
1061: 
1062:     <span class="ruby-identifier">assert_queries</span> <span class="ruby-value">2</span> <span class="ruby-keyword kw">do</span>
1063:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">loaded?</span>
1064:       <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">first</span>(<span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'name'</span>)
1065:       <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">last</span>(<span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'name'</span>)
1066:     <span class="ruby-keyword kw">end</span>
1067:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006112" class="method">
  <div id="M006112_title" class="title">
    <b>test_calling_first_or_last_with_integer_on_association_should_load_association</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006112_source')" id="l_M006112_source">show source</a> ]</p>
  <div id="M006112_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 1069</span>
1069:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_calling_first_or_last_with_integer_on_association_should_load_association</span>
1070:     <span class="ruby-identifier">firm</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>)
1071: 
1072:     <span class="ruby-identifier">assert_queries</span> <span class="ruby-value">1</span> <span class="ruby-keyword kw">do</span>
1073:       <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">first</span>(<span class="ruby-value">2</span>)
1074:       <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">last</span>(<span class="ruby-value">2</span>)
1075:     <span class="ruby-keyword kw">end</span>
1076: 
1077:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">loaded?</span>
1078:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005999" class="method">
  <div id="M005999_title" class="title">
    <b>test_cant_save_has_many_readonly_association</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005999_source')" id="l_M005999_source">show source</a> ]</p>
  <div id="M005999_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 113</span>
113:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_cant_save_has_many_readonly_association</span>
114:     <span class="ruby-identifier">authors</span>(<span class="ruby-identifier">:david</span>).<span class="ruby-identifier">readonly_comments</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span> <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">ReadOnlyRecord</span>) { <span class="ruby-identifier">c</span>.<span class="ruby-identifier">save!</span> } }
115:     <span class="ruby-identifier">authors</span>(<span class="ruby-identifier">:david</span>).<span class="ruby-identifier">readonly_comments</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span> <span class="ruby-identifier">assert</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">readonly?</span> }
116:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006056" class="method">
  <div id="M006056_title" class="title">
    <b>test_clearing_a_dependent_association_collection</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006056_source')" id="l_M006056_source">show source</a> ]</p>
  <div id="M006056_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 582</span>
582:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_clearing_a_dependent_association_collection</span>
583:     <span class="ruby-identifier">firm</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>)
584:     <span class="ruby-identifier">client_id</span> = <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">dependent_clients_of_firm</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">id</span>
585:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">dependent_clients_of_firm</span>.<span class="ruby-identifier">size</span>
586: 
587:     <span class="ruby-comment cmt"># :dependent means destroy is called on each client</span>
588:     <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">dependent_clients_of_firm</span>.<span class="ruby-identifier">clear</span>
589: 
590:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">dependent_clients_of_firm</span>.<span class="ruby-identifier">size</span>
591:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">dependent_clients_of_firm</span>(<span class="ruby-keyword kw">true</span>).<span class="ruby-identifier">size</span>
592:     <span class="ruby-identifier">assert_equal</span> [<span class="ruby-identifier">client_id</span>], <span class="ruby-constant">Client</span>.<span class="ruby-identifier">destroyed_client_ids</span>[<span class="ruby-identifier">firm</span>.<span class="ruby-identifier">id</span>]
593: 
594:     <span class="ruby-comment cmt"># Should be destroyed since the association is dependent.</span>
595:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">Client</span>.<span class="ruby-identifier">find_by_id</span>(<span class="ruby-identifier">client_id</span>).<span class="ruby-identifier">nil?</span>
596:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006054" class="method">
  <div id="M006054_title" class="title">
    <b>test_clearing_an_association_collection</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006054_source')" id="l_M006054_source">show source</a> ]</p>
  <div id="M006054_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 557</span>
557:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_clearing_an_association_collection</span>
558:     <span class="ruby-identifier">firm</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>)
559:     <span class="ruby-identifier">client_id</span> = <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">id</span>
560:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">size</span>
561: 
562:     <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">clear</span>
563: 
564:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">size</span>
565:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients_of_firm</span>(<span class="ruby-keyword kw">true</span>).<span class="ruby-identifier">size</span>
566:     <span class="ruby-identifier">assert_equal</span> [], <span class="ruby-constant">Client</span>.<span class="ruby-identifier">destroyed_client_ids</span>[<span class="ruby-identifier">firm</span>.<span class="ruby-identifier">id</span>]
567: 
568:     <span class="ruby-comment cmt"># Should not be destroyed since the association is not dependent.</span>
569:     <span class="ruby-identifier">assert_nothing_raised</span> <span class="ruby-keyword kw">do</span>
570:       <span class="ruby-identifier">assert</span> <span class="ruby-constant">Client</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">client_id</span>).<span class="ruby-identifier">firm</span>.<span class="ruby-identifier">nil?</span>
571:     <span class="ruby-keyword kw">end</span>
572:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006057" class="method">
  <div id="M006057_title" class="title">
    <b>test_clearing_an_exclusively_dependent_association_collection</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006057_source')" id="l_M006057_source">show source</a> ]</p>
  <div id="M006057_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 598</span>
598:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_clearing_an_exclusively_dependent_association_collection</span>
599:     <span class="ruby-identifier">firm</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>)
600:     <span class="ruby-identifier">client_id</span> = <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">exclusively_dependent_clients_of_firm</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">id</span>
601:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">exclusively_dependent_clients_of_firm</span>.<span class="ruby-identifier">size</span>
602: 
603:     <span class="ruby-identifier">assert_equal</span> [], <span class="ruby-constant">Client</span>.<span class="ruby-identifier">destroyed_client_ids</span>[<span class="ruby-identifier">firm</span>.<span class="ruby-identifier">id</span>]
604: 
605:     <span class="ruby-comment cmt"># :exclusively_dependent means each client is deleted directly from</span>
606:     <span class="ruby-comment cmt"># the database without looping through them calling destroy.</span>
607:     <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">exclusively_dependent_clients_of_firm</span>.<span class="ruby-identifier">clear</span>
608: 
609:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">exclusively_dependent_clients_of_firm</span>.<span class="ruby-identifier">size</span>
610:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">exclusively_dependent_clients_of_firm</span>(<span class="ruby-keyword kw">true</span>).<span class="ruby-identifier">size</span>
611:     <span class="ruby-comment cmt"># no destroy-filters should have been called</span>
612:     <span class="ruby-identifier">assert_equal</span> [], <span class="ruby-constant">Client</span>.<span class="ruby-identifier">destroyed_client_ids</span>[<span class="ruby-identifier">firm</span>.<span class="ruby-identifier">id</span>]
613: 
614:     <span class="ruby-comment cmt"># Should be destroyed since the association is exclusively dependent.</span>
615:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">Client</span>.<span class="ruby-identifier">find_by_id</span>(<span class="ruby-identifier">client_id</span>).<span class="ruby-identifier">nil?</span>
616:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006055" class="method">
  <div id="M006055_title" class="title">
    <b>test_clearing_updates_counter_cache</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006055_source')" id="l_M006055_source">show source</a> ]</p>
  <div id="M006055_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 574</span>
574:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_clearing_updates_counter_cache</span>
575:     <span class="ruby-identifier">topic</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">first</span>
576: 
577:     <span class="ruby-identifier">topic</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">clear</span>
578:     <span class="ruby-identifier">topic</span>.<span class="ruby-identifier">reload</span>
579:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-identifier">topic</span>.<span class="ruby-identifier">replies_count</span>
580:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006064" class="method">
  <div id="M006064_title" class="title">
    <b>test_clearing_without_initial_access</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006064_source')" id="l_M006064_source">show source</a> ]</p>
  <div id="M006064_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 685</span>
685:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_clearing_without_initial_access</span>
686:     <span class="ruby-identifier">firm</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>)
687: 
688:     <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">clear</span>
689: 
690:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">size</span>
691:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients_of_firm</span>(<span class="ruby-keyword kw">true</span>).<span class="ruby-identifier">size</span>
692:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006034" class="method">
  <div id="M006034_title" class="title">
    <b>test_collection_size_after_building</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006034_source')" id="l_M006034_source">show source</a> ]</p>
  <div id="M006034_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 380</span>
380:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_collection_size_after_building</span>
381:     <span class="ruby-identifier">company</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>)  <span class="ruby-comment cmt"># company already has one client</span>
382:     <span class="ruby-identifier">company</span>.<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">build</span>(<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Another Client&quot;</span>)
383:     <span class="ruby-identifier">company</span>.<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">build</span>(<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Yet Another Client&quot;</span>)
384:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">3</span>, <span class="ruby-identifier">company</span>.<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">size</span>
385:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006035" class="method">
  <div id="M006035_title" class="title">
    <b>test_collection_size_twice_for_regressions</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006035_source')" id="l_M006035_source">show source</a> ]</p>
  <div id="M006035_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 387</span>
387:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_collection_size_twice_for_regressions</span>
388:     <span class="ruby-identifier">post</span> = <span class="ruby-identifier">posts</span>(<span class="ruby-identifier">:thinking</span>)
389:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-identifier">post</span>.<span class="ruby-identifier">readers</span>.<span class="ruby-identifier">size</span>
390:     <span class="ruby-comment cmt"># This test needs a post that has no readers, we assert it to ensure it holds,</span>
391:     <span class="ruby-comment cmt"># but need to reload the post because the very call to #size hides the bug.</span>
392:     <span class="ruby-identifier">post</span>.<span class="ruby-identifier">reload</span>
393:     <span class="ruby-identifier">post</span>.<span class="ruby-identifier">readers</span>.<span class="ruby-identifier">build</span>
394:     <span class="ruby-identifier">size1</span> = <span class="ruby-identifier">post</span>.<span class="ruby-identifier">readers</span>.<span class="ruby-identifier">size</span>
395:     <span class="ruby-identifier">size2</span> = <span class="ruby-identifier">post</span>.<span class="ruby-identifier">readers</span>.<span class="ruby-identifier">size</span>
396:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">size1</span>, <span class="ruby-identifier">size2</span>
397:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005982" class="method">
  <div id="M005982_title" class="title">
    <b>test_counting</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005982_source')" id="l_M005982_source">show source</a> ]</p>
  <div id="M005982_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 32</span>
32:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_counting</span>
33:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>).<span class="ruby-identifier">plain_clients</span>.<span class="ruby-identifier">count</span>
34:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006009" class="method">
  <div id="M006009_title" class="title">
    <b>test_counting_non_existant_items_using_sql</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006009_source')" id="l_M006009_source">show source</a> ]</p>
  <div id="M006009_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 163</span>
163:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_counting_non_existant_items_using_sql</span>
164:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>).<span class="ruby-identifier">no_clients_using_counter_sql</span>.<span class="ruby-identifier">size</span>
165:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006008" class="method">
  <div id="M006008_title" class="title">
    <b>test_counting_using_sql</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006008_source')" id="l_M006008_source">show source</a> ]</p>
  <div id="M006008_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 156</span>
156:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_counting_using_sql</span>
157:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>).<span class="ruby-identifier">clients_using_counter_sql</span>.<span class="ruby-identifier">size</span>
158:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>).<span class="ruby-identifier">clients_using_counter_sql</span>.<span class="ruby-identifier">any?</span>
159:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>).<span class="ruby-identifier">clients_using_zero_counter_sql</span>.<span class="ruby-identifier">size</span>
160:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>).<span class="ruby-identifier">clients_using_zero_counter_sql</span>.<span class="ruby-identifier">any?</span>
161:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005987" class="method">
  <div id="M005987_title" class="title">
    <b>test_counting_with_association_limit</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005987_source')" id="l_M005987_source">show source</a> ]</p>
  <div id="M005987_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 52</span>
52:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_counting_with_association_limit</span>
53:     <span class="ruby-identifier">firm</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>)
54:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">limited_clients</span>.<span class="ruby-identifier">length</span>, <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">limited_clients</span>.<span class="ruby-identifier">size</span>
55:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">limited_clients</span>.<span class="ruby-identifier">length</span>, <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">limited_clients</span>.<span class="ruby-identifier">count</span>
56:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005986" class="method">
  <div id="M005986_title" class="title">
    <b>test_counting_with_column_name_and_hash</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005986_source')" id="l_M005986_source">show source</a> ]</p>
  <div id="M005986_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 48</span>
48:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_counting_with_column_name_and_hash</span>
49:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>).<span class="ruby-identifier">plain_clients</span>.<span class="ruby-identifier">count</span>(<span class="ruby-identifier">:name</span>)
50:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005981" class="method">
  <div id="M005981_title" class="title">
    <b>test_counting_with_counter_sql</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005981_source')" id="l_M005981_source">show source</a> ]</p>
  <div id="M005981_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 28</span>
28:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_counting_with_counter_sql</span>
29:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>).<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">count</span>
30:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005983" class="method">
  <div id="M005983_title" class="title">
    <b>test_counting_with_empty_hash_conditions</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005983_source')" id="l_M005983_source">show source</a> ]</p>
  <div id="M005983_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 36</span>
36:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_counting_with_empty_hash_conditions</span>
37:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>).<span class="ruby-identifier">plain_clients</span>.<span class="ruby-identifier">count</span>(<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> {})
38:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005984" class="method">
  <div id="M005984_title" class="title">
    <b>test_counting_with_single_conditions</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005984_source')" id="l_M005984_source">show source</a> ]</p>
  <div id="M005984_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 40</span>
40:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_counting_with_single_conditions</span>
41:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>).<span class="ruby-identifier">plain_clients</span>.<span class="ruby-identifier">count</span>(<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">'name=?'</span>, <span class="ruby-value str">&quot;Microsoft&quot;</span>])
42:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005985" class="method">
  <div id="M005985_title" class="title">
    <b>test_counting_with_single_hash</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005985_source')" id="l_M005985_source">show source</a> ]</p>
  <div id="M005985_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 44</span>
44:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_counting_with_single_hash</span>
45:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>).<span class="ruby-identifier">plain_clients</span>.<span class="ruby-identifier">count</span>(<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> {<span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Microsoft&quot;</span>})
46:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006042" class="method">
  <div id="M006042_title" class="title">
    <b>test_create</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006042_source')" id="l_M006042_source">show source</a> ]</p>
  <div id="M006042_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 463</span>
463:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_create</span>
464:     <span class="ruby-identifier">force_signal37_to_load_all_clients_of_firm</span>
465:     <span class="ruby-identifier">new_client</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Another Client&quot;</span>)
466:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">new_client</span>.<span class="ruby-identifier">new_record?</span>
467:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">new_client</span>, <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">last</span>
468:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">new_client</span>, <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>(<span class="ruby-keyword kw">true</span>).<span class="ruby-identifier">last</span>
469:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006044" class="method">
  <div id="M006044_title" class="title">
    <b>test_create_followed_by_save_does_not_load_target</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006044_source')" id="l_M006044_source">show source</a> ]</p>
  <div id="M006044_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 476</span>
476:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_create_followed_by_save_does_not_load_target</span>
477:     <span class="ruby-identifier">new_client</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Another Client&quot;</span>)
478:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">save</span>
479:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">loaded?</span>
480:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006043" class="method">
  <div id="M006043_title" class="title">
    <b>test_create_many</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006043_source')" id="l_M006043_source">show source</a> ]</p>
  <div id="M006043_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 471</span>
471:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_create_many</span>
472:     <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">create</span>([{<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Another Client&quot;</span>}, {<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Another Client II&quot;</span>}])
473:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">3</span>, <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>(<span class="ruby-keyword kw">true</span>).<span class="ruby-identifier">size</span>
474:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006030" class="method">
  <div id="M006030_title" class="title">
    <b>test_create_with_bang_on_habtm_when_parent_is_new_raises</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006030_source')" id="l_M006030_source">show source</a> ]</p>
  <div id="M006030_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 351</span>
351:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_create_with_bang_on_habtm_when_parent_is_new_raises</span>
352:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">RecordNotSaved</span>) <span class="ruby-keyword kw">do</span>
353:       <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Aredridel&quot;</span>).<span class="ruby-identifier">projects</span>.<span class="ruby-identifier">create!</span>
354:     <span class="ruby-keyword kw">end</span>
355:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006029" class="method">
  <div id="M006029_title" class="title">
    <b>test_create_with_bang_on_has_many_raises_when_record_not_saved</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006029_source')" id="l_M006029_source">show source</a> ]</p>
  <div id="M006029_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 344</span>
344:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_create_with_bang_on_has_many_raises_when_record_not_saved</span>
345:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">RecordInvalid</span>) <span class="ruby-keyword kw">do</span>
346:       <span class="ruby-identifier">firm</span> = <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>)
347:       <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">plain_clients</span>.<span class="ruby-identifier">create!</span>
348:     <span class="ruby-keyword kw">end</span>
349:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006027" class="method">
  <div id="M006027_title" class="title">
    <b>test_create_with_bang_on_has_many_when_parent_is_new_raises</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006027_source')" id="l_M006027_source">show source</a> ]</p>
  <div id="M006027_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 330</span>
330:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_create_with_bang_on_has_many_when_parent_is_new_raises</span>
331:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">RecordNotSaved</span>) <span class="ruby-keyword kw">do</span>
332:       <span class="ruby-identifier">firm</span> = <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">new</span>
333:       <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">plain_clients</span>.<span class="ruby-identifier">create!</span> <span class="ruby-identifier">:name=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;Whoever&quot;</span>
334:     <span class="ruby-keyword kw">end</span>
335:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006041" class="method">
  <div id="M006041_title" class="title">
    <b>test_create_without_loading_association</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006041_source')" id="l_M006041_source">show source</a> ]</p>
  <div id="M006041_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 448</span>
448:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_create_without_loading_association</span>
449:     <span class="ruby-identifier">first_firm</span>  = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>)
450:     <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">column_names</span>
451:     <span class="ruby-constant">Client</span>.<span class="ruby-identifier">column_names</span>
452: 
453:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">first_firm</span>.<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">size</span>
454:     <span class="ruby-identifier">first_firm</span>.<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">reset</span>
455: 
456:     <span class="ruby-identifier">assert_queries</span>(<span class="ruby-value">1</span>) <span class="ruby-keyword kw">do</span>
457:       <span class="ruby-identifier">first_firm</span>.<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Superstars&quot;</span>)
458:     <span class="ruby-keyword kw">end</span>
459: 
460:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-identifier">first_firm</span>.<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">size</span>
461:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006117" class="method">
  <div id="M006117_title" class="title">
    <b>test_creating_using_primary_key</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006117_source')" id="l_M006117_source">show source</a> ]</p>
  <div id="M006117_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 1116</span>
1116:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_creating_using_primary_key</span>
1117:     <span class="ruby-identifier">firm</span> = <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>)
1118:     <span class="ruby-identifier">client</span> = <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients_using_primary_key</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'test'</span>)
1119:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">name</span>, <span class="ruby-identifier">client</span>.<span class="ruby-identifier">firm_name</span>
1120:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006061" class="method">
  <div id="M006061_title" class="title">
    <b>test_creation_respects_hash_condition</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006061_source')" id="l_M006061_source">show source</a> ]</p>
  <div id="M006061_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 655</span>
655:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_creation_respects_hash_condition</span>
656:     <span class="ruby-identifier">ms_client</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_like_ms_with_hash_conditions</span>.<span class="ruby-identifier">build</span>
657: 
658:     <span class="ruby-identifier">assert</span>        <span class="ruby-identifier">ms_client</span>.<span class="ruby-identifier">save</span>
659:     <span class="ruby-identifier">assert_equal</span>  <span class="ruby-value str">'Microsoft'</span>, <span class="ruby-identifier">ms_client</span>.<span class="ruby-identifier">name</span>
660: 
661:     <span class="ruby-identifier">another_ms_client</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_like_ms_with_hash_conditions</span>.<span class="ruby-identifier">create</span>
662: 
663:     <span class="ruby-identifier">assert</span>        <span class="ruby-operator">!</span><span class="ruby-identifier">another_ms_client</span>.<span class="ruby-identifier">new_record?</span>
664:     <span class="ruby-identifier">assert_equal</span>  <span class="ruby-value str">'Microsoft'</span>, <span class="ruby-identifier">another_ms_client</span>.<span class="ruby-identifier">name</span>
665:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006052" class="method">
  <div id="M006052_title" class="title">
    <b>test_delete_all</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006052_source')" id="l_M006052_source">show source</a> ]</p>
  <div id="M006052_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 538</span>
538:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_delete_all</span>
539:     <span class="ruby-identifier">force_signal37_to_load_all_clients_of_firm</span>
540:     <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Another Client&quot;</span>)
541:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">size</span>
542:     <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">delete_all</span>
543:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">size</span>
544:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>(<span class="ruby-keyword kw">true</span>).<span class="ruby-identifier">size</span>
545:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006053" class="method">
  <div id="M006053_title" class="title">
    <b>test_delete_all_with_not_yet_loaded_association_collection</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006053_source')" id="l_M006053_source">show source</a> ]</p>
  <div id="M006053_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 547</span>
547:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_delete_all_with_not_yet_loaded_association_collection</span>
548:     <span class="ruby-identifier">force_signal37_to_load_all_clients_of_firm</span>
549:     <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Another Client&quot;</span>)
550:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">size</span>
551:     <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">reset</span>
552:     <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">delete_all</span>
553:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">size</span>
554:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>(<span class="ruby-keyword kw">true</span>).<span class="ruby-identifier">size</span>
555:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006047" class="method">
  <div id="M006047_title" class="title">
    <b>test_deleting</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006047_source')" id="l_M006047_source">show source</a> ]</p>
  <div id="M006047_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 497</span>
497:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_deleting</span>
498:     <span class="ruby-identifier">force_signal37_to_load_all_clients_of_firm</span>
499:     <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">first</span>)
500:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">size</span>
501:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>(<span class="ruby-keyword kw">true</span>).<span class="ruby-identifier">size</span>
502:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006051" class="method">
  <div id="M006051_title" class="title">
    <b>test_deleting_a_collection</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006051_source')" id="l_M006051_source">show source</a> ]</p>
  <div id="M006051_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 529</span>
529:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_deleting_a_collection</span>
530:     <span class="ruby-identifier">force_signal37_to_load_all_clients_of_firm</span>
531:     <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Another Client&quot;</span>)
532:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">size</span>
533:     <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">delete</span>([<span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>[<span class="ruby-value">0</span>], <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>[<span class="ruby-value">1</span>]])
534:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">size</span>
535:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>(<span class="ruby-keyword kw">true</span>).<span class="ruby-identifier">size</span>
536:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006065" class="method">
  <div id="M006065_title" class="title">
    <b>test_deleting_a_item_which_is_not_in_the_collection</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006065_source')" id="l_M006065_source">show source</a> ]</p>
  <div id="M006065_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 694</span>
694:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_deleting_a_item_which_is_not_in_the_collection</span>
695:     <span class="ruby-identifier">force_signal37_to_load_all_clients_of_firm</span>
696:     <span class="ruby-identifier">summit</span> = <span class="ruby-constant">Client</span>.<span class="ruby-identifier">find_by_name</span>(<span class="ruby-value str">'Summit'</span>)
697:     <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">summit</span>)
698:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">size</span>
699:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>(<span class="ruby-keyword kw">true</span>).<span class="ruby-identifier">size</span>
700:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-identifier">summit</span>.<span class="ruby-identifier">client_of</span>
701:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006048" class="method">
  <div id="M006048_title" class="title">
    <b>test_deleting_before_save</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006048_source')" id="l_M006048_source">show source</a> ]</p>
  <div id="M006048_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 504</span>
504:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_deleting_before_save</span>
505:     <span class="ruby-identifier">new_firm</span> = <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;A New Firm, Inc.&quot;</span>)
506:     <span class="ruby-identifier">new_client</span> = <span class="ruby-identifier">new_firm</span>.<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">build</span>(<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Another Client&quot;</span>)
507:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">new_firm</span>.<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">size</span>
508:     <span class="ruby-identifier">new_firm</span>.<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">new_client</span>)
509:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-identifier">new_firm</span>.<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">size</span>
510:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006067" class="method">
  <div id="M006067_title" class="title">
    <b>test_deleting_self_type_mismatch</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006067_source')" id="l_M006067_source">show source</a> ]</p>
  <div id="M006067_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 709</span>
709:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_deleting_self_type_mismatch</span>
710:     <span class="ruby-identifier">david</span> = <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">1</span>)
711:     <span class="ruby-identifier">david</span>.<span class="ruby-identifier">projects</span>.<span class="ruby-identifier">reload</span>
712:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">AssociationTypeMismatch</span>) { <span class="ruby-identifier">david</span>.<span class="ruby-identifier">projects</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-constant">Project</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">1</span>).<span class="ruby-identifier">developers</span>) }
713:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006066" class="method">
  <div id="M006066_title" class="title">
    <b>test_deleting_type_mismatch</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006066_source')" id="l_M006066_source">show source</a> ]</p>
  <div id="M006066_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 703</span>
703:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_deleting_type_mismatch</span>
704:     <span class="ruby-identifier">david</span> = <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">1</span>)
705:     <span class="ruby-identifier">david</span>.<span class="ruby-identifier">projects</span>.<span class="ruby-identifier">reload</span>
706:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">AssociationTypeMismatch</span>) { <span class="ruby-identifier">david</span>.<span class="ruby-identifier">projects</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">1</span>) }
707:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006049" class="method">
  <div id="M006049_title" class="title">
    <b>test_deleting_updates_counter_cache</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006049_source')" id="l_M006049_source">show source</a> ]</p>
  <div id="M006049_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 512</span>
512:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_deleting_updates_counter_cache</span>
513:     <span class="ruby-identifier">topic</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">first</span>
514:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">topic</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">to_a</span>.<span class="ruby-identifier">size</span>, <span class="ruby-identifier">topic</span>.<span class="ruby-identifier">replies_count</span>
515: 
516:     <span class="ruby-identifier">topic</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">topic</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">first</span>)
517:     <span class="ruby-identifier">topic</span>.<span class="ruby-identifier">reload</span>
518:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">topic</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">to_a</span>.<span class="ruby-identifier">size</span>, <span class="ruby-identifier">topic</span>.<span class="ruby-identifier">replies_count</span>
519:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006050" class="method">
  <div id="M006050_title" class="title">
    <b>test_deleting_updates_counter_cache_without_dependent_destroy</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006050_source')" id="l_M006050_source">show source</a> ]</p>
  <div id="M006050_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 521</span>
521:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_deleting_updates_counter_cache_without_dependent_destroy</span>
522:     <span class="ruby-identifier">post</span> = <span class="ruby-identifier">posts</span>(<span class="ruby-identifier">:welcome</span>)
523: 
524:     <span class="ruby-identifier">assert_difference</span> <span class="ruby-value str">&quot;post.reload.taggings_count&quot;</span>, <span class="ruby-value">-1</span> <span class="ruby-keyword kw">do</span>
525:       <span class="ruby-identifier">post</span>.<span class="ruby-identifier">taggings</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">post</span>.<span class="ruby-identifier">taggings</span>.<span class="ruby-identifier">first</span>)
526:     <span class="ruby-keyword kw">end</span>
527:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006073" class="method">
  <div id="M006073_title" class="title">
    <b>test_dependence</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006073_source')" id="l_M006073_source">show source</a> ]</p>
  <div id="M006073_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 769</span>
769:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_dependence</span>
770:     <span class="ruby-identifier">firm</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>)
771:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">size</span>
772:     <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">destroy</span>
773:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">Client</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;firm_id=#{firm.id}&quot;</span>).<span class="ruby-identifier">empty?</span>
774:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006074" class="method">
  <div id="M006074_title" class="title">
    <b>test_dependence_for_associations_with_hash_condition</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006074_source')" id="l_M006074_source">show source</a> ]</p>
  <div id="M006074_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 776</span>
776:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_dependence_for_associations_with_hash_condition</span>
777:     <span class="ruby-identifier">david</span> = <span class="ruby-identifier">authors</span>(<span class="ruby-identifier">:david</span>)
778:     <span class="ruby-identifier">post</span> = <span class="ruby-identifier">posts</span>(<span class="ruby-identifier">:thinking</span>).<span class="ruby-identifier">id</span>
779:     <span class="ruby-identifier">assert_difference</span>(<span class="ruby-value str">'Post.count'</span>, <span class="ruby-value">-1</span>) { <span class="ruby-identifier">assert</span> <span class="ruby-identifier">david</span>.<span class="ruby-identifier">destroy</span> }
780:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006079" class="method">
  <div id="M006079_title" class="title">
    <b>test_dependence_on_account</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006079_source')" id="l_M006079_source">show source</a> ]</p>
  <div id="M006079_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 814</span>
814:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_dependence_on_account</span>
815:     <span class="ruby-identifier">num_accounts</span> = <span class="ruby-constant">Account</span>.<span class="ruby-identifier">count</span>
816:     <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">destroy</span>
817:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">num_accounts</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>, <span class="ruby-constant">Account</span>.<span class="ruby-identifier">count</span>
818:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006077" class="method">
  <div id="M006077_title" class="title">
    <b>test_dependence_with_transaction_support_on_failure</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006077_source')" id="l_M006077_source">show source</a> ]</p>
  <div id="M006077_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 803</span>
803:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_dependence_with_transaction_support_on_failure</span>
804:     <span class="ruby-identifier">firm</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>)
805:     <span class="ruby-identifier">clients</span> = <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>
806:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-identifier">clients</span>.<span class="ruby-identifier">length</span>
807:     <span class="ruby-identifier">clients</span>.<span class="ruby-identifier">last</span>.<span class="ruby-identifier">instance_eval</span> { <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">before_destroy</span>() <span class="ruby-identifier">raise</span> <span class="ruby-value str">&quot;Trigger rollback&quot;</span> <span class="ruby-keyword kw">end</span> }
808: 
809:     <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">destroy</span> <span class="ruby-keyword kw">rescue</span> <span class="ruby-value str">&quot;do nothing&quot;</span>
810: 
811:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-constant">Client</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;firm_id=#{firm.id}&quot;</span>).<span class="ruby-identifier">size</span>
812:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006058" class="method">
  <div id="M006058_title" class="title">
    <b>test_dependent_association_respects_optional_conditions_on_delete</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006058_source')" id="l_M006058_source">show source</a> ]</p>
  <div id="M006058_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 618</span>
618:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_dependent_association_respects_optional_conditions_on_delete</span>
619:     <span class="ruby-identifier">firm</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:odegy</span>)
620:     <span class="ruby-constant">Client</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:client_of</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;BigShot Inc.&quot;</span>)
621:     <span class="ruby-constant">Client</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:client_of</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;SmallTime Inc.&quot;</span>)
622:     <span class="ruby-comment cmt"># only one of two clients is included in the association due to the :conditions key</span>
623:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-constant">Client</span>.<span class="ruby-identifier">find_all_by_client_of</span>(<span class="ruby-identifier">firm</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">size</span>
624:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">dependent_conditional_clients_of_firm</span>.<span class="ruby-identifier">size</span>
625:     <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">destroy</span>
626:     <span class="ruby-comment cmt"># only the correctly associated client should have been deleted</span>
627:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-constant">Client</span>.<span class="ruby-identifier">find_all_by_client_of</span>(<span class="ruby-identifier">firm</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">size</span>
628:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006060" class="method">
  <div id="M006060_title" class="title">
    <b>test_dependent_association_respects_optional_hash_conditions_on_delete</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006060_source')" id="l_M006060_source">show source</a> ]</p>
  <div id="M006060_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 642</span>
642:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_dependent_association_respects_optional_hash_conditions_on_delete</span>
643:     <span class="ruby-identifier">firm</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:odegy</span>)
644:     <span class="ruby-constant">Client</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:client_of</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;BigShot Inc.&quot;</span>)
645:     <span class="ruby-constant">Client</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:client_of</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;SmallTime Inc.&quot;</span>)
646:     <span class="ruby-comment cmt"># only one of two clients is included in the association due to the :conditions key</span>
647:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-constant">Client</span>.<span class="ruby-identifier">find_all_by_client_of</span>(<span class="ruby-identifier">firm</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">size</span>
648:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">dependent_sanitized_conditional_clients_of_firm</span>.<span class="ruby-identifier">size</span>
649:     <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">destroy</span>
650:     <span class="ruby-comment cmt"># only the correctly associated client should have been deleted</span>
651:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-constant">Client</span>.<span class="ruby-identifier">find_all_by_client_of</span>(<span class="ruby-identifier">firm</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">size</span>
652:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006059" class="method">
  <div id="M006059_title" class="title">
    <b>test_dependent_association_respects_optional_sanitized_conditions_on_delete</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006059_source')" id="l_M006059_source">show source</a> ]</p>
  <div id="M006059_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 630</span>
630:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_dependent_association_respects_optional_sanitized_conditions_on_delete</span>
631:     <span class="ruby-identifier">firm</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:odegy</span>)
632:     <span class="ruby-constant">Client</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:client_of</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;BigShot Inc.&quot;</span>)
633:     <span class="ruby-constant">Client</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:client_of</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;SmallTime Inc.&quot;</span>)
634:     <span class="ruby-comment cmt"># only one of two clients is included in the association due to the :conditions key</span>
635:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-constant">Client</span>.<span class="ruby-identifier">find_all_by_client_of</span>(<span class="ruby-identifier">firm</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">size</span>
636:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">dependent_sanitized_conditional_clients_of_firm</span>.<span class="ruby-identifier">size</span>
637:     <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">destroy</span>
638:     <span class="ruby-comment cmt"># only the correctly associated client should have been deleted</span>
639:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-constant">Client</span>.<span class="ruby-identifier">find_all_by_client_of</span>(<span class="ruby-identifier">firm</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">size</span>
640:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006062" class="method">
  <div id="M006062_title" class="title">
    <b>test_dependent_delete_and_destroy_with_belongs_to</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006062_source')" id="l_M006062_source">show source</a> ]</p>
  <div id="M006062_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 667</span>
667:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_dependent_delete_and_destroy_with_belongs_to</span>
668:     <span class="ruby-identifier">author_address</span> = <span class="ruby-identifier">author_addresses</span>(<span class="ruby-identifier">:david_address</span>)
669:     <span class="ruby-identifier">assert_equal</span> [], <span class="ruby-constant">AuthorAddress</span>.<span class="ruby-identifier">destroyed_author_address_ids</span>[<span class="ruby-identifier">authors</span>(<span class="ruby-identifier">:david</span>).<span class="ruby-identifier">id</span>]
670: 
671:     <span class="ruby-identifier">assert_difference</span> <span class="ruby-value str">&quot;AuthorAddress.count&quot;</span>, <span class="ruby-value">-2</span> <span class="ruby-keyword kw">do</span>
672:       <span class="ruby-identifier">authors</span>(<span class="ruby-identifier">:david</span>).<span class="ruby-identifier">destroy</span>
673:     <span class="ruby-keyword kw">end</span>
674: 
675:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-keyword kw">nil</span>, <span class="ruby-constant">AuthorAddress</span>.<span class="ruby-identifier">find_by_id</span>(<span class="ruby-identifier">authors</span>(<span class="ruby-identifier">:david</span>).<span class="ruby-identifier">author_address_id</span>)
676:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-keyword kw">nil</span>, <span class="ruby-constant">AuthorAddress</span>.<span class="ruby-identifier">find_by_id</span>(<span class="ruby-identifier">authors</span>(<span class="ruby-identifier">:david</span>).<span class="ruby-identifier">author_address_extra_id</span>)
677:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006080" class="method">
  <div id="M006080_title" class="title">
    <b>test_depends_and_nullify</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006080_source')" id="l_M006080_source">show source</a> ]</p>
  <div id="M006080_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 820</span>
820:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_depends_and_nullify</span>
821:     <span class="ruby-identifier">num_accounts</span> = <span class="ruby-constant">Account</span>.<span class="ruby-identifier">count</span>
822:     <span class="ruby-identifier">num_companies</span> = <span class="ruby-constant">Company</span>.<span class="ruby-identifier">count</span>
823: 
824:     <span class="ruby-identifier">core</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:rails_core</span>)
825:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">accounts</span>(<span class="ruby-identifier">:rails_core_account</span>), <span class="ruby-identifier">core</span>.<span class="ruby-identifier">account</span>
826:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:leetsoft</span>, <span class="ruby-identifier">:jadedpixel</span>), <span class="ruby-identifier">core</span>.<span class="ruby-identifier">companies</span>
827:     <span class="ruby-identifier">core</span>.<span class="ruby-identifier">destroy</span>
828:     <span class="ruby-identifier">assert_nil</span> <span class="ruby-identifier">accounts</span>(<span class="ruby-identifier">:rails_core_account</span>).<span class="ruby-identifier">reload</span>.<span class="ruby-identifier">firm_id</span>
829:     <span class="ruby-identifier">assert_nil</span> <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:leetsoft</span>).<span class="ruby-identifier">reload</span>.<span class="ruby-identifier">client_of</span>
830:     <span class="ruby-identifier">assert_nil</span> <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:jadedpixel</span>).<span class="ruby-identifier">reload</span>.<span class="ruby-identifier">client_of</span>
831: 
832: 
833:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">num_accounts</span>, <span class="ruby-constant">Account</span>.<span class="ruby-identifier">count</span>
834:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006072" class="method">
  <div id="M006072_title" class="title">
    <b>test_destroy_all</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006072_source')" id="l_M006072_source">show source</a> ]</p>
  <div id="M006072_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 761</span>
761:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_destroy_all</span>
762:     <span class="ruby-identifier">force_signal37_to_load_all_clients_of_firm</span>
763:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">empty?</span>, <span class="ruby-value str">&quot;37signals has clients after load&quot;</span>
764:     <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">destroy_all</span>
765:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">empty?</span>, <span class="ruby-value str">&quot;37signals has no clients after destroy all&quot;</span>
766:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>(<span class="ruby-keyword kw">true</span>).<span class="ruby-identifier">empty?</span>, <span class="ruby-value str">&quot;37signals has no clients after destroy all and refresh&quot;</span>
767:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006075" class="method">
  <div id="M006075_title" class="title">
    <b>test_destroy_dependent_when_deleted_from_association</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006075_source')" id="l_M006075_source">show source</a> ]</p>
  <div id="M006075_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 782</span>
782:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_destroy_dependent_when_deleted_from_association</span>
783:     <span class="ruby-identifier">firm</span> = <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>)
784:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">size</span>
785: 
786:     <span class="ruby-identifier">client</span> = <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">first</span>
787:     <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">client</span>)
788: 
789:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">RecordNotFound</span>) { <span class="ruby-constant">Client</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">client</span>.<span class="ruby-identifier">id</span>) }
790:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">RecordNotFound</span>) { <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">client</span>.<span class="ruby-identifier">id</span>) }
791:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">size</span>
792:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006068" class="method">
  <div id="M006068_title" class="title">
    <b>test_destroying</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006068_source')" id="l_M006068_source">show source</a> ]</p>
  <div id="M006068_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 715</span>
715:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_destroying</span>
716:     <span class="ruby-identifier">force_signal37_to_load_all_clients_of_firm</span>
717: 
718:     <span class="ruby-identifier">assert_difference</span> <span class="ruby-value str">&quot;Client.count&quot;</span>, <span class="ruby-value">-1</span> <span class="ruby-keyword kw">do</span>
719:       <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">destroy</span>(<span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">first</span>)
720:     <span class="ruby-keyword kw">end</span>
721: 
722:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">reload</span>.<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">size</span>
723:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>(<span class="ruby-keyword kw">true</span>).<span class="ruby-identifier">size</span>
724:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006071" class="method">
  <div id="M006071_title" class="title">
    <b>test_destroying_a_collection</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006071_source')" id="l_M006071_source">show source</a> ]</p>
  <div id="M006071_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 748</span>
748:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_destroying_a_collection</span>
749:     <span class="ruby-identifier">force_signal37_to_load_all_clients_of_firm</span>
750:     <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Another Client&quot;</span>)
751:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">size</span>
752: 
753:     <span class="ruby-identifier">assert_difference</span> <span class="ruby-value str">&quot;Client.count&quot;</span>, <span class="ruby-value">-2</span> <span class="ruby-keyword kw">do</span>
754:       <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">destroy</span>([<span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>[<span class="ruby-value">0</span>], <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>[<span class="ruby-value">1</span>]])
755:     <span class="ruby-keyword kw">end</span>
756: 
757:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">reload</span>.<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">size</span>
758:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>(<span class="ruby-keyword kw">true</span>).<span class="ruby-identifier">size</span>
759:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006069" class="method">
  <div id="M006069_title" class="title">
    <b>test_destroying_by_fixnum_id</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006069_source')" id="l_M006069_source">show source</a> ]</p>
  <div id="M006069_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 726</span>
726:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_destroying_by_fixnum_id</span>
727:     <span class="ruby-identifier">force_signal37_to_load_all_clients_of_firm</span>
728: 
729:     <span class="ruby-identifier">assert_difference</span> <span class="ruby-value str">&quot;Client.count&quot;</span>, <span class="ruby-value">-1</span> <span class="ruby-keyword kw">do</span>
730:       <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">destroy</span>(<span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">id</span>)
731:     <span class="ruby-keyword kw">end</span>
732: 
733:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">reload</span>.<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">size</span>
734:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>(<span class="ruby-keyword kw">true</span>).<span class="ruby-identifier">size</span>
735:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006070" class="method">
  <div id="M006070_title" class="title">
    <b>test_destroying_by_string_id</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006070_source')" id="l_M006070_source">show source</a> ]</p>
  <div id="M006070_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 737</span>
737:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_destroying_by_string_id</span>
738:     <span class="ruby-identifier">force_signal37_to_load_all_clients_of_firm</span>
739: 
740:     <span class="ruby-identifier">assert_difference</span> <span class="ruby-value str">&quot;Client.count&quot;</span>, <span class="ruby-value">-1</span> <span class="ruby-keyword kw">do</span>
741:       <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">destroy</span>(<span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">id</span>.<span class="ruby-identifier">to_s</span>)
742:     <span class="ruby-keyword kw">end</span>
743: 
744:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">reload</span>.<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">size</span>
745:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_of_firm</span>(<span class="ruby-keyword kw">true</span>).<span class="ruby-identifier">size</span>
746:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005997" class="method">
  <div id="M005997_title" class="title">
    <b>test_dynamic_find_all_limit_should_override_association_limit</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005997_source')" id="l_M005997_source">show source</a> ]</p>
  <div id="M005997_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 103</span>
103:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_dynamic_find_all_limit_should_override_association_limit</span>
104:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">limited_clients</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;type = 'Client'&quot;</span>, <span class="ruby-identifier">:limit</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">9_000</span>).<span class="ruby-identifier">length</span>
105:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">limited_clients</span>.<span class="ruby-identifier">find_all_by_type</span>(<span class="ruby-value str">'Client'</span>, <span class="ruby-identifier">:limit</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">9_000</span>).<span class="ruby-identifier">length</span>
106:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006099" class="method">
  <div id="M006099_title" class="title">
    <b>test_dynamic_find_all_order_should_override_association_limit_for_through</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006099_source')" id="l_M006099_source">show source</a> ]</p>
  <div id="M006099_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 946</span>
946:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_dynamic_find_all_order_should_override_association_limit_for_through</span>
947:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">4</span>, <span class="ruby-identifier">authors</span>(<span class="ruby-identifier">:david</span>).<span class="ruby-identifier">limited_comments</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;comments.type = 'SpecialComment'&quot;</span>, <span class="ruby-identifier">:limit</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">9_000</span>).<span class="ruby-identifier">length</span>
948:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">4</span>, <span class="ruby-identifier">authors</span>(<span class="ruby-identifier">:david</span>).<span class="ruby-identifier">limited_comments</span>.<span class="ruby-identifier">find_all_by_type</span>(<span class="ruby-value str">'SpecialComment'</span>, <span class="ruby-identifier">:limit</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">9_000</span>).<span class="ruby-identifier">length</span>
949:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005995" class="method">
  <div id="M005995_title" class="title">
    <b>test_dynamic_find_all_order_should_override_association_order</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005995_source')" id="l_M005995_source">show source</a> ]</p>
  <div id="M005995_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 93</span>
93:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_dynamic_find_all_order_should_override_association_order</span>
94:     <span class="ruby-identifier">assert_equal</span> [<span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_client</span>), <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:second_client</span>)], <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_sorted_desc</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;type = 'Client'&quot;</span>, <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'id'</span>)
95:     <span class="ruby-identifier">assert_equal</span> [<span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_client</span>), <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:second_client</span>)], <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_sorted_desc</span>.<span class="ruby-identifier">find_all_by_type</span>(<span class="ruby-value str">'Client'</span>, <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'id'</span>)
96:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006097" class="method">
  <div id="M006097_title" class="title">
    <b>test_dynamic_find_all_order_should_override_association_order_for_through</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006097_source')" id="l_M006097_source">show source</a> ]</p>
  <div id="M006097_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 936</span>
936:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_dynamic_find_all_order_should_override_association_order_for_through</span>
937:     <span class="ruby-identifier">assert_equal</span> [<span class="ruby-constant">Comment</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">3</span>), <span class="ruby-constant">Comment</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">6</span>), <span class="ruby-constant">Comment</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">7</span>), <span class="ruby-constant">Comment</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">10</span>)], <span class="ruby-identifier">authors</span>(<span class="ruby-identifier">:david</span>).<span class="ruby-identifier">comments_desc</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;comments.type = 'SpecialComment'&quot;</span>, <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'comments.id'</span>)
938:     <span class="ruby-identifier">assert_equal</span> [<span class="ruby-constant">Comment</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">3</span>), <span class="ruby-constant">Comment</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">6</span>), <span class="ruby-constant">Comment</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">7</span>), <span class="ruby-constant">Comment</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">10</span>)], <span class="ruby-identifier">authors</span>(<span class="ruby-identifier">:david</span>).<span class="ruby-identifier">comments_desc</span>.<span class="ruby-identifier">find_all_by_type</span>(<span class="ruby-value str">'SpecialComment'</span>, <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'comments.id'</span>)
939:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005996" class="method">
  <div id="M005996_title" class="title">
    <b>test_dynamic_find_all_should_respect_association_limit</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005996_source')" id="l_M005996_source">show source</a> ]</p>
  <div id="M005996_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 98</span>
 98:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_dynamic_find_all_should_respect_association_limit</span>
 99:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">limited_clients</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;type = 'Client'&quot;</span>).<span class="ruby-identifier">length</span>
100:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">limited_clients</span>.<span class="ruby-identifier">find_all_by_type</span>(<span class="ruby-value str">'Client'</span>).<span class="ruby-identifier">length</span>
101:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006098" class="method">
  <div id="M006098_title" class="title">
    <b>test_dynamic_find_all_should_respect_association_limit_for_through</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006098_source')" id="l_M006098_source">show source</a> ]</p>
  <div id="M006098_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 941</span>
941:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_dynamic_find_all_should_respect_association_limit_for_through</span>
942:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">authors</span>(<span class="ruby-identifier">:david</span>).<span class="ruby-identifier">limited_comments</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;comments.type = 'SpecialComment'&quot;</span>).<span class="ruby-identifier">length</span>
943:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">authors</span>(<span class="ruby-identifier">:david</span>).<span class="ruby-identifier">limited_comments</span>.<span class="ruby-identifier">find_all_by_type</span>(<span class="ruby-value str">'SpecialComment'</span>).<span class="ruby-identifier">length</span>
944:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005994" class="method">
  <div id="M005994_title" class="title">
    <b>test_dynamic_find_all_should_respect_association_order</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005994_source')" id="l_M005994_source">show source</a> ]</p>
  <div id="M005994_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 88</span>
88:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_dynamic_find_all_should_respect_association_order</span>
89:     <span class="ruby-identifier">assert_equal</span> [<span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:second_client</span>), <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_client</span>)], <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_sorted_desc</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;type = 'Client'&quot;</span>)
90:     <span class="ruby-identifier">assert_equal</span> [<span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:second_client</span>), <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_client</span>)], <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_sorted_desc</span>.<span class="ruby-identifier">find_all_by_type</span>(<span class="ruby-value str">'Client'</span>)
91:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006096" class="method">
  <div id="M006096_title" class="title">
    <b>test_dynamic_find_all_should_respect_association_order_for_through</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006096_source')" id="l_M006096_source">show source</a> ]</p>
  <div id="M006096_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 931</span>
931:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_dynamic_find_all_should_respect_association_order_for_through</span>
932:     <span class="ruby-identifier">assert_equal</span> [<span class="ruby-constant">Comment</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">10</span>), <span class="ruby-constant">Comment</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">7</span>), <span class="ruby-constant">Comment</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">6</span>), <span class="ruby-constant">Comment</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">3</span>)], <span class="ruby-identifier">authors</span>(<span class="ruby-identifier">:david</span>).<span class="ruby-identifier">comments_desc</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;comments.type = 'SpecialComment'&quot;</span>)
933:     <span class="ruby-identifier">assert_equal</span> [<span class="ruby-constant">Comment</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">10</span>), <span class="ruby-constant">Comment</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">7</span>), <span class="ruby-constant">Comment</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">6</span>), <span class="ruby-constant">Comment</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">3</span>)], <span class="ruby-identifier">authors</span>(<span class="ruby-identifier">:david</span>).<span class="ruby-identifier">comments_desc</span>.<span class="ruby-identifier">find_all_by_type</span>(<span class="ruby-value str">'SpecialComment'</span>)
934:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005998" class="method">
  <div id="M005998_title" class="title">
    <b>test_dynamic_find_all_should_respect_readonly_access</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005998_source')" id="l_M005998_source">show source</a> ]</p>
  <div id="M005998_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 108</span>
108:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_dynamic_find_all_should_respect_readonly_access</span>
109:     <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">readonly_clients</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>).<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span> <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">ReadOnlyRecord</span>) { <span class="ruby-identifier">c</span>.<span class="ruby-identifier">save!</span>  } }
110:     <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">readonly_clients</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>).<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span> <span class="ruby-identifier">assert</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">readonly?</span> }
111:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005991" class="method">
  <div id="M005991_title" class="title">
    <b>test_dynamic_find_last_without_specified_order</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005991_source')" id="l_M005991_source">show source</a> ]</p>
  <div id="M005991_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 74</span>
74:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_dynamic_find_last_without_specified_order</span>
75:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:second_client</span>), <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">unsorted_clients</span>.<span class="ruby-identifier">find_last_by_type</span>(<span class="ruby-value str">'Client'</span>)
76:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005993" class="method">
  <div id="M005993_title" class="title">
    <b>test_dynamic_find_order_should_override_association_order</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005993_source')" id="l_M005993_source">show source</a> ]</p>
  <div id="M005993_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 83</span>
83:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_dynamic_find_order_should_override_association_order</span>
84:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_client</span>), <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_sorted_desc</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;type = 'Client'&quot;</span>, <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'id'</span>)
85:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_client</span>), <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_sorted_desc</span>.<span class="ruby-identifier">find_by_type</span>(<span class="ruby-value str">'Client'</span>, <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'id'</span>)
86:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006095" class="method">
  <div id="M006095_title" class="title">
    <b>test_dynamic_find_order_should_override_association_order_for_through</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006095_source')" id="l_M006095_source">show source</a> ]</p>
  <div id="M006095_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 926</span>
926:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_dynamic_find_order_should_override_association_order_for_through</span>
927:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-constant">Comment</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">3</span>), <span class="ruby-identifier">authors</span>(<span class="ruby-identifier">:david</span>).<span class="ruby-identifier">comments_desc</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;comments.type = 'SpecialComment'&quot;</span>, <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'comments.id'</span>)
928:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-constant">Comment</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">3</span>), <span class="ruby-identifier">authors</span>(<span class="ruby-identifier">:david</span>).<span class="ruby-identifier">comments_desc</span>.<span class="ruby-identifier">find_by_type</span>(<span class="ruby-value str">'SpecialComment'</span>, <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'comments.id'</span>)
929:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005992" class="method">
  <div id="M005992_title" class="title">
    <b>test_dynamic_find_should_respect_association_order</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005992_source')" id="l_M005992_source">show source</a> ]</p>
  <div id="M005992_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 78</span>
78:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_dynamic_find_should_respect_association_order</span>
79:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:second_client</span>), <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_sorted_desc</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;type = 'Client'&quot;</span>)
80:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:second_client</span>), <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_sorted_desc</span>.<span class="ruby-identifier">find_by_type</span>(<span class="ruby-value str">'Client'</span>)
81:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006094" class="method">
  <div id="M006094_title" class="title">
    <b>test_dynamic_find_should_respect_association_order_for_through</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006094_source')" id="l_M006094_source">show source</a> ]</p>
  <div id="M006094_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 921</span>
921:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_dynamic_find_should_respect_association_order_for_through</span>
922:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-constant">Comment</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">10</span>), <span class="ruby-identifier">authors</span>(<span class="ruby-identifier">:david</span>).<span class="ruby-identifier">comments_desc</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;comments.type = 'SpecialComment'&quot;</span>)
923:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-constant">Comment</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">10</span>), <span class="ruby-identifier">authors</span>(<span class="ruby-identifier">:david</span>).<span class="ruby-identifier">comments_desc</span>.<span class="ruby-identifier">find_by_type</span>(<span class="ruby-value str">'SpecialComment'</span>)
924:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006013" class="method">
  <div id="M006013_title" class="title">
    <b>test_find_all</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006013_source')" id="l_M006013_source">show source</a> ]</p>
  <div id="M006013_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 217</span>
217:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_find_all</span>
218:     <span class="ruby-identifier">firm</span> = <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>)
219:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{QUOTED_TYPE} = 'Client'&quot;</span>).<span class="ruby-identifier">length</span>
220:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;name = 'Summit'&quot;</span>).<span class="ruby-identifier">length</span>
221:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006100" class="method">
  <div id="M006100_title" class="title">
    <b>test_find_all_include_over_the_same_table_for_through</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006100_source')" id="l_M006100_source">show source</a> ]</p>
  <div id="M006100_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 951</span>
951:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_find_all_include_over_the_same_table_for_through</span>
952:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-identifier">people</span>(<span class="ruby-identifier">:michael</span>).<span class="ruby-identifier">posts</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>, <span class="ruby-identifier">:include</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:people</span>).<span class="ruby-identifier">length</span>
953:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006017" class="method">
  <div id="M006017_title" class="title">
    <b>test_find_all_sanitized</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006017_source')" id="l_M006017_source">show source</a> ]</p>
  <div id="M006017_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 262</span>
262:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_find_all_sanitized</span>
263:     <span class="ruby-identifier">firm</span> = <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>)
264:     <span class="ruby-identifier">summit</span> = <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;name = 'Summit'&quot;</span>)
265:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">summit</span>, <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;name = ?&quot;</span>, <span class="ruby-value str">&quot;Summit&quot;</span>])
266:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">summit</span>, <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;name = :name&quot;</span>, { <span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Summit&quot;</span> }])
267:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006020" class="method">
  <div id="M006020_title" class="title">
    <b>test_find_all_with_include_and_conditions</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006020_source')" id="l_M006020_source">show source</a> ]</p>
  <div id="M006020_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 283</span>
283:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_find_all_with_include_and_conditions</span>
284:     <span class="ruby-identifier">assert_nothing_raised</span> <span class="ruby-keyword kw">do</span>
285:       <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>, <span class="ruby-identifier">:joins</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:audit_logs</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> {<span class="ruby-value str">'audit_logs.message'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'Smith'</span>})
286:     <span class="ruby-keyword kw">end</span>
287:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006083" class="method">
  <div id="M006083_title" class="title">
    <b>test_find_all_without_conditions</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006083_source')" id="l_M006083_source">show source</a> ]</p>
  <div id="M006083_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 844</span>
844:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_find_all_without_conditions</span>
845:     <span class="ruby-identifier">firm</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>)
846:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>).<span class="ruby-identifier">length</span>
847:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006014" class="method">
  <div id="M006014_title" class="title">
    <b>test_find_each</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006014_source')" id="l_M006014_source">show source</a> ]</p>
  <div id="M006014_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 223</span>
223:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_find_each</span>
224:     <span class="ruby-identifier">firm</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>)
225: 
226:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span> <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">loaded?</span>
227: 
228:     <span class="ruby-identifier">assert_queries</span>(<span class="ruby-value">3</span>) <span class="ruby-keyword kw">do</span>
229:       <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">find_each</span>(<span class="ruby-identifier">:batch_size</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>) {<span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span> <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">c</span>.<span class="ruby-identifier">firm_id</span> }
230:     <span class="ruby-keyword kw">end</span>
231: 
232:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span> <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">loaded?</span>
233:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006015" class="method">
  <div id="M006015_title" class="title">
    <b>test_find_each_with_conditions</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006015_source')" id="l_M006015_source">show source</a> ]</p>
  <div id="M006015_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 235</span>
235:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_find_each_with_conditions</span>
236:     <span class="ruby-identifier">firm</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>)
237: 
238:     <span class="ruby-identifier">assert_queries</span>(<span class="ruby-value">2</span>) <span class="ruby-keyword kw">do</span>
239:       <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">find_each</span>(<span class="ruby-identifier">:batch_size</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> {<span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Microsoft&quot;</span>}) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span>
240:         <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">c</span>.<span class="ruby-identifier">firm_id</span>
241:         <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;Microsoft&quot;</span>, <span class="ruby-identifier">c</span>.<span class="ruby-identifier">name</span>
242:       <span class="ruby-keyword kw">end</span>
243:     <span class="ruby-keyword kw">end</span>
244: 
245:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span> <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">loaded?</span>
246:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006018" class="method">
  <div id="M006018_title" class="title">
    <b>test_find_first</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006018_source')" id="l_M006018_source">show source</a> ]</p>
  <div id="M006018_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 269</span>
269:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_find_first</span>
270:     <span class="ruby-identifier">firm</span> = <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>)
271:     <span class="ruby-identifier">client2</span> = <span class="ruby-constant">Client</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">2</span>)
272:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">first</span>, <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>)
273:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">client2</span>, <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{QUOTED_TYPE} = 'Client'&quot;</span>)
274:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006019" class="method">
  <div id="M006019_title" class="title">
    <b>test_find_first_sanitized</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006019_source')" id="l_M006019_source">show source</a> ]</p>
  <div id="M006019_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 276</span>
276:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_find_first_sanitized</span>
277:     <span class="ruby-identifier">firm</span> = <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>)
278:     <span class="ruby-identifier">client2</span> = <span class="ruby-constant">Client</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">2</span>)
279:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">client2</span>, <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-node">&quot;#{QUOTED_TYPE} = ?&quot;</span>, <span class="ruby-value str">'Client'</span>])
280:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">client2</span>, <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-node">&quot;#{QUOTED_TYPE} = :type&quot;</span>, { <span class="ruby-identifier">:type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'Client'</span> }])
281:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006022" class="method">
  <div id="M006022_title" class="title">
    <b>test_find_grouped</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006022_source')" id="l_M006022_source">show source</a> ]</p>
  <div id="M006022_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 294</span>
294:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_find_grouped</span>
295:     <span class="ruby-identifier">all_clients_of_firm1</span> = <span class="ruby-constant">Client</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;firm_id = 1&quot;</span>)
296:     <span class="ruby-identifier">grouped_clients_of_firm1</span> = <span class="ruby-constant">Client</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;firm_id = 1&quot;</span>, <span class="ruby-identifier">:group</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;firm_id&quot;</span>, <span class="ruby-identifier">:select</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'firm_id, count(id) as clients_count'</span>)
297:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-identifier">all_clients_of_firm1</span>.<span class="ruby-identifier">size</span>
298:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">grouped_clients_of_firm1</span>.<span class="ruby-identifier">size</span>
299:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006011" class="method">
  <div id="M006011_title" class="title">
    <b>test_find_ids</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006011_source')" id="l_M006011_source">show source</a> ]</p>
  <div id="M006011_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 181</span>
181:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_find_ids</span>
182:     <span class="ruby-identifier">firm</span> = <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>)
183: 
184:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">RecordNotFound</span>) { <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">find</span> }
185: 
186:     <span class="ruby-identifier">client</span> = <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">2</span>)
187:     <span class="ruby-identifier">assert_kind_of</span> <span class="ruby-constant">Client</span>, <span class="ruby-identifier">client</span>
188: 
189:     <span class="ruby-identifier">client_ary</span> = <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">find</span>([<span class="ruby-value">2</span>])
190:     <span class="ruby-identifier">assert_kind_of</span> <span class="ruby-constant">Array</span>, <span class="ruby-identifier">client_ary</span>
191:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">client</span>, <span class="ruby-identifier">client_ary</span>.<span class="ruby-identifier">first</span>
192: 
193:     <span class="ruby-identifier">client_ary</span> = <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">2</span>, <span class="ruby-value">3</span>)
194:     <span class="ruby-identifier">assert_kind_of</span> <span class="ruby-constant">Array</span>, <span class="ruby-identifier">client_ary</span>
195:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-identifier">client_ary</span>.<span class="ruby-identifier">size</span>
196:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">client</span>, <span class="ruby-identifier">client_ary</span>.<span class="ruby-identifier">first</span>
197: 
198:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">RecordNotFound</span>) { <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">2</span>, <span class="ruby-value">99</span>) }
199:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006016" class="method">
  <div id="M006016_title" class="title">
    <b>test_find_in_batches</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006016_source')" id="l_M006016_source">show source</a> ]</p>
  <div id="M006016_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 248</span>
248:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_find_in_batches</span>
249:     <span class="ruby-identifier">firm</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>)
250: 
251:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span> <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">loaded?</span>
252: 
253:     <span class="ruby-identifier">assert_queries</span>(<span class="ruby-value">2</span>) <span class="ruby-keyword kw">do</span>
254:       <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">find_in_batches</span>(<span class="ruby-identifier">:batch_size</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">2</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">clients</span><span class="ruby-operator">|</span>
255:         <span class="ruby-identifier">clients</span>.<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span> <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">c</span>.<span class="ruby-identifier">firm_id</span> }
256:       <span class="ruby-keyword kw">end</span>
257:     <span class="ruby-keyword kw">end</span>
258: 
259:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span> <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">loaded?</span>
260:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006021" class="method">
  <div id="M006021_title" class="title">
    <b>test_find_in_collection</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006021_source')" id="l_M006021_source">show source</a> ]</p>
  <div id="M006021_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 289</span>
289:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_find_in_collection</span>
290:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-constant">Client</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">2</span>).<span class="ruby-identifier">name</span>, <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">2</span>).<span class="ruby-identifier">name</span>
291:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">RecordNotFound</span>) { <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">6</span>) }
292:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005990" class="method">
  <div id="M005990_title" class="title">
    <b>test_find_many_with_merged_options</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005990_source')" id="l_M005990_source">show source</a> ]</p>
  <div id="M005990_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 68</span>
68:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_find_many_with_merged_options</span>
69:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">limited_clients</span>.<span class="ruby-identifier">size</span>
70:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">limited_clients</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>).<span class="ruby-identifier">size</span>
71:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">limited_clients</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>, <span class="ruby-identifier">:limit</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>).<span class="ruby-identifier">size</span>
72:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006046" class="method">
  <div id="M006046_title" class="title">
    <b>test_find_or_create</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006046_source')" id="l_M006046_source">show source</a> ]</p>
  <div id="M006046_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 489</span>
489:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_find_or_create</span>
490:     <span class="ruby-identifier">number_of_clients</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">size</span>
491:     <span class="ruby-identifier">the_client</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">find_or_create_by_name</span>(<span class="ruby-value str">&quot;Yet another client&quot;</span>)
492:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">number_of_clients</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>, <span class="ruby-identifier">:reload</span>).<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">size</span>
493:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">the_client</span>, <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">find_or_create_by_name</span>(<span class="ruby-value str">&quot;Yet another client&quot;</span>)
494:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">number_of_clients</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>, <span class="ruby-identifier">:reload</span>).<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">size</span>
495:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006045" class="method">
  <div id="M006045_title" class="title">
    <b>test_find_or_initialize</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006045_source')" id="l_M006045_source">show source</a> ]</p>
  <div id="M006045_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 482</span>
482:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_find_or_initialize</span>
483:     <span class="ruby-identifier">the_client</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">find_or_initialize_by_name</span>(<span class="ruby-value str">&quot;Yet another client&quot;</span>)
484:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">id</span>, <span class="ruby-identifier">the_client</span>.<span class="ruby-identifier">firm_id</span>
485:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;Yet another client&quot;</span>, <span class="ruby-identifier">the_client</span>.<span class="ruby-identifier">name</span>
486:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">the_client</span>.<span class="ruby-identifier">new_record?</span>
487:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006023" class="method">
  <div id="M006023_title" class="title">
    <b>test_find_scoped_grouped</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006023_source')" id="l_M006023_source">show source</a> ]</p>
  <div id="M006023_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 301</span>
301:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_find_scoped_grouped</span>
302:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_grouped_by_firm_id</span>.<span class="ruby-identifier">size</span>
303:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_grouped_by_firm_id</span>.<span class="ruby-identifier">length</span>
304:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_grouped_by_name</span>.<span class="ruby-identifier">size</span>
305:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients_grouped_by_name</span>.<span class="ruby-identifier">length</span>
306:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006024" class="method">
  <div id="M006024_title" class="title">
    <b>test_find_scoped_grouped_having</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006024_source')" id="l_M006024_source">show source</a> ]</p>
  <div id="M006024_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 308</span>
308:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_find_scoped_grouped_having</span>
309:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">authors</span>(<span class="ruby-identifier">:david</span>).<span class="ruby-identifier">popular_grouped_posts</span>.<span class="ruby-identifier">length</span>
310:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-identifier">authors</span>(<span class="ruby-identifier">:mary</span>).<span class="ruby-identifier">popular_grouped_posts</span>.<span class="ruby-identifier">length</span>
311:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006012" class="method">
  <div id="M006012_title" class="title">
    <b>test_find_string_ids_when_using_finder_sql</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006012_source')" id="l_M006012_source">show source</a> ]</p>
  <div id="M006012_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 201</span>
201:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_find_string_ids_when_using_finder_sql</span>
202:     <span class="ruby-identifier">firm</span> = <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>)
203: 
204:     <span class="ruby-identifier">client</span> = <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients_using_finder_sql</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value str">&quot;2&quot;</span>)
205:     <span class="ruby-identifier">assert_kind_of</span> <span class="ruby-constant">Client</span>, <span class="ruby-identifier">client</span>
206: 
207:     <span class="ruby-identifier">client_ary</span> = <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients_using_finder_sql</span>.<span class="ruby-identifier">find</span>([<span class="ruby-value str">&quot;2&quot;</span>])
208:     <span class="ruby-identifier">assert_kind_of</span> <span class="ruby-constant">Array</span>, <span class="ruby-identifier">client_ary</span>
209:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">client</span>, <span class="ruby-identifier">client_ary</span>.<span class="ruby-identifier">first</span>
210: 
211:     <span class="ruby-identifier">client_ary</span> = <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients_using_finder_sql</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value str">&quot;2&quot;</span>, <span class="ruby-value str">&quot;3&quot;</span>)
212:     <span class="ruby-identifier">assert_kind_of</span> <span class="ruby-constant">Array</span>, <span class="ruby-identifier">client_ary</span>
213:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-identifier">client_ary</span>.<span class="ruby-identifier">size</span>
214:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">client_ary</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">client</span>)
215:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005989" class="method">
  <div id="M005989_title" class="title">
    <b>test_find_with_blank_conditions</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005989_source')" id="l_M005989_source">show source</a> ]</p>
  <div id="M005989_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 62</span>
62:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_find_with_blank_conditions</span>
63:     [[], {}, <span class="ruby-keyword kw">nil</span>, <span class="ruby-value str">&quot;&quot;</span>].<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">blank</span><span class="ruby-operator">|</span>
64:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>).<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">blank</span>).<span class="ruby-identifier">size</span>
65:     <span class="ruby-keyword kw">end</span>
66:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005988" class="method">
  <div id="M005988_title" class="title">
    <b>test_finding</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005988_source')" id="l_M005988_source">show source</a> ]</p>
  <div id="M005988_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 58</span>
58:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_finding</span>
59:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>).<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">length</span>
60:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006001" class="method">
  <div id="M006001_title" class="title">
    <b>test_finding_default_orders</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006001_source')" id="l_M006001_source">show source</a> ]</p>
  <div id="M006001_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 123</span>
123:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_finding_default_orders</span>
124:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;Summit&quot;</span>, <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>).<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">name</span>
125:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006006" class="method">
  <div id="M006006_title" class="title">
    <b>test_finding_using_primary_key</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006006_source')" id="l_M006006_source">show source</a> ]</p>
  <div id="M006006_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 143</span>
143:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_finding_using_primary_key</span>
144:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;Summit&quot;</span>, <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>).<span class="ruby-identifier">clients_using_primary_key</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">name</span>
145:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006007" class="method">
  <div id="M006007_title" class="title">
    <b>test_finding_using_sql</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006007_source')" id="l_M006007_source">show source</a> ]</p>
  <div id="M006007_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 147</span>
147:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_finding_using_sql</span>
148:     <span class="ruby-identifier">firm</span> = <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>)
149:     <span class="ruby-identifier">first_client</span> = <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients_using_sql</span>.<span class="ruby-identifier">first</span>
150:     <span class="ruby-identifier">assert_not_nil</span> <span class="ruby-identifier">first_client</span>
151:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;Microsoft&quot;</span>, <span class="ruby-identifier">first_client</span>.<span class="ruby-identifier">name</span>
152:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients_using_sql</span>.<span class="ruby-identifier">size</span>
153:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>).<span class="ruby-identifier">clients_using_sql</span>.<span class="ruby-identifier">size</span>
154:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006004" class="method">
  <div id="M006004_title" class="title">
    <b>test_finding_with_condition</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006004_source')" id="l_M006004_source">show source</a> ]</p>
  <div id="M006004_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 135</span>
135:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_finding_with_condition</span>
136:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;Microsoft&quot;</span>, <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>).<span class="ruby-identifier">clients_like_ms</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">name</span>
137:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006005" class="method">
  <div id="M006005_title" class="title">
    <b>test_finding_with_condition_hash</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006005_source')" id="l_M006005_source">show source</a> ]</p>
  <div id="M006005_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 139</span>
139:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_finding_with_condition_hash</span>
140:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;Microsoft&quot;</span>, <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>).<span class="ruby-identifier">clients_like_ms_with_hash_conditions</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">name</span>
141:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006002" class="method">
  <div id="M006002_title" class="title">
    <b>test_finding_with_different_class_name_and_order</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006002_source')" id="l_M006002_source">show source</a> ]</p>
  <div id="M006002_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 127</span>
127:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_finding_with_different_class_name_and_order</span>
128:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;Microsoft&quot;</span>, <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>).<span class="ruby-identifier">clients_sorted_desc</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">name</span>
129:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006003" class="method">
  <div id="M006003_title" class="title">
    <b>test_finding_with_foreign_key</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006003_source')" id="l_M006003_source">show source</a> ]</p>
  <div id="M006003_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 131</span>
131:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_finding_with_foreign_key</span>
132:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;Microsoft&quot;</span>, <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>).<span class="ruby-identifier">clients_of_firm</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">name</span>
133:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006087" class="method">
  <div id="M006087_title" class="title">
    <b>test_get_ids</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006087_source')" id="l_M006087_source">show source</a> ]</p>
  <div id="M006087_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 872</span>
872:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_get_ids</span>
873:     <span class="ruby-identifier">assert_equal</span> [<span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_client</span>).<span class="ruby-identifier">id</span>, <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:second_client</span>).<span class="ruby-identifier">id</span>], <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">client_ids</span>
874:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006088" class="method">
  <div id="M006088_title" class="title">
    <b>test_get_ids_for_loaded_associations</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006088_source')" id="l_M006088_source">show source</a> ]</p>
  <div id="M006088_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 876</span>
876:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_get_ids_for_loaded_associations</span>
877:     <span class="ruby-identifier">company</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>)
878:     <span class="ruby-identifier">company</span>.<span class="ruby-identifier">clients</span>(<span class="ruby-keyword kw">true</span>)
879:     <span class="ruby-identifier">assert_queries</span>(<span class="ruby-value">0</span>) <span class="ruby-keyword kw">do</span>
880:       <span class="ruby-identifier">company</span>.<span class="ruby-identifier">client_ids</span>
881:       <span class="ruby-identifier">company</span>.<span class="ruby-identifier">client_ids</span>
882:     <span class="ruby-keyword kw">end</span>
883:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006092" class="method">
  <div id="M006092_title" class="title">
    <b>test_get_ids_for_through</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006092_source')" id="l_M006092_source">show source</a> ]</p>
  <div id="M006092_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 908</span>
908:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_get_ids_for_through</span>
909:     <span class="ruby-identifier">assert_equal</span> [<span class="ruby-identifier">comments</span>(<span class="ruby-identifier">:eager_other_comment1</span>).<span class="ruby-identifier">id</span>], <span class="ruby-identifier">authors</span>(<span class="ruby-identifier">:mary</span>).<span class="ruby-identifier">comment_ids</span>
910:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006089" class="method">
  <div id="M006089_title" class="title">
    <b>test_get_ids_for_unloaded_associations_does_not_load_them</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006089_source')" id="l_M006089_source">show source</a> ]</p>
  <div id="M006089_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 885</span>
885:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_get_ids_for_unloaded_associations_does_not_load_them</span>
886:     <span class="ruby-identifier">company</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>)
887:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">company</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">loaded?</span>
888:     <span class="ruby-identifier">assert_equal</span> [<span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_client</span>).<span class="ruby-identifier">id</span>, <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:second_client</span>).<span class="ruby-identifier">id</span>], <span class="ruby-identifier">company</span>.<span class="ruby-identifier">client_ids</span>
889:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">company</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">loaded?</span>
890:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006090" class="method">
  <div id="M006090_title" class="title">
    <b>test_get_ids_for_unloaded_finder_sql_associations_loads_them</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006090_source')" id="l_M006090_source">show source</a> ]</p>
  <div id="M006090_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 892</span>
892:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_get_ids_for_unloaded_finder_sql_associations_loads_them</span>
893:     <span class="ruby-identifier">company</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>)
894:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">company</span>.<span class="ruby-identifier">clients_using_sql</span>.<span class="ruby-identifier">loaded?</span>
895:     <span class="ruby-identifier">assert_equal</span> [<span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:second_client</span>).<span class="ruby-identifier">id</span>], <span class="ruby-identifier">company</span>.<span class="ruby-identifier">clients_using_sql_ids</span>
896:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">company</span>.<span class="ruby-identifier">clients_using_sql</span>.<span class="ruby-identifier">loaded?</span>
897:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006101" class="method">
  <div id="M006101_title" class="title">
    <b>test_has_many_through_respects_hash_conditions</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006101_source')" id="l_M006101_source">show source</a> ]</p>
  <div id="M006101_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 955</span>
955:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_has_many_through_respects_hash_conditions</span>
956:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">authors</span>(<span class="ruby-identifier">:david</span>).<span class="ruby-identifier">hello_posts</span>, <span class="ruby-identifier">authors</span>(<span class="ruby-identifier">:david</span>).<span class="ruby-identifier">hello_posts_with_hash_conditions</span>
957:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">authors</span>(<span class="ruby-identifier">:david</span>).<span class="ruby-identifier">hello_post_comments</span>, <span class="ruby-identifier">authors</span>(<span class="ruby-identifier">:david</span>).<span class="ruby-identifier">hello_post_comments_with_hash_conditions</span>
958:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006103" class="method">
  <div id="M006103_title" class="title">
    <b>test_include_checks_if_record_exists_if_target_not_loaded</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006103_source')" id="l_M006103_source">show source</a> ]</p>
  <div id="M006103_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 972</span>
972:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_include_checks_if_record_exists_if_target_not_loaded</span>
973:     <span class="ruby-identifier">firm</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>)
974:     <span class="ruby-identifier">client</span> = <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">first</span>
975: 
976:     <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">reload</span>
977:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span> <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">loaded?</span>
978:     <span class="ruby-identifier">assert_queries</span>(<span class="ruby-value">1</span>) <span class="ruby-keyword kw">do</span>
979:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">client</span>)
980:     <span class="ruby-keyword kw">end</span>
981:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span> <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">loaded?</span>
982:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006104" class="method">
  <div id="M006104_title" class="title">
    <b>test_include_loads_collection_if_target_uses_finder_sql</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006104_source')" id="l_M006104_source">show source</a> ]</p>
  <div id="M006104_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 984</span>
984:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_include_loads_collection_if_target_uses_finder_sql</span>
985:     <span class="ruby-identifier">firm</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>)
986:     <span class="ruby-identifier">client</span> = <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients_using_sql</span>.<span class="ruby-identifier">first</span>
987: 
988:     <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">reload</span>
989:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span> <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients_using_sql</span>.<span class="ruby-identifier">loaded?</span>
990:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients_using_sql</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">client</span>)
991:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients_using_sql</span>.<span class="ruby-identifier">loaded?</span>
992:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006105" class="method">
  <div id="M006105_title" class="title">
    <b>test_include_returns_false_for_non_matching_record_to_verify_scoping</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006105_source')" id="l_M006105_source">show source</a> ]</p>
  <div id="M006105_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 995</span>
 995:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_include_returns_false_for_non_matching_record_to_verify_scoping</span>
 996:     <span class="ruby-identifier">firm</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>)
 997:     <span class="ruby-identifier">client</span> = <span class="ruby-constant">Client</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'Not Associated'</span>)
 998: 
 999:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span> <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">loaded?</span>
1000:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span> <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">client</span>)
1001:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006102" class="method">
  <div id="M006102_title" class="title">
    <b>test_include_uses_array_include_after_loaded</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006102_source')" id="l_M006102_source">show source</a> ]</p>
  <div id="M006102_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 960</span>
960:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_include_uses_array_include_after_loaded</span>
961:     <span class="ruby-identifier">firm</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>)
962:     <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">class</span> <span class="ruby-comment cmt"># force load target</span>
963: 
964:     <span class="ruby-identifier">client</span> = <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">first</span>
965: 
966:     <span class="ruby-identifier">assert_no_queries</span> <span class="ruby-keyword kw">do</span>
967:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">loaded?</span>
968:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">client</span>)
969:     <span class="ruby-keyword kw">end</span>
970:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006081" class="method">
  <div id="M006081_title" class="title">
    <b>test_included_in_collection</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006081_source')" id="l_M006081_source">show source</a> ]</p>
  <div id="M006081_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 836</span>
836:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_included_in_collection</span>
837:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-constant">Client</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">2</span>))
838:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006063" class="method">
  <div id="M006063_title" class="title">
    <b>test_invalid_belongs_to_dependent_option_raises_exception</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006063_source')" id="l_M006063_source">show source</a> ]</p>
  <div id="M006063_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 679</span>
679:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_invalid_belongs_to_dependent_option_raises_exception</span>
680:     <span class="ruby-identifier">assert_raise</span> <span class="ruby-constant">ArgumentError</span> <span class="ruby-keyword kw">do</span>
681:       <span class="ruby-constant">Author</span>.<span class="ruby-identifier">belongs_to</span> <span class="ruby-identifier">:special_author_address</span>, <span class="ruby-identifier">:dependent</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:nullify</span>
682:     <span class="ruby-keyword kw">end</span>
683:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006113" class="method">
  <div id="M006113_title" class="title">
    <b>test_joins_with_namespaced_model_should_use_correct_type</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006113_source')" id="l_M006113_source">show source</a> ]</p>
  <div id="M006113_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 1080</span>
1080:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_joins_with_namespaced_model_should_use_correct_type</span>
1081:     <span class="ruby-identifier">old</span> = <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">store_full_sti_class</span>
1082:     <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">store_full_sti_class</span> = <span class="ruby-keyword kw">true</span>
1083: 
1084:     <span class="ruby-identifier">firm</span> = <span class="ruby-constant">Namespaced</span><span class="ruby-operator">::</span><span class="ruby-constant">Firm</span>.<span class="ruby-identifier">create</span>({ <span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'Some Company'</span> })
1085:     <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">create</span>({ <span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'Some Client'</span> })
1086: 
1087:     <span class="ruby-identifier">stats</span> = <span class="ruby-constant">Namespaced</span><span class="ruby-operator">::</span><span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">firm</span>.<span class="ruby-identifier">id</span>, {
1088:       <span class="ruby-identifier">:select</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{Namespaced::Firm.table_name}.id, COUNT(#{Namespaced::Client.table_name}.id) AS num_clients&quot;</span>,
1089:       <span class="ruby-identifier">:joins</span>  =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:clients</span>,
1090:       <span class="ruby-identifier">:group</span>  =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{Namespaced::Firm.table_name}.id&quot;</span>
1091:     })
1092:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">stats</span>.<span class="ruby-identifier">num_clients</span>.<span class="ruby-identifier">to_i</span>
1093: 
1094:   <span class="ruby-keyword kw">ensure</span>
1095:     <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">store_full_sti_class</span> = <span class="ruby-identifier">old</span>
1096:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006093" class="method">
  <div id="M006093_title" class="title">
    <b>test_modifying_a_through_a_has_many_should_raise</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006093_source')" id="l_M006093_source">show source</a> ]</p>
  <div id="M006093_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 912</span>
912:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_modifying_a_through_a_has_many_should_raise</span>
913:     [
914:       <span class="ruby-identifier">lambda</span> { <span class="ruby-identifier">authors</span>(<span class="ruby-identifier">:mary</span>).<span class="ruby-identifier">comment_ids</span> = [<span class="ruby-identifier">comments</span>(<span class="ruby-identifier">:greetings</span>).<span class="ruby-identifier">id</span>, <span class="ruby-identifier">comments</span>(<span class="ruby-identifier">:more_greetings</span>).<span class="ruby-identifier">id</span>] },
915:       <span class="ruby-identifier">lambda</span> { <span class="ruby-identifier">authors</span>(<span class="ruby-identifier">:mary</span>).<span class="ruby-identifier">comments</span> = [<span class="ruby-identifier">comments</span>(<span class="ruby-identifier">:greetings</span>), <span class="ruby-identifier">comments</span>(<span class="ruby-identifier">:more_greetings</span>)] },
916:       <span class="ruby-identifier">lambda</span> { <span class="ruby-identifier">authors</span>(<span class="ruby-identifier">:mary</span>).<span class="ruby-identifier">comments</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">Comment</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-identifier">:body</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Yay&quot;</span>, <span class="ruby-identifier">:post_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">424242</span>) },
917:       <span class="ruby-identifier">lambda</span> { <span class="ruby-identifier">authors</span>(<span class="ruby-identifier">:mary</span>).<span class="ruby-identifier">comments</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">authors</span>(<span class="ruby-identifier">:mary</span>).<span class="ruby-identifier">comments</span>.<span class="ruby-identifier">first</span>) },
918:     ].<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">block</span><span class="ruby-operator">|</span> <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">HasManyThroughCantAssociateThroughHasOneOrManyReflection</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>) }
919:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006028" class="method">
  <div id="M006028_title" class="title">
    <b>test_regular_create_on_has_many_when_parent_is_new_raises</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006028_source')" id="l_M006028_source">show source</a> ]</p>
  <div id="M006028_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 337</span>
337:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_regular_create_on_has_many_when_parent_is_new_raises</span>
338:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">RecordNotSaved</span>) <span class="ruby-keyword kw">do</span>
339:       <span class="ruby-identifier">firm</span> = <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">new</span>
340:       <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">plain_clients</span>.<span class="ruby-identifier">create</span> <span class="ruby-identifier">:name=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;Whoever&quot;</span>
341:     <span class="ruby-keyword kw">end</span>
342:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006084" class="method">
  <div id="M006084_title" class="title">
    <b>test_replace_with_less</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006084_source')" id="l_M006084_source">show source</a> ]</p>
  <div id="M006084_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 849</span>
849:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_replace_with_less</span>
850:     <span class="ruby-identifier">firm</span> = <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>)
851:     <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span> = [<span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_client</span>)]
852:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Could not save firm&quot;</span>
853:     <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">reload</span>
854:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">length</span>
855:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006085" class="method">
  <div id="M006085_title" class="title">
    <b>test_replace_with_less_and_dependent_nullify</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006085_source')" id="l_M006085_source">show source</a> ]</p>
  <div id="M006085_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 857</span>
857:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_replace_with_less_and_dependent_nullify</span>
858:     <span class="ruby-identifier">num_companies</span> = <span class="ruby-constant">Company</span>.<span class="ruby-identifier">count</span>
859:     <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:rails_core</span>).<span class="ruby-identifier">companies</span> = []
860:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">num_companies</span>, <span class="ruby-constant">Company</span>.<span class="ruby-identifier">count</span>
861:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006086" class="method">
  <div id="M006086_title" class="title">
    <b>test_replace_with_new</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006086_source')" id="l_M006086_source">show source</a> ]</p>
  <div id="M006086_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 863</span>
863:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_replace_with_new</span>
864:     <span class="ruby-identifier">firm</span> = <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>)
865:     <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span> = [<span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:second_client</span>), <span class="ruby-constant">Client</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;New Client&quot;</span>)]
866:     <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">save</span>
867:     <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">reload</span>
868:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">length</span>
869:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">firm</span>.<span class="ruby-identifier">clients</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">:first_client</span>)
870:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006116" class="method">
  <div id="M006116_title" class="title">
    <b>test_respond_to_private_class_methods</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006116_source')" id="l_M006116_source">show source</a> ]</p>
  <div id="M006116_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 1110</span>
1110:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_respond_to_private_class_methods</span>
1111:     <span class="ruby-identifier">client_association</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients</span>
1112:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">client_association</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:private_method</span>)
1113:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">client_association</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:private_method</span>, <span class="ruby-keyword kw">true</span>)
1114:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006115" class="method">
  <div id="M006115_title" class="title">
    <b>test_sending_new_to_association_proxy_should_have_same_effect_as_calling_new</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006115_source')" id="l_M006115_source">show source</a> ]</p>
  <div id="M006115_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 1105</span>
1105:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_sending_new_to_association_proxy_should_have_same_effect_as_calling_new</span>
1106:     <span class="ruby-identifier">client_association</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">clients</span>
1107:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">client_association</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">attributes</span>, <span class="ruby-identifier">client_association</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:new</span>).<span class="ruby-identifier">attributes</span>
1108:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006076" class="method">
  <div id="M006076_title" class="title">
    <b>test_three_levels_of_dependence</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006076_source')" id="l_M006076_source">show source</a> ]</p>
  <div id="M006076_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 794</span>
794:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_three_levels_of_dependence</span>
795:     <span class="ruby-identifier">topic</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span> <span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;neat and simple&quot;</span>
796:     <span class="ruby-identifier">reply</span> = <span class="ruby-identifier">topic</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">create</span> <span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;neat and simple&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;still digging it&quot;</span>
797:     <span class="ruby-identifier">silly_reply</span> = <span class="ruby-identifier">reply</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">create</span> <span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;neat and simple&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;ain't complaining&quot;</span>
798: 
799:     <span class="ruby-identifier">assert_nothing_raised</span> { <span class="ruby-identifier">topic</span>.<span class="ruby-identifier">destroy</span> }
800:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006000" class="method">
  <div id="M006000_title" class="title">
    <b>test_triple_equality</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006000_source')" id="l_M006000_source">show source</a> ]</p>
  <div id="M006000_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/has_many_associations_test.rb, line 118</span>
118:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_triple_equality</span>
119:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span>(<span class="ruby-constant">Array</span> <span class="ruby-operator">===</span> <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>).<span class="ruby-identifier">clients</span>)
120:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>).<span class="ruby-identifier">clients</span> <span class="ruby-operator">===</span> <span class="ruby-constant">Array</span>
121:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
</div>

  </div>