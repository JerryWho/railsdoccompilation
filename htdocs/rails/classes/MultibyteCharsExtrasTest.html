  <div id="C00000717">
<div class='banner'>
  <span class="file-title-prefix">Class</span><br />MultibyteCharsExtrasTest<br/>
  In:
<a href="#" onclick="jsHref('files/activesupport/test/multibyte_chars_test_rb.html');">activesupport/test/multibyte_chars_test.rb</a>

Parent:&nbsp;
Test::Unit::TestCase
</div>
 <!-- banner header -->

  <div id="bodyContent" >
      <div id="content">

  <div class="description"><p>
The default Multibyte Chars proxy has more features than the normal string
implementation. Tests for the implementation of these features should run
on all Ruby versions and shouldn&#8217;t be tested through the proxy
methods.
</p>
</div>



  <div class="sectiontitle">Methods</div>
  <ul>
  <li><a href="index.html?a=M004641&name=test_capitalize_should_be_unicode_aware" >test_capitalize_should_be_unicode_aware</a></li>
  <li><a href="index.html?a=M004642&name=test_composition_exclusion_is_set_up_properly" >test_composition_exclusion_is_set_up_properly</a></li>
  <li><a href="index.html?a=M004640&name=test_downcase_should_be_unicode_aware" >test_downcase_should_be_unicode_aware</a></li>
  <li><a href="index.html?a=M004643&name=test_normalization_C_pri_29" >test_normalization_C_pri_29</a></li>
  <li><a href="index.html?a=M004644&name=test_normalization_shouldnt_strip_null_bytes" >test_normalization_shouldnt_strip_null_bytes</a></li>
  <li><a href="index.html?a=M004646&name=test_should_compute_grapheme_length" >test_should_compute_grapheme_length</a></li>
  <li><a href="index.html?a=M004645&name=test_simple_normalization" >test_simple_normalization</a></li>
  <li><a href="index.html?a=M004638&name=test_tidy_bytes_is_broken_on_1_9_0" >test_tidy_bytes_is_broken_on_1_9_0</a></li>
  <li><a href="index.html?a=M004647&name=test_tidy_bytes_should_tidy_bytes" >test_tidy_bytes_should_tidy_bytes</a></li>
  <li><a href="index.html?a=M004639&name=test_upcase_should_be_unicode_aware" >test_upcase_should_be_unicode_aware</a></li>
  </ul>

<div class="sectiontitle">Included Modules</div>
<ul>
  <li><a href="#" onclick="jsHref('classes/MultibyteTestHelpers.html');">MultibyteTestHelpers</a></li>
</ul>





<div class="sectiontitle">Public Instance methods</div>
<div id="M004641" class="method">
  <div id="M004641_title" class="title">
    <b>test_capitalize_should_be_unicode_aware</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M004641_source')" id="l_M004641_source">show source</a> ]</p>
  <div id="M004641_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activesupport/test/multibyte_chars_test.rb, line 488</span>
488:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_capitalize_should_be_unicode_aware</span>
489:     { <span class="ruby-value str">'аБвг аБвг'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'Абвг абвг'</span>,
490:       <span class="ruby-value str">'аБвг АБВГ'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'Абвг абвг'</span>,
491:       <span class="ruby-value str">'АБВГ АБВГ'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'Абвг абвг'</span>,
492:       <span class="ruby-value str">''</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">''</span> }.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f</span>,<span class="ruby-identifier">t</span><span class="ruby-operator">|</span>
493:         <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">t</span>, <span class="ruby-identifier">chars</span>(<span class="ruby-identifier">f</span>).<span class="ruby-identifier">capitalize</span>
494:     <span class="ruby-keyword kw">end</span>
495:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M004642" class="method">
  <div id="M004642_title" class="title">
    <b>test_composition_exclusion_is_set_up_properly</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M004642_source')" id="l_M004642_source">show source</a> ]</p>
  <div id="M004642_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activesupport/test/multibyte_chars_test.rb, line 497</span>
497:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_composition_exclusion_is_set_up_properly</span>
498:     <span class="ruby-comment cmt"># Normalization of DEVANAGARI LETTER QA breaks when composition exclusion isn't used correctly</span>
499:     <span class="ruby-identifier">qa</span> = [<span class="ruby-value">0x915</span>, <span class="ruby-value">0x93c</span>].<span class="ruby-identifier">pack</span>(<span class="ruby-value str">'U*'</span>)
500:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">qa</span>, <span class="ruby-identifier">chars</span>(<span class="ruby-identifier">qa</span>).<span class="ruby-identifier">normalize</span>(<span class="ruby-identifier">:c</span>)
501:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M004640" class="method">
  <div id="M004640_title" class="title">
    <b>test_downcase_should_be_unicode_aware</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M004640_source')" id="l_M004640_source">show source</a> ]</p>
  <div id="M004640_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activesupport/test/multibyte_chars_test.rb, line 483</span>
483:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_downcase_should_be_unicode_aware</span>
484:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;абвгд\0f&quot;</span>, <span class="ruby-identifier">chars</span>(<span class="ruby-value str">&quot;аБвгд\0f&quot;</span>).<span class="ruby-identifier">downcase</span>
485:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'こにちわ'</span>, <span class="ruby-identifier">chars</span>(<span class="ruby-value str">'こにちわ'</span>).<span class="ruby-identifier">downcase</span>
486:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M004643" class="method">
  <div id="M004643_title" class="title">
    <b>test_normalization_C_pri_29</b>()
  </div>
  <div class="description">
  <p>
<a href="index.html?a=C00001790&name=Test">Test</a> for the Public Review
Issue 29, bad explanation of composition might lead to a bad
implementation: <a href="http://www.unicode.org/review/pr-29.html"
target="_blank">http://www.unicode.org/review/pr-29.html</a>
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M004643_source')" id="l_M004643_source">show source</a> ]</p>
  <div id="M004643_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activesupport/test/multibyte_chars_test.rb, line 505</span>
505:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_normalization_C_pri_29</span>
506:     [
507:       [<span class="ruby-value">0x0</span><span class="ruby-constant">B47</span>, <span class="ruby-value">0x0300</span>, <span class="ruby-value">0x0</span><span class="ruby-constant">B3E</span>],
508:       [<span class="ruby-value">0x1100</span>, <span class="ruby-value">0x0300</span>, <span class="ruby-value">0x1161</span>]
509:     ].<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">pack</span>(<span class="ruby-value str">'U*'</span>) }.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span>
510:       <span class="ruby-identifier">assert_equal_codepoints</span> <span class="ruby-identifier">c</span>, <span class="ruby-identifier">chars</span>(<span class="ruby-identifier">c</span>).<span class="ruby-identifier">normalize</span>(<span class="ruby-identifier">:c</span>)
511:     <span class="ruby-keyword kw">end</span>
512:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M004644" class="method">
  <div id="M004644_title" class="title">
    <b>test_normalization_shouldnt_strip_null_bytes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M004644_source')" id="l_M004644_source">show source</a> ]</p>
  <div id="M004644_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activesupport/test/multibyte_chars_test.rb, line 514</span>
514:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_normalization_shouldnt_strip_null_bytes</span>
515:     <span class="ruby-identifier">null_byte_str</span> = <span class="ruby-value str">&quot;Test\0test&quot;</span>
516: 
517:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">null_byte_str</span>, <span class="ruby-identifier">chars</span>(<span class="ruby-identifier">null_byte_str</span>).<span class="ruby-identifier">normalize</span>(<span class="ruby-identifier">:kc</span>)
518:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">null_byte_str</span>, <span class="ruby-identifier">chars</span>(<span class="ruby-identifier">null_byte_str</span>).<span class="ruby-identifier">normalize</span>(<span class="ruby-identifier">:c</span>)
519:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">null_byte_str</span>, <span class="ruby-identifier">chars</span>(<span class="ruby-identifier">null_byte_str</span>).<span class="ruby-identifier">normalize</span>(<span class="ruby-identifier">:d</span>)
520:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">null_byte_str</span>, <span class="ruby-identifier">chars</span>(<span class="ruby-identifier">null_byte_str</span>).<span class="ruby-identifier">normalize</span>(<span class="ruby-identifier">:kd</span>)
521:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">null_byte_str</span>, <span class="ruby-identifier">chars</span>(<span class="ruby-identifier">null_byte_str</span>).<span class="ruby-identifier">decompose</span>
522:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">null_byte_str</span>, <span class="ruby-identifier">chars</span>(<span class="ruby-identifier">null_byte_str</span>).<span class="ruby-identifier">compose</span>
523:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M004646" class="method">
  <div id="M004646_title" class="title">
    <b>test_should_compute_grapheme_length</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M004646_source')" id="l_M004646_source">show source</a> ]</p>
  <div id="M004646_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activesupport/test/multibyte_chars_test.rb, line 540</span>
540:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_compute_grapheme_length</span>
541:     [
542:       [<span class="ruby-value str">''</span>, <span class="ruby-value">0</span>],
543:       [<span class="ruby-value str">'abc'</span>, <span class="ruby-value">3</span>],
544:       [<span class="ruby-value str">'こにちわ'</span>, <span class="ruby-value">4</span>],
545:       [[<span class="ruby-value">0x0924</span>, <span class="ruby-value">0x094</span><span class="ruby-constant">D</span>, <span class="ruby-value">0x0930</span>].<span class="ruby-identifier">pack</span>(<span class="ruby-value str">'U*'</span>), <span class="ruby-value">2</span>],
546:       [<span class="ruby-node">%w(cr lf)</span>, <span class="ruby-value">1</span>],
547:       [<span class="ruby-node">%w(l l)</span>, <span class="ruby-value">1</span>],
548:       [<span class="ruby-node">%w(l v)</span>, <span class="ruby-value">1</span>],
549:       [<span class="ruby-node">%w(l lv)</span>, <span class="ruby-value">1</span>],
550:       [<span class="ruby-node">%w(l lvt)</span>, <span class="ruby-value">1</span>],
551:       [<span class="ruby-node">%w(lv v)</span>, <span class="ruby-value">1</span>],
552:       [<span class="ruby-node">%w(lv t)</span>, <span class="ruby-value">1</span>],
553:       [<span class="ruby-node">%w(v v)</span>, <span class="ruby-value">1</span>],
554:       [<span class="ruby-node">%w(v t)</span>, <span class="ruby-value">1</span>],
555:       [<span class="ruby-node">%w(lvt t)</span>, <span class="ruby-value">1</span>],
556:       [<span class="ruby-node">%w(t t)</span>, <span class="ruby-value">1</span>],
557:       [<span class="ruby-node">%w(n extend)</span>, <span class="ruby-value">1</span>],
558:       [<span class="ruby-node">%w(n n)</span>, <span class="ruby-value">2</span>],
559:       [<span class="ruby-node">%w(n cr lf n)</span>, <span class="ruby-value">3</span>],
560:       [<span class="ruby-node">%w(n l v t)</span>, <span class="ruby-value">2</span>]
561:     ].<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">input</span>, <span class="ruby-identifier">expected_length</span><span class="ruby-operator">|</span>
562:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">input</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">Array</span>)
563:         <span class="ruby-identifier">str</span> = <span class="ruby-identifier">string_from_classes</span>(<span class="ruby-identifier">input</span>)
564:       <span class="ruby-keyword kw">else</span>
565:         <span class="ruby-identifier">str</span> = <span class="ruby-identifier">input</span>
566:       <span class="ruby-keyword kw">end</span>
567:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">expected_length</span>, <span class="ruby-identifier">chars</span>(<span class="ruby-identifier">str</span>).<span class="ruby-identifier">g_length</span>
568:     <span class="ruby-keyword kw">end</span>
569:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M004645" class="method">
  <div id="M004645_title" class="title">
    <b>test_simple_normalization</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M004645_source')" id="l_M004645_source">show source</a> ]</p>
  <div id="M004645_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activesupport/test/multibyte_chars_test.rb, line 525</span>
525:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_simple_normalization</span>
526:     <span class="ruby-identifier">comp_str</span> = [
527:       <span class="ruby-value">44</span>,  <span class="ruby-comment cmt"># LATIN CAPITAL LETTER D</span>
528:       <span class="ruby-value">307</span>, <span class="ruby-comment cmt"># COMBINING DOT ABOVE</span>
529:       <span class="ruby-value">328</span>, <span class="ruby-comment cmt"># COMBINING OGONEK</span>
530:       <span class="ruby-value">323</span> <span class="ruby-comment cmt"># COMBINING DOT BELOW</span>
531:     ].<span class="ruby-identifier">pack</span>(<span class="ruby-value str">&quot;U*&quot;</span>)
532: 
533:     <span class="ruby-identifier">assert_equal_codepoints</span> <span class="ruby-value str">''</span>, <span class="ruby-identifier">chars</span>(<span class="ruby-value str">''</span>).<span class="ruby-identifier">normalize</span>
534:     <span class="ruby-identifier">assert_equal_codepoints</span> [<span class="ruby-value">44</span>,<span class="ruby-value">105</span>,<span class="ruby-value">106</span>,<span class="ruby-value">328</span>,<span class="ruby-value">323</span>].<span class="ruby-identifier">pack</span>(<span class="ruby-value str">&quot;U*&quot;</span>), <span class="ruby-identifier">chars</span>(<span class="ruby-identifier">comp_str</span>).<span class="ruby-identifier">normalize</span>(<span class="ruby-identifier">:kc</span>).<span class="ruby-identifier">to_s</span>
535:     <span class="ruby-identifier">assert_equal_codepoints</span> [<span class="ruby-value">44</span>,<span class="ruby-value">307</span>,<span class="ruby-value">328</span>,<span class="ruby-value">323</span>].<span class="ruby-identifier">pack</span>(<span class="ruby-value str">&quot;U*&quot;</span>), <span class="ruby-identifier">chars</span>(<span class="ruby-identifier">comp_str</span>).<span class="ruby-identifier">normalize</span>(<span class="ruby-identifier">:c</span>).<span class="ruby-identifier">to_s</span>
536:     <span class="ruby-identifier">assert_equal_codepoints</span> [<span class="ruby-value">44</span>,<span class="ruby-value">307</span>,<span class="ruby-value">110</span>,<span class="ruby-value">780</span>,<span class="ruby-value">78</span>,<span class="ruby-value">769</span>].<span class="ruby-identifier">pack</span>(<span class="ruby-value str">&quot;U*&quot;</span>), <span class="ruby-identifier">chars</span>(<span class="ruby-identifier">comp_str</span>).<span class="ruby-identifier">normalize</span>(<span class="ruby-identifier">:d</span>).<span class="ruby-identifier">to_s</span>
537:     <span class="ruby-identifier">assert_equal_codepoints</span> [<span class="ruby-value">44</span>,<span class="ruby-value">105</span>,<span class="ruby-value">106</span>,<span class="ruby-value">110</span>,<span class="ruby-value">780</span>,<span class="ruby-value">78</span>,<span class="ruby-value">769</span>].<span class="ruby-identifier">pack</span>(<span class="ruby-value str">&quot;U*&quot;</span>), <span class="ruby-identifier">chars</span>(<span class="ruby-identifier">comp_str</span>).<span class="ruby-identifier">normalize</span>(<span class="ruby-identifier">:kd</span>).<span class="ruby-identifier">to_s</span>
538:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M004638" class="method">
  <div id="M004638_title" class="title">
    <b>test_tidy_bytes_is_broken_on_1_9_0</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M004638_source')" id="l_M004638_source">show source</a> ]</p>
  <div id="M004638_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activesupport/test/multibyte_chars_test.rb, line 471</span>
471:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_tidy_bytes_is_broken_on_1_9_0</span>
472:       <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ArgumentError</span>) <span class="ruby-keyword kw">do</span>
473:         <span class="ruby-identifier">assert_equal_codepoints</span> [<span class="ruby-value">0xfffd</span>].<span class="ruby-identifier">pack</span>(<span class="ruby-value str">'U'</span>), <span class="ruby-identifier">chars</span>(<span class="ruby-value str">&quot;\xef\xbf\xbd&quot;</span>).<span class="ruby-identifier">tidy_bytes</span>
474:       <span class="ruby-keyword kw">end</span>
475:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M004647" class="method">
  <div id="M004647_title" class="title">
    <b>test_tidy_bytes_should_tidy_bytes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M004647_source')" id="l_M004647_source">show source</a> ]</p>
  <div id="M004647_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activesupport/test/multibyte_chars_test.rb, line 571</span>
571:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_tidy_bytes_should_tidy_bytes</span>
572:     <span class="ruby-identifier">byte_string</span> = <span class="ruby-value str">&quot;\270\236\010\210\245&quot;</span>
573:     <span class="ruby-identifier">tidy_string</span> = [<span class="ruby-value">0xb8</span>, <span class="ruby-value">0x17e</span>, <span class="ruby-value">0x8</span>, <span class="ruby-value">0x2c6</span>, <span class="ruby-value">0xa5</span>].<span class="ruby-identifier">pack</span>(<span class="ruby-value str">'U*'</span>)
574:     <span class="ruby-identifier">ascii_padding</span> = <span class="ruby-value str">'aa'</span>
575:     <span class="ruby-identifier">utf8_padding</span> = <span class="ruby-value str">'éé'</span>
576: 
577:     <span class="ruby-identifier">assert_equal_codepoints</span> <span class="ruby-identifier">tidy_string</span>, <span class="ruby-identifier">chars</span>(<span class="ruby-identifier">byte_string</span>).<span class="ruby-identifier">tidy_bytes</span>
578: 
579:     <span class="ruby-identifier">assert_equal_codepoints</span> <span class="ruby-identifier">ascii_padding</span>.<span class="ruby-identifier">dup</span>.<span class="ruby-identifier">insert</span>(<span class="ruby-value">1</span>, <span class="ruby-identifier">tidy_string</span>),
580:       <span class="ruby-identifier">chars</span>(<span class="ruby-identifier">ascii_padding</span>.<span class="ruby-identifier">dup</span>.<span class="ruby-identifier">insert</span>(<span class="ruby-value">1</span>, <span class="ruby-identifier">byte_string</span>)).<span class="ruby-identifier">tidy_bytes</span>
581:     <span class="ruby-identifier">assert_equal_codepoints</span> <span class="ruby-identifier">utf8_padding</span>.<span class="ruby-identifier">dup</span>.<span class="ruby-identifier">insert</span>(<span class="ruby-value">2</span>, <span class="ruby-identifier">tidy_string</span>),
582:       <span class="ruby-identifier">chars</span>(<span class="ruby-identifier">utf8_padding</span>.<span class="ruby-identifier">dup</span>.<span class="ruby-identifier">insert</span>(<span class="ruby-value">2</span>, <span class="ruby-identifier">byte_string</span>)).<span class="ruby-identifier">tidy_bytes</span>
583:     <span class="ruby-identifier">assert_nothing_raised</span> { <span class="ruby-identifier">chars</span>(<span class="ruby-identifier">byte_string</span>).<span class="ruby-identifier">tidy_bytes</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">unpack</span>(<span class="ruby-value str">'U*'</span>) }
584: 
585:     <span class="ruby-identifier">assert_equal_codepoints</span> <span class="ruby-value str">&quot;\xC3\xA7&quot;</span>, <span class="ruby-identifier">chars</span>(<span class="ruby-value str">&quot;\xE7&quot;</span>).<span class="ruby-identifier">tidy_bytes</span> <span class="ruby-comment cmt"># iso_8859_1: small c cedilla</span>
586:     <span class="ruby-identifier">assert_equal_codepoints</span> <span class="ruby-value str">&quot;\xE2\x80\x9C&quot;</span>, <span class="ruby-identifier">chars</span>(<span class="ruby-value str">&quot;\x93&quot;</span>).<span class="ruby-identifier">tidy_bytes</span> <span class="ruby-comment cmt"># win_1252: left smart quote</span>
587:     <span class="ruby-identifier">assert_equal_codepoints</span> <span class="ruby-value str">&quot;\xE2\x82\xAC&quot;</span>, <span class="ruby-identifier">chars</span>(<span class="ruby-value str">&quot;\x80&quot;</span>).<span class="ruby-identifier">tidy_bytes</span> <span class="ruby-comment cmt"># win_1252: euro</span>
588:     <span class="ruby-identifier">assert_equal_codepoints</span> <span class="ruby-value str">&quot;\x00&quot;</span>, <span class="ruby-identifier">chars</span>(<span class="ruby-value str">&quot;\x00&quot;</span>).<span class="ruby-identifier">tidy_bytes</span> <span class="ruby-comment cmt"># null char</span>
589:     <span class="ruby-identifier">assert_equal_codepoints</span> [<span class="ruby-value">0xfffd</span>].<span class="ruby-identifier">pack</span>(<span class="ruby-value str">'U'</span>), <span class="ruby-identifier">chars</span>(<span class="ruby-value str">&quot;\xef\xbf\xbd&quot;</span>).<span class="ruby-identifier">tidy_bytes</span> <span class="ruby-comment cmt"># invalid char</span>
590:   <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">ArgumentError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
591:     <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span> <span class="ruby-keyword kw">if</span> <span class="ruby-constant">RUBY_VERSION</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value str">'1.9'</span>
592:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M004639" class="method">
  <div id="M004639_title" class="title">
    <b>test_upcase_should_be_unicode_aware</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M004639_source')" id="l_M004639_source">show source</a> ]</p>
  <div id="M004639_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activesupport/test/multibyte_chars_test.rb, line 478</span>
478:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_upcase_should_be_unicode_aware</span>
479:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;АБВГД\0F&quot;</span>, <span class="ruby-identifier">chars</span>(<span class="ruby-value str">&quot;аБвгд\0f&quot;</span>).<span class="ruby-identifier">upcase</span>
480:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'こにちわ'</span>, <span class="ruby-identifier">chars</span>(<span class="ruby-value str">'こにちわ'</span>).<span class="ruby-identifier">upcase</span>
481:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
</div>

  </div>