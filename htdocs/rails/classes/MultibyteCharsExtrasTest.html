  <div id="C00000708">
<div class='banner'>
  <span class="file-title-prefix">Class</span><br />MultibyteCharsExtrasTest<br/>
  In:
<a href="#" onclick="jsHref('files/activesupport/test/multibyte_chars_test_rb.html');">activesupport/test/multibyte_chars_test.rb</a>

Parent:&nbsp;
Test::Unit::TestCase
</div>
 <!-- banner header -->

  <div id="bodyContent" >
      <div id="content">

  <div class="description"><p>
The default Multibyte Chars proxy has more features than the normal string
implementation. Tests for the implementation of these features should run
on all Ruby versions and shouldn&#8217;t be tested through the proxy
methods.
</p>
</div>



  <div class="sectiontitle">Methods</div>
  <ul>
  <li><a href="index.html?a=M004606&name=test_capitalize_should_be_unicode_aware" >test_capitalize_should_be_unicode_aware</a></li>
  <li><a href="index.html?a=M004607&name=test_composition_exclusion_is_set_up_properly" >test_composition_exclusion_is_set_up_properly</a></li>
  <li><a href="index.html?a=M004605&name=test_downcase_should_be_unicode_aware" >test_downcase_should_be_unicode_aware</a></li>
  <li><a href="index.html?a=M004608&name=test_normalization_C_pri_29" >test_normalization_C_pri_29</a></li>
  <li><a href="index.html?a=M004609&name=test_normalization_shouldnt_strip_null_bytes" >test_normalization_shouldnt_strip_null_bytes</a></li>
  <li><a href="index.html?a=M004611&name=test_should_compute_grapheme_length" >test_should_compute_grapheme_length</a></li>
  <li><a href="index.html?a=M004610&name=test_simple_normalization" >test_simple_normalization</a></li>
  <li><a href="index.html?a=M004603&name=test_tidy_bytes_is_broken_on_1_9_0" >test_tidy_bytes_is_broken_on_1_9_0</a></li>
  <li><a href="index.html?a=M004612&name=test_tidy_bytes_should_tidy_bytes" >test_tidy_bytes_should_tidy_bytes</a></li>
  <li><a href="index.html?a=M004604&name=test_upcase_should_be_unicode_aware" >test_upcase_should_be_unicode_aware</a></li>
  </ul>

<div class="sectiontitle">Included Modules</div>
<ul>
  <li><a href="#" onclick="jsHref('classes/MultibyteTestHelpers.html');">MultibyteTestHelpers</a></li>
</ul>





<div class="sectiontitle">Public Instance methods</div>
<div id="M004606" class="method">
  <div id="M004606_title" class="title">
    <b>test_capitalize_should_be_unicode_aware</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M004606_source')" id="l_M004606_source">show source</a> ]</p>
  <div id="M004606_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activesupport/test/multibyte_chars_test.rb, line 471</span>
471:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_capitalize_should_be_unicode_aware</span>
472:     { <span class="ruby-value str">'аБвг аБвг'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'Абвг абвг'</span>,
473:       <span class="ruby-value str">'аБвг АБВГ'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'Абвг абвг'</span>,
474:       <span class="ruby-value str">'АБВГ АБВГ'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'Абвг абвг'</span>,
475:       <span class="ruby-value str">''</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">''</span> }.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f</span>,<span class="ruby-identifier">t</span><span class="ruby-operator">|</span>
476:         <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">t</span>, <span class="ruby-identifier">chars</span>(<span class="ruby-identifier">f</span>).<span class="ruby-identifier">capitalize</span>
477:     <span class="ruby-keyword kw">end</span>
478:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M004607" class="method">
  <div id="M004607_title" class="title">
    <b>test_composition_exclusion_is_set_up_properly</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M004607_source')" id="l_M004607_source">show source</a> ]</p>
  <div id="M004607_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activesupport/test/multibyte_chars_test.rb, line 480</span>
480:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_composition_exclusion_is_set_up_properly</span>
481:     <span class="ruby-comment cmt"># Normalization of DEVANAGARI LETTER QA breaks when composition exclusion isn't used correctly</span>
482:     <span class="ruby-identifier">qa</span> = [<span class="ruby-value">0x915</span>, <span class="ruby-value">0x93c</span>].<span class="ruby-identifier">pack</span>(<span class="ruby-value str">'U*'</span>)
483:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">qa</span>, <span class="ruby-identifier">chars</span>(<span class="ruby-identifier">qa</span>).<span class="ruby-identifier">normalize</span>(<span class="ruby-identifier">:c</span>)
484:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M004605" class="method">
  <div id="M004605_title" class="title">
    <b>test_downcase_should_be_unicode_aware</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M004605_source')" id="l_M004605_source">show source</a> ]</p>
  <div id="M004605_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activesupport/test/multibyte_chars_test.rb, line 466</span>
466:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_downcase_should_be_unicode_aware</span>
467:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;абвгд\0f&quot;</span>, <span class="ruby-identifier">chars</span>(<span class="ruby-value str">&quot;аБвгд\0f&quot;</span>).<span class="ruby-identifier">downcase</span>
468:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'こにちわ'</span>, <span class="ruby-identifier">chars</span>(<span class="ruby-value str">'こにちわ'</span>).<span class="ruby-identifier">downcase</span>
469:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M004608" class="method">
  <div id="M004608_title" class="title">
    <b>test_normalization_C_pri_29</b>()
  </div>
  <div class="description">
  <p>
<a href="index.html?a=C00001760&name=Test">Test</a> for the Public Review
Issue 29, bad explanation of composition might lead to a bad
implementation: <a href="http://www.unicode.org/review/pr-29.html"
target="_blank">http://www.unicode.org/review/pr-29.html</a>
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M004608_source')" id="l_M004608_source">show source</a> ]</p>
  <div id="M004608_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activesupport/test/multibyte_chars_test.rb, line 488</span>
488:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_normalization_C_pri_29</span>
489:     [
490:       [<span class="ruby-value">0x0</span><span class="ruby-constant">B47</span>, <span class="ruby-value">0x0300</span>, <span class="ruby-value">0x0</span><span class="ruby-constant">B3E</span>],
491:       [<span class="ruby-value">0x1100</span>, <span class="ruby-value">0x0300</span>, <span class="ruby-value">0x1161</span>]
492:     ].<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">pack</span>(<span class="ruby-value str">'U*'</span>) }.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span>
493:       <span class="ruby-identifier">assert_equal_codepoints</span> <span class="ruby-identifier">c</span>, <span class="ruby-identifier">chars</span>(<span class="ruby-identifier">c</span>).<span class="ruby-identifier">normalize</span>(<span class="ruby-identifier">:c</span>)
494:     <span class="ruby-keyword kw">end</span>
495:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M004609" class="method">
  <div id="M004609_title" class="title">
    <b>test_normalization_shouldnt_strip_null_bytes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M004609_source')" id="l_M004609_source">show source</a> ]</p>
  <div id="M004609_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activesupport/test/multibyte_chars_test.rb, line 497</span>
497:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_normalization_shouldnt_strip_null_bytes</span>
498:     <span class="ruby-identifier">null_byte_str</span> = <span class="ruby-value str">&quot;Test\0test&quot;</span>
499: 
500:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">null_byte_str</span>, <span class="ruby-identifier">chars</span>(<span class="ruby-identifier">null_byte_str</span>).<span class="ruby-identifier">normalize</span>(<span class="ruby-identifier">:kc</span>)
501:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">null_byte_str</span>, <span class="ruby-identifier">chars</span>(<span class="ruby-identifier">null_byte_str</span>).<span class="ruby-identifier">normalize</span>(<span class="ruby-identifier">:c</span>)
502:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">null_byte_str</span>, <span class="ruby-identifier">chars</span>(<span class="ruby-identifier">null_byte_str</span>).<span class="ruby-identifier">normalize</span>(<span class="ruby-identifier">:d</span>)
503:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">null_byte_str</span>, <span class="ruby-identifier">chars</span>(<span class="ruby-identifier">null_byte_str</span>).<span class="ruby-identifier">normalize</span>(<span class="ruby-identifier">:kd</span>)
504:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">null_byte_str</span>, <span class="ruby-identifier">chars</span>(<span class="ruby-identifier">null_byte_str</span>).<span class="ruby-identifier">decompose</span>
505:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">null_byte_str</span>, <span class="ruby-identifier">chars</span>(<span class="ruby-identifier">null_byte_str</span>).<span class="ruby-identifier">compose</span>
506:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M004611" class="method">
  <div id="M004611_title" class="title">
    <b>test_should_compute_grapheme_length</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M004611_source')" id="l_M004611_source">show source</a> ]</p>
  <div id="M004611_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activesupport/test/multibyte_chars_test.rb, line 523</span>
523:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_compute_grapheme_length</span>
524:     [
525:       [<span class="ruby-value str">''</span>, <span class="ruby-value">0</span>],
526:       [<span class="ruby-value str">'abc'</span>, <span class="ruby-value">3</span>],
527:       [<span class="ruby-value str">'こにちわ'</span>, <span class="ruby-value">4</span>],
528:       [[<span class="ruby-value">0x0924</span>, <span class="ruby-value">0x094</span><span class="ruby-constant">D</span>, <span class="ruby-value">0x0930</span>].<span class="ruby-identifier">pack</span>(<span class="ruby-value str">'U*'</span>), <span class="ruby-value">2</span>],
529:       [<span class="ruby-node">%w(cr lf)</span>, <span class="ruby-value">1</span>],
530:       [<span class="ruby-node">%w(l l)</span>, <span class="ruby-value">1</span>],
531:       [<span class="ruby-node">%w(l v)</span>, <span class="ruby-value">1</span>],
532:       [<span class="ruby-node">%w(l lv)</span>, <span class="ruby-value">1</span>],
533:       [<span class="ruby-node">%w(l lvt)</span>, <span class="ruby-value">1</span>],
534:       [<span class="ruby-node">%w(lv v)</span>, <span class="ruby-value">1</span>],
535:       [<span class="ruby-node">%w(lv t)</span>, <span class="ruby-value">1</span>],
536:       [<span class="ruby-node">%w(v v)</span>, <span class="ruby-value">1</span>],
537:       [<span class="ruby-node">%w(v t)</span>, <span class="ruby-value">1</span>],
538:       [<span class="ruby-node">%w(lvt t)</span>, <span class="ruby-value">1</span>],
539:       [<span class="ruby-node">%w(t t)</span>, <span class="ruby-value">1</span>],
540:       [<span class="ruby-node">%w(n extend)</span>, <span class="ruby-value">1</span>],
541:       [<span class="ruby-node">%w(n n)</span>, <span class="ruby-value">2</span>],
542:       [<span class="ruby-node">%w(n cr lf n)</span>, <span class="ruby-value">3</span>],
543:       [<span class="ruby-node">%w(n l v t)</span>, <span class="ruby-value">2</span>]
544:     ].<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">input</span>, <span class="ruby-identifier">expected_length</span><span class="ruby-operator">|</span>
545:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">input</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">Array</span>)
546:         <span class="ruby-identifier">str</span> = <span class="ruby-identifier">string_from_classes</span>(<span class="ruby-identifier">input</span>)
547:       <span class="ruby-keyword kw">else</span>
548:         <span class="ruby-identifier">str</span> = <span class="ruby-identifier">input</span>
549:       <span class="ruby-keyword kw">end</span>
550:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">expected_length</span>, <span class="ruby-identifier">chars</span>(<span class="ruby-identifier">str</span>).<span class="ruby-identifier">g_length</span>
551:     <span class="ruby-keyword kw">end</span>
552:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M004610" class="method">
  <div id="M004610_title" class="title">
    <b>test_simple_normalization</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M004610_source')" id="l_M004610_source">show source</a> ]</p>
  <div id="M004610_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activesupport/test/multibyte_chars_test.rb, line 508</span>
508:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_simple_normalization</span>
509:     <span class="ruby-identifier">comp_str</span> = [
510:       <span class="ruby-value">44</span>,  <span class="ruby-comment cmt"># LATIN CAPITAL LETTER D</span>
511:       <span class="ruby-value">307</span>, <span class="ruby-comment cmt"># COMBINING DOT ABOVE</span>
512:       <span class="ruby-value">328</span>, <span class="ruby-comment cmt"># COMBINING OGONEK</span>
513:       <span class="ruby-value">323</span> <span class="ruby-comment cmt"># COMBINING DOT BELOW</span>
514:     ].<span class="ruby-identifier">pack</span>(<span class="ruby-value str">&quot;U*&quot;</span>)
515: 
516:     <span class="ruby-identifier">assert_equal_codepoints</span> <span class="ruby-value str">''</span>, <span class="ruby-identifier">chars</span>(<span class="ruby-value str">''</span>).<span class="ruby-identifier">normalize</span>
517:     <span class="ruby-identifier">assert_equal_codepoints</span> [<span class="ruby-value">44</span>,<span class="ruby-value">105</span>,<span class="ruby-value">106</span>,<span class="ruby-value">328</span>,<span class="ruby-value">323</span>].<span class="ruby-identifier">pack</span>(<span class="ruby-value str">&quot;U*&quot;</span>), <span class="ruby-identifier">chars</span>(<span class="ruby-identifier">comp_str</span>).<span class="ruby-identifier">normalize</span>(<span class="ruby-identifier">:kc</span>).<span class="ruby-identifier">to_s</span>
518:     <span class="ruby-identifier">assert_equal_codepoints</span> [<span class="ruby-value">44</span>,<span class="ruby-value">307</span>,<span class="ruby-value">328</span>,<span class="ruby-value">323</span>].<span class="ruby-identifier">pack</span>(<span class="ruby-value str">&quot;U*&quot;</span>), <span class="ruby-identifier">chars</span>(<span class="ruby-identifier">comp_str</span>).<span class="ruby-identifier">normalize</span>(<span class="ruby-identifier">:c</span>).<span class="ruby-identifier">to_s</span>
519:     <span class="ruby-identifier">assert_equal_codepoints</span> [<span class="ruby-value">44</span>,<span class="ruby-value">307</span>,<span class="ruby-value">110</span>,<span class="ruby-value">780</span>,<span class="ruby-value">78</span>,<span class="ruby-value">769</span>].<span class="ruby-identifier">pack</span>(<span class="ruby-value str">&quot;U*&quot;</span>), <span class="ruby-identifier">chars</span>(<span class="ruby-identifier">comp_str</span>).<span class="ruby-identifier">normalize</span>(<span class="ruby-identifier">:d</span>).<span class="ruby-identifier">to_s</span>
520:     <span class="ruby-identifier">assert_equal_codepoints</span> [<span class="ruby-value">44</span>,<span class="ruby-value">105</span>,<span class="ruby-value">106</span>,<span class="ruby-value">110</span>,<span class="ruby-value">780</span>,<span class="ruby-value">78</span>,<span class="ruby-value">769</span>].<span class="ruby-identifier">pack</span>(<span class="ruby-value str">&quot;U*&quot;</span>), <span class="ruby-identifier">chars</span>(<span class="ruby-identifier">comp_str</span>).<span class="ruby-identifier">normalize</span>(<span class="ruby-identifier">:kd</span>).<span class="ruby-identifier">to_s</span>
521:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M004603" class="method">
  <div id="M004603_title" class="title">
    <b>test_tidy_bytes_is_broken_on_1_9_0</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M004603_source')" id="l_M004603_source">show source</a> ]</p>
  <div id="M004603_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activesupport/test/multibyte_chars_test.rb, line 454</span>
454:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_tidy_bytes_is_broken_on_1_9_0</span>
455:       <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ArgumentError</span>) <span class="ruby-keyword kw">do</span>
456:         <span class="ruby-identifier">assert_equal_codepoints</span> [<span class="ruby-value">0xfffd</span>].<span class="ruby-identifier">pack</span>(<span class="ruby-value str">'U'</span>), <span class="ruby-identifier">chars</span>(<span class="ruby-value str">&quot;\xef\xbf\xbd&quot;</span>).<span class="ruby-identifier">tidy_bytes</span>
457:       <span class="ruby-keyword kw">end</span>
458:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M004612" class="method">
  <div id="M004612_title" class="title">
    <b>test_tidy_bytes_should_tidy_bytes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M004612_source')" id="l_M004612_source">show source</a> ]</p>
  <div id="M004612_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activesupport/test/multibyte_chars_test.rb, line 554</span>
554:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_tidy_bytes_should_tidy_bytes</span>
555:     <span class="ruby-identifier">byte_string</span> = <span class="ruby-value str">&quot;\270\236\010\210\245&quot;</span>
556:     <span class="ruby-identifier">tidy_string</span> = [<span class="ruby-value">0xb8</span>, <span class="ruby-value">0x17e</span>, <span class="ruby-value">0x8</span>, <span class="ruby-value">0x2c6</span>, <span class="ruby-value">0xa5</span>].<span class="ruby-identifier">pack</span>(<span class="ruby-value str">'U*'</span>)
557:     <span class="ruby-identifier">ascii_padding</span> = <span class="ruby-value str">'aa'</span>
558:     <span class="ruby-identifier">utf8_padding</span> = <span class="ruby-value str">'éé'</span>
559: 
560:     <span class="ruby-identifier">assert_equal_codepoints</span> <span class="ruby-identifier">tidy_string</span>, <span class="ruby-identifier">chars</span>(<span class="ruby-identifier">byte_string</span>).<span class="ruby-identifier">tidy_bytes</span>
561: 
562:     <span class="ruby-identifier">assert_equal_codepoints</span> <span class="ruby-identifier">ascii_padding</span>.<span class="ruby-identifier">dup</span>.<span class="ruby-identifier">insert</span>(<span class="ruby-value">1</span>, <span class="ruby-identifier">tidy_string</span>),
563:       <span class="ruby-identifier">chars</span>(<span class="ruby-identifier">ascii_padding</span>.<span class="ruby-identifier">dup</span>.<span class="ruby-identifier">insert</span>(<span class="ruby-value">1</span>, <span class="ruby-identifier">byte_string</span>)).<span class="ruby-identifier">tidy_bytes</span>
564:     <span class="ruby-identifier">assert_equal_codepoints</span> <span class="ruby-identifier">utf8_padding</span>.<span class="ruby-identifier">dup</span>.<span class="ruby-identifier">insert</span>(<span class="ruby-value">2</span>, <span class="ruby-identifier">tidy_string</span>),
565:       <span class="ruby-identifier">chars</span>(<span class="ruby-identifier">utf8_padding</span>.<span class="ruby-identifier">dup</span>.<span class="ruby-identifier">insert</span>(<span class="ruby-value">2</span>, <span class="ruby-identifier">byte_string</span>)).<span class="ruby-identifier">tidy_bytes</span>
566:     <span class="ruby-identifier">assert_nothing_raised</span> { <span class="ruby-identifier">chars</span>(<span class="ruby-identifier">byte_string</span>).<span class="ruby-identifier">tidy_bytes</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">unpack</span>(<span class="ruby-value str">'U*'</span>) }
567: 
568:     <span class="ruby-identifier">assert_equal_codepoints</span> <span class="ruby-value str">&quot;\xC3\xA7&quot;</span>, <span class="ruby-identifier">chars</span>(<span class="ruby-value str">&quot;\xE7&quot;</span>).<span class="ruby-identifier">tidy_bytes</span> <span class="ruby-comment cmt"># iso_8859_1: small c cedilla</span>
569:     <span class="ruby-identifier">assert_equal_codepoints</span> <span class="ruby-value str">&quot;\xE2\x80\x9C&quot;</span>, <span class="ruby-identifier">chars</span>(<span class="ruby-value str">&quot;\x93&quot;</span>).<span class="ruby-identifier">tidy_bytes</span> <span class="ruby-comment cmt"># win_1252: left smart quote</span>
570:     <span class="ruby-identifier">assert_equal_codepoints</span> <span class="ruby-value str">&quot;\xE2\x82\xAC&quot;</span>, <span class="ruby-identifier">chars</span>(<span class="ruby-value str">&quot;\x80&quot;</span>).<span class="ruby-identifier">tidy_bytes</span> <span class="ruby-comment cmt"># win_1252: euro</span>
571:     <span class="ruby-identifier">assert_equal_codepoints</span> <span class="ruby-value str">&quot;\x00&quot;</span>, <span class="ruby-identifier">chars</span>(<span class="ruby-value str">&quot;\x00&quot;</span>).<span class="ruby-identifier">tidy_bytes</span> <span class="ruby-comment cmt"># null char</span>
572:     <span class="ruby-identifier">assert_equal_codepoints</span> [<span class="ruby-value">0xfffd</span>].<span class="ruby-identifier">pack</span>(<span class="ruby-value str">'U'</span>), <span class="ruby-identifier">chars</span>(<span class="ruby-value str">&quot;\xef\xbf\xbd&quot;</span>).<span class="ruby-identifier">tidy_bytes</span> <span class="ruby-comment cmt"># invalid char</span>
573:   <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">ArgumentError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
574:     <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span> <span class="ruby-keyword kw">if</span> <span class="ruby-constant">RUBY_VERSION</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value str">'1.9'</span>
575:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M004604" class="method">
  <div id="M004604_title" class="title">
    <b>test_upcase_should_be_unicode_aware</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M004604_source')" id="l_M004604_source">show source</a> ]</p>
  <div id="M004604_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activesupport/test/multibyte_chars_test.rb, line 461</span>
461:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_upcase_should_be_unicode_aware</span>
462:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;АБВГД\0F&quot;</span>, <span class="ruby-identifier">chars</span>(<span class="ruby-value str">&quot;аБвгд\0f&quot;</span>).<span class="ruby-identifier">upcase</span>
463:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'こにちわ'</span>, <span class="ruby-identifier">chars</span>(<span class="ruby-value str">'こにちわ'</span>).<span class="ruby-identifier">upcase</span>
464:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
</div>

  </div>