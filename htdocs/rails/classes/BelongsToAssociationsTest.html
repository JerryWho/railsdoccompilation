  <div id="C00000464">
<div class='banner'>
  <span class="file-title-prefix">Class</span><br />BelongsToAssociationsTest<br/>
  In:
<a href="#" onclick="jsHref('files/activerecord/test/cases/associations/belongs_to_associations_test_rb.html');">activerecord/test/cases/associations/belongs_to_associations_test.rb</a>

Parent:&nbsp;
ActiveRecord::TestCase
</div>
 <!-- banner header -->

  <div id="bodyContent" >
      <div id="content">




  <div class="sectiontitle">Methods</div>
  <ul>
  <li><a href="index.html?a=M002795&name=test_assignment_before_child_saved" >test_assignment_before_child_saved</a></li>
  <li><a href="index.html?a=M002796&name=test_assignment_before_child_saved_with_primary_key" >test_assignment_before_child_saved_with_primary_key</a></li>
  <li><a href="index.html?a=M002802&name=test_association_assignment_sticks" >test_association_assignment_sticks</a></li>
  <li><a href="index.html?a=M002770&name=test_belongs_to" >test_belongs_to</a></li>
  <li><a href="index.html?a=M002787&name=test_belongs_to_counter" >test_belongs_to_counter</a></li>
  <li><a href="index.html?a=M002793&name=test_belongs_to_counter_after_save" >test_belongs_to_counter_after_save</a></li>
  <li><a href="index.html?a=M002794&name=test_belongs_to_counter_after_update_attributes" >test_belongs_to_counter_after_update_attributes</a></li>
  <li><a href="index.html?a=M002789&name=test_belongs_to_counter_with_assigning_nil" >test_belongs_to_counter_with_assigning_nil</a></li>
  <li><a href="index.html?a=M002791&name=test_belongs_to_counter_with_reassigning" >test_belongs_to_counter_with_reassigning</a></li>
  <li><a href="index.html?a=M002808&name=test_belongs_to_proxy_should_not_respond_to_private_methods" >test_belongs_to_proxy_should_not_respond_to_private_methods</a></li>
  <li><a href="index.html?a=M002809&name=test_belongs_to_proxy_should_respond_to_private_methods_via_send" >test_belongs_to_proxy_should_respond_to_private_methods_via_send</a></li>
  <li><a href="index.html?a=M002792&name=test_belongs_to_reassign_with_namespaced_models_and_counters" >test_belongs_to_reassign_with_namespaced_models_and_counters</a></li>
  <li><a href="index.html?a=M002771&name=test_belongs_to_with_primary_key" >test_belongs_to_with_primary_key</a></li>
  <li><a href="index.html?a=M002788&name=test_belongs_to_with_primary_key_counter" >test_belongs_to_with_primary_key_counter</a></li>
  <li><a href="index.html?a=M002790&name=test_belongs_to_with_primary_key_counter_with_assigning_nil" >test_belongs_to_with_primary_key_counter_with_assigning_nil</a></li>
  <li><a href="index.html?a=M002780&name=test_building_the_belonging_object" >test_building_the_belonging_object</a></li>
  <li><a href="index.html?a=M002781&name=test_building_the_belonging_object_with_primary_key" >test_building_the_belonging_object_with_primary_key</a></li>
  <li><a href="index.html?a=M002803&name=test_cant_save_readonly_association" >test_cant_save_readonly_association</a></li>
  <li><a href="index.html?a=M002800&name=test_counter_cache" >test_counter_cache</a></li>
  <li><a href="index.html?a=M002778&name=test_creating_the_belonging_object" >test_creating_the_belonging_object</a></li>
  <li><a href="index.html?a=M002779&name=test_creating_the_belonging_object_with_primary_key" >test_creating_the_belonging_object_with_primary_key</a></li>
  <li><a href="index.html?a=M002801&name=test_custom_counter_cache" >test_custom_counter_cache</a></li>
  <li><a href="index.html?a=M002799&name=test_field_name_same_as_foreign_key" >test_field_name_same_as_foreign_key</a></li>
  <li><a href="index.html?a=M002798&name=test_forgetting_the_load_when_foreign_key_enters_late" >test_forgetting_the_load_when_foreign_key_enters_late</a></li>
  <li><a href="index.html?a=M002775&name=test_natural_assignment" >test_natural_assignment</a></li>
  <li><a href="index.html?a=M002782&name=test_natural_assignment_to_nil" >test_natural_assignment_to_nil</a></li>
  <li><a href="index.html?a=M002783&name=test_natural_assignment_to_nil_with_primary_key" >test_natural_assignment_to_nil_with_primary_key</a></li>
  <li><a href="index.html?a=M002776&name=test_natural_assignment_with_primary_key" >test_natural_assignment_with_primary_key</a></li>
  <li><a href="index.html?a=M002797&name=test_new_record_with_foreign_key_but_no_object" >test_new_record_with_foreign_key_but_no_object</a></li>
  <li><a href="index.html?a=M002777&name=test_no_unexpected_aliasing" >test_no_unexpected_aliasing</a></li>
  <li><a href="index.html?a=M002804&name=test_polymorphic_assignment_foreign_type_field_updating" >test_polymorphic_assignment_foreign_type_field_updating</a></li>
  <li><a href="index.html?a=M002806&name=test_polymorphic_assignment_updates_foreign_id_field_for_new_and_saved_records" >test_polymorphic_assignment_updates_foreign_id_field_for_new_and_saved_records</a></li>
  <li><a href="index.html?a=M002805&name=test_polymorphic_assignment_with_primary_key_foreign_type_field_updating" >test_polymorphic_assignment_with_primary_key_foreign_type_field_updating</a></li>
  <li><a href="index.html?a=M002807&name=test_polymorphic_assignment_with_primary_key_updates_foreign_id_field_for_new_and_saved_records" >test_polymorphic_assignment_with_primary_key_updates_foreign_id_field_for_new_and_saved_records</a></li>
  <li><a href="index.html?a=M002772&name=test_proxy_assignment" >test_proxy_assignment</a></li>
  <li><a href="index.html?a=M002810&name=test_save_of_record_with_loaded_belongs_to" >test_save_of_record_with_loaded_belongs_to</a></li>
  <li><a href="index.html?a=M002773&name=test_triple_equality" >test_triple_equality</a></li>
  <li><a href="index.html?a=M002774&name=test_type_mismatch" >test_type_mismatch</a></li>
  <li><a href="index.html?a=M002785&name=test_with_condition" >test_with_condition</a></li>
  <li><a href="index.html?a=M002784&name=test_with_different_class_name" >test_with_different_class_name</a></li>
  <li><a href="index.html?a=M002786&name=test_with_select" >test_with_select</a></li>
  </ul>






<div class="sectiontitle">Public Instance methods</div>
<div id="M002795" class="method">
  <div id="M002795_title" class="title">
    <b>test_assignment_before_child_saved</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002795_source')" id="l_M002795_source">show source</a> ]</p>
  <div id="M002795_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 252</span>
252:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_assignment_before_child_saved</span>
253:     <span class="ruby-identifier">final_cut</span> = <span class="ruby-constant">Client</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Final Cut&quot;</span>)
254:     <span class="ruby-identifier">firm</span> = <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">1</span>)
255:     <span class="ruby-identifier">final_cut</span>.<span class="ruby-identifier">firm</span> = <span class="ruby-identifier">firm</span>
256:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">final_cut</span>.<span class="ruby-identifier">new_record?</span>
257:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">final_cut</span>.<span class="ruby-identifier">save</span>
258:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">final_cut</span>.<span class="ruby-identifier">new_record?</span>
259:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">firm</span>.<span class="ruby-identifier">new_record?</span>
260:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">firm</span>, <span class="ruby-identifier">final_cut</span>.<span class="ruby-identifier">firm</span>
261:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">firm</span>, <span class="ruby-identifier">final_cut</span>.<span class="ruby-identifier">firm</span>(<span class="ruby-keyword kw">true</span>)
262:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002796" class="method">
  <div id="M002796_title" class="title">
    <b>test_assignment_before_child_saved_with_primary_key</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002796_source')" id="l_M002796_source">show source</a> ]</p>
  <div id="M002796_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 264</span>
264:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_assignment_before_child_saved_with_primary_key</span>
265:     <span class="ruby-identifier">final_cut</span> = <span class="ruby-constant">Client</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Final Cut&quot;</span>)
266:     <span class="ruby-identifier">firm</span> = <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">1</span>)
267:     <span class="ruby-identifier">final_cut</span>.<span class="ruby-identifier">firm_with_primary_key</span> = <span class="ruby-identifier">firm</span>
268:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">final_cut</span>.<span class="ruby-identifier">new_record?</span>
269:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">final_cut</span>.<span class="ruby-identifier">save</span>
270:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">final_cut</span>.<span class="ruby-identifier">new_record?</span>
271:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">firm</span>.<span class="ruby-identifier">new_record?</span>
272:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">firm</span>, <span class="ruby-identifier">final_cut</span>.<span class="ruby-identifier">firm_with_primary_key</span>
273:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">firm</span>, <span class="ruby-identifier">final_cut</span>.<span class="ruby-identifier">firm_with_primary_key</span>(<span class="ruby-keyword kw">true</span>)
274:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002802" class="method">
  <div id="M002802_title" class="title">
    <b>test_association_assignment_sticks</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002802_source')" id="l_M002802_source">show source</a> ]</p>
  <div id="M002802_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 322</span>
322:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_association_assignment_sticks</span>
323:     <span class="ruby-identifier">post</span> = <span class="ruby-constant">Post</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>)
324: 
325:     <span class="ruby-identifier">author1</span>, <span class="ruby-identifier">author2</span> = <span class="ruby-constant">Author</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>, <span class="ruby-identifier">:limit</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">2</span>)
326:     <span class="ruby-identifier">assert_not_nil</span> <span class="ruby-identifier">author1</span>
327:     <span class="ruby-identifier">assert_not_nil</span> <span class="ruby-identifier">author2</span>
328: 
329:     <span class="ruby-comment cmt"># make sure the association is loaded</span>
330:     <span class="ruby-identifier">post</span>.<span class="ruby-identifier">author</span>
331: 
332:     <span class="ruby-comment cmt"># set the association by id, directly</span>
333:     <span class="ruby-identifier">post</span>.<span class="ruby-identifier">author_id</span> = <span class="ruby-identifier">author2</span>.<span class="ruby-identifier">id</span>
334: 
335:     <span class="ruby-comment cmt"># save and reload</span>
336:     <span class="ruby-identifier">post</span>.<span class="ruby-identifier">save!</span>
337:     <span class="ruby-identifier">post</span>.<span class="ruby-identifier">reload</span>
338: 
339:     <span class="ruby-comment cmt"># the author id of the post should be the id we set</span>
340:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">post</span>.<span class="ruby-identifier">author_id</span>, <span class="ruby-identifier">author2</span>.<span class="ruby-identifier">id</span>
341:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002770" class="method">
  <div id="M002770_title" class="title">
    <b>test_belongs_to</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002770_source')" id="l_M002770_source">show source</a> ]</p>
  <div id="M002770_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 23</span>
23:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_belongs_to</span>
24:     <span class="ruby-constant">Client</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">3</span>).<span class="ruby-identifier">firm</span>.<span class="ruby-identifier">name</span>
25:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">name</span>, <span class="ruby-constant">Client</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">3</span>).<span class="ruby-identifier">firm</span>.<span class="ruby-identifier">name</span>
26:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-constant">Client</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">3</span>).<span class="ruby-identifier">firm</span>.<span class="ruby-identifier">nil?</span>, <span class="ruby-value str">&quot;Microsoft should have a firm&quot;</span>
27:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002787" class="method">
  <div id="M002787_title" class="title">
    <b>test_belongs_to_counter</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002787_source')" id="l_M002787_source">show source</a> ]</p>
  <div id="M002787_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 139</span>
139:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_belongs_to_counter</span>
140:     <span class="ruby-identifier">debate</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;debate&quot;</span>)
141:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-identifier">debate</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:read_attribute</span>, <span class="ruby-value str">&quot;replies_count&quot;</span>), <span class="ruby-value str">&quot;No replies yet&quot;</span>
142: 
143:     <span class="ruby-identifier">trash</span> = <span class="ruby-identifier">debate</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;blah!&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;world around!&quot;</span>)
144:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">debate</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:read_attribute</span>, <span class="ruby-value str">&quot;replies_count&quot;</span>), <span class="ruby-value str">&quot;First reply created&quot;</span>
145: 
146:     <span class="ruby-identifier">trash</span>.<span class="ruby-identifier">destroy</span>
147:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">debate</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:read_attribute</span>, <span class="ruby-value str">&quot;replies_count&quot;</span>), <span class="ruby-value str">&quot;First reply deleted&quot;</span>
148:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002793" class="method">
  <div id="M002793_title" class="title">
    <b>test_belongs_to_counter_after_save</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002793_source')" id="l_M002793_source">show source</a> ]</p>
  <div id="M002793_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 234</span>
234:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_belongs_to_counter_after_save</span>
235:     <span class="ruby-identifier">topic</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;monday night&quot;</span>)
236:     <span class="ruby-identifier">topic</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;re: monday night&quot;</span>, <span class="ruby-identifier">:content</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;football&quot;</span>)
237:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">topic</span>.<span class="ruby-identifier">id</span>)[<span class="ruby-identifier">:replies_count</span>]
238: 
239:     <span class="ruby-identifier">topic</span>.<span class="ruby-identifier">save!</span>
240:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">topic</span>.<span class="ruby-identifier">id</span>)[<span class="ruby-identifier">:replies_count</span>]
241:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002794" class="method">
  <div id="M002794_title" class="title">
    <b>test_belongs_to_counter_after_update_attributes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002794_source')" id="l_M002794_source">show source</a> ]</p>
  <div id="M002794_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 243</span>
243:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_belongs_to_counter_after_update_attributes</span>
244:     <span class="ruby-identifier">topic</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;37s&quot;</span>)
245:     <span class="ruby-identifier">topic</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;re: 37s&quot;</span>, <span class="ruby-identifier">:content</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;rails&quot;</span>)
246:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">topic</span>.<span class="ruby-identifier">id</span>)[<span class="ruby-identifier">:replies_count</span>]
247: 
248:     <span class="ruby-identifier">topic</span>.<span class="ruby-identifier">update_attributes</span>(<span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;37signals&quot;</span>)
249:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">topic</span>.<span class="ruby-identifier">id</span>)[<span class="ruby-identifier">:replies_count</span>]
250:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002789" class="method">
  <div id="M002789_title" class="title">
    <b>test_belongs_to_counter_with_assigning_nil</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002789_source')" id="l_M002789_source">show source</a> ]</p>
  <div id="M002789_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 161</span>
161:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_belongs_to_counter_with_assigning_nil</span>
162:     <span class="ruby-identifier">p</span> = <span class="ruby-constant">Post</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">1</span>)
163:     <span class="ruby-identifier">c</span> = <span class="ruby-constant">Comment</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">1</span>)
164: 
165:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">p</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">c</span>.<span class="ruby-identifier">post_id</span>
166:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-constant">Post</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">p</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">comments</span>.<span class="ruby-identifier">size</span>
167: 
168:     <span class="ruby-identifier">c</span>.<span class="ruby-identifier">post</span> = <span class="ruby-keyword kw">nil</span>
169: 
170:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-constant">Post</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">p</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">comments</span>.<span class="ruby-identifier">size</span>
171:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002791" class="method">
  <div id="M002791_title" class="title">
    <b>test_belongs_to_counter_with_reassigning</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002791_source')" id="l_M002791_source">show source</a> ]</p>
  <div id="M002791_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 185</span>
185:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_belongs_to_counter_with_reassigning</span>
186:     <span class="ruby-identifier">t1</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;t1&quot;</span>)
187:     <span class="ruby-identifier">t2</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;t2&quot;</span>)
188:     <span class="ruby-identifier">r1</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;r1&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;r1&quot;</span>)
189:     <span class="ruby-identifier">r1</span>.<span class="ruby-identifier">topic</span> = <span class="ruby-identifier">t1</span>
190: 
191:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r1</span>.<span class="ruby-identifier">save</span>
192:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">t1</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">size</span>
193:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">t2</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">size</span>
194: 
195:     <span class="ruby-identifier">r1</span>.<span class="ruby-identifier">topic</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">t2</span>.<span class="ruby-identifier">id</span>)
196: 
197:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r1</span>.<span class="ruby-identifier">save</span>
198:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">t1</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">size</span>
199:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">t2</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">size</span>
200: 
201:     <span class="ruby-identifier">r1</span>.<span class="ruby-identifier">topic</span> = <span class="ruby-keyword kw">nil</span>
202: 
203:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">t1</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">size</span>
204:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">t2</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">size</span>
205: 
206:     <span class="ruby-identifier">r1</span>.<span class="ruby-identifier">topic</span> = <span class="ruby-identifier">t1</span>
207: 
208:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">t1</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">size</span>
209:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">t2</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">size</span>
210: 
211:     <span class="ruby-identifier">r1</span>.<span class="ruby-identifier">destroy</span>
212: 
213:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">t1</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">size</span>
214:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">t2</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">size</span>
215:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002808" class="method">
  <div id="M002808_title" class="title">
    <b>test_belongs_to_proxy_should_not_respond_to_private_methods</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002808_source')" id="l_M002808_source">show source</a> ]</p>
  <div id="M002808_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 400</span>
400:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_belongs_to_proxy_should_not_respond_to_private_methods</span>
401:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">NoMethodError</span>) { <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">private_method</span> }
402:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">NoMethodError</span>) { <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:second_client</span>).<span class="ruby-identifier">firm</span>.<span class="ruby-identifier">private_method</span> }
403:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002809" class="method">
  <div id="M002809_title" class="title">
    <b>test_belongs_to_proxy_should_respond_to_private_methods_via_send</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002809_source')" id="l_M002809_source">show source</a> ]</p>
  <div id="M002809_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 405</span>
405:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_belongs_to_proxy_should_respond_to_private_methods_via_send</span>
406:     <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:private_method</span>)
407:     <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:second_client</span>).<span class="ruby-identifier">firm</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:private_method</span>)
408:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002792" class="method">
  <div id="M002792_title" class="title">
    <b>test_belongs_to_reassign_with_namespaced_models_and_counters</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002792_source')" id="l_M002792_source">show source</a> ]</p>
  <div id="M002792_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 217</span>
217:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_belongs_to_reassign_with_namespaced_models_and_counters</span>
218:     <span class="ruby-identifier">t1</span> = <span class="ruby-constant">Web</span><span class="ruby-operator">::</span><span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;t1&quot;</span>)
219:     <span class="ruby-identifier">t2</span> = <span class="ruby-constant">Web</span><span class="ruby-operator">::</span><span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;t2&quot;</span>)
220:     <span class="ruby-identifier">r1</span> = <span class="ruby-constant">Web</span><span class="ruby-operator">::</span><span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;r1&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;r1&quot;</span>)
221:     <span class="ruby-identifier">r1</span>.<span class="ruby-identifier">topic</span> = <span class="ruby-identifier">t1</span>
222: 
223:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r1</span>.<span class="ruby-identifier">save</span>
224:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-constant">Web</span><span class="ruby-operator">::</span><span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">t1</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">size</span>
225:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-constant">Web</span><span class="ruby-operator">::</span><span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">t2</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">size</span>
226: 
227:     <span class="ruby-identifier">r1</span>.<span class="ruby-identifier">topic</span> = <span class="ruby-constant">Web</span><span class="ruby-operator">::</span><span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">t2</span>.<span class="ruby-identifier">id</span>)
228: 
229:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r1</span>.<span class="ruby-identifier">save</span>
230:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-constant">Web</span><span class="ruby-operator">::</span><span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">t1</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">size</span>
231:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-constant">Web</span><span class="ruby-operator">::</span><span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">t2</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">size</span>
232:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002771" class="method">
  <div id="M002771_title" class="title">
    <b>test_belongs_to_with_primary_key</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002771_source')" id="l_M002771_source">show source</a> ]</p>
  <div id="M002771_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 29</span>
29:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_belongs_to_with_primary_key</span>
30:     <span class="ruby-identifier">client</span> = <span class="ruby-constant">Client</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Primary key client&quot;</span>, <span class="ruby-identifier">:firm_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">name</span>)
31:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">name</span>, <span class="ruby-identifier">client</span>.<span class="ruby-identifier">firm_with_primary_key</span>.<span class="ruby-identifier">name</span>
32:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002788" class="method">
  <div id="M002788_title" class="title">
    <b>test_belongs_to_with_primary_key_counter</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002788_source')" id="l_M002788_source">show source</a> ]</p>
  <div id="M002788_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 150</span>
150:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_belongs_to_with_primary_key_counter</span>
151:     <span class="ruby-identifier">debate</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;debate&quot;</span>)
152:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-identifier">debate</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:read_attribute</span>, <span class="ruby-value str">&quot;replies_count&quot;</span>), <span class="ruby-value str">&quot;No replies yet&quot;</span>
153: 
154:     <span class="ruby-identifier">trash</span> = <span class="ruby-identifier">debate</span>.<span class="ruby-identifier">replies_with_primary_key</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;blah!&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;world around!&quot;</span>)
155:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">debate</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:read_attribute</span>, <span class="ruby-value str">&quot;replies_count&quot;</span>), <span class="ruby-value str">&quot;First reply created&quot;</span>
156: 
157:     <span class="ruby-identifier">trash</span>.<span class="ruby-identifier">destroy</span>
158:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">debate</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:read_attribute</span>, <span class="ruby-value str">&quot;replies_count&quot;</span>), <span class="ruby-value str">&quot;First reply deleted&quot;</span>
159:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002790" class="method">
  <div id="M002790_title" class="title">
    <b>test_belongs_to_with_primary_key_counter_with_assigning_nil</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002790_source')" id="l_M002790_source">show source</a> ]</p>
  <div id="M002790_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 173</span>
173:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_belongs_to_with_primary_key_counter_with_assigning_nil</span>
174:     <span class="ruby-identifier">debate</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;debate&quot;</span>)
175:     <span class="ruby-identifier">reply</span>  = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;blah!&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;world around!&quot;</span>, <span class="ruby-value str">&quot;parent_title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;debate&quot;</span>)
176: 
177:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">debate</span>.<span class="ruby-identifier">title</span>, <span class="ruby-identifier">reply</span>.<span class="ruby-identifier">parent_title</span>
178:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">debate</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:read_attribute</span>, <span class="ruby-value str">&quot;replies_count&quot;</span>)
179: 
180:     <span class="ruby-identifier">reply</span>.<span class="ruby-identifier">topic_with_primary_key</span> = <span class="ruby-keyword kw">nil</span>
181: 
182:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">debate</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:read_attribute</span>, <span class="ruby-value str">&quot;replies_count&quot;</span>)
183:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002780" class="method">
  <div id="M002780_title" class="title">
    <b>test_building_the_belonging_object</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002780_source')" id="l_M002780_source">show source</a> ]</p>
  <div id="M002780_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 94</span>
94:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_building_the_belonging_object</span>
95:     <span class="ruby-identifier">citibank</span> = <span class="ruby-constant">Account</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;credit_limit&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">10</span>)
96:     <span class="ruby-identifier">apple</span>    = <span class="ruby-identifier">citibank</span>.<span class="ruby-identifier">build_firm</span>(<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Apple&quot;</span>)
97:     <span class="ruby-identifier">citibank</span>.<span class="ruby-identifier">save</span>
98:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">apple</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">citibank</span>.<span class="ruby-identifier">firm_id</span>
99:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002781" class="method">
  <div id="M002781_title" class="title">
    <b>test_building_the_belonging_object_with_primary_key</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002781_source')" id="l_M002781_source">show source</a> ]</p>
  <div id="M002781_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 101</span>
101:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_building_the_belonging_object_with_primary_key</span>
102:     <span class="ruby-identifier">client</span> = <span class="ruby-constant">Client</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Primary key client&quot;</span>)
103:     <span class="ruby-identifier">apple</span>  = <span class="ruby-identifier">client</span>.<span class="ruby-identifier">build_firm_with_primary_key</span>(<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Apple&quot;</span>)
104:     <span class="ruby-identifier">client</span>.<span class="ruby-identifier">save</span>
105:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">apple</span>.<span class="ruby-identifier">name</span>, <span class="ruby-identifier">client</span>.<span class="ruby-identifier">firm_name</span>
106:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002803" class="method">
  <div id="M002803_title" class="title">
    <b>test_cant_save_readonly_association</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002803_source')" id="l_M002803_source">show source</a> ]</p>
  <div id="M002803_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 343</span>
343:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_cant_save_readonly_association</span>
344:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">ReadOnlyRecord</span>) { <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_client</span>).<span class="ruby-identifier">readonly_firm</span>.<span class="ruby-identifier">save!</span> }
345:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_client</span>).<span class="ruby-identifier">readonly_firm</span>.<span class="ruby-identifier">readonly?</span>
346:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002800" class="method">
  <div id="M002800_title" class="title">
    <b>test_counter_cache</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002800_source')" id="l_M002800_source">show source</a> ]</p>
  <div id="M002800_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 294</span>
294:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_counter_cache</span>
295:     <span class="ruby-identifier">topic</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span> <span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Zoom-zoom-zoom&quot;</span>
296:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-identifier">topic</span>[<span class="ruby-identifier">:replies_count</span>]
297: 
298:     <span class="ruby-identifier">reply</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;re: zoom&quot;</span>, <span class="ruby-identifier">:content</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;speedy quick!&quot;</span>)
299:     <span class="ruby-identifier">reply</span>.<span class="ruby-identifier">topic</span> = <span class="ruby-identifier">topic</span>
300: 
301:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">topic</span>.<span class="ruby-identifier">reload</span>[<span class="ruby-identifier">:replies_count</span>]
302:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">topic</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">size</span>
303: 
304:     <span class="ruby-identifier">topic</span>[<span class="ruby-identifier">:replies_count</span>] = <span class="ruby-value">15</span>
305:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">15</span>, <span class="ruby-identifier">topic</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">size</span>
306:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002778" class="method">
  <div id="M002778_title" class="title">
    <b>test_creating_the_belonging_object</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002778_source')" id="l_M002778_source">show source</a> ]</p>
  <div id="M002778_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 76</span>
76:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_creating_the_belonging_object</span>
77:     <span class="ruby-identifier">citibank</span> = <span class="ruby-constant">Account</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;credit_limit&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">10</span>)
78:     <span class="ruby-identifier">apple</span>    = <span class="ruby-identifier">citibank</span>.<span class="ruby-identifier">create_firm</span>(<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Apple&quot;</span>)
79:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">apple</span>, <span class="ruby-identifier">citibank</span>.<span class="ruby-identifier">firm</span>
80:     <span class="ruby-identifier">citibank</span>.<span class="ruby-identifier">save</span>
81:     <span class="ruby-identifier">citibank</span>.<span class="ruby-identifier">reload</span>
82:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">apple</span>, <span class="ruby-identifier">citibank</span>.<span class="ruby-identifier">firm</span>
83:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002779" class="method">
  <div id="M002779_title" class="title">
    <b>test_creating_the_belonging_object_with_primary_key</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002779_source')" id="l_M002779_source">show source</a> ]</p>
  <div id="M002779_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 85</span>
85:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_creating_the_belonging_object_with_primary_key</span>
86:     <span class="ruby-identifier">client</span> = <span class="ruby-constant">Client</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Primary key client&quot;</span>)
87:     <span class="ruby-identifier">apple</span>  = <span class="ruby-identifier">client</span>.<span class="ruby-identifier">create_firm_with_primary_key</span>(<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Apple&quot;</span>)
88:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">apple</span>, <span class="ruby-identifier">client</span>.<span class="ruby-identifier">firm_with_primary_key</span>
89:     <span class="ruby-identifier">client</span>.<span class="ruby-identifier">save</span>
90:     <span class="ruby-identifier">client</span>.<span class="ruby-identifier">reload</span>
91:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">apple</span>, <span class="ruby-identifier">client</span>.<span class="ruby-identifier">firm_with_primary_key</span>
92:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002801" class="method">
  <div id="M002801_title" class="title">
    <b>test_custom_counter_cache</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002801_source')" id="l_M002801_source">show source</a> ]</p>
  <div id="M002801_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 308</span>
308:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_custom_counter_cache</span>
309:     <span class="ruby-identifier">reply</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;re: zoom&quot;</span>, <span class="ruby-identifier">:content</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;speedy quick!&quot;</span>)
310:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-identifier">reply</span>[<span class="ruby-identifier">:replies_count</span>]
311: 
312:     <span class="ruby-identifier">silly</span> = <span class="ruby-constant">SillyReply</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;gaga&quot;</span>, <span class="ruby-identifier">:content</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;boo-boo&quot;</span>)
313:     <span class="ruby-identifier">silly</span>.<span class="ruby-identifier">reply</span> = <span class="ruby-identifier">reply</span>
314: 
315:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">reply</span>.<span class="ruby-identifier">reload</span>[<span class="ruby-identifier">:replies_count</span>]
316:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">reply</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">size</span>
317: 
318:     <span class="ruby-identifier">reply</span>[<span class="ruby-identifier">:replies_count</span>] = <span class="ruby-value">17</span>
319:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">17</span>, <span class="ruby-identifier">reply</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">size</span>
320:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002799" class="method">
  <div id="M002799_title" class="title">
    <b>test_field_name_same_as_foreign_key</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002799_source')" id="l_M002799_source">show source</a> ]</p>
  <div id="M002799_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 289</span>
289:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_field_name_same_as_foreign_key</span>
290:     <span class="ruby-identifier">computer</span> = <span class="ruby-constant">Computer</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">1</span>)
291:     <span class="ruby-identifier">assert_not_nil</span> <span class="ruby-identifier">computer</span>.<span class="ruby-identifier">developer</span>, <span class="ruby-value str">&quot;:foreign key == attribute didn't lock up&quot;</span> <span class="ruby-comment cmt"># '</span>
292:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002798" class="method">
  <div id="M002798_title" class="title">
    <b>test_forgetting_the_load_when_foreign_key_enters_late</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002798_source')" id="l_M002798_source">show source</a> ]</p>
  <div id="M002798_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 281</span>
281:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_forgetting_the_load_when_foreign_key_enters_late</span>
282:     <span class="ruby-identifier">c</span> = <span class="ruby-constant">Client</span>.<span class="ruby-identifier">new</span>
283:     <span class="ruby-identifier">assert_nil</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">firm_with_basic_id</span>
284: 
285:     <span class="ruby-identifier">c</span>.<span class="ruby-identifier">firm_id</span> = <span class="ruby-value">1</span>
286:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>), <span class="ruby-identifier">c</span>.<span class="ruby-identifier">firm_with_basic_id</span>
287:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002775" class="method">
  <div id="M002775_title" class="title">
    <b>test_natural_assignment</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002775_source')" id="l_M002775_source">show source</a> ]</p>
  <div id="M002775_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 49</span>
49:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_natural_assignment</span>
50:     <span class="ruby-identifier">apple</span> = <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Apple&quot;</span>)
51:     <span class="ruby-identifier">citibank</span> = <span class="ruby-constant">Account</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;credit_limit&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">10</span>)
52:     <span class="ruby-identifier">citibank</span>.<span class="ruby-identifier">firm</span> = <span class="ruby-identifier">apple</span>
53:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">apple</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">citibank</span>.<span class="ruby-identifier">firm_id</span>
54:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002782" class="method">
  <div id="M002782_title" class="title">
    <b>test_natural_assignment_to_nil</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002782_source')" id="l_M002782_source">show source</a> ]</p>
  <div id="M002782_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 108</span>
108:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_natural_assignment_to_nil</span>
109:     <span class="ruby-identifier">client</span> = <span class="ruby-constant">Client</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">3</span>)
110:     <span class="ruby-identifier">client</span>.<span class="ruby-identifier">firm</span> = <span class="ruby-keyword kw">nil</span>
111:     <span class="ruby-identifier">client</span>.<span class="ruby-identifier">save</span>
112:     <span class="ruby-identifier">assert_nil</span> <span class="ruby-identifier">client</span>.<span class="ruby-identifier">firm</span>(<span class="ruby-keyword kw">true</span>)
113:     <span class="ruby-identifier">assert_nil</span> <span class="ruby-identifier">client</span>.<span class="ruby-identifier">client_of</span>
114:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002783" class="method">
  <div id="M002783_title" class="title">
    <b>test_natural_assignment_to_nil_with_primary_key</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002783_source')" id="l_M002783_source">show source</a> ]</p>
  <div id="M002783_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 116</span>
116:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_natural_assignment_to_nil_with_primary_key</span>
117:     <span class="ruby-identifier">client</span> = <span class="ruby-constant">Client</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Primary key client&quot;</span>, <span class="ruby-identifier">:firm_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">name</span>)
118:     <span class="ruby-identifier">client</span>.<span class="ruby-identifier">firm_with_primary_key</span> = <span class="ruby-keyword kw">nil</span>
119:     <span class="ruby-identifier">client</span>.<span class="ruby-identifier">save</span>
120:     <span class="ruby-identifier">assert_nil</span> <span class="ruby-identifier">client</span>.<span class="ruby-identifier">firm_with_primary_key</span>(<span class="ruby-keyword kw">true</span>)
121:     <span class="ruby-identifier">assert_nil</span> <span class="ruby-identifier">client</span>.<span class="ruby-identifier">client_of</span>
122:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002776" class="method">
  <div id="M002776_title" class="title">
    <b>test_natural_assignment_with_primary_key</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002776_source')" id="l_M002776_source">show source</a> ]</p>
  <div id="M002776_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 56</span>
56:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_natural_assignment_with_primary_key</span>
57:     <span class="ruby-identifier">apple</span> = <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Apple&quot;</span>)
58:     <span class="ruby-identifier">citibank</span> = <span class="ruby-constant">Client</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Primary key client&quot;</span>)
59:     <span class="ruby-identifier">citibank</span>.<span class="ruby-identifier">firm_with_primary_key</span> = <span class="ruby-identifier">apple</span>
60:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">apple</span>.<span class="ruby-identifier">name</span>, <span class="ruby-identifier">citibank</span>.<span class="ruby-identifier">firm_name</span>
61:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002797" class="method">
  <div id="M002797_title" class="title">
    <b>test_new_record_with_foreign_key_but_no_object</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002797_source')" id="l_M002797_source">show source</a> ]</p>
  <div id="M002797_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 276</span>
276:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_new_record_with_foreign_key_but_no_object</span>
277:     <span class="ruby-identifier">c</span> = <span class="ruby-constant">Client</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;firm_id&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>)
278:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>), <span class="ruby-identifier">c</span>.<span class="ruby-identifier">firm_with_basic_id</span>
279:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002777" class="method">
  <div id="M002777_title" class="title">
    <b>test_no_unexpected_aliasing</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002777_source')" id="l_M002777_source">show source</a> ]</p>
  <div id="M002777_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 63</span>
63:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_no_unexpected_aliasing</span>
64:     <span class="ruby-identifier">first_firm</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>)
65:     <span class="ruby-identifier">another_firm</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:another_firm</span>)
66: 
67:     <span class="ruby-identifier">citibank</span> = <span class="ruby-constant">Account</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;credit_limit&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">10</span>)
68:     <span class="ruby-identifier">citibank</span>.<span class="ruby-identifier">firm</span> = <span class="ruby-identifier">first_firm</span>
69:     <span class="ruby-identifier">original_proxy</span> = <span class="ruby-identifier">citibank</span>.<span class="ruby-identifier">firm</span>
70:     <span class="ruby-identifier">citibank</span>.<span class="ruby-identifier">firm</span> = <span class="ruby-identifier">another_firm</span>
71: 
72:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">first_firm</span>.<span class="ruby-identifier">object_id</span>, <span class="ruby-identifier">original_proxy</span>.<span class="ruby-identifier">target</span>.<span class="ruby-identifier">object_id</span>
73:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">another_firm</span>.<span class="ruby-identifier">object_id</span>, <span class="ruby-identifier">citibank</span>.<span class="ruby-identifier">firm</span>.<span class="ruby-identifier">target</span>.<span class="ruby-identifier">object_id</span>
74:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002804" class="method">
  <div id="M002804_title" class="title">
    <b>test_polymorphic_assignment_foreign_type_field_updating</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002804_source')" id="l_M002804_source">show source</a> ]</p>
  <div id="M002804_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 348</span>
348:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_polymorphic_assignment_foreign_type_field_updating</span>
349:     <span class="ruby-comment cmt"># should update when assigning a saved record</span>
350:     <span class="ruby-identifier">sponsor</span> = <span class="ruby-constant">Sponsor</span>.<span class="ruby-identifier">new</span>
351:     <span class="ruby-identifier">member</span> = <span class="ruby-constant">Member</span>.<span class="ruby-identifier">create</span>
352:     <span class="ruby-identifier">sponsor</span>.<span class="ruby-identifier">sponsorable</span> = <span class="ruby-identifier">member</span>
353:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;Member&quot;</span>, <span class="ruby-identifier">sponsor</span>.<span class="ruby-identifier">sponsorable_type</span>
354: 
355:     <span class="ruby-comment cmt"># should update when assigning a new record</span>
356:     <span class="ruby-identifier">sponsor</span> = <span class="ruby-constant">Sponsor</span>.<span class="ruby-identifier">new</span>
357:     <span class="ruby-identifier">member</span> = <span class="ruby-constant">Member</span>.<span class="ruby-identifier">new</span>
358:     <span class="ruby-identifier">sponsor</span>.<span class="ruby-identifier">sponsorable</span> = <span class="ruby-identifier">member</span>
359:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;Member&quot;</span>, <span class="ruby-identifier">sponsor</span>.<span class="ruby-identifier">sponsorable_type</span>
360:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002806" class="method">
  <div id="M002806_title" class="title">
    <b>test_polymorphic_assignment_updates_foreign_id_field_for_new_and_saved_records</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002806_source')" id="l_M002806_source">show source</a> ]</p>
  <div id="M002806_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 376</span>
376:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_polymorphic_assignment_updates_foreign_id_field_for_new_and_saved_records</span>
377:     <span class="ruby-identifier">sponsor</span> = <span class="ruby-constant">Sponsor</span>.<span class="ruby-identifier">new</span>
378:     <span class="ruby-identifier">saved_member</span> = <span class="ruby-constant">Member</span>.<span class="ruby-identifier">create</span>
379:     <span class="ruby-identifier">new_member</span> = <span class="ruby-constant">Member</span>.<span class="ruby-identifier">new</span>
380: 
381:     <span class="ruby-identifier">sponsor</span>.<span class="ruby-identifier">sponsorable</span> = <span class="ruby-identifier">saved_member</span>
382:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">saved_member</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">sponsor</span>.<span class="ruby-identifier">sponsorable_id</span>
383: 
384:     <span class="ruby-identifier">sponsor</span>.<span class="ruby-identifier">sponsorable</span> = <span class="ruby-identifier">new_member</span>
385:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">sponsor</span>.<span class="ruby-identifier">sponsorable_id</span>
386:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002805" class="method">
  <div id="M002805_title" class="title">
    <b>test_polymorphic_assignment_with_primary_key_foreign_type_field_updating</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002805_source')" id="l_M002805_source">show source</a> ]</p>
  <div id="M002805_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 362</span>
362:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_polymorphic_assignment_with_primary_key_foreign_type_field_updating</span>
363:     <span class="ruby-comment cmt"># should update when assigning a saved record</span>
364:     <span class="ruby-identifier">essay</span> = <span class="ruby-constant">Essay</span>.<span class="ruby-identifier">new</span>
365:     <span class="ruby-identifier">writer</span> = <span class="ruby-constant">Author</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;David&quot;</span>)
366:     <span class="ruby-identifier">essay</span>.<span class="ruby-identifier">writer</span> = <span class="ruby-identifier">writer</span>
367:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;Author&quot;</span>, <span class="ruby-identifier">essay</span>.<span class="ruby-identifier">writer_type</span>
368: 
369:     <span class="ruby-comment cmt"># should update when assigning a new record</span>
370:     <span class="ruby-identifier">essay</span> = <span class="ruby-constant">Essay</span>.<span class="ruby-identifier">new</span>
371:     <span class="ruby-identifier">writer</span> = <span class="ruby-constant">Author</span>.<span class="ruby-identifier">new</span>
372:     <span class="ruby-identifier">essay</span>.<span class="ruby-identifier">writer</span> = <span class="ruby-identifier">writer</span>
373:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;Author&quot;</span>, <span class="ruby-identifier">essay</span>.<span class="ruby-identifier">writer_type</span>
374:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002807" class="method">
  <div id="M002807_title" class="title">
    <b>test_polymorphic_assignment_with_primary_key_updates_foreign_id_field_for_new_and_saved_records</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002807_source')" id="l_M002807_source">show source</a> ]</p>
  <div id="M002807_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 388</span>
388:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_polymorphic_assignment_with_primary_key_updates_foreign_id_field_for_new_and_saved_records</span>
389:     <span class="ruby-identifier">essay</span> = <span class="ruby-constant">Essay</span>.<span class="ruby-identifier">new</span>
390:     <span class="ruby-identifier">saved_writer</span> = <span class="ruby-constant">Author</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;David&quot;</span>)
391:     <span class="ruby-identifier">new_writer</span> = <span class="ruby-constant">Author</span>.<span class="ruby-identifier">new</span>
392: 
393:     <span class="ruby-identifier">essay</span>.<span class="ruby-identifier">writer</span> = <span class="ruby-identifier">saved_writer</span>
394:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">saved_writer</span>.<span class="ruby-identifier">name</span>, <span class="ruby-identifier">essay</span>.<span class="ruby-identifier">writer_id</span>
395: 
396:     <span class="ruby-identifier">essay</span>.<span class="ruby-identifier">writer</span> = <span class="ruby-identifier">new_writer</span>
397:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">essay</span>.<span class="ruby-identifier">writer_id</span>
398:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002772" class="method">
  <div id="M002772_title" class="title">
    <b>test_proxy_assignment</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002772_source')" id="l_M002772_source">show source</a> ]</p>
  <div id="M002772_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 34</span>
34:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_proxy_assignment</span>
35:     <span class="ruby-identifier">account</span> = <span class="ruby-constant">Account</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">1</span>)
36:     <span class="ruby-identifier">assert_nothing_raised</span> { <span class="ruby-identifier">account</span>.<span class="ruby-identifier">firm</span> = <span class="ruby-identifier">account</span>.<span class="ruby-identifier">firm</span> }
37:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002810" class="method">
  <div id="M002810_title" class="title">
    <b>test_save_of_record_with_loaded_belongs_to</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002810_source')" id="l_M002810_source">show source</a> ]</p>
  <div id="M002810_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 410</span>
410:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_save_of_record_with_loaded_belongs_to</span>
411:     <span class="ruby-ivar">@account</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">account</span>
412: 
413:     <span class="ruby-identifier">assert_nothing_raised</span> <span class="ruby-keyword kw">do</span>
414:       <span class="ruby-constant">Account</span>.<span class="ruby-identifier">find</span>(<span class="ruby-ivar">@account</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">save!</span>
415:       <span class="ruby-constant">Account</span>.<span class="ruby-identifier">find</span>(<span class="ruby-ivar">@account</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">:include</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:firm</span>).<span class="ruby-identifier">save!</span>
416:     <span class="ruby-keyword kw">end</span>
417: 
418:     <span class="ruby-ivar">@account</span>.<span class="ruby-identifier">firm</span>.<span class="ruby-identifier">delete</span>
419: 
420:     <span class="ruby-identifier">assert_nothing_raised</span> <span class="ruby-keyword kw">do</span>
421:       <span class="ruby-constant">Account</span>.<span class="ruby-identifier">find</span>(<span class="ruby-ivar">@account</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">save!</span>
422:       <span class="ruby-constant">Account</span>.<span class="ruby-identifier">find</span>(<span class="ruby-ivar">@account</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">:include</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:firm</span>).<span class="ruby-identifier">save!</span>
423:     <span class="ruby-keyword kw">end</span>
424:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002773" class="method">
  <div id="M002773_title" class="title">
    <b>test_triple_equality</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002773_source')" id="l_M002773_source">show source</a> ]</p>
  <div id="M002773_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 39</span>
39:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_triple_equality</span>
40:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">Client</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">3</span>).<span class="ruby-identifier">firm</span> <span class="ruby-operator">===</span> <span class="ruby-constant">Firm</span>
41:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">Firm</span> <span class="ruby-operator">===</span> <span class="ruby-constant">Client</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">3</span>).<span class="ruby-identifier">firm</span>
42:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002774" class="method">
  <div id="M002774_title" class="title">
    <b>test_type_mismatch</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002774_source')" id="l_M002774_source">show source</a> ]</p>
  <div id="M002774_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 44</span>
44:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_type_mismatch</span>
45:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">AssociationTypeMismatch</span>) { <span class="ruby-constant">Account</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">1</span>).<span class="ruby-identifier">firm</span> = <span class="ruby-value">1</span> }
46:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">AssociationTypeMismatch</span>) { <span class="ruby-constant">Account</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">1</span>).<span class="ruby-identifier">firm</span> = <span class="ruby-constant">Project</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">1</span>) }
47:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002785" class="method">
  <div id="M002785_title" class="title">
    <b>test_with_condition</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002785_source')" id="l_M002785_source">show source</a> ]</p>
  <div id="M002785_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 129</span>
129:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_with_condition</span>
130:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-constant">Company</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">1</span>).<span class="ruby-identifier">name</span>, <span class="ruby-constant">Company</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">3</span>).<span class="ruby-identifier">firm_with_condition</span>.<span class="ruby-identifier">name</span>
131:     <span class="ruby-identifier">assert_not_nil</span> <span class="ruby-constant">Company</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">3</span>).<span class="ruby-identifier">firm_with_condition</span>, <span class="ruby-value str">&quot;Microsoft should have a firm&quot;</span>
132:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002784" class="method">
  <div id="M002784_title" class="title">
    <b>test_with_different_class_name</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002784_source')" id="l_M002784_source">show source</a> ]</p>
  <div id="M002784_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 124</span>
124:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_with_different_class_name</span>
125:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-constant">Company</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">1</span>).<span class="ruby-identifier">name</span>, <span class="ruby-constant">Company</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">3</span>).<span class="ruby-identifier">firm_with_other_name</span>.<span class="ruby-identifier">name</span>
126:     <span class="ruby-identifier">assert_not_nil</span> <span class="ruby-constant">Company</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">3</span>).<span class="ruby-identifier">firm_with_other_name</span>, <span class="ruby-value str">&quot;Microsoft should have a firm&quot;</span>
127:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002786" class="method">
  <div id="M002786_title" class="title">
    <b>test_with_select</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002786_source')" id="l_M002786_source">show source</a> ]</p>
  <div id="M002786_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 134</span>
134:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_with_select</span>
135:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-constant">Company</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">2</span>).<span class="ruby-identifier">firm_with_select</span>.<span class="ruby-identifier">attributes</span>.<span class="ruby-identifier">size</span>, <span class="ruby-value">1</span>
136:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-constant">Company</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">2</span>, <span class="ruby-identifier">:include</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:firm_with_select</span> ).<span class="ruby-identifier">firm_with_select</span>.<span class="ruby-identifier">attributes</span>.<span class="ruby-identifier">size</span>, <span class="ruby-value">1</span>
137:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
</div>

  </div>