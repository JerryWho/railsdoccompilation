  <div id="C00000425">
<div class='banner'>
  <span class="file-title-prefix">Class</span><br />BelongsToAssociationsTest<br/>
  In:
<a href="#" onclick="jsHref('files/activerecord/test/cases/associations/belongs_to_associations_test_rb.html');">activerecord/test/cases/associations/belongs_to_associations_test.rb</a>

Parent:&nbsp;
ActiveRecord::TestCase
</div>
 <!-- banner header -->

  <div id="bodyContent" >
      <div id="content">




  <div class="sectiontitle">Methods</div>
  <ul>
  <li><a href="index.html?a=M002815&name=test_assignment_before_child_saved" >test_assignment_before_child_saved</a></li>
  <li><a href="index.html?a=M002816&name=test_assignment_before_child_saved_with_primary_key" >test_assignment_before_child_saved_with_primary_key</a></li>
  <li><a href="index.html?a=M002822&name=test_association_assignment_sticks" >test_association_assignment_sticks</a></li>
  <li><a href="index.html?a=M002788&name=test_belongs_to" >test_belongs_to</a></li>
  <li><a href="index.html?a=M002807&name=test_belongs_to_counter" >test_belongs_to_counter</a></li>
  <li><a href="index.html?a=M002813&name=test_belongs_to_counter_after_save" >test_belongs_to_counter_after_save</a></li>
  <li><a href="index.html?a=M002814&name=test_belongs_to_counter_after_update_attributes" >test_belongs_to_counter_after_update_attributes</a></li>
  <li><a href="index.html?a=M002809&name=test_belongs_to_counter_with_assigning_nil" >test_belongs_to_counter_with_assigning_nil</a></li>
  <li><a href="index.html?a=M002811&name=test_belongs_to_counter_with_reassigning" >test_belongs_to_counter_with_reassigning</a></li>
  <li><a href="index.html?a=M002828&name=test_belongs_to_proxy_should_not_respond_to_private_methods" >test_belongs_to_proxy_should_not_respond_to_private_methods</a></li>
  <li><a href="index.html?a=M002829&name=test_belongs_to_proxy_should_respond_to_private_methods_via_send" >test_belongs_to_proxy_should_respond_to_private_methods_via_send</a></li>
  <li><a href="index.html?a=M002812&name=test_belongs_to_reassign_with_namespaced_models_and_counters" >test_belongs_to_reassign_with_namespaced_models_and_counters</a></li>
  <li><a href="index.html?a=M002789&name=test_belongs_to_with_primary_key" >test_belongs_to_with_primary_key</a></li>
  <li><a href="index.html?a=M002808&name=test_belongs_to_with_primary_key_counter" >test_belongs_to_with_primary_key_counter</a></li>
  <li><a href="index.html?a=M002810&name=test_belongs_to_with_primary_key_counter_with_assigning_nil" >test_belongs_to_with_primary_key_counter_with_assigning_nil</a></li>
  <li><a href="index.html?a=M002790&name=test_belongs_to_with_primary_key_joins_on_correct_column" >test_belongs_to_with_primary_key_joins_on_correct_column</a></li>
  <li><a href="index.html?a=M002800&name=test_building_the_belonging_object" >test_building_the_belonging_object</a></li>
  <li><a href="index.html?a=M002801&name=test_building_the_belonging_object_with_primary_key" >test_building_the_belonging_object_with_primary_key</a></li>
  <li><a href="index.html?a=M002823&name=test_cant_save_readonly_association" >test_cant_save_readonly_association</a></li>
  <li><a href="index.html?a=M002820&name=test_counter_cache" >test_counter_cache</a></li>
  <li><a href="index.html?a=M002798&name=test_creating_the_belonging_object" >test_creating_the_belonging_object</a></li>
  <li><a href="index.html?a=M002799&name=test_creating_the_belonging_object_with_primary_key" >test_creating_the_belonging_object_with_primary_key</a></li>
  <li><a href="index.html?a=M002821&name=test_custom_counter_cache" >test_custom_counter_cache</a></li>
  <li><a href="index.html?a=M002796&name=test_eager_loading_with_primary_key" >test_eager_loading_with_primary_key</a></li>
  <li><a href="index.html?a=M002819&name=test_field_name_same_as_foreign_key" >test_field_name_same_as_foreign_key</a></li>
  <li><a href="index.html?a=M002818&name=test_forgetting_the_load_when_foreign_key_enters_late" >test_forgetting_the_load_when_foreign_key_enters_late</a></li>
  <li><a href="index.html?a=M002794&name=test_natural_assignment" >test_natural_assignment</a></li>
  <li><a href="index.html?a=M002802&name=test_natural_assignment_to_nil" >test_natural_assignment_to_nil</a></li>
  <li><a href="index.html?a=M002803&name=test_natural_assignment_to_nil_with_primary_key" >test_natural_assignment_to_nil_with_primary_key</a></li>
  <li><a href="index.html?a=M002795&name=test_natural_assignment_with_primary_key" >test_natural_assignment_with_primary_key</a></li>
  <li><a href="index.html?a=M002817&name=test_new_record_with_foreign_key_but_no_object" >test_new_record_with_foreign_key_but_no_object</a></li>
  <li><a href="index.html?a=M002797&name=test_no_unexpected_aliasing" >test_no_unexpected_aliasing</a></li>
  <li><a href="index.html?a=M002824&name=test_polymorphic_assignment_foreign_type_field_updating" >test_polymorphic_assignment_foreign_type_field_updating</a></li>
  <li><a href="index.html?a=M002826&name=test_polymorphic_assignment_updates_foreign_id_field_for_new_and_saved_records" >test_polymorphic_assignment_updates_foreign_id_field_for_new_and_saved_records</a></li>
  <li><a href="index.html?a=M002825&name=test_polymorphic_assignment_with_primary_key_foreign_type_field_updating" >test_polymorphic_assignment_with_primary_key_foreign_type_field_updating</a></li>
  <li><a href="index.html?a=M002827&name=test_polymorphic_assignment_with_primary_key_updates_foreign_id_field_for_new_and_saved_records" >test_polymorphic_assignment_with_primary_key_updates_foreign_id_field_for_new_and_saved_records</a></li>
  <li><a href="index.html?a=M002791&name=test_proxy_assignment" >test_proxy_assignment</a></li>
  <li><a href="index.html?a=M002830&name=test_save_of_record_with_loaded_belongs_to" >test_save_of_record_with_loaded_belongs_to</a></li>
  <li><a href="index.html?a=M002792&name=test_triple_equality" >test_triple_equality</a></li>
  <li><a href="index.html?a=M002793&name=test_type_mismatch" >test_type_mismatch</a></li>
  <li><a href="index.html?a=M002805&name=test_with_condition" >test_with_condition</a></li>
  <li><a href="index.html?a=M002804&name=test_with_different_class_name" >test_with_different_class_name</a></li>
  <li><a href="index.html?a=M002806&name=test_with_select" >test_with_select</a></li>
  </ul>






<div class="sectiontitle">Public Instance methods</div>
<div id="M002815" class="method">
  <div id="M002815_title" class="title">
    <b>test_assignment_before_child_saved</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002815_source')" id="l_M002815_source">show source</a> ]</p>
  <div id="M002815_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 265</span>
265:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_assignment_before_child_saved</span>
266:     <span class="ruby-identifier">final_cut</span> = <span class="ruby-constant">Client</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Final Cut&quot;</span>)
267:     <span class="ruby-identifier">firm</span> = <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">1</span>)
268:     <span class="ruby-identifier">final_cut</span>.<span class="ruby-identifier">firm</span> = <span class="ruby-identifier">firm</span>
269:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">final_cut</span>.<span class="ruby-identifier">new_record?</span>
270:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">final_cut</span>.<span class="ruby-identifier">save</span>
271:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">final_cut</span>.<span class="ruby-identifier">new_record?</span>
272:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">firm</span>.<span class="ruby-identifier">new_record?</span>
273:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">firm</span>, <span class="ruby-identifier">final_cut</span>.<span class="ruby-identifier">firm</span>
274:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">firm</span>, <span class="ruby-identifier">final_cut</span>.<span class="ruby-identifier">firm</span>(<span class="ruby-keyword kw">true</span>)
275:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002816" class="method">
  <div id="M002816_title" class="title">
    <b>test_assignment_before_child_saved_with_primary_key</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002816_source')" id="l_M002816_source">show source</a> ]</p>
  <div id="M002816_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 277</span>
277:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_assignment_before_child_saved_with_primary_key</span>
278:     <span class="ruby-identifier">final_cut</span> = <span class="ruby-constant">Client</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Final Cut&quot;</span>)
279:     <span class="ruby-identifier">firm</span> = <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">1</span>)
280:     <span class="ruby-identifier">final_cut</span>.<span class="ruby-identifier">firm_with_primary_key</span> = <span class="ruby-identifier">firm</span>
281:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">final_cut</span>.<span class="ruby-identifier">new_record?</span>
282:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">final_cut</span>.<span class="ruby-identifier">save</span>
283:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">final_cut</span>.<span class="ruby-identifier">new_record?</span>
284:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">firm</span>.<span class="ruby-identifier">new_record?</span>
285:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">firm</span>, <span class="ruby-identifier">final_cut</span>.<span class="ruby-identifier">firm_with_primary_key</span>
286:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">firm</span>, <span class="ruby-identifier">final_cut</span>.<span class="ruby-identifier">firm_with_primary_key</span>(<span class="ruby-keyword kw">true</span>)
287:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002822" class="method">
  <div id="M002822_title" class="title">
    <b>test_association_assignment_sticks</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002822_source')" id="l_M002822_source">show source</a> ]</p>
  <div id="M002822_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 335</span>
335:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_association_assignment_sticks</span>
336:     <span class="ruby-identifier">post</span> = <span class="ruby-constant">Post</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>)
337: 
338:     <span class="ruby-identifier">author1</span>, <span class="ruby-identifier">author2</span> = <span class="ruby-constant">Author</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>, <span class="ruby-identifier">:limit</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">2</span>)
339:     <span class="ruby-identifier">assert_not_nil</span> <span class="ruby-identifier">author1</span>
340:     <span class="ruby-identifier">assert_not_nil</span> <span class="ruby-identifier">author2</span>
341: 
342:     <span class="ruby-comment cmt"># make sure the association is loaded</span>
343:     <span class="ruby-identifier">post</span>.<span class="ruby-identifier">author</span>
344: 
345:     <span class="ruby-comment cmt"># set the association by id, directly</span>
346:     <span class="ruby-identifier">post</span>.<span class="ruby-identifier">author_id</span> = <span class="ruby-identifier">author2</span>.<span class="ruby-identifier">id</span>
347: 
348:     <span class="ruby-comment cmt"># save and reload</span>
349:     <span class="ruby-identifier">post</span>.<span class="ruby-identifier">save!</span>
350:     <span class="ruby-identifier">post</span>.<span class="ruby-identifier">reload</span>
351: 
352:     <span class="ruby-comment cmt"># the author id of the post should be the id we set</span>
353:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">post</span>.<span class="ruby-identifier">author_id</span>, <span class="ruby-identifier">author2</span>.<span class="ruby-identifier">id</span>
354:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002788" class="method">
  <div id="M002788_title" class="title">
    <b>test_belongs_to</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002788_source')" id="l_M002788_source">show source</a> ]</p>
  <div id="M002788_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 23</span>
23:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_belongs_to</span>
24:     <span class="ruby-constant">Client</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">3</span>).<span class="ruby-identifier">firm</span>.<span class="ruby-identifier">name</span>
25:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">name</span>, <span class="ruby-constant">Client</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">3</span>).<span class="ruby-identifier">firm</span>.<span class="ruby-identifier">name</span>
26:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-constant">Client</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">3</span>).<span class="ruby-identifier">firm</span>.<span class="ruby-identifier">nil?</span>, <span class="ruby-value str">&quot;Microsoft should have a firm&quot;</span>
27:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002807" class="method">
  <div id="M002807_title" class="title">
    <b>test_belongs_to_counter</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002807_source')" id="l_M002807_source">show source</a> ]</p>
  <div id="M002807_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 152</span>
152:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_belongs_to_counter</span>
153:     <span class="ruby-identifier">debate</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;debate&quot;</span>)
154:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-identifier">debate</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:read_attribute</span>, <span class="ruby-value str">&quot;replies_count&quot;</span>), <span class="ruby-value str">&quot;No replies yet&quot;</span>
155: 
156:     <span class="ruby-identifier">trash</span> = <span class="ruby-identifier">debate</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;blah!&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;world around!&quot;</span>)
157:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">debate</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:read_attribute</span>, <span class="ruby-value str">&quot;replies_count&quot;</span>), <span class="ruby-value str">&quot;First reply created&quot;</span>
158: 
159:     <span class="ruby-identifier">trash</span>.<span class="ruby-identifier">destroy</span>
160:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">debate</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:read_attribute</span>, <span class="ruby-value str">&quot;replies_count&quot;</span>), <span class="ruby-value str">&quot;First reply deleted&quot;</span>
161:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002813" class="method">
  <div id="M002813_title" class="title">
    <b>test_belongs_to_counter_after_save</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002813_source')" id="l_M002813_source">show source</a> ]</p>
  <div id="M002813_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 247</span>
247:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_belongs_to_counter_after_save</span>
248:     <span class="ruby-identifier">topic</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;monday night&quot;</span>)
249:     <span class="ruby-identifier">topic</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;re: monday night&quot;</span>, <span class="ruby-identifier">:content</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;football&quot;</span>)
250:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">topic</span>.<span class="ruby-identifier">id</span>)[<span class="ruby-identifier">:replies_count</span>]
251: 
252:     <span class="ruby-identifier">topic</span>.<span class="ruby-identifier">save!</span>
253:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">topic</span>.<span class="ruby-identifier">id</span>)[<span class="ruby-identifier">:replies_count</span>]
254:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002814" class="method">
  <div id="M002814_title" class="title">
    <b>test_belongs_to_counter_after_update_attributes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002814_source')" id="l_M002814_source">show source</a> ]</p>
  <div id="M002814_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 256</span>
256:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_belongs_to_counter_after_update_attributes</span>
257:     <span class="ruby-identifier">topic</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;37s&quot;</span>)
258:     <span class="ruby-identifier">topic</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;re: 37s&quot;</span>, <span class="ruby-identifier">:content</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;rails&quot;</span>)
259:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">topic</span>.<span class="ruby-identifier">id</span>)[<span class="ruby-identifier">:replies_count</span>]
260: 
261:     <span class="ruby-identifier">topic</span>.<span class="ruby-identifier">update_attributes</span>(<span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;37signals&quot;</span>)
262:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">topic</span>.<span class="ruby-identifier">id</span>)[<span class="ruby-identifier">:replies_count</span>]
263:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002809" class="method">
  <div id="M002809_title" class="title">
    <b>test_belongs_to_counter_with_assigning_nil</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002809_source')" id="l_M002809_source">show source</a> ]</p>
  <div id="M002809_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 174</span>
174:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_belongs_to_counter_with_assigning_nil</span>
175:     <span class="ruby-identifier">p</span> = <span class="ruby-constant">Post</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">1</span>)
176:     <span class="ruby-identifier">c</span> = <span class="ruby-constant">Comment</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">1</span>)
177: 
178:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">p</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">c</span>.<span class="ruby-identifier">post_id</span>
179:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-constant">Post</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">p</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">comments</span>.<span class="ruby-identifier">size</span>
180: 
181:     <span class="ruby-identifier">c</span>.<span class="ruby-identifier">post</span> = <span class="ruby-keyword kw">nil</span>
182: 
183:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-constant">Post</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">p</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">comments</span>.<span class="ruby-identifier">size</span>
184:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002811" class="method">
  <div id="M002811_title" class="title">
    <b>test_belongs_to_counter_with_reassigning</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002811_source')" id="l_M002811_source">show source</a> ]</p>
  <div id="M002811_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 198</span>
198:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_belongs_to_counter_with_reassigning</span>
199:     <span class="ruby-identifier">t1</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;t1&quot;</span>)
200:     <span class="ruby-identifier">t2</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;t2&quot;</span>)
201:     <span class="ruby-identifier">r1</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;r1&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;r1&quot;</span>)
202:     <span class="ruby-identifier">r1</span>.<span class="ruby-identifier">topic</span> = <span class="ruby-identifier">t1</span>
203: 
204:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r1</span>.<span class="ruby-identifier">save</span>
205:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">t1</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">size</span>
206:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">t2</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">size</span>
207: 
208:     <span class="ruby-identifier">r1</span>.<span class="ruby-identifier">topic</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">t2</span>.<span class="ruby-identifier">id</span>)
209: 
210:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r1</span>.<span class="ruby-identifier">save</span>
211:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">t1</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">size</span>
212:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">t2</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">size</span>
213: 
214:     <span class="ruby-identifier">r1</span>.<span class="ruby-identifier">topic</span> = <span class="ruby-keyword kw">nil</span>
215: 
216:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">t1</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">size</span>
217:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">t2</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">size</span>
218: 
219:     <span class="ruby-identifier">r1</span>.<span class="ruby-identifier">topic</span> = <span class="ruby-identifier">t1</span>
220: 
221:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">t1</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">size</span>
222:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">t2</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">size</span>
223: 
224:     <span class="ruby-identifier">r1</span>.<span class="ruby-identifier">destroy</span>
225: 
226:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">t1</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">size</span>
227:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">t2</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">size</span>
228:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002828" class="method">
  <div id="M002828_title" class="title">
    <b>test_belongs_to_proxy_should_not_respond_to_private_methods</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002828_source')" id="l_M002828_source">show source</a> ]</p>
  <div id="M002828_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 413</span>
413:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_belongs_to_proxy_should_not_respond_to_private_methods</span>
414:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">NoMethodError</span>) { <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">private_method</span> }
415:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">NoMethodError</span>) { <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:second_client</span>).<span class="ruby-identifier">firm</span>.<span class="ruby-identifier">private_method</span> }
416:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002829" class="method">
  <div id="M002829_title" class="title">
    <b>test_belongs_to_proxy_should_respond_to_private_methods_via_send</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002829_source')" id="l_M002829_source">show source</a> ]</p>
  <div id="M002829_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 418</span>
418:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_belongs_to_proxy_should_respond_to_private_methods_via_send</span>
419:     <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:private_method</span>)
420:     <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:second_client</span>).<span class="ruby-identifier">firm</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:private_method</span>)
421:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002812" class="method">
  <div id="M002812_title" class="title">
    <b>test_belongs_to_reassign_with_namespaced_models_and_counters</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002812_source')" id="l_M002812_source">show source</a> ]</p>
  <div id="M002812_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 230</span>
230:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_belongs_to_reassign_with_namespaced_models_and_counters</span>
231:     <span class="ruby-identifier">t1</span> = <span class="ruby-constant">Web</span><span class="ruby-operator">::</span><span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;t1&quot;</span>)
232:     <span class="ruby-identifier">t2</span> = <span class="ruby-constant">Web</span><span class="ruby-operator">::</span><span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;t2&quot;</span>)
233:     <span class="ruby-identifier">r1</span> = <span class="ruby-constant">Web</span><span class="ruby-operator">::</span><span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;r1&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;r1&quot;</span>)
234:     <span class="ruby-identifier">r1</span>.<span class="ruby-identifier">topic</span> = <span class="ruby-identifier">t1</span>
235: 
236:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r1</span>.<span class="ruby-identifier">save</span>
237:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-constant">Web</span><span class="ruby-operator">::</span><span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">t1</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">size</span>
238:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-constant">Web</span><span class="ruby-operator">::</span><span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">t2</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">size</span>
239: 
240:     <span class="ruby-identifier">r1</span>.<span class="ruby-identifier">topic</span> = <span class="ruby-constant">Web</span><span class="ruby-operator">::</span><span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">t2</span>.<span class="ruby-identifier">id</span>)
241: 
242:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r1</span>.<span class="ruby-identifier">save</span>
243:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-constant">Web</span><span class="ruby-operator">::</span><span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">t1</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">size</span>
244:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-constant">Web</span><span class="ruby-operator">::</span><span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">t2</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">size</span>
245:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002789" class="method">
  <div id="M002789_title" class="title">
    <b>test_belongs_to_with_primary_key</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002789_source')" id="l_M002789_source">show source</a> ]</p>
  <div id="M002789_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 29</span>
29:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_belongs_to_with_primary_key</span>
30:     <span class="ruby-identifier">client</span> = <span class="ruby-constant">Client</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Primary key client&quot;</span>, <span class="ruby-identifier">:firm_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">name</span>)
31:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">name</span>, <span class="ruby-identifier">client</span>.<span class="ruby-identifier">firm_with_primary_key</span>.<span class="ruby-identifier">name</span>
32:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002808" class="method">
  <div id="M002808_title" class="title">
    <b>test_belongs_to_with_primary_key_counter</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002808_source')" id="l_M002808_source">show source</a> ]</p>
  <div id="M002808_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 163</span>
163:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_belongs_to_with_primary_key_counter</span>
164:     <span class="ruby-identifier">debate</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;debate&quot;</span>)
165:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-identifier">debate</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:read_attribute</span>, <span class="ruby-value str">&quot;replies_count&quot;</span>), <span class="ruby-value str">&quot;No replies yet&quot;</span>
166: 
167:     <span class="ruby-identifier">trash</span> = <span class="ruby-identifier">debate</span>.<span class="ruby-identifier">replies_with_primary_key</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;blah!&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;world around!&quot;</span>)
168:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">debate</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:read_attribute</span>, <span class="ruby-value str">&quot;replies_count&quot;</span>), <span class="ruby-value str">&quot;First reply created&quot;</span>
169: 
170:     <span class="ruby-identifier">trash</span>.<span class="ruby-identifier">destroy</span>
171:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">debate</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:read_attribute</span>, <span class="ruby-value str">&quot;replies_count&quot;</span>), <span class="ruby-value str">&quot;First reply deleted&quot;</span>
172:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002810" class="method">
  <div id="M002810_title" class="title">
    <b>test_belongs_to_with_primary_key_counter_with_assigning_nil</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002810_source')" id="l_M002810_source">show source</a> ]</p>
  <div id="M002810_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 186</span>
186:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_belongs_to_with_primary_key_counter_with_assigning_nil</span>
187:     <span class="ruby-identifier">debate</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;debate&quot;</span>)
188:     <span class="ruby-identifier">reply</span>  = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;blah!&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;world around!&quot;</span>, <span class="ruby-value str">&quot;parent_title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;debate&quot;</span>)
189: 
190:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">debate</span>.<span class="ruby-identifier">title</span>, <span class="ruby-identifier">reply</span>.<span class="ruby-identifier">parent_title</span>
191:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">debate</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:read_attribute</span>, <span class="ruby-value str">&quot;replies_count&quot;</span>)
192: 
193:     <span class="ruby-identifier">reply</span>.<span class="ruby-identifier">topic_with_primary_key</span> = <span class="ruby-keyword kw">nil</span>
194: 
195:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">debate</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:read_attribute</span>, <span class="ruby-value str">&quot;replies_count&quot;</span>)
196:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002790" class="method">
  <div id="M002790_title" class="title">
    <b>test_belongs_to_with_primary_key_joins_on_correct_column</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002790_source')" id="l_M002790_source">show source</a> ]</p>
  <div id="M002790_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 34</span>
34:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_belongs_to_with_primary_key_joins_on_correct_column</span>
35:     <span class="ruby-identifier">sql</span> = <span class="ruby-constant">Client</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:construct_finder_sql</span>, <span class="ruby-identifier">:joins</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:firm_with_primary_key</span>)
36:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">sql</span> <span class="ruby-operator">!~</span> <span class="ruby-regexp re">/\.id/</span>
37:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">sql</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/\.name/</span>
38:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002800" class="method">
  <div id="M002800_title" class="title">
    <b>test_building_the_belonging_object</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002800_source')" id="l_M002800_source">show source</a> ]</p>
  <div id="M002800_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 107</span>
107:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_building_the_belonging_object</span>
108:     <span class="ruby-identifier">citibank</span> = <span class="ruby-constant">Account</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;credit_limit&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">10</span>)
109:     <span class="ruby-identifier">apple</span>    = <span class="ruby-identifier">citibank</span>.<span class="ruby-identifier">build_firm</span>(<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Apple&quot;</span>)
110:     <span class="ruby-identifier">citibank</span>.<span class="ruby-identifier">save</span>
111:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">apple</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">citibank</span>.<span class="ruby-identifier">firm_id</span>
112:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002801" class="method">
  <div id="M002801_title" class="title">
    <b>test_building_the_belonging_object_with_primary_key</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002801_source')" id="l_M002801_source">show source</a> ]</p>
  <div id="M002801_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 114</span>
114:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_building_the_belonging_object_with_primary_key</span>
115:     <span class="ruby-identifier">client</span> = <span class="ruby-constant">Client</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Primary key client&quot;</span>)
116:     <span class="ruby-identifier">apple</span>  = <span class="ruby-identifier">client</span>.<span class="ruby-identifier">build_firm_with_primary_key</span>(<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Apple&quot;</span>)
117:     <span class="ruby-identifier">client</span>.<span class="ruby-identifier">save</span>
118:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">apple</span>.<span class="ruby-identifier">name</span>, <span class="ruby-identifier">client</span>.<span class="ruby-identifier">firm_name</span>
119:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002823" class="method">
  <div id="M002823_title" class="title">
    <b>test_cant_save_readonly_association</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002823_source')" id="l_M002823_source">show source</a> ]</p>
  <div id="M002823_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 356</span>
356:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_cant_save_readonly_association</span>
357:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">ReadOnlyRecord</span>) { <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_client</span>).<span class="ruby-identifier">readonly_firm</span>.<span class="ruby-identifier">save!</span> }
358:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_client</span>).<span class="ruby-identifier">readonly_firm</span>.<span class="ruby-identifier">readonly?</span>
359:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002820" class="method">
  <div id="M002820_title" class="title">
    <b>test_counter_cache</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002820_source')" id="l_M002820_source">show source</a> ]</p>
  <div id="M002820_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 307</span>
307:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_counter_cache</span>
308:     <span class="ruby-identifier">topic</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span> <span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Zoom-zoom-zoom&quot;</span>
309:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-identifier">topic</span>[<span class="ruby-identifier">:replies_count</span>]
310: 
311:     <span class="ruby-identifier">reply</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;re: zoom&quot;</span>, <span class="ruby-identifier">:content</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;speedy quick!&quot;</span>)
312:     <span class="ruby-identifier">reply</span>.<span class="ruby-identifier">topic</span> = <span class="ruby-identifier">topic</span>
313: 
314:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">topic</span>.<span class="ruby-identifier">reload</span>[<span class="ruby-identifier">:replies_count</span>]
315:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">topic</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">size</span>
316: 
317:     <span class="ruby-identifier">topic</span>[<span class="ruby-identifier">:replies_count</span>] = <span class="ruby-value">15</span>
318:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">15</span>, <span class="ruby-identifier">topic</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">size</span>
319:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002798" class="method">
  <div id="M002798_title" class="title">
    <b>test_creating_the_belonging_object</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002798_source')" id="l_M002798_source">show source</a> ]</p>
  <div id="M002798_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 89</span>
89:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_creating_the_belonging_object</span>
90:     <span class="ruby-identifier">citibank</span> = <span class="ruby-constant">Account</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;credit_limit&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">10</span>)
91:     <span class="ruby-identifier">apple</span>    = <span class="ruby-identifier">citibank</span>.<span class="ruby-identifier">create_firm</span>(<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Apple&quot;</span>)
92:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">apple</span>, <span class="ruby-identifier">citibank</span>.<span class="ruby-identifier">firm</span>
93:     <span class="ruby-identifier">citibank</span>.<span class="ruby-identifier">save</span>
94:     <span class="ruby-identifier">citibank</span>.<span class="ruby-identifier">reload</span>
95:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">apple</span>, <span class="ruby-identifier">citibank</span>.<span class="ruby-identifier">firm</span>
96:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002799" class="method">
  <div id="M002799_title" class="title">
    <b>test_creating_the_belonging_object_with_primary_key</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002799_source')" id="l_M002799_source">show source</a> ]</p>
  <div id="M002799_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 98</span>
 98:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_creating_the_belonging_object_with_primary_key</span>
 99:     <span class="ruby-identifier">client</span> = <span class="ruby-constant">Client</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Primary key client&quot;</span>)
100:     <span class="ruby-identifier">apple</span>  = <span class="ruby-identifier">client</span>.<span class="ruby-identifier">create_firm_with_primary_key</span>(<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Apple&quot;</span>)
101:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">apple</span>, <span class="ruby-identifier">client</span>.<span class="ruby-identifier">firm_with_primary_key</span>
102:     <span class="ruby-identifier">client</span>.<span class="ruby-identifier">save</span>
103:     <span class="ruby-identifier">client</span>.<span class="ruby-identifier">reload</span>
104:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">apple</span>, <span class="ruby-identifier">client</span>.<span class="ruby-identifier">firm_with_primary_key</span>
105:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002821" class="method">
  <div id="M002821_title" class="title">
    <b>test_custom_counter_cache</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002821_source')" id="l_M002821_source">show source</a> ]</p>
  <div id="M002821_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 321</span>
321:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_custom_counter_cache</span>
322:     <span class="ruby-identifier">reply</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;re: zoom&quot;</span>, <span class="ruby-identifier">:content</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;speedy quick!&quot;</span>)
323:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-identifier">reply</span>[<span class="ruby-identifier">:replies_count</span>]
324: 
325:     <span class="ruby-identifier">silly</span> = <span class="ruby-constant">SillyReply</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;gaga&quot;</span>, <span class="ruby-identifier">:content</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;boo-boo&quot;</span>)
326:     <span class="ruby-identifier">silly</span>.<span class="ruby-identifier">reply</span> = <span class="ruby-identifier">reply</span>
327: 
328:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">reply</span>.<span class="ruby-identifier">reload</span>[<span class="ruby-identifier">:replies_count</span>]
329:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">reply</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">size</span>
330: 
331:     <span class="ruby-identifier">reply</span>[<span class="ruby-identifier">:replies_count</span>] = <span class="ruby-value">17</span>
332:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">17</span>, <span class="ruby-identifier">reply</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">size</span>
333:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002796" class="method">
  <div id="M002796_title" class="title">
    <b>test_eager_loading_with_primary_key</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002796_source')" id="l_M002796_source">show source</a> ]</p>
  <div id="M002796_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 69</span>
69:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_eager_loading_with_primary_key</span>
70:     <span class="ruby-identifier">apple</span> = <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Apple&quot;</span>)
71:     <span class="ruby-identifier">citibank</span> = <span class="ruby-constant">Client</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Citibank&quot;</span>, <span class="ruby-identifier">:firm_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Apple&quot;</span>)
72:     <span class="ruby-identifier">citibank_result</span> = <span class="ruby-constant">Client</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> {<span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Citibank&quot;</span>}, <span class="ruby-identifier">:include</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:firm_with_primary_key</span>)
73:     <span class="ruby-identifier">assert_not_nil</span> <span class="ruby-identifier">citibank_result</span>.<span class="ruby-identifier">instance_variable_get</span>(<span class="ruby-value str">&quot;@firm_with_primary_key&quot;</span>)
74:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002819" class="method">
  <div id="M002819_title" class="title">
    <b>test_field_name_same_as_foreign_key</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002819_source')" id="l_M002819_source">show source</a> ]</p>
  <div id="M002819_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 302</span>
302:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_field_name_same_as_foreign_key</span>
303:     <span class="ruby-identifier">computer</span> = <span class="ruby-constant">Computer</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">1</span>)
304:     <span class="ruby-identifier">assert_not_nil</span> <span class="ruby-identifier">computer</span>.<span class="ruby-identifier">developer</span>, <span class="ruby-value str">&quot;:foreign key == attribute didn't lock up&quot;</span> <span class="ruby-comment cmt"># '</span>
305:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002818" class="method">
  <div id="M002818_title" class="title">
    <b>test_forgetting_the_load_when_foreign_key_enters_late</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002818_source')" id="l_M002818_source">show source</a> ]</p>
  <div id="M002818_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 294</span>
294:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_forgetting_the_load_when_foreign_key_enters_late</span>
295:     <span class="ruby-identifier">c</span> = <span class="ruby-constant">Client</span>.<span class="ruby-identifier">new</span>
296:     <span class="ruby-identifier">assert_nil</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">firm_with_basic_id</span>
297: 
298:     <span class="ruby-identifier">c</span>.<span class="ruby-identifier">firm_id</span> = <span class="ruby-value">1</span>
299:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>), <span class="ruby-identifier">c</span>.<span class="ruby-identifier">firm_with_basic_id</span>
300:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002794" class="method">
  <div id="M002794_title" class="title">
    <b>test_natural_assignment</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002794_source')" id="l_M002794_source">show source</a> ]</p>
  <div id="M002794_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 55</span>
55:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_natural_assignment</span>
56:     <span class="ruby-identifier">apple</span> = <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Apple&quot;</span>)
57:     <span class="ruby-identifier">citibank</span> = <span class="ruby-constant">Account</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;credit_limit&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">10</span>)
58:     <span class="ruby-identifier">citibank</span>.<span class="ruby-identifier">firm</span> = <span class="ruby-identifier">apple</span>
59:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">apple</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">citibank</span>.<span class="ruby-identifier">firm_id</span>
60:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002802" class="method">
  <div id="M002802_title" class="title">
    <b>test_natural_assignment_to_nil</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002802_source')" id="l_M002802_source">show source</a> ]</p>
  <div id="M002802_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 121</span>
121:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_natural_assignment_to_nil</span>
122:     <span class="ruby-identifier">client</span> = <span class="ruby-constant">Client</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">3</span>)
123:     <span class="ruby-identifier">client</span>.<span class="ruby-identifier">firm</span> = <span class="ruby-keyword kw">nil</span>
124:     <span class="ruby-identifier">client</span>.<span class="ruby-identifier">save</span>
125:     <span class="ruby-identifier">assert_nil</span> <span class="ruby-identifier">client</span>.<span class="ruby-identifier">firm</span>(<span class="ruby-keyword kw">true</span>)
126:     <span class="ruby-identifier">assert_nil</span> <span class="ruby-identifier">client</span>.<span class="ruby-identifier">client_of</span>
127:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002803" class="method">
  <div id="M002803_title" class="title">
    <b>test_natural_assignment_to_nil_with_primary_key</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002803_source')" id="l_M002803_source">show source</a> ]</p>
  <div id="M002803_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 129</span>
129:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_natural_assignment_to_nil_with_primary_key</span>
130:     <span class="ruby-identifier">client</span> = <span class="ruby-constant">Client</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Primary key client&quot;</span>, <span class="ruby-identifier">:firm_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">name</span>)
131:     <span class="ruby-identifier">client</span>.<span class="ruby-identifier">firm_with_primary_key</span> = <span class="ruby-keyword kw">nil</span>
132:     <span class="ruby-identifier">client</span>.<span class="ruby-identifier">save</span>
133:     <span class="ruby-identifier">assert_nil</span> <span class="ruby-identifier">client</span>.<span class="ruby-identifier">firm_with_primary_key</span>(<span class="ruby-keyword kw">true</span>)
134:     <span class="ruby-identifier">assert_nil</span> <span class="ruby-identifier">client</span>.<span class="ruby-identifier">client_of</span>
135:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002795" class="method">
  <div id="M002795_title" class="title">
    <b>test_natural_assignment_with_primary_key</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002795_source')" id="l_M002795_source">show source</a> ]</p>
  <div id="M002795_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 62</span>
62:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_natural_assignment_with_primary_key</span>
63:     <span class="ruby-identifier">apple</span> = <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Apple&quot;</span>)
64:     <span class="ruby-identifier">citibank</span> = <span class="ruby-constant">Client</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Primary key client&quot;</span>)
65:     <span class="ruby-identifier">citibank</span>.<span class="ruby-identifier">firm_with_primary_key</span> = <span class="ruby-identifier">apple</span>
66:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">apple</span>.<span class="ruby-identifier">name</span>, <span class="ruby-identifier">citibank</span>.<span class="ruby-identifier">firm_name</span>
67:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002817" class="method">
  <div id="M002817_title" class="title">
    <b>test_new_record_with_foreign_key_but_no_object</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002817_source')" id="l_M002817_source">show source</a> ]</p>
  <div id="M002817_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 289</span>
289:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_new_record_with_foreign_key_but_no_object</span>
290:     <span class="ruby-identifier">c</span> = <span class="ruby-constant">Client</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;firm_id&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>)
291:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-constant">Firm</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>), <span class="ruby-identifier">c</span>.<span class="ruby-identifier">firm_with_basic_id</span>
292:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002797" class="method">
  <div id="M002797_title" class="title">
    <b>test_no_unexpected_aliasing</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002797_source')" id="l_M002797_source">show source</a> ]</p>
  <div id="M002797_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 76</span>
76:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_no_unexpected_aliasing</span>
77:     <span class="ruby-identifier">first_firm</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>)
78:     <span class="ruby-identifier">another_firm</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:another_firm</span>)
79: 
80:     <span class="ruby-identifier">citibank</span> = <span class="ruby-constant">Account</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;credit_limit&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">10</span>)
81:     <span class="ruby-identifier">citibank</span>.<span class="ruby-identifier">firm</span> = <span class="ruby-identifier">first_firm</span>
82:     <span class="ruby-identifier">original_proxy</span> = <span class="ruby-identifier">citibank</span>.<span class="ruby-identifier">firm</span>
83:     <span class="ruby-identifier">citibank</span>.<span class="ruby-identifier">firm</span> = <span class="ruby-identifier">another_firm</span>
84: 
85:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">first_firm</span>.<span class="ruby-identifier">object_id</span>, <span class="ruby-identifier">original_proxy</span>.<span class="ruby-identifier">target</span>.<span class="ruby-identifier">object_id</span>
86:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">another_firm</span>.<span class="ruby-identifier">object_id</span>, <span class="ruby-identifier">citibank</span>.<span class="ruby-identifier">firm</span>.<span class="ruby-identifier">target</span>.<span class="ruby-identifier">object_id</span>
87:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002824" class="method">
  <div id="M002824_title" class="title">
    <b>test_polymorphic_assignment_foreign_type_field_updating</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002824_source')" id="l_M002824_source">show source</a> ]</p>
  <div id="M002824_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 361</span>
361:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_polymorphic_assignment_foreign_type_field_updating</span>
362:     <span class="ruby-comment cmt"># should update when assigning a saved record</span>
363:     <span class="ruby-identifier">sponsor</span> = <span class="ruby-constant">Sponsor</span>.<span class="ruby-identifier">new</span>
364:     <span class="ruby-identifier">member</span> = <span class="ruby-constant">Member</span>.<span class="ruby-identifier">create</span>
365:     <span class="ruby-identifier">sponsor</span>.<span class="ruby-identifier">sponsorable</span> = <span class="ruby-identifier">member</span>
366:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;Member&quot;</span>, <span class="ruby-identifier">sponsor</span>.<span class="ruby-identifier">sponsorable_type</span>
367: 
368:     <span class="ruby-comment cmt"># should update when assigning a new record</span>
369:     <span class="ruby-identifier">sponsor</span> = <span class="ruby-constant">Sponsor</span>.<span class="ruby-identifier">new</span>
370:     <span class="ruby-identifier">member</span> = <span class="ruby-constant">Member</span>.<span class="ruby-identifier">new</span>
371:     <span class="ruby-identifier">sponsor</span>.<span class="ruby-identifier">sponsorable</span> = <span class="ruby-identifier">member</span>
372:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;Member&quot;</span>, <span class="ruby-identifier">sponsor</span>.<span class="ruby-identifier">sponsorable_type</span>
373:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002826" class="method">
  <div id="M002826_title" class="title">
    <b>test_polymorphic_assignment_updates_foreign_id_field_for_new_and_saved_records</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002826_source')" id="l_M002826_source">show source</a> ]</p>
  <div id="M002826_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 389</span>
389:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_polymorphic_assignment_updates_foreign_id_field_for_new_and_saved_records</span>
390:     <span class="ruby-identifier">sponsor</span> = <span class="ruby-constant">Sponsor</span>.<span class="ruby-identifier">new</span>
391:     <span class="ruby-identifier">saved_member</span> = <span class="ruby-constant">Member</span>.<span class="ruby-identifier">create</span>
392:     <span class="ruby-identifier">new_member</span> = <span class="ruby-constant">Member</span>.<span class="ruby-identifier">new</span>
393: 
394:     <span class="ruby-identifier">sponsor</span>.<span class="ruby-identifier">sponsorable</span> = <span class="ruby-identifier">saved_member</span>
395:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">saved_member</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">sponsor</span>.<span class="ruby-identifier">sponsorable_id</span>
396: 
397:     <span class="ruby-identifier">sponsor</span>.<span class="ruby-identifier">sponsorable</span> = <span class="ruby-identifier">new_member</span>
398:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">sponsor</span>.<span class="ruby-identifier">sponsorable_id</span>
399:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002825" class="method">
  <div id="M002825_title" class="title">
    <b>test_polymorphic_assignment_with_primary_key_foreign_type_field_updating</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002825_source')" id="l_M002825_source">show source</a> ]</p>
  <div id="M002825_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 375</span>
375:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_polymorphic_assignment_with_primary_key_foreign_type_field_updating</span>
376:     <span class="ruby-comment cmt"># should update when assigning a saved record</span>
377:     <span class="ruby-identifier">essay</span> = <span class="ruby-constant">Essay</span>.<span class="ruby-identifier">new</span>
378:     <span class="ruby-identifier">writer</span> = <span class="ruby-constant">Author</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;David&quot;</span>)
379:     <span class="ruby-identifier">essay</span>.<span class="ruby-identifier">writer</span> = <span class="ruby-identifier">writer</span>
380:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;Author&quot;</span>, <span class="ruby-identifier">essay</span>.<span class="ruby-identifier">writer_type</span>
381: 
382:     <span class="ruby-comment cmt"># should update when assigning a new record</span>
383:     <span class="ruby-identifier">essay</span> = <span class="ruby-constant">Essay</span>.<span class="ruby-identifier">new</span>
384:     <span class="ruby-identifier">writer</span> = <span class="ruby-constant">Author</span>.<span class="ruby-identifier">new</span>
385:     <span class="ruby-identifier">essay</span>.<span class="ruby-identifier">writer</span> = <span class="ruby-identifier">writer</span>
386:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;Author&quot;</span>, <span class="ruby-identifier">essay</span>.<span class="ruby-identifier">writer_type</span>
387:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002827" class="method">
  <div id="M002827_title" class="title">
    <b>test_polymorphic_assignment_with_primary_key_updates_foreign_id_field_for_new_and_saved_records</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002827_source')" id="l_M002827_source">show source</a> ]</p>
  <div id="M002827_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 401</span>
401:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_polymorphic_assignment_with_primary_key_updates_foreign_id_field_for_new_and_saved_records</span>
402:     <span class="ruby-identifier">essay</span> = <span class="ruby-constant">Essay</span>.<span class="ruby-identifier">new</span>
403:     <span class="ruby-identifier">saved_writer</span> = <span class="ruby-constant">Author</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;David&quot;</span>)
404:     <span class="ruby-identifier">new_writer</span> = <span class="ruby-constant">Author</span>.<span class="ruby-identifier">new</span>
405: 
406:     <span class="ruby-identifier">essay</span>.<span class="ruby-identifier">writer</span> = <span class="ruby-identifier">saved_writer</span>
407:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">saved_writer</span>.<span class="ruby-identifier">name</span>, <span class="ruby-identifier">essay</span>.<span class="ruby-identifier">writer_id</span>
408: 
409:     <span class="ruby-identifier">essay</span>.<span class="ruby-identifier">writer</span> = <span class="ruby-identifier">new_writer</span>
410:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">essay</span>.<span class="ruby-identifier">writer_id</span>
411:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002791" class="method">
  <div id="M002791_title" class="title">
    <b>test_proxy_assignment</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002791_source')" id="l_M002791_source">show source</a> ]</p>
  <div id="M002791_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 40</span>
40:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_proxy_assignment</span>
41:     <span class="ruby-identifier">account</span> = <span class="ruby-constant">Account</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">1</span>)
42:     <span class="ruby-identifier">assert_nothing_raised</span> { <span class="ruby-identifier">account</span>.<span class="ruby-identifier">firm</span> = <span class="ruby-identifier">account</span>.<span class="ruby-identifier">firm</span> }
43:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002830" class="method">
  <div id="M002830_title" class="title">
    <b>test_save_of_record_with_loaded_belongs_to</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002830_source')" id="l_M002830_source">show source</a> ]</p>
  <div id="M002830_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 423</span>
423:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_save_of_record_with_loaded_belongs_to</span>
424:     <span class="ruby-ivar">@account</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-identifier">:first_firm</span>).<span class="ruby-identifier">account</span>
425: 
426:     <span class="ruby-identifier">assert_nothing_raised</span> <span class="ruby-keyword kw">do</span>
427:       <span class="ruby-constant">Account</span>.<span class="ruby-identifier">find</span>(<span class="ruby-ivar">@account</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">save!</span>
428:       <span class="ruby-constant">Account</span>.<span class="ruby-identifier">find</span>(<span class="ruby-ivar">@account</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">:include</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:firm</span>).<span class="ruby-identifier">save!</span>
429:     <span class="ruby-keyword kw">end</span>
430: 
431:     <span class="ruby-ivar">@account</span>.<span class="ruby-identifier">firm</span>.<span class="ruby-identifier">delete</span>
432: 
433:     <span class="ruby-identifier">assert_nothing_raised</span> <span class="ruby-keyword kw">do</span>
434:       <span class="ruby-constant">Account</span>.<span class="ruby-identifier">find</span>(<span class="ruby-ivar">@account</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">save!</span>
435:       <span class="ruby-constant">Account</span>.<span class="ruby-identifier">find</span>(<span class="ruby-ivar">@account</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">:include</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:firm</span>).<span class="ruby-identifier">save!</span>
436:     <span class="ruby-keyword kw">end</span>
437:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002792" class="method">
  <div id="M002792_title" class="title">
    <b>test_triple_equality</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002792_source')" id="l_M002792_source">show source</a> ]</p>
  <div id="M002792_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 45</span>
45:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_triple_equality</span>
46:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">Client</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">3</span>).<span class="ruby-identifier">firm</span> <span class="ruby-operator">===</span> <span class="ruby-constant">Firm</span>
47:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">Firm</span> <span class="ruby-operator">===</span> <span class="ruby-constant">Client</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">3</span>).<span class="ruby-identifier">firm</span>
48:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002793" class="method">
  <div id="M002793_title" class="title">
    <b>test_type_mismatch</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002793_source')" id="l_M002793_source">show source</a> ]</p>
  <div id="M002793_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 50</span>
50:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_type_mismatch</span>
51:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">AssociationTypeMismatch</span>) { <span class="ruby-constant">Account</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">1</span>).<span class="ruby-identifier">firm</span> = <span class="ruby-value">1</span> }
52:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">AssociationTypeMismatch</span>) { <span class="ruby-constant">Account</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">1</span>).<span class="ruby-identifier">firm</span> = <span class="ruby-constant">Project</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">1</span>) }
53:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002805" class="method">
  <div id="M002805_title" class="title">
    <b>test_with_condition</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002805_source')" id="l_M002805_source">show source</a> ]</p>
  <div id="M002805_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 142</span>
142:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_with_condition</span>
143:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-constant">Company</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">1</span>).<span class="ruby-identifier">name</span>, <span class="ruby-constant">Company</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">3</span>).<span class="ruby-identifier">firm_with_condition</span>.<span class="ruby-identifier">name</span>
144:     <span class="ruby-identifier">assert_not_nil</span> <span class="ruby-constant">Company</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">3</span>).<span class="ruby-identifier">firm_with_condition</span>, <span class="ruby-value str">&quot;Microsoft should have a firm&quot;</span>
145:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002804" class="method">
  <div id="M002804_title" class="title">
    <b>test_with_different_class_name</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002804_source')" id="l_M002804_source">show source</a> ]</p>
  <div id="M002804_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 137</span>
137:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_with_different_class_name</span>
138:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-constant">Company</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">1</span>).<span class="ruby-identifier">name</span>, <span class="ruby-constant">Company</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">3</span>).<span class="ruby-identifier">firm_with_other_name</span>.<span class="ruby-identifier">name</span>
139:     <span class="ruby-identifier">assert_not_nil</span> <span class="ruby-constant">Company</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">3</span>).<span class="ruby-identifier">firm_with_other_name</span>, <span class="ruby-value str">&quot;Microsoft should have a firm&quot;</span>
140:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002806" class="method">
  <div id="M002806_title" class="title">
    <b>test_with_select</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002806_source')" id="l_M002806_source">show source</a> ]</p>
  <div id="M002806_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/associations/belongs_to_associations_test.rb, line 147</span>
147:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_with_select</span>
148:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-constant">Company</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">2</span>).<span class="ruby-identifier">firm_with_select</span>.<span class="ruby-identifier">attributes</span>.<span class="ruby-identifier">size</span>, <span class="ruby-value">1</span>
149:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-constant">Company</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">2</span>, <span class="ruby-identifier">:include</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:firm_with_select</span> ).<span class="ruby-identifier">firm_with_select</span>.<span class="ruby-identifier">attributes</span>.<span class="ruby-identifier">size</span>, <span class="ruby-value">1</span>
150:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
</div>

  </div>