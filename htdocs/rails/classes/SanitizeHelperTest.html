  <div id="C00000921">
<div class='banner'>
  <span class="file-title-prefix">Class</span><br />SanitizeHelperTest<br/>
  In:
<a href="#" onclick="jsHref('files/actionpack/test/template/sanitize_helper_test_rb.html');">actionpack/test/template/sanitize_helper_test.rb</a>

Parent:&nbsp;
ActionView::TestCase
</div>
 <!-- banner header -->

  <div id="bodyContent" >
      <div id="content">

  <div class="description"><p>
The exhaustive tests are in test/controller/html/sanitizer_test.rb. This
tests the that the helpers hook up correctly to the sanitizer classes.
</p>
</div>



  <div class="sectiontitle">Methods</div>
  <ul>
  <li><a href="index.html?a=M006468&name=assert_sanitized" >assert_sanitized</a></li>
  <li><a href="index.html?a=M006465&name=test_sanitize_form" >test_sanitize_form</a></li>
  <li><a href="index.html?a=M006466&name=test_should_sanitize_illegal_style_properties" >test_should_sanitize_illegal_style_properties</a></li>
  <li><a href="index.html?a=M006464&name=test_strip_links" >test_strip_links</a></li>
  <li><a href="index.html?a=M006467&name=test_strip_tags" >test_strip_tags</a></li>
  </ul>

<div class="sectiontitle">Included Modules</div>
<ul>
  <li><a href="#" onclick="jsHref('classes/TestingSandbox.html');">TestingSandbox</a></li>
</ul>





<div class="sectiontitle">Public Instance methods</div>
<div id="M006468" class="method">
  <div id="M006468_title" class="title">
    <b>assert_sanitized</b>(text, expected = nil)
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006468_source')" id="l_M006468_source">show source</a> ]</p>
  <div id="M006468_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/template/sanitize_helper_test.rb, line 45</span>
45:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">assert_sanitized</span>(<span class="ruby-identifier">text</span>, <span class="ruby-identifier">expected</span> = <span class="ruby-keyword kw">nil</span>)
46:     <span class="ruby-identifier">assert_equal</span>((<span class="ruby-identifier">expected</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">text</span>), <span class="ruby-identifier">sanitize</span>(<span class="ruby-identifier">text</span>))
47:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006465" class="method">
  <div id="M006465_title" class="title">
    <b>test_sanitize_form</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006465_source')" id="l_M006465_source">show source</a> ]</p>
  <div id="M006465_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/template/sanitize_helper_test.rb, line 21</span>
21:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_sanitize_form</span>
22:     <span class="ruby-identifier">assert_sanitized</span> <span class="ruby-value str">&quot;&lt;form action=\&quot;/foo/bar\&quot; method=\&quot;post\&quot;&gt;&lt;input&gt;&lt;/form&gt;&quot;</span>, <span class="ruby-value str">''</span>
23:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006466" class="method">
  <div id="M006466_title" class="title">
    <b>test_should_sanitize_illegal_style_properties</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006466_source')" id="l_M006466_source">show source</a> ]</p>
  <div id="M006466_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/template/sanitize_helper_test.rb, line 25</span>
25:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_sanitize_illegal_style_properties</span>
26:     <span class="ruby-identifier">raw</span>      = <span class="ruby-value str">%(display:block; position:absolute; left:0; top:0; width:100%; height:100%; z-index:1; background-color:black; background-image:url(http://www.ragingplatypus.com/i/cam-full.jpg); background-x:center; background-y:center; background-repeat:repeat;)</span>
27:     <span class="ruby-identifier">expected</span> = <span class="ruby-value str">%(display: block; width: 100%; height: 100%; background-color: black; background-image: ; background-x: center; background-y: center;)</span>
28:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">expected</span>, <span class="ruby-identifier">sanitize_css</span>(<span class="ruby-identifier">raw</span>)
29:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006464" class="method">
  <div id="M006464_title" class="title">
    <b>test_strip_links</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006464_source')" id="l_M006464_source">show source</a> ]</p>
  <div id="M006464_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/template/sanitize_helper_test.rb, line 10</span>
10:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_strip_links</span>
11:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;Dont touch me&quot;</span>, <span class="ruby-identifier">strip_links</span>(<span class="ruby-value str">&quot;Dont touch me&quot;</span>)
12:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;&lt;a&lt;a&quot;</span>, <span class="ruby-identifier">strip_links</span>(<span class="ruby-value str">&quot;&lt;a&lt;a&quot;</span>)
13:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;on my mind\nall day long&quot;</span>, <span class="ruby-identifier">strip_links</span>(<span class="ruby-value str">&quot;&lt;a href='almost'&gt;on my mind&lt;/a&gt;\n&lt;A href='almost'&gt;all day long&lt;/A&gt;&quot;</span>)
14:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;0wn3d&quot;</span>, <span class="ruby-identifier">strip_links</span>(<span class="ruby-value str">&quot;&lt;a href='http://www.rubyonrails.com/'&gt;&lt;a href='http://www.rubyonrails.com/' onlclick='steal()'&gt;0wn3d&lt;/a&gt;&lt;/a&gt;&quot;</span>)
15:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;Magic&quot;</span>, <span class="ruby-identifier">strip_links</span>(<span class="ruby-value str">&quot;&lt;a href='http://www.rubyonrails.com/'&gt;Mag&lt;a href='http://www.ruby-lang.org/'&gt;ic&quot;</span>)
16:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;FrrFox&quot;</span>, <span class="ruby-identifier">strip_links</span>(<span class="ruby-value str">&quot;&lt;href onlclick='steal()'&gt;FrrFox&lt;/a&gt;&lt;/href&gt;&quot;</span>)
17:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;My mind\nall &lt;b&gt;day&lt;/b&gt; long&quot;</span>, <span class="ruby-identifier">strip_links</span>(<span class="ruby-value str">&quot;&lt;a href='almost'&gt;My mind&lt;/a&gt;\n&lt;A href='almost'&gt;all &lt;b&gt;day&lt;/b&gt; long&lt;/A&gt;&quot;</span>)
18:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;all &lt;b&gt;day&lt;/b&gt; long&quot;</span>, <span class="ruby-identifier">strip_links</span>(<span class="ruby-value str">&quot;&lt;&lt;a&gt;a href='hello'&gt;all &lt;b&gt;day&lt;/b&gt; long&lt;&lt;/A&gt;/a&gt;&quot;</span>)
19:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006467" class="method">
  <div id="M006467_title" class="title">
    <b>test_strip_tags</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006467_source')" id="l_M006467_source">show source</a> ]</p>
  <div id="M006467_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/template/sanitize_helper_test.rb, line 31</span>
31:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_strip_tags</span>
32:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;&lt;&lt;bad html&quot;</span>, <span class="ruby-identifier">strip_tags</span>(<span class="ruby-value str">&quot;&lt;&lt;&lt;bad html&quot;</span>))
33:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;&lt;&quot;</span>, <span class="ruby-identifier">strip_tags</span>(<span class="ruby-value str">&quot;&lt;&lt;&lt;bad html&gt;&quot;</span>))
34:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;Dont touch me&quot;</span>, <span class="ruby-identifier">strip_tags</span>(<span class="ruby-value str">&quot;Dont touch me&quot;</span>))
35:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;This is a test.&quot;</span>, <span class="ruby-identifier">strip_tags</span>(<span class="ruby-value str">&quot;&lt;p&gt;This &lt;u&gt;is&lt;u&gt; a &lt;a href='test.html'&gt;&lt;strong&gt;test&lt;/strong&gt;&lt;/a&gt;.&lt;/p&gt;&quot;</span>))
36:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;Weirdos&quot;</span>, <span class="ruby-identifier">strip_tags</span>(<span class="ruby-value str">&quot;Wei&lt;&lt;a&gt;a onclick='alert(document.cookie);'&lt;/a&gt;/&gt;rdos&quot;</span>))
37:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;This is a test.&quot;</span>, <span class="ruby-identifier">strip_tags</span>(<span class="ruby-value str">&quot;This is a test.&quot;</span>))
38:     <span class="ruby-identifier">assert_equal</span>(
39:     <span class="ruby-value str">%{This is a test.\n\n\nIt no longer contains any HTML.\n}</span>, <span class="ruby-identifier">strip_tags</span>(
40:     <span class="ruby-value str">%{&lt;title&gt;This is &lt;b&gt;a &lt;a href=&quot;&quot; target=&quot;_blank&quot;&gt;test&lt;/a&gt;&lt;/b&gt;.&lt;/title&gt;\n\n&lt;!-- it has a comment --&gt;\n\n&lt;p&gt;It no &lt;b&gt;longer &lt;strong&gt;contains &lt;em&gt;any &lt;strike&gt;HTML&lt;/strike&gt;&lt;/em&gt;.&lt;/strong&gt;&lt;/b&gt;&lt;/p&gt;\n}</span>))
41:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;This has a  here.&quot;</span>, <span class="ruby-identifier">strip_tags</span>(<span class="ruby-value str">&quot;This has a &lt;!-- comment --&gt; here.&quot;</span>)
42:     [<span class="ruby-keyword kw">nil</span>, <span class="ruby-value str">''</span>, <span class="ruby-value str">'   '</span>].<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">blank</span><span class="ruby-operator">|</span> <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">blank</span>, <span class="ruby-identifier">strip_tags</span>(<span class="ruby-identifier">blank</span>) }
43:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
</div>

  </div>