  <div id="C00000794">
<div class='banner'>
  <span class="file-title-prefix">Class</span><br />SanitizerTest<br/>
  In:
<a href="#" onclick="jsHref('files/actionpack/test/controller/html-scanner/sanitizer_test_rb.html');">actionpack/test/controller/html-scanner/sanitizer_test.rb</a>

Parent:&nbsp;
ActionController::TestCase
</div>
 <!-- banner header -->

  <div id="bodyContent" >
      <div id="content">




  <div class="sectiontitle">Methods</div>
  <ul>
  <li><a href="index.html?a=M005315&name=assert_sanitized" >assert_sanitized</a></li>
  <li><a href="index.html?a=M005316&name=sanitize_css" >sanitize_css</a></li>
  <li><a href="index.html?a=M005274&name=setup" >setup</a></li>
  <li><a href="index.html?a=M005284&name=test_allow_colons_in_path_component" >test_allow_colons_in_path_component</a></li>
  <li><a href="index.html?a=M005277&name=test_sanitize_form" >test_sanitize_form</a></li>
  <li><a href="index.html?a=M005282&name=test_sanitize_image_src" >test_sanitize_image_src</a></li>
  <li><a href="index.html?a=M005281&name=test_sanitize_javascript_href" >test_sanitize_javascript_href</a></li>
  <li><a href="index.html?a=M005280&name=test_sanitize_js_handlers" >test_sanitize_js_handlers</a></li>
  <li><a href="index.html?a=M005278&name=test_sanitize_plaintext" >test_sanitize_plaintext</a></li>
  <li><a href="index.html?a=M005279&name=test_sanitize_script" >test_sanitize_script</a></li>
  <li><a href="index.html?a=M005292&name=test_should_accept_good_protocols" >test_should_accept_good_protocols</a></li>
  <li><a href="index.html?a=M005283&name=test_should_allow_anchors" >test_should_allow_anchors</a></li>
  <li><a href="index.html?a=M005287&name=test_should_allow_custom_tags" >test_should_allow_custom_tags</a></li>
  <li><a href="index.html?a=M005289&name=test_should_allow_custom_tags_with_attributes" >test_should_allow_custom_tags_with_attributes</a></li>
  <li><a href="index.html?a=M005290&name=test_should_allow_custom_tags_with_custom_attributes" >test_should_allow_custom_tags_with_custom_attributes</a></li>
  <li><a href="index.html?a=M005288&name=test_should_allow_only_custom_tags" >test_should_allow_only_custom_tags</a></li>
  <li><a href="index.html?a=M005294&name=test_should_block_script_tag" >test_should_block_script_tag</a></li>
  <li><a href="index.html?a=M005291&name=test_should_flag_bad_protocols" >test_should_flag_bad_protocols</a></li>
  <li><a href="index.html?a=M005286&name=test_should_handle_blank_text" >test_should_handle_blank_text</a></li>
  <li><a href="index.html?a=M005285&name=test_should_handle_non_html" >test_should_handle_non_html</a></li>
  <li><a href="index.html?a=M005300&name=test_should_not_fall_for_ridiculous_hack" >test_should_not_fall_for_ridiculous_hack</a></li>
  <li><a href="index.html?a=M005314&name=test_should_not_mangle_urls_with_ampersand" >test_should_not_mangle_urls_with_ampersand</a></li>
  <li><a href="index.html?a=M005293&name=test_should_reject_hex_codes_in_protocol" >test_should_reject_hex_codes_in_protocol</a></li>
  <li><a href="index.html?a=M005301&name=test_should_sanitize_attributes" >test_should_sanitize_attributes</a></li>
  <li><a href="index.html?a=M005312&name=test_should_sanitize_cdata_section" >test_should_sanitize_cdata_section</a></li>
  <li><a href="index.html?a=M005309&name=test_should_sanitize_div_background_image_unicode_encoded" >test_should_sanitize_div_background_image_unicode_encoded</a></li>
  <li><a href="index.html?a=M005310&name=test_should_sanitize_div_style_expression" >test_should_sanitize_div_style_expression</a></li>
  <li><a href="index.html?a=M005299&name=test_should_sanitize_half_open_scripts" >test_should_sanitize_half_open_scripts</a></li>
  <li><a href="index.html?a=M005302&name=test_should_sanitize_illegal_style_properties" >test_should_sanitize_illegal_style_properties</a></li>
  <li><a href="index.html?a=M005308&name=test_should_sanitize_img_dynsrc_lowsrc" >test_should_sanitize_img_dynsrc_lowsrc</a></li>
  <li><a href="index.html?a=M005311&name=test_should_sanitize_img_vbscript" >test_should_sanitize_img_vbscript</a></li>
  <li><a href="index.html?a=M005296&name=test_should_sanitize_invalid_script_tag" >test_should_sanitize_invalid_script_tag</a></li>
  <li><a href="index.html?a=M005305&name=test_should_sanitize_invalid_tag_names" >test_should_sanitize_invalid_tag_names</a></li>
  <li><a href="index.html?a=M005307&name=test_should_sanitize_invalid_tag_names_in_single_tags" >test_should_sanitize_invalid_tag_names_in_single_tags</a></li>
  <li><a href="index.html?a=M005306&name=test_should_sanitize_non_alpha_and_non_digit_characters_in_tags" >test_should_sanitize_non_alpha_and_non_digit_characters_in_tags</a></li>
  <li><a href="index.html?a=M005297&name=test_should_sanitize_script_tag_with_multiple_open_brackets" >test_should_sanitize_script_tag_with_multiple_open_brackets</a></li>
  <li><a href="index.html?a=M005295&name=test_should_sanitize_tag_broken_up_by_null" >test_should_sanitize_tag_broken_up_by_null</a></li>
  <li><a href="index.html?a=M005298&name=test_should_sanitize_unclosed_script" >test_should_sanitize_unclosed_script</a></li>
  <li><a href="index.html?a=M005313&name=test_should_sanitize_unterminated_cdata_section" >test_should_sanitize_unterminated_cdata_section</a></li>
  <li><a href="index.html?a=M005303&name=test_should_sanitize_with_trailing_space" >test_should_sanitize_with_trailing_space</a></li>
  <li><a href="index.html?a=M005304&name=test_should_sanitize_xul_style_attributes" >test_should_sanitize_xul_style_attributes</a></li>
  <li><a href="index.html?a=M005276&name=test_strip_links" >test_strip_links</a></li>
  <li><a href="index.html?a=M005275&name=test_strip_tags" >test_strip_tags</a></li>
  </ul>






<div class="sectiontitle">Public Instance methods</div>
<div id="M005274" class="method">
  <div id="M005274_title" class="title">
    <b>setup</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005274_source')" id="l_M005274_source">show source</a> ]</p>
  <div id="M005274_source" class="dyn-source">
<pre>
   <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 4</span>
4:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">setup</span>
5:     <span class="ruby-ivar">@sanitizer</span> = <span class="ruby-keyword kw">nil</span> <span class="ruby-comment cmt"># used by assert_sanitizer</span>
6:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005284" class="method">
  <div id="M005284_title" class="title">
    <b>test_allow_colons_in_path_component</b>()
  </div>
  <div class="description">
  <p>
RFC 3986, sec 4.2
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005284_source')" id="l_M005284_source">show source</a> ]</p>
  <div id="M005284_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 78</span>
78:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_allow_colons_in_path_component</span>
79:     <span class="ruby-identifier">assert_sanitized</span>(<span class="ruby-value str">&quot;&lt;a href=\&quot;./this:that\&quot;&gt;foo&lt;/a&gt;&quot;</span>)
80:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005277" class="method">
  <div id="M005277_title" class="title">
    <b>test_sanitize_form</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005277_source')" id="l_M005277_source">show source</a> ]</p>
  <div id="M005277_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 38</span>
38:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_sanitize_form</span>
39:     <span class="ruby-identifier">assert_sanitized</span> <span class="ruby-value str">&quot;&lt;form action=\&quot;/foo/bar\&quot; method=\&quot;post\&quot;&gt;&lt;input&gt;&lt;/form&gt;&quot;</span>, <span class="ruby-value str">''</span>
40:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005282" class="method">
  <div id="M005282_title" class="title">
    <b>test_sanitize_image_src</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005282_source')" id="l_M005282_source">show source</a> ]</p>
  <div id="M005282_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 62</span>
62:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_sanitize_image_src</span>
63:     <span class="ruby-identifier">raw</span> = <span class="ruby-value str">%{src=&quot;javascript:bang&quot; &lt;img src=&quot;javascript:bang&quot; width=&quot;5&quot;&gt;foo&lt;/img&gt;, &lt;span src=&quot;javascript:bang&quot;&gt;bar&lt;/span&gt;}</span>
64:     <span class="ruby-identifier">assert_sanitized</span> <span class="ruby-identifier">raw</span>, <span class="ruby-value str">%{src=&quot;javascript:bang&quot; &lt;img width=&quot;5&quot;&gt;foo&lt;/img&gt;, &lt;span&gt;bar&lt;/span&gt;}</span>
65:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005281" class="method">
  <div id="M005281_title" class="title">
    <b>test_sanitize_javascript_href</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005281_source')" id="l_M005281_source">show source</a> ]</p>
  <div id="M005281_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 57</span>
57:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_sanitize_javascript_href</span>
58:     <span class="ruby-identifier">raw</span> = <span class="ruby-value str">%{href=&quot;javascript:bang&quot; &lt;a href=&quot;javascript:bang&quot; name=&quot;hello&quot;&gt;foo&lt;/a&gt;, &lt;span href=&quot;javascript:bang&quot;&gt;bar&lt;/span&gt;}</span>
59:     <span class="ruby-identifier">assert_sanitized</span> <span class="ruby-identifier">raw</span>, <span class="ruby-value str">%{href=&quot;javascript:bang&quot; &lt;a name=&quot;hello&quot;&gt;foo&lt;/a&gt;, &lt;span&gt;bar&lt;/span&gt;}</span>
60:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005280" class="method">
  <div id="M005280_title" class="title">
    <b>test_sanitize_js_handlers</b>()
  </div>
  <div class="description">
  <p>
fucked
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005280_source')" id="l_M005280_source">show source</a> ]</p>
  <div id="M005280_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 52</span>
52:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_sanitize_js_handlers</span>
53:     <span class="ruby-identifier">raw</span> = <span class="ruby-value str">%{onthis=&quot;do that&quot; &lt;a href=&quot;#&quot; onclick=&quot;hello&quot; name=&quot;foo&quot; onbogus=&quot;remove me&quot;&gt;hello&lt;/a&gt;}</span>
54:     <span class="ruby-identifier">assert_sanitized</span> <span class="ruby-identifier">raw</span>, <span class="ruby-value str">%{onthis=&quot;do that&quot; &lt;a name=&quot;foo&quot; href=&quot;#&quot;&gt;hello&lt;/a&gt;}</span>
55:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005278" class="method">
  <div id="M005278_title" class="title">
    <b>test_sanitize_plaintext</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005278_source')" id="l_M005278_source">show source</a> ]</p>
  <div id="M005278_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 42</span>
42:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_sanitize_plaintext</span>
43:     <span class="ruby-identifier">raw</span> = <span class="ruby-value str">&quot;&lt;plaintext&gt;&lt;span&gt;foo&lt;/span&gt;&lt;/plaintext&gt;&quot;</span>
44:     <span class="ruby-identifier">assert_sanitized</span> <span class="ruby-identifier">raw</span>, <span class="ruby-value str">&quot;&lt;span&gt;foo&lt;/span&gt;&quot;</span>
45:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005279" class="method">
  <div id="M005279_title" class="title">
    <b>test_sanitize_script</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005279_source')" id="l_M005279_source">show source</a> ]</p>
  <div id="M005279_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 47</span>
47:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_sanitize_script</span>
48:     <span class="ruby-identifier">assert_sanitized</span> <span class="ruby-value str">&quot;a b c&lt;script language=\&quot;Javascript\&quot;&gt;blah blah blah&lt;/script&gt;d e f&quot;</span>, <span class="ruby-value str">&quot;a b cd e f&quot;</span>
49:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005292" class="method">
  <div id="M005292_title" class="title">
    <b>test_should_accept_good_protocols</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005292_source')" id="l_M005292_source">show source</a> ]</p>
  <div id="M005292_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 134</span>
134:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_accept_good_protocols</span>
135:     <span class="ruby-identifier">sanitizer</span> = <span class="ruby-constant">HTML</span><span class="ruby-operator">::</span><span class="ruby-constant">WhiteListSanitizer</span>.<span class="ruby-identifier">new</span>
136:     <span class="ruby-constant">HTML</span><span class="ruby-operator">::</span><span class="ruby-constant">WhiteListSanitizer</span>.<span class="ruby-identifier">allowed_protocols</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">proto</span><span class="ruby-operator">|</span>
137:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">sanitizer</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:contains_bad_protocols?</span>, <span class="ruby-value str">'src'</span>, <span class="ruby-node">&quot;#{proto}://good&quot;</span>)
138:     <span class="ruby-keyword kw">end</span>
139:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005283" class="method">
  <div id="M005283_title" class="title">
    <b>test_should_allow_anchors</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005283_source')" id="l_M005283_source">show source</a> ]</p>
  <div id="M005283_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 73</span>
73:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_allow_anchors</span>
74:     <span class="ruby-identifier">assert_sanitized</span> <span class="ruby-value str">%(&lt;a href=&quot;foo&quot; onclick=&quot;bar&quot;&gt;&lt;script&gt;baz&lt;/script&gt;&lt;/a&gt;)</span>, <span class="ruby-value str">%(&lt;a href=&quot;foo&quot;&gt;&lt;/a&gt;)</span>
75:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005287" class="method">
  <div id="M005287_title" class="title">
    <b>test_should_allow_custom_tags</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005287_source')" id="l_M005287_source">show source</a> ]</p>
  <div id="M005287_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 97</span>
 97:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_allow_custom_tags</span>
 98:     <span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;&lt;u&gt;foo&lt;/u&gt;&quot;</span>
 99:     <span class="ruby-identifier">sanitizer</span> = <span class="ruby-constant">HTML</span><span class="ruby-operator">::</span><span class="ruby-constant">WhiteListSanitizer</span>.<span class="ruby-identifier">new</span>
100:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-identifier">text</span>, <span class="ruby-identifier">sanitizer</span>.<span class="ruby-identifier">sanitize</span>(<span class="ruby-identifier">text</span>, <span class="ruby-identifier">:tags</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">%w(u)</span>))
101:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005289" class="method">
  <div id="M005289_title" class="title">
    <b>test_should_allow_custom_tags_with_attributes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005289_source')" id="l_M005289_source">show source</a> ]</p>
  <div id="M005289_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 109</span>
109:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_allow_custom_tags_with_attributes</span>
110:     <span class="ruby-identifier">text</span> = <span class="ruby-value str">%(&lt;blockquote cite=&quot;http://example.com/&quot;&gt;foo&lt;/blockquote&gt;)</span>
111:     <span class="ruby-identifier">sanitizer</span> = <span class="ruby-constant">HTML</span><span class="ruby-operator">::</span><span class="ruby-constant">WhiteListSanitizer</span>.<span class="ruby-identifier">new</span>
112:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-identifier">text</span>, <span class="ruby-identifier">sanitizer</span>.<span class="ruby-identifier">sanitize</span>(<span class="ruby-identifier">text</span>))
113:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005290" class="method">
  <div id="M005290_title" class="title">
    <b>test_should_allow_custom_tags_with_custom_attributes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005290_source')" id="l_M005290_source">show source</a> ]</p>
  <div id="M005290_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 115</span>
115:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_allow_custom_tags_with_custom_attributes</span>
116:     <span class="ruby-identifier">text</span> = <span class="ruby-value str">%(&lt;blockquote foo=&quot;bar&quot;&gt;Lorem ipsum&lt;/blockquote&gt;)</span>
117:     <span class="ruby-identifier">sanitizer</span> = <span class="ruby-constant">HTML</span><span class="ruby-operator">::</span><span class="ruby-constant">WhiteListSanitizer</span>.<span class="ruby-identifier">new</span>
118:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-identifier">text</span>, <span class="ruby-identifier">sanitizer</span>.<span class="ruby-identifier">sanitize</span>(<span class="ruby-identifier">text</span>, <span class="ruby-identifier">:attributes</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">'foo'</span>]))
119:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005288" class="method">
  <div id="M005288_title" class="title">
    <b>test_should_allow_only_custom_tags</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005288_source')" id="l_M005288_source">show source</a> ]</p>
  <div id="M005288_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 103</span>
103:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_allow_only_custom_tags</span>
104:     <span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;&lt;u&gt;foo&lt;/u&gt; with &lt;i&gt;bar&lt;/i&gt;&quot;</span>
105:     <span class="ruby-identifier">sanitizer</span> = <span class="ruby-constant">HTML</span><span class="ruby-operator">::</span><span class="ruby-constant">WhiteListSanitizer</span>.<span class="ruby-identifier">new</span>
106:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;u&gt;foo&lt;/u&gt; with bar&quot;</span>, <span class="ruby-identifier">sanitizer</span>.<span class="ruby-identifier">sanitize</span>(<span class="ruby-identifier">text</span>, <span class="ruby-identifier">:tags</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">%w(u)</span>))
107:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005294" class="method">
  <div id="M005294_title" class="title">
    <b>test_should_block_script_tag</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005294_source')" id="l_M005294_source">show source</a> ]</p>
  <div id="M005294_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 146</span>
146:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_block_script_tag</span>
147:     <span class="ruby-identifier">assert_sanitized</span> <span class="ruby-value str">%(&lt;SCRIPT\nSRC=http://ha.ckers.org/xss.js&gt;&lt;/SCRIPT&gt;)</span>, <span class="ruby-value str">&quot;&quot;</span>
148:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005291" class="method">
  <div id="M005291_title" class="title">
    <b>test_should_flag_bad_protocols</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005291_source')" id="l_M005291_source">show source</a> ]</p>
  <div id="M005291_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 127</span>
127:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_flag_bad_protocols</span>
128:     <span class="ruby-identifier">sanitizer</span> = <span class="ruby-constant">HTML</span><span class="ruby-operator">::</span><span class="ruby-constant">WhiteListSanitizer</span>.<span class="ruby-identifier">new</span>
129:     <span class="ruby-node">%w(about chrome data disk hcp help javascript livescript lynxcgi lynxexec ms-help ms-its mhtml mocha opera res resource shell vbscript view-source vnd.ms.radio wysiwyg)</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">proto</span><span class="ruby-operator">|</span>
130:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">sanitizer</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:contains_bad_protocols?</span>, <span class="ruby-value str">'src'</span>, <span class="ruby-node">&quot;#{proto}://bad&quot;</span>)
131:     <span class="ruby-keyword kw">end</span>
132:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005286" class="method">
  <div id="M005286_title" class="title">
    <b>test_should_handle_blank_text</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005286_source')" id="l_M005286_source">show source</a> ]</p>
  <div id="M005286_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 92</span>
92:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_handle_blank_text</span>
93:     <span class="ruby-identifier">assert_sanitized</span> <span class="ruby-keyword kw">nil</span>
94:     <span class="ruby-identifier">assert_sanitized</span> <span class="ruby-value str">''</span>
95:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005285" class="method">
  <div id="M005285_title" class="title">
    <b>test_should_handle_non_html</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005285_source')" id="l_M005285_source">show source</a> ]</p>
  <div id="M005285_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 88</span>
88:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_handle_non_html</span>
89:     <span class="ruby-identifier">assert_sanitized</span> <span class="ruby-value str">'abc'</span>
90:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005300" class="method">
  <div id="M005300_title" class="title">
    <b>test_should_not_fall_for_ridiculous_hack</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005300_source')" id="l_M005300_source">show source</a> ]</p>
  <div id="M005300_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 191</span>
191:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_not_fall_for_ridiculous_hack</span>
192:     <span class="ruby-identifier">img_hack</span> = <span class="ruby-value str">%(&lt;IMG\nSRC\n=\n&quot;\nj\na\nv\na\ns\nc\nr\ni\np\nt\n:\na\nl\ne\nr\nt\n(\n'\nX\nS\nS\n'\n)\n&quot;\n&gt;)</span>
193:     <span class="ruby-identifier">assert_sanitized</span> <span class="ruby-identifier">img_hack</span>, <span class="ruby-value str">&quot;&lt;img&gt;&quot;</span>
194:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005314" class="method">
  <div id="M005314_title" class="title">
    <b>test_should_not_mangle_urls_with_ampersand</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005314_source')" id="l_M005314_source">show source</a> ]</p>
  <div id="M005314_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 256</span>
256:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_not_mangle_urls_with_ampersand</span>
257:      <span class="ruby-identifier">assert_sanitized</span> <span class="ruby-value str">%{&lt;a href=\&quot;http://www.domain.com?var1=1&amp;amp;var2=2\&quot;&gt;my link&lt;/a&gt;}</span>
258:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005293" class="method">
  <div id="M005293_title" class="title">
    <b>test_should_reject_hex_codes_in_protocol</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005293_source')" id="l_M005293_source">show source</a> ]</p>
  <div id="M005293_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 141</span>
141:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_reject_hex_codes_in_protocol</span>
142:     <span class="ruby-identifier">assert_sanitized</span> <span class="ruby-value str">%(&lt;a href=&quot;&amp;#37;6A&amp;#37;61&amp;#37;76&amp;#37;61&amp;#37;73&amp;#37;63&amp;#37;72&amp;#37;69&amp;#37;70&amp;#37;74&amp;#37;3A&amp;#37;61&amp;#37;6C&amp;#37;65&amp;#37;72&amp;#37;74&amp;#37;28&amp;#37;22&amp;#37;58&amp;#37;53&amp;#37;53&amp;#37;22&amp;#37;29&quot;&gt;1&lt;/a&gt;)</span>, <span class="ruby-value str">&quot;&lt;a&gt;1&lt;/a&gt;&quot;</span>
143:     <span class="ruby-identifier">assert</span> <span class="ruby-ivar">@sanitizer</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:contains_bad_protocols?</span>, <span class="ruby-value str">'src'</span>, <span class="ruby-value str">&quot;%6A%61%76%61%73%63%72%69%70%74%3A%61%6C%65%72%74%28%22%58%53%53%22%29&quot;</span>)
144:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005301" class="method">
  <div id="M005301_title" class="title">
    <b>test_should_sanitize_attributes</b>()
  </div>
  <div class="description">
  <p>
fucked
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005301_source')" id="l_M005301_source">show source</a> ]</p>
  <div id="M005301_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 197</span>
197:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_sanitize_attributes</span>
198:     <span class="ruby-identifier">assert_sanitized</span> <span class="ruby-value str">%(&lt;SPAN title=&quot;'&gt;&lt;script&gt;alert()&lt;/script&gt;&quot;&gt;blah&lt;/SPAN&gt;)</span>, <span class="ruby-value str">%(&lt;span title=&quot;'&amp;gt;&amp;lt;script&amp;gt;alert()&amp;lt;/script&amp;gt;&quot;&gt;blah&lt;/span&gt;)</span>
199:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005312" class="method">
  <div id="M005312_title" class="title">
    <b>test_should_sanitize_cdata_section</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005312_source')" id="l_M005312_source">show source</a> ]</p>
  <div id="M005312_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 248</span>
248:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_sanitize_cdata_section</span>
249:     <span class="ruby-identifier">assert_sanitized</span> <span class="ruby-value str">&quot;&lt;![CDATA[&lt;span&gt;section&lt;/span&gt;]]&gt;&quot;</span>, <span class="ruby-value str">&quot;&amp;lt;![CDATA[&amp;lt;span&gt;section&amp;lt;/span&gt;]]&gt;&quot;</span>
250:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005309" class="method">
  <div id="M005309_title" class="title">
    <b>test_should_sanitize_div_background_image_unicode_encoded</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005309_source')" id="l_M005309_source">show source</a> ]</p>
  <div id="M005309_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 234</span>
234:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_sanitize_div_background_image_unicode_encoded</span>
235:     <span class="ruby-identifier">raw</span> = <span class="ruby-value str">%(background-image:\0075\0072\006C\0028'\006a\0061\0076\0061\0073\0063\0072\0069\0070\0074\003a\0061\006c\0065\0072\0074\0028.1027\0058.1053\0053\0027\0029'\0029)</span>
236:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">''</span>, <span class="ruby-identifier">sanitize_css</span>(<span class="ruby-identifier">raw</span>)
237:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005310" class="method">
  <div id="M005310_title" class="title">
    <b>test_should_sanitize_div_style_expression</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005310_source')" id="l_M005310_source">show source</a> ]</p>
  <div id="M005310_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 239</span>
239:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_sanitize_div_style_expression</span>
240:     <span class="ruby-identifier">raw</span> = <span class="ruby-value str">%(width: expression(alert('XSS'));)</span>
241:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">''</span>, <span class="ruby-identifier">sanitize_css</span>(<span class="ruby-identifier">raw</span>)
242:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005299" class="method">
  <div id="M005299_title" class="title">
    <b>test_should_sanitize_half_open_scripts</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005299_source')" id="l_M005299_source">show source</a> ]</p>
  <div id="M005299_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 187</span>
187:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_sanitize_half_open_scripts</span>
188:     <span class="ruby-identifier">assert_sanitized</span> <span class="ruby-value str">%(&lt;IMG SRC=&quot;javascript:alert('XSS')&quot;)</span>, <span class="ruby-value str">&quot;&lt;img&gt;&quot;</span>
189:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005302" class="method">
  <div id="M005302_title" class="title">
    <b>test_should_sanitize_illegal_style_properties</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005302_source')" id="l_M005302_source">show source</a> ]</p>
  <div id="M005302_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 201</span>
201:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_sanitize_illegal_style_properties</span>
202:     <span class="ruby-identifier">raw</span>      = <span class="ruby-value str">%(display:block; position:absolute; left:0; top:0; width:100%; height:100%; z-index:1; background-color:black; background-image:url(http://www.ragingplatypus.com/i/cam-full.jpg); background-x:center; background-y:center; background-repeat:repeat;)</span>
203:     <span class="ruby-identifier">expected</span> = <span class="ruby-value str">%(display: block; width: 100%; height: 100%; background-color: black; background-image: ; background-x: center; background-y: center;)</span>
204:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">expected</span>, <span class="ruby-identifier">sanitize_css</span>(<span class="ruby-identifier">raw</span>)
205:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005308" class="method">
  <div id="M005308_title" class="title">
    <b>test_should_sanitize_img_dynsrc_lowsrc</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005308_source')" id="l_M005308_source">show source</a> ]</p>
  <div id="M005308_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 230</span>
230:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_sanitize_img_dynsrc_lowsrc</span>
231:     <span class="ruby-identifier">assert_sanitized</span>(<span class="ruby-value str">%(&lt;img lowsrc=&quot;javascript:alert('XSS')&quot; /&gt;)</span>, <span class="ruby-value str">&quot;&lt;img /&gt;&quot;</span>)
232:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005311" class="method">
  <div id="M005311_title" class="title">
    <b>test_should_sanitize_img_vbscript</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005311_source')" id="l_M005311_source">show source</a> ]</p>
  <div id="M005311_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 244</span>
244:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_sanitize_img_vbscript</span>
245:     <span class="ruby-identifier">assert_sanitized</span> <span class="ruby-value str">%(&lt;img src='vbscript:msgbox(&quot;XSS&quot;)' /&gt;)</span>, <span class="ruby-value str">'&lt;img /&gt;'</span>
246:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005296" class="method">
  <div id="M005296_title" class="title">
    <b>test_should_sanitize_invalid_script_tag</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005296_source')" id="l_M005296_source">show source</a> ]</p>
  <div id="M005296_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 174</span>
174:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_sanitize_invalid_script_tag</span>
175:     <span class="ruby-identifier">assert_sanitized</span> <span class="ruby-value str">%(&lt;SCRIPT/XSS SRC=&quot;http://ha.ckers.org/xss.js&quot;&gt;&lt;/SCRIPT&gt;)</span>, <span class="ruby-value str">&quot;&quot;</span>
176:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005305" class="method">
  <div id="M005305_title" class="title">
    <b>test_should_sanitize_invalid_tag_names</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005305_source')" id="l_M005305_source">show source</a> ]</p>
  <div id="M005305_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 218</span>
218:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_sanitize_invalid_tag_names</span>
219:     <span class="ruby-identifier">assert_sanitized</span>(<span class="ruby-value str">%(a b c&lt;script/XSS src=&quot;http://ha.ckers.org/xss.js&quot;&gt;&lt;/script&gt;d e f)</span>, <span class="ruby-value str">&quot;a b cd e f&quot;</span>)
220:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005307" class="method">
  <div id="M005307_title" class="title">
    <b>test_should_sanitize_invalid_tag_names_in_single_tags</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005307_source')" id="l_M005307_source">show source</a> ]</p>
  <div id="M005307_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 226</span>
226:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_sanitize_invalid_tag_names_in_single_tags</span>
227:     <span class="ruby-identifier">assert_sanitized</span>(<span class="ruby-value str">'&lt;img/src=&quot;http://ha.ckers.org/xss.js&quot;/&gt;'</span>, <span class="ruby-value str">&quot;&lt;img /&gt;&quot;</span>)
228:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005306" class="method">
  <div id="M005306_title" class="title">
    <b>test_should_sanitize_non_alpha_and_non_digit_characters_in_tags</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005306_source')" id="l_M005306_source">show source</a> ]</p>
  <div id="M005306_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 222</span>
222:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_sanitize_non_alpha_and_non_digit_characters_in_tags</span>
223:     <span class="ruby-identifier">assert_sanitized</span>(<span class="ruby-value str">'&lt;a onclick!#$%&amp;()*~+-_.,:;?@[/|\]^`=alert(&quot;XSS&quot;)&gt;foo&lt;/a&gt;'</span>, <span class="ruby-value str">&quot;&lt;a&gt;foo&lt;/a&gt;&quot;</span>)
224:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005297" class="method">
  <div id="M005297_title" class="title">
    <b>test_should_sanitize_script_tag_with_multiple_open_brackets</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005297_source')" id="l_M005297_source">show source</a> ]</p>
  <div id="M005297_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 178</span>
178:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_sanitize_script_tag_with_multiple_open_brackets</span>
179:     <span class="ruby-identifier">assert_sanitized</span> <span class="ruby-value str">%(&lt;&lt;SCRIPT&gt;alert(&quot;XSS&quot;);//&lt;&lt;/SCRIPT&gt;)</span>, <span class="ruby-value str">&quot;&amp;lt;&quot;</span>
180:     <span class="ruby-identifier">assert_sanitized</span> <span class="ruby-value str">%(&lt;iframe src=http://ha.ckers.org/scriptlet.html\n&lt;a)</span>, <span class="ruby-value str">%(&amp;lt;a)</span>
181:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005295" class="method">
  <div id="M005295_title" class="title">
    <b>test_should_sanitize_tag_broken_up_by_null</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005295_source')" id="l_M005295_source">show source</a> ]</p>
  <div id="M005295_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 170</span>
170:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_sanitize_tag_broken_up_by_null</span>
171:     <span class="ruby-identifier">assert_sanitized</span> <span class="ruby-value str">%(&lt;SCR\0IPT&gt;alert(\&quot;XSS\&quot;)&lt;/SCR\0IPT&gt;)</span>, <span class="ruby-value str">&quot;alert(\&quot;XSS\&quot;)&quot;</span>
172:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005298" class="method">
  <div id="M005298_title" class="title">
    <b>test_should_sanitize_unclosed_script</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005298_source')" id="l_M005298_source">show source</a> ]</p>
  <div id="M005298_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 183</span>
183:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_sanitize_unclosed_script</span>
184:     <span class="ruby-identifier">assert_sanitized</span> <span class="ruby-value str">%(&lt;SCRIPT SRC=http://ha.ckers.org/xss.js?&lt;B&gt;)</span>, <span class="ruby-value str">&quot;&lt;b&gt;&quot;</span>
185:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005313" class="method">
  <div id="M005313_title" class="title">
    <b>test_should_sanitize_unterminated_cdata_section</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005313_source')" id="l_M005313_source">show source</a> ]</p>
  <div id="M005313_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 252</span>
252:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_sanitize_unterminated_cdata_section</span>
253:     <span class="ruby-identifier">assert_sanitized</span> <span class="ruby-value str">&quot;&lt;![CDATA[&lt;span&gt;neverending...&quot;</span>, <span class="ruby-value str">&quot;&amp;lt;![CDATA[&amp;lt;span&gt;neverending...]]&gt;&quot;</span>
254:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005303" class="method">
  <div id="M005303_title" class="title">
    <b>test_should_sanitize_with_trailing_space</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005303_source')" id="l_M005303_source">show source</a> ]</p>
  <div id="M005303_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 207</span>
207:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_sanitize_with_trailing_space</span>
208:     <span class="ruby-identifier">raw</span> = <span class="ruby-value str">&quot;display:block; &quot;</span>
209:     <span class="ruby-identifier">expected</span> = <span class="ruby-value str">&quot;display: block;&quot;</span>
210:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">expected</span>, <span class="ruby-identifier">sanitize_css</span>(<span class="ruby-identifier">raw</span>)
211:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005304" class="method">
  <div id="M005304_title" class="title">
    <b>test_should_sanitize_xul_style_attributes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005304_source')" id="l_M005304_source">show source</a> ]</p>
  <div id="M005304_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 213</span>
213:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_sanitize_xul_style_attributes</span>
214:     <span class="ruby-identifier">raw</span> = <span class="ruby-value str">%(-moz-binding:url('http://ha.ckers.org/xssmoz.xml#xss'))</span>
215:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">''</span>, <span class="ruby-identifier">sanitize_css</span>(<span class="ruby-identifier">raw</span>)
216:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005276" class="method">
  <div id="M005276_title" class="title">
    <b>test_strip_links</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005276_source')" id="l_M005276_source">show source</a> ]</p>
  <div id="M005276_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 25</span>
25:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_strip_links</span>
26:     <span class="ruby-identifier">sanitizer</span> = <span class="ruby-constant">HTML</span><span class="ruby-operator">::</span><span class="ruby-constant">LinkSanitizer</span>.<span class="ruby-identifier">new</span>
27:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;Dont touch me&quot;</span>, <span class="ruby-identifier">sanitizer</span>.<span class="ruby-identifier">sanitize</span>(<span class="ruby-value str">&quot;Dont touch me&quot;</span>)    
28:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;on my mind\nall day long&quot;</span>, <span class="ruby-identifier">sanitizer</span>.<span class="ruby-identifier">sanitize</span>(<span class="ruby-value str">&quot;&lt;a href='almost'&gt;on my mind&lt;/a&gt;\n&lt;A href='almost'&gt;all day long&lt;/A&gt;&quot;</span>)
29:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;0wn3d&quot;</span>, <span class="ruby-identifier">sanitizer</span>.<span class="ruby-identifier">sanitize</span>(<span class="ruby-value str">&quot;&lt;a href='http://www.rubyonrails.com/'&gt;&lt;a href='http://www.rubyonrails.com/' onlclick='steal()'&gt;0wn3d&lt;/a&gt;&lt;/a&gt;&quot;</span>) 
30:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;Magic&quot;</span>, <span class="ruby-identifier">sanitizer</span>.<span class="ruby-identifier">sanitize</span>(<span class="ruby-value str">&quot;&lt;a href='http://www.rubyonrails.com/'&gt;Mag&lt;a href='http://www.ruby-lang.org/'&gt;ic&quot;</span>) 
31:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;FrrFox&quot;</span>, <span class="ruby-identifier">sanitizer</span>.<span class="ruby-identifier">sanitize</span>(<span class="ruby-value str">&quot;&lt;href onlclick='steal()'&gt;FrrFox&lt;/a&gt;&lt;/href&gt;&quot;</span>) 
32:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;My mind\nall &lt;b&gt;day&lt;/b&gt; long&quot;</span>, <span class="ruby-identifier">sanitizer</span>.<span class="ruby-identifier">sanitize</span>(<span class="ruby-value str">&quot;&lt;a href='almost'&gt;My mind&lt;/a&gt;\n&lt;A href='almost'&gt;all &lt;b&gt;day&lt;/b&gt; long&lt;/A&gt;&quot;</span>)
33:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;all &lt;b&gt;day&lt;/b&gt; long&quot;</span>, <span class="ruby-identifier">sanitizer</span>.<span class="ruby-identifier">sanitize</span>(<span class="ruby-value str">&quot;&lt;&lt;a&gt;a href='hello'&gt;all &lt;b&gt;day&lt;/b&gt; long&lt;&lt;/A&gt;/a&gt;&quot;</span>)
34: 
35:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;&lt;a&lt;a&quot;</span>, <span class="ruby-identifier">sanitizer</span>.<span class="ruby-identifier">sanitize</span>(<span class="ruby-value str">&quot;&lt;a&lt;a&quot;</span>)
36:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005275" class="method">
  <div id="M005275_title" class="title">
    <b>test_strip_tags</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005275_source')" id="l_M005275_source">show source</a> ]</p>
  <div id="M005275_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 8</span>
 8:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_strip_tags</span>
 9:     <span class="ruby-identifier">sanitizer</span> = <span class="ruby-constant">HTML</span><span class="ruby-operator">::</span><span class="ruby-constant">FullSanitizer</span>.<span class="ruby-identifier">new</span>
10:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;&lt;&lt;bad html&quot;</span>, <span class="ruby-identifier">sanitizer</span>.<span class="ruby-identifier">sanitize</span>(<span class="ruby-value str">&quot;&lt;&lt;&lt;bad html&quot;</span>))
11:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;&lt;&quot;</span>, <span class="ruby-identifier">sanitizer</span>.<span class="ruby-identifier">sanitize</span>(<span class="ruby-value str">&quot;&lt;&lt;&lt;bad html&gt;&quot;</span>))
12:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;Dont touch me&quot;</span>, <span class="ruby-identifier">sanitizer</span>.<span class="ruby-identifier">sanitize</span>(<span class="ruby-value str">&quot;Dont touch me&quot;</span>))
13:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;This is a test.&quot;</span>, <span class="ruby-identifier">sanitizer</span>.<span class="ruby-identifier">sanitize</span>(<span class="ruby-value str">&quot;&lt;p&gt;This &lt;u&gt;is&lt;u&gt; a &lt;a href='test.html'&gt;&lt;strong&gt;test&lt;/strong&gt;&lt;/a&gt;.&lt;/p&gt;&quot;</span>))
14:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;Weirdos&quot;</span>, <span class="ruby-identifier">sanitizer</span>.<span class="ruby-identifier">sanitize</span>(<span class="ruby-value str">&quot;Wei&lt;&lt;a&gt;a onclick='alert(document.cookie);'&lt;/a&gt;/&gt;rdos&quot;</span>))
15:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;This is a test.&quot;</span>, <span class="ruby-identifier">sanitizer</span>.<span class="ruby-identifier">sanitize</span>(<span class="ruby-value str">&quot;This is a test.&quot;</span>))
16:     <span class="ruby-identifier">assert_equal</span>(
17:     <span class="ruby-value str">%{This is a test.\n\n\nIt no longer contains any HTML.\n}</span>, <span class="ruby-identifier">sanitizer</span>.<span class="ruby-identifier">sanitize</span>(
18:     <span class="ruby-value str">%{&lt;title&gt;This is &lt;b&gt;a &lt;a href=&quot;&quot; target=&quot;_blank&quot;&gt;test&lt;/a&gt;&lt;/b&gt;.&lt;/title&gt;\n\n&lt;!-- it has a comment --&gt;\n\n&lt;p&gt;It no &lt;b&gt;longer &lt;strong&gt;contains &lt;em&gt;any &lt;strike&gt;HTML&lt;/strike&gt;&lt;/em&gt;.&lt;/strong&gt;&lt;/b&gt;&lt;/p&gt;\n}</span>))
19:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;This has a  here.&quot;</span>, <span class="ruby-identifier">sanitizer</span>.<span class="ruby-identifier">sanitize</span>(<span class="ruby-value str">&quot;This has a &lt;!-- comment --&gt; here.&quot;</span>)
20:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;This has a  here.&quot;</span>, <span class="ruby-identifier">sanitizer</span>.<span class="ruby-identifier">sanitize</span>(<span class="ruby-value str">&quot;This has a &lt;![CDATA[&lt;section&gt;]]&gt; here.&quot;</span>)
21:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;This has an unclosed &quot;</span>, <span class="ruby-identifier">sanitizer</span>.<span class="ruby-identifier">sanitize</span>(<span class="ruby-value str">&quot;This has an unclosed &lt;![CDATA[&lt;section&gt;]] here...&quot;</span>)
22:     [<span class="ruby-keyword kw">nil</span>, <span class="ruby-value str">''</span>, <span class="ruby-value str">'   '</span>].<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">blank</span><span class="ruby-operator">|</span> <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">blank</span>, <span class="ruby-identifier">sanitizer</span>.<span class="ruby-identifier">sanitize</span>(<span class="ruby-identifier">blank</span>) }
23:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div class="sectiontitle">Protected Instance methods</div>
<div id="M005315" class="method">
  <div id="M005315_title" class="title">
    <b>assert_sanitized</b>(input, expected = nil)
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005315_source')" id="l_M005315_source">show source</a> ]</p>
  <div id="M005315_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 261</span>
261:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">assert_sanitized</span>(<span class="ruby-identifier">input</span>, <span class="ruby-identifier">expected</span> = <span class="ruby-keyword kw">nil</span>)
262:     <span class="ruby-ivar">@sanitizer</span> <span class="ruby-operator">||=</span> <span class="ruby-constant">HTML</span><span class="ruby-operator">::</span><span class="ruby-constant">WhiteListSanitizer</span>.<span class="ruby-identifier">new</span>
263:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">input</span>
264:       <span class="ruby-identifier">assert_dom_equal</span> <span class="ruby-identifier">expected</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">input</span>, <span class="ruby-ivar">@sanitizer</span>.<span class="ruby-identifier">sanitize</span>(<span class="ruby-identifier">input</span>)
265:     <span class="ruby-keyword kw">else</span>
266:       <span class="ruby-identifier">assert_nil</span> <span class="ruby-ivar">@sanitizer</span>.<span class="ruby-identifier">sanitize</span>(<span class="ruby-identifier">input</span>)
267:     <span class="ruby-keyword kw">end</span>
268:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005316" class="method">
  <div id="M005316_title" class="title">
    <b>sanitize_css</b>(input)
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005316_source')" id="l_M005316_source">show source</a> ]</p>
  <div id="M005316_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 270</span>
270:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">sanitize_css</span>(<span class="ruby-identifier">input</span>)
271:     (<span class="ruby-ivar">@sanitizer</span> <span class="ruby-operator">||=</span> <span class="ruby-constant">HTML</span><span class="ruby-operator">::</span><span class="ruby-constant">WhiteListSanitizer</span>.<span class="ruby-identifier">new</span>).<span class="ruby-identifier">sanitize_css</span>(<span class="ruby-identifier">input</span>)
272:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
</div>

  </div>