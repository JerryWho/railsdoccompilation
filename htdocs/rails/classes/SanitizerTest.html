  <div id="C00000804">
<div class='banner'>
  <span class="file-title-prefix">Class</span><br />SanitizerTest<br/>
  In:
<a href="#" onclick="jsHref('files/actionpack/test/controller/html-scanner/sanitizer_test_rb.html');">actionpack/test/controller/html-scanner/sanitizer_test.rb</a>

Parent:&nbsp;
ActionController::TestCase
</div>
 <!-- banner header -->

  <div id="bodyContent" >
      <div id="content">




  <div class="sectiontitle">Methods</div>
  <ul>
  <li><a href="index.html?a=M005353&name=assert_sanitized" >assert_sanitized</a></li>
  <li><a href="index.html?a=M005354&name=sanitize_css" >sanitize_css</a></li>
  <li><a href="index.html?a=M005312&name=setup" >setup</a></li>
  <li><a href="index.html?a=M005322&name=test_allow_colons_in_path_component" >test_allow_colons_in_path_component</a></li>
  <li><a href="index.html?a=M005315&name=test_sanitize_form" >test_sanitize_form</a></li>
  <li><a href="index.html?a=M005320&name=test_sanitize_image_src" >test_sanitize_image_src</a></li>
  <li><a href="index.html?a=M005319&name=test_sanitize_javascript_href" >test_sanitize_javascript_href</a></li>
  <li><a href="index.html?a=M005318&name=test_sanitize_js_handlers" >test_sanitize_js_handlers</a></li>
  <li><a href="index.html?a=M005316&name=test_sanitize_plaintext" >test_sanitize_plaintext</a></li>
  <li><a href="index.html?a=M005317&name=test_sanitize_script" >test_sanitize_script</a></li>
  <li><a href="index.html?a=M005330&name=test_should_accept_good_protocols" >test_should_accept_good_protocols</a></li>
  <li><a href="index.html?a=M005321&name=test_should_allow_anchors" >test_should_allow_anchors</a></li>
  <li><a href="index.html?a=M005325&name=test_should_allow_custom_tags" >test_should_allow_custom_tags</a></li>
  <li><a href="index.html?a=M005327&name=test_should_allow_custom_tags_with_attributes" >test_should_allow_custom_tags_with_attributes</a></li>
  <li><a href="index.html?a=M005328&name=test_should_allow_custom_tags_with_custom_attributes" >test_should_allow_custom_tags_with_custom_attributes</a></li>
  <li><a href="index.html?a=M005326&name=test_should_allow_only_custom_tags" >test_should_allow_only_custom_tags</a></li>
  <li><a href="index.html?a=M005332&name=test_should_block_script_tag" >test_should_block_script_tag</a></li>
  <li><a href="index.html?a=M005329&name=test_should_flag_bad_protocols" >test_should_flag_bad_protocols</a></li>
  <li><a href="index.html?a=M005324&name=test_should_handle_blank_text" >test_should_handle_blank_text</a></li>
  <li><a href="index.html?a=M005323&name=test_should_handle_non_html" >test_should_handle_non_html</a></li>
  <li><a href="index.html?a=M005338&name=test_should_not_fall_for_ridiculous_hack" >test_should_not_fall_for_ridiculous_hack</a></li>
  <li><a href="index.html?a=M005352&name=test_should_not_mangle_urls_with_ampersand" >test_should_not_mangle_urls_with_ampersand</a></li>
  <li><a href="index.html?a=M005331&name=test_should_reject_hex_codes_in_protocol" >test_should_reject_hex_codes_in_protocol</a></li>
  <li><a href="index.html?a=M005339&name=test_should_sanitize_attributes" >test_should_sanitize_attributes</a></li>
  <li><a href="index.html?a=M005350&name=test_should_sanitize_cdata_section" >test_should_sanitize_cdata_section</a></li>
  <li><a href="index.html?a=M005347&name=test_should_sanitize_div_background_image_unicode_encoded" >test_should_sanitize_div_background_image_unicode_encoded</a></li>
  <li><a href="index.html?a=M005348&name=test_should_sanitize_div_style_expression" >test_should_sanitize_div_style_expression</a></li>
  <li><a href="index.html?a=M005337&name=test_should_sanitize_half_open_scripts" >test_should_sanitize_half_open_scripts</a></li>
  <li><a href="index.html?a=M005340&name=test_should_sanitize_illegal_style_properties" >test_should_sanitize_illegal_style_properties</a></li>
  <li><a href="index.html?a=M005346&name=test_should_sanitize_img_dynsrc_lowsrc" >test_should_sanitize_img_dynsrc_lowsrc</a></li>
  <li><a href="index.html?a=M005349&name=test_should_sanitize_img_vbscript" >test_should_sanitize_img_vbscript</a></li>
  <li><a href="index.html?a=M005334&name=test_should_sanitize_invalid_script_tag" >test_should_sanitize_invalid_script_tag</a></li>
  <li><a href="index.html?a=M005343&name=test_should_sanitize_invalid_tag_names" >test_should_sanitize_invalid_tag_names</a></li>
  <li><a href="index.html?a=M005345&name=test_should_sanitize_invalid_tag_names_in_single_tags" >test_should_sanitize_invalid_tag_names_in_single_tags</a></li>
  <li><a href="index.html?a=M005344&name=test_should_sanitize_non_alpha_and_non_digit_characters_in_tags" >test_should_sanitize_non_alpha_and_non_digit_characters_in_tags</a></li>
  <li><a href="index.html?a=M005335&name=test_should_sanitize_script_tag_with_multiple_open_brackets" >test_should_sanitize_script_tag_with_multiple_open_brackets</a></li>
  <li><a href="index.html?a=M005333&name=test_should_sanitize_tag_broken_up_by_null" >test_should_sanitize_tag_broken_up_by_null</a></li>
  <li><a href="index.html?a=M005336&name=test_should_sanitize_unclosed_script" >test_should_sanitize_unclosed_script</a></li>
  <li><a href="index.html?a=M005351&name=test_should_sanitize_unterminated_cdata_section" >test_should_sanitize_unterminated_cdata_section</a></li>
  <li><a href="index.html?a=M005341&name=test_should_sanitize_with_trailing_space" >test_should_sanitize_with_trailing_space</a></li>
  <li><a href="index.html?a=M005342&name=test_should_sanitize_xul_style_attributes" >test_should_sanitize_xul_style_attributes</a></li>
  <li><a href="index.html?a=M005314&name=test_strip_links" >test_strip_links</a></li>
  <li><a href="index.html?a=M005313&name=test_strip_tags" >test_strip_tags</a></li>
  </ul>






<div class="sectiontitle">Public Instance methods</div>
<div id="M005312" class="method">
  <div id="M005312_title" class="title">
    <b>setup</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005312_source')" id="l_M005312_source">show source</a> ]</p>
  <div id="M005312_source" class="dyn-source">
<pre>
   <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 4</span>
4:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">setup</span>
5:     <span class="ruby-ivar">@sanitizer</span> = <span class="ruby-keyword kw">nil</span> <span class="ruby-comment cmt"># used by assert_sanitizer</span>
6:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005322" class="method">
  <div id="M005322_title" class="title">
    <b>test_allow_colons_in_path_component</b>()
  </div>
  <div class="description">
  <p>
RFC 3986, sec 4.2
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005322_source')" id="l_M005322_source">show source</a> ]</p>
  <div id="M005322_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 79</span>
79:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_allow_colons_in_path_component</span>
80:     <span class="ruby-identifier">assert_sanitized</span>(<span class="ruby-value str">&quot;&lt;a href=\&quot;./this:that\&quot;&gt;foo&lt;/a&gt;&quot;</span>)
81:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005315" class="method">
  <div id="M005315_title" class="title">
    <b>test_sanitize_form</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005315_source')" id="l_M005315_source">show source</a> ]</p>
  <div id="M005315_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 39</span>
39:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_sanitize_form</span>
40:     <span class="ruby-identifier">assert_sanitized</span> <span class="ruby-value str">&quot;&lt;form action=\&quot;/foo/bar\&quot; method=\&quot;post\&quot;&gt;&lt;input&gt;&lt;/form&gt;&quot;</span>, <span class="ruby-value str">''</span>
41:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005320" class="method">
  <div id="M005320_title" class="title">
    <b>test_sanitize_image_src</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005320_source')" id="l_M005320_source">show source</a> ]</p>
  <div id="M005320_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 63</span>
63:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_sanitize_image_src</span>
64:     <span class="ruby-identifier">raw</span> = <span class="ruby-value str">%{src=&quot;javascript:bang&quot; &lt;img src=&quot;javascript:bang&quot; width=&quot;5&quot;&gt;foo&lt;/img&gt;, &lt;span src=&quot;javascript:bang&quot;&gt;bar&lt;/span&gt;}</span>
65:     <span class="ruby-identifier">assert_sanitized</span> <span class="ruby-identifier">raw</span>, <span class="ruby-value str">%{src=&quot;javascript:bang&quot; &lt;img width=&quot;5&quot;&gt;foo&lt;/img&gt;, &lt;span&gt;bar&lt;/span&gt;}</span>
66:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005319" class="method">
  <div id="M005319_title" class="title">
    <b>test_sanitize_javascript_href</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005319_source')" id="l_M005319_source">show source</a> ]</p>
  <div id="M005319_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 58</span>
58:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_sanitize_javascript_href</span>
59:     <span class="ruby-identifier">raw</span> = <span class="ruby-value str">%{href=&quot;javascript:bang&quot; &lt;a href=&quot;javascript:bang&quot; name=&quot;hello&quot;&gt;foo&lt;/a&gt;, &lt;span href=&quot;javascript:bang&quot;&gt;bar&lt;/span&gt;}</span>
60:     <span class="ruby-identifier">assert_sanitized</span> <span class="ruby-identifier">raw</span>, <span class="ruby-value str">%{href=&quot;javascript:bang&quot; &lt;a name=&quot;hello&quot;&gt;foo&lt;/a&gt;, &lt;span&gt;bar&lt;/span&gt;}</span>
61:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005318" class="method">
  <div id="M005318_title" class="title">
    <b>test_sanitize_js_handlers</b>()
  </div>
  <div class="description">
  <p>
fucked
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005318_source')" id="l_M005318_source">show source</a> ]</p>
  <div id="M005318_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 53</span>
53:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_sanitize_js_handlers</span>
54:     <span class="ruby-identifier">raw</span> = <span class="ruby-value str">%{onthis=&quot;do that&quot; &lt;a href=&quot;#&quot; onclick=&quot;hello&quot; name=&quot;foo&quot; onbogus=&quot;remove me&quot;&gt;hello&lt;/a&gt;}</span>
55:     <span class="ruby-identifier">assert_sanitized</span> <span class="ruby-identifier">raw</span>, <span class="ruby-value str">%{onthis=&quot;do that&quot; &lt;a name=&quot;foo&quot; href=&quot;#&quot;&gt;hello&lt;/a&gt;}</span>
56:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005316" class="method">
  <div id="M005316_title" class="title">
    <b>test_sanitize_plaintext</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005316_source')" id="l_M005316_source">show source</a> ]</p>
  <div id="M005316_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 43</span>
43:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_sanitize_plaintext</span>
44:     <span class="ruby-identifier">raw</span> = <span class="ruby-value str">&quot;&lt;plaintext&gt;&lt;span&gt;foo&lt;/span&gt;&lt;/plaintext&gt;&quot;</span>
45:     <span class="ruby-identifier">assert_sanitized</span> <span class="ruby-identifier">raw</span>, <span class="ruby-value str">&quot;&lt;span&gt;foo&lt;/span&gt;&quot;</span>
46:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005317" class="method">
  <div id="M005317_title" class="title">
    <b>test_sanitize_script</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005317_source')" id="l_M005317_source">show source</a> ]</p>
  <div id="M005317_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 48</span>
48:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_sanitize_script</span>
49:     <span class="ruby-identifier">assert_sanitized</span> <span class="ruby-value str">&quot;a b c&lt;script language=\&quot;Javascript\&quot;&gt;blah blah blah&lt;/script&gt;d e f&quot;</span>, <span class="ruby-value str">&quot;a b cd e f&quot;</span>
50:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005330" class="method">
  <div id="M005330_title" class="title">
    <b>test_should_accept_good_protocols</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005330_source')" id="l_M005330_source">show source</a> ]</p>
  <div id="M005330_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 135</span>
135:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_accept_good_protocols</span>
136:     <span class="ruby-identifier">sanitizer</span> = <span class="ruby-constant">HTML</span><span class="ruby-operator">::</span><span class="ruby-constant">WhiteListSanitizer</span>.<span class="ruby-identifier">new</span>
137:     <span class="ruby-constant">HTML</span><span class="ruby-operator">::</span><span class="ruby-constant">WhiteListSanitizer</span>.<span class="ruby-identifier">allowed_protocols</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">proto</span><span class="ruby-operator">|</span>
138:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">sanitizer</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:contains_bad_protocols?</span>, <span class="ruby-value str">'src'</span>, <span class="ruby-node">&quot;#{proto}://good&quot;</span>)
139:     <span class="ruby-keyword kw">end</span>
140:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005321" class="method">
  <div id="M005321_title" class="title">
    <b>test_should_allow_anchors</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005321_source')" id="l_M005321_source">show source</a> ]</p>
  <div id="M005321_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 74</span>
74:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_allow_anchors</span>
75:     <span class="ruby-identifier">assert_sanitized</span> <span class="ruby-value str">%(&lt;a href=&quot;foo&quot; onclick=&quot;bar&quot;&gt;&lt;script&gt;baz&lt;/script&gt;&lt;/a&gt;)</span>, <span class="ruby-value str">%(&lt;a href=&quot;foo&quot;&gt;&lt;/a&gt;)</span>
76:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005325" class="method">
  <div id="M005325_title" class="title">
    <b>test_should_allow_custom_tags</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005325_source')" id="l_M005325_source">show source</a> ]</p>
  <div id="M005325_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 98</span>
 98:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_allow_custom_tags</span>
 99:     <span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;&lt;u&gt;foo&lt;/u&gt;&quot;</span>
100:     <span class="ruby-identifier">sanitizer</span> = <span class="ruby-constant">HTML</span><span class="ruby-operator">::</span><span class="ruby-constant">WhiteListSanitizer</span>.<span class="ruby-identifier">new</span>
101:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-identifier">text</span>, <span class="ruby-identifier">sanitizer</span>.<span class="ruby-identifier">sanitize</span>(<span class="ruby-identifier">text</span>, <span class="ruby-identifier">:tags</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">%w(u)</span>))
102:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005327" class="method">
  <div id="M005327_title" class="title">
    <b>test_should_allow_custom_tags_with_attributes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005327_source')" id="l_M005327_source">show source</a> ]</p>
  <div id="M005327_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 110</span>
110:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_allow_custom_tags_with_attributes</span>
111:     <span class="ruby-identifier">text</span> = <span class="ruby-value str">%(&lt;blockquote cite=&quot;http://example.com/&quot;&gt;foo&lt;/blockquote&gt;)</span>
112:     <span class="ruby-identifier">sanitizer</span> = <span class="ruby-constant">HTML</span><span class="ruby-operator">::</span><span class="ruby-constant">WhiteListSanitizer</span>.<span class="ruby-identifier">new</span>
113:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-identifier">text</span>, <span class="ruby-identifier">sanitizer</span>.<span class="ruby-identifier">sanitize</span>(<span class="ruby-identifier">text</span>))
114:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005328" class="method">
  <div id="M005328_title" class="title">
    <b>test_should_allow_custom_tags_with_custom_attributes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005328_source')" id="l_M005328_source">show source</a> ]</p>
  <div id="M005328_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 116</span>
116:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_allow_custom_tags_with_custom_attributes</span>
117:     <span class="ruby-identifier">text</span> = <span class="ruby-value str">%(&lt;blockquote foo=&quot;bar&quot;&gt;Lorem ipsum&lt;/blockquote&gt;)</span>
118:     <span class="ruby-identifier">sanitizer</span> = <span class="ruby-constant">HTML</span><span class="ruby-operator">::</span><span class="ruby-constant">WhiteListSanitizer</span>.<span class="ruby-identifier">new</span>
119:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-identifier">text</span>, <span class="ruby-identifier">sanitizer</span>.<span class="ruby-identifier">sanitize</span>(<span class="ruby-identifier">text</span>, <span class="ruby-identifier">:attributes</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">'foo'</span>]))
120:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005326" class="method">
  <div id="M005326_title" class="title">
    <b>test_should_allow_only_custom_tags</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005326_source')" id="l_M005326_source">show source</a> ]</p>
  <div id="M005326_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 104</span>
104:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_allow_only_custom_tags</span>
105:     <span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;&lt;u&gt;foo&lt;/u&gt; with &lt;i&gt;bar&lt;/i&gt;&quot;</span>
106:     <span class="ruby-identifier">sanitizer</span> = <span class="ruby-constant">HTML</span><span class="ruby-operator">::</span><span class="ruby-constant">WhiteListSanitizer</span>.<span class="ruby-identifier">new</span>
107:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;u&gt;foo&lt;/u&gt; with bar&quot;</span>, <span class="ruby-identifier">sanitizer</span>.<span class="ruby-identifier">sanitize</span>(<span class="ruby-identifier">text</span>, <span class="ruby-identifier">:tags</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">%w(u)</span>))
108:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005332" class="method">
  <div id="M005332_title" class="title">
    <b>test_should_block_script_tag</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005332_source')" id="l_M005332_source">show source</a> ]</p>
  <div id="M005332_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 147</span>
147:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_block_script_tag</span>
148:     <span class="ruby-identifier">assert_sanitized</span> <span class="ruby-value str">%(&lt;SCRIPT\nSRC=http://ha.ckers.org/xss.js&gt;&lt;/SCRIPT&gt;)</span>, <span class="ruby-value str">&quot;&quot;</span>
149:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005329" class="method">
  <div id="M005329_title" class="title">
    <b>test_should_flag_bad_protocols</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005329_source')" id="l_M005329_source">show source</a> ]</p>
  <div id="M005329_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 128</span>
128:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_flag_bad_protocols</span>
129:     <span class="ruby-identifier">sanitizer</span> = <span class="ruby-constant">HTML</span><span class="ruby-operator">::</span><span class="ruby-constant">WhiteListSanitizer</span>.<span class="ruby-identifier">new</span>
130:     <span class="ruby-node">%w(about chrome data disk hcp help javascript livescript lynxcgi lynxexec ms-help ms-its mhtml mocha opera res resource shell vbscript view-source vnd.ms.radio wysiwyg)</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">proto</span><span class="ruby-operator">|</span>
131:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">sanitizer</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:contains_bad_protocols?</span>, <span class="ruby-value str">'src'</span>, <span class="ruby-node">&quot;#{proto}://bad&quot;</span>)
132:     <span class="ruby-keyword kw">end</span>
133:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005324" class="method">
  <div id="M005324_title" class="title">
    <b>test_should_handle_blank_text</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005324_source')" id="l_M005324_source">show source</a> ]</p>
  <div id="M005324_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 93</span>
93:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_handle_blank_text</span>
94:     <span class="ruby-identifier">assert_sanitized</span> <span class="ruby-keyword kw">nil</span>
95:     <span class="ruby-identifier">assert_sanitized</span> <span class="ruby-value str">''</span>
96:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005323" class="method">
  <div id="M005323_title" class="title">
    <b>test_should_handle_non_html</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005323_source')" id="l_M005323_source">show source</a> ]</p>
  <div id="M005323_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 89</span>
89:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_handle_non_html</span>
90:     <span class="ruby-identifier">assert_sanitized</span> <span class="ruby-value str">'abc'</span>
91:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005338" class="method">
  <div id="M005338_title" class="title">
    <b>test_should_not_fall_for_ridiculous_hack</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005338_source')" id="l_M005338_source">show source</a> ]</p>
  <div id="M005338_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 192</span>
192:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_not_fall_for_ridiculous_hack</span>
193:     <span class="ruby-identifier">img_hack</span> = <span class="ruby-value str">%(&lt;IMG\nSRC\n=\n&quot;\nj\na\nv\na\ns\nc\nr\ni\np\nt\n:\na\nl\ne\nr\nt\n(\n'\nX\nS\nS\n'\n)\n&quot;\n&gt;)</span>
194:     <span class="ruby-identifier">assert_sanitized</span> <span class="ruby-identifier">img_hack</span>, <span class="ruby-value str">&quot;&lt;img&gt;&quot;</span>
195:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005352" class="method">
  <div id="M005352_title" class="title">
    <b>test_should_not_mangle_urls_with_ampersand</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005352_source')" id="l_M005352_source">show source</a> ]</p>
  <div id="M005352_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 257</span>
257:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_not_mangle_urls_with_ampersand</span>
258:      <span class="ruby-identifier">assert_sanitized</span> <span class="ruby-value str">%{&lt;a href=\&quot;http://www.domain.com?var1=1&amp;amp;var2=2\&quot;&gt;my link&lt;/a&gt;}</span>
259:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005331" class="method">
  <div id="M005331_title" class="title">
    <b>test_should_reject_hex_codes_in_protocol</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005331_source')" id="l_M005331_source">show source</a> ]</p>
  <div id="M005331_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 142</span>
142:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_reject_hex_codes_in_protocol</span>
143:     <span class="ruby-identifier">assert_sanitized</span> <span class="ruby-value str">%(&lt;a href=&quot;&amp;#37;6A&amp;#37;61&amp;#37;76&amp;#37;61&amp;#37;73&amp;#37;63&amp;#37;72&amp;#37;69&amp;#37;70&amp;#37;74&amp;#37;3A&amp;#37;61&amp;#37;6C&amp;#37;65&amp;#37;72&amp;#37;74&amp;#37;28&amp;#37;22&amp;#37;58&amp;#37;53&amp;#37;53&amp;#37;22&amp;#37;29&quot;&gt;1&lt;/a&gt;)</span>, <span class="ruby-value str">&quot;&lt;a&gt;1&lt;/a&gt;&quot;</span>
144:     <span class="ruby-identifier">assert</span> <span class="ruby-ivar">@sanitizer</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:contains_bad_protocols?</span>, <span class="ruby-value str">'src'</span>, <span class="ruby-value str">&quot;%6A%61%76%61%73%63%72%69%70%74%3A%61%6C%65%72%74%28%22%58%53%53%22%29&quot;</span>)
145:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005339" class="method">
  <div id="M005339_title" class="title">
    <b>test_should_sanitize_attributes</b>()
  </div>
  <div class="description">
  <p>
fucked
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005339_source')" id="l_M005339_source">show source</a> ]</p>
  <div id="M005339_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 198</span>
198:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_sanitize_attributes</span>
199:     <span class="ruby-identifier">assert_sanitized</span> <span class="ruby-value str">%(&lt;SPAN title=&quot;'&gt;&lt;script&gt;alert()&lt;/script&gt;&quot;&gt;blah&lt;/SPAN&gt;)</span>, <span class="ruby-value str">%(&lt;span title=&quot;'&amp;gt;&amp;lt;script&amp;gt;alert()&amp;lt;/script&amp;gt;&quot;&gt;blah&lt;/span&gt;)</span>
200:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005350" class="method">
  <div id="M005350_title" class="title">
    <b>test_should_sanitize_cdata_section</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005350_source')" id="l_M005350_source">show source</a> ]</p>
  <div id="M005350_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 249</span>
249:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_sanitize_cdata_section</span>
250:     <span class="ruby-identifier">assert_sanitized</span> <span class="ruby-value str">&quot;&lt;![CDATA[&lt;span&gt;section&lt;/span&gt;]]&gt;&quot;</span>, <span class="ruby-value str">&quot;&amp;lt;![CDATA[&amp;lt;span&gt;section&amp;lt;/span&gt;]]&gt;&quot;</span>
251:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005347" class="method">
  <div id="M005347_title" class="title">
    <b>test_should_sanitize_div_background_image_unicode_encoded</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005347_source')" id="l_M005347_source">show source</a> ]</p>
  <div id="M005347_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 235</span>
235:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_sanitize_div_background_image_unicode_encoded</span>
236:     <span class="ruby-identifier">raw</span> = <span class="ruby-value str">%(background-image:\0075\0072\006C\0028'\006a\0061\0076\0061\0073\0063\0072\0069\0070\0074\003a\0061\006c\0065\0072\0074\0028.1027\0058.1053\0053\0027\0029'\0029)</span>
237:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">''</span>, <span class="ruby-identifier">sanitize_css</span>(<span class="ruby-identifier">raw</span>)
238:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005348" class="method">
  <div id="M005348_title" class="title">
    <b>test_should_sanitize_div_style_expression</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005348_source')" id="l_M005348_source">show source</a> ]</p>
  <div id="M005348_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 240</span>
240:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_sanitize_div_style_expression</span>
241:     <span class="ruby-identifier">raw</span> = <span class="ruby-value str">%(width: expression(alert('XSS'));)</span>
242:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">''</span>, <span class="ruby-identifier">sanitize_css</span>(<span class="ruby-identifier">raw</span>)
243:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005337" class="method">
  <div id="M005337_title" class="title">
    <b>test_should_sanitize_half_open_scripts</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005337_source')" id="l_M005337_source">show source</a> ]</p>
  <div id="M005337_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 188</span>
188:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_sanitize_half_open_scripts</span>
189:     <span class="ruby-identifier">assert_sanitized</span> <span class="ruby-value str">%(&lt;IMG SRC=&quot;javascript:alert('XSS')&quot;)</span>, <span class="ruby-value str">&quot;&lt;img&gt;&quot;</span>
190:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005340" class="method">
  <div id="M005340_title" class="title">
    <b>test_should_sanitize_illegal_style_properties</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005340_source')" id="l_M005340_source">show source</a> ]</p>
  <div id="M005340_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 202</span>
202:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_sanitize_illegal_style_properties</span>
203:     <span class="ruby-identifier">raw</span>      = <span class="ruby-value str">%(display:block; position:absolute; left:0; top:0; width:100%; height:100%; z-index:1; background-color:black; background-image:url(http://www.ragingplatypus.com/i/cam-full.jpg); background-x:center; background-y:center; background-repeat:repeat;)</span>
204:     <span class="ruby-identifier">expected</span> = <span class="ruby-value str">%(display: block; width: 100%; height: 100%; background-color: black; background-image: ; background-x: center; background-y: center;)</span>
205:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">expected</span>, <span class="ruby-identifier">sanitize_css</span>(<span class="ruby-identifier">raw</span>)
206:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005346" class="method">
  <div id="M005346_title" class="title">
    <b>test_should_sanitize_img_dynsrc_lowsrc</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005346_source')" id="l_M005346_source">show source</a> ]</p>
  <div id="M005346_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 231</span>
231:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_sanitize_img_dynsrc_lowsrc</span>
232:     <span class="ruby-identifier">assert_sanitized</span>(<span class="ruby-value str">%(&lt;img lowsrc=&quot;javascript:alert('XSS')&quot; /&gt;)</span>, <span class="ruby-value str">&quot;&lt;img /&gt;&quot;</span>)
233:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005349" class="method">
  <div id="M005349_title" class="title">
    <b>test_should_sanitize_img_vbscript</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005349_source')" id="l_M005349_source">show source</a> ]</p>
  <div id="M005349_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 245</span>
245:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_sanitize_img_vbscript</span>
246:     <span class="ruby-identifier">assert_sanitized</span> <span class="ruby-value str">%(&lt;img src='vbscript:msgbox(&quot;XSS&quot;)' /&gt;)</span>, <span class="ruby-value str">'&lt;img /&gt;'</span>
247:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005334" class="method">
  <div id="M005334_title" class="title">
    <b>test_should_sanitize_invalid_script_tag</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005334_source')" id="l_M005334_source">show source</a> ]</p>
  <div id="M005334_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 175</span>
175:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_sanitize_invalid_script_tag</span>
176:     <span class="ruby-identifier">assert_sanitized</span> <span class="ruby-value str">%(&lt;SCRIPT/XSS SRC=&quot;http://ha.ckers.org/xss.js&quot;&gt;&lt;/SCRIPT&gt;)</span>, <span class="ruby-value str">&quot;&quot;</span>
177:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005343" class="method">
  <div id="M005343_title" class="title">
    <b>test_should_sanitize_invalid_tag_names</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005343_source')" id="l_M005343_source">show source</a> ]</p>
  <div id="M005343_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 219</span>
219:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_sanitize_invalid_tag_names</span>
220:     <span class="ruby-identifier">assert_sanitized</span>(<span class="ruby-value str">%(a b c&lt;script/XSS src=&quot;http://ha.ckers.org/xss.js&quot;&gt;&lt;/script&gt;d e f)</span>, <span class="ruby-value str">&quot;a b cd e f&quot;</span>)
221:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005345" class="method">
  <div id="M005345_title" class="title">
    <b>test_should_sanitize_invalid_tag_names_in_single_tags</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005345_source')" id="l_M005345_source">show source</a> ]</p>
  <div id="M005345_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 227</span>
227:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_sanitize_invalid_tag_names_in_single_tags</span>
228:     <span class="ruby-identifier">assert_sanitized</span>(<span class="ruby-value str">'&lt;img/src=&quot;http://ha.ckers.org/xss.js&quot;/&gt;'</span>, <span class="ruby-value str">&quot;&lt;img /&gt;&quot;</span>)
229:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005344" class="method">
  <div id="M005344_title" class="title">
    <b>test_should_sanitize_non_alpha_and_non_digit_characters_in_tags</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005344_source')" id="l_M005344_source">show source</a> ]</p>
  <div id="M005344_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 223</span>
223:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_sanitize_non_alpha_and_non_digit_characters_in_tags</span>
224:     <span class="ruby-identifier">assert_sanitized</span>(<span class="ruby-value str">'&lt;a onclick!#$%&amp;()*~+-_.,:;?@[/|\]^`=alert(&quot;XSS&quot;)&gt;foo&lt;/a&gt;'</span>, <span class="ruby-value str">&quot;&lt;a&gt;foo&lt;/a&gt;&quot;</span>)
225:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005335" class="method">
  <div id="M005335_title" class="title">
    <b>test_should_sanitize_script_tag_with_multiple_open_brackets</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005335_source')" id="l_M005335_source">show source</a> ]</p>
  <div id="M005335_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 179</span>
179:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_sanitize_script_tag_with_multiple_open_brackets</span>
180:     <span class="ruby-identifier">assert_sanitized</span> <span class="ruby-value str">%(&lt;&lt;SCRIPT&gt;alert(&quot;XSS&quot;);//&lt;&lt;/SCRIPT&gt;)</span>, <span class="ruby-value str">&quot;&amp;lt;&quot;</span>
181:     <span class="ruby-identifier">assert_sanitized</span> <span class="ruby-value str">%(&lt;iframe src=http://ha.ckers.org/scriptlet.html\n&lt;a)</span>, <span class="ruby-value str">%(&amp;lt;a)</span>
182:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005333" class="method">
  <div id="M005333_title" class="title">
    <b>test_should_sanitize_tag_broken_up_by_null</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005333_source')" id="l_M005333_source">show source</a> ]</p>
  <div id="M005333_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 171</span>
171:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_sanitize_tag_broken_up_by_null</span>
172:     <span class="ruby-identifier">assert_sanitized</span> <span class="ruby-value str">%(&lt;SCR\0IPT&gt;alert(\&quot;XSS\&quot;)&lt;/SCR\0IPT&gt;)</span>, <span class="ruby-value str">&quot;alert(\&quot;XSS\&quot;)&quot;</span>
173:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005336" class="method">
  <div id="M005336_title" class="title">
    <b>test_should_sanitize_unclosed_script</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005336_source')" id="l_M005336_source">show source</a> ]</p>
  <div id="M005336_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 184</span>
184:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_sanitize_unclosed_script</span>
185:     <span class="ruby-identifier">assert_sanitized</span> <span class="ruby-value str">%(&lt;SCRIPT SRC=http://ha.ckers.org/xss.js?&lt;B&gt;)</span>, <span class="ruby-value str">&quot;&lt;b&gt;&quot;</span>
186:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005351" class="method">
  <div id="M005351_title" class="title">
    <b>test_should_sanitize_unterminated_cdata_section</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005351_source')" id="l_M005351_source">show source</a> ]</p>
  <div id="M005351_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 253</span>
253:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_sanitize_unterminated_cdata_section</span>
254:     <span class="ruby-identifier">assert_sanitized</span> <span class="ruby-value str">&quot;&lt;![CDATA[&lt;span&gt;neverending...&quot;</span>, <span class="ruby-value str">&quot;&amp;lt;![CDATA[&amp;lt;span&gt;neverending...]]&gt;&quot;</span>
255:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005341" class="method">
  <div id="M005341_title" class="title">
    <b>test_should_sanitize_with_trailing_space</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005341_source')" id="l_M005341_source">show source</a> ]</p>
  <div id="M005341_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 208</span>
208:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_sanitize_with_trailing_space</span>
209:     <span class="ruby-identifier">raw</span> = <span class="ruby-value str">&quot;display:block; &quot;</span>
210:     <span class="ruby-identifier">expected</span> = <span class="ruby-value str">&quot;display: block;&quot;</span>
211:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">expected</span>, <span class="ruby-identifier">sanitize_css</span>(<span class="ruby-identifier">raw</span>)
212:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005342" class="method">
  <div id="M005342_title" class="title">
    <b>test_should_sanitize_xul_style_attributes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005342_source')" id="l_M005342_source">show source</a> ]</p>
  <div id="M005342_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 214</span>
214:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_should_sanitize_xul_style_attributes</span>
215:     <span class="ruby-identifier">raw</span> = <span class="ruby-value str">%(-moz-binding:url('http://ha.ckers.org/xssmoz.xml#xss'))</span>
216:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">''</span>, <span class="ruby-identifier">sanitize_css</span>(<span class="ruby-identifier">raw</span>)
217:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005314" class="method">
  <div id="M005314_title" class="title">
    <b>test_strip_links</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005314_source')" id="l_M005314_source">show source</a> ]</p>
  <div id="M005314_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 26</span>
26:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_strip_links</span>
27:     <span class="ruby-identifier">sanitizer</span> = <span class="ruby-constant">HTML</span><span class="ruby-operator">::</span><span class="ruby-constant">LinkSanitizer</span>.<span class="ruby-identifier">new</span>
28:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;Dont touch me&quot;</span>, <span class="ruby-identifier">sanitizer</span>.<span class="ruby-identifier">sanitize</span>(<span class="ruby-value str">&quot;Dont touch me&quot;</span>)    
29:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;on my mind\nall day long&quot;</span>, <span class="ruby-identifier">sanitizer</span>.<span class="ruby-identifier">sanitize</span>(<span class="ruby-value str">&quot;&lt;a href='almost'&gt;on my mind&lt;/a&gt;\n&lt;A href='almost'&gt;all day long&lt;/A&gt;&quot;</span>)
30:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;0wn3d&quot;</span>, <span class="ruby-identifier">sanitizer</span>.<span class="ruby-identifier">sanitize</span>(<span class="ruby-value str">&quot;&lt;a href='http://www.rubyonrails.com/'&gt;&lt;a href='http://www.rubyonrails.com/' onlclick='steal()'&gt;0wn3d&lt;/a&gt;&lt;/a&gt;&quot;</span>) 
31:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;Magic&quot;</span>, <span class="ruby-identifier">sanitizer</span>.<span class="ruby-identifier">sanitize</span>(<span class="ruby-value str">&quot;&lt;a href='http://www.rubyonrails.com/'&gt;Mag&lt;a href='http://www.ruby-lang.org/'&gt;ic&quot;</span>) 
32:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;FrrFox&quot;</span>, <span class="ruby-identifier">sanitizer</span>.<span class="ruby-identifier">sanitize</span>(<span class="ruby-value str">&quot;&lt;href onlclick='steal()'&gt;FrrFox&lt;/a&gt;&lt;/href&gt;&quot;</span>) 
33:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;My mind\nall &lt;b&gt;day&lt;/b&gt; long&quot;</span>, <span class="ruby-identifier">sanitizer</span>.<span class="ruby-identifier">sanitize</span>(<span class="ruby-value str">&quot;&lt;a href='almost'&gt;My mind&lt;/a&gt;\n&lt;A href='almost'&gt;all &lt;b&gt;day&lt;/b&gt; long&lt;/A&gt;&quot;</span>)
34:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;all &lt;b&gt;day&lt;/b&gt; long&quot;</span>, <span class="ruby-identifier">sanitizer</span>.<span class="ruby-identifier">sanitize</span>(<span class="ruby-value str">&quot;&lt;&lt;a&gt;a href='hello'&gt;all &lt;b&gt;day&lt;/b&gt; long&lt;&lt;/A&gt;/a&gt;&quot;</span>)
35: 
36:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;&lt;a&lt;a&quot;</span>, <span class="ruby-identifier">sanitizer</span>.<span class="ruby-identifier">sanitize</span>(<span class="ruby-value str">&quot;&lt;a&lt;a&quot;</span>)
37:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005313" class="method">
  <div id="M005313_title" class="title">
    <b>test_strip_tags</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005313_source')" id="l_M005313_source">show source</a> ]</p>
  <div id="M005313_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 8</span>
 8:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_strip_tags</span>
 9:     <span class="ruby-identifier">sanitizer</span> = <span class="ruby-constant">HTML</span><span class="ruby-operator">::</span><span class="ruby-constant">FullSanitizer</span>.<span class="ruby-identifier">new</span>
10:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;&lt;&lt;bad html&quot;</span>, <span class="ruby-identifier">sanitizer</span>.<span class="ruby-identifier">sanitize</span>(<span class="ruby-value str">&quot;&lt;&lt;&lt;bad html&quot;</span>))
11:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;&lt;&lt;&quot;</span>, <span class="ruby-identifier">sanitizer</span>.<span class="ruby-identifier">sanitize</span>(<span class="ruby-value str">&quot;&lt;&lt;&lt;bad html&gt;&quot;</span>))
12:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;Dont touch me&quot;</span>, <span class="ruby-identifier">sanitizer</span>.<span class="ruby-identifier">sanitize</span>(<span class="ruby-value str">&quot;Dont touch me&quot;</span>))
13:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;This is a test.&quot;</span>, <span class="ruby-identifier">sanitizer</span>.<span class="ruby-identifier">sanitize</span>(<span class="ruby-value str">&quot;&lt;p&gt;This &lt;u&gt;is&lt;u&gt; a &lt;a href='test.html'&gt;&lt;strong&gt;test&lt;/strong&gt;&lt;/a&gt;.&lt;/p&gt;&quot;</span>))
14:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;Weirdos&quot;</span>, <span class="ruby-identifier">sanitizer</span>.<span class="ruby-identifier">sanitize</span>(<span class="ruby-value str">&quot;Wei&lt;&lt;a&gt;a onclick='alert(document.cookie);'&lt;/a&gt;/&gt;rdos&quot;</span>))
15:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;This is a test.&quot;</span>, <span class="ruby-identifier">sanitizer</span>.<span class="ruby-identifier">sanitize</span>(<span class="ruby-value str">&quot;This is a test.&quot;</span>))
16:     <span class="ruby-identifier">assert_equal</span>(
17:     <span class="ruby-value str">%{This is a test.\n\n\nIt no longer contains any HTML.\n}</span>, <span class="ruby-identifier">sanitizer</span>.<span class="ruby-identifier">sanitize</span>(
18:     <span class="ruby-value str">%{&lt;title&gt;This is &lt;b&gt;a &lt;a href=&quot;&quot; target=&quot;_blank&quot;&gt;test&lt;/a&gt;&lt;/b&gt;.&lt;/title&gt;\n\n&lt;!-- it has a comment --&gt;\n\n&lt;p&gt;It no &lt;b&gt;longer &lt;strong&gt;contains &lt;em&gt;any &lt;strike&gt;HTML&lt;/strike&gt;&lt;/em&gt;.&lt;/strong&gt;&lt;/b&gt;&lt;/p&gt;\n}</span>))
19:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;This has a  here.&quot;</span>, <span class="ruby-identifier">sanitizer</span>.<span class="ruby-identifier">sanitize</span>(<span class="ruby-value str">&quot;This has a &lt;!-- comment --&gt; here.&quot;</span>)
20:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;This has a  here.&quot;</span>, <span class="ruby-identifier">sanitizer</span>.<span class="ruby-identifier">sanitize</span>(<span class="ruby-value str">&quot;This has a &lt;![CDATA[&lt;section&gt;]]&gt; here.&quot;</span>)
21:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;This has an unclosed &quot;</span>, <span class="ruby-identifier">sanitizer</span>.<span class="ruby-identifier">sanitize</span>(<span class="ruby-value str">&quot;This has an unclosed &lt;![CDATA[&lt;section&gt;]] here...&quot;</span>)
22:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;non printable char is a tag&quot;</span>, <span class="ruby-identifier">sanitizer</span>.<span class="ruby-identifier">sanitize</span>(<span class="ruby-value str">&quot;&lt;\x07a href='/hello'&gt;non printable char is a tag&lt;/a&gt;&quot;</span>)
23:     [<span class="ruby-keyword kw">nil</span>, <span class="ruby-value str">''</span>, <span class="ruby-value str">'   '</span>].<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">blank</span><span class="ruby-operator">|</span> <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">blank</span>, <span class="ruby-identifier">sanitizer</span>.<span class="ruby-identifier">sanitize</span>(<span class="ruby-identifier">blank</span>) }
24:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div class="sectiontitle">Protected Instance methods</div>
<div id="M005353" class="method">
  <div id="M005353_title" class="title">
    <b>assert_sanitized</b>(input, expected = nil)
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005353_source')" id="l_M005353_source">show source</a> ]</p>
  <div id="M005353_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 262</span>
262:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">assert_sanitized</span>(<span class="ruby-identifier">input</span>, <span class="ruby-identifier">expected</span> = <span class="ruby-keyword kw">nil</span>)
263:     <span class="ruby-ivar">@sanitizer</span> <span class="ruby-operator">||=</span> <span class="ruby-constant">HTML</span><span class="ruby-operator">::</span><span class="ruby-constant">WhiteListSanitizer</span>.<span class="ruby-identifier">new</span>
264:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">input</span>
265:       <span class="ruby-identifier">assert_dom_equal</span> <span class="ruby-identifier">expected</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">input</span>, <span class="ruby-ivar">@sanitizer</span>.<span class="ruby-identifier">sanitize</span>(<span class="ruby-identifier">input</span>)
266:     <span class="ruby-keyword kw">else</span>
267:       <span class="ruby-identifier">assert_nil</span> <span class="ruby-ivar">@sanitizer</span>.<span class="ruby-identifier">sanitize</span>(<span class="ruby-identifier">input</span>)
268:     <span class="ruby-keyword kw">end</span>
269:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005354" class="method">
  <div id="M005354_title" class="title">
    <b>sanitize_css</b>(input)
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005354_source')" id="l_M005354_source">show source</a> ]</p>
  <div id="M005354_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File actionpack/test/controller/html-scanner/sanitizer_test.rb, line 271</span>
271:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">sanitize_css</span>(<span class="ruby-identifier">input</span>)
272:     (<span class="ruby-ivar">@sanitizer</span> <span class="ruby-operator">||=</span> <span class="ruby-constant">HTML</span><span class="ruby-operator">::</span><span class="ruby-constant">WhiteListSanitizer</span>.<span class="ruby-identifier">new</span>).<span class="ruby-identifier">sanitize_css</span>(<span class="ruby-identifier">input</span>)
273:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
</div>

  </div>