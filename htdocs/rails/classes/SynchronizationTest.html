  <div id="C00000639">
<div class='banner'>
  <span class="file-title-prefix">Class</span><br />SynchronizationTest<br/>
  In:
<a href="#" onclick="jsHref('files/activesupport/test/core_ext/module/synchronization_test_rb.html');">activesupport/test/core_ext/module/synchronization_test.rb</a>

Parent:&nbsp;
Test::Unit::TestCase
</div>
 <!-- banner header -->

  <div id="bodyContent" >
      <div id="content">




  <div class="sectiontitle">Methods</div>
  <ul>
  <li><a href="index.html?a=M004504&name=dangerous!" >dangerous!</a></li>
  <li><a href="index.html?a=M004503&name=dangerous?" >dangerous?</a></li>
  <li><a href="index.html?a=M004500&name=dummy_sync" >dummy_sync</a></li>
  <li><a href="index.html?a=M004495&name=setup" >setup</a></li>
  <li><a href="index.html?a=M004502&name=test_can_synchronize_method_with_punctuation" >test_can_synchronize_method_with_punctuation</a></li>
  <li><a href="index.html?a=M004505&name=test_can_synchronize_singleton_methods" >test_can_synchronize_singleton_methods</a></li>
  <li><a href="index.html?a=M004499&name=test_double_synchronize_raises_an_argument_error" >test_double_synchronize_raises_an_argument_error</a></li>
  <li><a href="index.html?a=M004501&name=test_mutex_is_entered_during_method_call" >test_mutex_is_entered_during_method_call</a></li>
  <li><a href="index.html?a=M004496&name=test_synchronize_aliases_method_chain_with_synchronize" >test_synchronize_aliases_method_chain_with_synchronize</a></li>
  <li><a href="index.html?a=M004497&name=test_synchronize_does_not_change_behavior" >test_synchronize_does_not_change_behavior</a></li>
  <li><a href="index.html?a=M004498&name=test_synchronize_with_no_mutex_raises_an_argument_error" >test_synchronize_with_no_mutex_raises_an_argument_error</a></li>
  </ul>






<div class="sectiontitle">Public Instance methods</div>
<div id="M004504" class="method">
  <div id="M004504_title" class="title">
    <b>dangerous!</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M004504_source')" id="l_M004504_source">show source</a> ]</p>
  <div id="M004504_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activesupport/test/core_ext/module/synchronization_test.rb, line 67</span>
67:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">dangerous!</span>
68:         <span class="ruby-ivar">@dangerous</span> = <span class="ruby-keyword kw">true</span>
69:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M004503" class="method">
  <div id="M004503_title" class="title">
    <b>dangerous?</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M004503_source')" id="l_M004503_source">show source</a> ]</p>
  <div id="M004503_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activesupport/test/core_ext/module/synchronization_test.rb, line 64</span>
64:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">dangerous?</span>
65:         <span class="ruby-ivar">@dangerous</span>
66:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M004500" class="method">
  <div id="M004500_title" class="title">
    <b>dummy_sync</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M004500_source')" id="l_M004500_source">show source</a> ]</p>
  <div id="M004500_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activesupport/test/core_ext/module/synchronization_test.rb, line 43</span>
43:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">dummy_sync</span>
44:     <span class="ruby-identifier">dummy</span> = <span class="ruby-constant">Object</span>.<span class="ruby-identifier">new</span>
45:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">dummy</span>.<span class="ruby-identifier">synchronize</span>
46:       <span class="ruby-ivar">@sync_count</span> <span class="ruby-operator">||=</span> <span class="ruby-value">0</span>
47:       <span class="ruby-ivar">@sync_count</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
48:       <span class="ruby-keyword kw">yield</span>
49:     <span class="ruby-keyword kw">end</span>
50:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">dummy</span>.<span class="ruby-identifier">sync_count</span>; <span class="ruby-ivar">@sync_count</span>; <span class="ruby-keyword kw">end</span>
51:     <span class="ruby-identifier">dummy</span>
52:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M004495" class="method">
  <div id="M004495_title" class="title">
    <b>setup</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M004495_source')" id="l_M004495_source">show source</a> ]</p>
  <div id="M004495_source" class="dyn-source">
<pre>
   <span class="ruby-comment cmt"># File activesupport/test/core_ext/module/synchronization_test.rb, line 4</span>
4:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">setup</span>
5:     <span class="ruby-ivar">@target</span> = <span class="ruby-constant">Class</span>.<span class="ruby-identifier">new</span>
6:     <span class="ruby-ivar">@target</span>.<span class="ruby-identifier">cattr_accessor</span> <span class="ruby-identifier">:mutex</span>, <span class="ruby-identifier">:instance_writer</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">false</span>
7:     <span class="ruby-ivar">@target</span>.<span class="ruby-identifier">mutex</span> = <span class="ruby-constant">Mutex</span>.<span class="ruby-identifier">new</span>
8:     <span class="ruby-ivar">@instance</span> = <span class="ruby-ivar">@target</span>.<span class="ruby-identifier">new</span>
9:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M004502" class="method">
  <div id="M004502_title" class="title">
    <b>test_can_synchronize_method_with_punctuation</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M004502_source')" id="l_M004502_source">show source</a> ]</p>
  <div id="M004502_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activesupport/test/core_ext/module/synchronization_test.rb, line 62</span>
62:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_can_synchronize_method_with_punctuation</span>
63:     <span class="ruby-ivar">@target</span>.<span class="ruby-identifier">module_eval</span> <span class="ruby-keyword kw">do</span>
64:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">dangerous?</span>
65:         <span class="ruby-ivar">@dangerous</span>
66:       <span class="ruby-keyword kw">end</span>
67:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">dangerous!</span>
68:         <span class="ruby-ivar">@dangerous</span> = <span class="ruby-keyword kw">true</span>
69:       <span class="ruby-keyword kw">end</span>
70:     <span class="ruby-keyword kw">end</span>
71:     <span class="ruby-ivar">@target</span>.<span class="ruby-identifier">synchronize</span> <span class="ruby-identifier">:dangerous?</span>, <span class="ruby-identifier">:dangerous!</span>, <span class="ruby-identifier">:with</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:mutex</span>
72:     <span class="ruby-ivar">@instance</span>.<span class="ruby-identifier">dangerous!</span>
73:     <span class="ruby-identifier">assert</span> <span class="ruby-ivar">@instance</span>.<span class="ruby-identifier">dangerous?</span>
74:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M004505" class="method">
  <div id="M004505_title" class="title">
    <b>test_can_synchronize_singleton_methods</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M004505_source')" id="l_M004505_source">show source</a> ]</p>
  <div id="M004505_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activesupport/test/core_ext/module/synchronization_test.rb, line 76</span>
76:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_can_synchronize_singleton_methods</span>
77:     <span class="ruby-ivar">@target</span>.<span class="ruby-identifier">mutex</span> = <span class="ruby-identifier">dummy_sync</span>
78:     <span class="ruby-keyword kw">class</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-ivar">@target</span>
79:       <span class="ruby-identifier">synchronize</span> <span class="ruby-identifier">:to_s</span>, <span class="ruby-identifier">:with</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:mutex</span>
80:     <span class="ruby-keyword kw">end</span>
81:     <span class="ruby-identifier">assert</span> <span class="ruby-ivar">@target</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:to_s_without_synchronization</span>)
82:     <span class="ruby-identifier">assert_nothing_raised</span> { <span class="ruby-ivar">@target</span>.<span class="ruby-identifier">to_s</span>; <span class="ruby-ivar">@target</span>.<span class="ruby-identifier">to_s</span> }
83:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-ivar">@target</span>.<span class="ruby-identifier">mutex</span>.<span class="ruby-identifier">sync_count</span>
84:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M004499" class="method">
  <div id="M004499_title" class="title">
    <b>test_double_synchronize_raises_an_argument_error</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M004499_source')" id="l_M004499_source">show source</a> ]</p>
  <div id="M004499_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activesupport/test/core_ext/module/synchronization_test.rb, line 36</span>
36:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_double_synchronize_raises_an_argument_error</span>
37:     <span class="ruby-ivar">@target</span>.<span class="ruby-identifier">synchronize</span> <span class="ruby-identifier">:to_s</span>, <span class="ruby-identifier">:with</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:mutex</span>
38:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ArgumentError</span>) <span class="ruby-keyword kw">do</span>
39:       <span class="ruby-ivar">@target</span>.<span class="ruby-identifier">synchronize</span> <span class="ruby-identifier">:to_s</span>, <span class="ruby-identifier">:with</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:mutex</span>
40:     <span class="ruby-keyword kw">end</span>
41:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M004501" class="method">
  <div id="M004501_title" class="title">
    <b>test_mutex_is_entered_during_method_call</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M004501_source')" id="l_M004501_source">show source</a> ]</p>
  <div id="M004501_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activesupport/test/core_ext/module/synchronization_test.rb, line 54</span>
54:   <span class="ruby-keyword kw">def</span>   <span class="ruby-identifier">test_mutex_is_entered_during_method_call</span><span class="ruby-identifier">test_mutex_is_entered_during_method_call</span><span class="ruby-identifier">test_mutex_is_entered_during_method_call</span>
55:     <span class="ruby-ivar">@target</span>.<span class="ruby-identifier">mutex</span> = <span class="ruby-identifier">dummy_sync</span>
56:     <span class="ruby-ivar">@target</span>.<span class="ruby-identifier">synchronize</span> <span class="ruby-identifier">:to_s</span>, <span class="ruby-identifier">:with</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:mutex</span>
57:     <span class="ruby-ivar">@instance</span>.<span class="ruby-identifier">to_s</span>
58:     <span class="ruby-ivar">@instance</span>.<span class="ruby-identifier">to_s</span>
59:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-ivar">@target</span>.<span class="ruby-identifier">mutex</span>.<span class="ruby-identifier">sync_count</span>
60:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M004496" class="method">
  <div id="M004496_title" class="title">
    <b>test_synchronize_aliases_method_chain_with_synchronize</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M004496_source')" id="l_M004496_source">show source</a> ]</p>
  <div id="M004496_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activesupport/test/core_ext/module/synchronization_test.rb, line 11</span>
11:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_synchronize_aliases_method_chain_with_synchronize</span>
12:     <span class="ruby-ivar">@target</span>.<span class="ruby-identifier">module_eval</span> <span class="ruby-keyword kw">do</span>
13:       <span class="ruby-identifier">attr_accessor</span> <span class="ruby-identifier">:value</span>
14:       <span class="ruby-identifier">synchronize</span> <span class="ruby-identifier">:value</span>, <span class="ruby-identifier">:with</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:mutex</span>
15:     <span class="ruby-keyword kw">end</span>
16:     <span class="ruby-identifier">assert</span> <span class="ruby-ivar">@instance</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:value_with_synchronization</span>)
17:     <span class="ruby-identifier">assert</span> <span class="ruby-ivar">@instance</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:value_without_synchronization</span>)
18:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M004497" class="method">
  <div id="M004497_title" class="title">
    <b>test_synchronize_does_not_change_behavior</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M004497_source')" id="l_M004497_source">show source</a> ]</p>
  <div id="M004497_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activesupport/test/core_ext/module/synchronization_test.rb, line 20</span>
20:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_synchronize_does_not_change_behavior</span>
21:     <span class="ruby-ivar">@target</span>.<span class="ruby-identifier">module_eval</span> <span class="ruby-keyword kw">do</span>
22:       <span class="ruby-identifier">attr_accessor</span> <span class="ruby-identifier">:value</span>
23:       <span class="ruby-identifier">synchronize</span> <span class="ruby-identifier">:value</span>, <span class="ruby-identifier">:with</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:mutex</span>
24:     <span class="ruby-keyword kw">end</span>
25:     <span class="ruby-identifier">expected</span> = <span class="ruby-value str">&quot;some state&quot;</span>
26:     <span class="ruby-ivar">@instance</span>.<span class="ruby-identifier">value</span> = <span class="ruby-identifier">expected</span>
27:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">expected</span>, <span class="ruby-ivar">@instance</span>.<span class="ruby-identifier">value</span>
28:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M004498" class="method">
  <div id="M004498_title" class="title">
    <b>test_synchronize_with_no_mutex_raises_an_argument_error</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M004498_source')" id="l_M004498_source">show source</a> ]</p>
  <div id="M004498_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activesupport/test/core_ext/module/synchronization_test.rb, line 30</span>
30:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_synchronize_with_no_mutex_raises_an_argument_error</span>
31:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ArgumentError</span>) <span class="ruby-keyword kw">do</span>
32:       <span class="ruby-ivar">@target</span>.<span class="ruby-identifier">synchronize</span> <span class="ruby-identifier">:to_s</span>
33:     <span class="ruby-keyword kw">end</span>
34:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
</div>

  </div>