  <div id="C00000511">
<div class='banner'>
  <span class="file-title-prefix">Class</span><br />ValidationsTest<br/>
  In:
<a href="#" onclick="jsHref('files/activerecord/test/cases/validations_test_rb.html');">activerecord/test/cases/validations_test.rb</a>

Parent:&nbsp;
ActiveRecord::TestCase
</div>
 <!-- banner header -->

  <div id="bodyContent" >
      <div id="content">




  <div class="sectiontitle">Methods</div>
  <ul>
  <li><a href="index.html?a=M003327&name=test_create_with_exceptions_using_scope_and_empty_attributes" >test_create_with_exceptions_using_scope_and_empty_attributes</a></li>
  <li><a href="index.html?a=M003326&name=test_create_with_exceptions_using_scope_for_protected_attributes" >test_create_with_exceptions_using_scope_for_protected_attributes</a></li>
  <li><a href="index.html?a=M003333&name=test_create_without_validation" >test_create_without_validation</a></li>
  <li><a href="index.html?a=M003334&name=test_create_without_validation_bang" >test_create_without_validation_bang</a></li>
  <li><a href="index.html?a=M003318&name=test_double_attr_validation_and_error_msg" >test_double_attr_validation_and_error_msg</a></li>
  <li><a href="index.html?a=M003319&name=test_error_on_create" >test_error_on_create</a></li>
  <li><a href="index.html?a=M003320&name=test_error_on_update" >test_error_on_update</a></li>
  <li><a href="index.html?a=M003332&name=test_errors_on_base" >test_errors_on_base</a></li>
  <li><a href="index.html?a=M003433&name=test_errors_to_xml" >test_errors_to_xml</a></li>
  <li><a href="index.html?a=M003340&name=test_eula" >test_eula</a></li>
  <li><a href="index.html?a=M003322&name=test_exception_on_create_bang_many" >test_exception_on_create_bang_many</a></li>
  <li><a href="index.html?a=M003324&name=test_exception_on_create_bang_many_with_block" >test_exception_on_create_bang_many_with_block</a></li>
  <li><a href="index.html?a=M003323&name=test_exception_on_create_bang_with_block" >test_exception_on_create_bang_with_block</a></li>
  <li><a href="index.html?a=M003430&name=test_if_validation_using_block_false" >test_if_validation_using_block_false</a></li>
  <li><a href="index.html?a=M003428&name=test_if_validation_using_block_true" >test_if_validation_using_block_true</a></li>
  <li><a href="index.html?a=M003422&name=test_if_validation_using_method_false" >test_if_validation_using_method_false</a></li>
  <li><a href="index.html?a=M003420&name=test_if_validation_using_method_true" >test_if_validation_using_method_true</a></li>
  <li><a href="index.html?a=M003426&name=test_if_validation_using_string_false" >test_if_validation_using_string_false</a></li>
  <li><a href="index.html?a=M003424&name=test_if_validation_using_string_true" >test_if_validation_using_string_true</a></li>
  <li><a href="index.html?a=M003321&name=test_invalid_record_exception" >test_invalid_record_exception</a></li>
  <li><a href="index.html?a=M003435&name=test_invalid_should_be_the_opposite_of_valid" >test_invalid_should_be_the_opposite_of_valid</a></li>
  <li><a href="index.html?a=M003408&name=test_invalid_validator" >test_invalid_validator</a></li>
  <li><a href="index.html?a=M003331&name=test_multiple_errors_per_attr_iteration_with_full_error_composition" >test_multiple_errors_per_attr_iteration_with_full_error_composition</a></li>
  <li><a href="index.html?a=M003336&name=test_no_title_confirmation" >test_no_title_confirmation</a></li>
  <li><a href="index.html?a=M003371&name=test_numericality_with_allow_nil_and_getter_method" >test_numericality_with_allow_nil_and_getter_method</a></li>
  <li><a href="index.html?a=M003367&name=test_numericality_with_getter_method" >test_numericality_with_getter_method</a></li>
  <li><a href="index.html?a=M003383&name=test_optionally_validates_length_of_using_is" >test_optionally_validates_length_of_using_is</a></li>
  <li><a href="index.html?a=M003377&name=test_optionally_validates_length_of_using_maximum" >test_optionally_validates_length_of_using_maximum</a></li>
  <li><a href="index.html?a=M003375&name=test_optionally_validates_length_of_using_minimum" >test_optionally_validates_length_of_using_minimum</a></li>
  <li><a href="index.html?a=M003379&name=test_optionally_validates_length_of_using_within" >test_optionally_validates_length_of_using_within</a></li>
  <li><a href="index.html?a=M003380&name=test_optionally_validates_length_of_using_within_on_create" >test_optionally_validates_length_of_using_within_on_create</a></li>
  <li><a href="index.html?a=M003400&name=test_optionally_validates_length_of_using_within_on_create_utf8" >test_optionally_validates_length_of_using_within_on_create_utf8</a></li>
  <li><a href="index.html?a=M003381&name=test_optionally_validates_length_of_using_within_on_update" >test_optionally_validates_length_of_using_within_on_update</a></li>
  <li><a href="index.html?a=M003401&name=test_optionally_validates_length_of_using_within_on_update_utf8" >test_optionally_validates_length_of_using_within_on_update_utf8</a></li>
  <li><a href="index.html?a=M003399&name=test_optionally_validates_length_of_using_within_utf8" >test_optionally_validates_length_of_using_within_utf8</a></li>
  <li><a href="index.html?a=M003325&name=test_scoped_create_without_attributes" >test_scoped_create_without_attributes</a></li>
  <li><a href="index.html?a=M003317&name=test_single_attr_validation_and_error_msg" >test_single_attr_validation_and_error_msg</a></li>
  <li><a href="index.html?a=M003330&name=test_single_error_object_per_attr_iteration" >test_single_error_object_per_attr_iteration</a></li>
  <li><a href="index.html?a=M003329&name=test_single_error_string_per_attr_iteration" >test_single_error_string_per_attr_iteration</a></li>
  <li><a href="index.html?a=M003316&name=test_single_field_validation" >test_single_field_validation</a></li>
  <li><a href="index.html?a=M003339&name=test_terms_of_service_agreement" >test_terms_of_service_agreement</a></li>
  <li><a href="index.html?a=M003338&name=test_terms_of_service_agreement_no_acceptance" >test_terms_of_service_agreement_no_acceptance</a></li>
  <li><a href="index.html?a=M003341&name=test_terms_of_service_agreement_with_accept_value" >test_terms_of_service_agreement_with_accept_value</a></li>
  <li><a href="index.html?a=M003409&name=test_throw_away_typing" >test_throw_away_typing</a></li>
  <li><a href="index.html?a=M003337&name=test_title_confirmation" >test_title_confirmation</a></li>
  <li><a href="index.html?a=M003431&name=test_unless_validation_using_block_false" >test_unless_validation_using_block_false</a></li>
  <li><a href="index.html?a=M003429&name=test_unless_validation_using_block_true" >test_unless_validation_using_block_true</a></li>
  <li><a href="index.html?a=M003423&name=test_unless_validation_using_method_false" >test_unless_validation_using_method_false</a></li>
  <li><a href="index.html?a=M003421&name=test_unless_validation_using_method_true" >test_unless_validation_using_method_true</a></li>
  <li><a href="index.html?a=M003427&name=test_unless_validation_using_string_false" >test_unless_validation_using_string_false</a></li>
  <li><a href="index.html?a=M003425&name=test_unless_validation_using_string_true" >test_unless_validation_using_string_true</a></li>
  <li><a href="index.html?a=M003407&name=test_validate_block" >test_validate_block</a></li>
  <li><a href="index.html?a=M003352&name=test_validate_case_insensitive_uniqueness" >test_validate_case_insensitive_uniqueness</a></li>
  <li><a href="index.html?a=M003353&name=test_validate_case_sensitive_uniqueness" >test_validate_case_sensitive_uniqueness</a></li>
  <li><a href="index.html?a=M003354&name=test_validate_case_sensitive_uniqueness_with_attribute_passed_as_integer" >test_validate_case_sensitive_uniqueness_with_attribute_passed_as_integer</a></li>
  <li><a href="index.html?a=M003361&name=test_validate_format" >test_validate_format</a></li>
  <li><a href="index.html?a=M003363&name=test_validate_format_numeric" >test_validate_format_numeric</a></li>
  <li><a href="index.html?a=M003362&name=test_validate_format_with_allow_blank" >test_validate_format_with_allow_blank</a></li>
  <li><a href="index.html?a=M003364&name=test_validate_format_with_formatted_message" >test_validate_format_with_formatted_message</a></li>
  <li><a href="index.html?a=M003344&name=test_validate_presences" >test_validate_presences</a></li>
  <li><a href="index.html?a=M003360&name=test_validate_straight_inheritance_uniqueness" >test_validate_straight_inheritance_uniqueness</a></li>
  <li><a href="index.html?a=M003347&name=test_validate_uniqueness" >test_validate_uniqueness</a></li>
  <li><a href="index.html?a=M003350&name=test_validate_uniqueness_scoped_to_defining_class" >test_validate_uniqueness_scoped_to_defining_class</a></li>
  <li><a href="index.html?a=M003357&name=test_validate_uniqueness_with_columns_which_are_sql_keywords" >test_validate_uniqueness_with_columns_which_are_sql_keywords</a></li>
  <li><a href="index.html?a=M003358&name=test_validate_uniqueness_with_limit" >test_validate_uniqueness_with_limit</a></li>
  <li><a href="index.html?a=M003359&name=test_validate_uniqueness_with_limit_and_utf8" >test_validate_uniqueness_with_limit_and_utf8</a></li>
  <li><a href="index.html?a=M003355&name=test_validate_uniqueness_with_non_standard_table_names" >test_validate_uniqueness_with_non_standard_table_names</a></li>
  <li><a href="index.html?a=M003349&name=test_validate_uniqueness_with_scope" >test_validate_uniqueness_with_scope</a></li>
  <li><a href="index.html?a=M003351&name=test_validate_uniqueness_with_scope_array" >test_validate_uniqueness_with_scope_array</a></li>
  <li><a href="index.html?a=M003342&name=test_validates_acceptance_of_as_database_column" >test_validates_acceptance_of_as_database_column</a></li>
  <li><a href="index.html?a=M003410&name=test_validates_acceptance_of_with_custom_error_using_quotes" >test_validates_acceptance_of_with_custom_error_using_quotes</a></li>
  <li><a href="index.html?a=M003343&name=test_validates_acceptance_of_with_non_existant_table" >test_validates_acceptance_of_with_non_existant_table</a></li>
  <li><a href="index.html?a=M003405&name=test_validates_associated_many" >test_validates_associated_many</a></li>
  <li><a href="index.html?a=M003432&name=test_validates_associated_missing" >test_validates_associated_missing</a></li>
  <li><a href="index.html?a=M003406&name=test_validates_associated_one" >test_validates_associated_one</a></li>
  <li><a href="index.html?a=M003419&name=test_validates_associated_with_custom_message_using_quotes" >test_validates_associated_with_custom_message_using_quotes</a></li>
  <li><a href="index.html?a=M003411&name=test_validates_confirmation_of_with_custom_error_using_quotes" >test_validates_confirmation_of_with_custom_error_using_quotes</a></li>
  <li><a href="index.html?a=M003335&name=test_validates_each" >test_validates_each</a></li>
  <li><a href="index.html?a=M003372&name=test_validates_exclusion_of" >test_validates_exclusion_of</a></li>
  <li><a href="index.html?a=M003373&name=test_validates_exclusion_of_with_formatted_message" >test_validates_exclusion_of_with_formatted_message</a></li>
  <li><a href="index.html?a=M003412&name=test_validates_format_of_with_custom_error_using_quotes" >test_validates_format_of_with_custom_error_using_quotes</a></li>
  <li><a href="index.html?a=M003365&name=test_validates_inclusion_of" >test_validates_inclusion_of</a></li>
  <li><a href="index.html?a=M003366&name=test_validates_inclusion_of_with_allow_nil" >test_validates_inclusion_of_with_allow_nil</a></li>
  <li><a href="index.html?a=M003413&name=test_validates_inclusion_of_with_custom_error_using_quotes" >test_validates_inclusion_of_with_custom_error_using_quotes</a></li>
  <li><a href="index.html?a=M003370&name=test_validates_inclusion_of_with_formatted_message" >test_validates_inclusion_of_with_formatted_message</a></li>
  <li><a href="index.html?a=M003392&name=test_validates_length_of_custom_errors_for_in" >test_validates_length_of_custom_errors_for_in</a></li>
  <li><a href="index.html?a=M003394&name=test_validates_length_of_custom_errors_for_is_with_message" >test_validates_length_of_custom_errors_for_is_with_message</a></li>
  <li><a href="index.html?a=M003395&name=test_validates_length_of_custom_errors_for_is_with_wrong_length" >test_validates_length_of_custom_errors_for_is_with_wrong_length</a></li>
  <li><a href="index.html?a=M003391&name=test_validates_length_of_custom_errors_for_maximum_with_message" >test_validates_length_of_custom_errors_for_maximum_with_message</a></li>
  <li><a href="index.html?a=M003393&name=test_validates_length_of_custom_errors_for_maximum_with_too_long" >test_validates_length_of_custom_errors_for_maximum_with_too_long</a></li>
  <li><a href="index.html?a=M003389&name=test_validates_length_of_custom_errors_for_minimum_with_message" >test_validates_length_of_custom_errors_for_minimum_with_message</a></li>
  <li><a href="index.html?a=M003390&name=test_validates_length_of_custom_errors_for_minimum_with_too_short" >test_validates_length_of_custom_errors_for_minimum_with_too_short</a></li>
  <li><a href="index.html?a=M003388&name=test_validates_length_of_nasty_params" >test_validates_length_of_nasty_params</a></li>
  <li><a href="index.html?a=M003384&name=test_validates_length_of_using_bignum" >test_validates_length_of_using_bignum</a></li>
  <li><a href="index.html?a=M003382&name=test_validates_length_of_using_is" >test_validates_length_of_using_is</a></li>
  <li><a href="index.html?a=M003402&name=test_validates_length_of_using_is_utf8" >test_validates_length_of_using_is_utf8</a></li>
  <li><a href="index.html?a=M003376&name=test_validates_length_of_using_maximum" >test_validates_length_of_using_maximum</a></li>
  <li><a href="index.html?a=M003397&name=test_validates_length_of_using_maximum_utf8" >test_validates_length_of_using_maximum_utf8</a></li>
  <li><a href="index.html?a=M003374&name=test_validates_length_of_using_minimum" >test_validates_length_of_using_minimum</a></li>
  <li><a href="index.html?a=M003396&name=test_validates_length_of_using_minimum_utf8" >test_validates_length_of_using_minimum_utf8</a></li>
  <li><a href="index.html?a=M003378&name=test_validates_length_of_using_within" >test_validates_length_of_using_within</a></li>
  <li><a href="index.html?a=M003398&name=test_validates_length_of_using_within_utf8" >test_validates_length_of_using_within_utf8</a></li>
  <li><a href="index.html?a=M003369&name=test_validates_length_of_with_allow_blank" >test_validates_length_of_with_allow_blank</a></li>
  <li><a href="index.html?a=M003368&name=test_validates_length_of_with_allow_nil" >test_validates_length_of_with_allow_nil</a></li>
  <li><a href="index.html?a=M003403&name=test_validates_length_of_with_block" >test_validates_length_of_with_block</a></li>
  <li><a href="index.html?a=M003416&name=test_validates_length_of_with_custom_message_using_quotes" >test_validates_length_of_with_custom_message_using_quotes</a></li>
  <li><a href="index.html?a=M003414&name=test_validates_length_of_with_custom_too_long_using_quotes" >test_validates_length_of_with_custom_too_long_using_quotes</a></li>
  <li><a href="index.html?a=M003415&name=test_validates_length_of_with_custom_too_short_using_quotes" >test_validates_length_of_with_custom_too_short_using_quotes</a></li>
  <li><a href="index.html?a=M003385&name=test_validates_length_with_globally_modified_error_message" >test_validates_length_with_globally_modified_error_message</a></li>
  <li><a href="index.html?a=M003346&name=test_validates_presence_of_belongs_to_association__existing_parent" >test_validates_presence_of_belongs_to_association__existing_parent</a></li>
  <li><a href="index.html?a=M003345&name=test_validates_presence_of_belongs_to_association__parent_is_new_record" >test_validates_presence_of_belongs_to_association__parent_is_new_record</a></li>
  <li><a href="index.html?a=M003417&name=test_validates_presence_of_with_custom_message_using_quotes" >test_validates_presence_of_with_custom_message_using_quotes</a></li>
  <li><a href="index.html?a=M003386&name=test_validates_size_of_association" >test_validates_size_of_association</a></li>
  <li><a href="index.html?a=M003387&name=test_validates_size_of_association_using_within" >test_validates_size_of_association_using_within</a></li>
  <li><a href="index.html?a=M003404&name=test_validates_size_of_association_utf8" >test_validates_size_of_association_utf8</a></li>
  <li><a href="index.html?a=M003356&name=test_validates_uniqueness_inside_with_scope" >test_validates_uniqueness_inside_with_scope</a></li>
  <li><a href="index.html?a=M003418&name=test_validates_uniqueness_of_with_custom_message_using_quotes" >test_validates_uniqueness_of_with_custom_message_using_quotes</a></li>
  <li><a href="index.html?a=M003348&name=test_validates_uniquness_with_newline_chars" >test_validates_uniquness_with_newline_chars</a></li>
  <li><a href="index.html?a=M003434&name=test_validation_order" >test_validation_order</a></li>
  <li><a href="index.html?a=M003436&name=test_validation_with_if_as_string" >test_validation_with_if_as_string</a></li>
  <li><a href="index.html?a=M003328&name=test_values_are_not_retrieved_unless_needed" >test_values_are_not_retrieved_unless_needed</a></li>
  </ul>






<div class="sectiontitle">Public Instance methods</div>
<div id="M003327" class="method">
  <div id="M003327_title" class="title">
    <b>test_create_with_exceptions_using_scope_and_empty_attributes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003327_source')" id="l_M003327_source">show source</a> ]</p>
  <div id="M003327_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 174</span>
174:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_create_with_exceptions_using_scope_and_empty_attributes</span>
175:     <span class="ruby-identifier">assert_nothing_raised</span> <span class="ruby-keyword kw">do</span>
176:       <span class="ruby-constant">ProtectedPerson</span>.<span class="ruby-identifier">with_scope</span>( <span class="ruby-identifier">:create</span> =<span class="ruby-operator">&gt;</span> { <span class="ruby-identifier">:first_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Mary&quot;</span> } ) <span class="ruby-keyword kw">do</span>
177:         <span class="ruby-identifier">person</span> = <span class="ruby-constant">ProtectedPerson</span>.<span class="ruby-identifier">create!</span>
178:         <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">person</span>.<span class="ruby-identifier">first_name</span>, <span class="ruby-value str">&quot;Mary&quot;</span>, <span class="ruby-value str">&quot;should be ok when no attributes are passed to create!&quot;</span>
179:       <span class="ruby-keyword kw">end</span>
180:     <span class="ruby-keyword kw">end</span>
181:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003326" class="method">
  <div id="M003326_title" class="title">
    <b>test_create_with_exceptions_using_scope_for_protected_attributes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003326_source')" id="l_M003326_source">show source</a> ]</p>
  <div id="M003326_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 165</span>
165:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_create_with_exceptions_using_scope_for_protected_attributes</span>
166:     <span class="ruby-identifier">assert_nothing_raised</span> <span class="ruby-keyword kw">do</span>
167:       <span class="ruby-constant">ProtectedPerson</span>.<span class="ruby-identifier">with_scope</span>( <span class="ruby-identifier">:create</span> =<span class="ruby-operator">&gt;</span> { <span class="ruby-identifier">:first_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Mary&quot;</span> } ) <span class="ruby-keyword kw">do</span>
168:         <span class="ruby-identifier">person</span> = <span class="ruby-constant">ProtectedPerson</span>.<span class="ruby-identifier">create!</span> <span class="ruby-identifier">:addon</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Addon&quot;</span>
169:         <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">person</span>.<span class="ruby-identifier">first_name</span>, <span class="ruby-value str">&quot;Mary&quot;</span>, <span class="ruby-value str">&quot;scope should ignore attr_protected&quot;</span>
170:       <span class="ruby-keyword kw">end</span>
171:     <span class="ruby-keyword kw">end</span>
172:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003333" class="method">
  <div id="M003333_title" class="title">
    <b>test_create_without_validation</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003333_source')" id="l_M003333_source">show source</a> ]</p>
  <div id="M003333_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 243</span>
243:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_create_without_validation</span>
244:     <span class="ruby-identifier">reply</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span>
245:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">reply</span>.<span class="ruby-identifier">save</span>
246:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">reply</span>.<span class="ruby-identifier">save</span>(<span class="ruby-keyword kw">false</span>)
247:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003334" class="method">
  <div id="M003334_title" class="title">
    <b>test_create_without_validation_bang</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003334_source')" id="l_M003334_source">show source</a> ]</p>
  <div id="M003334_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 249</span>
249:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_create_without_validation_bang</span>
250:     <span class="ruby-identifier">count</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">count</span>
251:     <span class="ruby-identifier">assert_nothing_raised</span> { <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">save_without_validation!</span> }
252:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">count</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>, <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">count</span>
253:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003318" class="method">
  <div id="M003318_title" class="title">
    <b>test_double_attr_validation_and_error_msg</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003318_source')" id="l_M003318_source">show source</a> ]</p>
  <div id="M003318_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 90</span>
 90:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_double_attr_validation_and_error_msg</span>
 91:     <span class="ruby-identifier">r</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span>
 92:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">r</span>.<span class="ruby-identifier">valid?</span>
 93: 
 94:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">invalid?</span>(<span class="ruby-value str">&quot;title&quot;</span>), <span class="ruby-value str">&quot;A reply without title should mark that attribute as invalid&quot;</span>
 95:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;Empty&quot;</span>, <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-value str">&quot;title&quot;</span>), <span class="ruby-value str">&quot;A reply without title should contain an error&quot;</span>
 96: 
 97:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">invalid?</span>(<span class="ruby-value str">&quot;content&quot;</span>), <span class="ruby-value str">&quot;A reply without content should mark that attribute as invalid&quot;</span>
 98:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;Empty&quot;</span>, <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-value str">&quot;content&quot;</span>), <span class="ruby-value str">&quot;A reply without content should contain an error&quot;</span>
 99: 
100:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">count</span>
101:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003319" class="method">
  <div id="M003319_title" class="title">
    <b>test_error_on_create</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003319_source')" id="l_M003319_source">show source</a> ]</p>
  <div id="M003319_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 103</span>
103:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_error_on_create</span>
104:     <span class="ruby-identifier">r</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span>
105:     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;Wrong Create&quot;</span>
106:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">r</span>.<span class="ruby-identifier">valid?</span>
107:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">invalid?</span>(<span class="ruby-value str">&quot;title&quot;</span>), <span class="ruby-value str">&quot;A reply with a bad title should mark that attribute as invalid&quot;</span>
108:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is Wrong Create&quot;</span>, <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-value str">&quot;title&quot;</span>), <span class="ruby-value str">&quot;A reply with a bad content should contain an error&quot;</span>
109:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003320" class="method">
  <div id="M003320_title" class="title">
    <b>test_error_on_update</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003320_source')" id="l_M003320_source">show source</a> ]</p>
  <div id="M003320_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 111</span>
111:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_error_on_update</span>
112:     <span class="ruby-identifier">r</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span>
113:     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;Bad&quot;</span>
114:     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">content</span> = <span class="ruby-value str">&quot;Good&quot;</span>
115:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;First save should be successful&quot;</span>
116: 
117:     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;Wrong Update&quot;</span>
118:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">r</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Second save should fail&quot;</span>
119: 
120:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">invalid?</span>(<span class="ruby-value str">&quot;title&quot;</span>), <span class="ruby-value str">&quot;A reply with a bad title should mark that attribute as invalid&quot;</span>
121:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is Wrong Update&quot;</span>, <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-value str">&quot;title&quot;</span>), <span class="ruby-value str">&quot;A reply with a bad content should contain an error&quot;</span>
122:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003332" class="method">
  <div id="M003332_title" class="title">
    <b>test_errors_on_base</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003332_source')" id="l_M003332_source">show source</a> ]</p>
  <div id="M003332_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 227</span>
227:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_errors_on_base</span>
228:     <span class="ruby-identifier">r</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span>
229:     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">content</span> = <span class="ruby-value str">&quot;Mismatch&quot;</span>
230:     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">save</span>
231:     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add_to_base</span> <span class="ruby-value str">&quot;Reply is not dignifying&quot;</span>
232: 
233:     <span class="ruby-identifier">errors</span> = []
234:     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">each_full</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">error</span><span class="ruby-operator">|</span> <span class="ruby-identifier">errors</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">error</span> }
235: 
236:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;Reply is not dignifying&quot;</span>, <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on_base</span>
237: 
238:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">errors</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-value str">&quot;Title Empty&quot;</span>)
239:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">errors</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-value str">&quot;Reply is not dignifying&quot;</span>)
240:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">count</span>
241:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003433" class="method">
  <div id="M003433_title" class="title">
    <b>test_errors_to_xml</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003433_source')" id="l_M003433_source">show source</a> ]</p>
  <div id="M003433_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1475</span>
1475:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_errors_to_xml</span>
1476:     <span class="ruby-identifier">r</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span> <span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Wrong Create&quot;</span>
1477:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">r</span>.<span class="ruby-identifier">valid?</span>
1478:     <span class="ruby-identifier">xml</span> = <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">to_xml</span>(<span class="ruby-identifier">:skip_instruct</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>)
1479:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;&lt;errors&gt;&quot;</span>, <span class="ruby-identifier">xml</span>.<span class="ruby-identifier">first</span>(<span class="ruby-value">8</span>)
1480:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">xml</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-value str">&quot;&lt;error&gt;Title is Wrong Create&lt;/error&gt;&quot;</span>)
1481:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">xml</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-value str">&quot;&lt;error&gt;Content Empty&lt;/error&gt;&quot;</span>)
1482:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003340" class="method">
  <div id="M003340_title" class="title">
    <b>test_eula</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003340_source')" id="l_M003340_source">show source</a> ]</p>
  <div id="M003340_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 314</span>
314:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_eula</span>
315:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_acceptance_of</span>(<span class="ruby-identifier">:eula</span>, <span class="ruby-identifier">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;must be abided&quot;</span>, <span class="ruby-identifier">:on</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:create</span>)
316: 
317:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;We should be confirmed&quot;</span>,<span class="ruby-value str">&quot;eula&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;&quot;</span>)
318:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
319:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;must be abided&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:eula</span>)
320: 
321:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">eula</span> = <span class="ruby-value str">&quot;1&quot;</span>
322:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
323:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003322" class="method">
  <div id="M003322_title" class="title">
    <b>test_exception_on_create_bang_many</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003322_source')" id="l_M003322_source">show source</a> ]</p>
  <div id="M003322_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 137</span>
137:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_exception_on_create_bang_many</span>
138:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">RecordInvalid</span>) <span class="ruby-keyword kw">do</span>
139:       <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">create!</span>([ { <span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;OK&quot;</span> }, { <span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Wrong Create&quot;</span> }])
140:     <span class="ruby-keyword kw">end</span>
141:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003324" class="method">
  <div id="M003324_title" class="title">
    <b>test_exception_on_create_bang_many_with_block</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003324_source')" id="l_M003324_source">show source</a> ]</p>
  <div id="M003324_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 151</span>
151:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_exception_on_create_bang_many_with_block</span>
152:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">RecordInvalid</span>) <span class="ruby-keyword kw">do</span>
153:       <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">create!</span>([{ <span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;OK&quot;</span> }, { <span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Wrong Create&quot;</span> }]) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span>
154:         <span class="ruby-identifier">r</span>.<span class="ruby-identifier">content</span> = <span class="ruby-keyword kw">nil</span>
155:       <span class="ruby-keyword kw">end</span>
156:     <span class="ruby-keyword kw">end</span>
157:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003323" class="method">
  <div id="M003323_title" class="title">
    <b>test_exception_on_create_bang_with_block</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003323_source')" id="l_M003323_source">show source</a> ]</p>
  <div id="M003323_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 143</span>
143:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_exception_on_create_bang_with_block</span>
144:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">RecordInvalid</span>) <span class="ruby-keyword kw">do</span>
145:       <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">create!</span>({ <span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;OK&quot;</span> }) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span>
146:         <span class="ruby-identifier">r</span>.<span class="ruby-identifier">content</span> = <span class="ruby-keyword kw">nil</span>
147:       <span class="ruby-keyword kw">end</span>
148:     <span class="ruby-keyword kw">end</span>
149:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003430" class="method">
  <div id="M003430_title" class="title">
    <b>test_if_validation_using_block_false</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003430_source')" id="l_M003430_source">show source</a> ]</p>
  <div id="M003430_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1444</span>
1444:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_if_validation_using_block_false</span>
1445:     <span class="ruby-comment cmt"># When the block returns false</span>
1446:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:too_long=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;hoo {{count}}&quot;</span>,
1447:       <span class="ruby-identifier">:if</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">title</span> <span class="ruby-operator">!=</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>} )
1448:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1449:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1450:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1451:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003428" class="method">
  <div id="M003428_title" class="title">
    <b>test_if_validation_using_block_true</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003428_source')" id="l_M003428_source">show source</a> ]</p>
  <div id="M003428_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1425</span>
1425:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_if_validation_using_block_true</span>
1426:     <span class="ruby-comment cmt"># When the block returns true</span>
1427:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:too_long=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;hoo {{count}}&quot;</span>,
1428:       <span class="ruby-identifier">:if</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">content</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">4</span> } )
1429:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1430:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1431:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1432:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;hoo 5&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
1433:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003422" class="method">
  <div id="M003422_title" class="title">
    <b>test_if_validation_using_method_false</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003422_source')" id="l_M003422_source">show source</a> ]</p>
  <div id="M003422_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1374</span>
1374:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_if_validation_using_method_false</span>
1375:     <span class="ruby-comment cmt"># When the method returns false</span>
1376:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:too_long=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;hoo {{count}}&quot;</span>, <span class="ruby-identifier">:if</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:condition_is_true_but_its_not</span> )
1377:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1378:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1379:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1380:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003420" class="method">
  <div id="M003420_title" class="title">
    <b>test_if_validation_using_method_true</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003420_source')" id="l_M003420_source">show source</a> ]</p>
  <div id="M003420_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1357</span>
1357:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_if_validation_using_method_true</span>
1358:     <span class="ruby-comment cmt"># When the method returns true</span>
1359:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:too_long=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;hoo {{count}}&quot;</span>, <span class="ruby-identifier">:if</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:condition_is_true</span> )
1360:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1361:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1362:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1363:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;hoo 5&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
1364:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003426" class="method">
  <div id="M003426_title" class="title">
    <b>test_if_validation_using_string_false</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003426_source')" id="l_M003426_source">show source</a> ]</p>
  <div id="M003426_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1408</span>
1408:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_if_validation_using_string_false</span>
1409:     <span class="ruby-comment cmt"># When the evaluated string returns false</span>
1410:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:too_long=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;hoo {{count}}&quot;</span>, <span class="ruby-identifier">:if</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;false&quot;</span>)
1411:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1412:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1413:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1414:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003424" class="method">
  <div id="M003424_title" class="title">
    <b>test_if_validation_using_string_true</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003424_source')" id="l_M003424_source">show source</a> ]</p>
  <div id="M003424_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1391</span>
1391:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_if_validation_using_string_true</span>
1392:     <span class="ruby-comment cmt"># When the evaluated string returns true</span>
1393:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:too_long=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;hoo {{count}}&quot;</span>, <span class="ruby-identifier">:if</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;a = 1; a == 1&quot;</span> )
1394:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1395:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1396:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1397:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;hoo 5&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
1398:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003321" class="method">
  <div id="M003321_title" class="title">
    <b>test_invalid_record_exception</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003321_source')" id="l_M003321_source">show source</a> ]</p>
  <div id="M003321_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 124</span>
124:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_invalid_record_exception</span>
125:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">RecordInvalid</span>) { <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">create!</span> }
126:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">RecordInvalid</span>) { <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">save!</span> }
127: 
128:     <span class="ruby-keyword kw">begin</span>
129:       <span class="ruby-identifier">r</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span>
130:       <span class="ruby-identifier">r</span>.<span class="ruby-identifier">save!</span>
131:       <span class="ruby-identifier">flunk</span>
132:     <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">RecordInvalid</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">invalid</span>
133:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">r</span>, <span class="ruby-identifier">invalid</span>.<span class="ruby-identifier">record</span>
134:     <span class="ruby-keyword kw">end</span>
135:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003435" class="method">
  <div id="M003435_title" class="title">
    <b>test_invalid_should_be_the_opposite_of_valid</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003435_source')" id="l_M003435_source">show source</a> ]</p>
  <div id="M003435_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1503</span>
1503:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_invalid_should_be_the_opposite_of_valid</span>
1504:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_presence_of</span> <span class="ruby-identifier">:title</span>
1505: 
1506:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>
1507:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">invalid?</span>
1508:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">invalid?</span>(<span class="ruby-identifier">:title</span>)
1509: 
1510:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">'Things are going to change'</span>
1511:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">invalid?</span>
1512:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003408" class="method">
  <div id="M003408_title" class="title">
    <b>test_invalid_validator</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003408_source')" id="l_M003408_source">show source</a> ]</p>
  <div id="M003408_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1243</span>
1243:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_invalid_validator</span>
1244:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validate</span> <span class="ruby-value">3</span>
1245:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ArgumentError</span>) { <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span> }
1246:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003331" class="method">
  <div id="M003331_title" class="title">
    <b>test_multiple_errors_per_attr_iteration_with_full_error_composition</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003331_source')" id="l_M003331_source">show source</a> ]</p>
  <div id="M003331_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 213</span>
213:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_multiple_errors_per_attr_iteration_with_full_error_composition</span>
214:     <span class="ruby-identifier">r</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span>
215:     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">title</span>   = <span class="ruby-value str">&quot;Wrong Create&quot;</span>
216:     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">content</span> = <span class="ruby-value str">&quot;Mismatch&quot;</span>
217:     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">save</span>
218: 
219:     <span class="ruby-identifier">errors</span> = []
220:     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">each_full</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">error</span><span class="ruby-operator">|</span> <span class="ruby-identifier">errors</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">error</span> }
221: 
222:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;Title is Wrong Create&quot;</span>, <span class="ruby-identifier">errors</span>[<span class="ruby-value">0</span>]
223:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;Title is Content Mismatch&quot;</span>, <span class="ruby-identifier">errors</span>[<span class="ruby-value">1</span>]
224:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">count</span>
225:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003336" class="method">
  <div id="M003336_title" class="title">
    <b>test_no_title_confirmation</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003336_source')" id="l_M003336_source">show source</a> ]</p>
  <div id="M003336_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 268</span>
268:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_no_title_confirmation</span>
269:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_confirmation_of</span>(<span class="ruby-identifier">:title</span>)
270: 
271:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">:author_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Plutarch&quot;</span>)
272:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
273: 
274:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title_confirmation</span> = <span class="ruby-value str">&quot;Parallel Lives&quot;</span>
275:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
276: 
277:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title_confirmation</span> = <span class="ruby-keyword kw">nil</span>
278:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;Parallel Lives&quot;</span>
279:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
280: 
281:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title_confirmation</span> = <span class="ruby-value str">&quot;Parallel Lives&quot;</span>
282:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
283:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003371" class="method">
  <div id="M003371_title" class="title">
    <b>test_numericality_with_allow_nil_and_getter_method</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003371_source')" id="l_M003371_source">show source</a> ]</p>
  <div id="M003371_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 754</span>
754:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_numericality_with_allow_nil_and_getter_method</span>
755:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Developer</span>) <span class="ruby-keyword kw">do</span>
756:       <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">validates_numericality_of</span>( <span class="ruby-identifier">:salary</span>, <span class="ruby-identifier">:allow_nil</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>)
757:       <span class="ruby-identifier">developer</span> = <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;michael&quot;</span>, <span class="ruby-value str">&quot;salary&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>)
758:       <span class="ruby-identifier">developer</span>.<span class="ruby-identifier">instance_eval</span>(<span class="ruby-value str">&quot;def salary; read_attribute('salary') ? read_attribute('salary') : 100000; end&quot;</span>)
759:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">developer</span>.<span class="ruby-identifier">valid?</span>
760:     <span class="ruby-keyword kw">end</span>
761:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003367" class="method">
  <div id="M003367_title" class="title">
    <b>test_numericality_with_getter_method</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003367_source')" id="l_M003367_source">show source</a> ]</p>
  <div id="M003367_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 716</span>
716:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_numericality_with_getter_method</span>
717:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Developer</span>) <span class="ruby-keyword kw">do</span>
718:       <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">validates_numericality_of</span>( <span class="ruby-identifier">:salary</span> )
719:       <span class="ruby-identifier">developer</span> = <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;michael&quot;</span>, <span class="ruby-value str">&quot;salary&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>)
720:       <span class="ruby-identifier">developer</span>.<span class="ruby-identifier">instance_eval</span>(<span class="ruby-value str">&quot;def salary; read_attribute('salary') ? read_attribute('salary') : 100000; end&quot;</span>)
721:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">developer</span>.<span class="ruby-identifier">valid?</span>
722:     <span class="ruby-keyword kw">end</span>
723:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003383" class="method">
  <div id="M003383_title" class="title">
    <b>test_optionally_validates_length_of_using_is</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003383_source')" id="l_M003383_source">show source</a> ]</p>
  <div id="M003383_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 930</span>
930:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_optionally_validates_length_of_using_is</span>
931:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:is</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span>, <span class="ruby-identifier">:allow_nil</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>
932: 
933:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;valid&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
934:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
935: 
936:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-keyword kw">nil</span>
937:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
938:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003377" class="method">
  <div id="M003377_title" class="title">
    <b>test_optionally_validates_length_of_using_maximum</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003377_source')" id="l_M003377_source">show source</a> ]</p>
  <div id="M003377_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 831</span>
831:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_optionally_validates_length_of_using_maximum</span>
832:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span>, <span class="ruby-identifier">:allow_nil</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>
833: 
834:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;valid&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
835:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
836: 
837:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-keyword kw">nil</span>
838:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
839:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003375" class="method">
  <div id="M003375_title" class="title">
    <b>test_optionally_validates_length_of_using_minimum</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003375_source')" id="l_M003375_source">show source</a> ]</p>
  <div id="M003375_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 803</span>
803:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_optionally_validates_length_of_using_minimum</span>
804:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:minimum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span>, <span class="ruby-identifier">:allow_nil</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>
805: 
806:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;valid&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
807:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
808: 
809:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-keyword kw">nil</span>
810:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
811:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003379" class="method">
  <div id="M003379_title" class="title">
    <b>test_optionally_validates_length_of_using_within</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003379_source')" id="l_M003379_source">show source</a> ]</p>
  <div id="M003379_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 860</span>
860:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_optionally_validates_length_of_using_within</span>
861:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:content</span>, <span class="ruby-identifier">:within</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">3</span><span class="ruby-operator">..</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:allow_nil</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>
862: 
863:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">'title'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'abc'</span>, <span class="ruby-value str">'content'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'abcd'</span>)
864:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
865: 
866:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-keyword kw">nil</span>
867:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
868:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003380" class="method">
  <div id="M003380_title" class="title">
    <b>test_optionally_validates_length_of_using_within_on_create</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003380_source')" id="l_M003380_source">show source</a> ]</p>
  <div id="M003380_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 870</span>
870:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_optionally_validates_length_of_using_within_on_create</span>
871:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:content</span>, <span class="ruby-identifier">:within</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span><span class="ruby-operator">..</span><span class="ruby-value">10</span>, <span class="ruby-identifier">:on</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:create</span>, <span class="ruby-identifier">:too_long</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;my string is too long: {{count}}&quot;</span>
872: 
873:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;thisisnotvalid&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
874:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
875:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
876:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;my string is too long: 10&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-identifier">:title</span>]
877: 
878:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;butthisis&quot;</span>
879:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
880: 
881:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;few&quot;</span>
882:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
883: 
884:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">content</span> = <span class="ruby-value str">&quot;andthisislong&quot;</span>
885:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
886: 
887:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">content</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;iamfine&quot;</span>
888:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
889:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003400" class="method">
  <div id="M003400_title" class="title">
    <b>test_optionally_validates_length_of_using_within_on_create_utf8</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003400_source')" id="l_M003400_source">show source</a> ]</p>
  <div id="M003400_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1124</span>
1124:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_optionally_validates_length_of_using_within_on_create_utf8</span>
1125:     <span class="ruby-identifier">with_kcode</span>(<span class="ruby-value str">'UTF8'</span>) <span class="ruby-keyword kw">do</span>
1126:       <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:within</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span><span class="ruby-operator">..</span><span class="ruby-value">10</span>, <span class="ruby-identifier">:on</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:create</span>, <span class="ruby-identifier">:too_long</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;: {{count}}&quot;</span>
1127: 
1128:       <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;A&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1129:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
1130:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1131:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;: 10&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-identifier">:title</span>]
1132: 
1133:       <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;&quot;</span>
1134:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
1135: 
1136:       <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;3&quot;</span>
1137:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
1138: 
1139:       <span class="ruby-identifier">t</span>.<span class="ruby-identifier">content</span> = <span class="ruby-value str">&quot;&quot;</span>
1140:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
1141: 
1142:       <span class="ruby-identifier">t</span>.<span class="ruby-identifier">content</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;&quot;</span>
1143:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
1144:     <span class="ruby-keyword kw">end</span>
1145:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003381" class="method">
  <div id="M003381_title" class="title">
    <b>test_optionally_validates_length_of_using_within_on_update</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003381_source')" id="l_M003381_source">show source</a> ]</p>
  <div id="M003381_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 891</span>
891:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_optionally_validates_length_of_using_within_on_update</span>
892:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:content</span>, <span class="ruby-identifier">:within</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span><span class="ruby-operator">..</span><span class="ruby-value">10</span>, <span class="ruby-identifier">:on</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:update</span>, <span class="ruby-identifier">:too_short</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;my string is too short: {{count}}&quot;</span>
893: 
894:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;vali&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
895:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
896:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
897: 
898:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;not&quot;</span>
899:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
900:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
901:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;my string is too short: 5&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-identifier">:title</span>]
902: 
903:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;valid&quot;</span>
904:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">content</span> = <span class="ruby-value str">&quot;andthisistoolong&quot;</span>
905:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
906:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:content</span>)
907: 
908:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">content</span> = <span class="ruby-value str">&quot;iamfine&quot;</span>
909:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
910:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003401" class="method">
  <div id="M003401_title" class="title">
    <b>test_optionally_validates_length_of_using_within_on_update_utf8</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003401_source')" id="l_M003401_source">show source</a> ]</p>
  <div id="M003401_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1147</span>
1147:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_optionally_validates_length_of_using_within_on_update_utf8</span>
1148:     <span class="ruby-identifier">with_kcode</span>(<span class="ruby-value str">'UTF8'</span>) <span class="ruby-keyword kw">do</span>
1149:       <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:within</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span><span class="ruby-operator">..</span><span class="ruby-value">10</span>, <span class="ruby-identifier">:on</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:update</span>, <span class="ruby-identifier">:too_short</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;: {{count}}&quot;</span>
1150: 
1151:       <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;4&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1152:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
1153:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1154: 
1155:       <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;14&quot;</span>
1156:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
1157:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1158:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;: 5&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-identifier">:title</span>]
1159: 
1160:       <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;A&quot;</span>
1161:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
1162:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1163: 
1164:       <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;345&quot;</span>
1165:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
1166:     <span class="ruby-keyword kw">end</span>
1167:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003399" class="method">
  <div id="M003399_title" class="title">
    <b>test_optionally_validates_length_of_using_within_utf8</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003399_source')" id="l_M003399_source">show source</a> ]</p>
  <div id="M003399_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1109</span>
1109:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_optionally_validates_length_of_using_within_utf8</span>
1110:     <span class="ruby-identifier">with_kcode</span>(<span class="ruby-value str">'UTF8'</span>) <span class="ruby-keyword kw">do</span>
1111:       <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:within</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">3</span><span class="ruby-operator">..</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:allow_nil</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>
1112: 
1113:       <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;&quot;</span>)
1114:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">inspect</span>
1115: 
1116:       <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;&quot;</span>)
1117:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">inspect</span>
1118: 
1119:       <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-keyword kw">nil</span>
1120:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">inspect</span>
1121:     <span class="ruby-keyword kw">end</span>
1122:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003325" class="method">
  <div id="M003325_title" class="title">
    <b>test_scoped_create_without_attributes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003325_source')" id="l_M003325_source">show source</a> ]</p>
  <div id="M003325_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 159</span>
159:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_scoped_create_without_attributes</span>
160:     <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">with_scope</span>(<span class="ruby-identifier">:create</span> =<span class="ruby-operator">&gt;</span> {}) <span class="ruby-keyword kw">do</span>
161:       <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">RecordInvalid</span>) { <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">create!</span> }
162:     <span class="ruby-keyword kw">end</span>
163:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003317" class="method">
  <div id="M003317_title" class="title">
    <b>test_single_attr_validation_and_error_msg</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003317_source')" id="l_M003317_source">show source</a> ]</p>
  <div id="M003317_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 81</span>
81:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_single_attr_validation_and_error_msg</span>
82:     <span class="ruby-identifier">r</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span>
83:     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;There's no content!&quot;</span>
84:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">r</span>.<span class="ruby-identifier">valid?</span>
85:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">invalid?</span>(<span class="ruby-value str">&quot;content&quot;</span>), <span class="ruby-value str">&quot;A reply without content should mark that attribute as invalid&quot;</span>
86:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;Empty&quot;</span>, <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-value str">&quot;content&quot;</span>), <span class="ruby-value str">&quot;A reply without content should contain an error&quot;</span>
87:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">count</span>
88:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003330" class="method">
  <div id="M003330_title" class="title">
    <b>test_single_error_object_per_attr_iteration</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003330_source')" id="l_M003330_source">show source</a> ]</p>
  <div id="M003330_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 202</span>
202:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_single_error_object_per_attr_iteration</span>
203:     <span class="ruby-identifier">r</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span>
204:     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">save</span>
205: 
206:     <span class="ruby-identifier">errors</span> = []
207:     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">each_error</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">attr</span>, <span class="ruby-identifier">error</span><span class="ruby-operator">|</span> <span class="ruby-identifier">errors</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-identifier">attr</span>, <span class="ruby-identifier">error</span>.<span class="ruby-identifier">attribute</span>] }
208: 
209:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">errors</span>.<span class="ruby-identifier">include?</span>([<span class="ruby-value str">&quot;title&quot;</span>, <span class="ruby-value str">&quot;title&quot;</span>])
210:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">errors</span>.<span class="ruby-identifier">include?</span>([<span class="ruby-value str">&quot;content&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span>])
211:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003329" class="method">
  <div id="M003329_title" class="title">
    <b>test_single_error_string_per_attr_iteration</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003329_source')" id="l_M003329_source">show source</a> ]</p>
  <div id="M003329_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 191</span>
191:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_single_error_string_per_attr_iteration</span>
192:     <span class="ruby-identifier">r</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span>
193:     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">save</span>
194: 
195:     <span class="ruby-identifier">errors</span> = []
196:     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">attr</span>, <span class="ruby-identifier">msg</span><span class="ruby-operator">|</span> <span class="ruby-identifier">errors</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-identifier">attr</span>, <span class="ruby-identifier">msg</span>] }
197: 
198:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">errors</span>.<span class="ruby-identifier">include?</span>([<span class="ruby-value str">&quot;title&quot;</span>, <span class="ruby-value str">&quot;Empty&quot;</span>])
199:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">errors</span>.<span class="ruby-identifier">include?</span>([<span class="ruby-value str">&quot;content&quot;</span>, <span class="ruby-value str">&quot;Empty&quot;</span>])
200:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003316" class="method">
  <div id="M003316_title" class="title">
    <b>test_single_field_validation</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003316_source')" id="l_M003316_source">show source</a> ]</p>
  <div id="M003316_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 72</span>
72:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_single_field_validation</span>
73:     <span class="ruby-identifier">r</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span>
74:     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;There's no content!&quot;</span>
75:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">r</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;A reply without content shouldn't be saveable&quot;</span>
76: 
77:     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">content</span> = <span class="ruby-value str">&quot;Messa content!&quot;</span>
78:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;A reply with content should be saveable&quot;</span>
79:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003339" class="method">
  <div id="M003339_title" class="title">
    <b>test_terms_of_service_agreement</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003339_source')" id="l_M003339_source">show source</a> ]</p>
  <div id="M003339_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 302</span>
302:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_terms_of_service_agreement</span>
303:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_acceptance_of</span>(<span class="ruby-identifier">:terms_of_service</span>, <span class="ruby-identifier">:on</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:create</span>)
304: 
305:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;We should be confirmed&quot;</span>,<span class="ruby-value str">&quot;terms_of_service&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;&quot;</span>)
306:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
307:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;must be accepted&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:terms_of_service</span>)
308: 
309:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">terms_of_service</span> = <span class="ruby-value str">&quot;1&quot;</span>
310:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
311:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003338" class="method">
  <div id="M003338_title" class="title">
    <b>test_terms_of_service_agreement_no_acceptance</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003338_source')" id="l_M003338_source">show source</a> ]</p>
  <div id="M003338_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 295</span>
295:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_terms_of_service_agreement_no_acceptance</span>
296:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_acceptance_of</span>(<span class="ruby-identifier">:terms_of_service</span>, <span class="ruby-identifier">:on</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:create</span>)
297: 
298:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;We should not be confirmed&quot;</span>)
299:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
300:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003341" class="method">
  <div id="M003341_title" class="title">
    <b>test_terms_of_service_agreement_with_accept_value</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003341_source')" id="l_M003341_source">show source</a> ]</p>
  <div id="M003341_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 325</span>
325:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_terms_of_service_agreement_with_accept_value</span>
326:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_acceptance_of</span>(<span class="ruby-identifier">:terms_of_service</span>, <span class="ruby-identifier">:on</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:create</span>, <span class="ruby-identifier">:accept</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;I agree.&quot;</span>)
327: 
328:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;We should be confirmed&quot;</span>, <span class="ruby-value str">&quot;terms_of_service&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;&quot;</span>)
329:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
330:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;must be accepted&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:terms_of_service</span>)
331: 
332:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">terms_of_service</span> = <span class="ruby-value str">&quot;I agree.&quot;</span>
333:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
334:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003409" class="method">
  <div id="M003409_title" class="title">
    <b>test_throw_away_typing</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003409_source')" id="l_M003409_source">show source</a> ]</p>
  <div id="M003409_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1248</span>
1248:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_throw_away_typing</span>
1249:     <span class="ruby-identifier">d</span> = <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;David&quot;</span>, <span class="ruby-value str">&quot;salary&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;100,000&quot;</span>)
1250:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">d</span>.<span class="ruby-identifier">valid?</span>
1251:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">100</span>, <span class="ruby-identifier">d</span>.<span class="ruby-identifier">salary</span>
1252:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;100,000&quot;</span>, <span class="ruby-identifier">d</span>.<span class="ruby-identifier">salary_before_type_cast</span>
1253:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003337" class="method">
  <div id="M003337_title" class="title">
    <b>test_title_confirmation</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003337_source')" id="l_M003337_source">show source</a> ]</p>
  <div id="M003337_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 285</span>
285:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_title_confirmation</span>
286:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_confirmation_of</span>(<span class="ruby-identifier">:title</span>)
287: 
288:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;We should be confirmed&quot;</span>,<span class="ruby-value str">&quot;title_confirmation&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;&quot;</span>)
289:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
290: 
291:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title_confirmation</span> = <span class="ruby-value str">&quot;We should be confirmed&quot;</span>
292:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
293:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003431" class="method">
  <div id="M003431_title" class="title">
    <b>test_unless_validation_using_block_false</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003431_source')" id="l_M003431_source">show source</a> ]</p>
  <div id="M003431_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1453</span>
1453:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_unless_validation_using_block_false</span>
1454:     <span class="ruby-comment cmt"># When the block returns false</span>
1455:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:too_long=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;hoo {{count}}&quot;</span>,
1456:       <span class="ruby-identifier">:unless</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">title</span> <span class="ruby-operator">!=</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>} )
1457:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1458:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1459:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1460:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;hoo 5&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
1461:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003429" class="method">
  <div id="M003429_title" class="title">
    <b>test_unless_validation_using_block_true</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003429_source')" id="l_M003429_source">show source</a> ]</p>
  <div id="M003429_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1435</span>
1435:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_unless_validation_using_block_true</span>
1436:     <span class="ruby-comment cmt"># When the block returns true</span>
1437:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:too_long=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;hoo {{count}}&quot;</span>,
1438:       <span class="ruby-identifier">:unless</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">content</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">4</span> } )
1439:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1440:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1441:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1442:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003423" class="method">
  <div id="M003423_title" class="title">
    <b>test_unless_validation_using_method_false</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003423_source')" id="l_M003423_source">show source</a> ]</p>
  <div id="M003423_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1382</span>
1382:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_unless_validation_using_method_false</span>
1383:     <span class="ruby-comment cmt"># When the method returns false</span>
1384:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:too_long=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;hoo {{count}}&quot;</span>, <span class="ruby-identifier">:unless</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:condition_is_true_but_its_not</span> )
1385:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1386:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1387:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1388:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;hoo 5&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
1389:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003421" class="method">
  <div id="M003421_title" class="title">
    <b>test_unless_validation_using_method_true</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003421_source')" id="l_M003421_source">show source</a> ]</p>
  <div id="M003421_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1366</span>
1366:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_unless_validation_using_method_true</span>
1367:     <span class="ruby-comment cmt"># When the method returns true</span>
1368:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:too_long=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;hoo {{count}}&quot;</span>, <span class="ruby-identifier">:unless</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:condition_is_true</span> )
1369:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1370:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1371:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1372:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003427" class="method">
  <div id="M003427_title" class="title">
    <b>test_unless_validation_using_string_false</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003427_source')" id="l_M003427_source">show source</a> ]</p>
  <div id="M003427_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1416</span>
1416:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_unless_validation_using_string_false</span>
1417:     <span class="ruby-comment cmt"># When the evaluated string returns false</span>
1418:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:too_long=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;hoo {{count}}&quot;</span>, <span class="ruby-identifier">:unless</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;false&quot;</span>)
1419:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1420:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1421:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1422:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;hoo 5&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
1423:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003425" class="method">
  <div id="M003425_title" class="title">
    <b>test_unless_validation_using_string_true</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003425_source')" id="l_M003425_source">show source</a> ]</p>
  <div id="M003425_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1400</span>
1400:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_unless_validation_using_string_true</span>
1401:     <span class="ruby-comment cmt"># When the evaluated string returns true</span>
1402:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:too_long=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;hoo {{count}}&quot;</span>, <span class="ruby-identifier">:unless</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;a = 1; a == 1&quot;</span> )
1403:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1404:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1405:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1406:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003407" class="method">
  <div id="M003407_title" class="title">
    <b>test_validate_block</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003407_source')" id="l_M003407_source">show source</a> ]</p>
  <div id="M003407_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1235</span>
1235:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_block</span>
1236:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validate</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">topic</span><span class="ruby-operator">|</span> <span class="ruby-identifier">topic</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span>(<span class="ruby-value str">&quot;title&quot;</span>, <span class="ruby-value str">&quot;will never be valid&quot;</span>) }
1237:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Title&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1238:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1239:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1240:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;will never be valid&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
1241:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003352" class="method">
  <div id="M003352_title" class="title">
    <b>test_validate_case_insensitive_uniqueness</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003352_source')" id="l_M003352_source">show source</a> ]</p>
  <div id="M003352_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 478</span>
478:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_case_insensitive_uniqueness</span>
479:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_uniqueness_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:parent_id</span>, <span class="ruby-identifier">:case_sensitive</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">false</span>, <span class="ruby-identifier">:allow_nil</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>)
480: 
481:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;I'm unique!&quot;</span>, <span class="ruby-identifier">:parent_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">2</span>)
482:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Should save t as unique&quot;</span>
483: 
484:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">content</span> = <span class="ruby-value str">&quot;Remaining unique&quot;</span>
485:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Should still save t as unique&quot;</span>
486: 
487:     <span class="ruby-identifier">t2</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;I'm UNIQUE!&quot;</span>, <span class="ruby-identifier">:parent_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>)
488:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Shouldn't be valid&quot;</span>
489:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Shouldn't save t2 as unique&quot;</span>
490:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
491:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:parent_id</span>)
492:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;has already been taken&quot;</span>, <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
493: 
494:     <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;I'm truly UNIQUE!&quot;</span>
495:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Shouldn't be valid&quot;</span>
496:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Shouldn't save t2 as unique&quot;</span>
497:     <span class="ruby-identifier">assert_nil</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
498:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:parent_id</span>)
499: 
500:     <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">parent_id</span> = <span class="ruby-value">4</span>
501:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Should now save t2 as unique&quot;</span>
502: 
503:     <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">parent_id</span> = <span class="ruby-keyword kw">nil</span>
504:     <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">title</span> = <span class="ruby-keyword kw">nil</span>
505:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;should validate with nil&quot;</span>
506:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;should save with nil&quot;</span>
507: 
508:     <span class="ruby-identifier">with_kcode</span>(<span class="ruby-value str">'UTF8'</span>) <span class="ruby-keyword kw">do</span>
509:       <span class="ruby-identifier">t_utf8</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;  !&quot;</span>)
510:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t_utf8</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Should save t_utf8 as unique&quot;</span>
511: 
512:       <span class="ruby-comment cmt"># If database hasn't UTF-8 character set, this test fails</span>
513:       <span class="ruby-keyword kw">if</span> <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">t_utf8</span>, <span class="ruby-identifier">:select</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'LOWER(title) AS title'</span>).<span class="ruby-identifier">title</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;  !&quot;</span>
514:         <span class="ruby-identifier">t2_utf8</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;  !&quot;</span>)
515:         <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2_utf8</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Shouldn't be valid&quot;</span>
516:         <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2_utf8</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Shouldn't save t2_utf8 as unique&quot;</span>
517:       <span class="ruby-keyword kw">end</span>
518:     <span class="ruby-keyword kw">end</span>
519:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003353" class="method">
  <div id="M003353_title" class="title">
    <b>test_validate_case_sensitive_uniqueness</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003353_source')" id="l_M003353_source">show source</a> ]</p>
  <div id="M003353_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 521</span>
521:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_case_sensitive_uniqueness</span>
522:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_uniqueness_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:case_sensitive</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>, <span class="ruby-identifier">:allow_nil</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>)
523: 
524:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;I'm unique!&quot;</span>)
525:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Should save t as unique&quot;</span>
526: 
527:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">content</span> = <span class="ruby-value str">&quot;Remaining unique&quot;</span>
528:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Should still save t as unique&quot;</span>
529: 
530:     <span class="ruby-identifier">t2</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;I'M UNIQUE!&quot;</span>)
531:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Should be valid&quot;</span>
532:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Should save t2 as unique&quot;</span>
533:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
534:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:parent_id</span>)
535:     <span class="ruby-identifier">assert_not_equal</span> <span class="ruby-value str">&quot;has already been taken&quot;</span>, <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
536: 
537:     <span class="ruby-identifier">t3</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;I'M uNiQUe!&quot;</span>)
538:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t3</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Should be valid&quot;</span>
539:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t3</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Should save t2 as unique&quot;</span>
540:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t3</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
541:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t3</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:parent_id</span>)
542:     <span class="ruby-identifier">assert_not_equal</span> <span class="ruby-value str">&quot;has already been taken&quot;</span>, <span class="ruby-identifier">t3</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
543:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003354" class="method">
  <div id="M003354_title" class="title">
    <b>test_validate_case_sensitive_uniqueness_with_attribute_passed_as_integer</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003354_source')" id="l_M003354_source">show source</a> ]</p>
  <div id="M003354_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 545</span>
545:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_case_sensitive_uniqueness_with_attribute_passed_as_integer</span>
546:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_uniqueness_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:case_sensitve</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>)
547:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-value str">'title'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">101</span>)
548: 
549:     <span class="ruby-identifier">t2</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">'title'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">101</span>)
550:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2</span>.<span class="ruby-identifier">valid?</span>
551:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
552:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003361" class="method">
  <div id="M003361_title" class="title">
    <b>test_validate_format</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003361_source')" id="l_M003361_source">show source</a> ]</p>
  <div id="M003361_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 627</span>
627:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_format</span>
628:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_format_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:content</span>, <span class="ruby-identifier">:with</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-regexp re">/^Validation\smacros \w+!$/</span>, <span class="ruby-identifier">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;is bad data&quot;</span>)
629: 
630:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;i'm incorrect&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Validation macros rule!&quot;</span>)
631:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Shouldn't be valid&quot;</span>
632:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Shouldn't save because it's invalid&quot;</span>
633:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is bad data&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
634:     <span class="ruby-identifier">assert_nil</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:content</span>)
635: 
636:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;Validation macros rule!&quot;</span>
637: 
638:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
639:     <span class="ruby-identifier">assert_nil</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
640: 
641:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ArgumentError</span>) { <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_format_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:content</span>) }
642:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003363" class="method">
  <div id="M003363_title" class="title">
    <b>test_validate_format_numeric</b>()
  </div>
  <div class="description">
  <p>
testing ticket 3142
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003363_source')" id="l_M003363_source">show source</a> ]</p>
  <div id="M003363_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 653</span>
653:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_format_numeric</span>
654:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_format_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:content</span>, <span class="ruby-identifier">:with</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-regexp re">/^[1-9][0-9]*$/</span>, <span class="ruby-identifier">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;is bad data&quot;</span>)
655: 
656:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;72x&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;6789&quot;</span>)
657:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Shouldn't be valid&quot;</span>
658:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Shouldn't save because it's invalid&quot;</span>
659:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is bad data&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
660:     <span class="ruby-identifier">assert_nil</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:content</span>)
661: 
662:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;-11&quot;</span>
663:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Shouldn't be valid&quot;</span>
664: 
665:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;03&quot;</span>
666:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Shouldn't be valid&quot;</span>
667: 
668:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;z44&quot;</span>
669:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Shouldn't be valid&quot;</span>
670: 
671:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;5v7&quot;</span>
672:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Shouldn't be valid&quot;</span>
673: 
674:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;1&quot;</span>
675: 
676:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
677:     <span class="ruby-identifier">assert_nil</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
678:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003362" class="method">
  <div id="M003362_title" class="title">
    <b>test_validate_format_with_allow_blank</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003362_source')" id="l_M003362_source">show source</a> ]</p>
  <div id="M003362_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 644</span>
644:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_format_with_allow_blank</span>
645:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_format_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:with</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-regexp re">/^Validation\smacros \w+!$/</span>, <span class="ruby-identifier">:allow_blank=</span><span class="ruby-operator">&gt;</span><span class="ruby-keyword kw">true</span>)
646:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Shouldn't be valid&quot;</span>).<span class="ruby-identifier">valid?</span>
647:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;&quot;</span>).<span class="ruby-identifier">valid?</span>
648:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>).<span class="ruby-identifier">valid?</span>
649:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Validation macros rule!&quot;</span>).<span class="ruby-identifier">valid?</span>
650:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003364" class="method">
  <div id="M003364_title" class="title">
    <b>test_validate_format_with_formatted_message</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003364_source')" id="l_M003364_source">show source</a> ]</p>
  <div id="M003364_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 680</span>
680:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_format_with_formatted_message</span>
681:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_format_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:with</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-regexp re">/^Valid Title$/</span>, <span class="ruby-identifier">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;can't be {{value}}&quot;</span>)
682:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'Invalid title'</span>)
683:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;can't be Invalid title&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
684:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003344" class="method">
  <div id="M003344_title" class="title">
    <b>test_validate_presences</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003344_source')" id="l_M003344_source">show source</a> ]</p>
  <div id="M003344_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 353</span>
353:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_presences</span>
354:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_presence_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:content</span>)
355: 
356:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>
357:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
358:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;can't be blank&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
359:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;can't be blank&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:content</span>)
360: 
361:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;something&quot;</span>
362:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">content</span>  = <span class="ruby-value str">&quot;   &quot;</span>
363: 
364:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
365:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;can't be blank&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:content</span>)
366: 
367:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">content</span> = <span class="ruby-value str">&quot;like stuff&quot;</span>
368: 
369:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
370:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003360" class="method">
  <div id="M003360_title" class="title">
    <b>test_validate_straight_inheritance_uniqueness</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003360_source')" id="l_M003360_source">show source</a> ]</p>
  <div id="M003360_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 598</span>
598:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_straight_inheritance_uniqueness</span>
599:     <span class="ruby-identifier">w1</span> = <span class="ruby-constant">IneptWizard</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Rincewind&quot;</span>, <span class="ruby-identifier">:city</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Ankh-Morpork&quot;</span>)
600:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">w1</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Saving w1&quot;</span>
601: 
602:     <span class="ruby-comment cmt"># Should use validation from base class (which is abstract)</span>
603:     <span class="ruby-identifier">w2</span> = <span class="ruby-constant">IneptWizard</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Rincewind&quot;</span>, <span class="ruby-identifier">:city</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Quirm&quot;</span>)
604:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">w2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;w2 shouldn't be valid&quot;</span>
605:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">w2</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:name</span>), <span class="ruby-value str">&quot;Should have errors for name&quot;</span>
606:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;has already been taken&quot;</span>, <span class="ruby-identifier">w2</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:name</span>), <span class="ruby-value str">&quot;Should have uniqueness message for name&quot;</span>
607: 
608:     <span class="ruby-identifier">w3</span> = <span class="ruby-constant">Conjurer</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Rincewind&quot;</span>, <span class="ruby-identifier">:city</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Quirm&quot;</span>)
609:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">w3</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;w3 shouldn't be valid&quot;</span>
610:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">w3</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:name</span>), <span class="ruby-value str">&quot;Should have errors for name&quot;</span>
611:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;has already been taken&quot;</span>, <span class="ruby-identifier">w3</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:name</span>), <span class="ruby-value str">&quot;Should have uniqueness message for name&quot;</span>
612: 
613:     <span class="ruby-identifier">w4</span> = <span class="ruby-constant">Conjurer</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;The Amazing Bonko&quot;</span>, <span class="ruby-identifier">:city</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Quirm&quot;</span>)
614:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">w4</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Saving w4&quot;</span>
615: 
616:     <span class="ruby-identifier">w5</span> = <span class="ruby-constant">Thaumaturgist</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;The Amazing Bonko&quot;</span>, <span class="ruby-identifier">:city</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Lancre&quot;</span>)
617:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">w5</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;w5 shouldn't be valid&quot;</span>
618:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">w5</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:name</span>), <span class="ruby-value str">&quot;Should have errors for name&quot;</span>
619:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;has already been taken&quot;</span>, <span class="ruby-identifier">w5</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:name</span>), <span class="ruby-value str">&quot;Should have uniqueness message for name&quot;</span>
620: 
621:     <span class="ruby-identifier">w6</span> = <span class="ruby-constant">Thaumaturgist</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Mustrum Ridcully&quot;</span>, <span class="ruby-identifier">:city</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Quirm&quot;</span>)
622:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">w6</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;w6 shouldn't be valid&quot;</span>
623:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">w6</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:city</span>), <span class="ruby-value str">&quot;Should have errors for city&quot;</span>
624:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;has already been taken&quot;</span>, <span class="ruby-identifier">w6</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:city</span>), <span class="ruby-value str">&quot;Should have uniqueness message for city&quot;</span>
625:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003347" class="method">
  <div id="M003347_title" class="title">
    <b>test_validate_uniqueness</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003347_source')" id="l_M003347_source">show source</a> ]</p>
  <div id="M003347_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 391</span>
391:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_uniqueness</span>
392:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_uniqueness_of</span>(<span class="ruby-identifier">:title</span>)
393: 
394:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;I'm uniqu!&quot;</span>)
395:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Should save t as unique&quot;</span>
396: 
397:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">content</span> = <span class="ruby-value str">&quot;Remaining unique&quot;</span>
398:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Should still save t as unique&quot;</span>
399: 
400:     <span class="ruby-identifier">t2</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;I'm uniqu!&quot;</span>)
401:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Shouldn't be valid&quot;</span>
402:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Shouldn't save t2 as unique&quot;</span>
403:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;has already been taken&quot;</span>, <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
404: 
405:     <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;Now Im really also unique&quot;</span>
406:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Should now save t2 as unique&quot;</span>
407:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003350" class="method">
  <div id="M003350_title" class="title">
    <b>test_validate_uniqueness_scoped_to_defining_class</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003350_source')" id="l_M003350_source">show source</a> ]</p>
  <div id="M003350_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 437</span>
437:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_uniqueness_scoped_to_defining_class</span>
438:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;What, me worry?&quot;</span>)
439: 
440:     <span class="ruby-identifier">r1</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">unique_replies</span>.<span class="ruby-identifier">create</span> <span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;r1&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;a barrel of fun&quot;</span>
441:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r1</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Saving r1&quot;</span>
442: 
443:     <span class="ruby-identifier">r2</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">silly_unique_replies</span>.<span class="ruby-identifier">create</span> <span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;r2&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;a barrel of fun&quot;</span>
444:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">r2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Saving r2&quot;</span>
445: 
446:     <span class="ruby-comment cmt"># Should succeed as validates_uniqueness_of only applies to</span>
447:     <span class="ruby-comment cmt"># UniqueReply and its subclasses</span>
448:     <span class="ruby-identifier">r3</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">create</span> <span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;r2&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;a barrel of fun&quot;</span>
449:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r3</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Saving r3&quot;</span>
450:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003357" class="method">
  <div id="M003357_title" class="title">
    <b>test_validate_uniqueness_with_columns_which_are_sql_keywords</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003357_source')" id="l_M003357_source">show source</a> ]</p>
  <div id="M003357_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 571</span>
571:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_uniqueness_with_columns_which_are_sql_keywords</span>
572:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Guid</span>) <span class="ruby-keyword kw">do</span>
573:       <span class="ruby-constant">Guid</span>.<span class="ruby-identifier">validates_uniqueness_of</span> <span class="ruby-identifier">:key</span>
574:       <span class="ruby-identifier">g</span> = <span class="ruby-constant">Guid</span>.<span class="ruby-identifier">new</span>
575:       <span class="ruby-identifier">g</span>.<span class="ruby-identifier">key</span> = <span class="ruby-value str">&quot;foo&quot;</span>
576:       <span class="ruby-identifier">assert_nothing_raised</span> { <span class="ruby-operator">!</span><span class="ruby-identifier">g</span>.<span class="ruby-identifier">valid?</span> }
577:     <span class="ruby-keyword kw">end</span>
578:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003358" class="method">
  <div id="M003358_title" class="title">
    <b>test_validate_uniqueness_with_limit</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003358_source')" id="l_M003358_source">show source</a> ]</p>
  <div id="M003358_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 580</span>
580:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_uniqueness_with_limit</span>
581:     <span class="ruby-comment cmt"># Event.title is limited to 5 characters</span>
582:     <span class="ruby-identifier">e1</span> = <span class="ruby-constant">Event</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;abcde&quot;</span>)
583:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">e1</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Could not create an event with a unique, 5 character title&quot;</span>
584:     <span class="ruby-identifier">e2</span> = <span class="ruby-constant">Event</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;abcdefgh&quot;</span>)
585:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">e2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Created an event whose title, with limit taken into account, is not unique&quot;</span>
586:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003359" class="method">
  <div id="M003359_title" class="title">
    <b>test_validate_uniqueness_with_limit_and_utf8</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003359_source')" id="l_M003359_source">show source</a> ]</p>
  <div id="M003359_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 588</span>
588:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_uniqueness_with_limit_and_utf8</span>
589:     <span class="ruby-identifier">with_kcode</span>(<span class="ruby-value str">'UTF8'</span>) <span class="ruby-keyword kw">do</span>
590:       <span class="ruby-comment cmt"># Event.title is limited to 5 characters</span>
591:       <span class="ruby-identifier">e1</span> = <span class="ruby-constant">Event</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;&quot;</span>)
592:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">e1</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Could not create an event with a unique, 5 character title&quot;</span>
593:       <span class="ruby-identifier">e2</span> = <span class="ruby-constant">Event</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;&quot;</span>)
594:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">e2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Created an event whose title, with limit taken into account, is not unique&quot;</span>
595:     <span class="ruby-keyword kw">end</span>
596:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003355" class="method">
  <div id="M003355_title" class="title">
    <b>test_validate_uniqueness_with_non_standard_table_names</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003355_source')" id="l_M003355_source">show source</a> ]</p>
  <div id="M003355_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 554</span>
554:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_uniqueness_with_non_standard_table_names</span>
555:     <span class="ruby-identifier">i1</span> = <span class="ruby-constant">WarehouseThing</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:value</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1000</span>)
556:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">i1</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;i1 should not be valid&quot;</span>
557:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">i1</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:value</span>), <span class="ruby-value str">&quot;Should not be empty&quot;</span>
558:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003349" class="method">
  <div id="M003349_title" class="title">
    <b>test_validate_uniqueness_with_scope</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003349_source')" id="l_M003349_source">show source</a> ]</p>
  <div id="M003349_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 416</span>
416:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_uniqueness_with_scope</span>
417:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Reply</span>) <span class="ruby-keyword kw">do</span>
418:       <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">validates_uniqueness_of</span>(<span class="ruby-identifier">:content</span>, <span class="ruby-identifier">:scope</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;parent_id&quot;</span>)
419: 
420:       <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;I'm unique!&quot;</span>)
421: 
422:       <span class="ruby-identifier">r1</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">create</span> <span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;r1&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;hello world&quot;</span>
423:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r1</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Saving r1&quot;</span>
424: 
425:       <span class="ruby-identifier">r2</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">create</span> <span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;r2&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;hello world&quot;</span>
426:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">r2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Saving r2 first time&quot;</span>
427: 
428:       <span class="ruby-identifier">r2</span>.<span class="ruby-identifier">content</span> = <span class="ruby-value str">&quot;something else&quot;</span>
429:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r2</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Saving r2 second time&quot;</span>
430: 
431:       <span class="ruby-identifier">t2</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;I'm unique too!&quot;</span>)
432:       <span class="ruby-identifier">r3</span> = <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">create</span> <span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;r3&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;hello world&quot;</span>
433:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r3</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Saving r3&quot;</span>
434:     <span class="ruby-keyword kw">end</span>
435:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003351" class="method">
  <div id="M003351_title" class="title">
    <b>test_validate_uniqueness_with_scope_array</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003351_source')" id="l_M003351_source">show source</a> ]</p>
  <div id="M003351_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 452</span>
452:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_uniqueness_with_scope_array</span>
453:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Reply</span>) <span class="ruby-keyword kw">do</span>
454:       <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">validates_uniqueness_of</span>(<span class="ruby-identifier">:author_name</span>, <span class="ruby-identifier">:scope</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-identifier">:author_email_address</span>, <span class="ruby-identifier">:parent_id</span>])
455: 
456:       <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;The earth is actually flat!&quot;</span>)
457: 
458:       <span class="ruby-identifier">r1</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">create</span> <span class="ruby-value str">&quot;author_name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;jeremy&quot;</span>, <span class="ruby-value str">&quot;author_email_address&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;jeremy@rubyonrails.com&quot;</span>, <span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;You're crazy!&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Crazy reply&quot;</span>
459:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r1</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Saving r1&quot;</span>
460: 
461:       <span class="ruby-identifier">r2</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">create</span> <span class="ruby-value str">&quot;author_name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;jeremy&quot;</span>, <span class="ruby-value str">&quot;author_email_address&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;jeremy@rubyonrails.com&quot;</span>, <span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;You're crazy!&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Crazy reply again...&quot;</span>
462:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">r2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Saving r2. Double reply by same author.&quot;</span>
463: 
464:       <span class="ruby-identifier">r2</span>.<span class="ruby-identifier">author_email_address</span> = <span class="ruby-value str">&quot;jeremy_alt_email@rubyonrails.com&quot;</span>
465:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r2</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Saving r2 the second time.&quot;</span>
466: 
467:       <span class="ruby-identifier">r3</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">create</span> <span class="ruby-value str">&quot;author_name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;jeremy&quot;</span>, <span class="ruby-value str">&quot;author_email_address&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;jeremy_alt_email@rubyonrails.com&quot;</span>, <span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;You're wrong&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;It's cubic&quot;</span>
468:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">r3</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Saving r3&quot;</span>
469: 
470:       <span class="ruby-identifier">r3</span>.<span class="ruby-identifier">author_name</span> = <span class="ruby-value str">&quot;jj&quot;</span>
471:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r3</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Saving r3 the second time.&quot;</span>
472: 
473:       <span class="ruby-identifier">r3</span>.<span class="ruby-identifier">author_name</span> = <span class="ruby-value str">&quot;jeremy&quot;</span>
474:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">r3</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Saving r3 the third time.&quot;</span>
475:     <span class="ruby-keyword kw">end</span>
476:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003342" class="method">
  <div id="M003342_title" class="title">
    <b>test_validates_acceptance_of_as_database_column</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003342_source')" id="l_M003342_source">show source</a> ]</p>
  <div id="M003342_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 336</span>
336:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_acceptance_of_as_database_column</span>
337:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Reply</span>) <span class="ruby-keyword kw">do</span>
338:       <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">validates_acceptance_of</span>(<span class="ruby-identifier">:author_name</span>)
339: 
340:       <span class="ruby-identifier">reply</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;author_name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Dan Brown&quot;</span>)
341:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;Dan Brown&quot;</span>, <span class="ruby-identifier">reply</span>[<span class="ruby-value str">&quot;author_name&quot;</span>]
342:     <span class="ruby-keyword kw">end</span>
343:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003410" class="method">
  <div id="M003410_title" class="title">
    <b>test_validates_acceptance_of_with_custom_error_using_quotes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003410_source')" id="l_M003410_source">show source</a> ]</p>
  <div id="M003410_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1255</span>
1255:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_acceptance_of_with_custom_error_using_quotes</span>
1256:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Developer</span>) <span class="ruby-keyword kw">do</span>
1257:       <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">validates_acceptance_of</span> <span class="ruby-identifier">:salary</span>, <span class="ruby-identifier">:message=</span><span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;This string contains 'single' and \&quot;double\&quot; quotes&quot;</span>
1258:       <span class="ruby-identifier">d</span> = <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">new</span>
1259:       <span class="ruby-identifier">d</span>.<span class="ruby-identifier">salary</span> = <span class="ruby-value str">&quot;0&quot;</span>
1260:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">d</span>.<span class="ruby-identifier">valid?</span>
1261:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;This string contains 'single' and \&quot;double\&quot; quotes&quot;</span>, <span class="ruby-identifier">d</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:salary</span>).<span class="ruby-identifier">last</span>
1262:     <span class="ruby-keyword kw">end</span>
1263:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003343" class="method">
  <div id="M003343_title" class="title">
    <b>test_validates_acceptance_of_with_non_existant_table</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003343_source')" id="l_M003343_source">show source</a> ]</p>
  <div id="M003343_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 345</span>
345:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_acceptance_of_with_non_existant_table</span>
346:     <span class="ruby-constant">Object</span>.<span class="ruby-identifier">const_set</span> <span class="ruby-identifier">:IncorporealModel</span>, <span class="ruby-constant">Class</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>)
347: 
348:     <span class="ruby-identifier">assert_nothing_raised</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">StatementInvalid</span> <span class="ruby-keyword kw">do</span>
349:       <span class="ruby-constant">IncorporealModel</span>.<span class="ruby-identifier">validates_acceptance_of</span>(<span class="ruby-identifier">:incorporeal_column</span>)
350:     <span class="ruby-keyword kw">end</span>
351:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003405" class="method">
  <div id="M003405_title" class="title">
    <b>test_validates_associated_many</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003405_source')" id="l_M003405_source">show source</a> ]</p>
  <div id="M003405_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1208</span>
1208:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_associated_many</span>
1209:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_associated</span>( <span class="ruby-identifier">:replies</span> )
1210:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1211:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">replies</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-identifier">r</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;A reply&quot;</span>), <span class="ruby-identifier">r2</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Another reply&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;non-empty&quot;</span>), <span class="ruby-identifier">r3</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Yet another reply&quot;</span>), <span class="ruby-identifier">r4</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;The last reply&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;non-empty&quot;</span>)]
1212:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1213:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:replies</span>)
1214:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">count</span>  <span class="ruby-comment cmt"># make sure all associated objects have been validated</span>
1215:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-identifier">r2</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">count</span>
1216:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">r3</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">count</span>
1217:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-identifier">r4</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">count</span>
1218:     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">content</span> = <span class="ruby-identifier">r3</span>.<span class="ruby-identifier">content</span> = <span class="ruby-value str">&quot;non-empty&quot;</span>
1219:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1220:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003432" class="method">
  <div id="M003432_title" class="title">
    <b>test_validates_associated_missing</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003432_source')" id="l_M003432_source">show source</a> ]</p>
  <div id="M003432_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1463</span>
1463:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_associated_missing</span>
1464:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Reply</span>) <span class="ruby-keyword kw">do</span>
1465:       <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">validates_presence_of</span>(<span class="ruby-identifier">:topic</span>)
1466:       <span class="ruby-identifier">r</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;A reply&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;with content!&quot;</span>)
1467:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">r</span>.<span class="ruby-identifier">valid?</span>
1468:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:topic</span>)
1469: 
1470:       <span class="ruby-identifier">r</span>.<span class="ruby-identifier">topic</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span> <span class="ruby-identifier">:first</span>
1471:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">valid?</span>
1472:     <span class="ruby-keyword kw">end</span>
1473:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003406" class="method">
  <div id="M003406_title" class="title">
    <b>test_validates_associated_one</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003406_source')" id="l_M003406_source">show source</a> ]</p>
  <div id="M003406_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1222</span>
1222:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_associated_one</span>
1223:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Reply</span>) <span class="ruby-keyword kw">do</span>
1224:       <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">validates_associated</span>( <span class="ruby-identifier">:topic</span> )
1225:       <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_presence_of</span>( <span class="ruby-identifier">:content</span> )
1226:       <span class="ruby-identifier">r</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;A reply&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;with content!&quot;</span>)
1227:       <span class="ruby-identifier">r</span>.<span class="ruby-identifier">topic</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>)
1228:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">r</span>.<span class="ruby-identifier">valid?</span>
1229:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:topic</span>)
1230:       <span class="ruby-identifier">r</span>.<span class="ruby-identifier">topic</span>.<span class="ruby-identifier">content</span> = <span class="ruby-value str">&quot;non-empty&quot;</span>
1231:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">valid?</span>
1232:     <span class="ruby-keyword kw">end</span>
1233:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003419" class="method">
  <div id="M003419_title" class="title">
    <b>test_validates_associated_with_custom_message_using_quotes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003419_source')" id="l_M003419_source">show source</a> ]</p>
  <div id="M003419_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1346</span>
1346:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_associated_with_custom_message_using_quotes</span>
1347:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Reply</span>) <span class="ruby-keyword kw">do</span>
1348:       <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">validates_associated</span> <span class="ruby-identifier">:topic</span>, <span class="ruby-identifier">:message=</span><span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;This string contains 'single' and \&quot;double\&quot; quotes&quot;</span>
1349:       <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_presence_of</span> <span class="ruby-identifier">:content</span>
1350:       <span class="ruby-identifier">r</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;A reply&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;with content!&quot;</span>)
1351:       <span class="ruby-identifier">r</span>.<span class="ruby-identifier">topic</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>)
1352:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">r</span>.<span class="ruby-identifier">valid?</span>
1353:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;This string contains 'single' and \&quot;double\&quot; quotes&quot;</span>, <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:topic</span>)
1354:     <span class="ruby-keyword kw">end</span>
1355:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003411" class="method">
  <div id="M003411_title" class="title">
    <b>test_validates_confirmation_of_with_custom_error_using_quotes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003411_source')" id="l_M003411_source">show source</a> ]</p>
  <div id="M003411_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1265</span>
1265:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_confirmation_of_with_custom_error_using_quotes</span>
1266:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Developer</span>) <span class="ruby-keyword kw">do</span>
1267:       <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">validates_confirmation_of</span> <span class="ruby-identifier">:name</span>, <span class="ruby-identifier">:message=</span><span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;confirm 'single' and \&quot;double\&quot; quotes&quot;</span>
1268:       <span class="ruby-identifier">d</span> = <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">new</span>
1269:       <span class="ruby-identifier">d</span>.<span class="ruby-identifier">name</span> = <span class="ruby-value str">&quot;John&quot;</span>
1270:       <span class="ruby-identifier">d</span>.<span class="ruby-identifier">name_confirmation</span> = <span class="ruby-value str">&quot;Johnny&quot;</span>
1271:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">d</span>.<span class="ruby-identifier">valid?</span>
1272:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;confirm 'single' and \&quot;double\&quot; quotes&quot;</span>, <span class="ruby-identifier">d</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:name</span>)
1273:     <span class="ruby-keyword kw">end</span>
1274:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003335" class="method">
  <div id="M003335_title" class="title">
    <b>test_validates_each</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003335_source')" id="l_M003335_source">show source</a> ]</p>
  <div id="M003335_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 255</span>
255:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_each</span>
256:     <span class="ruby-identifier">hits</span> = <span class="ruby-value">0</span>
257:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_each</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:content</span>, [<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:content</span>]) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">record</span>, <span class="ruby-identifier">attr</span><span class="ruby-operator">|</span>
258:       <span class="ruby-identifier">record</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span> <span class="ruby-identifier">attr</span>, <span class="ruby-value str">'gotcha'</span>
259:       <span class="ruby-identifier">hits</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
260:     <span class="ruby-keyword kw">end</span>
261:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;valid&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
262:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
263:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">4</span>, <span class="ruby-identifier">hits</span>
264:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-node">%w(gotcha gotcha)</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
265:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-node">%w(gotcha gotcha)</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:content</span>)
266:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003372" class="method">
  <div id="M003372_title" class="title">
    <b>test_validates_exclusion_of</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003372_source')" id="l_M003372_source">show source</a> ]</p>
  <div id="M003372_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 763</span>
763:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_exclusion_of</span>
764:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_exclusion_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:in</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">%w( abe monkey )</span> )
765: 
766:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;something&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;abc&quot;</span>).<span class="ruby-identifier">valid?</span>
767:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;monkey&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;abc&quot;</span>).<span class="ruby-identifier">valid?</span>
768:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003373" class="method">
  <div id="M003373_title" class="title">
    <b>test_validates_exclusion_of_with_formatted_message</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003373_source')" id="l_M003373_source">show source</a> ]</p>
  <div id="M003373_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 770</span>
770:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_exclusion_of_with_formatted_message</span>
771:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_exclusion_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:in</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">%w( abe monkey )</span>, <span class="ruby-identifier">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;option {{value}} is restricted&quot;</span> )
772: 
773:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;something&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;abc&quot;</span>)
774: 
775:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;monkey&quot;</span>)
776:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
777:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
778:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;option monkey is restricted&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
779:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003412" class="method">
  <div id="M003412_title" class="title">
    <b>test_validates_format_of_with_custom_error_using_quotes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003412_source')" id="l_M003412_source">show source</a> ]</p>
  <div id="M003412_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1276</span>
1276:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_format_of_with_custom_error_using_quotes</span>
1277:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Developer</span>) <span class="ruby-keyword kw">do</span>
1278:       <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">validates_format_of</span> <span class="ruby-identifier">:name</span>, <span class="ruby-identifier">:with</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-regexp re">/^(A-Z*)$/</span>, <span class="ruby-identifier">:message=</span><span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;format 'single' and \&quot;double\&quot; quotes&quot;</span>
1279:       <span class="ruby-identifier">d</span> = <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">new</span>
1280:       <span class="ruby-identifier">d</span>.<span class="ruby-identifier">name</span> = <span class="ruby-identifier">d</span>.<span class="ruby-identifier">name_confirmation</span> = <span class="ruby-value str">&quot;John 32&quot;</span>
1281:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">d</span>.<span class="ruby-identifier">valid?</span>
1282:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;format 'single' and \&quot;double\&quot; quotes&quot;</span>, <span class="ruby-identifier">d</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:name</span>)
1283:     <span class="ruby-keyword kw">end</span>
1284:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003365" class="method">
  <div id="M003365_title" class="title">
    <b>test_validates_inclusion_of</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003365_source')" id="l_M003365_source">show source</a> ]</p>
  <div id="M003365_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 686</span>
686:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_inclusion_of</span>
687:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_inclusion_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:in</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">%w( a b c d e f g )</span> )
688: 
689:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;a!&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;abc&quot;</span>).<span class="ruby-identifier">valid?</span>
690:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;a b&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;abc&quot;</span>).<span class="ruby-identifier">valid?</span>
691:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;def&quot;</span>).<span class="ruby-identifier">valid?</span>
692: 
693:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;a&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;I know you are but what am I?&quot;</span>)
694:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
695:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;uhoh&quot;</span>
696:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
697:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
698:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is not included in the list&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
699: 
700:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ArgumentError</span>) { <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_inclusion_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:in</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span> ) }
701:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ArgumentError</span>) { <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_inclusion_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:in</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>) }
702: 
703:     <span class="ruby-identifier">assert_nothing_raised</span>(<span class="ruby-constant">ArgumentError</span>) { <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_inclusion_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:in</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;hi!&quot;</span> ) }
704:     <span class="ruby-identifier">assert_nothing_raised</span>(<span class="ruby-constant">ArgumentError</span>) { <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_inclusion_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:in</span> =<span class="ruby-operator">&gt;</span> {} ) }
705:     <span class="ruby-identifier">assert_nothing_raised</span>(<span class="ruby-constant">ArgumentError</span>) { <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_inclusion_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:in</span> =<span class="ruby-operator">&gt;</span> [] ) }
706:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003366" class="method">
  <div id="M003366_title" class="title">
    <b>test_validates_inclusion_of_with_allow_nil</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003366_source')" id="l_M003366_source">show source</a> ]</p>
  <div id="M003366_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 708</span>
708:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_inclusion_of_with_allow_nil</span>
709:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_inclusion_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:in</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">%w( a b c d e f g )</span>, <span class="ruby-identifier">:allow_nil=</span><span class="ruby-operator">&gt;</span><span class="ruby-keyword kw">true</span> )
710: 
711:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;a!&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;abc&quot;</span>).<span class="ruby-identifier">valid?</span>
712:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;abc&quot;</span>).<span class="ruby-identifier">valid?</span>
713:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;abc&quot;</span>).<span class="ruby-identifier">valid?</span>
714:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003413" class="method">
  <div id="M003413_title" class="title">
    <b>test_validates_inclusion_of_with_custom_error_using_quotes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003413_source')" id="l_M003413_source">show source</a> ]</p>
  <div id="M003413_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1286</span>
1286:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_inclusion_of_with_custom_error_using_quotes</span>
1287:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Developer</span>) <span class="ruby-keyword kw">do</span>
1288:       <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">validates_inclusion_of</span> <span class="ruby-identifier">:salary</span>, <span class="ruby-identifier">:in</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1000</span><span class="ruby-operator">..</span><span class="ruby-value">80000</span>, <span class="ruby-identifier">:message=</span><span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;This string contains 'single' and \&quot;double\&quot; quotes&quot;</span>
1289:       <span class="ruby-identifier">d</span> = <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">new</span>
1290:       <span class="ruby-identifier">d</span>.<span class="ruby-identifier">salary</span> = <span class="ruby-value str">&quot;90,000&quot;</span>
1291:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">d</span>.<span class="ruby-identifier">valid?</span>
1292:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;This string contains 'single' and \&quot;double\&quot; quotes&quot;</span>, <span class="ruby-identifier">d</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:salary</span>).<span class="ruby-identifier">last</span>
1293:     <span class="ruby-keyword kw">end</span>
1294:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003370" class="method">
  <div id="M003370_title" class="title">
    <b>test_validates_inclusion_of_with_formatted_message</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003370_source')" id="l_M003370_source">show source</a> ]</p>
  <div id="M003370_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 743</span>
743:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_inclusion_of_with_formatted_message</span>
744:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_inclusion_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:in</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">%w( a b c d e f g )</span>, <span class="ruby-identifier">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;option {{value}} is not in the list&quot;</span> )
745: 
746:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;a&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;abc&quot;</span>).<span class="ruby-identifier">valid?</span>
747: 
748:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;abc&quot;</span>)
749:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
750:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
751:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;option uhoh is not in the list&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
752:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003392" class="method">
  <div id="M003392_title" class="title">
    <b>test_validates_length_of_custom_errors_for_in</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003392_source')" id="l_M003392_source">show source</a> ]</p>
  <div id="M003392_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1030</span>
1030:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_custom_errors_for_in</span>
1031:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:in</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">10</span><span class="ruby-operator">..</span><span class="ruby-value">20</span>, <span class="ruby-identifier">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;hoo {{count}}&quot;</span>)
1032:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1033:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1034:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1035:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;hoo 10&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
1036: 
1037:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhohuhohuhohuhohuhohuhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1038:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1039:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1040:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;hoo 20&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
1041:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003394" class="method">
  <div id="M003394_title" class="title">
    <b>test_validates_length_of_custom_errors_for_is_with_message</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003394_source')" id="l_M003394_source">show source</a> ]</p>
  <div id="M003394_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1051</span>
1051:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_custom_errors_for_is_with_message</span>
1052:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:is=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:message=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;boo {{count}}&quot;</span> )
1053:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1054:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1055:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1056:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;boo 5&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
1057:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003395" class="method">
  <div id="M003395_title" class="title">
    <b>test_validates_length_of_custom_errors_for_is_with_wrong_length</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003395_source')" id="l_M003395_source">show source</a> ]</p>
  <div id="M003395_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1059</span>
1059:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_custom_errors_for_is_with_wrong_length</span>
1060:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:is=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:wrong_length=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;hoo {{count}}&quot;</span> )
1061:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1062:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1063:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1064:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;hoo 5&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
1065:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003391" class="method">
  <div id="M003391_title" class="title">
    <b>test_validates_length_of_custom_errors_for_maximum_with_message</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003391_source')" id="l_M003391_source">show source</a> ]</p>
  <div id="M003391_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1022</span>
1022:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_custom_errors_for_maximum_with_message</span>
1023:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:message=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;boo {{count}}&quot;</span> )
1024:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1025:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1026:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1027:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;boo 5&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
1028:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003393" class="method">
  <div id="M003393_title" class="title">
    <b>test_validates_length_of_custom_errors_for_maximum_with_too_long</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003393_source')" id="l_M003393_source">show source</a> ]</p>
  <div id="M003393_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1043</span>
1043:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_custom_errors_for_maximum_with_too_long</span>
1044:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:too_long=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;hoo {{count}}&quot;</span> )
1045:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1046:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1047:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1048:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;hoo 5&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
1049:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003389" class="method">
  <div id="M003389_title" class="title">
    <b>test_validates_length_of_custom_errors_for_minimum_with_message</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003389_source')" id="l_M003389_source">show source</a> ]</p>
  <div id="M003389_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1006</span>
1006:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_custom_errors_for_minimum_with_message</span>
1007:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:minimum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:message=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;boo {{count}}&quot;</span> )
1008:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1009:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1010:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1011:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;boo 5&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
1012:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003390" class="method">
  <div id="M003390_title" class="title">
    <b>test_validates_length_of_custom_errors_for_minimum_with_too_short</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003390_source')" id="l_M003390_source">show source</a> ]</p>
  <div id="M003390_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1014</span>
1014:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_custom_errors_for_minimum_with_too_short</span>
1015:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:minimum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:too_short=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;hoo {{count}}&quot;</span> )
1016:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1017:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1018:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1019:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;hoo 5&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
1020:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003388" class="method">
  <div id="M003388_title" class="title">
    <b>test_validates_length_of_nasty_params</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003388_source')" id="l_M003388_source">show source</a> ]</p>
  <div id="M003388_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 995</span>
 995:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_nasty_params</span>
 996:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ArgumentError</span>) { <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:minimum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">6</span>, <span class="ruby-identifier">:maximum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">9</span>) }
 997:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ArgumentError</span>) { <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:within=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">6</span>, <span class="ruby-identifier">:maximum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">9</span>) }
 998:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ArgumentError</span>) { <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:within=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">6</span>, <span class="ruby-identifier">:minimum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">9</span>) }
 999:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ArgumentError</span>) { <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:within=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">6</span>, <span class="ruby-identifier">:is=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">9</span>) }
1000:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ArgumentError</span>) { <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:minimum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;a&quot;</span>) }
1001:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ArgumentError</span>) { <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;a&quot;</span>) }
1002:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ArgumentError</span>) { <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:within=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;a&quot;</span>) }
1003:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ArgumentError</span>) { <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:is=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;a&quot;</span>) }
1004:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003384" class="method">
  <div id="M003384_title" class="title">
    <b>test_validates_length_of_using_bignum</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003384_source')" id="l_M003384_source">show source</a> ]</p>
  <div id="M003384_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 940</span>
940:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_using_bignum</span>
941:     <span class="ruby-identifier">bigmin</span> = <span class="ruby-value">2</span> <span class="ruby-operator">**</span> <span class="ruby-value">30</span>
942:     <span class="ruby-identifier">bigmax</span> = <span class="ruby-value">2</span> <span class="ruby-operator">**</span> <span class="ruby-value">32</span>
943:     <span class="ruby-identifier">bigrange</span> = <span class="ruby-identifier">bigmin</span><span class="ruby-operator">...</span><span class="ruby-identifier">bigmax</span>
944:     <span class="ruby-identifier">assert_nothing_raised</span> <span class="ruby-keyword kw">do</span>
945:       <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:is</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">bigmin</span> <span class="ruby-operator">+</span> <span class="ruby-value">5</span>
946:       <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:within</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">bigrange</span>
947:       <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:in</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">bigrange</span>
948:       <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:minimum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">bigmin</span>
949:       <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">bigmax</span>
950:     <span class="ruby-keyword kw">end</span>
951:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003382" class="method">
  <div id="M003382_title" class="title">
    <b>test_validates_length_of_using_is</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003382_source')" id="l_M003382_source">show source</a> ]</p>
  <div id="M003382_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 912</span>
912:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_using_is</span>
913:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:is</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span>
914: 
915:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;valid&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
916:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
917: 
918:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;notvalid&quot;</span>
919:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
920:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
921:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is the wrong length (should be 5 characters)&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
922: 
923:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;&quot;</span>
924:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
925: 
926:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-keyword kw">nil</span>
927:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
928:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003402" class="method">
  <div id="M003402_title" class="title">
    <b>test_validates_length_of_using_is_utf8</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003402_source')" id="l_M003402_source">show source</a> ]</p>
  <div id="M003402_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1169</span>
1169:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_using_is_utf8</span>
1170:     <span class="ruby-identifier">with_kcode</span>(<span class="ruby-value str">'UTF8'</span>) <span class="ruby-keyword kw">do</span>
1171:       <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:is</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span>
1172: 
1173:       <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;345&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1174:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1175: 
1176:       <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;345&quot;</span>
1177:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1178:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1179:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is the wrong length (should be 5 characters)&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
1180:     <span class="ruby-keyword kw">end</span>
1181:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003376" class="method">
  <div id="M003376_title" class="title">
    <b>test_validates_length_of_using_maximum</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003376_source')" id="l_M003376_source">show source</a> ]</p>
  <div id="M003376_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 813</span>
813:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_using_maximum</span>
814:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span>
815: 
816:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;valid&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
817:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
818: 
819:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;notvalid&quot;</span>
820:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
821:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
822:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is too long (maximum is 5 characters)&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
823: 
824:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;&quot;</span>
825:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
826: 
827:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-keyword kw">nil</span>
828:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
829:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003397" class="method">
  <div id="M003397_title" class="title">
    <b>test_validates_length_of_using_maximum_utf8</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003397_source')" id="l_M003397_source">show source</a> ]</p>
  <div id="M003397_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1081</span>
1081:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_using_maximum_utf8</span>
1082:     <span class="ruby-identifier">with_kcode</span>(<span class="ruby-value str">'UTF8'</span>) <span class="ruby-keyword kw">do</span>
1083:       <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span>
1084: 
1085:       <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1086:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1087: 
1088:       <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;34&quot;</span>
1089:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1090:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1091:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is too long (maximum is 5 characters)&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
1092:     <span class="ruby-keyword kw">end</span>
1093:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003374" class="method">
  <div id="M003374_title" class="title">
    <b>test_validates_length_of_using_minimum</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003374_source')" id="l_M003374_source">show source</a> ]</p>
  <div id="M003374_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 781</span>
781:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_using_minimum</span>
782:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:minimum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span>
783: 
784:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;valid&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
785:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
786: 
787:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;not&quot;</span>
788:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
789:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
790:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is too short (minimum is 5 characters)&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
791: 
792:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;&quot;</span>
793:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
794:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
795:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is too short (minimum is 5 characters)&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
796: 
797:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-keyword kw">nil</span>
798:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
799:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
800:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is too short (minimum is 5 characters)&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
801:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003396" class="method">
  <div id="M003396_title" class="title">
    <b>test_validates_length_of_using_minimum_utf8</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003396_source')" id="l_M003396_source">show source</a> ]</p>
  <div id="M003396_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1067</span>
1067:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_using_minimum_utf8</span>
1068:     <span class="ruby-identifier">with_kcode</span>(<span class="ruby-value str">'UTF8'</span>) <span class="ruby-keyword kw">do</span>
1069:       <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:minimum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span>
1070: 
1071:       <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1072:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1073: 
1074:       <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;&quot;</span>
1075:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1076:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1077:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is too short (minimum is 5 characters)&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
1078:     <span class="ruby-keyword kw">end</span>
1079:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003378" class="method">
  <div id="M003378_title" class="title">
    <b>test_validates_length_of_using_within</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003378_source')" id="l_M003378_source">show source</a> ]</p>
  <div id="M003378_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 841</span>
841:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_using_within</span>
842:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:content</span>, <span class="ruby-identifier">:within</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">3</span><span class="ruby-operator">..</span><span class="ruby-value">5</span>)
843: 
844:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;a!&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;I'm ooooooooh so very long&quot;</span>)
845:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
846:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is too short (minimum is 3 characters)&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
847:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is too long (maximum is 5 characters)&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:content</span>)
848: 
849:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-keyword kw">nil</span>
850:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">content</span> = <span class="ruby-keyword kw">nil</span>
851:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
852:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is too short (minimum is 3 characters)&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
853:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is too short (minimum is 3 characters)&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:content</span>)
854: 
855:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;abe&quot;</span>
856:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">content</span>  = <span class="ruby-value str">&quot;mad&quot;</span>
857:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
858:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003398" class="method">
  <div id="M003398_title" class="title">
    <b>test_validates_length_of_using_within_utf8</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003398_source')" id="l_M003398_source">show source</a> ]</p>
  <div id="M003398_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1095</span>
1095:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_using_within_utf8</span>
1096:     <span class="ruby-identifier">with_kcode</span>(<span class="ruby-value str">'UTF8'</span>) <span class="ruby-keyword kw">do</span>
1097:       <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:content</span>, <span class="ruby-identifier">:within</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">3</span><span class="ruby-operator">..</span><span class="ruby-value">5</span>)
1098: 
1099:       <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;12&quot;</span>)
1100:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1101:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is too short (minimum is 3 characters)&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1102:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is too long (maximum is 5 characters)&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:content</span>)
1103:       <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;&quot;</span>
1104:       <span class="ruby-identifier">t</span>.<span class="ruby-identifier">content</span>  = <span class="ruby-value str">&quot;12&quot;</span>
1105:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1106:     <span class="ruby-keyword kw">end</span>
1107:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003369" class="method">
  <div id="M003369_title" class="title">
    <b>test_validates_length_of_with_allow_blank</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003369_source')" id="l_M003369_source">show source</a> ]</p>
  <div id="M003369_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 734</span>
734:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_with_allow_blank</span>
735:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:is</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span>, <span class="ruby-identifier">:allow_blank=</span><span class="ruby-operator">&gt;</span><span class="ruby-keyword kw">true</span> )
736: 
737:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;ab&quot;</span>).<span class="ruby-identifier">valid?</span>
738:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;&quot;</span>).<span class="ruby-identifier">valid?</span>
739:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>).<span class="ruby-identifier">valid?</span>
740:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;abcde&quot;</span>).<span class="ruby-identifier">valid?</span>
741:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003368" class="method">
  <div id="M003368_title" class="title">
    <b>test_validates_length_of_with_allow_nil</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003368_source')" id="l_M003368_source">show source</a> ]</p>
  <div id="M003368_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 725</span>
725:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_with_allow_nil</span>
726:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:is</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span>, <span class="ruby-identifier">:allow_nil=</span><span class="ruby-operator">&gt;</span><span class="ruby-keyword kw">true</span> )
727: 
728:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;ab&quot;</span>).<span class="ruby-identifier">valid?</span>
729:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;&quot;</span>).<span class="ruby-identifier">valid?</span>
730:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>).<span class="ruby-identifier">valid?</span>
731:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;abcde&quot;</span>).<span class="ruby-identifier">valid?</span>
732:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003403" class="method">
  <div id="M003403_title" class="title">
    <b>test_validates_length_of_with_block</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003403_source')" id="l_M003403_source">show source</a> ]</p>
  <div id="M003403_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1183</span>
1183:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_with_block</span>
1184:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:content</span>, <span class="ruby-identifier">:minimum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span>, <span class="ruby-identifier">:too_short=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;Your essay must be at least {{count}} words.&quot;</span>,
1185:                                         <span class="ruby-identifier">:tokenizer</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">lambda</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">str</span><span class="ruby-operator">|</span> <span class="ruby-identifier">str</span>.<span class="ruby-identifier">scan</span>(<span class="ruby-regexp re">/\w+/</span>) }
1186:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-identifier">:content</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;this content should be long enough&quot;</span>)
1187:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1188: 
1189:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">content</span> = <span class="ruby-value str">&quot;not long enough&quot;</span>
1190:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1191:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:content</span>)
1192:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;Your essay must be at least 5 words.&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-identifier">:content</span>]
1193:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003416" class="method">
  <div id="M003416_title" class="title">
    <b>test_validates_length_of_with_custom_message_using_quotes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003416_source')" id="l_M003416_source">show source</a> ]</p>
  <div id="M003416_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1316</span>
1316:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_with_custom_message_using_quotes</span>
1317:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Developer</span>) <span class="ruby-keyword kw">do</span>
1318:       <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:name</span>, <span class="ruby-identifier">:minimum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">4</span>, <span class="ruby-identifier">:message=</span><span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;This string contains 'single' and \&quot;double\&quot; quotes&quot;</span>
1319:       <span class="ruby-identifier">d</span> = <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">new</span>
1320:       <span class="ruby-identifier">d</span>.<span class="ruby-identifier">name</span> = <span class="ruby-value str">&quot;Joe&quot;</span>
1321:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">d</span>.<span class="ruby-identifier">valid?</span>
1322:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;This string contains 'single' and \&quot;double\&quot; quotes&quot;</span>, <span class="ruby-identifier">d</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:name</span>)
1323:     <span class="ruby-keyword kw">end</span>
1324:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003414" class="method">
  <div id="M003414_title" class="title">
    <b>test_validates_length_of_with_custom_too_long_using_quotes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003414_source')" id="l_M003414_source">show source</a> ]</p>
  <div id="M003414_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1296</span>
1296:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_with_custom_too_long_using_quotes</span>
1297:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Developer</span>) <span class="ruby-keyword kw">do</span>
1298:       <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:name</span>, <span class="ruby-identifier">:maximum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">4</span>, <span class="ruby-identifier">:too_long=</span><span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;This string contains 'single' and \&quot;double\&quot; quotes&quot;</span>
1299:       <span class="ruby-identifier">d</span> = <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">new</span>
1300:       <span class="ruby-identifier">d</span>.<span class="ruby-identifier">name</span> = <span class="ruby-value str">&quot;Jeffrey&quot;</span>
1301:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">d</span>.<span class="ruby-identifier">valid?</span>
1302:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;This string contains 'single' and \&quot;double\&quot; quotes&quot;</span>, <span class="ruby-identifier">d</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:name</span>)
1303:     <span class="ruby-keyword kw">end</span>
1304:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003415" class="method">
  <div id="M003415_title" class="title">
    <b>test_validates_length_of_with_custom_too_short_using_quotes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003415_source')" id="l_M003415_source">show source</a> ]</p>
  <div id="M003415_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1306</span>
1306:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_with_custom_too_short_using_quotes</span>
1307:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Developer</span>) <span class="ruby-keyword kw">do</span>
1308:       <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:name</span>, <span class="ruby-identifier">:minimum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">4</span>, <span class="ruby-identifier">:too_short=</span><span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;This string contains 'single' and \&quot;double\&quot; quotes&quot;</span>
1309:       <span class="ruby-identifier">d</span> = <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">new</span>
1310:       <span class="ruby-identifier">d</span>.<span class="ruby-identifier">name</span> = <span class="ruby-value str">&quot;Joe&quot;</span>
1311:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">d</span>.<span class="ruby-identifier">valid?</span>
1312:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;This string contains 'single' and \&quot;double\&quot; quotes&quot;</span>, <span class="ruby-identifier">d</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:name</span>)
1313:     <span class="ruby-keyword kw">end</span>
1314:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003385" class="method">
  <div id="M003385_title" class="title">
    <b>test_validates_length_with_globally_modified_error_message</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003385_source')" id="l_M003385_source">show source</a> ]</p>
  <div id="M003385_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 953</span>
953:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_with_globally_modified_error_message</span>
954:     <span class="ruby-identifier">defaults</span> = <span class="ruby-constant">ActiveSupport</span><span class="ruby-operator">::</span><span class="ruby-constant">Deprecation</span>.<span class="ruby-identifier">silence</span> { <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Errors</span>.<span class="ruby-identifier">default_error_messages</span> }
955:     <span class="ruby-identifier">original_message</span> = <span class="ruby-identifier">defaults</span>[<span class="ruby-identifier">:too_short</span>]
956:     <span class="ruby-identifier">defaults</span>[<span class="ruby-identifier">:too_short</span>] = <span class="ruby-value str">'tu est trops petit hombre {{count}}'</span>
957: 
958:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:minimum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">10</span>
959:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'too short'</span>)
960:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
961: 
962:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'tu est trops petit hombre 10'</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">'title'</span>]
963: 
964:   <span class="ruby-keyword kw">ensure</span>
965:     <span class="ruby-identifier">defaults</span>[<span class="ruby-identifier">:too_short</span>] = <span class="ruby-identifier">original_message</span>
966:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003346" class="method">
  <div id="M003346_title" class="title">
    <b>test_validates_presence_of_belongs_to_association__existing_parent</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003346_source')" id="l_M003346_source">show source</a> ]</p>
  <div id="M003346_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 382</span>
382:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_presence_of_belongs_to_association__existing_parent</span>
383:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Interest</span>) <span class="ruby-keyword kw">do</span>
384:       <span class="ruby-constant">Interest</span>.<span class="ruby-identifier">validates_presence_of</span>(<span class="ruby-identifier">:man</span>)
385:       <span class="ruby-identifier">man</span> = <span class="ruby-constant">Man</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'John'</span>)
386:       <span class="ruby-identifier">interest</span> = <span class="ruby-identifier">man</span>.<span class="ruby-identifier">interests</span>.<span class="ruby-identifier">build</span>(<span class="ruby-identifier">:topic</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'Airplanes'</span>)
387:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">interest</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Expected interest to be valid, but was not. Interest should have a man object associated&quot;</span>
388:     <span class="ruby-keyword kw">end</span>
389:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003345" class="method">
  <div id="M003345_title" class="title">
    <b>test_validates_presence_of_belongs_to_association__parent_is_new_record</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003345_source')" id="l_M003345_source">show source</a> ]</p>
  <div id="M003345_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 372</span>
372:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_presence_of_belongs_to_association__parent_is_new_record</span>
373:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Interest</span>) <span class="ruby-keyword kw">do</span>
374:       <span class="ruby-comment cmt"># Note that Interest and Man have the :inverse_of option set</span>
375:       <span class="ruby-constant">Interest</span>.<span class="ruby-identifier">validates_presence_of</span>(<span class="ruby-identifier">:man</span>)
376:       <span class="ruby-identifier">man</span> = <span class="ruby-constant">Man</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'John'</span>)
377:       <span class="ruby-identifier">interest</span> = <span class="ruby-identifier">man</span>.<span class="ruby-identifier">interests</span>.<span class="ruby-identifier">build</span>(<span class="ruby-identifier">:topic</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'Airplanes'</span>)
378:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">interest</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Expected interest to be valid, but was not. Interest should have a man object associated&quot;</span>
379:     <span class="ruby-keyword kw">end</span>
380:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003417" class="method">
  <div id="M003417_title" class="title">
    <b>test_validates_presence_of_with_custom_message_using_quotes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003417_source')" id="l_M003417_source">show source</a> ]</p>
  <div id="M003417_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1326</span>
1326:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_presence_of_with_custom_message_using_quotes</span>
1327:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Developer</span>) <span class="ruby-keyword kw">do</span>
1328:       <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">validates_presence_of</span> <span class="ruby-identifier">:non_existent</span>, <span class="ruby-identifier">:message=</span><span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;This string contains 'single' and \&quot;double\&quot; quotes&quot;</span>
1329:       <span class="ruby-identifier">d</span> = <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">new</span>
1330:       <span class="ruby-identifier">d</span>.<span class="ruby-identifier">name</span> = <span class="ruby-value str">&quot;Joe&quot;</span>
1331:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">d</span>.<span class="ruby-identifier">valid?</span>
1332:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;This string contains 'single' and \&quot;double\&quot; quotes&quot;</span>, <span class="ruby-identifier">d</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:non_existent</span>)
1333:     <span class="ruby-keyword kw">end</span>
1334:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003386" class="method">
  <div id="M003386_title" class="title">
    <b>test_validates_size_of_association</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003386_source')" id="l_M003386_source">show source</a> ]</p>
  <div id="M003386_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 968</span>
968:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_size_of_association</span>
969:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Owner</span>) <span class="ruby-keyword kw">do</span>
970:       <span class="ruby-identifier">assert_nothing_raised</span> { <span class="ruby-constant">Owner</span>.<span class="ruby-identifier">validates_size_of</span> <span class="ruby-identifier">:pets</span>, <span class="ruby-identifier">:minimum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span> }
971:       <span class="ruby-identifier">o</span> = <span class="ruby-constant">Owner</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">'name'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'nopets'</span>)
972:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">o</span>.<span class="ruby-identifier">save</span>
973:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:pets</span>)
974:       <span class="ruby-identifier">pet</span> = <span class="ruby-identifier">o</span>.<span class="ruby-identifier">pets</span>.<span class="ruby-identifier">build</span>(<span class="ruby-value str">'name'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'apet'</span>)
975:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">valid?</span>
976:     <span class="ruby-keyword kw">end</span>
977:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003387" class="method">
  <div id="M003387_title" class="title">
    <b>test_validates_size_of_association_using_within</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003387_source')" id="l_M003387_source">show source</a> ]</p>
  <div id="M003387_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 979</span>
979:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_size_of_association_using_within</span>
980:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Owner</span>) <span class="ruby-keyword kw">do</span>
981:       <span class="ruby-identifier">assert_nothing_raised</span> { <span class="ruby-constant">Owner</span>.<span class="ruby-identifier">validates_size_of</span> <span class="ruby-identifier">:pets</span>, <span class="ruby-identifier">:within</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">2</span> }
982:       <span class="ruby-identifier">o</span> = <span class="ruby-constant">Owner</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">'name'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'nopets'</span>)
983:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">o</span>.<span class="ruby-identifier">save</span>
984:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:pets</span>)
985: 
986:       <span class="ruby-identifier">pet</span> = <span class="ruby-identifier">o</span>.<span class="ruby-identifier">pets</span>.<span class="ruby-identifier">build</span>(<span class="ruby-value str">'name'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'apet'</span>)
987:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">valid?</span>
988: 
989:       <span class="ruby-value">2</span>.<span class="ruby-identifier">times</span> { <span class="ruby-identifier">o</span>.<span class="ruby-identifier">pets</span>.<span class="ruby-identifier">build</span>(<span class="ruby-value str">'name'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'apet'</span>) }
990:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">o</span>.<span class="ruby-identifier">save</span>
991:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:pets</span>)
992:     <span class="ruby-keyword kw">end</span>
993:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003404" class="method">
  <div id="M003404_title" class="title">
    <b>test_validates_size_of_association_utf8</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003404_source')" id="l_M003404_source">show source</a> ]</p>
  <div id="M003404_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1195</span>
1195:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_size_of_association_utf8</span>
1196:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Owner</span>) <span class="ruby-keyword kw">do</span>
1197:       <span class="ruby-identifier">with_kcode</span>(<span class="ruby-value str">'UTF8'</span>) <span class="ruby-keyword kw">do</span>
1198:         <span class="ruby-identifier">assert_nothing_raised</span> { <span class="ruby-constant">Owner</span>.<span class="ruby-identifier">validates_size_of</span> <span class="ruby-identifier">:pets</span>, <span class="ruby-identifier">:minimum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span> }
1199:         <span class="ruby-identifier">o</span> = <span class="ruby-constant">Owner</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">'name'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">''</span>)
1200:         <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">o</span>.<span class="ruby-identifier">save</span>
1201:         <span class="ruby-identifier">assert</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:pets</span>)
1202:         <span class="ruby-identifier">o</span>.<span class="ruby-identifier">pets</span>.<span class="ruby-identifier">build</span>(<span class="ruby-value str">'name'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">''</span>)
1203:         <span class="ruby-identifier">assert</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">valid?</span>
1204:       <span class="ruby-keyword kw">end</span>
1205:     <span class="ruby-keyword kw">end</span>
1206:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003356" class="method">
  <div id="M003356_title" class="title">
    <b>test_validates_uniqueness_inside_with_scope</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003356_source')" id="l_M003356_source">show source</a> ]</p>
  <div id="M003356_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 560</span>
560:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_uniqueness_inside_with_scope</span>
561:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_uniqueness_of</span>(<span class="ruby-identifier">:title</span>)
562: 
563:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">with_scope</span>(<span class="ruby-identifier">:find</span> =<span class="ruby-operator">&gt;</span> { <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> { <span class="ruby-identifier">:author_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;David&quot;</span> } }) <span class="ruby-keyword kw">do</span>
564:       <span class="ruby-identifier">t1</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;I'm unique!&quot;</span>, <span class="ruby-value str">&quot;author_name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Mary&quot;</span>)
565:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t1</span>.<span class="ruby-identifier">save</span>
566:       <span class="ruby-identifier">t2</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;I'm unique!&quot;</span>, <span class="ruby-value str">&quot;author_name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;David&quot;</span>)
567:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2</span>.<span class="ruby-identifier">valid?</span>
568:     <span class="ruby-keyword kw">end</span>
569:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003418" class="method">
  <div id="M003418_title" class="title">
    <b>test_validates_uniqueness_of_with_custom_message_using_quotes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003418_source')" id="l_M003418_source">show source</a> ]</p>
  <div id="M003418_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1336</span>
1336:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_uniqueness_of_with_custom_message_using_quotes</span>
1337:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Developer</span>) <span class="ruby-keyword kw">do</span>
1338:       <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">validates_uniqueness_of</span> <span class="ruby-identifier">:name</span>, <span class="ruby-identifier">:message=</span><span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;This string contains 'single' and \&quot;double\&quot; quotes&quot;</span>
1339:       <span class="ruby-identifier">d</span> = <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">new</span>
1340:       <span class="ruby-identifier">d</span>.<span class="ruby-identifier">name</span> = <span class="ruby-value str">&quot;David&quot;</span>
1341:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">d</span>.<span class="ruby-identifier">valid?</span>
1342:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;This string contains 'single' and \&quot;double\&quot; quotes&quot;</span>, <span class="ruby-identifier">d</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:name</span>)
1343:     <span class="ruby-keyword kw">end</span>
1344:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003348" class="method">
  <div id="M003348_title" class="title">
    <b>test_validates_uniquness_with_newline_chars</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003348_source')" id="l_M003348_source">show source</a> ]</p>
  <div id="M003348_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 409</span>
409:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_uniquness_with_newline_chars</span>
410:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_uniqueness_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:case_sensitive</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">false</span>)
411: 
412:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;new\nline&quot;</span>)
413:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Should save t as unique&quot;</span>
414:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003434" class="method">
  <div id="M003434_title" class="title">
    <b>test_validation_order</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003434_source')" id="l_M003434_source">show source</a> ]</p>
  <div id="M003434_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1484</span>
1484:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validation_order</span>
1485:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_presence_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:author_name</span>
1486:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validate</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">topic</span><span class="ruby-operator">|</span> <span class="ruby-identifier">topic</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span>(<span class="ruby-value str">'author_email_address'</span>, <span class="ruby-value str">'will never be valid'</span>)}
1487:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:content</span>, <span class="ruby-identifier">:minimum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">2</span>
1488: 
1489:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span> <span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">''</span>
1490:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1491:     <span class="ruby-identifier">e</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">instance_variable_get</span> <span class="ruby-value str">'@errors'</span>
1492:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'title'</span>, <span class="ruby-identifier">key</span> = <span class="ruby-identifier">e</span>.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">first</span>
1493:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;can't be blank&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">key</span>).<span class="ruby-identifier">first</span>
1494:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'is too short (minimum is 2 characters)'</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">key</span>).<span class="ruby-identifier">second</span>
1495:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'author_name'</span>, <span class="ruby-identifier">key</span> = <span class="ruby-identifier">e</span>.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">second</span>
1496:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;can't be blank&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">key</span>)
1497:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'author_email_address'</span>, <span class="ruby-identifier">key</span> = <span class="ruby-identifier">e</span>.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">third</span>
1498:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'will never be valid'</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">key</span>)
1499:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'content'</span>, <span class="ruby-identifier">key</span> = <span class="ruby-identifier">e</span>.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">fourth</span>
1500:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'is too short (minimum is 2 characters)'</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">key</span>)
1501:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003436" class="method">
  <div id="M003436_title" class="title">
    <b>test_validation_with_if_as_string</b>()
  </div>
  <div class="description">
  <p>
previous implementation of validates_presence_of eval&#8217;d the string
with the wrong binding, this regression test is to ensure that it works
correctly
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003436_source')" id="l_M003436_source">show source</a> ]</p>
  <div id="M003436_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1517</span>
1517:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validation_with_if_as_string</span>
1518:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_presence_of</span>(<span class="ruby-identifier">:title</span>)
1519:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_presence_of</span>(<span class="ruby-identifier">:author_name</span>, <span class="ruby-identifier">:if</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;title.to_s.match('important')&quot;</span>)
1520: 
1521:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>
1522:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;A topic without a title should not be valid&quot;</span>
1523:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">invalid?</span>(<span class="ruby-value str">&quot;author_name&quot;</span>), <span class="ruby-value str">&quot;A topic without an 'important' title should not require an author&quot;</span>
1524: 
1525:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;Just a title&quot;</span>
1526:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;A topic with a basic title should be valid&quot;</span>
1527: 
1528:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;A very important title&quot;</span>
1529:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;A topic with an important title, but without an author, should not be valid&quot;</span>
1530:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">invalid?</span>(<span class="ruby-value str">&quot;author_name&quot;</span>), <span class="ruby-value str">&quot;A topic with an 'important' title should require an author&quot;</span>
1531: 
1532:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">author_name</span> = <span class="ruby-value str">&quot;Hubert J. Farnsworth&quot;</span>
1533:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;A topic with an important title and author should be valid&quot;</span>
1534:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003328" class="method">
  <div id="M003328_title" class="title">
    <b>test_values_are_not_retrieved_unless_needed</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003328_source')" id="l_M003328_source">show source</a> ]</p>
  <div id="M003328_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 183</span>
183:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_values_are_not_retrieved_unless_needed</span>
184:     <span class="ruby-identifier">assert_nothing_raised</span> <span class="ruby-keyword kw">do</span>
185:       <span class="ruby-identifier">person</span> = <span class="ruby-constant">ProtectedPerson</span>.<span class="ruby-identifier">new</span>
186:       <span class="ruby-identifier">person</span>.<span class="ruby-identifier">special_error</span>
187:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;This method does not exist&quot;</span>, <span class="ruby-identifier">person</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-identifier">:special_error</span>]
188:     <span class="ruby-keyword kw">end</span>
189:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
</div>

  </div>