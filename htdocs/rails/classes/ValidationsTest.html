  <div id="C00000553">
<div class='banner'>
  <span class="file-title-prefix">Class</span><br />ValidationsTest<br/>
  In:
<a href="#" onclick="jsHref('files/activerecord/test/cases/validations_test_rb.html');">activerecord/test/cases/validations_test.rb</a>

Parent:&nbsp;
ActiveRecord::TestCase
</div>
 <!-- banner header -->

  <div id="bodyContent" >
      <div id="content">




  <div class="sectiontitle">Methods</div>
  <ul>
  <li><a href="index.html?a=M003307&name=test_create_with_exceptions_using_scope_and_empty_attributes" >test_create_with_exceptions_using_scope_and_empty_attributes</a></li>
  <li><a href="index.html?a=M003306&name=test_create_with_exceptions_using_scope_for_protected_attributes" >test_create_with_exceptions_using_scope_for_protected_attributes</a></li>
  <li><a href="index.html?a=M003312&name=test_create_without_validation" >test_create_without_validation</a></li>
  <li><a href="index.html?a=M003313&name=test_create_without_validation_bang" >test_create_without_validation_bang</a></li>
  <li><a href="index.html?a=M003298&name=test_double_attr_validation_and_error_msg" >test_double_attr_validation_and_error_msg</a></li>
  <li><a href="index.html?a=M003299&name=test_error_on_create" >test_error_on_create</a></li>
  <li><a href="index.html?a=M003300&name=test_error_on_update" >test_error_on_update</a></li>
  <li><a href="index.html?a=M003311&name=test_errors_on_base" >test_errors_on_base</a></li>
  <li><a href="index.html?a=M003410&name=test_errors_to_xml" >test_errors_to_xml</a></li>
  <li><a href="index.html?a=M003319&name=test_eula" >test_eula</a></li>
  <li><a href="index.html?a=M003302&name=test_exception_on_create_bang_many" >test_exception_on_create_bang_many</a></li>
  <li><a href="index.html?a=M003304&name=test_exception_on_create_bang_many_with_block" >test_exception_on_create_bang_many_with_block</a></li>
  <li><a href="index.html?a=M003303&name=test_exception_on_create_bang_with_block" >test_exception_on_create_bang_with_block</a></li>
  <li><a href="index.html?a=M003407&name=test_if_validation_using_block_false" >test_if_validation_using_block_false</a></li>
  <li><a href="index.html?a=M003405&name=test_if_validation_using_block_true" >test_if_validation_using_block_true</a></li>
  <li><a href="index.html?a=M003399&name=test_if_validation_using_method_false" >test_if_validation_using_method_false</a></li>
  <li><a href="index.html?a=M003397&name=test_if_validation_using_method_true" >test_if_validation_using_method_true</a></li>
  <li><a href="index.html?a=M003403&name=test_if_validation_using_string_false" >test_if_validation_using_string_false</a></li>
  <li><a href="index.html?a=M003401&name=test_if_validation_using_string_true" >test_if_validation_using_string_true</a></li>
  <li><a href="index.html?a=M003301&name=test_invalid_record_exception" >test_invalid_record_exception</a></li>
  <li><a href="index.html?a=M003412&name=test_invalid_should_be_the_opposite_of_valid" >test_invalid_should_be_the_opposite_of_valid</a></li>
  <li><a href="index.html?a=M003385&name=test_invalid_validator" >test_invalid_validator</a></li>
  <li><a href="index.html?a=M003310&name=test_multiple_errors_per_attr_iteration_with_full_error_composition" >test_multiple_errors_per_attr_iteration_with_full_error_composition</a></li>
  <li><a href="index.html?a=M003315&name=test_no_title_confirmation" >test_no_title_confirmation</a></li>
  <li><a href="index.html?a=M003348&name=test_numericality_with_allow_nil_and_getter_method" >test_numericality_with_allow_nil_and_getter_method</a></li>
  <li><a href="index.html?a=M003344&name=test_numericality_with_getter_method" >test_numericality_with_getter_method</a></li>
  <li><a href="index.html?a=M003360&name=test_optionally_validates_length_of_using_is" >test_optionally_validates_length_of_using_is</a></li>
  <li><a href="index.html?a=M003354&name=test_optionally_validates_length_of_using_maximum" >test_optionally_validates_length_of_using_maximum</a></li>
  <li><a href="index.html?a=M003352&name=test_optionally_validates_length_of_using_minimum" >test_optionally_validates_length_of_using_minimum</a></li>
  <li><a href="index.html?a=M003356&name=test_optionally_validates_length_of_using_within" >test_optionally_validates_length_of_using_within</a></li>
  <li><a href="index.html?a=M003357&name=test_optionally_validates_length_of_using_within_on_create" >test_optionally_validates_length_of_using_within_on_create</a></li>
  <li><a href="index.html?a=M003377&name=test_optionally_validates_length_of_using_within_on_create_utf8" >test_optionally_validates_length_of_using_within_on_create_utf8</a></li>
  <li><a href="index.html?a=M003358&name=test_optionally_validates_length_of_using_within_on_update" >test_optionally_validates_length_of_using_within_on_update</a></li>
  <li><a href="index.html?a=M003378&name=test_optionally_validates_length_of_using_within_on_update_utf8" >test_optionally_validates_length_of_using_within_on_update_utf8</a></li>
  <li><a href="index.html?a=M003376&name=test_optionally_validates_length_of_using_within_utf8" >test_optionally_validates_length_of_using_within_utf8</a></li>
  <li><a href="index.html?a=M003305&name=test_scoped_create_without_attributes" >test_scoped_create_without_attributes</a></li>
  <li><a href="index.html?a=M003297&name=test_single_attr_validation_and_error_msg" >test_single_attr_validation_and_error_msg</a></li>
  <li><a href="index.html?a=M003309&name=test_single_error_per_attr_iteration" >test_single_error_per_attr_iteration</a></li>
  <li><a href="index.html?a=M003296&name=test_single_field_validation" >test_single_field_validation</a></li>
  <li><a href="index.html?a=M003318&name=test_terms_of_service_agreement" >test_terms_of_service_agreement</a></li>
  <li><a href="index.html?a=M003317&name=test_terms_of_service_agreement_no_acceptance" >test_terms_of_service_agreement_no_acceptance</a></li>
  <li><a href="index.html?a=M003320&name=test_terms_of_service_agreement_with_accept_value" >test_terms_of_service_agreement_with_accept_value</a></li>
  <li><a href="index.html?a=M003386&name=test_throw_away_typing" >test_throw_away_typing</a></li>
  <li><a href="index.html?a=M003316&name=test_title_confirmation" >test_title_confirmation</a></li>
  <li><a href="index.html?a=M003408&name=test_unless_validation_using_block_false" >test_unless_validation_using_block_false</a></li>
  <li><a href="index.html?a=M003406&name=test_unless_validation_using_block_true" >test_unless_validation_using_block_true</a></li>
  <li><a href="index.html?a=M003400&name=test_unless_validation_using_method_false" >test_unless_validation_using_method_false</a></li>
  <li><a href="index.html?a=M003398&name=test_unless_validation_using_method_true" >test_unless_validation_using_method_true</a></li>
  <li><a href="index.html?a=M003404&name=test_unless_validation_using_string_false" >test_unless_validation_using_string_false</a></li>
  <li><a href="index.html?a=M003402&name=test_unless_validation_using_string_true" >test_unless_validation_using_string_true</a></li>
  <li><a href="index.html?a=M003384&name=test_validate_block" >test_validate_block</a></li>
  <li><a href="index.html?a=M003329&name=test_validate_case_insensitive_uniqueness" >test_validate_case_insensitive_uniqueness</a></li>
  <li><a href="index.html?a=M003330&name=test_validate_case_sensitive_uniqueness" >test_validate_case_sensitive_uniqueness</a></li>
  <li><a href="index.html?a=M003331&name=test_validate_case_sensitive_uniqueness_with_attribute_passed_as_integer" >test_validate_case_sensitive_uniqueness_with_attribute_passed_as_integer</a></li>
  <li><a href="index.html?a=M003338&name=test_validate_format" >test_validate_format</a></li>
  <li><a href="index.html?a=M003340&name=test_validate_format_numeric" >test_validate_format_numeric</a></li>
  <li><a href="index.html?a=M003339&name=test_validate_format_with_allow_blank" >test_validate_format_with_allow_blank</a></li>
  <li><a href="index.html?a=M003341&name=test_validate_format_with_formatted_message" >test_validate_format_with_formatted_message</a></li>
  <li><a href="index.html?a=M003323&name=test_validate_presences" >test_validate_presences</a></li>
  <li><a href="index.html?a=M003337&name=test_validate_straight_inheritance_uniqueness" >test_validate_straight_inheritance_uniqueness</a></li>
  <li><a href="index.html?a=M003324&name=test_validate_uniqueness" >test_validate_uniqueness</a></li>
  <li><a href="index.html?a=M003327&name=test_validate_uniqueness_scoped_to_defining_class" >test_validate_uniqueness_scoped_to_defining_class</a></li>
  <li><a href="index.html?a=M003334&name=test_validate_uniqueness_with_columns_which_are_sql_keywords" >test_validate_uniqueness_with_columns_which_are_sql_keywords</a></li>
  <li><a href="index.html?a=M003335&name=test_validate_uniqueness_with_limit" >test_validate_uniqueness_with_limit</a></li>
  <li><a href="index.html?a=M003336&name=test_validate_uniqueness_with_limit_and_utf8" >test_validate_uniqueness_with_limit_and_utf8</a></li>
  <li><a href="index.html?a=M003332&name=test_validate_uniqueness_with_non_standard_table_names" >test_validate_uniqueness_with_non_standard_table_names</a></li>
  <li><a href="index.html?a=M003326&name=test_validate_uniqueness_with_scope" >test_validate_uniqueness_with_scope</a></li>
  <li><a href="index.html?a=M003328&name=test_validate_uniqueness_with_scope_array" >test_validate_uniqueness_with_scope_array</a></li>
  <li><a href="index.html?a=M003321&name=test_validates_acceptance_of_as_database_column" >test_validates_acceptance_of_as_database_column</a></li>
  <li><a href="index.html?a=M003387&name=test_validates_acceptance_of_with_custom_error_using_quotes" >test_validates_acceptance_of_with_custom_error_using_quotes</a></li>
  <li><a href="index.html?a=M003322&name=test_validates_acceptance_of_with_non_existant_table" >test_validates_acceptance_of_with_non_existant_table</a></li>
  <li><a href="index.html?a=M003382&name=test_validates_associated_many" >test_validates_associated_many</a></li>
  <li><a href="index.html?a=M003409&name=test_validates_associated_missing" >test_validates_associated_missing</a></li>
  <li><a href="index.html?a=M003383&name=test_validates_associated_one" >test_validates_associated_one</a></li>
  <li><a href="index.html?a=M003396&name=test_validates_associated_with_custom_message_using_quotes" >test_validates_associated_with_custom_message_using_quotes</a></li>
  <li><a href="index.html?a=M003388&name=test_validates_confirmation_of_with_custom_error_using_quotes" >test_validates_confirmation_of_with_custom_error_using_quotes</a></li>
  <li><a href="index.html?a=M003314&name=test_validates_each" >test_validates_each</a></li>
  <li><a href="index.html?a=M003349&name=test_validates_exclusion_of" >test_validates_exclusion_of</a></li>
  <li><a href="index.html?a=M003350&name=test_validates_exclusion_of_with_formatted_message" >test_validates_exclusion_of_with_formatted_message</a></li>
  <li><a href="index.html?a=M003389&name=test_validates_format_of_with_custom_error_using_quotes" >test_validates_format_of_with_custom_error_using_quotes</a></li>
  <li><a href="index.html?a=M003342&name=test_validates_inclusion_of" >test_validates_inclusion_of</a></li>
  <li><a href="index.html?a=M003343&name=test_validates_inclusion_of_with_allow_nil" >test_validates_inclusion_of_with_allow_nil</a></li>
  <li><a href="index.html?a=M003390&name=test_validates_inclusion_of_with_custom_error_using_quotes" >test_validates_inclusion_of_with_custom_error_using_quotes</a></li>
  <li><a href="index.html?a=M003347&name=test_validates_inclusion_of_with_formatted_message" >test_validates_inclusion_of_with_formatted_message</a></li>
  <li><a href="index.html?a=M003369&name=test_validates_length_of_custom_errors_for_in" >test_validates_length_of_custom_errors_for_in</a></li>
  <li><a href="index.html?a=M003371&name=test_validates_length_of_custom_errors_for_is_with_message" >test_validates_length_of_custom_errors_for_is_with_message</a></li>
  <li><a href="index.html?a=M003372&name=test_validates_length_of_custom_errors_for_is_with_wrong_length" >test_validates_length_of_custom_errors_for_is_with_wrong_length</a></li>
  <li><a href="index.html?a=M003368&name=test_validates_length_of_custom_errors_for_maximum_with_message" >test_validates_length_of_custom_errors_for_maximum_with_message</a></li>
  <li><a href="index.html?a=M003370&name=test_validates_length_of_custom_errors_for_maximum_with_too_long" >test_validates_length_of_custom_errors_for_maximum_with_too_long</a></li>
  <li><a href="index.html?a=M003366&name=test_validates_length_of_custom_errors_for_minimum_with_message" >test_validates_length_of_custom_errors_for_minimum_with_message</a></li>
  <li><a href="index.html?a=M003367&name=test_validates_length_of_custom_errors_for_minimum_with_too_short" >test_validates_length_of_custom_errors_for_minimum_with_too_short</a></li>
  <li><a href="index.html?a=M003365&name=test_validates_length_of_nasty_params" >test_validates_length_of_nasty_params</a></li>
  <li><a href="index.html?a=M003361&name=test_validates_length_of_using_bignum" >test_validates_length_of_using_bignum</a></li>
  <li><a href="index.html?a=M003359&name=test_validates_length_of_using_is" >test_validates_length_of_using_is</a></li>
  <li><a href="index.html?a=M003379&name=test_validates_length_of_using_is_utf8" >test_validates_length_of_using_is_utf8</a></li>
  <li><a href="index.html?a=M003353&name=test_validates_length_of_using_maximum" >test_validates_length_of_using_maximum</a></li>
  <li><a href="index.html?a=M003374&name=test_validates_length_of_using_maximum_utf8" >test_validates_length_of_using_maximum_utf8</a></li>
  <li><a href="index.html?a=M003351&name=test_validates_length_of_using_minimum" >test_validates_length_of_using_minimum</a></li>
  <li><a href="index.html?a=M003373&name=test_validates_length_of_using_minimum_utf8" >test_validates_length_of_using_minimum_utf8</a></li>
  <li><a href="index.html?a=M003355&name=test_validates_length_of_using_within" >test_validates_length_of_using_within</a></li>
  <li><a href="index.html?a=M003375&name=test_validates_length_of_using_within_utf8" >test_validates_length_of_using_within_utf8</a></li>
  <li><a href="index.html?a=M003346&name=test_validates_length_of_with_allow_blank" >test_validates_length_of_with_allow_blank</a></li>
  <li><a href="index.html?a=M003345&name=test_validates_length_of_with_allow_nil" >test_validates_length_of_with_allow_nil</a></li>
  <li><a href="index.html?a=M003380&name=test_validates_length_of_with_block" >test_validates_length_of_with_block</a></li>
  <li><a href="index.html?a=M003393&name=test_validates_length_of_with_custom_message_using_quotes" >test_validates_length_of_with_custom_message_using_quotes</a></li>
  <li><a href="index.html?a=M003391&name=test_validates_length_of_with_custom_too_long_using_quotes" >test_validates_length_of_with_custom_too_long_using_quotes</a></li>
  <li><a href="index.html?a=M003392&name=test_validates_length_of_with_custom_too_short_using_quotes" >test_validates_length_of_with_custom_too_short_using_quotes</a></li>
  <li><a href="index.html?a=M003362&name=test_validates_length_with_globally_modified_error_message" >test_validates_length_with_globally_modified_error_message</a></li>
  <li><a href="index.html?a=M003394&name=test_validates_presence_of_with_custom_message_using_quotes" >test_validates_presence_of_with_custom_message_using_quotes</a></li>
  <li><a href="index.html?a=M003363&name=test_validates_size_of_association" >test_validates_size_of_association</a></li>
  <li><a href="index.html?a=M003364&name=test_validates_size_of_association_using_within" >test_validates_size_of_association_using_within</a></li>
  <li><a href="index.html?a=M003381&name=test_validates_size_of_association_utf8" >test_validates_size_of_association_utf8</a></li>
  <li><a href="index.html?a=M003333&name=test_validates_uniqueness_inside_with_scope" >test_validates_uniqueness_inside_with_scope</a></li>
  <li><a href="index.html?a=M003395&name=test_validates_uniqueness_of_with_custom_message_using_quotes" >test_validates_uniqueness_of_with_custom_message_using_quotes</a></li>
  <li><a href="index.html?a=M003325&name=test_validates_uniquness_with_newline_chars" >test_validates_uniquness_with_newline_chars</a></li>
  <li><a href="index.html?a=M003411&name=test_validation_order" >test_validation_order</a></li>
  <li><a href="index.html?a=M003413&name=test_validation_with_if_as_string" >test_validation_with_if_as_string</a></li>
  <li><a href="index.html?a=M003308&name=test_values_are_not_retrieved_unless_needed" >test_values_are_not_retrieved_unless_needed</a></li>
  </ul>






<div class="sectiontitle">Public Instance methods</div>
<div id="M003307" class="method">
  <div id="M003307_title" class="title">
    <b>test_create_with_exceptions_using_scope_and_empty_attributes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003307_source')" id="l_M003307_source">show source</a> ]</p>
  <div id="M003307_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 172</span>
172:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_create_with_exceptions_using_scope_and_empty_attributes</span>
173:     <span class="ruby-identifier">assert_nothing_raised</span> <span class="ruby-keyword kw">do</span>
174:       <span class="ruby-constant">ProtectedPerson</span>.<span class="ruby-identifier">with_scope</span>( <span class="ruby-identifier">:create</span> =<span class="ruby-operator">&gt;</span> { <span class="ruby-identifier">:first_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Mary&quot;</span> } ) <span class="ruby-keyword kw">do</span>
175:         <span class="ruby-identifier">person</span> = <span class="ruby-constant">ProtectedPerson</span>.<span class="ruby-identifier">create!</span>
176:         <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">person</span>.<span class="ruby-identifier">first_name</span>, <span class="ruby-value str">&quot;Mary&quot;</span>, <span class="ruby-value str">&quot;should be ok when no attributes are passed to create!&quot;</span>
177:       <span class="ruby-keyword kw">end</span>
178:     <span class="ruby-keyword kw">end</span>
179:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003306" class="method">
  <div id="M003306_title" class="title">
    <b>test_create_with_exceptions_using_scope_for_protected_attributes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003306_source')" id="l_M003306_source">show source</a> ]</p>
  <div id="M003306_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 163</span>
163:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_create_with_exceptions_using_scope_for_protected_attributes</span>
164:     <span class="ruby-identifier">assert_nothing_raised</span> <span class="ruby-keyword kw">do</span>
165:       <span class="ruby-constant">ProtectedPerson</span>.<span class="ruby-identifier">with_scope</span>( <span class="ruby-identifier">:create</span> =<span class="ruby-operator">&gt;</span> { <span class="ruby-identifier">:first_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Mary&quot;</span> } ) <span class="ruby-keyword kw">do</span>
166:         <span class="ruby-identifier">person</span> = <span class="ruby-constant">ProtectedPerson</span>.<span class="ruby-identifier">create!</span> <span class="ruby-identifier">:addon</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Addon&quot;</span>
167:         <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">person</span>.<span class="ruby-identifier">first_name</span>, <span class="ruby-value str">&quot;Mary&quot;</span>, <span class="ruby-value str">&quot;scope should ignore attr_protected&quot;</span>
168:       <span class="ruby-keyword kw">end</span>
169:     <span class="ruby-keyword kw">end</span>
170:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003312" class="method">
  <div id="M003312_title" class="title">
    <b>test_create_without_validation</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003312_source')" id="l_M003312_source">show source</a> ]</p>
  <div id="M003312_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 230</span>
230:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_create_without_validation</span>
231:     <span class="ruby-identifier">reply</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span>
232:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">reply</span>.<span class="ruby-identifier">save</span>
233:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">reply</span>.<span class="ruby-identifier">save</span>(<span class="ruby-keyword kw">false</span>)
234:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003313" class="method">
  <div id="M003313_title" class="title">
    <b>test_create_without_validation_bang</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003313_source')" id="l_M003313_source">show source</a> ]</p>
  <div id="M003313_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 236</span>
236:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_create_without_validation_bang</span>
237:     <span class="ruby-identifier">count</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">count</span>
238:     <span class="ruby-identifier">assert_nothing_raised</span> { <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">save_without_validation!</span> }
239:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">count</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>, <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">count</span>
240:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003298" class="method">
  <div id="M003298_title" class="title">
    <b>test_double_attr_validation_and_error_msg</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003298_source')" id="l_M003298_source">show source</a> ]</p>
  <div id="M003298_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 88</span>
88:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_double_attr_validation_and_error_msg</span>
89:     <span class="ruby-identifier">r</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span>
90:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">r</span>.<span class="ruby-identifier">valid?</span>
91: 
92:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">invalid?</span>(<span class="ruby-value str">&quot;title&quot;</span>), <span class="ruby-value str">&quot;A reply without title should mark that attribute as invalid&quot;</span>
93:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;Empty&quot;</span>, <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-value str">&quot;title&quot;</span>), <span class="ruby-value str">&quot;A reply without title should contain an error&quot;</span>
94: 
95:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">invalid?</span>(<span class="ruby-value str">&quot;content&quot;</span>), <span class="ruby-value str">&quot;A reply without content should mark that attribute as invalid&quot;</span>
96:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;Empty&quot;</span>, <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-value str">&quot;content&quot;</span>), <span class="ruby-value str">&quot;A reply without content should contain an error&quot;</span>
97: 
98:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">count</span>
99:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003299" class="method">
  <div id="M003299_title" class="title">
    <b>test_error_on_create</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003299_source')" id="l_M003299_source">show source</a> ]</p>
  <div id="M003299_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 101</span>
101:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_error_on_create</span>
102:     <span class="ruby-identifier">r</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span>
103:     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;Wrong Create&quot;</span>
104:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">r</span>.<span class="ruby-identifier">valid?</span>
105:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">invalid?</span>(<span class="ruby-value str">&quot;title&quot;</span>), <span class="ruby-value str">&quot;A reply with a bad title should mark that attribute as invalid&quot;</span>
106:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is Wrong Create&quot;</span>, <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-value str">&quot;title&quot;</span>), <span class="ruby-value str">&quot;A reply with a bad content should contain an error&quot;</span>
107:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003300" class="method">
  <div id="M003300_title" class="title">
    <b>test_error_on_update</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003300_source')" id="l_M003300_source">show source</a> ]</p>
  <div id="M003300_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 109</span>
109:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_error_on_update</span>
110:     <span class="ruby-identifier">r</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span>
111:     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;Bad&quot;</span>
112:     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">content</span> = <span class="ruby-value str">&quot;Good&quot;</span>
113:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;First save should be successful&quot;</span>
114: 
115:     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;Wrong Update&quot;</span>
116:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">r</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Second save should fail&quot;</span>
117: 
118:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">invalid?</span>(<span class="ruby-value str">&quot;title&quot;</span>), <span class="ruby-value str">&quot;A reply with a bad title should mark that attribute as invalid&quot;</span>
119:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is Wrong Update&quot;</span>, <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-value str">&quot;title&quot;</span>), <span class="ruby-value str">&quot;A reply with a bad content should contain an error&quot;</span>
120:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003311" class="method">
  <div id="M003311_title" class="title">
    <b>test_errors_on_base</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003311_source')" id="l_M003311_source">show source</a> ]</p>
  <div id="M003311_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 214</span>
214:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_errors_on_base</span>
215:     <span class="ruby-identifier">r</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span>
216:     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">content</span> = <span class="ruby-value str">&quot;Mismatch&quot;</span>
217:     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">save</span>
218:     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add_to_base</span> <span class="ruby-value str">&quot;Reply is not dignifying&quot;</span>
219: 
220:     <span class="ruby-identifier">errors</span> = []
221:     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">each_full</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">error</span><span class="ruby-operator">|</span> <span class="ruby-identifier">errors</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">error</span> }
222: 
223:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;Reply is not dignifying&quot;</span>, <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on_base</span>
224: 
225:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">errors</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-value str">&quot;Title Empty&quot;</span>)
226:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">errors</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-value str">&quot;Reply is not dignifying&quot;</span>)
227:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">count</span>
228:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003410" class="method">
  <div id="M003410_title" class="title">
    <b>test_errors_to_xml</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003410_source')" id="l_M003410_source">show source</a> ]</p>
  <div id="M003410_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1443</span>
1443:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_errors_to_xml</span>
1444:     <span class="ruby-identifier">r</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span> <span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Wrong Create&quot;</span>
1445:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">r</span>.<span class="ruby-identifier">valid?</span>
1446:     <span class="ruby-identifier">xml</span> = <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">to_xml</span>(<span class="ruby-identifier">:skip_instruct</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>)
1447:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;&lt;errors&gt;&quot;</span>, <span class="ruby-identifier">xml</span>.<span class="ruby-identifier">first</span>(<span class="ruby-value">8</span>)
1448:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">xml</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-value str">&quot;&lt;error&gt;Title is Wrong Create&lt;/error&gt;&quot;</span>)
1449:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">xml</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-value str">&quot;&lt;error&gt;Content Empty&lt;/error&gt;&quot;</span>)
1450:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003319" class="method">
  <div id="M003319_title" class="title">
    <b>test_eula</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003319_source')" id="l_M003319_source">show source</a> ]</p>
  <div id="M003319_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 301</span>
301:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_eula</span>
302:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_acceptance_of</span>(<span class="ruby-identifier">:eula</span>, <span class="ruby-identifier">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;must be abided&quot;</span>, <span class="ruby-identifier">:on</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:create</span>)
303: 
304:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;We should be confirmed&quot;</span>,<span class="ruby-value str">&quot;eula&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;&quot;</span>)
305:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
306:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;must be abided&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:eula</span>)
307: 
308:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">eula</span> = <span class="ruby-value str">&quot;1&quot;</span>
309:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
310:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003302" class="method">
  <div id="M003302_title" class="title">
    <b>test_exception_on_create_bang_many</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003302_source')" id="l_M003302_source">show source</a> ]</p>
  <div id="M003302_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 135</span>
135:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_exception_on_create_bang_many</span>
136:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">RecordInvalid</span>) <span class="ruby-keyword kw">do</span>
137:       <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">create!</span>([ { <span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;OK&quot;</span> }, { <span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Wrong Create&quot;</span> }])
138:     <span class="ruby-keyword kw">end</span>
139:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003304" class="method">
  <div id="M003304_title" class="title">
    <b>test_exception_on_create_bang_many_with_block</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003304_source')" id="l_M003304_source">show source</a> ]</p>
  <div id="M003304_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 149</span>
149:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_exception_on_create_bang_many_with_block</span>
150:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">RecordInvalid</span>) <span class="ruby-keyword kw">do</span>
151:       <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">create!</span>([{ <span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;OK&quot;</span> }, { <span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Wrong Create&quot;</span> }]) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span>
152:         <span class="ruby-identifier">r</span>.<span class="ruby-identifier">content</span> = <span class="ruby-keyword kw">nil</span>
153:       <span class="ruby-keyword kw">end</span>
154:     <span class="ruby-keyword kw">end</span>
155:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003303" class="method">
  <div id="M003303_title" class="title">
    <b>test_exception_on_create_bang_with_block</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003303_source')" id="l_M003303_source">show source</a> ]</p>
  <div id="M003303_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 141</span>
141:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_exception_on_create_bang_with_block</span>
142:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">RecordInvalid</span>) <span class="ruby-keyword kw">do</span>
143:       <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">create!</span>({ <span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;OK&quot;</span> }) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span>
144:         <span class="ruby-identifier">r</span>.<span class="ruby-identifier">content</span> = <span class="ruby-keyword kw">nil</span>
145:       <span class="ruby-keyword kw">end</span>
146:     <span class="ruby-keyword kw">end</span>
147:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003407" class="method">
  <div id="M003407_title" class="title">
    <b>test_if_validation_using_block_false</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003407_source')" id="l_M003407_source">show source</a> ]</p>
  <div id="M003407_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1412</span>
1412:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_if_validation_using_block_false</span>
1413:     <span class="ruby-comment cmt"># When the block returns false</span>
1414:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:too_long=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;hoo {{count}}&quot;</span>,
1415:       <span class="ruby-identifier">:if</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">title</span> <span class="ruby-operator">!=</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>} )
1416:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1417:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1418:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1419:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003405" class="method">
  <div id="M003405_title" class="title">
    <b>test_if_validation_using_block_true</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003405_source')" id="l_M003405_source">show source</a> ]</p>
  <div id="M003405_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1393</span>
1393:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_if_validation_using_block_true</span>
1394:     <span class="ruby-comment cmt"># When the block returns true</span>
1395:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:too_long=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;hoo {{count}}&quot;</span>,
1396:       <span class="ruby-identifier">:if</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">content</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">4</span> } )
1397:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1398:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1399:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1400:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;hoo 5&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
1401:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003399" class="method">
  <div id="M003399_title" class="title">
    <b>test_if_validation_using_method_false</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003399_source')" id="l_M003399_source">show source</a> ]</p>
  <div id="M003399_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1342</span>
1342:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_if_validation_using_method_false</span>
1343:     <span class="ruby-comment cmt"># When the method returns false</span>
1344:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:too_long=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;hoo {{count}}&quot;</span>, <span class="ruby-identifier">:if</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:condition_is_true_but_its_not</span> )
1345:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1346:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1347:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1348:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003397" class="method">
  <div id="M003397_title" class="title">
    <b>test_if_validation_using_method_true</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003397_source')" id="l_M003397_source">show source</a> ]</p>
  <div id="M003397_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1325</span>
1325:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_if_validation_using_method_true</span>
1326:     <span class="ruby-comment cmt"># When the method returns true</span>
1327:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:too_long=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;hoo {{count}}&quot;</span>, <span class="ruby-identifier">:if</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:condition_is_true</span> )
1328:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1329:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1330:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1331:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;hoo 5&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
1332:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003403" class="method">
  <div id="M003403_title" class="title">
    <b>test_if_validation_using_string_false</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003403_source')" id="l_M003403_source">show source</a> ]</p>
  <div id="M003403_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1376</span>
1376:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_if_validation_using_string_false</span>
1377:     <span class="ruby-comment cmt"># When the evaluated string returns false</span>
1378:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:too_long=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;hoo {{count}}&quot;</span>, <span class="ruby-identifier">:if</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;false&quot;</span>)
1379:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1380:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1381:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1382:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003401" class="method">
  <div id="M003401_title" class="title">
    <b>test_if_validation_using_string_true</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003401_source')" id="l_M003401_source">show source</a> ]</p>
  <div id="M003401_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1359</span>
1359:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_if_validation_using_string_true</span>
1360:     <span class="ruby-comment cmt"># When the evaluated string returns true</span>
1361:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:too_long=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;hoo {{count}}&quot;</span>, <span class="ruby-identifier">:if</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;a = 1; a == 1&quot;</span> )
1362:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1363:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1364:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1365:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;hoo 5&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
1366:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003301" class="method">
  <div id="M003301_title" class="title">
    <b>test_invalid_record_exception</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003301_source')" id="l_M003301_source">show source</a> ]</p>
  <div id="M003301_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 122</span>
122:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_invalid_record_exception</span>
123:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">RecordInvalid</span>) { <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">create!</span> }
124:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">RecordInvalid</span>) { <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">save!</span> }
125: 
126:     <span class="ruby-keyword kw">begin</span>
127:       <span class="ruby-identifier">r</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span>
128:       <span class="ruby-identifier">r</span>.<span class="ruby-identifier">save!</span>
129:       <span class="ruby-identifier">flunk</span>
130:     <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">RecordInvalid</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">invalid</span>
131:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">r</span>, <span class="ruby-identifier">invalid</span>.<span class="ruby-identifier">record</span>
132:     <span class="ruby-keyword kw">end</span>
133:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003412" class="method">
  <div id="M003412_title" class="title">
    <b>test_invalid_should_be_the_opposite_of_valid</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003412_source')" id="l_M003412_source">show source</a> ]</p>
  <div id="M003412_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1471</span>
1471:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_invalid_should_be_the_opposite_of_valid</span>
1472:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_presence_of</span> <span class="ruby-identifier">:title</span>
1473: 
1474:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>
1475:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">invalid?</span>
1476:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">invalid?</span>(<span class="ruby-identifier">:title</span>)
1477: 
1478:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">'Things are going to change'</span>
1479:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">invalid?</span>
1480:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003385" class="method">
  <div id="M003385_title" class="title">
    <b>test_invalid_validator</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003385_source')" id="l_M003385_source">show source</a> ]</p>
  <div id="M003385_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1211</span>
1211:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_invalid_validator</span>
1212:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validate</span> <span class="ruby-value">3</span>
1213:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ArgumentError</span>) { <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span> }
1214:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003310" class="method">
  <div id="M003310_title" class="title">
    <b>test_multiple_errors_per_attr_iteration_with_full_error_composition</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003310_source')" id="l_M003310_source">show source</a> ]</p>
  <div id="M003310_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 200</span>
200:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_multiple_errors_per_attr_iteration_with_full_error_composition</span>
201:     <span class="ruby-identifier">r</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span>
202:     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">title</span>   = <span class="ruby-value str">&quot;Wrong Create&quot;</span>
203:     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">content</span> = <span class="ruby-value str">&quot;Mismatch&quot;</span>
204:     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">save</span>
205: 
206:     <span class="ruby-identifier">errors</span> = []
207:     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">each_full</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">error</span><span class="ruby-operator">|</span> <span class="ruby-identifier">errors</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">error</span> }
208: 
209:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;Title is Wrong Create&quot;</span>, <span class="ruby-identifier">errors</span>[<span class="ruby-value">0</span>]
210:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;Title is Content Mismatch&quot;</span>, <span class="ruby-identifier">errors</span>[<span class="ruby-value">1</span>]
211:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">count</span>
212:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003315" class="method">
  <div id="M003315_title" class="title">
    <b>test_no_title_confirmation</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003315_source')" id="l_M003315_source">show source</a> ]</p>
  <div id="M003315_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 255</span>
255:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_no_title_confirmation</span>
256:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_confirmation_of</span>(<span class="ruby-identifier">:title</span>)
257: 
258:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">:author_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Plutarch&quot;</span>)
259:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
260: 
261:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title_confirmation</span> = <span class="ruby-value str">&quot;Parallel Lives&quot;</span>
262:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
263: 
264:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title_confirmation</span> = <span class="ruby-keyword kw">nil</span>
265:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;Parallel Lives&quot;</span>
266:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
267: 
268:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title_confirmation</span> = <span class="ruby-value str">&quot;Parallel Lives&quot;</span>
269:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
270:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003348" class="method">
  <div id="M003348_title" class="title">
    <b>test_numericality_with_allow_nil_and_getter_method</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003348_source')" id="l_M003348_source">show source</a> ]</p>
  <div id="M003348_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 722</span>
722:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_numericality_with_allow_nil_and_getter_method</span>
723:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Developer</span>) <span class="ruby-keyword kw">do</span>
724:       <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">validates_numericality_of</span>( <span class="ruby-identifier">:salary</span>, <span class="ruby-identifier">:allow_nil</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>)
725:       <span class="ruby-identifier">developer</span> = <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;michael&quot;</span>, <span class="ruby-value str">&quot;salary&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>)
726:       <span class="ruby-identifier">developer</span>.<span class="ruby-identifier">instance_eval</span>(<span class="ruby-value str">&quot;def salary; read_attribute('salary') ? read_attribute('salary') : 100000; end&quot;</span>)
727:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">developer</span>.<span class="ruby-identifier">valid?</span>
728:     <span class="ruby-keyword kw">end</span>
729:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003344" class="method">
  <div id="M003344_title" class="title">
    <b>test_numericality_with_getter_method</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003344_source')" id="l_M003344_source">show source</a> ]</p>
  <div id="M003344_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 684</span>
684:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_numericality_with_getter_method</span>
685:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Developer</span>) <span class="ruby-keyword kw">do</span>
686:       <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">validates_numericality_of</span>( <span class="ruby-identifier">:salary</span> )
687:       <span class="ruby-identifier">developer</span> = <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;michael&quot;</span>, <span class="ruby-value str">&quot;salary&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>)
688:       <span class="ruby-identifier">developer</span>.<span class="ruby-identifier">instance_eval</span>(<span class="ruby-value str">&quot;def salary; read_attribute('salary') ? read_attribute('salary') : 100000; end&quot;</span>)
689:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">developer</span>.<span class="ruby-identifier">valid?</span>
690:     <span class="ruby-keyword kw">end</span>
691:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003360" class="method">
  <div id="M003360_title" class="title">
    <b>test_optionally_validates_length_of_using_is</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003360_source')" id="l_M003360_source">show source</a> ]</p>
  <div id="M003360_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 898</span>
898:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_optionally_validates_length_of_using_is</span>
899:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:is</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span>, <span class="ruby-identifier">:allow_nil</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>
900: 
901:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;valid&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
902:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
903: 
904:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-keyword kw">nil</span>
905:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
906:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003354" class="method">
  <div id="M003354_title" class="title">
    <b>test_optionally_validates_length_of_using_maximum</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003354_source')" id="l_M003354_source">show source</a> ]</p>
  <div id="M003354_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 799</span>
799:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_optionally_validates_length_of_using_maximum</span>
800:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span>, <span class="ruby-identifier">:allow_nil</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>
801: 
802:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;valid&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
803:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
804: 
805:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-keyword kw">nil</span>
806:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
807:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003352" class="method">
  <div id="M003352_title" class="title">
    <b>test_optionally_validates_length_of_using_minimum</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003352_source')" id="l_M003352_source">show source</a> ]</p>
  <div id="M003352_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 771</span>
771:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_optionally_validates_length_of_using_minimum</span>
772:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:minimum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span>, <span class="ruby-identifier">:allow_nil</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>
773: 
774:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;valid&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
775:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
776: 
777:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-keyword kw">nil</span>
778:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
779:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003356" class="method">
  <div id="M003356_title" class="title">
    <b>test_optionally_validates_length_of_using_within</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003356_source')" id="l_M003356_source">show source</a> ]</p>
  <div id="M003356_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 828</span>
828:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_optionally_validates_length_of_using_within</span>
829:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:content</span>, <span class="ruby-identifier">:within</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">3</span><span class="ruby-operator">..</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:allow_nil</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>
830: 
831:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">'title'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'abc'</span>, <span class="ruby-value str">'content'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'abcd'</span>)
832:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
833: 
834:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-keyword kw">nil</span>
835:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
836:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003357" class="method">
  <div id="M003357_title" class="title">
    <b>test_optionally_validates_length_of_using_within_on_create</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003357_source')" id="l_M003357_source">show source</a> ]</p>
  <div id="M003357_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 838</span>
838:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_optionally_validates_length_of_using_within_on_create</span>
839:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:content</span>, <span class="ruby-identifier">:within</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span><span class="ruby-operator">..</span><span class="ruby-value">10</span>, <span class="ruby-identifier">:on</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:create</span>, <span class="ruby-identifier">:too_long</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;my string is too long: {{count}}&quot;</span>
840: 
841:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;thisisnotvalid&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
842:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
843:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
844:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;my string is too long: 10&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-identifier">:title</span>]
845: 
846:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;butthisis&quot;</span>
847:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
848: 
849:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;few&quot;</span>
850:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
851: 
852:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">content</span> = <span class="ruby-value str">&quot;andthisislong&quot;</span>
853:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
854: 
855:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">content</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;iamfine&quot;</span>
856:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
857:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003377" class="method">
  <div id="M003377_title" class="title">
    <b>test_optionally_validates_length_of_using_within_on_create_utf8</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003377_source')" id="l_M003377_source">show source</a> ]</p>
  <div id="M003377_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1092</span>
1092:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_optionally_validates_length_of_using_within_on_create_utf8</span>
1093:     <span class="ruby-identifier">with_kcode</span>(<span class="ruby-value str">'UTF8'</span>) <span class="ruby-keyword kw">do</span>
1094:       <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:within</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span><span class="ruby-operator">..</span><span class="ruby-value">10</span>, <span class="ruby-identifier">:on</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:create</span>, <span class="ruby-identifier">:too_long</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;長すぎます: {{count}}&quot;</span>
1095: 
1096:       <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;一二三四五六七八九十A&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1097:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
1098:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1099:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;長すぎます: 10&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-identifier">:title</span>]
1100: 
1101:       <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;一二三四五六七八九&quot;</span>
1102:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
1103: 
1104:       <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;一二3&quot;</span>
1105:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
1106: 
1107:       <span class="ruby-identifier">t</span>.<span class="ruby-identifier">content</span> = <span class="ruby-value str">&quot;一二三四五六七八九十&quot;</span>
1108:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
1109: 
1110:       <span class="ruby-identifier">t</span>.<span class="ruby-identifier">content</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;一二三四五六&quot;</span>
1111:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
1112:     <span class="ruby-keyword kw">end</span>
1113:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003358" class="method">
  <div id="M003358_title" class="title">
    <b>test_optionally_validates_length_of_using_within_on_update</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003358_source')" id="l_M003358_source">show source</a> ]</p>
  <div id="M003358_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 859</span>
859:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_optionally_validates_length_of_using_within_on_update</span>
860:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:content</span>, <span class="ruby-identifier">:within</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span><span class="ruby-operator">..</span><span class="ruby-value">10</span>, <span class="ruby-identifier">:on</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:update</span>, <span class="ruby-identifier">:too_short</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;my string is too short: {{count}}&quot;</span>
861: 
862:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;vali&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
863:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
864:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
865: 
866:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;not&quot;</span>
867:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
868:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
869:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;my string is too short: 5&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-identifier">:title</span>]
870: 
871:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;valid&quot;</span>
872:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">content</span> = <span class="ruby-value str">&quot;andthisistoolong&quot;</span>
873:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
874:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:content</span>)
875: 
876:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">content</span> = <span class="ruby-value str">&quot;iamfine&quot;</span>
877:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
878:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003378" class="method">
  <div id="M003378_title" class="title">
    <b>test_optionally_validates_length_of_using_within_on_update_utf8</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003378_source')" id="l_M003378_source">show source</a> ]</p>
  <div id="M003378_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1115</span>
1115:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_optionally_validates_length_of_using_within_on_update_utf8</span>
1116:     <span class="ruby-identifier">with_kcode</span>(<span class="ruby-value str">'UTF8'</span>) <span class="ruby-keyword kw">do</span>
1117:       <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:within</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span><span class="ruby-operator">..</span><span class="ruby-value">10</span>, <span class="ruby-identifier">:on</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:update</span>, <span class="ruby-identifier">:too_short</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;短すぎます: {{count}}&quot;</span>
1118: 
1119:       <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;一二三4&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1120:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
1121:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1122: 
1123:       <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;1二三4&quot;</span>
1124:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
1125:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1126:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;短すぎます: 5&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-identifier">:title</span>]
1127: 
1128:       <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;一二三四五六七八九十A&quot;</span>
1129:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
1130:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1131: 
1132:       <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;一二345&quot;</span>
1133:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
1134:     <span class="ruby-keyword kw">end</span>
1135:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003376" class="method">
  <div id="M003376_title" class="title">
    <b>test_optionally_validates_length_of_using_within_utf8</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003376_source')" id="l_M003376_source">show source</a> ]</p>
  <div id="M003376_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1077</span>
1077:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_optionally_validates_length_of_using_within_utf8</span>
1078:     <span class="ruby-identifier">with_kcode</span>(<span class="ruby-value str">'UTF8'</span>) <span class="ruby-keyword kw">do</span>
1079:       <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:within</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">3</span><span class="ruby-operator">..</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:allow_nil</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>
1080: 
1081:       <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;一二三四五&quot;</span>)
1082:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">inspect</span>
1083: 
1084:       <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;一二三&quot;</span>)
1085:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">inspect</span>
1086: 
1087:       <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-keyword kw">nil</span>
1088:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">inspect</span>
1089:     <span class="ruby-keyword kw">end</span>
1090:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003305" class="method">
  <div id="M003305_title" class="title">
    <b>test_scoped_create_without_attributes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003305_source')" id="l_M003305_source">show source</a> ]</p>
  <div id="M003305_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 157</span>
157:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_scoped_create_without_attributes</span>
158:     <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">with_scope</span>(<span class="ruby-identifier">:create</span> =<span class="ruby-operator">&gt;</span> {}) <span class="ruby-keyword kw">do</span>
159:       <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">RecordInvalid</span>) { <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">create!</span> }
160:     <span class="ruby-keyword kw">end</span>
161:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003297" class="method">
  <div id="M003297_title" class="title">
    <b>test_single_attr_validation_and_error_msg</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003297_source')" id="l_M003297_source">show source</a> ]</p>
  <div id="M003297_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 79</span>
79:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_single_attr_validation_and_error_msg</span>
80:     <span class="ruby-identifier">r</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span>
81:     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;There's no content!&quot;</span>
82:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">r</span>.<span class="ruby-identifier">valid?</span>
83:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">invalid?</span>(<span class="ruby-value str">&quot;content&quot;</span>), <span class="ruby-value str">&quot;A reply without content should mark that attribute as invalid&quot;</span>
84:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;Empty&quot;</span>, <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-value str">&quot;content&quot;</span>), <span class="ruby-value str">&quot;A reply without content should contain an error&quot;</span>
85:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">count</span>
86:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003309" class="method">
  <div id="M003309_title" class="title">
    <b>test_single_error_per_attr_iteration</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003309_source')" id="l_M003309_source">show source</a> ]</p>
  <div id="M003309_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 189</span>
189:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_single_error_per_attr_iteration</span>
190:     <span class="ruby-identifier">r</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span>
191:     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">save</span>
192: 
193:     <span class="ruby-identifier">errors</span> = []
194:     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">attr</span>, <span class="ruby-identifier">msg</span><span class="ruby-operator">|</span> <span class="ruby-identifier">errors</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-identifier">attr</span>, <span class="ruby-identifier">msg</span>] }
195: 
196:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">errors</span>.<span class="ruby-identifier">include?</span>([<span class="ruby-value str">&quot;title&quot;</span>, <span class="ruby-value str">&quot;Empty&quot;</span>])
197:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">errors</span>.<span class="ruby-identifier">include?</span>([<span class="ruby-value str">&quot;content&quot;</span>, <span class="ruby-value str">&quot;Empty&quot;</span>])
198:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003296" class="method">
  <div id="M003296_title" class="title">
    <b>test_single_field_validation</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003296_source')" id="l_M003296_source">show source</a> ]</p>
  <div id="M003296_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 70</span>
70:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_single_field_validation</span>
71:     <span class="ruby-identifier">r</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span>
72:     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;There's no content!&quot;</span>
73:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">r</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;A reply without content shouldn't be saveable&quot;</span>
74: 
75:     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">content</span> = <span class="ruby-value str">&quot;Messa content!&quot;</span>
76:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;A reply with content should be saveable&quot;</span>
77:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003318" class="method">
  <div id="M003318_title" class="title">
    <b>test_terms_of_service_agreement</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003318_source')" id="l_M003318_source">show source</a> ]</p>
  <div id="M003318_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 289</span>
289:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_terms_of_service_agreement</span>
290:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_acceptance_of</span>(<span class="ruby-identifier">:terms_of_service</span>, <span class="ruby-identifier">:on</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:create</span>)
291: 
292:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;We should be confirmed&quot;</span>,<span class="ruby-value str">&quot;terms_of_service&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;&quot;</span>)
293:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
294:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;must be accepted&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:terms_of_service</span>)
295: 
296:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">terms_of_service</span> = <span class="ruby-value str">&quot;1&quot;</span>
297:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
298:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003317" class="method">
  <div id="M003317_title" class="title">
    <b>test_terms_of_service_agreement_no_acceptance</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003317_source')" id="l_M003317_source">show source</a> ]</p>
  <div id="M003317_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 282</span>
282:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_terms_of_service_agreement_no_acceptance</span>
283:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_acceptance_of</span>(<span class="ruby-identifier">:terms_of_service</span>, <span class="ruby-identifier">:on</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:create</span>)
284: 
285:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;We should not be confirmed&quot;</span>)
286:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
287:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003320" class="method">
  <div id="M003320_title" class="title">
    <b>test_terms_of_service_agreement_with_accept_value</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003320_source')" id="l_M003320_source">show source</a> ]</p>
  <div id="M003320_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 312</span>
312:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_terms_of_service_agreement_with_accept_value</span>
313:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_acceptance_of</span>(<span class="ruby-identifier">:terms_of_service</span>, <span class="ruby-identifier">:on</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:create</span>, <span class="ruby-identifier">:accept</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;I agree.&quot;</span>)
314: 
315:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;We should be confirmed&quot;</span>, <span class="ruby-value str">&quot;terms_of_service&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;&quot;</span>)
316:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
317:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;must be accepted&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:terms_of_service</span>)
318: 
319:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">terms_of_service</span> = <span class="ruby-value str">&quot;I agree.&quot;</span>
320:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
321:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003386" class="method">
  <div id="M003386_title" class="title">
    <b>test_throw_away_typing</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003386_source')" id="l_M003386_source">show source</a> ]</p>
  <div id="M003386_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1216</span>
1216:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_throw_away_typing</span>
1217:     <span class="ruby-identifier">d</span> = <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;David&quot;</span>, <span class="ruby-value str">&quot;salary&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;100,000&quot;</span>)
1218:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">d</span>.<span class="ruby-identifier">valid?</span>
1219:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">100</span>, <span class="ruby-identifier">d</span>.<span class="ruby-identifier">salary</span>
1220:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;100,000&quot;</span>, <span class="ruby-identifier">d</span>.<span class="ruby-identifier">salary_before_type_cast</span>
1221:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003316" class="method">
  <div id="M003316_title" class="title">
    <b>test_title_confirmation</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003316_source')" id="l_M003316_source">show source</a> ]</p>
  <div id="M003316_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 272</span>
272:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_title_confirmation</span>
273:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_confirmation_of</span>(<span class="ruby-identifier">:title</span>)
274: 
275:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;We should be confirmed&quot;</span>,<span class="ruby-value str">&quot;title_confirmation&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;&quot;</span>)
276:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
277: 
278:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title_confirmation</span> = <span class="ruby-value str">&quot;We should be confirmed&quot;</span>
279:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
280:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003408" class="method">
  <div id="M003408_title" class="title">
    <b>test_unless_validation_using_block_false</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003408_source')" id="l_M003408_source">show source</a> ]</p>
  <div id="M003408_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1421</span>
1421:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_unless_validation_using_block_false</span>
1422:     <span class="ruby-comment cmt"># When the block returns false</span>
1423:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:too_long=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;hoo {{count}}&quot;</span>,
1424:       <span class="ruby-identifier">:unless</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">title</span> <span class="ruby-operator">!=</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>} )
1425:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1426:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1427:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1428:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;hoo 5&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
1429:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003406" class="method">
  <div id="M003406_title" class="title">
    <b>test_unless_validation_using_block_true</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003406_source')" id="l_M003406_source">show source</a> ]</p>
  <div id="M003406_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1403</span>
1403:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_unless_validation_using_block_true</span>
1404:     <span class="ruby-comment cmt"># When the block returns true</span>
1405:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:too_long=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;hoo {{count}}&quot;</span>,
1406:       <span class="ruby-identifier">:unless</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">content</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">4</span> } )
1407:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1408:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1409:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1410:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003400" class="method">
  <div id="M003400_title" class="title">
    <b>test_unless_validation_using_method_false</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003400_source')" id="l_M003400_source">show source</a> ]</p>
  <div id="M003400_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1350</span>
1350:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_unless_validation_using_method_false</span>
1351:     <span class="ruby-comment cmt"># When the method returns false</span>
1352:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:too_long=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;hoo {{count}}&quot;</span>, <span class="ruby-identifier">:unless</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:condition_is_true_but_its_not</span> )
1353:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1354:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1355:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1356:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;hoo 5&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
1357:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003398" class="method">
  <div id="M003398_title" class="title">
    <b>test_unless_validation_using_method_true</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003398_source')" id="l_M003398_source">show source</a> ]</p>
  <div id="M003398_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1334</span>
1334:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_unless_validation_using_method_true</span>
1335:     <span class="ruby-comment cmt"># When the method returns true</span>
1336:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:too_long=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;hoo {{count}}&quot;</span>, <span class="ruby-identifier">:unless</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:condition_is_true</span> )
1337:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1338:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1339:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1340:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003404" class="method">
  <div id="M003404_title" class="title">
    <b>test_unless_validation_using_string_false</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003404_source')" id="l_M003404_source">show source</a> ]</p>
  <div id="M003404_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1384</span>
1384:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_unless_validation_using_string_false</span>
1385:     <span class="ruby-comment cmt"># When the evaluated string returns false</span>
1386:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:too_long=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;hoo {{count}}&quot;</span>, <span class="ruby-identifier">:unless</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;false&quot;</span>)
1387:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1388:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1389:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1390:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;hoo 5&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
1391:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003402" class="method">
  <div id="M003402_title" class="title">
    <b>test_unless_validation_using_string_true</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003402_source')" id="l_M003402_source">show source</a> ]</p>
  <div id="M003402_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1368</span>
1368:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_unless_validation_using_string_true</span>
1369:     <span class="ruby-comment cmt"># When the evaluated string returns true</span>
1370:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:too_long=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;hoo {{count}}&quot;</span>, <span class="ruby-identifier">:unless</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;a = 1; a == 1&quot;</span> )
1371:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1372:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1373:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1374:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003384" class="method">
  <div id="M003384_title" class="title">
    <b>test_validate_block</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003384_source')" id="l_M003384_source">show source</a> ]</p>
  <div id="M003384_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1203</span>
1203:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_block</span>
1204:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validate</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">topic</span><span class="ruby-operator">|</span> <span class="ruby-identifier">topic</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span>(<span class="ruby-value str">&quot;title&quot;</span>, <span class="ruby-value str">&quot;will never be valid&quot;</span>) }
1205:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Title&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1206:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1207:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1208:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;will never be valid&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
1209:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003329" class="method">
  <div id="M003329_title" class="title">
    <b>test_validate_case_insensitive_uniqueness</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003329_source')" id="l_M003329_source">show source</a> ]</p>
  <div id="M003329_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 446</span>
446:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_case_insensitive_uniqueness</span>
447:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_uniqueness_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:parent_id</span>, <span class="ruby-identifier">:case_sensitive</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">false</span>, <span class="ruby-identifier">:allow_nil</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>)
448: 
449:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;I'm unique!&quot;</span>, <span class="ruby-identifier">:parent_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">2</span>)
450:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Should save t as unique&quot;</span>
451: 
452:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">content</span> = <span class="ruby-value str">&quot;Remaining unique&quot;</span>
453:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Should still save t as unique&quot;</span>
454: 
455:     <span class="ruby-identifier">t2</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;I'm UNIQUE!&quot;</span>, <span class="ruby-identifier">:parent_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>)
456:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Shouldn't be valid&quot;</span>
457:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Shouldn't save t2 as unique&quot;</span>
458:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
459:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:parent_id</span>)
460:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;has already been taken&quot;</span>, <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
461: 
462:     <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;I'm truly UNIQUE!&quot;</span>
463:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Shouldn't be valid&quot;</span>
464:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Shouldn't save t2 as unique&quot;</span>
465:     <span class="ruby-identifier">assert_nil</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
466:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:parent_id</span>)
467: 
468:     <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">parent_id</span> = <span class="ruby-value">4</span>
469:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Should now save t2 as unique&quot;</span>
470: 
471:     <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">parent_id</span> = <span class="ruby-keyword kw">nil</span>
472:     <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">title</span> = <span class="ruby-keyword kw">nil</span>
473:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;should validate with nil&quot;</span>
474:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;should save with nil&quot;</span>
475: 
476:     <span class="ruby-identifier">with_kcode</span>(<span class="ruby-value str">'UTF8'</span>) <span class="ruby-keyword kw">do</span>
477:       <span class="ruby-identifier">t_utf8</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Я тоже уникальный!&quot;</span>)
478:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t_utf8</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Should save t_utf8 as unique&quot;</span>
479: 
480:       <span class="ruby-comment cmt"># If database hasn't UTF-8 character set, this test fails</span>
481:       <span class="ruby-keyword kw">if</span> <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">t_utf8</span>, <span class="ruby-identifier">:select</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'LOWER(title) AS title'</span>).<span class="ruby-identifier">title</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;я тоже уникальный!&quot;</span>
482:         <span class="ruby-identifier">t2_utf8</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;я тоже УНИКАЛЬНЫЙ!&quot;</span>)
483:         <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2_utf8</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Shouldn't be valid&quot;</span>
484:         <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2_utf8</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Shouldn't save t2_utf8 as unique&quot;</span>
485:       <span class="ruby-keyword kw">end</span>
486:     <span class="ruby-keyword kw">end</span>
487:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003330" class="method">
  <div id="M003330_title" class="title">
    <b>test_validate_case_sensitive_uniqueness</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003330_source')" id="l_M003330_source">show source</a> ]</p>
  <div id="M003330_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 489</span>
489:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_case_sensitive_uniqueness</span>
490:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_uniqueness_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:case_sensitive</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>, <span class="ruby-identifier">:allow_nil</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>)
491: 
492:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;I'm unique!&quot;</span>)
493:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Should save t as unique&quot;</span>
494: 
495:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">content</span> = <span class="ruby-value str">&quot;Remaining unique&quot;</span>
496:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Should still save t as unique&quot;</span>
497: 
498:     <span class="ruby-identifier">t2</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;I'M UNIQUE!&quot;</span>)
499:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Should be valid&quot;</span>
500:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Should save t2 as unique&quot;</span>
501:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
502:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:parent_id</span>)
503:     <span class="ruby-identifier">assert_not_equal</span> <span class="ruby-value str">&quot;has already been taken&quot;</span>, <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
504: 
505:     <span class="ruby-identifier">t3</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;I'M uNiQUe!&quot;</span>)
506:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t3</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Should be valid&quot;</span>
507:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t3</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Should save t2 as unique&quot;</span>
508:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t3</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
509:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t3</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:parent_id</span>)
510:     <span class="ruby-identifier">assert_not_equal</span> <span class="ruby-value str">&quot;has already been taken&quot;</span>, <span class="ruby-identifier">t3</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
511:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003331" class="method">
  <div id="M003331_title" class="title">
    <b>test_validate_case_sensitive_uniqueness_with_attribute_passed_as_integer</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003331_source')" id="l_M003331_source">show source</a> ]</p>
  <div id="M003331_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 513</span>
513:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_case_sensitive_uniqueness_with_attribute_passed_as_integer</span>
514:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_uniqueness_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:case_sensitve</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>)
515:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-value str">'title'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">101</span>)
516: 
517:     <span class="ruby-identifier">t2</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">'title'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">101</span>)
518:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2</span>.<span class="ruby-identifier">valid?</span>
519:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
520:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003338" class="method">
  <div id="M003338_title" class="title">
    <b>test_validate_format</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003338_source')" id="l_M003338_source">show source</a> ]</p>
  <div id="M003338_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 595</span>
595:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_format</span>
596:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_format_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:content</span>, <span class="ruby-identifier">:with</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-regexp re">/^Validation\smacros \w+!$/</span>, <span class="ruby-identifier">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;is bad data&quot;</span>)
597: 
598:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;i'm incorrect&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Validation macros rule!&quot;</span>)
599:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Shouldn't be valid&quot;</span>
600:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Shouldn't save because it's invalid&quot;</span>
601:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is bad data&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
602:     <span class="ruby-identifier">assert_nil</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:content</span>)
603: 
604:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;Validation macros rule!&quot;</span>
605: 
606:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
607:     <span class="ruby-identifier">assert_nil</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
608: 
609:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ArgumentError</span>) { <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_format_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:content</span>) }
610:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003340" class="method">
  <div id="M003340_title" class="title">
    <b>test_validate_format_numeric</b>()
  </div>
  <div class="description">
  <p>
testing ticket 3142
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003340_source')" id="l_M003340_source">show source</a> ]</p>
  <div id="M003340_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 621</span>
621:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_format_numeric</span>
622:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_format_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:content</span>, <span class="ruby-identifier">:with</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-regexp re">/^[1-9][0-9]*$/</span>, <span class="ruby-identifier">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;is bad data&quot;</span>)
623: 
624:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;72x&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;6789&quot;</span>)
625:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Shouldn't be valid&quot;</span>
626:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Shouldn't save because it's invalid&quot;</span>
627:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is bad data&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
628:     <span class="ruby-identifier">assert_nil</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:content</span>)
629: 
630:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;-11&quot;</span>
631:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Shouldn't be valid&quot;</span>
632: 
633:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;03&quot;</span>
634:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Shouldn't be valid&quot;</span>
635: 
636:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;z44&quot;</span>
637:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Shouldn't be valid&quot;</span>
638: 
639:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;5v7&quot;</span>
640:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Shouldn't be valid&quot;</span>
641: 
642:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;1&quot;</span>
643: 
644:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
645:     <span class="ruby-identifier">assert_nil</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
646:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003339" class="method">
  <div id="M003339_title" class="title">
    <b>test_validate_format_with_allow_blank</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003339_source')" id="l_M003339_source">show source</a> ]</p>
  <div id="M003339_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 612</span>
612:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_format_with_allow_blank</span>
613:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_format_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:with</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-regexp re">/^Validation\smacros \w+!$/</span>, <span class="ruby-identifier">:allow_blank=</span><span class="ruby-operator">&gt;</span><span class="ruby-keyword kw">true</span>)
614:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Shouldn't be valid&quot;</span>).<span class="ruby-identifier">valid?</span>
615:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;&quot;</span>).<span class="ruby-identifier">valid?</span>
616:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>).<span class="ruby-identifier">valid?</span>
617:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Validation macros rule!&quot;</span>).<span class="ruby-identifier">valid?</span>
618:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003341" class="method">
  <div id="M003341_title" class="title">
    <b>test_validate_format_with_formatted_message</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003341_source')" id="l_M003341_source">show source</a> ]</p>
  <div id="M003341_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 648</span>
648:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_format_with_formatted_message</span>
649:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_format_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:with</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-regexp re">/^Valid Title$/</span>, <span class="ruby-identifier">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;can't be {{value}}&quot;</span>)
650:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'Invalid title'</span>)
651:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;can't be Invalid title&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
652:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003323" class="method">
  <div id="M003323_title" class="title">
    <b>test_validate_presences</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003323_source')" id="l_M003323_source">show source</a> ]</p>
  <div id="M003323_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 340</span>
340:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_presences</span>
341:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_presence_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:content</span>)
342: 
343:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>
344:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
345:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;can't be blank&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
346:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;can't be blank&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:content</span>)
347: 
348:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;something&quot;</span>
349:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">content</span>  = <span class="ruby-value str">&quot;   &quot;</span>
350: 
351:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
352:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;can't be blank&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:content</span>)
353: 
354:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">content</span> = <span class="ruby-value str">&quot;like stuff&quot;</span>
355: 
356:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
357:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003337" class="method">
  <div id="M003337_title" class="title">
    <b>test_validate_straight_inheritance_uniqueness</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003337_source')" id="l_M003337_source">show source</a> ]</p>
  <div id="M003337_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 566</span>
566:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_straight_inheritance_uniqueness</span>
567:     <span class="ruby-identifier">w1</span> = <span class="ruby-constant">IneptWizard</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Rincewind&quot;</span>, <span class="ruby-identifier">:city</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Ankh-Morpork&quot;</span>)
568:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">w1</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Saving w1&quot;</span>
569: 
570:     <span class="ruby-comment cmt"># Should use validation from base class (which is abstract)</span>
571:     <span class="ruby-identifier">w2</span> = <span class="ruby-constant">IneptWizard</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Rincewind&quot;</span>, <span class="ruby-identifier">:city</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Quirm&quot;</span>)
572:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">w2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;w2 shouldn't be valid&quot;</span>
573:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">w2</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:name</span>), <span class="ruby-value str">&quot;Should have errors for name&quot;</span>
574:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;has already been taken&quot;</span>, <span class="ruby-identifier">w2</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:name</span>), <span class="ruby-value str">&quot;Should have uniqueness message for name&quot;</span>
575: 
576:     <span class="ruby-identifier">w3</span> = <span class="ruby-constant">Conjurer</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Rincewind&quot;</span>, <span class="ruby-identifier">:city</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Quirm&quot;</span>)
577:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">w3</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;w3 shouldn't be valid&quot;</span>
578:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">w3</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:name</span>), <span class="ruby-value str">&quot;Should have errors for name&quot;</span>
579:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;has already been taken&quot;</span>, <span class="ruby-identifier">w3</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:name</span>), <span class="ruby-value str">&quot;Should have uniqueness message for name&quot;</span>
580: 
581:     <span class="ruby-identifier">w4</span> = <span class="ruby-constant">Conjurer</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;The Amazing Bonko&quot;</span>, <span class="ruby-identifier">:city</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Quirm&quot;</span>)
582:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">w4</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Saving w4&quot;</span>
583: 
584:     <span class="ruby-identifier">w5</span> = <span class="ruby-constant">Thaumaturgist</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;The Amazing Bonko&quot;</span>, <span class="ruby-identifier">:city</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Lancre&quot;</span>)
585:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">w5</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;w5 shouldn't be valid&quot;</span>
586:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">w5</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:name</span>), <span class="ruby-value str">&quot;Should have errors for name&quot;</span>
587:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;has already been taken&quot;</span>, <span class="ruby-identifier">w5</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:name</span>), <span class="ruby-value str">&quot;Should have uniqueness message for name&quot;</span>
588: 
589:     <span class="ruby-identifier">w6</span> = <span class="ruby-constant">Thaumaturgist</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Mustrum Ridcully&quot;</span>, <span class="ruby-identifier">:city</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Quirm&quot;</span>)
590:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">w6</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;w6 shouldn't be valid&quot;</span>
591:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">w6</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:city</span>), <span class="ruby-value str">&quot;Should have errors for city&quot;</span>
592:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;has already been taken&quot;</span>, <span class="ruby-identifier">w6</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:city</span>), <span class="ruby-value str">&quot;Should have uniqueness message for city&quot;</span>
593:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003324" class="method">
  <div id="M003324_title" class="title">
    <b>test_validate_uniqueness</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003324_source')" id="l_M003324_source">show source</a> ]</p>
  <div id="M003324_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 359</span>
359:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_uniqueness</span>
360:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_uniqueness_of</span>(<span class="ruby-identifier">:title</span>)
361: 
362:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;I'm uniqué!&quot;</span>)
363:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Should save t as unique&quot;</span>
364: 
365:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">content</span> = <span class="ruby-value str">&quot;Remaining unique&quot;</span>
366:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Should still save t as unique&quot;</span>
367: 
368:     <span class="ruby-identifier">t2</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;I'm uniqué!&quot;</span>)
369:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Shouldn't be valid&quot;</span>
370:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Shouldn't save t2 as unique&quot;</span>
371:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;has already been taken&quot;</span>, <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
372: 
373:     <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;Now Im really also unique&quot;</span>
374:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Should now save t2 as unique&quot;</span>
375:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003327" class="method">
  <div id="M003327_title" class="title">
    <b>test_validate_uniqueness_scoped_to_defining_class</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003327_source')" id="l_M003327_source">show source</a> ]</p>
  <div id="M003327_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 405</span>
405:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_uniqueness_scoped_to_defining_class</span>
406:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;What, me worry?&quot;</span>)
407: 
408:     <span class="ruby-identifier">r1</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">unique_replies</span>.<span class="ruby-identifier">create</span> <span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;r1&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;a barrel of fun&quot;</span>
409:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r1</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Saving r1&quot;</span>
410: 
411:     <span class="ruby-identifier">r2</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">silly_unique_replies</span>.<span class="ruby-identifier">create</span> <span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;r2&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;a barrel of fun&quot;</span>
412:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">r2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Saving r2&quot;</span>
413: 
414:     <span class="ruby-comment cmt"># Should succeed as validates_uniqueness_of only applies to</span>
415:     <span class="ruby-comment cmt"># UniqueReply and its subclasses</span>
416:     <span class="ruby-identifier">r3</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">create</span> <span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;r2&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;a barrel of fun&quot;</span>
417:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r3</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Saving r3&quot;</span>
418:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003334" class="method">
  <div id="M003334_title" class="title">
    <b>test_validate_uniqueness_with_columns_which_are_sql_keywords</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003334_source')" id="l_M003334_source">show source</a> ]</p>
  <div id="M003334_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 539</span>
539:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_uniqueness_with_columns_which_are_sql_keywords</span>
540:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Guid</span>) <span class="ruby-keyword kw">do</span>
541:       <span class="ruby-constant">Guid</span>.<span class="ruby-identifier">validates_uniqueness_of</span> <span class="ruby-identifier">:key</span>
542:       <span class="ruby-identifier">g</span> = <span class="ruby-constant">Guid</span>.<span class="ruby-identifier">new</span>
543:       <span class="ruby-identifier">g</span>.<span class="ruby-identifier">key</span> = <span class="ruby-value str">&quot;foo&quot;</span>
544:       <span class="ruby-identifier">assert_nothing_raised</span> { <span class="ruby-operator">!</span><span class="ruby-identifier">g</span>.<span class="ruby-identifier">valid?</span> }
545:     <span class="ruby-keyword kw">end</span>
546:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003335" class="method">
  <div id="M003335_title" class="title">
    <b>test_validate_uniqueness_with_limit</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003335_source')" id="l_M003335_source">show source</a> ]</p>
  <div id="M003335_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 548</span>
548:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_uniqueness_with_limit</span>
549:     <span class="ruby-comment cmt"># Event.title is limited to 5 characters</span>
550:     <span class="ruby-identifier">e1</span> = <span class="ruby-constant">Event</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;abcde&quot;</span>)
551:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">e1</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Could not create an event with a unique, 5 character title&quot;</span>
552:     <span class="ruby-identifier">e2</span> = <span class="ruby-constant">Event</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;abcdefgh&quot;</span>)
553:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">e2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Created an event whose title, with limit taken into account, is not unique&quot;</span>
554:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003336" class="method">
  <div id="M003336_title" class="title">
    <b>test_validate_uniqueness_with_limit_and_utf8</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003336_source')" id="l_M003336_source">show source</a> ]</p>
  <div id="M003336_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 556</span>
556:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_uniqueness_with_limit_and_utf8</span>
557:     <span class="ruby-identifier">with_kcode</span>(<span class="ruby-value str">'UTF8'</span>) <span class="ruby-keyword kw">do</span>
558:       <span class="ruby-comment cmt"># Event.title is limited to 5 characters</span>
559:       <span class="ruby-identifier">e1</span> = <span class="ruby-constant">Event</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;一二三四五&quot;</span>)
560:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">e1</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Could not create an event with a unique, 5 character title&quot;</span>
561:       <span class="ruby-identifier">e2</span> = <span class="ruby-constant">Event</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;一二三四五六七八&quot;</span>)
562:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">e2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Created an event whose title, with limit taken into account, is not unique&quot;</span>
563:     <span class="ruby-keyword kw">end</span>
564:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003332" class="method">
  <div id="M003332_title" class="title">
    <b>test_validate_uniqueness_with_non_standard_table_names</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003332_source')" id="l_M003332_source">show source</a> ]</p>
  <div id="M003332_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 522</span>
522:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_uniqueness_with_non_standard_table_names</span>
523:     <span class="ruby-identifier">i1</span> = <span class="ruby-constant">WarehouseThing</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:value</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1000</span>)
524:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">i1</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;i1 should not be valid&quot;</span>
525:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">i1</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:value</span>), <span class="ruby-value str">&quot;Should not be empty&quot;</span>
526:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003326" class="method">
  <div id="M003326_title" class="title">
    <b>test_validate_uniqueness_with_scope</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003326_source')" id="l_M003326_source">show source</a> ]</p>
  <div id="M003326_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 384</span>
384:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_uniqueness_with_scope</span>
385:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Reply</span>) <span class="ruby-keyword kw">do</span>
386:       <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">validates_uniqueness_of</span>(<span class="ruby-identifier">:content</span>, <span class="ruby-identifier">:scope</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;parent_id&quot;</span>)
387: 
388:       <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;I'm unique!&quot;</span>)
389: 
390:       <span class="ruby-identifier">r1</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">create</span> <span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;r1&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;hello world&quot;</span>
391:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r1</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Saving r1&quot;</span>
392: 
393:       <span class="ruby-identifier">r2</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">create</span> <span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;r2&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;hello world&quot;</span>
394:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">r2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Saving r2 first time&quot;</span>
395: 
396:       <span class="ruby-identifier">r2</span>.<span class="ruby-identifier">content</span> = <span class="ruby-value str">&quot;something else&quot;</span>
397:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r2</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Saving r2 second time&quot;</span>
398: 
399:       <span class="ruby-identifier">t2</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;I'm unique too!&quot;</span>)
400:       <span class="ruby-identifier">r3</span> = <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">create</span> <span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;r3&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;hello world&quot;</span>
401:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r3</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Saving r3&quot;</span>
402:     <span class="ruby-keyword kw">end</span>
403:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003328" class="method">
  <div id="M003328_title" class="title">
    <b>test_validate_uniqueness_with_scope_array</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003328_source')" id="l_M003328_source">show source</a> ]</p>
  <div id="M003328_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 420</span>
420:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_uniqueness_with_scope_array</span>
421:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Reply</span>) <span class="ruby-keyword kw">do</span>
422:       <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">validates_uniqueness_of</span>(<span class="ruby-identifier">:author_name</span>, <span class="ruby-identifier">:scope</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-identifier">:author_email_address</span>, <span class="ruby-identifier">:parent_id</span>])
423: 
424:       <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;The earth is actually flat!&quot;</span>)
425: 
426:       <span class="ruby-identifier">r1</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">create</span> <span class="ruby-value str">&quot;author_name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;jeremy&quot;</span>, <span class="ruby-value str">&quot;author_email_address&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;jeremy@rubyonrails.com&quot;</span>, <span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;You're crazy!&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Crazy reply&quot;</span>
427:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r1</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Saving r1&quot;</span>
428: 
429:       <span class="ruby-identifier">r2</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">create</span> <span class="ruby-value str">&quot;author_name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;jeremy&quot;</span>, <span class="ruby-value str">&quot;author_email_address&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;jeremy@rubyonrails.com&quot;</span>, <span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;You're crazy!&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Crazy reply again...&quot;</span>
430:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">r2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Saving r2. Double reply by same author.&quot;</span>
431: 
432:       <span class="ruby-identifier">r2</span>.<span class="ruby-identifier">author_email_address</span> = <span class="ruby-value str">&quot;jeremy_alt_email@rubyonrails.com&quot;</span>
433:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r2</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Saving r2 the second time.&quot;</span>
434: 
435:       <span class="ruby-identifier">r3</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">create</span> <span class="ruby-value str">&quot;author_name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;jeremy&quot;</span>, <span class="ruby-value str">&quot;author_email_address&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;jeremy_alt_email@rubyonrails.com&quot;</span>, <span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;You're wrong&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;It's cubic&quot;</span>
436:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">r3</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Saving r3&quot;</span>
437: 
438:       <span class="ruby-identifier">r3</span>.<span class="ruby-identifier">author_name</span> = <span class="ruby-value str">&quot;jj&quot;</span>
439:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r3</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Saving r3 the second time.&quot;</span>
440: 
441:       <span class="ruby-identifier">r3</span>.<span class="ruby-identifier">author_name</span> = <span class="ruby-value str">&quot;jeremy&quot;</span>
442:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">r3</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Saving r3 the third time.&quot;</span>
443:     <span class="ruby-keyword kw">end</span>
444:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003321" class="method">
  <div id="M003321_title" class="title">
    <b>test_validates_acceptance_of_as_database_column</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003321_source')" id="l_M003321_source">show source</a> ]</p>
  <div id="M003321_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 323</span>
323:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_acceptance_of_as_database_column</span>
324:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Reply</span>) <span class="ruby-keyword kw">do</span>
325:       <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">validates_acceptance_of</span>(<span class="ruby-identifier">:author_name</span>)
326: 
327:       <span class="ruby-identifier">reply</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;author_name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Dan Brown&quot;</span>)
328:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;Dan Brown&quot;</span>, <span class="ruby-identifier">reply</span>[<span class="ruby-value str">&quot;author_name&quot;</span>]
329:     <span class="ruby-keyword kw">end</span>
330:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003387" class="method">
  <div id="M003387_title" class="title">
    <b>test_validates_acceptance_of_with_custom_error_using_quotes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003387_source')" id="l_M003387_source">show source</a> ]</p>
  <div id="M003387_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1223</span>
1223:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_acceptance_of_with_custom_error_using_quotes</span>
1224:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Developer</span>) <span class="ruby-keyword kw">do</span>
1225:       <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">validates_acceptance_of</span> <span class="ruby-identifier">:salary</span>, <span class="ruby-identifier">:message=</span><span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;This string contains 'single' and \&quot;double\&quot; quotes&quot;</span>
1226:       <span class="ruby-identifier">d</span> = <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">new</span>
1227:       <span class="ruby-identifier">d</span>.<span class="ruby-identifier">salary</span> = <span class="ruby-value str">&quot;0&quot;</span>
1228:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">d</span>.<span class="ruby-identifier">valid?</span>
1229:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;This string contains 'single' and \&quot;double\&quot; quotes&quot;</span>, <span class="ruby-identifier">d</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:salary</span>).<span class="ruby-identifier">last</span>
1230:     <span class="ruby-keyword kw">end</span>
1231:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003322" class="method">
  <div id="M003322_title" class="title">
    <b>test_validates_acceptance_of_with_non_existant_table</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003322_source')" id="l_M003322_source">show source</a> ]</p>
  <div id="M003322_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 332</span>
332:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_acceptance_of_with_non_existant_table</span>
333:     <span class="ruby-constant">Object</span>.<span class="ruby-identifier">const_set</span> <span class="ruby-identifier">:IncorporealModel</span>, <span class="ruby-constant">Class</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>)
334: 
335:     <span class="ruby-identifier">assert_nothing_raised</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">StatementInvalid</span> <span class="ruby-keyword kw">do</span>
336:       <span class="ruby-constant">IncorporealModel</span>.<span class="ruby-identifier">validates_acceptance_of</span>(<span class="ruby-identifier">:incorporeal_column</span>)
337:     <span class="ruby-keyword kw">end</span>
338:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003382" class="method">
  <div id="M003382_title" class="title">
    <b>test_validates_associated_many</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003382_source')" id="l_M003382_source">show source</a> ]</p>
  <div id="M003382_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1176</span>
1176:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_associated_many</span>
1177:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_associated</span>( <span class="ruby-identifier">:replies</span> )
1178:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1179:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">replies</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-identifier">r</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;A reply&quot;</span>), <span class="ruby-identifier">r2</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Another reply&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;non-empty&quot;</span>), <span class="ruby-identifier">r3</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Yet another reply&quot;</span>), <span class="ruby-identifier">r4</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;The last reply&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;non-empty&quot;</span>)]
1180:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1181:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:replies</span>)
1182:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">count</span>  <span class="ruby-comment cmt"># make sure all associated objects have been validated</span>
1183:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-identifier">r2</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">count</span>
1184:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">r3</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">count</span>
1185:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-identifier">r4</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">count</span>
1186:     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">content</span> = <span class="ruby-identifier">r3</span>.<span class="ruby-identifier">content</span> = <span class="ruby-value str">&quot;non-empty&quot;</span>
1187:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1188:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003409" class="method">
  <div id="M003409_title" class="title">
    <b>test_validates_associated_missing</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003409_source')" id="l_M003409_source">show source</a> ]</p>
  <div id="M003409_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1431</span>
1431:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_associated_missing</span>
1432:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Reply</span>) <span class="ruby-keyword kw">do</span>
1433:       <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">validates_presence_of</span>(<span class="ruby-identifier">:topic</span>)
1434:       <span class="ruby-identifier">r</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;A reply&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;with content!&quot;</span>)
1435:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">r</span>.<span class="ruby-identifier">valid?</span>
1436:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:topic</span>)
1437: 
1438:       <span class="ruby-identifier">r</span>.<span class="ruby-identifier">topic</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span> <span class="ruby-identifier">:first</span>
1439:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">valid?</span>
1440:     <span class="ruby-keyword kw">end</span>
1441:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003383" class="method">
  <div id="M003383_title" class="title">
    <b>test_validates_associated_one</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003383_source')" id="l_M003383_source">show source</a> ]</p>
  <div id="M003383_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1190</span>
1190:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_associated_one</span>
1191:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Reply</span>) <span class="ruby-keyword kw">do</span>
1192:       <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">validates_associated</span>( <span class="ruby-identifier">:topic</span> )
1193:       <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_presence_of</span>( <span class="ruby-identifier">:content</span> )
1194:       <span class="ruby-identifier">r</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;A reply&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;with content!&quot;</span>)
1195:       <span class="ruby-identifier">r</span>.<span class="ruby-identifier">topic</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>)
1196:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">r</span>.<span class="ruby-identifier">valid?</span>
1197:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:topic</span>)
1198:       <span class="ruby-identifier">r</span>.<span class="ruby-identifier">topic</span>.<span class="ruby-identifier">content</span> = <span class="ruby-value str">&quot;non-empty&quot;</span>
1199:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">valid?</span>
1200:     <span class="ruby-keyword kw">end</span>
1201:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003396" class="method">
  <div id="M003396_title" class="title">
    <b>test_validates_associated_with_custom_message_using_quotes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003396_source')" id="l_M003396_source">show source</a> ]</p>
  <div id="M003396_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1314</span>
1314:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_associated_with_custom_message_using_quotes</span>
1315:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Reply</span>) <span class="ruby-keyword kw">do</span>
1316:       <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">validates_associated</span> <span class="ruby-identifier">:topic</span>, <span class="ruby-identifier">:message=</span><span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;This string contains 'single' and \&quot;double\&quot; quotes&quot;</span>
1317:       <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_presence_of</span> <span class="ruby-identifier">:content</span>
1318:       <span class="ruby-identifier">r</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;A reply&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;with content!&quot;</span>)
1319:       <span class="ruby-identifier">r</span>.<span class="ruby-identifier">topic</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>)
1320:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">r</span>.<span class="ruby-identifier">valid?</span>
1321:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;This string contains 'single' and \&quot;double\&quot; quotes&quot;</span>, <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:topic</span>)
1322:     <span class="ruby-keyword kw">end</span>
1323:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003388" class="method">
  <div id="M003388_title" class="title">
    <b>test_validates_confirmation_of_with_custom_error_using_quotes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003388_source')" id="l_M003388_source">show source</a> ]</p>
  <div id="M003388_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1233</span>
1233:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_confirmation_of_with_custom_error_using_quotes</span>
1234:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Developer</span>) <span class="ruby-keyword kw">do</span>
1235:       <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">validates_confirmation_of</span> <span class="ruby-identifier">:name</span>, <span class="ruby-identifier">:message=</span><span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;confirm 'single' and \&quot;double\&quot; quotes&quot;</span>
1236:       <span class="ruby-identifier">d</span> = <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">new</span>
1237:       <span class="ruby-identifier">d</span>.<span class="ruby-identifier">name</span> = <span class="ruby-value str">&quot;John&quot;</span>
1238:       <span class="ruby-identifier">d</span>.<span class="ruby-identifier">name_confirmation</span> = <span class="ruby-value str">&quot;Johnny&quot;</span>
1239:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">d</span>.<span class="ruby-identifier">valid?</span>
1240:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;confirm 'single' and \&quot;double\&quot; quotes&quot;</span>, <span class="ruby-identifier">d</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:name</span>)
1241:     <span class="ruby-keyword kw">end</span>
1242:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003314" class="method">
  <div id="M003314_title" class="title">
    <b>test_validates_each</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003314_source')" id="l_M003314_source">show source</a> ]</p>
  <div id="M003314_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 242</span>
242:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_each</span>
243:     <span class="ruby-identifier">hits</span> = <span class="ruby-value">0</span>
244:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_each</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:content</span>, [<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:content</span>]) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">record</span>, <span class="ruby-identifier">attr</span><span class="ruby-operator">|</span>
245:       <span class="ruby-identifier">record</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span> <span class="ruby-identifier">attr</span>, <span class="ruby-value str">'gotcha'</span>
246:       <span class="ruby-identifier">hits</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
247:     <span class="ruby-keyword kw">end</span>
248:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;valid&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
249:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
250:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">4</span>, <span class="ruby-identifier">hits</span>
251:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-node">%w(gotcha gotcha)</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
252:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-node">%w(gotcha gotcha)</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:content</span>)
253:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003349" class="method">
  <div id="M003349_title" class="title">
    <b>test_validates_exclusion_of</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003349_source')" id="l_M003349_source">show source</a> ]</p>
  <div id="M003349_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 731</span>
731:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_exclusion_of</span>
732:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_exclusion_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:in</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">%w( abe monkey )</span> )
733: 
734:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;something&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;abc&quot;</span>).<span class="ruby-identifier">valid?</span>
735:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;monkey&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;abc&quot;</span>).<span class="ruby-identifier">valid?</span>
736:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003350" class="method">
  <div id="M003350_title" class="title">
    <b>test_validates_exclusion_of_with_formatted_message</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003350_source')" id="l_M003350_source">show source</a> ]</p>
  <div id="M003350_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 738</span>
738:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_exclusion_of_with_formatted_message</span>
739:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_exclusion_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:in</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">%w( abe monkey )</span>, <span class="ruby-identifier">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;option {{value}} is restricted&quot;</span> )
740: 
741:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;something&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;abc&quot;</span>)
742: 
743:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;monkey&quot;</span>)
744:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
745:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
746:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;option monkey is restricted&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
747:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003389" class="method">
  <div id="M003389_title" class="title">
    <b>test_validates_format_of_with_custom_error_using_quotes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003389_source')" id="l_M003389_source">show source</a> ]</p>
  <div id="M003389_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1244</span>
1244:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_format_of_with_custom_error_using_quotes</span>
1245:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Developer</span>) <span class="ruby-keyword kw">do</span>
1246:       <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">validates_format_of</span> <span class="ruby-identifier">:name</span>, <span class="ruby-identifier">:with</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-regexp re">/^(A-Z*)$/</span>, <span class="ruby-identifier">:message=</span><span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;format 'single' and \&quot;double\&quot; quotes&quot;</span>
1247:       <span class="ruby-identifier">d</span> = <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">new</span>
1248:       <span class="ruby-identifier">d</span>.<span class="ruby-identifier">name</span> = <span class="ruby-identifier">d</span>.<span class="ruby-identifier">name_confirmation</span> = <span class="ruby-value str">&quot;John 32&quot;</span>
1249:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">d</span>.<span class="ruby-identifier">valid?</span>
1250:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;format 'single' and \&quot;double\&quot; quotes&quot;</span>, <span class="ruby-identifier">d</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:name</span>)
1251:     <span class="ruby-keyword kw">end</span>
1252:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003342" class="method">
  <div id="M003342_title" class="title">
    <b>test_validates_inclusion_of</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003342_source')" id="l_M003342_source">show source</a> ]</p>
  <div id="M003342_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 654</span>
654:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_inclusion_of</span>
655:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_inclusion_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:in</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">%w( a b c d e f g )</span> )
656: 
657:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;a!&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;abc&quot;</span>).<span class="ruby-identifier">valid?</span>
658:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;a b&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;abc&quot;</span>).<span class="ruby-identifier">valid?</span>
659:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;def&quot;</span>).<span class="ruby-identifier">valid?</span>
660: 
661:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;a&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;I know you are but what am I?&quot;</span>)
662:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
663:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;uhoh&quot;</span>
664:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
665:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
666:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is not included in the list&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
667: 
668:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ArgumentError</span>) { <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_inclusion_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:in</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span> ) }
669:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ArgumentError</span>) { <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_inclusion_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:in</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>) }
670: 
671:     <span class="ruby-identifier">assert_nothing_raised</span>(<span class="ruby-constant">ArgumentError</span>) { <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_inclusion_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:in</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;hi!&quot;</span> ) }
672:     <span class="ruby-identifier">assert_nothing_raised</span>(<span class="ruby-constant">ArgumentError</span>) { <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_inclusion_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:in</span> =<span class="ruby-operator">&gt;</span> {} ) }
673:     <span class="ruby-identifier">assert_nothing_raised</span>(<span class="ruby-constant">ArgumentError</span>) { <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_inclusion_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:in</span> =<span class="ruby-operator">&gt;</span> [] ) }
674:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003343" class="method">
  <div id="M003343_title" class="title">
    <b>test_validates_inclusion_of_with_allow_nil</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003343_source')" id="l_M003343_source">show source</a> ]</p>
  <div id="M003343_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 676</span>
676:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_inclusion_of_with_allow_nil</span>
677:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_inclusion_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:in</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">%w( a b c d e f g )</span>, <span class="ruby-identifier">:allow_nil=</span><span class="ruby-operator">&gt;</span><span class="ruby-keyword kw">true</span> )
678: 
679:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;a!&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;abc&quot;</span>).<span class="ruby-identifier">valid?</span>
680:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;abc&quot;</span>).<span class="ruby-identifier">valid?</span>
681:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;abc&quot;</span>).<span class="ruby-identifier">valid?</span>
682:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003390" class="method">
  <div id="M003390_title" class="title">
    <b>test_validates_inclusion_of_with_custom_error_using_quotes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003390_source')" id="l_M003390_source">show source</a> ]</p>
  <div id="M003390_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1254</span>
1254:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_inclusion_of_with_custom_error_using_quotes</span>
1255:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Developer</span>) <span class="ruby-keyword kw">do</span>
1256:       <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">validates_inclusion_of</span> <span class="ruby-identifier">:salary</span>, <span class="ruby-identifier">:in</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1000</span><span class="ruby-operator">..</span><span class="ruby-value">80000</span>, <span class="ruby-identifier">:message=</span><span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;This string contains 'single' and \&quot;double\&quot; quotes&quot;</span>
1257:       <span class="ruby-identifier">d</span> = <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">new</span>
1258:       <span class="ruby-identifier">d</span>.<span class="ruby-identifier">salary</span> = <span class="ruby-value str">&quot;90,000&quot;</span>
1259:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">d</span>.<span class="ruby-identifier">valid?</span>
1260:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;This string contains 'single' and \&quot;double\&quot; quotes&quot;</span>, <span class="ruby-identifier">d</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:salary</span>).<span class="ruby-identifier">last</span>
1261:     <span class="ruby-keyword kw">end</span>
1262:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003347" class="method">
  <div id="M003347_title" class="title">
    <b>test_validates_inclusion_of_with_formatted_message</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003347_source')" id="l_M003347_source">show source</a> ]</p>
  <div id="M003347_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 711</span>
711:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_inclusion_of_with_formatted_message</span>
712:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_inclusion_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:in</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">%w( a b c d e f g )</span>, <span class="ruby-identifier">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;option {{value}} is not in the list&quot;</span> )
713: 
714:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;a&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;abc&quot;</span>).<span class="ruby-identifier">valid?</span>
715: 
716:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;abc&quot;</span>)
717:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
718:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
719:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;option uhoh is not in the list&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
720:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003369" class="method">
  <div id="M003369_title" class="title">
    <b>test_validates_length_of_custom_errors_for_in</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003369_source')" id="l_M003369_source">show source</a> ]</p>
  <div id="M003369_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 998</span>
 998:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_custom_errors_for_in</span>
 999:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:in</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">10</span><span class="ruby-operator">..</span><span class="ruby-value">20</span>, <span class="ruby-identifier">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;hoo {{count}}&quot;</span>)
1000:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1001:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1002:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1003:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;hoo 10&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
1004: 
1005:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhohuhohuhohuhohuhohuhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1006:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1007:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1008:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;hoo 20&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
1009:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003371" class="method">
  <div id="M003371_title" class="title">
    <b>test_validates_length_of_custom_errors_for_is_with_message</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003371_source')" id="l_M003371_source">show source</a> ]</p>
  <div id="M003371_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1019</span>
1019:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_custom_errors_for_is_with_message</span>
1020:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:is=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:message=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;boo {{count}}&quot;</span> )
1021:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1022:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1023:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1024:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;boo 5&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
1025:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003372" class="method">
  <div id="M003372_title" class="title">
    <b>test_validates_length_of_custom_errors_for_is_with_wrong_length</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003372_source')" id="l_M003372_source">show source</a> ]</p>
  <div id="M003372_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1027</span>
1027:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_custom_errors_for_is_with_wrong_length</span>
1028:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:is=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:wrong_length=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;hoo {{count}}&quot;</span> )
1029:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1030:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1031:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1032:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;hoo 5&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
1033:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003368" class="method">
  <div id="M003368_title" class="title">
    <b>test_validates_length_of_custom_errors_for_maximum_with_message</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003368_source')" id="l_M003368_source">show source</a> ]</p>
  <div id="M003368_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 990</span>
990:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_custom_errors_for_maximum_with_message</span>
991:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:message=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;boo {{count}}&quot;</span> )
992:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
993:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
994:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
995:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;boo 5&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
996:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003370" class="method">
  <div id="M003370_title" class="title">
    <b>test_validates_length_of_custom_errors_for_maximum_with_too_long</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003370_source')" id="l_M003370_source">show source</a> ]</p>
  <div id="M003370_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1011</span>
1011:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_custom_errors_for_maximum_with_too_long</span>
1012:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:too_long=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;hoo {{count}}&quot;</span> )
1013:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1014:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1015:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1016:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;hoo 5&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
1017:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003366" class="method">
  <div id="M003366_title" class="title">
    <b>test_validates_length_of_custom_errors_for_minimum_with_message</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003366_source')" id="l_M003366_source">show source</a> ]</p>
  <div id="M003366_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 974</span>
974:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_custom_errors_for_minimum_with_message</span>
975:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:minimum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:message=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;boo {{count}}&quot;</span> )
976:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
977:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
978:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
979:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;boo 5&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
980:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003367" class="method">
  <div id="M003367_title" class="title">
    <b>test_validates_length_of_custom_errors_for_minimum_with_too_short</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003367_source')" id="l_M003367_source">show source</a> ]</p>
  <div id="M003367_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 982</span>
982:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_custom_errors_for_minimum_with_too_short</span>
983:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:minimum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:too_short=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;hoo {{count}}&quot;</span> )
984:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
985:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
986:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
987:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;hoo 5&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
988:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003365" class="method">
  <div id="M003365_title" class="title">
    <b>test_validates_length_of_nasty_params</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003365_source')" id="l_M003365_source">show source</a> ]</p>
  <div id="M003365_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 963</span>
963:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_nasty_params</span>
964:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ArgumentError</span>) { <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:minimum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">6</span>, <span class="ruby-identifier">:maximum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">9</span>) }
965:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ArgumentError</span>) { <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:within=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">6</span>, <span class="ruby-identifier">:maximum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">9</span>) }
966:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ArgumentError</span>) { <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:within=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">6</span>, <span class="ruby-identifier">:minimum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">9</span>) }
967:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ArgumentError</span>) { <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:within=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">6</span>, <span class="ruby-identifier">:is=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">9</span>) }
968:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ArgumentError</span>) { <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:minimum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;a&quot;</span>) }
969:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ArgumentError</span>) { <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;a&quot;</span>) }
970:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ArgumentError</span>) { <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:within=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;a&quot;</span>) }
971:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ArgumentError</span>) { <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:is=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;a&quot;</span>) }
972:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003361" class="method">
  <div id="M003361_title" class="title">
    <b>test_validates_length_of_using_bignum</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003361_source')" id="l_M003361_source">show source</a> ]</p>
  <div id="M003361_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 908</span>
908:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_using_bignum</span>
909:     <span class="ruby-identifier">bigmin</span> = <span class="ruby-value">2</span> <span class="ruby-operator">**</span> <span class="ruby-value">30</span>
910:     <span class="ruby-identifier">bigmax</span> = <span class="ruby-value">2</span> <span class="ruby-operator">**</span> <span class="ruby-value">32</span>
911:     <span class="ruby-identifier">bigrange</span> = <span class="ruby-identifier">bigmin</span><span class="ruby-operator">...</span><span class="ruby-identifier">bigmax</span>
912:     <span class="ruby-identifier">assert_nothing_raised</span> <span class="ruby-keyword kw">do</span>
913:       <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:is</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">bigmin</span> <span class="ruby-operator">+</span> <span class="ruby-value">5</span>
914:       <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:within</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">bigrange</span>
915:       <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:in</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">bigrange</span>
916:       <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:minimum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">bigmin</span>
917:       <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">bigmax</span>
918:     <span class="ruby-keyword kw">end</span>
919:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003359" class="method">
  <div id="M003359_title" class="title">
    <b>test_validates_length_of_using_is</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003359_source')" id="l_M003359_source">show source</a> ]</p>
  <div id="M003359_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 880</span>
880:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_using_is</span>
881:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:is</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span>
882: 
883:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;valid&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
884:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
885: 
886:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;notvalid&quot;</span>
887:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
888:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
889:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is the wrong length (should be 5 characters)&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
890: 
891:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;&quot;</span>
892:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
893: 
894:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-keyword kw">nil</span>
895:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
896:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003379" class="method">
  <div id="M003379_title" class="title">
    <b>test_validates_length_of_using_is_utf8</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003379_source')" id="l_M003379_source">show source</a> ]</p>
  <div id="M003379_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1137</span>
1137:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_using_is_utf8</span>
1138:     <span class="ruby-identifier">with_kcode</span>(<span class="ruby-value str">'UTF8'</span>) <span class="ruby-keyword kw">do</span>
1139:       <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:is</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span>
1140: 
1141:       <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;一二345&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1142:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1143: 
1144:       <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;一二345六&quot;</span>
1145:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1146:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1147:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is the wrong length (should be 5 characters)&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
1148:     <span class="ruby-keyword kw">end</span>
1149:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003353" class="method">
  <div id="M003353_title" class="title">
    <b>test_validates_length_of_using_maximum</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003353_source')" id="l_M003353_source">show source</a> ]</p>
  <div id="M003353_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 781</span>
781:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_using_maximum</span>
782:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span>
783: 
784:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;valid&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
785:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
786: 
787:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;notvalid&quot;</span>
788:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
789:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
790:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is too long (maximum is 5 characters)&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
791: 
792:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;&quot;</span>
793:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
794: 
795:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-keyword kw">nil</span>
796:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
797:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003374" class="method">
  <div id="M003374_title" class="title">
    <b>test_validates_length_of_using_maximum_utf8</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003374_source')" id="l_M003374_source">show source</a> ]</p>
  <div id="M003374_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1049</span>
1049:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_using_maximum_utf8</span>
1050:     <span class="ruby-identifier">with_kcode</span>(<span class="ruby-value str">'UTF8'</span>) <span class="ruby-keyword kw">do</span>
1051:       <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span>
1052: 
1053:       <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;一二三四五&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1054:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1055: 
1056:       <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;一二34五六&quot;</span>
1057:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1058:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1059:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is too long (maximum is 5 characters)&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
1060:     <span class="ruby-keyword kw">end</span>
1061:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003351" class="method">
  <div id="M003351_title" class="title">
    <b>test_validates_length_of_using_minimum</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003351_source')" id="l_M003351_source">show source</a> ]</p>
  <div id="M003351_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 749</span>
749:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_using_minimum</span>
750:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:minimum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span>
751: 
752:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;valid&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
753:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
754: 
755:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;not&quot;</span>
756:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
757:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
758:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is too short (minimum is 5 characters)&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
759: 
760:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;&quot;</span>
761:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
762:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
763:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is too short (minimum is 5 characters)&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
764: 
765:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-keyword kw">nil</span>
766:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
767:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
768:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is too short (minimum is 5 characters)&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
769:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003373" class="method">
  <div id="M003373_title" class="title">
    <b>test_validates_length_of_using_minimum_utf8</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003373_source')" id="l_M003373_source">show source</a> ]</p>
  <div id="M003373_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1035</span>
1035:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_using_minimum_utf8</span>
1036:     <span class="ruby-identifier">with_kcode</span>(<span class="ruby-value str">'UTF8'</span>) <span class="ruby-keyword kw">do</span>
1037:       <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:minimum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span>
1038: 
1039:       <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;一二三四五&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1040:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1041: 
1042:       <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;一二三四&quot;</span>
1043:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1044:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1045:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is too short (minimum is 5 characters)&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
1046:     <span class="ruby-keyword kw">end</span>
1047:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003355" class="method">
  <div id="M003355_title" class="title">
    <b>test_validates_length_of_using_within</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003355_source')" id="l_M003355_source">show source</a> ]</p>
  <div id="M003355_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 809</span>
809:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_using_within</span>
810:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:content</span>, <span class="ruby-identifier">:within</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">3</span><span class="ruby-operator">..</span><span class="ruby-value">5</span>)
811: 
812:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;a!&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;I'm ooooooooh so very long&quot;</span>)
813:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
814:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is too short (minimum is 3 characters)&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
815:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is too long (maximum is 5 characters)&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:content</span>)
816: 
817:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-keyword kw">nil</span>
818:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">content</span> = <span class="ruby-keyword kw">nil</span>
819:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
820:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is too short (minimum is 3 characters)&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
821:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is too short (minimum is 3 characters)&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:content</span>)
822: 
823:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;abe&quot;</span>
824:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">content</span>  = <span class="ruby-value str">&quot;mad&quot;</span>
825:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
826:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003375" class="method">
  <div id="M003375_title" class="title">
    <b>test_validates_length_of_using_within_utf8</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003375_source')" id="l_M003375_source">show source</a> ]</p>
  <div id="M003375_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1063</span>
1063:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_using_within_utf8</span>
1064:     <span class="ruby-identifier">with_kcode</span>(<span class="ruby-value str">'UTF8'</span>) <span class="ruby-keyword kw">do</span>
1065:       <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:content</span>, <span class="ruby-identifier">:within</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">3</span><span class="ruby-operator">..</span><span class="ruby-value">5</span>)
1066: 
1067:       <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;一二&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;12三四五六七&quot;</span>)
1068:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1069:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is too short (minimum is 3 characters)&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1070:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is too long (maximum is 5 characters)&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:content</span>)
1071:       <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;一二三&quot;</span>
1072:       <span class="ruby-identifier">t</span>.<span class="ruby-identifier">content</span>  = <span class="ruby-value str">&quot;12三&quot;</span>
1073:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1074:     <span class="ruby-keyword kw">end</span>
1075:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003346" class="method">
  <div id="M003346_title" class="title">
    <b>test_validates_length_of_with_allow_blank</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003346_source')" id="l_M003346_source">show source</a> ]</p>
  <div id="M003346_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 702</span>
702:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_with_allow_blank</span>
703:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:is</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span>, <span class="ruby-identifier">:allow_blank=</span><span class="ruby-operator">&gt;</span><span class="ruby-keyword kw">true</span> )
704: 
705:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;ab&quot;</span>).<span class="ruby-identifier">valid?</span>
706:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;&quot;</span>).<span class="ruby-identifier">valid?</span>
707:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>).<span class="ruby-identifier">valid?</span>
708:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;abcde&quot;</span>).<span class="ruby-identifier">valid?</span>
709:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003345" class="method">
  <div id="M003345_title" class="title">
    <b>test_validates_length_of_with_allow_nil</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003345_source')" id="l_M003345_source">show source</a> ]</p>
  <div id="M003345_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 693</span>
693:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_with_allow_nil</span>
694:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:is</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span>, <span class="ruby-identifier">:allow_nil=</span><span class="ruby-operator">&gt;</span><span class="ruby-keyword kw">true</span> )
695: 
696:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;ab&quot;</span>).<span class="ruby-identifier">valid?</span>
697:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;&quot;</span>).<span class="ruby-identifier">valid?</span>
698:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>).<span class="ruby-identifier">valid?</span>
699:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;abcde&quot;</span>).<span class="ruby-identifier">valid?</span>
700:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003380" class="method">
  <div id="M003380_title" class="title">
    <b>test_validates_length_of_with_block</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003380_source')" id="l_M003380_source">show source</a> ]</p>
  <div id="M003380_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1151</span>
1151:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_with_block</span>
1152:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:content</span>, <span class="ruby-identifier">:minimum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span>, <span class="ruby-identifier">:too_short=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;Your essay must be at least {{count}} words.&quot;</span>,
1153:                                         <span class="ruby-identifier">:tokenizer</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">lambda</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">str</span><span class="ruby-operator">|</span> <span class="ruby-identifier">str</span>.<span class="ruby-identifier">scan</span>(<span class="ruby-regexp re">/\w+/</span>) }
1154:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-identifier">:content</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;this content should be long enough&quot;</span>)
1155:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1156: 
1157:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">content</span> = <span class="ruby-value str">&quot;not long enough&quot;</span>
1158:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1159:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:content</span>)
1160:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;Your essay must be at least 5 words.&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-identifier">:content</span>]
1161:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003393" class="method">
  <div id="M003393_title" class="title">
    <b>test_validates_length_of_with_custom_message_using_quotes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003393_source')" id="l_M003393_source">show source</a> ]</p>
  <div id="M003393_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1284</span>
1284:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_with_custom_message_using_quotes</span>
1285:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Developer</span>) <span class="ruby-keyword kw">do</span>
1286:       <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:name</span>, <span class="ruby-identifier">:minimum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">4</span>, <span class="ruby-identifier">:message=</span><span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;This string contains 'single' and \&quot;double\&quot; quotes&quot;</span>
1287:       <span class="ruby-identifier">d</span> = <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">new</span>
1288:       <span class="ruby-identifier">d</span>.<span class="ruby-identifier">name</span> = <span class="ruby-value str">&quot;Joe&quot;</span>
1289:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">d</span>.<span class="ruby-identifier">valid?</span>
1290:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;This string contains 'single' and \&quot;double\&quot; quotes&quot;</span>, <span class="ruby-identifier">d</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:name</span>)
1291:     <span class="ruby-keyword kw">end</span>
1292:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003391" class="method">
  <div id="M003391_title" class="title">
    <b>test_validates_length_of_with_custom_too_long_using_quotes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003391_source')" id="l_M003391_source">show source</a> ]</p>
  <div id="M003391_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1264</span>
1264:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_with_custom_too_long_using_quotes</span>
1265:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Developer</span>) <span class="ruby-keyword kw">do</span>
1266:       <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:name</span>, <span class="ruby-identifier">:maximum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">4</span>, <span class="ruby-identifier">:too_long=</span><span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;This string contains 'single' and \&quot;double\&quot; quotes&quot;</span>
1267:       <span class="ruby-identifier">d</span> = <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">new</span>
1268:       <span class="ruby-identifier">d</span>.<span class="ruby-identifier">name</span> = <span class="ruby-value str">&quot;Jeffrey&quot;</span>
1269:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">d</span>.<span class="ruby-identifier">valid?</span>
1270:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;This string contains 'single' and \&quot;double\&quot; quotes&quot;</span>, <span class="ruby-identifier">d</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:name</span>)
1271:     <span class="ruby-keyword kw">end</span>
1272:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003392" class="method">
  <div id="M003392_title" class="title">
    <b>test_validates_length_of_with_custom_too_short_using_quotes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003392_source')" id="l_M003392_source">show source</a> ]</p>
  <div id="M003392_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1274</span>
1274:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_with_custom_too_short_using_quotes</span>
1275:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Developer</span>) <span class="ruby-keyword kw">do</span>
1276:       <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:name</span>, <span class="ruby-identifier">:minimum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">4</span>, <span class="ruby-identifier">:too_short=</span><span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;This string contains 'single' and \&quot;double\&quot; quotes&quot;</span>
1277:       <span class="ruby-identifier">d</span> = <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">new</span>
1278:       <span class="ruby-identifier">d</span>.<span class="ruby-identifier">name</span> = <span class="ruby-value str">&quot;Joe&quot;</span>
1279:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">d</span>.<span class="ruby-identifier">valid?</span>
1280:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;This string contains 'single' and \&quot;double\&quot; quotes&quot;</span>, <span class="ruby-identifier">d</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:name</span>)
1281:     <span class="ruby-keyword kw">end</span>
1282:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003362" class="method">
  <div id="M003362_title" class="title">
    <b>test_validates_length_with_globally_modified_error_message</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003362_source')" id="l_M003362_source">show source</a> ]</p>
  <div id="M003362_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 921</span>
921:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_with_globally_modified_error_message</span>
922:     <span class="ruby-identifier">defaults</span> = <span class="ruby-constant">ActiveSupport</span><span class="ruby-operator">::</span><span class="ruby-constant">Deprecation</span>.<span class="ruby-identifier">silence</span> { <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Errors</span>.<span class="ruby-identifier">default_error_messages</span> }
923:     <span class="ruby-identifier">original_message</span> = <span class="ruby-identifier">defaults</span>[<span class="ruby-identifier">:too_short</span>]
924:     <span class="ruby-identifier">defaults</span>[<span class="ruby-identifier">:too_short</span>] = <span class="ruby-value str">'tu est trops petit hombre {{count}}'</span>
925: 
926:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:minimum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">10</span>
927:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'too short'</span>)
928:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
929: 
930:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'tu est trops petit hombre 10'</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">'title'</span>]
931: 
932:   <span class="ruby-keyword kw">ensure</span>
933:     <span class="ruby-identifier">defaults</span>[<span class="ruby-identifier">:too_short</span>] = <span class="ruby-identifier">original_message</span>
934:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003394" class="method">
  <div id="M003394_title" class="title">
    <b>test_validates_presence_of_with_custom_message_using_quotes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003394_source')" id="l_M003394_source">show source</a> ]</p>
  <div id="M003394_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1294</span>
1294:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_presence_of_with_custom_message_using_quotes</span>
1295:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Developer</span>) <span class="ruby-keyword kw">do</span>
1296:       <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">validates_presence_of</span> <span class="ruby-identifier">:non_existent</span>, <span class="ruby-identifier">:message=</span><span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;This string contains 'single' and \&quot;double\&quot; quotes&quot;</span>
1297:       <span class="ruby-identifier">d</span> = <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">new</span>
1298:       <span class="ruby-identifier">d</span>.<span class="ruby-identifier">name</span> = <span class="ruby-value str">&quot;Joe&quot;</span>
1299:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">d</span>.<span class="ruby-identifier">valid?</span>
1300:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;This string contains 'single' and \&quot;double\&quot; quotes&quot;</span>, <span class="ruby-identifier">d</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:non_existent</span>)
1301:     <span class="ruby-keyword kw">end</span>
1302:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003363" class="method">
  <div id="M003363_title" class="title">
    <b>test_validates_size_of_association</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003363_source')" id="l_M003363_source">show source</a> ]</p>
  <div id="M003363_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 936</span>
936:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_size_of_association</span>
937:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Owner</span>) <span class="ruby-keyword kw">do</span>
938:       <span class="ruby-identifier">assert_nothing_raised</span> { <span class="ruby-constant">Owner</span>.<span class="ruby-identifier">validates_size_of</span> <span class="ruby-identifier">:pets</span>, <span class="ruby-identifier">:minimum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span> }
939:       <span class="ruby-identifier">o</span> = <span class="ruby-constant">Owner</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">'name'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'nopets'</span>)
940:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">o</span>.<span class="ruby-identifier">save</span>
941:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:pets</span>)
942:       <span class="ruby-identifier">pet</span> = <span class="ruby-identifier">o</span>.<span class="ruby-identifier">pets</span>.<span class="ruby-identifier">build</span>(<span class="ruby-value str">'name'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'apet'</span>)
943:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">valid?</span>
944:     <span class="ruby-keyword kw">end</span>
945:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003364" class="method">
  <div id="M003364_title" class="title">
    <b>test_validates_size_of_association_using_within</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003364_source')" id="l_M003364_source">show source</a> ]</p>
  <div id="M003364_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 947</span>
947:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_size_of_association_using_within</span>
948:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Owner</span>) <span class="ruby-keyword kw">do</span>
949:       <span class="ruby-identifier">assert_nothing_raised</span> { <span class="ruby-constant">Owner</span>.<span class="ruby-identifier">validates_size_of</span> <span class="ruby-identifier">:pets</span>, <span class="ruby-identifier">:within</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">2</span> }
950:       <span class="ruby-identifier">o</span> = <span class="ruby-constant">Owner</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">'name'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'nopets'</span>)
951:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">o</span>.<span class="ruby-identifier">save</span>
952:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:pets</span>)
953: 
954:       <span class="ruby-identifier">pet</span> = <span class="ruby-identifier">o</span>.<span class="ruby-identifier">pets</span>.<span class="ruby-identifier">build</span>(<span class="ruby-value str">'name'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'apet'</span>)
955:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">valid?</span>
956: 
957:       <span class="ruby-value">2</span>.<span class="ruby-identifier">times</span> { <span class="ruby-identifier">o</span>.<span class="ruby-identifier">pets</span>.<span class="ruby-identifier">build</span>(<span class="ruby-value str">'name'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'apet'</span>) }
958:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">o</span>.<span class="ruby-identifier">save</span>
959:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:pets</span>)
960:     <span class="ruby-keyword kw">end</span>
961:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003381" class="method">
  <div id="M003381_title" class="title">
    <b>test_validates_size_of_association_utf8</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003381_source')" id="l_M003381_source">show source</a> ]</p>
  <div id="M003381_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1163</span>
1163:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_size_of_association_utf8</span>
1164:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Owner</span>) <span class="ruby-keyword kw">do</span>
1165:       <span class="ruby-identifier">with_kcode</span>(<span class="ruby-value str">'UTF8'</span>) <span class="ruby-keyword kw">do</span>
1166:         <span class="ruby-identifier">assert_nothing_raised</span> { <span class="ruby-constant">Owner</span>.<span class="ruby-identifier">validates_size_of</span> <span class="ruby-identifier">:pets</span>, <span class="ruby-identifier">:minimum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span> }
1167:         <span class="ruby-identifier">o</span> = <span class="ruby-constant">Owner</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">'name'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'あいうえおかきくけこ'</span>)
1168:         <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">o</span>.<span class="ruby-identifier">save</span>
1169:         <span class="ruby-identifier">assert</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:pets</span>)
1170:         <span class="ruby-identifier">o</span>.<span class="ruby-identifier">pets</span>.<span class="ruby-identifier">build</span>(<span class="ruby-value str">'name'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'あいうえおかきくけこ'</span>)
1171:         <span class="ruby-identifier">assert</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">valid?</span>
1172:       <span class="ruby-keyword kw">end</span>
1173:     <span class="ruby-keyword kw">end</span>
1174:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003333" class="method">
  <div id="M003333_title" class="title">
    <b>test_validates_uniqueness_inside_with_scope</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003333_source')" id="l_M003333_source">show source</a> ]</p>
  <div id="M003333_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 528</span>
528:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_uniqueness_inside_with_scope</span>
529:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_uniqueness_of</span>(<span class="ruby-identifier">:title</span>)
530: 
531:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">with_scope</span>(<span class="ruby-identifier">:find</span> =<span class="ruby-operator">&gt;</span> { <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> { <span class="ruby-identifier">:author_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;David&quot;</span> } }) <span class="ruby-keyword kw">do</span>
532:       <span class="ruby-identifier">t1</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;I'm unique!&quot;</span>, <span class="ruby-value str">&quot;author_name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Mary&quot;</span>)
533:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t1</span>.<span class="ruby-identifier">save</span>
534:       <span class="ruby-identifier">t2</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;I'm unique!&quot;</span>, <span class="ruby-value str">&quot;author_name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;David&quot;</span>)
535:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2</span>.<span class="ruby-identifier">valid?</span>
536:     <span class="ruby-keyword kw">end</span>
537:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003395" class="method">
  <div id="M003395_title" class="title">
    <b>test_validates_uniqueness_of_with_custom_message_using_quotes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003395_source')" id="l_M003395_source">show source</a> ]</p>
  <div id="M003395_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1304</span>
1304:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_uniqueness_of_with_custom_message_using_quotes</span>
1305:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Developer</span>) <span class="ruby-keyword kw">do</span>
1306:       <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">validates_uniqueness_of</span> <span class="ruby-identifier">:name</span>, <span class="ruby-identifier">:message=</span><span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;This string contains 'single' and \&quot;double\&quot; quotes&quot;</span>
1307:       <span class="ruby-identifier">d</span> = <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">new</span>
1308:       <span class="ruby-identifier">d</span>.<span class="ruby-identifier">name</span> = <span class="ruby-value str">&quot;David&quot;</span>
1309:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">d</span>.<span class="ruby-identifier">valid?</span>
1310:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;This string contains 'single' and \&quot;double\&quot; quotes&quot;</span>, <span class="ruby-identifier">d</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:name</span>)
1311:     <span class="ruby-keyword kw">end</span>
1312:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003325" class="method">
  <div id="M003325_title" class="title">
    <b>test_validates_uniquness_with_newline_chars</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003325_source')" id="l_M003325_source">show source</a> ]</p>
  <div id="M003325_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 377</span>
377:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_uniquness_with_newline_chars</span>
378:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_uniqueness_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:case_sensitive</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">false</span>)
379: 
380:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;new\nline&quot;</span>)
381:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Should save t as unique&quot;</span>
382:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003411" class="method">
  <div id="M003411_title" class="title">
    <b>test_validation_order</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003411_source')" id="l_M003411_source">show source</a> ]</p>
  <div id="M003411_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1452</span>
1452:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validation_order</span>
1453:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_presence_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:author_name</span>
1454:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validate</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">topic</span><span class="ruby-operator">|</span> <span class="ruby-identifier">topic</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span>(<span class="ruby-value str">'author_email_address'</span>, <span class="ruby-value str">'will never be valid'</span>)}
1455:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:content</span>, <span class="ruby-identifier">:minimum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">2</span>
1456: 
1457:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span> <span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">''</span>
1458:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1459:     <span class="ruby-identifier">e</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">instance_variable_get</span> <span class="ruby-value str">'@errors'</span>
1460:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'title'</span>, <span class="ruby-identifier">key</span> = <span class="ruby-identifier">e</span>.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">first</span>
1461:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;can't be blank&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">key</span>).<span class="ruby-identifier">first</span>
1462:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'is too short (minimum is 2 characters)'</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">key</span>).<span class="ruby-identifier">second</span>
1463:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'author_name'</span>, <span class="ruby-identifier">key</span> = <span class="ruby-identifier">e</span>.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">second</span>
1464:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;can't be blank&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">key</span>)
1465:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'author_email_address'</span>, <span class="ruby-identifier">key</span> = <span class="ruby-identifier">e</span>.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">third</span>
1466:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'will never be valid'</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">key</span>)
1467:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'content'</span>, <span class="ruby-identifier">key</span> = <span class="ruby-identifier">e</span>.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">fourth</span>
1468:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'is too short (minimum is 2 characters)'</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">key</span>)
1469:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003413" class="method">
  <div id="M003413_title" class="title">
    <b>test_validation_with_if_as_string</b>()
  </div>
  <div class="description">
  <p>
previous implementation of validates_presence_of eval&#8217;d the string
with the wrong binding, this regression test is to ensure that it works
correctly
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003413_source')" id="l_M003413_source">show source</a> ]</p>
  <div id="M003413_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1485</span>
1485:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validation_with_if_as_string</span>
1486:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_presence_of</span>(<span class="ruby-identifier">:title</span>)
1487:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_presence_of</span>(<span class="ruby-identifier">:author_name</span>, <span class="ruby-identifier">:if</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;title.to_s.match('important')&quot;</span>)
1488: 
1489:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>
1490:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;A topic without a title should not be valid&quot;</span>
1491:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">invalid?</span>(<span class="ruby-value str">&quot;author_name&quot;</span>), <span class="ruby-value str">&quot;A topic without an 'important' title should not require an author&quot;</span>
1492: 
1493:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;Just a title&quot;</span>
1494:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;A topic with a basic title should be valid&quot;</span>
1495: 
1496:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;A very important title&quot;</span>
1497:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;A topic with an important title, but without an author, should not be valid&quot;</span>
1498:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">invalid?</span>(<span class="ruby-value str">&quot;author_name&quot;</span>), <span class="ruby-value str">&quot;A topic with an 'important' title should require an author&quot;</span>
1499: 
1500:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">author_name</span> = <span class="ruby-value str">&quot;Hubert J. Farnsworth&quot;</span>
1501:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;A topic with an important title and author should be valid&quot;</span>
1502:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003308" class="method">
  <div id="M003308_title" class="title">
    <b>test_values_are_not_retrieved_unless_needed</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003308_source')" id="l_M003308_source">show source</a> ]</p>
  <div id="M003308_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 181</span>
181:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_values_are_not_retrieved_unless_needed</span>
182:     <span class="ruby-identifier">assert_nothing_raised</span> <span class="ruby-keyword kw">do</span>
183:       <span class="ruby-identifier">person</span> = <span class="ruby-constant">ProtectedPerson</span>.<span class="ruby-identifier">new</span>
184:       <span class="ruby-identifier">person</span>.<span class="ruby-identifier">special_error</span>
185:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;This method does not exist&quot;</span>, <span class="ruby-identifier">person</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-identifier">:special_error</span>]
186:     <span class="ruby-keyword kw">end</span>
187:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
</div>

  </div>