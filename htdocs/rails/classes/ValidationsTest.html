  <div id="C00000547">
<div class='banner'>
  <span class="file-title-prefix">Class</span><br />ValidationsTest<br/>
  In:
<a href="#" onclick="jsHref('files/activerecord/test/cases/validations_test_rb.html');">activerecord/test/cases/validations_test.rb</a>

Parent:&nbsp;
ActiveRecord::TestCase
</div>
 <!-- banner header -->

  <div id="bodyContent" >
      <div id="content">




  <div class="sectiontitle">Methods</div>
  <ul>
  <li><a href="index.html?a=M003283&name=test_create_with_exceptions_using_scope_and_empty_attributes" >test_create_with_exceptions_using_scope_and_empty_attributes</a></li>
  <li><a href="index.html?a=M003282&name=test_create_with_exceptions_using_scope_for_protected_attributes" >test_create_with_exceptions_using_scope_for_protected_attributes</a></li>
  <li><a href="index.html?a=M003287&name=test_create_without_validation" >test_create_without_validation</a></li>
  <li><a href="index.html?a=M003288&name=test_create_without_validation_bang" >test_create_without_validation_bang</a></li>
  <li><a href="index.html?a=M003274&name=test_double_attr_validation_and_error_msg" >test_double_attr_validation_and_error_msg</a></li>
  <li><a href="index.html?a=M003275&name=test_error_on_create" >test_error_on_create</a></li>
  <li><a href="index.html?a=M003276&name=test_error_on_update" >test_error_on_update</a></li>
  <li><a href="index.html?a=M003286&name=test_errors_on_base" >test_errors_on_base</a></li>
  <li><a href="index.html?a=M003385&name=test_errors_to_xml" >test_errors_to_xml</a></li>
  <li><a href="index.html?a=M003294&name=test_eula" >test_eula</a></li>
  <li><a href="index.html?a=M003278&name=test_exception_on_create_bang_many" >test_exception_on_create_bang_many</a></li>
  <li><a href="index.html?a=M003280&name=test_exception_on_create_bang_many_with_block" >test_exception_on_create_bang_many_with_block</a></li>
  <li><a href="index.html?a=M003279&name=test_exception_on_create_bang_with_block" >test_exception_on_create_bang_with_block</a></li>
  <li><a href="index.html?a=M003382&name=test_if_validation_using_block_false" >test_if_validation_using_block_false</a></li>
  <li><a href="index.html?a=M003380&name=test_if_validation_using_block_true" >test_if_validation_using_block_true</a></li>
  <li><a href="index.html?a=M003374&name=test_if_validation_using_method_false" >test_if_validation_using_method_false</a></li>
  <li><a href="index.html?a=M003372&name=test_if_validation_using_method_true" >test_if_validation_using_method_true</a></li>
  <li><a href="index.html?a=M003378&name=test_if_validation_using_string_false" >test_if_validation_using_string_false</a></li>
  <li><a href="index.html?a=M003376&name=test_if_validation_using_string_true" >test_if_validation_using_string_true</a></li>
  <li><a href="index.html?a=M003277&name=test_invalid_record_exception" >test_invalid_record_exception</a></li>
  <li><a href="index.html?a=M003387&name=test_invalid_should_be_the_opposite_of_valid" >test_invalid_should_be_the_opposite_of_valid</a></li>
  <li><a href="index.html?a=M003360&name=test_invalid_validator" >test_invalid_validator</a></li>
  <li><a href="index.html?a=M003285&name=test_multiple_errors_per_attr_iteration_with_full_error_composition" >test_multiple_errors_per_attr_iteration_with_full_error_composition</a></li>
  <li><a href="index.html?a=M003290&name=test_no_title_confirmation" >test_no_title_confirmation</a></li>
  <li><a href="index.html?a=M003323&name=test_numericality_with_allow_nil_and_getter_method" >test_numericality_with_allow_nil_and_getter_method</a></li>
  <li><a href="index.html?a=M003319&name=test_numericality_with_getter_method" >test_numericality_with_getter_method</a></li>
  <li><a href="index.html?a=M003335&name=test_optionally_validates_length_of_using_is" >test_optionally_validates_length_of_using_is</a></li>
  <li><a href="index.html?a=M003329&name=test_optionally_validates_length_of_using_maximum" >test_optionally_validates_length_of_using_maximum</a></li>
  <li><a href="index.html?a=M003327&name=test_optionally_validates_length_of_using_minimum" >test_optionally_validates_length_of_using_minimum</a></li>
  <li><a href="index.html?a=M003331&name=test_optionally_validates_length_of_using_within" >test_optionally_validates_length_of_using_within</a></li>
  <li><a href="index.html?a=M003332&name=test_optionally_validates_length_of_using_within_on_create" >test_optionally_validates_length_of_using_within_on_create</a></li>
  <li><a href="index.html?a=M003352&name=test_optionally_validates_length_of_using_within_on_create_utf8" >test_optionally_validates_length_of_using_within_on_create_utf8</a></li>
  <li><a href="index.html?a=M003333&name=test_optionally_validates_length_of_using_within_on_update" >test_optionally_validates_length_of_using_within_on_update</a></li>
  <li><a href="index.html?a=M003353&name=test_optionally_validates_length_of_using_within_on_update_utf8" >test_optionally_validates_length_of_using_within_on_update_utf8</a></li>
  <li><a href="index.html?a=M003351&name=test_optionally_validates_length_of_using_within_utf8" >test_optionally_validates_length_of_using_within_utf8</a></li>
  <li><a href="index.html?a=M003281&name=test_scoped_create_without_attributes" >test_scoped_create_without_attributes</a></li>
  <li><a href="index.html?a=M003273&name=test_single_attr_validation_and_error_msg" >test_single_attr_validation_and_error_msg</a></li>
  <li><a href="index.html?a=M003284&name=test_single_error_per_attr_iteration" >test_single_error_per_attr_iteration</a></li>
  <li><a href="index.html?a=M003272&name=test_single_field_validation" >test_single_field_validation</a></li>
  <li><a href="index.html?a=M003293&name=test_terms_of_service_agreement" >test_terms_of_service_agreement</a></li>
  <li><a href="index.html?a=M003292&name=test_terms_of_service_agreement_no_acceptance" >test_terms_of_service_agreement_no_acceptance</a></li>
  <li><a href="index.html?a=M003295&name=test_terms_of_service_agreement_with_accept_value" >test_terms_of_service_agreement_with_accept_value</a></li>
  <li><a href="index.html?a=M003361&name=test_throw_away_typing" >test_throw_away_typing</a></li>
  <li><a href="index.html?a=M003291&name=test_title_confirmation" >test_title_confirmation</a></li>
  <li><a href="index.html?a=M003383&name=test_unless_validation_using_block_false" >test_unless_validation_using_block_false</a></li>
  <li><a href="index.html?a=M003381&name=test_unless_validation_using_block_true" >test_unless_validation_using_block_true</a></li>
  <li><a href="index.html?a=M003375&name=test_unless_validation_using_method_false" >test_unless_validation_using_method_false</a></li>
  <li><a href="index.html?a=M003373&name=test_unless_validation_using_method_true" >test_unless_validation_using_method_true</a></li>
  <li><a href="index.html?a=M003379&name=test_unless_validation_using_string_false" >test_unless_validation_using_string_false</a></li>
  <li><a href="index.html?a=M003377&name=test_unless_validation_using_string_true" >test_unless_validation_using_string_true</a></li>
  <li><a href="index.html?a=M003359&name=test_validate_block" >test_validate_block</a></li>
  <li><a href="index.html?a=M003304&name=test_validate_case_insensitive_uniqueness" >test_validate_case_insensitive_uniqueness</a></li>
  <li><a href="index.html?a=M003305&name=test_validate_case_sensitive_uniqueness" >test_validate_case_sensitive_uniqueness</a></li>
  <li><a href="index.html?a=M003306&name=test_validate_case_sensitive_uniqueness_with_attribute_passed_as_integer" >test_validate_case_sensitive_uniqueness_with_attribute_passed_as_integer</a></li>
  <li><a href="index.html?a=M003313&name=test_validate_format" >test_validate_format</a></li>
  <li><a href="index.html?a=M003315&name=test_validate_format_numeric" >test_validate_format_numeric</a></li>
  <li><a href="index.html?a=M003314&name=test_validate_format_with_allow_blank" >test_validate_format_with_allow_blank</a></li>
  <li><a href="index.html?a=M003316&name=test_validate_format_with_formatted_message" >test_validate_format_with_formatted_message</a></li>
  <li><a href="index.html?a=M003298&name=test_validate_presences" >test_validate_presences</a></li>
  <li><a href="index.html?a=M003312&name=test_validate_straight_inheritance_uniqueness" >test_validate_straight_inheritance_uniqueness</a></li>
  <li><a href="index.html?a=M003299&name=test_validate_uniqueness" >test_validate_uniqueness</a></li>
  <li><a href="index.html?a=M003302&name=test_validate_uniqueness_scoped_to_defining_class" >test_validate_uniqueness_scoped_to_defining_class</a></li>
  <li><a href="index.html?a=M003309&name=test_validate_uniqueness_with_columns_which_are_sql_keywords" >test_validate_uniqueness_with_columns_which_are_sql_keywords</a></li>
  <li><a href="index.html?a=M003310&name=test_validate_uniqueness_with_limit" >test_validate_uniqueness_with_limit</a></li>
  <li><a href="index.html?a=M003311&name=test_validate_uniqueness_with_limit_and_utf8" >test_validate_uniqueness_with_limit_and_utf8</a></li>
  <li><a href="index.html?a=M003307&name=test_validate_uniqueness_with_non_standard_table_names" >test_validate_uniqueness_with_non_standard_table_names</a></li>
  <li><a href="index.html?a=M003301&name=test_validate_uniqueness_with_scope" >test_validate_uniqueness_with_scope</a></li>
  <li><a href="index.html?a=M003303&name=test_validate_uniqueness_with_scope_array" >test_validate_uniqueness_with_scope_array</a></li>
  <li><a href="index.html?a=M003296&name=test_validates_acceptance_of_as_database_column" >test_validates_acceptance_of_as_database_column</a></li>
  <li><a href="index.html?a=M003362&name=test_validates_acceptance_of_with_custom_error_using_quotes" >test_validates_acceptance_of_with_custom_error_using_quotes</a></li>
  <li><a href="index.html?a=M003297&name=test_validates_acceptance_of_with_non_existant_table" >test_validates_acceptance_of_with_non_existant_table</a></li>
  <li><a href="index.html?a=M003357&name=test_validates_associated_many" >test_validates_associated_many</a></li>
  <li><a href="index.html?a=M003384&name=test_validates_associated_missing" >test_validates_associated_missing</a></li>
  <li><a href="index.html?a=M003358&name=test_validates_associated_one" >test_validates_associated_one</a></li>
  <li><a href="index.html?a=M003371&name=test_validates_associated_with_custom_message_using_quotes" >test_validates_associated_with_custom_message_using_quotes</a></li>
  <li><a href="index.html?a=M003363&name=test_validates_confirmation_of_with_custom_error_using_quotes" >test_validates_confirmation_of_with_custom_error_using_quotes</a></li>
  <li><a href="index.html?a=M003289&name=test_validates_each" >test_validates_each</a></li>
  <li><a href="index.html?a=M003324&name=test_validates_exclusion_of" >test_validates_exclusion_of</a></li>
  <li><a href="index.html?a=M003325&name=test_validates_exclusion_of_with_formatted_message" >test_validates_exclusion_of_with_formatted_message</a></li>
  <li><a href="index.html?a=M003364&name=test_validates_format_of_with_custom_error_using_quotes" >test_validates_format_of_with_custom_error_using_quotes</a></li>
  <li><a href="index.html?a=M003317&name=test_validates_inclusion_of" >test_validates_inclusion_of</a></li>
  <li><a href="index.html?a=M003318&name=test_validates_inclusion_of_with_allow_nil" >test_validates_inclusion_of_with_allow_nil</a></li>
  <li><a href="index.html?a=M003365&name=test_validates_inclusion_of_with_custom_error_using_quotes" >test_validates_inclusion_of_with_custom_error_using_quotes</a></li>
  <li><a href="index.html?a=M003322&name=test_validates_inclusion_of_with_formatted_message" >test_validates_inclusion_of_with_formatted_message</a></li>
  <li><a href="index.html?a=M003344&name=test_validates_length_of_custom_errors_for_in" >test_validates_length_of_custom_errors_for_in</a></li>
  <li><a href="index.html?a=M003346&name=test_validates_length_of_custom_errors_for_is_with_message" >test_validates_length_of_custom_errors_for_is_with_message</a></li>
  <li><a href="index.html?a=M003347&name=test_validates_length_of_custom_errors_for_is_with_wrong_length" >test_validates_length_of_custom_errors_for_is_with_wrong_length</a></li>
  <li><a href="index.html?a=M003343&name=test_validates_length_of_custom_errors_for_maximum_with_message" >test_validates_length_of_custom_errors_for_maximum_with_message</a></li>
  <li><a href="index.html?a=M003345&name=test_validates_length_of_custom_errors_for_maximum_with_too_long" >test_validates_length_of_custom_errors_for_maximum_with_too_long</a></li>
  <li><a href="index.html?a=M003341&name=test_validates_length_of_custom_errors_for_minimum_with_message" >test_validates_length_of_custom_errors_for_minimum_with_message</a></li>
  <li><a href="index.html?a=M003342&name=test_validates_length_of_custom_errors_for_minimum_with_too_short" >test_validates_length_of_custom_errors_for_minimum_with_too_short</a></li>
  <li><a href="index.html?a=M003340&name=test_validates_length_of_nasty_params" >test_validates_length_of_nasty_params</a></li>
  <li><a href="index.html?a=M003336&name=test_validates_length_of_using_bignum" >test_validates_length_of_using_bignum</a></li>
  <li><a href="index.html?a=M003334&name=test_validates_length_of_using_is" >test_validates_length_of_using_is</a></li>
  <li><a href="index.html?a=M003354&name=test_validates_length_of_using_is_utf8" >test_validates_length_of_using_is_utf8</a></li>
  <li><a href="index.html?a=M003328&name=test_validates_length_of_using_maximum" >test_validates_length_of_using_maximum</a></li>
  <li><a href="index.html?a=M003349&name=test_validates_length_of_using_maximum_utf8" >test_validates_length_of_using_maximum_utf8</a></li>
  <li><a href="index.html?a=M003326&name=test_validates_length_of_using_minimum" >test_validates_length_of_using_minimum</a></li>
  <li><a href="index.html?a=M003348&name=test_validates_length_of_using_minimum_utf8" >test_validates_length_of_using_minimum_utf8</a></li>
  <li><a href="index.html?a=M003330&name=test_validates_length_of_using_within" >test_validates_length_of_using_within</a></li>
  <li><a href="index.html?a=M003350&name=test_validates_length_of_using_within_utf8" >test_validates_length_of_using_within_utf8</a></li>
  <li><a href="index.html?a=M003321&name=test_validates_length_of_with_allow_blank" >test_validates_length_of_with_allow_blank</a></li>
  <li><a href="index.html?a=M003320&name=test_validates_length_of_with_allow_nil" >test_validates_length_of_with_allow_nil</a></li>
  <li><a href="index.html?a=M003355&name=test_validates_length_of_with_block" >test_validates_length_of_with_block</a></li>
  <li><a href="index.html?a=M003368&name=test_validates_length_of_with_custom_message_using_quotes" >test_validates_length_of_with_custom_message_using_quotes</a></li>
  <li><a href="index.html?a=M003366&name=test_validates_length_of_with_custom_too_long_using_quotes" >test_validates_length_of_with_custom_too_long_using_quotes</a></li>
  <li><a href="index.html?a=M003367&name=test_validates_length_of_with_custom_too_short_using_quotes" >test_validates_length_of_with_custom_too_short_using_quotes</a></li>
  <li><a href="index.html?a=M003337&name=test_validates_length_with_globally_modified_error_message" >test_validates_length_with_globally_modified_error_message</a></li>
  <li><a href="index.html?a=M003369&name=test_validates_presence_of_with_custom_message_using_quotes" >test_validates_presence_of_with_custom_message_using_quotes</a></li>
  <li><a href="index.html?a=M003338&name=test_validates_size_of_association" >test_validates_size_of_association</a></li>
  <li><a href="index.html?a=M003339&name=test_validates_size_of_association_using_within" >test_validates_size_of_association_using_within</a></li>
  <li><a href="index.html?a=M003356&name=test_validates_size_of_association_utf8" >test_validates_size_of_association_utf8</a></li>
  <li><a href="index.html?a=M003308&name=test_validates_uniqueness_inside_with_scope" >test_validates_uniqueness_inside_with_scope</a></li>
  <li><a href="index.html?a=M003370&name=test_validates_uniqueness_of_with_custom_message_using_quotes" >test_validates_uniqueness_of_with_custom_message_using_quotes</a></li>
  <li><a href="index.html?a=M003300&name=test_validates_uniquness_with_newline_chars" >test_validates_uniquness_with_newline_chars</a></li>
  <li><a href="index.html?a=M003386&name=test_validation_order" >test_validation_order</a></li>
  <li><a href="index.html?a=M003388&name=test_validation_with_if_as_string" >test_validation_with_if_as_string</a></li>
  </ul>






<div class="sectiontitle">Public Instance methods</div>
<div id="M003283" class="method">
  <div id="M003283_title" class="title">
    <b>test_create_with_exceptions_using_scope_and_empty_attributes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003283_source')" id="l_M003283_source">show source</a> ]</p>
  <div id="M003283_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 166</span>
166:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_create_with_exceptions_using_scope_and_empty_attributes</span>
167:     <span class="ruby-identifier">assert_nothing_raised</span> <span class="ruby-keyword kw">do</span>
168:       <span class="ruby-constant">ProtectedPerson</span>.<span class="ruby-identifier">with_scope</span>( <span class="ruby-identifier">:create</span> =<span class="ruby-operator">&gt;</span> { <span class="ruby-identifier">:first_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Mary&quot;</span> } ) <span class="ruby-keyword kw">do</span>
169:         <span class="ruby-identifier">person</span> = <span class="ruby-constant">ProtectedPerson</span>.<span class="ruby-identifier">create!</span>
170:         <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">person</span>.<span class="ruby-identifier">first_name</span>, <span class="ruby-value str">&quot;Mary&quot;</span>, <span class="ruby-value str">&quot;should be ok when no attributes are passed to create!&quot;</span>
171:       <span class="ruby-keyword kw">end</span>
172:     <span class="ruby-keyword kw">end</span>
173:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003282" class="method">
  <div id="M003282_title" class="title">
    <b>test_create_with_exceptions_using_scope_for_protected_attributes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003282_source')" id="l_M003282_source">show source</a> ]</p>
  <div id="M003282_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 157</span>
157:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_create_with_exceptions_using_scope_for_protected_attributes</span>
158:     <span class="ruby-identifier">assert_nothing_raised</span> <span class="ruby-keyword kw">do</span>
159:       <span class="ruby-constant">ProtectedPerson</span>.<span class="ruby-identifier">with_scope</span>( <span class="ruby-identifier">:create</span> =<span class="ruby-operator">&gt;</span> { <span class="ruby-identifier">:first_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Mary&quot;</span> } ) <span class="ruby-keyword kw">do</span>
160:         <span class="ruby-identifier">person</span> = <span class="ruby-constant">ProtectedPerson</span>.<span class="ruby-identifier">create!</span> <span class="ruby-identifier">:addon</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Addon&quot;</span>
161:         <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">person</span>.<span class="ruby-identifier">first_name</span>, <span class="ruby-value str">&quot;Mary&quot;</span>, <span class="ruby-value str">&quot;scope should ignore attr_protected&quot;</span>
162:       <span class="ruby-keyword kw">end</span>
163:     <span class="ruby-keyword kw">end</span>
164:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003287" class="method">
  <div id="M003287_title" class="title">
    <b>test_create_without_validation</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003287_source')" id="l_M003287_source">show source</a> ]</p>
  <div id="M003287_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 216</span>
216:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_create_without_validation</span>
217:     <span class="ruby-identifier">reply</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span>
218:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">reply</span>.<span class="ruby-identifier">save</span>
219:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">reply</span>.<span class="ruby-identifier">save</span>(<span class="ruby-keyword kw">false</span>)
220:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003288" class="method">
  <div id="M003288_title" class="title">
    <b>test_create_without_validation_bang</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003288_source')" id="l_M003288_source">show source</a> ]</p>
  <div id="M003288_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 222</span>
222:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_create_without_validation_bang</span>
223:     <span class="ruby-identifier">count</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">count</span>
224:     <span class="ruby-identifier">assert_nothing_raised</span> { <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">save_without_validation!</span> }
225:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">count</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>, <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">count</span>
226:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003274" class="method">
  <div id="M003274_title" class="title">
    <b>test_double_attr_validation_and_error_msg</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003274_source')" id="l_M003274_source">show source</a> ]</p>
  <div id="M003274_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 82</span>
82:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_double_attr_validation_and_error_msg</span>
83:     <span class="ruby-identifier">r</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span>
84:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">r</span>.<span class="ruby-identifier">valid?</span>
85: 
86:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">invalid?</span>(<span class="ruby-value str">&quot;title&quot;</span>), <span class="ruby-value str">&quot;A reply without title should mark that attribute as invalid&quot;</span>
87:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;Empty&quot;</span>, <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-value str">&quot;title&quot;</span>), <span class="ruby-value str">&quot;A reply without title should contain an error&quot;</span>
88: 
89:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">invalid?</span>(<span class="ruby-value str">&quot;content&quot;</span>), <span class="ruby-value str">&quot;A reply without content should mark that attribute as invalid&quot;</span>
90:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;Empty&quot;</span>, <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-value str">&quot;content&quot;</span>), <span class="ruby-value str">&quot;A reply without content should contain an error&quot;</span>
91: 
92:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">count</span>
93:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003275" class="method">
  <div id="M003275_title" class="title">
    <b>test_error_on_create</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003275_source')" id="l_M003275_source">show source</a> ]</p>
  <div id="M003275_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 95</span>
 95:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_error_on_create</span>
 96:     <span class="ruby-identifier">r</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span>
 97:     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;Wrong Create&quot;</span>
 98:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">r</span>.<span class="ruby-identifier">valid?</span>
 99:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">invalid?</span>(<span class="ruby-value str">&quot;title&quot;</span>), <span class="ruby-value str">&quot;A reply with a bad title should mark that attribute as invalid&quot;</span>
100:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is Wrong Create&quot;</span>, <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-value str">&quot;title&quot;</span>), <span class="ruby-value str">&quot;A reply with a bad content should contain an error&quot;</span>
101:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003276" class="method">
  <div id="M003276_title" class="title">
    <b>test_error_on_update</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003276_source')" id="l_M003276_source">show source</a> ]</p>
  <div id="M003276_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 103</span>
103:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_error_on_update</span>
104:     <span class="ruby-identifier">r</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span>
105:     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;Bad&quot;</span>
106:     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">content</span> = <span class="ruby-value str">&quot;Good&quot;</span>
107:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;First save should be successful&quot;</span>
108: 
109:     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;Wrong Update&quot;</span>
110:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">r</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Second save should fail&quot;</span>
111: 
112:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">invalid?</span>(<span class="ruby-value str">&quot;title&quot;</span>), <span class="ruby-value str">&quot;A reply with a bad title should mark that attribute as invalid&quot;</span>
113:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is Wrong Update&quot;</span>, <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-value str">&quot;title&quot;</span>), <span class="ruby-value str">&quot;A reply with a bad content should contain an error&quot;</span>
114:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003286" class="method">
  <div id="M003286_title" class="title">
    <b>test_errors_on_base</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003286_source')" id="l_M003286_source">show source</a> ]</p>
  <div id="M003286_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 200</span>
200:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_errors_on_base</span>
201:     <span class="ruby-identifier">r</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span>
202:     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">content</span> = <span class="ruby-value str">&quot;Mismatch&quot;</span>
203:     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">save</span>
204:     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add_to_base</span> <span class="ruby-value str">&quot;Reply is not dignifying&quot;</span>
205: 
206:     <span class="ruby-identifier">errors</span> = []
207:     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">each_full</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">error</span><span class="ruby-operator">|</span> <span class="ruby-identifier">errors</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">error</span> }
208: 
209:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;Reply is not dignifying&quot;</span>, <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on_base</span>
210: 
211:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">errors</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-value str">&quot;Title Empty&quot;</span>)
212:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">errors</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-value str">&quot;Reply is not dignifying&quot;</span>)
213:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">count</span>
214:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003385" class="method">
  <div id="M003385_title" class="title">
    <b>test_errors_to_xml</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003385_source')" id="l_M003385_source">show source</a> ]</p>
  <div id="M003385_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1425</span>
1425:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_errors_to_xml</span>
1426:     <span class="ruby-identifier">r</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span> <span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Wrong Create&quot;</span>
1427:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">r</span>.<span class="ruby-identifier">valid?</span>
1428:     <span class="ruby-identifier">xml</span> = <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">to_xml</span>(<span class="ruby-identifier">:skip_instruct</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>)
1429:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;&lt;errors&gt;&quot;</span>, <span class="ruby-identifier">xml</span>.<span class="ruby-identifier">first</span>(<span class="ruby-value">8</span>)
1430:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">xml</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-value str">&quot;&lt;error&gt;Title is Wrong Create&lt;/error&gt;&quot;</span>)
1431:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">xml</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-value str">&quot;&lt;error&gt;Content Empty&lt;/error&gt;&quot;</span>)
1432:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003294" class="method">
  <div id="M003294_title" class="title">
    <b>test_eula</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003294_source')" id="l_M003294_source">show source</a> ]</p>
  <div id="M003294_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 287</span>
287:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_eula</span>
288:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_acceptance_of</span>(<span class="ruby-identifier">:eula</span>, <span class="ruby-identifier">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;must be abided&quot;</span>, <span class="ruby-identifier">:on</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:create</span>)
289: 
290:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;We should be confirmed&quot;</span>,<span class="ruby-value str">&quot;eula&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;&quot;</span>)
291:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
292:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;must be abided&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:eula</span>)
293: 
294:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">eula</span> = <span class="ruby-value str">&quot;1&quot;</span>
295:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
296:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003278" class="method">
  <div id="M003278_title" class="title">
    <b>test_exception_on_create_bang_many</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003278_source')" id="l_M003278_source">show source</a> ]</p>
  <div id="M003278_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 129</span>
129:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_exception_on_create_bang_many</span>
130:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">RecordInvalid</span>) <span class="ruby-keyword kw">do</span>
131:       <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">create!</span>([ { <span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;OK&quot;</span> }, { <span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Wrong Create&quot;</span> }])
132:     <span class="ruby-keyword kw">end</span>
133:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003280" class="method">
  <div id="M003280_title" class="title">
    <b>test_exception_on_create_bang_many_with_block</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003280_source')" id="l_M003280_source">show source</a> ]</p>
  <div id="M003280_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 143</span>
143:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_exception_on_create_bang_many_with_block</span>
144:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">RecordInvalid</span>) <span class="ruby-keyword kw">do</span>
145:       <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">create!</span>([{ <span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;OK&quot;</span> }, { <span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Wrong Create&quot;</span> }]) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span>
146:         <span class="ruby-identifier">r</span>.<span class="ruby-identifier">content</span> = <span class="ruby-keyword kw">nil</span>
147:       <span class="ruby-keyword kw">end</span>
148:     <span class="ruby-keyword kw">end</span>
149:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003279" class="method">
  <div id="M003279_title" class="title">
    <b>test_exception_on_create_bang_with_block</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003279_source')" id="l_M003279_source">show source</a> ]</p>
  <div id="M003279_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 135</span>
135:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_exception_on_create_bang_with_block</span>
136:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">RecordInvalid</span>) <span class="ruby-keyword kw">do</span>
137:       <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">create!</span>({ <span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;OK&quot;</span> }) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span>
138:         <span class="ruby-identifier">r</span>.<span class="ruby-identifier">content</span> = <span class="ruby-keyword kw">nil</span>
139:       <span class="ruby-keyword kw">end</span>
140:     <span class="ruby-keyword kw">end</span>
141:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003382" class="method">
  <div id="M003382_title" class="title">
    <b>test_if_validation_using_block_false</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003382_source')" id="l_M003382_source">show source</a> ]</p>
  <div id="M003382_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1394</span>
1394:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_if_validation_using_block_false</span>
1395:     <span class="ruby-comment cmt"># When the block returns false</span>
1396:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:too_long=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;hoo {{count}}&quot;</span>,
1397:       <span class="ruby-identifier">:if</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">title</span> <span class="ruby-operator">!=</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>} )
1398:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1399:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1400:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1401:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003380" class="method">
  <div id="M003380_title" class="title">
    <b>test_if_validation_using_block_true</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003380_source')" id="l_M003380_source">show source</a> ]</p>
  <div id="M003380_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1375</span>
1375:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_if_validation_using_block_true</span>
1376:     <span class="ruby-comment cmt"># When the block returns true</span>
1377:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:too_long=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;hoo {{count}}&quot;</span>,
1378:       <span class="ruby-identifier">:if</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">content</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">4</span> } )
1379:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1380:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1381:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1382:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;hoo 5&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
1383:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003374" class="method">
  <div id="M003374_title" class="title">
    <b>test_if_validation_using_method_false</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003374_source')" id="l_M003374_source">show source</a> ]</p>
  <div id="M003374_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1324</span>
1324:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_if_validation_using_method_false</span>
1325:     <span class="ruby-comment cmt"># When the method returns false</span>
1326:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:too_long=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;hoo {{count}}&quot;</span>, <span class="ruby-identifier">:if</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:condition_is_true_but_its_not</span> )
1327:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1328:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1329:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1330:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003372" class="method">
  <div id="M003372_title" class="title">
    <b>test_if_validation_using_method_true</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003372_source')" id="l_M003372_source">show source</a> ]</p>
  <div id="M003372_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1307</span>
1307:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_if_validation_using_method_true</span>
1308:     <span class="ruby-comment cmt"># When the method returns true</span>
1309:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:too_long=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;hoo {{count}}&quot;</span>, <span class="ruby-identifier">:if</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:condition_is_true</span> )
1310:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1311:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1312:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1313:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;hoo 5&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
1314:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003378" class="method">
  <div id="M003378_title" class="title">
    <b>test_if_validation_using_string_false</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003378_source')" id="l_M003378_source">show source</a> ]</p>
  <div id="M003378_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1358</span>
1358:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_if_validation_using_string_false</span>
1359:     <span class="ruby-comment cmt"># When the evaluated string returns false</span>
1360:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:too_long=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;hoo {{count}}&quot;</span>, <span class="ruby-identifier">:if</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;false&quot;</span>)
1361:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1362:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1363:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1364:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003376" class="method">
  <div id="M003376_title" class="title">
    <b>test_if_validation_using_string_true</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003376_source')" id="l_M003376_source">show source</a> ]</p>
  <div id="M003376_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1341</span>
1341:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_if_validation_using_string_true</span>
1342:     <span class="ruby-comment cmt"># When the evaluated string returns true</span>
1343:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:too_long=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;hoo {{count}}&quot;</span>, <span class="ruby-identifier">:if</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;a = 1; a == 1&quot;</span> )
1344:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1345:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1346:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1347:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;hoo 5&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
1348:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003277" class="method">
  <div id="M003277_title" class="title">
    <b>test_invalid_record_exception</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003277_source')" id="l_M003277_source">show source</a> ]</p>
  <div id="M003277_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 116</span>
116:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_invalid_record_exception</span>
117:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">RecordInvalid</span>) { <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">create!</span> }
118:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">RecordInvalid</span>) { <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">save!</span> }
119: 
120:     <span class="ruby-keyword kw">begin</span>
121:       <span class="ruby-identifier">r</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span>
122:       <span class="ruby-identifier">r</span>.<span class="ruby-identifier">save!</span>
123:       <span class="ruby-identifier">flunk</span>
124:     <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">RecordInvalid</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">invalid</span>
125:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">r</span>, <span class="ruby-identifier">invalid</span>.<span class="ruby-identifier">record</span>
126:     <span class="ruby-keyword kw">end</span>
127:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003387" class="method">
  <div id="M003387_title" class="title">
    <b>test_invalid_should_be_the_opposite_of_valid</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003387_source')" id="l_M003387_source">show source</a> ]</p>
  <div id="M003387_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1443</span>
1443:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_invalid_should_be_the_opposite_of_valid</span>
1444:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_presence_of</span> <span class="ruby-identifier">:title</span>
1445: 
1446:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>
1447:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">invalid?</span>
1448:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">invalid?</span>(<span class="ruby-identifier">:title</span>)
1449: 
1450:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">'Things are going to change'</span>
1451:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">invalid?</span>
1452:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003360" class="method">
  <div id="M003360_title" class="title">
    <b>test_invalid_validator</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003360_source')" id="l_M003360_source">show source</a> ]</p>
  <div id="M003360_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1193</span>
1193:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_invalid_validator</span>
1194:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validate</span> <span class="ruby-value">3</span>
1195:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ArgumentError</span>) { <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span> }
1196:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003285" class="method">
  <div id="M003285_title" class="title">
    <b>test_multiple_errors_per_attr_iteration_with_full_error_composition</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003285_source')" id="l_M003285_source">show source</a> ]</p>
  <div id="M003285_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 186</span>
186:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_multiple_errors_per_attr_iteration_with_full_error_composition</span>
187:     <span class="ruby-identifier">r</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span>
188:     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">title</span>   = <span class="ruby-value str">&quot;Wrong Create&quot;</span>
189:     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">content</span> = <span class="ruby-value str">&quot;Mismatch&quot;</span>
190:     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">save</span>
191: 
192:     <span class="ruby-identifier">errors</span> = []
193:     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">each_full</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">error</span><span class="ruby-operator">|</span> <span class="ruby-identifier">errors</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">error</span> }
194: 
195:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;Title is Wrong Create&quot;</span>, <span class="ruby-identifier">errors</span>[<span class="ruby-value">0</span>]
196:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;Title is Content Mismatch&quot;</span>, <span class="ruby-identifier">errors</span>[<span class="ruby-value">1</span>]
197:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">count</span>
198:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003290" class="method">
  <div id="M003290_title" class="title">
    <b>test_no_title_confirmation</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003290_source')" id="l_M003290_source">show source</a> ]</p>
  <div id="M003290_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 241</span>
241:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_no_title_confirmation</span>
242:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_confirmation_of</span>(<span class="ruby-identifier">:title</span>)
243: 
244:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">:author_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Plutarch&quot;</span>)
245:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
246: 
247:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title_confirmation</span> = <span class="ruby-value str">&quot;Parallel Lives&quot;</span>
248:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
249: 
250:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title_confirmation</span> = <span class="ruby-keyword kw">nil</span>
251:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;Parallel Lives&quot;</span>
252:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
253: 
254:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title_confirmation</span> = <span class="ruby-value str">&quot;Parallel Lives&quot;</span>
255:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
256:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003323" class="method">
  <div id="M003323_title" class="title">
    <b>test_numericality_with_allow_nil_and_getter_method</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003323_source')" id="l_M003323_source">show source</a> ]</p>
  <div id="M003323_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 708</span>
708:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_numericality_with_allow_nil_and_getter_method</span>
709:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Developer</span>) <span class="ruby-keyword kw">do</span>
710:       <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">validates_numericality_of</span>( <span class="ruby-identifier">:salary</span>, <span class="ruby-identifier">:allow_nil</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>)
711:       <span class="ruby-identifier">developer</span> = <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;michael&quot;</span>, <span class="ruby-value str">&quot;salary&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>)
712:       <span class="ruby-identifier">developer</span>.<span class="ruby-identifier">instance_eval</span>(<span class="ruby-value str">&quot;def salary; read_attribute('salary') ? read_attribute('salary') : 100000; end&quot;</span>)
713:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">developer</span>.<span class="ruby-identifier">valid?</span>
714:     <span class="ruby-keyword kw">end</span>
715:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003319" class="method">
  <div id="M003319_title" class="title">
    <b>test_numericality_with_getter_method</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003319_source')" id="l_M003319_source">show source</a> ]</p>
  <div id="M003319_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 670</span>
670:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_numericality_with_getter_method</span>
671:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Developer</span>) <span class="ruby-keyword kw">do</span>
672:       <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">validates_numericality_of</span>( <span class="ruby-identifier">:salary</span> )
673:       <span class="ruby-identifier">developer</span> = <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;michael&quot;</span>, <span class="ruby-value str">&quot;salary&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>)
674:       <span class="ruby-identifier">developer</span>.<span class="ruby-identifier">instance_eval</span>(<span class="ruby-value str">&quot;def salary; read_attribute('salary') ? read_attribute('salary') : 100000; end&quot;</span>)
675:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">developer</span>.<span class="ruby-identifier">valid?</span>
676:     <span class="ruby-keyword kw">end</span>
677:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003335" class="method">
  <div id="M003335_title" class="title">
    <b>test_optionally_validates_length_of_using_is</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003335_source')" id="l_M003335_source">show source</a> ]</p>
  <div id="M003335_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 884</span>
884:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_optionally_validates_length_of_using_is</span>
885:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:is</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span>, <span class="ruby-identifier">:allow_nil</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>
886: 
887:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;valid&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
888:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
889: 
890:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-keyword kw">nil</span>
891:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
892:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003329" class="method">
  <div id="M003329_title" class="title">
    <b>test_optionally_validates_length_of_using_maximum</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003329_source')" id="l_M003329_source">show source</a> ]</p>
  <div id="M003329_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 785</span>
785:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_optionally_validates_length_of_using_maximum</span>
786:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span>, <span class="ruby-identifier">:allow_nil</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>
787: 
788:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;valid&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
789:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
790: 
791:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-keyword kw">nil</span>
792:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
793:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003327" class="method">
  <div id="M003327_title" class="title">
    <b>test_optionally_validates_length_of_using_minimum</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003327_source')" id="l_M003327_source">show source</a> ]</p>
  <div id="M003327_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 757</span>
757:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_optionally_validates_length_of_using_minimum</span>
758:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:minimum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span>, <span class="ruby-identifier">:allow_nil</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>
759: 
760:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;valid&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
761:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
762: 
763:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-keyword kw">nil</span>
764:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
765:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003331" class="method">
  <div id="M003331_title" class="title">
    <b>test_optionally_validates_length_of_using_within</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003331_source')" id="l_M003331_source">show source</a> ]</p>
  <div id="M003331_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 814</span>
814:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_optionally_validates_length_of_using_within</span>
815:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:content</span>, <span class="ruby-identifier">:within</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">3</span><span class="ruby-operator">..</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:allow_nil</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>
816: 
817:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">'title'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'abc'</span>, <span class="ruby-value str">'content'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'abcd'</span>)
818:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
819: 
820:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-keyword kw">nil</span>
821:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
822:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003332" class="method">
  <div id="M003332_title" class="title">
    <b>test_optionally_validates_length_of_using_within_on_create</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003332_source')" id="l_M003332_source">show source</a> ]</p>
  <div id="M003332_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 824</span>
824:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_optionally_validates_length_of_using_within_on_create</span>
825:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:content</span>, <span class="ruby-identifier">:within</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span><span class="ruby-operator">..</span><span class="ruby-value">10</span>, <span class="ruby-identifier">:on</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:create</span>, <span class="ruby-identifier">:too_long</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;my string is too long: {{count}}&quot;</span>
826: 
827:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;thisisnotvalid&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
828:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
829:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
830:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;my string is too long: 10&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-identifier">:title</span>]
831: 
832:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;butthisis&quot;</span>
833:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
834: 
835:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;few&quot;</span>
836:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
837: 
838:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">content</span> = <span class="ruby-value str">&quot;andthisislong&quot;</span>
839:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
840: 
841:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">content</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;iamfine&quot;</span>
842:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
843:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003352" class="method">
  <div id="M003352_title" class="title">
    <b>test_optionally_validates_length_of_using_within_on_create_utf8</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003352_source')" id="l_M003352_source">show source</a> ]</p>
  <div id="M003352_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1074</span>
1074:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_optionally_validates_length_of_using_within_on_create_utf8</span>
1075:     <span class="ruby-identifier">with_kcode</span>(<span class="ruby-value str">'UTF8'</span>) <span class="ruby-keyword kw">do</span>
1076:       <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:within</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span><span class="ruby-operator">..</span><span class="ruby-value">10</span>, <span class="ruby-identifier">:on</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:create</span>, <span class="ruby-identifier">:too_long</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;: {{count}}&quot;</span>
1077: 
1078:       <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;A&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1079:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
1080:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1081:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;: 10&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-identifier">:title</span>]
1082: 
1083:       <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;&quot;</span>
1084:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
1085: 
1086:       <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;3&quot;</span>
1087:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
1088: 
1089:       <span class="ruby-identifier">t</span>.<span class="ruby-identifier">content</span> = <span class="ruby-value str">&quot;&quot;</span>
1090:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
1091: 
1092:       <span class="ruby-identifier">t</span>.<span class="ruby-identifier">content</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;&quot;</span>
1093:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
1094:     <span class="ruby-keyword kw">end</span>
1095:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003333" class="method">
  <div id="M003333_title" class="title">
    <b>test_optionally_validates_length_of_using_within_on_update</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003333_source')" id="l_M003333_source">show source</a> ]</p>
  <div id="M003333_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 845</span>
845:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_optionally_validates_length_of_using_within_on_update</span>
846:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:content</span>, <span class="ruby-identifier">:within</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span><span class="ruby-operator">..</span><span class="ruby-value">10</span>, <span class="ruby-identifier">:on</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:update</span>, <span class="ruby-identifier">:too_short</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;my string is too short: {{count}}&quot;</span>
847: 
848:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;vali&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
849:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
850:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
851: 
852:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;not&quot;</span>
853:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
854:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
855:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;my string is too short: 5&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-identifier">:title</span>]
856: 
857:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;valid&quot;</span>
858:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">content</span> = <span class="ruby-value str">&quot;andthisistoolong&quot;</span>
859:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
860:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:content</span>)
861: 
862:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">content</span> = <span class="ruby-value str">&quot;iamfine&quot;</span>
863:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
864:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003353" class="method">
  <div id="M003353_title" class="title">
    <b>test_optionally_validates_length_of_using_within_on_update_utf8</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003353_source')" id="l_M003353_source">show source</a> ]</p>
  <div id="M003353_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1097</span>
1097:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_optionally_validates_length_of_using_within_on_update_utf8</span>
1098:     <span class="ruby-identifier">with_kcode</span>(<span class="ruby-value str">'UTF8'</span>) <span class="ruby-keyword kw">do</span>
1099:       <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:within</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span><span class="ruby-operator">..</span><span class="ruby-value">10</span>, <span class="ruby-identifier">:on</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:update</span>, <span class="ruby-identifier">:too_short</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;: {{count}}&quot;</span>
1100: 
1101:       <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;4&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1102:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
1103:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1104: 
1105:       <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;14&quot;</span>
1106:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
1107:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1108:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;: 5&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-identifier">:title</span>]
1109: 
1110:       <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;A&quot;</span>
1111:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
1112:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1113: 
1114:       <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;345&quot;</span>
1115:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
1116:     <span class="ruby-keyword kw">end</span>
1117:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003351" class="method">
  <div id="M003351_title" class="title">
    <b>test_optionally_validates_length_of_using_within_utf8</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003351_source')" id="l_M003351_source">show source</a> ]</p>
  <div id="M003351_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1059</span>
1059:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_optionally_validates_length_of_using_within_utf8</span>
1060:     <span class="ruby-identifier">with_kcode</span>(<span class="ruby-value str">'UTF8'</span>) <span class="ruby-keyword kw">do</span>
1061:       <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:within</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">3</span><span class="ruby-operator">..</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:allow_nil</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>
1062: 
1063:       <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;&quot;</span>)
1064:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">inspect</span>
1065: 
1066:       <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;&quot;</span>)
1067:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">inspect</span>
1068: 
1069:       <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-keyword kw">nil</span>
1070:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">inspect</span>
1071:     <span class="ruby-keyword kw">end</span>
1072:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003281" class="method">
  <div id="M003281_title" class="title">
    <b>test_scoped_create_without_attributes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003281_source')" id="l_M003281_source">show source</a> ]</p>
  <div id="M003281_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 151</span>
151:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_scoped_create_without_attributes</span>
152:     <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">with_scope</span>(<span class="ruby-identifier">:create</span> =<span class="ruby-operator">&gt;</span> {}) <span class="ruby-keyword kw">do</span>
153:       <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">RecordInvalid</span>) { <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">create!</span> }
154:     <span class="ruby-keyword kw">end</span>
155:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003273" class="method">
  <div id="M003273_title" class="title">
    <b>test_single_attr_validation_and_error_msg</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003273_source')" id="l_M003273_source">show source</a> ]</p>
  <div id="M003273_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 73</span>
73:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_single_attr_validation_and_error_msg</span>
74:     <span class="ruby-identifier">r</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span>
75:     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;There's no content!&quot;</span>
76:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">r</span>.<span class="ruby-identifier">valid?</span>
77:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">invalid?</span>(<span class="ruby-value str">&quot;content&quot;</span>), <span class="ruby-value str">&quot;A reply without content should mark that attribute as invalid&quot;</span>
78:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;Empty&quot;</span>, <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-value str">&quot;content&quot;</span>), <span class="ruby-value str">&quot;A reply without content should contain an error&quot;</span>
79:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">count</span>
80:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003284" class="method">
  <div id="M003284_title" class="title">
    <b>test_single_error_per_attr_iteration</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003284_source')" id="l_M003284_source">show source</a> ]</p>
  <div id="M003284_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 175</span>
175:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_single_error_per_attr_iteration</span>
176:     <span class="ruby-identifier">r</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span>
177:     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">save</span>
178: 
179:     <span class="ruby-identifier">errors</span> = []
180:     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">attr</span>, <span class="ruby-identifier">msg</span><span class="ruby-operator">|</span> <span class="ruby-identifier">errors</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-identifier">attr</span>, <span class="ruby-identifier">msg</span>] }
181: 
182:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">errors</span>.<span class="ruby-identifier">include?</span>([<span class="ruby-value str">&quot;title&quot;</span>, <span class="ruby-value str">&quot;Empty&quot;</span>])
183:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">errors</span>.<span class="ruby-identifier">include?</span>([<span class="ruby-value str">&quot;content&quot;</span>, <span class="ruby-value str">&quot;Empty&quot;</span>])
184:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003272" class="method">
  <div id="M003272_title" class="title">
    <b>test_single_field_validation</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003272_source')" id="l_M003272_source">show source</a> ]</p>
  <div id="M003272_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 64</span>
64:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_single_field_validation</span>
65:     <span class="ruby-identifier">r</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span>
66:     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;There's no content!&quot;</span>
67:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">r</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;A reply without content shouldn't be saveable&quot;</span>
68: 
69:     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">content</span> = <span class="ruby-value str">&quot;Messa content!&quot;</span>
70:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;A reply with content should be saveable&quot;</span>
71:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003293" class="method">
  <div id="M003293_title" class="title">
    <b>test_terms_of_service_agreement</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003293_source')" id="l_M003293_source">show source</a> ]</p>
  <div id="M003293_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 275</span>
275:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_terms_of_service_agreement</span>
276:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_acceptance_of</span>(<span class="ruby-identifier">:terms_of_service</span>, <span class="ruby-identifier">:on</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:create</span>)
277: 
278:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;We should be confirmed&quot;</span>,<span class="ruby-value str">&quot;terms_of_service&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;&quot;</span>)
279:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
280:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;must be accepted&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:terms_of_service</span>)
281: 
282:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">terms_of_service</span> = <span class="ruby-value str">&quot;1&quot;</span>
283:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
284:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003292" class="method">
  <div id="M003292_title" class="title">
    <b>test_terms_of_service_agreement_no_acceptance</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003292_source')" id="l_M003292_source">show source</a> ]</p>
  <div id="M003292_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 268</span>
268:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_terms_of_service_agreement_no_acceptance</span>
269:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_acceptance_of</span>(<span class="ruby-identifier">:terms_of_service</span>, <span class="ruby-identifier">:on</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:create</span>)
270: 
271:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;We should not be confirmed&quot;</span>)
272:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
273:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003295" class="method">
  <div id="M003295_title" class="title">
    <b>test_terms_of_service_agreement_with_accept_value</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003295_source')" id="l_M003295_source">show source</a> ]</p>
  <div id="M003295_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 298</span>
298:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_terms_of_service_agreement_with_accept_value</span>
299:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_acceptance_of</span>(<span class="ruby-identifier">:terms_of_service</span>, <span class="ruby-identifier">:on</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:create</span>, <span class="ruby-identifier">:accept</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;I agree.&quot;</span>)
300: 
301:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;We should be confirmed&quot;</span>, <span class="ruby-value str">&quot;terms_of_service&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;&quot;</span>)
302:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
303:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;must be accepted&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:terms_of_service</span>)
304: 
305:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">terms_of_service</span> = <span class="ruby-value str">&quot;I agree.&quot;</span>
306:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
307:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003361" class="method">
  <div id="M003361_title" class="title">
    <b>test_throw_away_typing</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003361_source')" id="l_M003361_source">show source</a> ]</p>
  <div id="M003361_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1198</span>
1198:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_throw_away_typing</span>
1199:     <span class="ruby-identifier">d</span> = <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;David&quot;</span>, <span class="ruby-value str">&quot;salary&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;100,000&quot;</span>)
1200:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">d</span>.<span class="ruby-identifier">valid?</span>
1201:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">100</span>, <span class="ruby-identifier">d</span>.<span class="ruby-identifier">salary</span>
1202:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;100,000&quot;</span>, <span class="ruby-identifier">d</span>.<span class="ruby-identifier">salary_before_type_cast</span>
1203:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003291" class="method">
  <div id="M003291_title" class="title">
    <b>test_title_confirmation</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003291_source')" id="l_M003291_source">show source</a> ]</p>
  <div id="M003291_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 258</span>
258:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_title_confirmation</span>
259:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_confirmation_of</span>(<span class="ruby-identifier">:title</span>)
260: 
261:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;We should be confirmed&quot;</span>,<span class="ruby-value str">&quot;title_confirmation&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;&quot;</span>)
262:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
263: 
264:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title_confirmation</span> = <span class="ruby-value str">&quot;We should be confirmed&quot;</span>
265:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
266:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003383" class="method">
  <div id="M003383_title" class="title">
    <b>test_unless_validation_using_block_false</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003383_source')" id="l_M003383_source">show source</a> ]</p>
  <div id="M003383_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1403</span>
1403:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_unless_validation_using_block_false</span>
1404:     <span class="ruby-comment cmt"># When the block returns false</span>
1405:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:too_long=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;hoo {{count}}&quot;</span>,
1406:       <span class="ruby-identifier">:unless</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">title</span> <span class="ruby-operator">!=</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>} )
1407:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1408:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1409:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1410:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;hoo 5&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
1411:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003381" class="method">
  <div id="M003381_title" class="title">
    <b>test_unless_validation_using_block_true</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003381_source')" id="l_M003381_source">show source</a> ]</p>
  <div id="M003381_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1385</span>
1385:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_unless_validation_using_block_true</span>
1386:     <span class="ruby-comment cmt"># When the block returns true</span>
1387:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:too_long=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;hoo {{count}}&quot;</span>,
1388:       <span class="ruby-identifier">:unless</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">content</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">4</span> } )
1389:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1390:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1391:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1392:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003375" class="method">
  <div id="M003375_title" class="title">
    <b>test_unless_validation_using_method_false</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003375_source')" id="l_M003375_source">show source</a> ]</p>
  <div id="M003375_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1332</span>
1332:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_unless_validation_using_method_false</span>
1333:     <span class="ruby-comment cmt"># When the method returns false</span>
1334:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:too_long=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;hoo {{count}}&quot;</span>, <span class="ruby-identifier">:unless</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:condition_is_true_but_its_not</span> )
1335:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1336:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1337:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1338:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;hoo 5&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
1339:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003373" class="method">
  <div id="M003373_title" class="title">
    <b>test_unless_validation_using_method_true</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003373_source')" id="l_M003373_source">show source</a> ]</p>
  <div id="M003373_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1316</span>
1316:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_unless_validation_using_method_true</span>
1317:     <span class="ruby-comment cmt"># When the method returns true</span>
1318:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:too_long=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;hoo {{count}}&quot;</span>, <span class="ruby-identifier">:unless</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:condition_is_true</span> )
1319:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1320:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1321:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1322:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003379" class="method">
  <div id="M003379_title" class="title">
    <b>test_unless_validation_using_string_false</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003379_source')" id="l_M003379_source">show source</a> ]</p>
  <div id="M003379_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1366</span>
1366:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_unless_validation_using_string_false</span>
1367:     <span class="ruby-comment cmt"># When the evaluated string returns false</span>
1368:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:too_long=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;hoo {{count}}&quot;</span>, <span class="ruby-identifier">:unless</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;false&quot;</span>)
1369:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1370:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1371:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1372:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;hoo 5&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
1373:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003377" class="method">
  <div id="M003377_title" class="title">
    <b>test_unless_validation_using_string_true</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003377_source')" id="l_M003377_source">show source</a> ]</p>
  <div id="M003377_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1350</span>
1350:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_unless_validation_using_string_true</span>
1351:     <span class="ruby-comment cmt"># When the evaluated string returns true</span>
1352:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:too_long=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;hoo {{count}}&quot;</span>, <span class="ruby-identifier">:unless</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;a = 1; a == 1&quot;</span> )
1353:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1354:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1355:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1356:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003359" class="method">
  <div id="M003359_title" class="title">
    <b>test_validate_block</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003359_source')" id="l_M003359_source">show source</a> ]</p>
  <div id="M003359_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1185</span>
1185:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_block</span>
1186:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validate</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">topic</span><span class="ruby-operator">|</span> <span class="ruby-identifier">topic</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span>(<span class="ruby-value str">&quot;title&quot;</span>, <span class="ruby-value str">&quot;will never be valid&quot;</span>) }
1187:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Title&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1188:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1189:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1190:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;will never be valid&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
1191:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003304" class="method">
  <div id="M003304_title" class="title">
    <b>test_validate_case_insensitive_uniqueness</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003304_source')" id="l_M003304_source">show source</a> ]</p>
  <div id="M003304_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 432</span>
432:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_case_insensitive_uniqueness</span>
433:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_uniqueness_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:parent_id</span>, <span class="ruby-identifier">:case_sensitive</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">false</span>, <span class="ruby-identifier">:allow_nil</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>)
434: 
435:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;I'm unique!&quot;</span>, <span class="ruby-identifier">:parent_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">2</span>)
436:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Should save t as unique&quot;</span>
437: 
438:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">content</span> = <span class="ruby-value str">&quot;Remaining unique&quot;</span>
439:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Should still save t as unique&quot;</span>
440: 
441:     <span class="ruby-identifier">t2</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;I'm UNIQUE!&quot;</span>, <span class="ruby-identifier">:parent_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>)
442:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Shouldn't be valid&quot;</span>
443:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Shouldn't save t2 as unique&quot;</span>
444:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
445:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:parent_id</span>)
446:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;has already been taken&quot;</span>, <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
447: 
448:     <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;I'm truly UNIQUE!&quot;</span>
449:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Shouldn't be valid&quot;</span>
450:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Shouldn't save t2 as unique&quot;</span>
451:     <span class="ruby-identifier">assert_nil</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
452:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:parent_id</span>)
453: 
454:     <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">parent_id</span> = <span class="ruby-value">4</span>
455:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Should now save t2 as unique&quot;</span>
456: 
457:     <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">parent_id</span> = <span class="ruby-keyword kw">nil</span>
458:     <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">title</span> = <span class="ruby-keyword kw">nil</span>
459:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;should validate with nil&quot;</span>
460:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;should save with nil&quot;</span>
461: 
462:     <span class="ruby-identifier">with_kcode</span>(<span class="ruby-value str">'UTF8'</span>) <span class="ruby-keyword kw">do</span>
463:       <span class="ruby-identifier">t_utf8</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;  !&quot;</span>)
464:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t_utf8</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Should save t_utf8 as unique&quot;</span>
465: 
466:       <span class="ruby-comment cmt"># If database hasn't UTF-8 character set, this test fails</span>
467:       <span class="ruby-keyword kw">if</span> <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">t_utf8</span>, <span class="ruby-identifier">:select</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'LOWER(title) AS title'</span>).<span class="ruby-identifier">title</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;  !&quot;</span>
468:         <span class="ruby-identifier">t2_utf8</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;  !&quot;</span>)
469:         <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2_utf8</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Shouldn't be valid&quot;</span>
470:         <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2_utf8</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Shouldn't save t2_utf8 as unique&quot;</span>
471:       <span class="ruby-keyword kw">end</span>
472:     <span class="ruby-keyword kw">end</span>
473:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003305" class="method">
  <div id="M003305_title" class="title">
    <b>test_validate_case_sensitive_uniqueness</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003305_source')" id="l_M003305_source">show source</a> ]</p>
  <div id="M003305_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 475</span>
475:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_case_sensitive_uniqueness</span>
476:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_uniqueness_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:case_sensitive</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>, <span class="ruby-identifier">:allow_nil</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>)
477: 
478:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;I'm unique!&quot;</span>)
479:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Should save t as unique&quot;</span>
480: 
481:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">content</span> = <span class="ruby-value str">&quot;Remaining unique&quot;</span>
482:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Should still save t as unique&quot;</span>
483: 
484:     <span class="ruby-identifier">t2</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;I'M UNIQUE!&quot;</span>)
485:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Should be valid&quot;</span>
486:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Should save t2 as unique&quot;</span>
487:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
488:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:parent_id</span>)
489:     <span class="ruby-identifier">assert_not_equal</span> <span class="ruby-value str">&quot;has already been taken&quot;</span>, <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
490: 
491:     <span class="ruby-identifier">t3</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;I'M uNiQUe!&quot;</span>)
492:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t3</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Should be valid&quot;</span>
493:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t3</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Should save t2 as unique&quot;</span>
494:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t3</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
495:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t3</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:parent_id</span>)
496:     <span class="ruby-identifier">assert_not_equal</span> <span class="ruby-value str">&quot;has already been taken&quot;</span>, <span class="ruby-identifier">t3</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
497:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003306" class="method">
  <div id="M003306_title" class="title">
    <b>test_validate_case_sensitive_uniqueness_with_attribute_passed_as_integer</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003306_source')" id="l_M003306_source">show source</a> ]</p>
  <div id="M003306_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 499</span>
499:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_case_sensitive_uniqueness_with_attribute_passed_as_integer</span>
500:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_uniqueness_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:case_sensitve</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>)
501:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-value str">'title'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">101</span>)
502: 
503:     <span class="ruby-identifier">t2</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">'title'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">101</span>)
504:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2</span>.<span class="ruby-identifier">valid?</span>
505:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
506:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003313" class="method">
  <div id="M003313_title" class="title">
    <b>test_validate_format</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003313_source')" id="l_M003313_source">show source</a> ]</p>
  <div id="M003313_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 581</span>
581:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_format</span>
582:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_format_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:content</span>, <span class="ruby-identifier">:with</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-regexp re">/^Validation\smacros \w+!$/</span>, <span class="ruby-identifier">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;is bad data&quot;</span>)
583: 
584:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;i'm incorrect&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Validation macros rule!&quot;</span>)
585:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Shouldn't be valid&quot;</span>
586:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Shouldn't save because it's invalid&quot;</span>
587:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is bad data&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
588:     <span class="ruby-identifier">assert_nil</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:content</span>)
589: 
590:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;Validation macros rule!&quot;</span>
591: 
592:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
593:     <span class="ruby-identifier">assert_nil</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
594: 
595:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ArgumentError</span>) { <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_format_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:content</span>) }
596:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003315" class="method">
  <div id="M003315_title" class="title">
    <b>test_validate_format_numeric</b>()
  </div>
  <div class="description">
  <p>
testing ticket 3142
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003315_source')" id="l_M003315_source">show source</a> ]</p>
  <div id="M003315_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 607</span>
607:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_format_numeric</span>
608:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_format_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:content</span>, <span class="ruby-identifier">:with</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-regexp re">/^[1-9][0-9]*$/</span>, <span class="ruby-identifier">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;is bad data&quot;</span>)
609: 
610:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;72x&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;6789&quot;</span>)
611:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Shouldn't be valid&quot;</span>
612:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Shouldn't save because it's invalid&quot;</span>
613:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is bad data&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
614:     <span class="ruby-identifier">assert_nil</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:content</span>)
615: 
616:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;-11&quot;</span>
617:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Shouldn't be valid&quot;</span>
618: 
619:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;03&quot;</span>
620:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Shouldn't be valid&quot;</span>
621: 
622:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;z44&quot;</span>
623:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Shouldn't be valid&quot;</span>
624: 
625:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;5v7&quot;</span>
626:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Shouldn't be valid&quot;</span>
627: 
628:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;1&quot;</span>
629: 
630:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
631:     <span class="ruby-identifier">assert_nil</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
632:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003314" class="method">
  <div id="M003314_title" class="title">
    <b>test_validate_format_with_allow_blank</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003314_source')" id="l_M003314_source">show source</a> ]</p>
  <div id="M003314_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 598</span>
598:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_format_with_allow_blank</span>
599:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_format_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:with</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-regexp re">/^Validation\smacros \w+!$/</span>, <span class="ruby-identifier">:allow_blank=</span><span class="ruby-operator">&gt;</span><span class="ruby-keyword kw">true</span>)
600:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Shouldn't be valid&quot;</span>).<span class="ruby-identifier">valid?</span>
601:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;&quot;</span>).<span class="ruby-identifier">valid?</span>
602:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>).<span class="ruby-identifier">valid?</span>
603:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Validation macros rule!&quot;</span>).<span class="ruby-identifier">valid?</span>
604:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003316" class="method">
  <div id="M003316_title" class="title">
    <b>test_validate_format_with_formatted_message</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003316_source')" id="l_M003316_source">show source</a> ]</p>
  <div id="M003316_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 634</span>
634:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_format_with_formatted_message</span>
635:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_format_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:with</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-regexp re">/^Valid Title$/</span>, <span class="ruby-identifier">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;can't be {{value}}&quot;</span>)
636:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'Invalid title'</span>)
637:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;can't be Invalid title&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
638:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003298" class="method">
  <div id="M003298_title" class="title">
    <b>test_validate_presences</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003298_source')" id="l_M003298_source">show source</a> ]</p>
  <div id="M003298_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 326</span>
326:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_presences</span>
327:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_presence_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:content</span>)
328: 
329:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>
330:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
331:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;can't be blank&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
332:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;can't be blank&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:content</span>)
333: 
334:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;something&quot;</span>
335:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">content</span>  = <span class="ruby-value str">&quot;   &quot;</span>
336: 
337:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
338:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;can't be blank&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:content</span>)
339: 
340:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">content</span> = <span class="ruby-value str">&quot;like stuff&quot;</span>
341: 
342:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
343:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003312" class="method">
  <div id="M003312_title" class="title">
    <b>test_validate_straight_inheritance_uniqueness</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003312_source')" id="l_M003312_source">show source</a> ]</p>
  <div id="M003312_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 552</span>
552:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_straight_inheritance_uniqueness</span>
553:     <span class="ruby-identifier">w1</span> = <span class="ruby-constant">IneptWizard</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Rincewind&quot;</span>, <span class="ruby-identifier">:city</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Ankh-Morpork&quot;</span>)
554:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">w1</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Saving w1&quot;</span>
555: 
556:     <span class="ruby-comment cmt"># Should use validation from base class (which is abstract)</span>
557:     <span class="ruby-identifier">w2</span> = <span class="ruby-constant">IneptWizard</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Rincewind&quot;</span>, <span class="ruby-identifier">:city</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Quirm&quot;</span>)
558:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">w2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;w2 shouldn't be valid&quot;</span>
559:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">w2</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:name</span>), <span class="ruby-value str">&quot;Should have errors for name&quot;</span>
560:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;has already been taken&quot;</span>, <span class="ruby-identifier">w2</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:name</span>), <span class="ruby-value str">&quot;Should have uniqueness message for name&quot;</span>
561: 
562:     <span class="ruby-identifier">w3</span> = <span class="ruby-constant">Conjurer</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Rincewind&quot;</span>, <span class="ruby-identifier">:city</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Quirm&quot;</span>)
563:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">w3</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;w3 shouldn't be valid&quot;</span>
564:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">w3</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:name</span>), <span class="ruby-value str">&quot;Should have errors for name&quot;</span>
565:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;has already been taken&quot;</span>, <span class="ruby-identifier">w3</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:name</span>), <span class="ruby-value str">&quot;Should have uniqueness message for name&quot;</span>
566: 
567:     <span class="ruby-identifier">w4</span> = <span class="ruby-constant">Conjurer</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;The Amazing Bonko&quot;</span>, <span class="ruby-identifier">:city</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Quirm&quot;</span>)
568:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">w4</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Saving w4&quot;</span>
569: 
570:     <span class="ruby-identifier">w5</span> = <span class="ruby-constant">Thaumaturgist</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;The Amazing Bonko&quot;</span>, <span class="ruby-identifier">:city</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Lancre&quot;</span>)
571:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">w5</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;w5 shouldn't be valid&quot;</span>
572:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">w5</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:name</span>), <span class="ruby-value str">&quot;Should have errors for name&quot;</span>
573:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;has already been taken&quot;</span>, <span class="ruby-identifier">w5</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:name</span>), <span class="ruby-value str">&quot;Should have uniqueness message for name&quot;</span>
574: 
575:     <span class="ruby-identifier">w6</span> = <span class="ruby-constant">Thaumaturgist</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Mustrum Ridcully&quot;</span>, <span class="ruby-identifier">:city</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Quirm&quot;</span>)
576:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">w6</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;w6 shouldn't be valid&quot;</span>
577:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">w6</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:city</span>), <span class="ruby-value str">&quot;Should have errors for city&quot;</span>
578:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;has already been taken&quot;</span>, <span class="ruby-identifier">w6</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:city</span>), <span class="ruby-value str">&quot;Should have uniqueness message for city&quot;</span>
579:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003299" class="method">
  <div id="M003299_title" class="title">
    <b>test_validate_uniqueness</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003299_source')" id="l_M003299_source">show source</a> ]</p>
  <div id="M003299_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 345</span>
345:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_uniqueness</span>
346:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_uniqueness_of</span>(<span class="ruby-identifier">:title</span>)
347: 
348:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;I'm uniqu!&quot;</span>)
349:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Should save t as unique&quot;</span>
350: 
351:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">content</span> = <span class="ruby-value str">&quot;Remaining unique&quot;</span>
352:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Should still save t as unique&quot;</span>
353: 
354:     <span class="ruby-identifier">t2</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;I'm uniqu!&quot;</span>)
355:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Shouldn't be valid&quot;</span>
356:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Shouldn't save t2 as unique&quot;</span>
357:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;has already been taken&quot;</span>, <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
358: 
359:     <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;Now Im really also unique&quot;</span>
360:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Should now save t2 as unique&quot;</span>
361:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003302" class="method">
  <div id="M003302_title" class="title">
    <b>test_validate_uniqueness_scoped_to_defining_class</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003302_source')" id="l_M003302_source">show source</a> ]</p>
  <div id="M003302_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 391</span>
391:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_uniqueness_scoped_to_defining_class</span>
392:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;What, me worry?&quot;</span>)
393: 
394:     <span class="ruby-identifier">r1</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">unique_replies</span>.<span class="ruby-identifier">create</span> <span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;r1&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;a barrel of fun&quot;</span>
395:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r1</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Saving r1&quot;</span>
396: 
397:     <span class="ruby-identifier">r2</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">silly_unique_replies</span>.<span class="ruby-identifier">create</span> <span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;r2&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;a barrel of fun&quot;</span>
398:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">r2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Saving r2&quot;</span>
399: 
400:     <span class="ruby-comment cmt"># Should succeed as validates_uniqueness_of only applies to</span>
401:     <span class="ruby-comment cmt"># UniqueReply and its subclasses</span>
402:     <span class="ruby-identifier">r3</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">create</span> <span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;r2&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;a barrel of fun&quot;</span>
403:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r3</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Saving r3&quot;</span>
404:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003309" class="method">
  <div id="M003309_title" class="title">
    <b>test_validate_uniqueness_with_columns_which_are_sql_keywords</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003309_source')" id="l_M003309_source">show source</a> ]</p>
  <div id="M003309_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 525</span>
525:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_uniqueness_with_columns_which_are_sql_keywords</span>
526:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Guid</span>) <span class="ruby-keyword kw">do</span>
527:       <span class="ruby-constant">Guid</span>.<span class="ruby-identifier">validates_uniqueness_of</span> <span class="ruby-identifier">:key</span>
528:       <span class="ruby-identifier">g</span> = <span class="ruby-constant">Guid</span>.<span class="ruby-identifier">new</span>
529:       <span class="ruby-identifier">g</span>.<span class="ruby-identifier">key</span> = <span class="ruby-value str">&quot;foo&quot;</span>
530:       <span class="ruby-identifier">assert_nothing_raised</span> { <span class="ruby-operator">!</span><span class="ruby-identifier">g</span>.<span class="ruby-identifier">valid?</span> }
531:     <span class="ruby-keyword kw">end</span>
532:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003310" class="method">
  <div id="M003310_title" class="title">
    <b>test_validate_uniqueness_with_limit</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003310_source')" id="l_M003310_source">show source</a> ]</p>
  <div id="M003310_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 534</span>
534:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_uniqueness_with_limit</span>
535:     <span class="ruby-comment cmt"># Event.title is limited to 5 characters</span>
536:     <span class="ruby-identifier">e1</span> = <span class="ruby-constant">Event</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;abcde&quot;</span>)
537:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">e1</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Could not create an event with a unique, 5 character title&quot;</span>
538:     <span class="ruby-identifier">e2</span> = <span class="ruby-constant">Event</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;abcdefgh&quot;</span>)
539:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">e2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Created an event whose title, with limit taken into account, is not unique&quot;</span>
540:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003311" class="method">
  <div id="M003311_title" class="title">
    <b>test_validate_uniqueness_with_limit_and_utf8</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003311_source')" id="l_M003311_source">show source</a> ]</p>
  <div id="M003311_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 542</span>
542:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_uniqueness_with_limit_and_utf8</span>
543:     <span class="ruby-identifier">with_kcode</span>(<span class="ruby-value str">'UTF8'</span>) <span class="ruby-keyword kw">do</span>
544:       <span class="ruby-comment cmt"># Event.title is limited to 5 characters</span>
545:       <span class="ruby-identifier">e1</span> = <span class="ruby-constant">Event</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;&quot;</span>)
546:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">e1</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Could not create an event with a unique, 5 character title&quot;</span>
547:       <span class="ruby-identifier">e2</span> = <span class="ruby-constant">Event</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;&quot;</span>)
548:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">e2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Created an event whose title, with limit taken into account, is not unique&quot;</span>
549:     <span class="ruby-keyword kw">end</span>
550:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003307" class="method">
  <div id="M003307_title" class="title">
    <b>test_validate_uniqueness_with_non_standard_table_names</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003307_source')" id="l_M003307_source">show source</a> ]</p>
  <div id="M003307_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 508</span>
508:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_uniqueness_with_non_standard_table_names</span>
509:     <span class="ruby-identifier">i1</span> = <span class="ruby-constant">WarehouseThing</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:value</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1000</span>)
510:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">i1</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;i1 should not be valid&quot;</span>
511:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">i1</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:value</span>), <span class="ruby-value str">&quot;Should not be empty&quot;</span>
512:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003301" class="method">
  <div id="M003301_title" class="title">
    <b>test_validate_uniqueness_with_scope</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003301_source')" id="l_M003301_source">show source</a> ]</p>
  <div id="M003301_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 370</span>
370:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_uniqueness_with_scope</span>
371:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Reply</span>) <span class="ruby-keyword kw">do</span>
372:       <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">validates_uniqueness_of</span>(<span class="ruby-identifier">:content</span>, <span class="ruby-identifier">:scope</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;parent_id&quot;</span>)
373: 
374:       <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;I'm unique!&quot;</span>)
375: 
376:       <span class="ruby-identifier">r1</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">create</span> <span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;r1&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;hello world&quot;</span>
377:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r1</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Saving r1&quot;</span>
378: 
379:       <span class="ruby-identifier">r2</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">create</span> <span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;r2&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;hello world&quot;</span>
380:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">r2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Saving r2 first time&quot;</span>
381: 
382:       <span class="ruby-identifier">r2</span>.<span class="ruby-identifier">content</span> = <span class="ruby-value str">&quot;something else&quot;</span>
383:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r2</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Saving r2 second time&quot;</span>
384: 
385:       <span class="ruby-identifier">t2</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;I'm unique too!&quot;</span>)
386:       <span class="ruby-identifier">r3</span> = <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">create</span> <span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;r3&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;hello world&quot;</span>
387:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r3</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Saving r3&quot;</span>
388:     <span class="ruby-keyword kw">end</span>
389:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003303" class="method">
  <div id="M003303_title" class="title">
    <b>test_validate_uniqueness_with_scope_array</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003303_source')" id="l_M003303_source">show source</a> ]</p>
  <div id="M003303_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 406</span>
406:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_uniqueness_with_scope_array</span>
407:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Reply</span>) <span class="ruby-keyword kw">do</span>
408:       <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">validates_uniqueness_of</span>(<span class="ruby-identifier">:author_name</span>, <span class="ruby-identifier">:scope</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-identifier">:author_email_address</span>, <span class="ruby-identifier">:parent_id</span>])
409: 
410:       <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;The earth is actually flat!&quot;</span>)
411: 
412:       <span class="ruby-identifier">r1</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">create</span> <span class="ruby-value str">&quot;author_name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;jeremy&quot;</span>, <span class="ruby-value str">&quot;author_email_address&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;jeremy@rubyonrails.com&quot;</span>, <span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;You're crazy!&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Crazy reply&quot;</span>
413:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r1</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Saving r1&quot;</span>
414: 
415:       <span class="ruby-identifier">r2</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">create</span> <span class="ruby-value str">&quot;author_name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;jeremy&quot;</span>, <span class="ruby-value str">&quot;author_email_address&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;jeremy@rubyonrails.com&quot;</span>, <span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;You're crazy!&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Crazy reply again...&quot;</span>
416:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">r2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Saving r2. Double reply by same author.&quot;</span>
417: 
418:       <span class="ruby-identifier">r2</span>.<span class="ruby-identifier">author_email_address</span> = <span class="ruby-value str">&quot;jeremy_alt_email@rubyonrails.com&quot;</span>
419:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r2</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Saving r2 the second time.&quot;</span>
420: 
421:       <span class="ruby-identifier">r3</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">create</span> <span class="ruby-value str">&quot;author_name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;jeremy&quot;</span>, <span class="ruby-value str">&quot;author_email_address&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;jeremy_alt_email@rubyonrails.com&quot;</span>, <span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;You're wrong&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;It's cubic&quot;</span>
422:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">r3</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;Saving r3&quot;</span>
423: 
424:       <span class="ruby-identifier">r3</span>.<span class="ruby-identifier">author_name</span> = <span class="ruby-value str">&quot;jj&quot;</span>
425:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r3</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Saving r3 the second time.&quot;</span>
426: 
427:       <span class="ruby-identifier">r3</span>.<span class="ruby-identifier">author_name</span> = <span class="ruby-value str">&quot;jeremy&quot;</span>
428:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">r3</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Saving r3 the third time.&quot;</span>
429:     <span class="ruby-keyword kw">end</span>
430:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003296" class="method">
  <div id="M003296_title" class="title">
    <b>test_validates_acceptance_of_as_database_column</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003296_source')" id="l_M003296_source">show source</a> ]</p>
  <div id="M003296_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 309</span>
309:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_acceptance_of_as_database_column</span>
310:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Reply</span>) <span class="ruby-keyword kw">do</span>
311:       <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">validates_acceptance_of</span>(<span class="ruby-identifier">:author_name</span>)
312: 
313:       <span class="ruby-identifier">reply</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;author_name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Dan Brown&quot;</span>)
314:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;Dan Brown&quot;</span>, <span class="ruby-identifier">reply</span>[<span class="ruby-value str">&quot;author_name&quot;</span>]
315:     <span class="ruby-keyword kw">end</span>
316:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003362" class="method">
  <div id="M003362_title" class="title">
    <b>test_validates_acceptance_of_with_custom_error_using_quotes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003362_source')" id="l_M003362_source">show source</a> ]</p>
  <div id="M003362_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1205</span>
1205:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_acceptance_of_with_custom_error_using_quotes</span>
1206:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Developer</span>) <span class="ruby-keyword kw">do</span>
1207:       <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">validates_acceptance_of</span> <span class="ruby-identifier">:salary</span>, <span class="ruby-identifier">:message=</span><span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;This string contains 'single' and \&quot;double\&quot; quotes&quot;</span>
1208:       <span class="ruby-identifier">d</span> = <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">new</span>
1209:       <span class="ruby-identifier">d</span>.<span class="ruby-identifier">salary</span> = <span class="ruby-value str">&quot;0&quot;</span>
1210:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">d</span>.<span class="ruby-identifier">valid?</span>
1211:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;This string contains 'single' and \&quot;double\&quot; quotes&quot;</span>, <span class="ruby-identifier">d</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:salary</span>).<span class="ruby-identifier">last</span>
1212:     <span class="ruby-keyword kw">end</span>
1213:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003297" class="method">
  <div id="M003297_title" class="title">
    <b>test_validates_acceptance_of_with_non_existant_table</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003297_source')" id="l_M003297_source">show source</a> ]</p>
  <div id="M003297_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 318</span>
318:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_acceptance_of_with_non_existant_table</span>
319:     <span class="ruby-constant">Object</span>.<span class="ruby-identifier">const_set</span> <span class="ruby-identifier">:IncorporealModel</span>, <span class="ruby-constant">Class</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>)
320: 
321:     <span class="ruby-identifier">assert_nothing_raised</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">StatementInvalid</span> <span class="ruby-keyword kw">do</span>
322:       <span class="ruby-constant">IncorporealModel</span>.<span class="ruby-identifier">validates_acceptance_of</span>(<span class="ruby-identifier">:incorporeal_column</span>)
323:     <span class="ruby-keyword kw">end</span>
324:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003357" class="method">
  <div id="M003357_title" class="title">
    <b>test_validates_associated_many</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003357_source')" id="l_M003357_source">show source</a> ]</p>
  <div id="M003357_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1158</span>
1158:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_associated_many</span>
1159:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_associated</span>( <span class="ruby-identifier">:replies</span> )
1160:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1161:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">replies</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-identifier">r</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;A reply&quot;</span>), <span class="ruby-identifier">r2</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Another reply&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;non-empty&quot;</span>), <span class="ruby-identifier">r3</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Yet another reply&quot;</span>), <span class="ruby-identifier">r4</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;The last reply&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;non-empty&quot;</span>)]
1162:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1163:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:replies</span>)
1164:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">count</span>  <span class="ruby-comment cmt"># make sure all associated objects have been validated</span>
1165:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-identifier">r2</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">count</span>
1166:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">r3</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">count</span>
1167:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-identifier">r4</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">count</span>
1168:     <span class="ruby-identifier">r</span>.<span class="ruby-identifier">content</span> = <span class="ruby-identifier">r3</span>.<span class="ruby-identifier">content</span> = <span class="ruby-value str">&quot;non-empty&quot;</span>
1169:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1170:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003384" class="method">
  <div id="M003384_title" class="title">
    <b>test_validates_associated_missing</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003384_source')" id="l_M003384_source">show source</a> ]</p>
  <div id="M003384_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1413</span>
1413:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_associated_missing</span>
1414:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Reply</span>) <span class="ruby-keyword kw">do</span>
1415:       <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">validates_presence_of</span>(<span class="ruby-identifier">:topic</span>)
1416:       <span class="ruby-identifier">r</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;A reply&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;with content!&quot;</span>)
1417:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">r</span>.<span class="ruby-identifier">valid?</span>
1418:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:topic</span>)
1419: 
1420:       <span class="ruby-identifier">r</span>.<span class="ruby-identifier">topic</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span> <span class="ruby-identifier">:first</span>
1421:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">valid?</span>
1422:     <span class="ruby-keyword kw">end</span>
1423:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003358" class="method">
  <div id="M003358_title" class="title">
    <b>test_validates_associated_one</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003358_source')" id="l_M003358_source">show source</a> ]</p>
  <div id="M003358_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1172</span>
1172:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_associated_one</span>
1173:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Reply</span>) <span class="ruby-keyword kw">do</span>
1174:       <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">validates_associated</span>( <span class="ruby-identifier">:topic</span> )
1175:       <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_presence_of</span>( <span class="ruby-identifier">:content</span> )
1176:       <span class="ruby-identifier">r</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;A reply&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;with content!&quot;</span>)
1177:       <span class="ruby-identifier">r</span>.<span class="ruby-identifier">topic</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>)
1178:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">r</span>.<span class="ruby-identifier">valid?</span>
1179:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:topic</span>)
1180:       <span class="ruby-identifier">r</span>.<span class="ruby-identifier">topic</span>.<span class="ruby-identifier">content</span> = <span class="ruby-value str">&quot;non-empty&quot;</span>
1181:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">valid?</span>
1182:     <span class="ruby-keyword kw">end</span>
1183:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003371" class="method">
  <div id="M003371_title" class="title">
    <b>test_validates_associated_with_custom_message_using_quotes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003371_source')" id="l_M003371_source">show source</a> ]</p>
  <div id="M003371_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1296</span>
1296:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_associated_with_custom_message_using_quotes</span>
1297:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Reply</span>) <span class="ruby-keyword kw">do</span>
1298:       <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">validates_associated</span> <span class="ruby-identifier">:topic</span>, <span class="ruby-identifier">:message=</span><span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;This string contains 'single' and \&quot;double\&quot; quotes&quot;</span>
1299:       <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_presence_of</span> <span class="ruby-identifier">:content</span>
1300:       <span class="ruby-identifier">r</span> = <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;A reply&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;with content!&quot;</span>)
1301:       <span class="ruby-identifier">r</span>.<span class="ruby-identifier">topic</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>)
1302:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">r</span>.<span class="ruby-identifier">valid?</span>
1303:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;This string contains 'single' and \&quot;double\&quot; quotes&quot;</span>, <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:topic</span>)
1304:     <span class="ruby-keyword kw">end</span>
1305:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003363" class="method">
  <div id="M003363_title" class="title">
    <b>test_validates_confirmation_of_with_custom_error_using_quotes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003363_source')" id="l_M003363_source">show source</a> ]</p>
  <div id="M003363_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1215</span>
1215:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_confirmation_of_with_custom_error_using_quotes</span>
1216:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Developer</span>) <span class="ruby-keyword kw">do</span>
1217:       <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">validates_confirmation_of</span> <span class="ruby-identifier">:name</span>, <span class="ruby-identifier">:message=</span><span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;confirm 'single' and \&quot;double\&quot; quotes&quot;</span>
1218:       <span class="ruby-identifier">d</span> = <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">new</span>
1219:       <span class="ruby-identifier">d</span>.<span class="ruby-identifier">name</span> = <span class="ruby-value str">&quot;John&quot;</span>
1220:       <span class="ruby-identifier">d</span>.<span class="ruby-identifier">name_confirmation</span> = <span class="ruby-value str">&quot;Johnny&quot;</span>
1221:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">d</span>.<span class="ruby-identifier">valid?</span>
1222:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;confirm 'single' and \&quot;double\&quot; quotes&quot;</span>, <span class="ruby-identifier">d</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:name</span>)
1223:     <span class="ruby-keyword kw">end</span>
1224:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003289" class="method">
  <div id="M003289_title" class="title">
    <b>test_validates_each</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003289_source')" id="l_M003289_source">show source</a> ]</p>
  <div id="M003289_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 228</span>
228:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_each</span>
229:     <span class="ruby-identifier">hits</span> = <span class="ruby-value">0</span>
230:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_each</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:content</span>, [<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:content</span>]) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">record</span>, <span class="ruby-identifier">attr</span><span class="ruby-operator">|</span>
231:       <span class="ruby-identifier">record</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span> <span class="ruby-identifier">attr</span>, <span class="ruby-value str">'gotcha'</span>
232:       <span class="ruby-identifier">hits</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
233:     <span class="ruby-keyword kw">end</span>
234:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;valid&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
235:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
236:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">4</span>, <span class="ruby-identifier">hits</span>
237:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-node">%w(gotcha gotcha)</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
238:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-node">%w(gotcha gotcha)</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:content</span>)
239:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003324" class="method">
  <div id="M003324_title" class="title">
    <b>test_validates_exclusion_of</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003324_source')" id="l_M003324_source">show source</a> ]</p>
  <div id="M003324_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 717</span>
717:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_exclusion_of</span>
718:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_exclusion_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:in</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">%w( abe monkey )</span> )
719: 
720:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;something&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;abc&quot;</span>).<span class="ruby-identifier">valid?</span>
721:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;monkey&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;abc&quot;</span>).<span class="ruby-identifier">valid?</span>
722:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003325" class="method">
  <div id="M003325_title" class="title">
    <b>test_validates_exclusion_of_with_formatted_message</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003325_source')" id="l_M003325_source">show source</a> ]</p>
  <div id="M003325_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 724</span>
724:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_exclusion_of_with_formatted_message</span>
725:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_exclusion_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:in</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">%w( abe monkey )</span>, <span class="ruby-identifier">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;option {{value}} is restricted&quot;</span> )
726: 
727:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;something&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;abc&quot;</span>)
728: 
729:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;monkey&quot;</span>)
730:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
731:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
732:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;option monkey is restricted&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
733:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003364" class="method">
  <div id="M003364_title" class="title">
    <b>test_validates_format_of_with_custom_error_using_quotes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003364_source')" id="l_M003364_source">show source</a> ]</p>
  <div id="M003364_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1226</span>
1226:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_format_of_with_custom_error_using_quotes</span>
1227:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Developer</span>) <span class="ruby-keyword kw">do</span>
1228:       <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">validates_format_of</span> <span class="ruby-identifier">:name</span>, <span class="ruby-identifier">:with</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-regexp re">/^(A-Z*)$/</span>, <span class="ruby-identifier">:message=</span><span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;format 'single' and \&quot;double\&quot; quotes&quot;</span>
1229:       <span class="ruby-identifier">d</span> = <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">new</span>
1230:       <span class="ruby-identifier">d</span>.<span class="ruby-identifier">name</span> = <span class="ruby-identifier">d</span>.<span class="ruby-identifier">name_confirmation</span> = <span class="ruby-value str">&quot;John 32&quot;</span>
1231:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">d</span>.<span class="ruby-identifier">valid?</span>
1232:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;format 'single' and \&quot;double\&quot; quotes&quot;</span>, <span class="ruby-identifier">d</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:name</span>)
1233:     <span class="ruby-keyword kw">end</span>
1234:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003317" class="method">
  <div id="M003317_title" class="title">
    <b>test_validates_inclusion_of</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003317_source')" id="l_M003317_source">show source</a> ]</p>
  <div id="M003317_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 640</span>
640:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_inclusion_of</span>
641:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_inclusion_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:in</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">%w( a b c d e f g )</span> )
642: 
643:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;a!&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;abc&quot;</span>).<span class="ruby-identifier">valid?</span>
644:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;a b&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;abc&quot;</span>).<span class="ruby-identifier">valid?</span>
645:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;def&quot;</span>).<span class="ruby-identifier">valid?</span>
646: 
647:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;a&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;I know you are but what am I?&quot;</span>)
648:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
649:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;uhoh&quot;</span>
650:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
651:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
652:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is not included in the list&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
653: 
654:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ArgumentError</span>) { <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_inclusion_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:in</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span> ) }
655:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ArgumentError</span>) { <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_inclusion_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:in</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>) }
656: 
657:     <span class="ruby-identifier">assert_nothing_raised</span>(<span class="ruby-constant">ArgumentError</span>) { <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_inclusion_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:in</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;hi!&quot;</span> ) }
658:     <span class="ruby-identifier">assert_nothing_raised</span>(<span class="ruby-constant">ArgumentError</span>) { <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_inclusion_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:in</span> =<span class="ruby-operator">&gt;</span> {} ) }
659:     <span class="ruby-identifier">assert_nothing_raised</span>(<span class="ruby-constant">ArgumentError</span>) { <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_inclusion_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:in</span> =<span class="ruby-operator">&gt;</span> [] ) }
660:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003318" class="method">
  <div id="M003318_title" class="title">
    <b>test_validates_inclusion_of_with_allow_nil</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003318_source')" id="l_M003318_source">show source</a> ]</p>
  <div id="M003318_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 662</span>
662:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_inclusion_of_with_allow_nil</span>
663:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_inclusion_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:in</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">%w( a b c d e f g )</span>, <span class="ruby-identifier">:allow_nil=</span><span class="ruby-operator">&gt;</span><span class="ruby-keyword kw">true</span> )
664: 
665:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;a!&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;abc&quot;</span>).<span class="ruby-identifier">valid?</span>
666:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;abc&quot;</span>).<span class="ruby-identifier">valid?</span>
667:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;abc&quot;</span>).<span class="ruby-identifier">valid?</span>
668:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003365" class="method">
  <div id="M003365_title" class="title">
    <b>test_validates_inclusion_of_with_custom_error_using_quotes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003365_source')" id="l_M003365_source">show source</a> ]</p>
  <div id="M003365_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1236</span>
1236:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_inclusion_of_with_custom_error_using_quotes</span>
1237:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Developer</span>) <span class="ruby-keyword kw">do</span>
1238:       <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">validates_inclusion_of</span> <span class="ruby-identifier">:salary</span>, <span class="ruby-identifier">:in</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1000</span><span class="ruby-operator">..</span><span class="ruby-value">80000</span>, <span class="ruby-identifier">:message=</span><span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;This string contains 'single' and \&quot;double\&quot; quotes&quot;</span>
1239:       <span class="ruby-identifier">d</span> = <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">new</span>
1240:       <span class="ruby-identifier">d</span>.<span class="ruby-identifier">salary</span> = <span class="ruby-value str">&quot;90,000&quot;</span>
1241:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">d</span>.<span class="ruby-identifier">valid?</span>
1242:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;This string contains 'single' and \&quot;double\&quot; quotes&quot;</span>, <span class="ruby-identifier">d</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:salary</span>).<span class="ruby-identifier">last</span>
1243:     <span class="ruby-keyword kw">end</span>
1244:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003322" class="method">
  <div id="M003322_title" class="title">
    <b>test_validates_inclusion_of_with_formatted_message</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003322_source')" id="l_M003322_source">show source</a> ]</p>
  <div id="M003322_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 697</span>
697:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_inclusion_of_with_formatted_message</span>
698:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_inclusion_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:in</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">%w( a b c d e f g )</span>, <span class="ruby-identifier">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;option {{value}} is not in the list&quot;</span> )
699: 
700:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;a&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;abc&quot;</span>).<span class="ruby-identifier">valid?</span>
701: 
702:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;abc&quot;</span>)
703:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
704:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
705:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;option uhoh is not in the list&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
706:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003344" class="method">
  <div id="M003344_title" class="title">
    <b>test_validates_length_of_custom_errors_for_in</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003344_source')" id="l_M003344_source">show source</a> ]</p>
  <div id="M003344_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 980</span>
980:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_custom_errors_for_in</span>
981:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:in</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">10</span><span class="ruby-operator">..</span><span class="ruby-value">20</span>, <span class="ruby-identifier">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;hoo {{count}}&quot;</span>)
982:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
983:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
984:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
985:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;hoo 10&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
986: 
987:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhohuhohuhohuhohuhohuhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
988:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
989:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
990:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;hoo 20&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
991:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003346" class="method">
  <div id="M003346_title" class="title">
    <b>test_validates_length_of_custom_errors_for_is_with_message</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003346_source')" id="l_M003346_source">show source</a> ]</p>
  <div id="M003346_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1001</span>
1001:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_custom_errors_for_is_with_message</span>
1002:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:is=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:message=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;boo {{count}}&quot;</span> )
1003:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1004:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1005:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1006:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;boo 5&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
1007:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003347" class="method">
  <div id="M003347_title" class="title">
    <b>test_validates_length_of_custom_errors_for_is_with_wrong_length</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003347_source')" id="l_M003347_source">show source</a> ]</p>
  <div id="M003347_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1009</span>
1009:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_custom_errors_for_is_with_wrong_length</span>
1010:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:is=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:wrong_length=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;hoo {{count}}&quot;</span> )
1011:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1012:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1013:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1014:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;hoo 5&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
1015:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003343" class="method">
  <div id="M003343_title" class="title">
    <b>test_validates_length_of_custom_errors_for_maximum_with_message</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003343_source')" id="l_M003343_source">show source</a> ]</p>
  <div id="M003343_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 972</span>
972:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_custom_errors_for_maximum_with_message</span>
973:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:message=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;boo {{count}}&quot;</span> )
974:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
975:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
976:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
977:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;boo 5&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
978:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003345" class="method">
  <div id="M003345_title" class="title">
    <b>test_validates_length_of_custom_errors_for_maximum_with_too_long</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003345_source')" id="l_M003345_source">show source</a> ]</p>
  <div id="M003345_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 993</span>
993:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_custom_errors_for_maximum_with_too_long</span>
994:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:too_long=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;hoo {{count}}&quot;</span> )
995:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhohuhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
996:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
997:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
998:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;hoo 5&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
999:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003341" class="method">
  <div id="M003341_title" class="title">
    <b>test_validates_length_of_custom_errors_for_minimum_with_message</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003341_source')" id="l_M003341_source">show source</a> ]</p>
  <div id="M003341_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 956</span>
956:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_custom_errors_for_minimum_with_message</span>
957:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:minimum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:message=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;boo {{count}}&quot;</span> )
958:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
959:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
960:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
961:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;boo 5&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
962:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003342" class="method">
  <div id="M003342_title" class="title">
    <b>test_validates_length_of_custom_errors_for_minimum_with_too_short</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003342_source')" id="l_M003342_source">show source</a> ]</p>
  <div id="M003342_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 964</span>
964:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_custom_errors_for_minimum_with_too_short</span>
965:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:minimum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">5</span>, <span class="ruby-identifier">:too_short=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;hoo {{count}}&quot;</span> )
966:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;uhoh&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
967:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
968:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
969:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;hoo 5&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
970:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003340" class="method">
  <div id="M003340_title" class="title">
    <b>test_validates_length_of_nasty_params</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003340_source')" id="l_M003340_source">show source</a> ]</p>
  <div id="M003340_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 945</span>
945:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_nasty_params</span>
946:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ArgumentError</span>) { <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:minimum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">6</span>, <span class="ruby-identifier">:maximum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">9</span>) }
947:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ArgumentError</span>) { <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:within=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">6</span>, <span class="ruby-identifier">:maximum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">9</span>) }
948:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ArgumentError</span>) { <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:within=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">6</span>, <span class="ruby-identifier">:minimum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">9</span>) }
949:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ArgumentError</span>) { <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:within=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">6</span>, <span class="ruby-identifier">:is=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">9</span>) }
950:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ArgumentError</span>) { <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:minimum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;a&quot;</span>) }
951:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ArgumentError</span>) { <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;a&quot;</span>) }
952:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ArgumentError</span>) { <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:within=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;a&quot;</span>) }
953:     <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ArgumentError</span>) { <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:is=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;a&quot;</span>) }
954:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003336" class="method">
  <div id="M003336_title" class="title">
    <b>test_validates_length_of_using_bignum</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003336_source')" id="l_M003336_source">show source</a> ]</p>
  <div id="M003336_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 894</span>
894:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_using_bignum</span>
895:     <span class="ruby-identifier">bigmin</span> = <span class="ruby-value">2</span> <span class="ruby-operator">**</span> <span class="ruby-value">30</span>
896:     <span class="ruby-identifier">bigmax</span> = <span class="ruby-value">2</span> <span class="ruby-operator">**</span> <span class="ruby-value">32</span>
897:     <span class="ruby-identifier">bigrange</span> = <span class="ruby-identifier">bigmin</span><span class="ruby-operator">...</span><span class="ruby-identifier">bigmax</span>
898:     <span class="ruby-identifier">assert_nothing_raised</span> <span class="ruby-keyword kw">do</span>
899:       <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:is</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">bigmin</span> <span class="ruby-operator">+</span> <span class="ruby-value">5</span>
900:       <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:within</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">bigrange</span>
901:       <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:in</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">bigrange</span>
902:       <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:minimum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">bigmin</span>
903:       <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">bigmax</span>
904:     <span class="ruby-keyword kw">end</span>
905:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003334" class="method">
  <div id="M003334_title" class="title">
    <b>test_validates_length_of_using_is</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003334_source')" id="l_M003334_source">show source</a> ]</p>
  <div id="M003334_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 866</span>
866:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_using_is</span>
867:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:is</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span>
868: 
869:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;valid&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
870:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
871: 
872:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;notvalid&quot;</span>
873:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
874:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
875:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is the wrong length (should be 5 characters)&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
876: 
877:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;&quot;</span>
878:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
879: 
880:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-keyword kw">nil</span>
881:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
882:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003354" class="method">
  <div id="M003354_title" class="title">
    <b>test_validates_length_of_using_is_utf8</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003354_source')" id="l_M003354_source">show source</a> ]</p>
  <div id="M003354_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1119</span>
1119:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_using_is_utf8</span>
1120:     <span class="ruby-identifier">with_kcode</span>(<span class="ruby-value str">'UTF8'</span>) <span class="ruby-keyword kw">do</span>
1121:       <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:is</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span>
1122: 
1123:       <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;345&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1124:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1125: 
1126:       <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;345&quot;</span>
1127:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1128:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1129:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is the wrong length (should be 5 characters)&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
1130:     <span class="ruby-keyword kw">end</span>
1131:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003328" class="method">
  <div id="M003328_title" class="title">
    <b>test_validates_length_of_using_maximum</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003328_source')" id="l_M003328_source">show source</a> ]</p>
  <div id="M003328_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 767</span>
767:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_using_maximum</span>
768:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span>
769: 
770:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;valid&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
771:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
772: 
773:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;notvalid&quot;</span>
774:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
775:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
776:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is too long (maximum is 5 characters)&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
777: 
778:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;&quot;</span>
779:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
780: 
781:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-keyword kw">nil</span>
782:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
783:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003349" class="method">
  <div id="M003349_title" class="title">
    <b>test_validates_length_of_using_maximum_utf8</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003349_source')" id="l_M003349_source">show source</a> ]</p>
  <div id="M003349_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1031</span>
1031:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_using_maximum_utf8</span>
1032:     <span class="ruby-identifier">with_kcode</span>(<span class="ruby-value str">'UTF8'</span>) <span class="ruby-keyword kw">do</span>
1033:       <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:maximum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span>
1034: 
1035:       <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1036:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1037: 
1038:       <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;34&quot;</span>
1039:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1040:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1041:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is too long (maximum is 5 characters)&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
1042:     <span class="ruby-keyword kw">end</span>
1043:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003326" class="method">
  <div id="M003326_title" class="title">
    <b>test_validates_length_of_using_minimum</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003326_source')" id="l_M003326_source">show source</a> ]</p>
  <div id="M003326_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 735</span>
735:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_using_minimum</span>
736:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:minimum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span>
737: 
738:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;valid&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
739:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
740: 
741:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;not&quot;</span>
742:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
743:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
744:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is too short (minimum is 5 characters)&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
745: 
746:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;&quot;</span>
747:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
748:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
749:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is too short (minimum is 5 characters)&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
750: 
751:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-keyword kw">nil</span>
752:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
753:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
754:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is too short (minimum is 5 characters)&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
755:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003348" class="method">
  <div id="M003348_title" class="title">
    <b>test_validates_length_of_using_minimum_utf8</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003348_source')" id="l_M003348_source">show source</a> ]</p>
  <div id="M003348_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1017</span>
1017:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_using_minimum_utf8</span>
1018:     <span class="ruby-identifier">with_kcode</span>(<span class="ruby-value str">'UTF8'</span>) <span class="ruby-keyword kw">do</span>
1019:       <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:minimum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span>
1020: 
1021:       <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;whatever&quot;</span>)
1022:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1023: 
1024:       <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;&quot;</span>
1025:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1026:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1027:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is too short (minimum is 5 characters)&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">&quot;title&quot;</span>]
1028:     <span class="ruby-keyword kw">end</span>
1029:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003330" class="method">
  <div id="M003330_title" class="title">
    <b>test_validates_length_of_using_within</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003330_source')" id="l_M003330_source">show source</a> ]</p>
  <div id="M003330_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 795</span>
795:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_using_within</span>
796:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:content</span>, <span class="ruby-identifier">:within</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">3</span><span class="ruby-operator">..</span><span class="ruby-value">5</span>)
797: 
798:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;a!&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;I'm ooooooooh so very long&quot;</span>)
799:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
800:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is too short (minimum is 3 characters)&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
801:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is too long (maximum is 5 characters)&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:content</span>)
802: 
803:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-keyword kw">nil</span>
804:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">content</span> = <span class="ruby-keyword kw">nil</span>
805:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
806:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is too short (minimum is 3 characters)&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
807:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is too short (minimum is 3 characters)&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:content</span>)
808: 
809:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;abe&quot;</span>
810:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">content</span>  = <span class="ruby-value str">&quot;mad&quot;</span>
811:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
812:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003350" class="method">
  <div id="M003350_title" class="title">
    <b>test_validates_length_of_using_within_utf8</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003350_source')" id="l_M003350_source">show source</a> ]</p>
  <div id="M003350_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1045</span>
1045:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_using_within_utf8</span>
1046:     <span class="ruby-identifier">with_kcode</span>(<span class="ruby-value str">'UTF8'</span>) <span class="ruby-keyword kw">do</span>
1047:       <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:content</span>, <span class="ruby-identifier">:within</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">3</span><span class="ruby-operator">..</span><span class="ruby-value">5</span>)
1048: 
1049:       <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;&quot;</span>, <span class="ruby-value str">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;12&quot;</span>)
1050:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1051:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is too short (minimum is 3 characters)&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:title</span>)
1052:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;is too long (maximum is 5 characters)&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:content</span>)
1053:       <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;&quot;</span>
1054:       <span class="ruby-identifier">t</span>.<span class="ruby-identifier">content</span>  = <span class="ruby-value str">&quot;12&quot;</span>
1055:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1056:     <span class="ruby-keyword kw">end</span>
1057:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003321" class="method">
  <div id="M003321_title" class="title">
    <b>test_validates_length_of_with_allow_blank</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003321_source')" id="l_M003321_source">show source</a> ]</p>
  <div id="M003321_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 688</span>
688:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_with_allow_blank</span>
689:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:is</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span>, <span class="ruby-identifier">:allow_blank=</span><span class="ruby-operator">&gt;</span><span class="ruby-keyword kw">true</span> )
690: 
691:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;ab&quot;</span>).<span class="ruby-identifier">valid?</span>
692:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;&quot;</span>).<span class="ruby-identifier">valid?</span>
693:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>).<span class="ruby-identifier">valid?</span>
694:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;abcde&quot;</span>).<span class="ruby-identifier">valid?</span>
695:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003320" class="method">
  <div id="M003320_title" class="title">
    <b>test_validates_length_of_with_allow_nil</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003320_source')" id="l_M003320_source">show source</a> ]</p>
  <div id="M003320_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 679</span>
679:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_with_allow_nil</span>
680:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span>( <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:is</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span>, <span class="ruby-identifier">:allow_nil=</span><span class="ruby-operator">&gt;</span><span class="ruby-keyword kw">true</span> )
681: 
682:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;ab&quot;</span>).<span class="ruby-identifier">valid?</span>
683:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;&quot;</span>).<span class="ruby-identifier">valid?</span>
684:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>).<span class="ruby-identifier">valid?</span>
685:     <span class="ruby-identifier">assert</span> <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;abcde&quot;</span>).<span class="ruby-identifier">valid?</span>
686:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003355" class="method">
  <div id="M003355_title" class="title">
    <b>test_validates_length_of_with_block</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003355_source')" id="l_M003355_source">show source</a> ]</p>
  <div id="M003355_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1133</span>
1133:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_with_block</span>
1134:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:content</span>, <span class="ruby-identifier">:minimum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span>, <span class="ruby-identifier">:too_short=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">&quot;Your essay must be at least {{count}} words.&quot;</span>,
1135:                                         <span class="ruby-identifier">:tokenizer</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">lambda</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">str</span><span class="ruby-operator">|</span> <span class="ruby-identifier">str</span>.<span class="ruby-identifier">scan</span>(<span class="ruby-regexp re">/\w+/</span>) }
1136:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-identifier">:content</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;this content should be long enough&quot;</span>)
1137:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1138: 
1139:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">content</span> = <span class="ruby-value str">&quot;not long enough&quot;</span>
1140:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1141:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:content</span>)
1142:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;Your essay must be at least 5 words.&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-identifier">:content</span>]
1143:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003368" class="method">
  <div id="M003368_title" class="title">
    <b>test_validates_length_of_with_custom_message_using_quotes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003368_source')" id="l_M003368_source">show source</a> ]</p>
  <div id="M003368_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1266</span>
1266:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_with_custom_message_using_quotes</span>
1267:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Developer</span>) <span class="ruby-keyword kw">do</span>
1268:       <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:name</span>, <span class="ruby-identifier">:minimum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">4</span>, <span class="ruby-identifier">:message=</span><span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;This string contains 'single' and \&quot;double\&quot; quotes&quot;</span>
1269:       <span class="ruby-identifier">d</span> = <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">new</span>
1270:       <span class="ruby-identifier">d</span>.<span class="ruby-identifier">name</span> = <span class="ruby-value str">&quot;Joe&quot;</span>
1271:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">d</span>.<span class="ruby-identifier">valid?</span>
1272:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;This string contains 'single' and \&quot;double\&quot; quotes&quot;</span>, <span class="ruby-identifier">d</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:name</span>)
1273:     <span class="ruby-keyword kw">end</span>
1274:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003366" class="method">
  <div id="M003366_title" class="title">
    <b>test_validates_length_of_with_custom_too_long_using_quotes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003366_source')" id="l_M003366_source">show source</a> ]</p>
  <div id="M003366_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1246</span>
1246:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_with_custom_too_long_using_quotes</span>
1247:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Developer</span>) <span class="ruby-keyword kw">do</span>
1248:       <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:name</span>, <span class="ruby-identifier">:maximum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">4</span>, <span class="ruby-identifier">:too_long=</span><span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;This string contains 'single' and \&quot;double\&quot; quotes&quot;</span>
1249:       <span class="ruby-identifier">d</span> = <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">new</span>
1250:       <span class="ruby-identifier">d</span>.<span class="ruby-identifier">name</span> = <span class="ruby-value str">&quot;Jeffrey&quot;</span>
1251:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">d</span>.<span class="ruby-identifier">valid?</span>
1252:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;This string contains 'single' and \&quot;double\&quot; quotes&quot;</span>, <span class="ruby-identifier">d</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:name</span>)
1253:     <span class="ruby-keyword kw">end</span>
1254:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003367" class="method">
  <div id="M003367_title" class="title">
    <b>test_validates_length_of_with_custom_too_short_using_quotes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003367_source')" id="l_M003367_source">show source</a> ]</p>
  <div id="M003367_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1256</span>
1256:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_of_with_custom_too_short_using_quotes</span>
1257:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Developer</span>) <span class="ruby-keyword kw">do</span>
1258:       <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:name</span>, <span class="ruby-identifier">:minimum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">4</span>, <span class="ruby-identifier">:too_short=</span><span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;This string contains 'single' and \&quot;double\&quot; quotes&quot;</span>
1259:       <span class="ruby-identifier">d</span> = <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">new</span>
1260:       <span class="ruby-identifier">d</span>.<span class="ruby-identifier">name</span> = <span class="ruby-value str">&quot;Joe&quot;</span>
1261:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">d</span>.<span class="ruby-identifier">valid?</span>
1262:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;This string contains 'single' and \&quot;double\&quot; quotes&quot;</span>, <span class="ruby-identifier">d</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:name</span>)
1263:     <span class="ruby-keyword kw">end</span>
1264:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003337" class="method">
  <div id="M003337_title" class="title">
    <b>test_validates_length_with_globally_modified_error_message</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003337_source')" id="l_M003337_source">show source</a> ]</p>
  <div id="M003337_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 907</span>
907:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_length_with_globally_modified_error_message</span>
908:     <span class="ruby-constant">ActiveSupport</span><span class="ruby-operator">::</span><span class="ruby-constant">Deprecation</span>.<span class="ruby-identifier">silence</span> <span class="ruby-keyword kw">do</span>
909:       <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Errors</span>.<span class="ruby-identifier">default_error_messages</span>[<span class="ruby-identifier">:too_short</span>] = <span class="ruby-value str">'tu est trops petit hombre {{count}}'</span>
910:     <span class="ruby-keyword kw">end</span>
911:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:minimum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">10</span>
912:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'too short'</span>)
913:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
914: 
915:     <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">'tu est trops petit hombre 10'</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value str">'title'</span>]
916:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003369" class="method">
  <div id="M003369_title" class="title">
    <b>test_validates_presence_of_with_custom_message_using_quotes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003369_source')" id="l_M003369_source">show source</a> ]</p>
  <div id="M003369_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1276</span>
1276:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_presence_of_with_custom_message_using_quotes</span>
1277:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Developer</span>) <span class="ruby-keyword kw">do</span>
1278:       <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">validates_presence_of</span> <span class="ruby-identifier">:non_existent</span>, <span class="ruby-identifier">:message=</span><span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;This string contains 'single' and \&quot;double\&quot; quotes&quot;</span>
1279:       <span class="ruby-identifier">d</span> = <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">new</span>
1280:       <span class="ruby-identifier">d</span>.<span class="ruby-identifier">name</span> = <span class="ruby-value str">&quot;Joe&quot;</span>
1281:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">d</span>.<span class="ruby-identifier">valid?</span>
1282:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;This string contains 'single' and \&quot;double\&quot; quotes&quot;</span>, <span class="ruby-identifier">d</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:non_existent</span>)
1283:     <span class="ruby-keyword kw">end</span>
1284:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003338" class="method">
  <div id="M003338_title" class="title">
    <b>test_validates_size_of_association</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003338_source')" id="l_M003338_source">show source</a> ]</p>
  <div id="M003338_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 918</span>
918:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_size_of_association</span>
919:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Owner</span>) <span class="ruby-keyword kw">do</span>
920:       <span class="ruby-identifier">assert_nothing_raised</span> { <span class="ruby-constant">Owner</span>.<span class="ruby-identifier">validates_size_of</span> <span class="ruby-identifier">:pets</span>, <span class="ruby-identifier">:minimum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span> }
921:       <span class="ruby-identifier">o</span> = <span class="ruby-constant">Owner</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">'name'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'nopets'</span>)
922:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">o</span>.<span class="ruby-identifier">save</span>
923:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:pets</span>)
924:       <span class="ruby-identifier">pet</span> = <span class="ruby-identifier">o</span>.<span class="ruby-identifier">pets</span>.<span class="ruby-identifier">build</span>(<span class="ruby-value str">'name'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'apet'</span>)
925:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">valid?</span>
926:     <span class="ruby-keyword kw">end</span>
927:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003339" class="method">
  <div id="M003339_title" class="title">
    <b>test_validates_size_of_association_using_within</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003339_source')" id="l_M003339_source">show source</a> ]</p>
  <div id="M003339_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 929</span>
929:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_size_of_association_using_within</span>
930:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Owner</span>) <span class="ruby-keyword kw">do</span>
931:       <span class="ruby-identifier">assert_nothing_raised</span> { <span class="ruby-constant">Owner</span>.<span class="ruby-identifier">validates_size_of</span> <span class="ruby-identifier">:pets</span>, <span class="ruby-identifier">:within</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">2</span> }
932:       <span class="ruby-identifier">o</span> = <span class="ruby-constant">Owner</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">'name'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'nopets'</span>)
933:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">o</span>.<span class="ruby-identifier">save</span>
934:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:pets</span>)
935: 
936:       <span class="ruby-identifier">pet</span> = <span class="ruby-identifier">o</span>.<span class="ruby-identifier">pets</span>.<span class="ruby-identifier">build</span>(<span class="ruby-value str">'name'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'apet'</span>)
937:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">valid?</span>
938: 
939:       <span class="ruby-value">2</span>.<span class="ruby-identifier">times</span> { <span class="ruby-identifier">o</span>.<span class="ruby-identifier">pets</span>.<span class="ruby-identifier">build</span>(<span class="ruby-value str">'name'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'apet'</span>) }
940:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">o</span>.<span class="ruby-identifier">save</span>
941:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:pets</span>)
942:     <span class="ruby-keyword kw">end</span>
943:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003356" class="method">
  <div id="M003356_title" class="title">
    <b>test_validates_size_of_association_utf8</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003356_source')" id="l_M003356_source">show source</a> ]</p>
  <div id="M003356_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1145</span>
1145:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_size_of_association_utf8</span>
1146:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Owner</span>) <span class="ruby-keyword kw">do</span>
1147:       <span class="ruby-identifier">with_kcode</span>(<span class="ruby-value str">'UTF8'</span>) <span class="ruby-keyword kw">do</span>
1148:         <span class="ruby-identifier">assert_nothing_raised</span> { <span class="ruby-constant">Owner</span>.<span class="ruby-identifier">validates_size_of</span> <span class="ruby-identifier">:pets</span>, <span class="ruby-identifier">:minimum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span> }
1149:         <span class="ruby-identifier">o</span> = <span class="ruby-constant">Owner</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">'name'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">''</span>)
1150:         <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">o</span>.<span class="ruby-identifier">save</span>
1151:         <span class="ruby-identifier">assert</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:pets</span>)
1152:         <span class="ruby-identifier">o</span>.<span class="ruby-identifier">pets</span>.<span class="ruby-identifier">build</span>(<span class="ruby-value str">'name'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">''</span>)
1153:         <span class="ruby-identifier">assert</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">valid?</span>
1154:       <span class="ruby-keyword kw">end</span>
1155:     <span class="ruby-keyword kw">end</span>
1156:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003308" class="method">
  <div id="M003308_title" class="title">
    <b>test_validates_uniqueness_inside_with_scope</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003308_source')" id="l_M003308_source">show source</a> ]</p>
  <div id="M003308_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 514</span>
514:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_uniqueness_inside_with_scope</span>
515:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_uniqueness_of</span>(<span class="ruby-identifier">:title</span>)
516: 
517:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">with_scope</span>(<span class="ruby-identifier">:find</span> =<span class="ruby-operator">&gt;</span> { <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> { <span class="ruby-identifier">:author_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;David&quot;</span> } }) <span class="ruby-keyword kw">do</span>
518:       <span class="ruby-identifier">t1</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;I'm unique!&quot;</span>, <span class="ruby-value str">&quot;author_name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;Mary&quot;</span>)
519:       <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t1</span>.<span class="ruby-identifier">save</span>
520:       <span class="ruby-identifier">t2</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;I'm unique!&quot;</span>, <span class="ruby-value str">&quot;author_name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;David&quot;</span>)
521:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2</span>.<span class="ruby-identifier">valid?</span>
522:     <span class="ruby-keyword kw">end</span>
523:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003370" class="method">
  <div id="M003370_title" class="title">
    <b>test_validates_uniqueness_of_with_custom_message_using_quotes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003370_source')" id="l_M003370_source">show source</a> ]</p>
  <div id="M003370_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1286</span>
1286:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_uniqueness_of_with_custom_message_using_quotes</span>
1287:     <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Developer</span>) <span class="ruby-keyword kw">do</span>
1288:       <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">validates_uniqueness_of</span> <span class="ruby-identifier">:name</span>, <span class="ruby-identifier">:message=</span><span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;This string contains 'single' and \&quot;double\&quot; quotes&quot;</span>
1289:       <span class="ruby-identifier">d</span> = <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">new</span>
1290:       <span class="ruby-identifier">d</span>.<span class="ruby-identifier">name</span> = <span class="ruby-value str">&quot;David&quot;</span>
1291:       <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">d</span>.<span class="ruby-identifier">valid?</span>
1292:       <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;This string contains 'single' and \&quot;double\&quot; quotes&quot;</span>, <span class="ruby-identifier">d</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-identifier">:name</span>)
1293:     <span class="ruby-keyword kw">end</span>
1294:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003300" class="method">
  <div id="M003300_title" class="title">
    <b>test_validates_uniquness_with_newline_chars</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003300_source')" id="l_M003300_source">show source</a> ]</p>
  <div id="M003300_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 363</span>
363:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validates_uniquness_with_newline_chars</span>
364:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_uniqueness_of</span>(<span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:case_sensitive</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">false</span>)
365: 
366:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;new\nline&quot;</span>)
367:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>, <span class="ruby-value str">&quot;Should save t as unique&quot;</span>
368:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003386" class="method">
  <div id="M003386_title" class="title">
    <b>test_validation_order</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003386_source')" id="l_M003386_source">show source</a> ]</p>
  <div id="M003386_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1434</span>
1434:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validation_order</span>
1435:      <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_presence_of</span> <span class="ruby-identifier">:title</span>
1436:      <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:title</span>, <span class="ruby-identifier">:minimum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">2</span>
1437: 
1438:      <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;&quot;</span>)
1439:      <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>
1440:      <span class="ruby-identifier">assert_equal</span> <span class="ruby-value str">&quot;can't be blank&quot;</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">on</span>(<span class="ruby-value str">&quot;title&quot;</span>).<span class="ruby-identifier">first</span>
1441:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M003388" class="method">
  <div id="M003388_title" class="title">
    <b>test_validation_with_if_as_string</b>()
  </div>
  <div class="description">
  <p>
previous implementation of validates_presence_of eval&#8217;d the string
with the wrong binding, this regression test is to ensure that it works
correctly
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M003388_source')" id="l_M003388_source">show source</a> ]</p>
  <div id="M003388_source" class="dyn-source">
<pre>
      <span class="ruby-comment cmt"># File activerecord/test/cases/validations_test.rb, line 1457</span>
1457:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validation_with_if_as_string</span>
1458:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_presence_of</span>(<span class="ruby-identifier">:title</span>)
1459:     <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_presence_of</span>(<span class="ruby-identifier">:author_name</span>, <span class="ruby-identifier">:if</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;title.to_s.match('important')&quot;</span>)
1460: 
1461:     <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>
1462:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;A topic without a title should not be valid&quot;</span>
1463:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">invalid?</span>(<span class="ruby-value str">&quot;author_name&quot;</span>), <span class="ruby-value str">&quot;A topic without an 'important' title should not require an author&quot;</span>
1464: 
1465:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;Just a title&quot;</span>
1466:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;A topic with a basic title should be valid&quot;</span>
1467: 
1468:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">title</span> = <span class="ruby-value str">&quot;A very important title&quot;</span>
1469:     <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;A topic with an important title, but without an author, should not be valid&quot;</span>
1470:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">invalid?</span>(<span class="ruby-value str">&quot;author_name&quot;</span>), <span class="ruby-value str">&quot;A topic with an 'important' title should require an author&quot;</span>
1471: 
1472:     <span class="ruby-identifier">t</span>.<span class="ruby-identifier">author_name</span> = <span class="ruby-value str">&quot;Hubert J. Farnsworth&quot;</span>
1473:     <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-value str">&quot;A topic with an important title and author should be valid&quot;</span>
1474:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
</div>

  </div>