<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta name="Content-Type" content="text/html; charset=utf-8" />
<title>Class: ActiveRecord::Associations::AssociationCollection</title>
<link rel="stylesheet" href="../../css/style.css" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="../../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '../..';
  if (relpath != '') relpath += '/';
</script>
<script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>

  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="../../_index.html">Index (A)</a> &raquo; 
    <span class='title'><span class='object_link'><a href="../../ActiveRecord.html" title="ActiveRecord (module)">ActiveRecord</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Associations.html" title="ActiveRecord::Associations (module)">Associations</a></span></span>
     &raquo; 
    <span class="title">AssociationCollection</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  <a id="class_list_link" href="#">Class List</a>
  <a id="method_list_link" href="#">Method List</a>
  <a id ="file_list_link" href="#">File List</a>
</div>

      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><h1>Class: ActiveRecord::Associations::AssociationCollection
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName"><span class='object_link'><a href="AssociationProxy.html" title="ActiveRecord::Associations::AssociationProxy (class)">AssociationProxy</a></span></span>
      
        <ul class="fullTree">
          <li><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></li>
          
            <li class="next"><span class='object_link'><a href="AssociationProxy.html" title="ActiveRecord::Associations::AssociationProxy (class)">AssociationProxy</a></span></li>
          
            <li class="next">ActiveRecord::Associations::AssociationCollection</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">activerecord/lib/active_record/associations/association_collection.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <h1>Active Record Association Collection</h1>
<p>
AssociationCollection is an abstract class that provides common stuff to
ease the implementation of association proxies that represent collections.
See the class hierarchy in AssociationProxy.
</p>
<p>
You need to be careful with assumptions regarding the target: The proxy
does not fetch records from the database until it needs them, but new ones
created with <tt>build</tt> are added to the target. So, the target may be
non-empty and still lack children waiting to be read from the database. If
you look directly to the database you cannot assume that&#8217;s the entire
collection because new records may have been added to the target, etc.
</p>
<p>
If you need to work on all current children, new and existing records,
<tt>load_target</tt> and the <tt>loaded</tt> flag are your friends.
</p>


  </div>
</div>
<div class="tags">
  
</div><div id="subclasses">
  <h2>Direct Known Subclasses</h2>
  <p class="children"><span class='object_link'><a href="HasAndBelongsToManyAssociation.html" title="ActiveRecord::Associations::HasAndBelongsToManyAssociation (class)">HasAndBelongsToManyAssociation</a></span>, <span class='object_link'><a href="HasManyAssociation.html" title="ActiveRecord::Associations::HasManyAssociation (class)">HasManyAssociation</a></span></p>
</div>


  
  
  
  

  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#%3C%3C-instance_method" title="#&lt;&lt; (instance method)">- (Object) <strong>&lt;&lt;</strong>(*records) </a>
    

    
      (also: #push, #concat)
    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Add <tt>records</tt> to this association.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#any%3F-instance_method" title="#any? (instance method)">- (Boolean) <strong>any?</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#build-instance_method" title="#build (instance method)">- (Object) <strong>build</strong>(attributes = {}, &amp;block) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#clear-instance_method" title="#clear (instance method)">- (Object) <strong>clear</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Removes all records from this association.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#count-instance_method" title="#count (instance method)">- (Object) <strong>count</strong>(column_name = nil, options = {}) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Count all records using SQL.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create-instance_method" title="#create (instance method)">- (Object) <strong>create</strong>(attrs = {}) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create%21-instance_method" title="#create! (instance method)">- (Object) <strong>create!</strong>(attrs = {}) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#delete-instance_method" title="#delete (instance method)">- (Object) <strong>delete</strong>(*records) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Removes <tt>records</tt> from this association calling
<tt>before_remove</tt> and <tt>after_remove</tt> callbacks.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#delete_all-instance_method" title="#delete_all (instance method)">- (Object) <strong>delete_all</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Remove all records from this association.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#destroy-instance_method" title="#destroy (instance method)">- (Object) <strong>destroy</strong>(*records) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Destroy <tt>records</tt> and remove them from this association calling
<tt>before_remove</tt> and <tt>after_remove</tt> callbacks.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#destroy_all-instance_method" title="#destroy_all (instance method)">- (Object) <strong>destroy_all</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Destroy all the records from this association.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#empty%3F-instance_method" title="#empty? (instance method)">- (Boolean) <strong>empty?</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Equivalent to <tt>collection.size.zero?</tt>.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#find-instance_method" title="#find (instance method)">- (Object) <strong>find</strong>(*args) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#first-instance_method" title="#first (instance method)">- (Object) <strong>first</strong>(*args) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Fetches the first one using SQL if possible.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#include%3F-instance_method" title="#include? (instance method)">- (Boolean) <strong>include?</strong>(record) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">- (AssociationCollection) <strong>initialize</strong>(owner, reflection) </a>
    

    
  </span>
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
:nodoc:.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#last-instance_method" title="#last (instance method)">- (Object) <strong>last</strong>(*args) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Fetches the last one using SQL if possible.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#length-instance_method" title="#length (instance method)">- (Object) <strong>length</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns the size of the collection calling <tt>size</tt> on the target.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#many%3F-instance_method" title="#many? (instance method)">- (Boolean) <strong>many?</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns true if the collection has more than 1 record.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#proxy_respond_to%3F-instance_method" title="#proxy_respond_to? (instance method)">- (Boolean) <strong>proxy_respond_to?</strong>(method, include_private = false) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#replace-instance_method" title="#replace (instance method)">- (Object) <strong>replace</strong>(other_array) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Replace this collection with <tt>other_array</tt> This will perform a diff
and delete/add only records that have changed.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#reset-instance_method" title="#reset (instance method)">- (Object) <strong>reset</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#scoped-instance_method" title="#scoped (instance method)">- (Object) <strong>scoped</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#select-instance_method" title="#select (instance method)">- (Object) <strong>select</strong>(select = nil) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#size-instance_method" title="#size (instance method)">- (Object) <strong>size</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns the size of the collection by executing a SELECT COUNT(*) query if
the collection hasn&#8217;t been loaded, and calling
<tt>collection.size</tt> if it has.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#sum-instance_method" title="#sum (instance method)">- (Object) <strong>sum</strong>(*args) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Calculate sum using SQL, not Enumerable.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#to_ary-instance_method" title="#to_ary (instance method)">- (Object) <strong>to_ary</strong> </a>
    

    
      (also: #to_a)
    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#transaction-instance_method" title="#transaction (instance method)">- (Object) <strong>transaction</strong>(*args) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Starts a transaction in the association class&#8217;s database connection.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#uniq-instance_method" title="#uniq (instance method)">- (Object) <strong>uniq</strong>(collection = self) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  <h3 class="inherited">Methods inherited from <span class='object_link'><a href="AssociationProxy.html" title="ActiveRecord::Associations::AssociationProxy (class)">AssociationProxy</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="AssociationProxy.html#%3D%3D%3D-instance_method" title="ActiveRecord::Associations::AssociationProxy#=== (method)">#===</a></span>, <span class='object_link'><a href="AssociationProxy.html#aliased_table_name-instance_method" title="ActiveRecord::Associations::AssociationProxy#aliased_table_name (method)">#aliased_table_name</a></span>, <span class='object_link'><a href="AssociationProxy.html#conditions-instance_method" title="ActiveRecord::Associations::AssociationProxy#conditions (method)">#conditions</a></span>, <span class='object_link'><a href="AssociationProxy.html#flatten_deeper-instance_method" title="ActiveRecord::Associations::AssociationProxy#flatten_deeper (method)">#flatten_deeper</a></span>, <span class='object_link'><a href="AssociationProxy.html#inspect-instance_method" title="ActiveRecord::Associations::AssociationProxy#inspect (method)">#inspect</a></span>, <span class='object_link'><a href="AssociationProxy.html#loaded-instance_method" title="ActiveRecord::Associations::AssociationProxy#loaded (method)">#loaded</a></span>, <span class='object_link'><a href="AssociationProxy.html#loaded%3F-instance_method" title="ActiveRecord::Associations::AssociationProxy#loaded? (method)">#loaded?</a></span>, <span class='object_link'><a href="AssociationProxy.html#proxy_owner-instance_method" title="ActiveRecord::Associations::AssociationProxy#proxy_owner (method)">#proxy_owner</a></span>, <span class='object_link'><a href="AssociationProxy.html#proxy_reflection-instance_method" title="ActiveRecord::Associations::AssociationProxy#proxy_reflection (method)">#proxy_reflection</a></span>, <span class='object_link'><a href="AssociationProxy.html#proxy_target-instance_method" title="ActiveRecord::Associations::AssociationProxy#proxy_target (method)">#proxy_target</a></span>, <span class='object_link'><a href="AssociationProxy.html#reload-instance_method" title="ActiveRecord::Associations::AssociationProxy#reload (method)">#reload</a></span>, <span class='object_link'><a href="AssociationProxy.html#respond_to%3F-instance_method" title="ActiveRecord::Associations::AssociationProxy#respond_to? (method)">#respond_to?</a></span>, <span class='object_link'><a href="AssociationProxy.html#send-instance_method" title="ActiveRecord::Associations::AssociationProxy#send (method)">#send</a></span>, <span class='object_link'><a href="AssociationProxy.html#target-instance_method" title="ActiveRecord::Associations::AssociationProxy#target (method)">#target</a></span>, <span class='object_link'><a href="AssociationProxy.html#target%3D-instance_method" title="ActiveRecord::Associations::AssociationProxy#target= (method)">#target=</a></span></p>
<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <p class="signature first" id="initialize-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="ActiveRecord::Associations::AssociationCollection (class)">AssociationCollection</a></span></tt>) <strong>initialize</strong>(owner, reflection) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
:nodoc:
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


22
23
24
25</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/associations/association_collection.rb', line 22</span>

<span class='kw'>def</span> <span class='id initialize'>initialize</span><span class='lparen'>(</span><span class='id owner'>owner</span><span class='comma'>,</span> <span class='id reflection'>reflection</span><span class='rparen'>)</span>
  <span class='kw'>super</span>
  <span class='id construct_sql'>construct_sql</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>
<div id="method_missing_details" class="method_details_list">
  <h2>Dynamic Method Handling</h2>
  <p class="notice this">
    This class handles dynamic methods through the <tt>method_missing</tt> method
    
  </p>
  
    <div class="method_details first">
  <p class="signature first" id="method_missing-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>method_missing</strong>(method, *args)  <span class="extras">(protected)</span>
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/associations/association_collection.rb', line 421</span>

<span class='kw'>def</span> <span class='id method_missing'>method_missing</span><span class='lparen'>(</span><span class='id method'>method</span><span class='comma'>,</span> <span class='op'>*</span><span class='id args'>args</span><span class='rparen'>)</span>
  <span class='id match'>match</span> <span class='op'>=</span> <span class='const'>DynamicFinderMatch</span><span class='period'>.</span><span class='id match'>match</span><span class='lparen'>(</span><span class='id method'>method</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id match'>match</span> <span class='op'>&amp;&amp;</span> <span class='id match'>match</span><span class='period'>.</span><span class='id creator?'>creator?</span>
    <span class='id attributes'>attributes</span> <span class='op'>=</span> <span class='id match'>match</span><span class='period'>.</span><span class='id attribute_names'>attribute_names</span>
    <span class='kw'>return</span> <span class='id send'>send</span><span class='lparen'>(</span><span class='symbol'>:find_by_</span><span class='embexpr_beg'>#{</span><span class='id attributes'>attributes</span><span class='period'>.</span><span class='id join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>_and_</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='op'>*</span><span class='id args'>args</span><span class='rparen'>)</span> <span class='op'>||</span> <span class='id create'>create</span><span class='lparen'>(</span><span class='const'>Hash</span><span class='lbracket'>[</span><span class='id attributes'>attributes</span><span class='period'>.</span><span class='id zip'>zip</span><span class='lparen'>(</span><span class='id args'>args</span><span class='rparen'>)</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='ivar'>@target</span><span class='period'>.</span><span class='id respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='id method'>method</span><span class='rparen'>)</span> <span class='op'>||</span> <span class='lparen'>(</span><span class='op'>!</span><span class='ivar'>@reflection</span><span class='period'>.</span><span class='id klass'>klass</span><span class='period'>.</span><span class='id respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='id method'>method</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='const'>Class</span><span class='period'>.</span><span class='id respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='id method'>method</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id block_given?'>block_given?</span>
      <span class='kw'>super</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='op'>*</span><span class='id block_args'>block_args</span><span class='op'>|</span> <span class='kw'>yield</span><span class='lparen'>(</span><span class='op'>*</span><span class='id block_args'>block_args</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
    <span class='kw'>else</span>
      <span class='kw'>super</span>
    <span class='kw'>end</span>
  <span class='kw'>elsif</span> <span class='ivar'>@reflection</span><span class='period'>.</span><span class='id klass'>klass</span><span class='period'>.</span><span class='id scopes'>scopes</span><span class='lbracket'>[</span><span class='id method'>method</span><span class='rbracket'>]</span>
    <span class='ivar'>@_named_scopes_cache</span> <span class='op'>||=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
    <span class='ivar'>@_named_scopes_cache</span><span class='lbracket'>[</span><span class='id method'>method</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
    <span class='ivar'>@_named_scopes_cache</span><span class='lbracket'>[</span><span class='id method'>method</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id args'>args</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='id with_scope'>with_scope</span><span class='lparen'>(</span><span class='id construct_scope'>construct_scope</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='ivar'>@reflection</span><span class='period'>.</span><span class='id klass'>klass</span><span class='period'>.</span><span class='id send'>send</span><span class='lparen'>(</span><span class='id method'>method</span><span class='comma'>,</span> <span class='op'>*</span><span class='id args'>args</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
  <span class='kw'>else</span>
    <span class='id with_scope'>with_scope</span><span class='lparen'>(</span><span class='id construct_scope'>construct_scope</span><span class='rparen'>)</span> <span class='kw'>do</span>
      <span class='kw'>if</span> <span class='id block_given?'>block_given?</span>
        <span class='ivar'>@reflection</span><span class='period'>.</span><span class='id klass'>klass</span><span class='period'>.</span><span class='id send'>send</span><span class='lparen'>(</span><span class='id method'>method</span><span class='comma'>,</span> <span class='op'>*</span><span class='id args'>args</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='op'>*</span><span class='id block_args'>block_args</span><span class='op'>|</span> <span class='kw'>yield</span><span class='lparen'>(</span><span class='op'>*</span><span class='id block_args'>block_args</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
      <span class='kw'>else</span>
        <span class='ivar'>@reflection</span><span class='period'>.</span><span class='id klass'>klass</span><span class='period'>.</span><span class='id send'>send</span><span class='lparen'>(</span><span class='id method'>method</span><span class='comma'>,</span> <span class='op'>*</span><span class='id args'>args</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="<<-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>&lt;&lt;</strong>(*records) 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='push-instance_method'>push</span>, <span id='concat-instance_method'>concat</span></span>
    </span>
  
</p><div class="docstring">
  <div class="discussion">
    <p>
Add <tt>records</tt> to this association.  Returns <tt>self</tt> so method
calls may be chained. Since << flattens its argument list and inserts each
record, <tt>push</tt> and <tt>concat</tt> behave identically.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


128
129
130
131
132
133
134
135
136
137
138
139
140
141
142</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/associations/association_collection.rb', line 128</span>

<span class='kw'>def</span> <span class='op'>&lt;&lt;</span><span class='lparen'>(</span><span class='op'>*</span><span class='id records'>records</span><span class='rparen'>)</span>
  <span class='id result'>result</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='id load_target'>load_target</span> <span class='kw'>if</span> <span class='ivar'>@owner</span><span class='period'>.</span><span class='id new_record?'>new_record?</span>

  <span class='id transaction'>transaction</span> <span class='kw'>do</span>
    <span class='id flatten_deeper'>flatten_deeper</span><span class='lparen'>(</span><span class='id records'>records</span><span class='rparen'>)</span><span class='period'>.</span><span class='id each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id record'>record</span><span class='op'>|</span>
      <span class='id raise_on_type_mismatch'>raise_on_type_mismatch</span><span class='lparen'>(</span><span class='id record'>record</span><span class='rparen'>)</span>
      <span class='id add_record_to_target_with_callbacks'>add_record_to_target_with_callbacks</span><span class='lparen'>(</span><span class='id record'>record</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id r'>r</span><span class='op'>|</span>
        <span class='id result'>result</span> <span class='op'>&amp;&amp;=</span> <span class='id insert_record'>insert_record</span><span class='lparen'>(</span><span class='id record'>record</span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='ivar'>@owner</span><span class='period'>.</span><span class='id new_record?'>new_record?</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id result'>result</span> <span class='op'>&amp;&amp;</span> <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="any?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>any?</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


322
323
324
325
326
327
328</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/associations/association_collection.rb', line 322</span>

<span class='kw'>def</span> <span class='id any?'>any?</span>
  <span class='kw'>if</span> <span class='id block_given?'>block_given?</span>
    <span class='id method_missing'>method_missing</span><span class='lparen'>(</span><span class='symbol'>:any?</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='op'>*</span><span class='id block_args'>block_args</span><span class='op'>|</span> <span class='kw'>yield</span><span class='lparen'>(</span><span class='op'>*</span><span class='id block_args'>block_args</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
  <span class='kw'>else</span>
    <span class='op'>!</span><span class='id empty?'>empty?</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="build-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>build</strong>(attributes = {}, &amp;block) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


115
116
117
118
119
120
121
122
123
124</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/associations/association_collection.rb', line 115</span>

<span class='kw'>def</span> <span class='id build'>build</span><span class='lparen'>(</span><span class='id attributes'>attributes</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id block'>block</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id attributes'>attributes</span><span class='period'>.</span><span class='id is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Array</span><span class='rparen'>)</span>
    <span class='id attributes'>attributes</span><span class='period'>.</span><span class='id collect'>collect</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id attr'>attr</span><span class='op'>|</span> <span class='id build'>build</span><span class='lparen'>(</span><span class='id attr'>attr</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id block'>block</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
  <span class='kw'>else</span>
    <span class='id build_record'>build_record</span><span class='lparen'>(</span><span class='id attributes'>attributes</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id record'>record</span><span class='op'>|</span>
      <span class='id block'>block</span><span class='period'>.</span><span class='id call'>call</span><span class='lparen'>(</span><span class='id record'>record</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id block_given?'>block_given?</span>
      <span class='id set_belongs_to_association_for'>set_belongs_to_association_for</span><span class='lparen'>(</span><span class='id record'>record</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="clear-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>clear</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Removes all records from this association.  Returns <tt>self</tt> so method
calls may be chained.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


242
243
244
245
246
247
248
249
250
251
252</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/associations/association_collection.rb', line 242</span>

<span class='kw'>def</span> <span class='id clear'>clear</span>
  <span class='kw'>return</span> <span class='kw'>self</span> <span class='kw'>if</span> <span class='id length'>length</span><span class='period'>.</span><span class='id zero?'>zero?</span> <span class='comment'># forces load_target if it hasn't happened already
</span>
  <span class='kw'>if</span> <span class='ivar'>@reflection</span><span class='period'>.</span><span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:dependent</span><span class='rbracket'>]</span> <span class='op'>&amp;&amp;</span> <span class='ivar'>@reflection</span><span class='period'>.</span><span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:dependent</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='symbol'>:destroy</span>
    <span class='id destroy_all'>destroy_all</span>
  <span class='kw'>else</span>
    <span class='id delete_all'>delete_all</span>
  <span class='kw'>end</span>

  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="count-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>count</strong>(column_name = nil, options = {}) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Count all records using SQL. If the <tt>:counter_sql</tt> option is set for
the association, it will be used for the query. If no <tt>:counter_sql</tt>
was supplied, but <tt>:finder_sql</tt> was set, the descendant&#8217;s
<tt>construct_sql</tt> method will have set :counter_sql automatically.
Otherwise, construct options and pass them with scope to the target
class&#8217;s <tt>count</tt>.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/associations/association_collection.rb', line 185</span>

<span class='kw'>def</span> <span class='id count'>count</span><span class='lparen'>(</span><span class='id column_name'>column_name</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id column_name'>column_name</span><span class='comma'>,</span> <span class='id options'>options</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id column_name'>column_name</span> <span class='kw'>if</span> <span class='id column_name'>column_name</span><span class='period'>.</span><span class='id is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Hash</span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='ivar'>@reflection</span><span class='period'>.</span><span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:counter_sql</span><span class='rbracket'>]</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id options'>options</span><span class='period'>.</span><span class='id blank?'>blank?</span>
    <span class='id raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>If finder_sql/counter_sql is used then options cannot be passed</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>elsif</span> <span class='ivar'>@reflection</span><span class='period'>.</span><span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:counter_sql</span><span class='rbracket'>]</span>
    <span class='ivar'>@reflection</span><span class='period'>.</span><span class='id klass'>klass</span><span class='period'>.</span><span class='id count_by_sql'>count_by_sql</span><span class='lparen'>(</span><span class='ivar'>@counter_sql</span><span class='rparen'>)</span>
  <span class='kw'>else</span>

    <span class='kw'>if</span> <span class='ivar'>@reflection</span><span class='period'>.</span><span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:uniq</span><span class='rbracket'>]</span>
      <span class='comment'># This is needed because 'SELECT count(DISTINCT *)..' is not valid SQL.
</span>      <span class='id column_name'>column_name</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='ivar'>@reflection</span><span class='period'>.</span><span class='id quoted_table_name'>quoted_table_name</span><span class='rbrace'>}</span><span class='tstring_content'>.</span><span class='embexpr_beg'>#{</span><span class='ivar'>@reflection</span><span class='period'>.</span><span class='id klass'>klass</span><span class='period'>.</span><span class='id primary_key'>primary_key</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id column_name'>column_name</span>
      <span class='id options'>options</span><span class='period'>.</span><span class='id merge!'>merge!</span><span class='lparen'>(</span><span class='symbol'>:distinct</span> <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='id value'>value</span> <span class='op'>=</span> <span class='ivar'>@reflection</span><span class='period'>.</span><span class='id klass'>klass</span><span class='period'>.</span><span class='id send'>send</span><span class='lparen'>(</span><span class='symbol'>:with_scope</span><span class='comma'>,</span> <span class='id construct_scope'>construct_scope</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='ivar'>@reflection</span><span class='period'>.</span><span class='id klass'>klass</span><span class='period'>.</span><span class='id count'>count</span><span class='lparen'>(</span><span class='id column_name'>column_name</span><span class='comma'>,</span> <span class='id options'>options</span><span class='rparen'>)</span> <span class='rbrace'>}</span>

    <span class='id limit'>limit</span>  <span class='op'>=</span> <span class='ivar'>@reflection</span><span class='period'>.</span><span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:limit</span><span class='rbracket'>]</span>
    <span class='id offset'>offset</span> <span class='op'>=</span> <span class='ivar'>@reflection</span><span class='period'>.</span><span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:offset</span><span class='rbracket'>]</span>

    <span class='kw'>if</span> <span class='id limit'>limit</span> <span class='op'>||</span> <span class='id offset'>offset</span>
      <span class='lbracket'>[</span> <span class='lbracket'>[</span><span class='id value'>value</span> <span class='op'>-</span> <span class='id offset'>offset</span><span class='period'>.</span><span class='id to_i'>to_i</span><span class='comma'>,</span> <span class='int'>0</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id max'>max</span><span class='comma'>,</span> <span class='id limit'>limit</span><span class='period'>.</span><span class='id to_i'>to_i</span> <span class='rbracket'>]</span><span class='period'>.</span><span class='id min'>min</span>
    <span class='kw'>else</span>
      <span class='id value'>value</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="create-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>create</strong>(attrs = {}) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


265
266
267
268
269
270
271
272
273
274</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/associations/association_collection.rb', line 265</span>

<span class='kw'>def</span> <span class='id create'>create</span><span class='lparen'>(</span><span class='id attrs'>attrs</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id attrs'>attrs</span><span class='period'>.</span><span class='id is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Array</span><span class='rparen'>)</span>
    <span class='id attrs'>attrs</span><span class='period'>.</span><span class='id collect'>collect</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id attr'>attr</span><span class='op'>|</span> <span class='id create'>create</span><span class='lparen'>(</span><span class='id attr'>attr</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
  <span class='kw'>else</span>
    <span class='id create_record'>create_record</span><span class='lparen'>(</span><span class='id attrs'>attrs</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id record'>record</span><span class='op'>|</span>
      <span class='kw'>yield</span><span class='lparen'>(</span><span class='id record'>record</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id block_given?'>block_given?</span>
      <span class='id record'>record</span><span class='period'>.</span><span class='id save'>save</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="create!-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>create!</strong>(attrs = {}) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


276
277
278
279
280
281</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/associations/association_collection.rb', line 276</span>

<span class='kw'>def</span> <span class='id create!'>create!</span><span class='lparen'>(</span><span class='id attrs'>attrs</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id create_record'>create_record</span><span class='lparen'>(</span><span class='id attrs'>attrs</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id record'>record</span><span class='op'>|</span>
    <span class='kw'>yield</span><span class='lparen'>(</span><span class='id record'>record</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id block_given?'>block_given?</span>
    <span class='id record'>record</span><span class='period'>.</span><span class='id save!'>save!</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="delete-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>delete</strong>(*records) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Removes <tt>records</tt> from this association calling
<tt>before_remove</tt> and <tt>after_remove</tt> callbacks.
</p>
<p>
This method is abstract in the sense that <tt>delete_records</tt> has to be
provided by descendants. Note this method does not imply the records are
actually removed from the database, that depends precisely on
<tt>delete_records</tt>. They are in any case removed from the collection.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


220
221
222
223
224
225</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/associations/association_collection.rb', line 220</span>

<span class='kw'>def</span> <span class='id delete'>delete</span><span class='lparen'>(</span><span class='op'>*</span><span class='id records'>records</span><span class='rparen'>)</span>
  <span class='id remove_records'>remove_records</span><span class='lparen'>(</span><span class='id records'>records</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id _records'>_records</span><span class='comma'>,</span> <span class='id old_records'>old_records</span><span class='op'>|</span>
    <span class='id delete_records'>delete_records</span><span class='lparen'>(</span><span class='id old_records'>old_records</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id old_records'>old_records</span><span class='period'>.</span><span class='id any?'>any?</span>
    <span class='id _records'>_records</span><span class='period'>.</span><span class='id each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id record'>record</span><span class='op'>|</span> <span class='ivar'>@target</span><span class='period'>.</span><span class='id delete'>delete</span><span class='lparen'>(</span><span class='id record'>record</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="delete_all-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>delete_all</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Remove all records from this association
</p>
<p>
See delete for more info.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


165
166
167
168
169
170</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/associations/association_collection.rb', line 165</span>

<span class='kw'>def</span> <span class='id delete_all'>delete_all</span>
  <span class='id load_target'>load_target</span>
  <span class='id delete'>delete</span><span class='lparen'>(</span><span class='ivar'>@target</span><span class='rparen'>)</span>
  <span class='id reset_target!'>reset_target!</span>
  <span class='id reset_named_scopes_cache!'>reset_named_scopes_cache!</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="destroy-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>destroy</strong>(*records) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Destroy <tt>records</tt> and remove them from this association calling
<tt>before_remove</tt> and <tt>after_remove</tt> callbacks.
</p>
<p>
Note that this method will <em>always</em> remove records from the database
ignoring the <tt>:dependent</tt> option.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


232
233
234
235
236
237
238
239</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/associations/association_collection.rb', line 232</span>

<span class='kw'>def</span> <span class='id destroy'>destroy</span><span class='lparen'>(</span><span class='op'>*</span><span class='id records'>records</span><span class='rparen'>)</span>
  <span class='id records'>records</span> <span class='op'>=</span> <span class='id find'>find</span><span class='lparen'>(</span><span class='id records'>records</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id records'>records</span><span class='period'>.</span><span class='id any?'>any?</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id record'>record</span><span class='op'>|</span> <span class='id record'>record</span><span class='period'>.</span><span class='id kind_of?'>kind_of?</span><span class='lparen'>(</span><span class='const'>Fixnum</span><span class='rparen'>)</span> <span class='op'>||</span> <span class='id record'>record</span><span class='period'>.</span><span class='id kind_of?'>kind_of?</span><span class='lparen'>(</span><span class='const'>String</span><span class='rparen'>)</span><span class='rbrace'>}</span>
  <span class='id remove_records'>remove_records</span><span class='lparen'>(</span><span class='id records'>records</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id _records'>_records</span><span class='comma'>,</span> <span class='id old_records'>old_records</span><span class='op'>|</span>
    <span class='id old_records'>old_records</span><span class='period'>.</span><span class='id each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id record'>record</span><span class='op'>|</span> <span class='id record'>record</span><span class='period'>.</span><span class='id destroy'>destroy</span> <span class='rbrace'>}</span>
  <span class='kw'>end</span>

  <span class='id load_target'>load_target</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="destroy_all-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>destroy_all</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Destroy all the records from this association.
</p>
<p>
See destroy for more info.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


257
258
259
260
261
262
263</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/associations/association_collection.rb', line 257</span>

<span class='kw'>def</span> <span class='id destroy_all'>destroy_all</span>
  <span class='id load_target'>load_target</span>
  <span class='id destroy'>destroy</span><span class='lparen'>(</span><span class='ivar'>@target</span><span class='rparen'>)</span><span class='period'>.</span><span class='id tap'>tap</span> <span class='kw'>do</span>
    <span class='id reset_target!'>reset_target!</span>
    <span class='id reset_named_scopes_cache!'>reset_named_scopes_cache!</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="empty?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>empty?</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Equivalent to <tt>collection.size.zero?</tt>. If the collection has not
been already loaded and you are going to fetch the records anyway it is
better to check <tt>collection.length.zero?</tt>.
</p>


  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


318
319
320</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/associations/association_collection.rb', line 318</span>

<span class='kw'>def</span> <span class='id empty?'>empty?</span>
  <span class='id size'>size</span><span class='period'>.</span><span class='id zero?'>zero?</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="find-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>find</strong>(*args) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/associations/association_collection.rb', line 42</span>

<span class='kw'>def</span> <span class='id find'>find</span><span class='lparen'>(</span><span class='op'>*</span><span class='id args'>args</span><span class='rparen'>)</span>
  <span class='id options'>options</span> <span class='op'>=</span> <span class='id args'>args</span><span class='period'>.</span><span class='id extract_options!'>extract_options!</span>

  <span class='comment'># If using a custom finder_sql, scan the entire collection.
</span>  <span class='kw'>if</span> <span class='ivar'>@reflection</span><span class='period'>.</span><span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:finder_sql</span><span class='rbracket'>]</span>
    <span class='id expects_array'>expects_array</span> <span class='op'>=</span> <span class='id args'>args</span><span class='period'>.</span><span class='id first'>first</span><span class='period'>.</span><span class='id kind_of?'>kind_of?</span><span class='lparen'>(</span><span class='const'>Array</span><span class='rparen'>)</span>
    <span class='id ids'>ids</span>           <span class='op'>=</span> <span class='id args'>args</span><span class='period'>.</span><span class='id flatten'>flatten</span><span class='period'>.</span><span class='id compact'>compact</span><span class='period'>.</span><span class='id uniq'>uniq</span><span class='period'>.</span><span class='id map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id arg'>arg</span><span class='op'>|</span> <span class='id arg'>arg</span><span class='period'>.</span><span class='id to_i'>to_i</span> <span class='rbrace'>}</span>

    <span class='kw'>if</span> <span class='id ids'>ids</span><span class='period'>.</span><span class='id size'>size</span> <span class='op'>==</span> <span class='int'>1</span>
      <span class='id id'>id</span> <span class='op'>=</span> <span class='id ids'>ids</span><span class='period'>.</span><span class='id first'>first</span>
      <span class='id record'>record</span> <span class='op'>=</span> <span class='id load_target'>load_target</span><span class='period'>.</span><span class='id detect'>detect</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id r'>r</span><span class='op'>|</span> <span class='id id'>id</span> <span class='op'>==</span> <span class='id r'>r</span><span class='period'>.</span><span class='id id'>id</span> <span class='rbrace'>}</span>
      <span class='id expects_array'>expects_array</span> <span class='op'>?</span> <span class='lbracket'>[</span> <span class='id record'>record</span> <span class='rbracket'>]</span> <span class='op'>:</span> <span class='id record'>record</span>
    <span class='kw'>else</span>
      <span class='id load_target'>load_target</span><span class='period'>.</span><span class='id select'>select</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id r'>r</span><span class='op'>|</span> <span class='id ids'>ids</span><span class='period'>.</span><span class='id include?'>include?</span><span class='lparen'>(</span><span class='id r'>r</span><span class='period'>.</span><span class='id id'>id</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='id merge_options_from_reflection!'>merge_options_from_reflection!</span><span class='lparen'>(</span><span class='id options'>options</span><span class='rparen'>)</span>
    <span class='id construct_find_options!'>construct_find_options!</span><span class='lparen'>(</span><span class='id options'>options</span><span class='rparen'>)</span>

    <span class='id find_scope'>find_scope</span> <span class='op'>=</span> <span class='id construct_scope'>construct_scope</span><span class='lbracket'>[</span><span class='symbol'>:find</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id slice'>slice</span><span class='lparen'>(</span><span class='symbol'>:conditions</span><span class='comma'>,</span> <span class='symbol'>:order</span><span class='rparen'>)</span>

    <span class='id with_scope'>with_scope</span><span class='lparen'>(</span><span class='symbol'>:find</span> <span class='op'>=&gt;</span> <span class='id find_scope'>find_scope</span><span class='rparen'>)</span> <span class='kw'>do</span>
      <span class='id relation'>relation</span> <span class='op'>=</span> <span class='ivar'>@reflection</span><span class='period'>.</span><span class='id klass'>klass</span><span class='period'>.</span><span class='id send'>send</span><span class='lparen'>(</span><span class='symbol'>:construct_finder_arel</span><span class='comma'>,</span> <span class='id options'>options</span><span class='comma'>,</span> <span class='ivar'>@reflection</span><span class='period'>.</span><span class='id klass'>klass</span><span class='period'>.</span><span class='id send'>send</span><span class='lparen'>(</span><span class='symbol'>:current_scoped_methods</span><span class='rparen'>)</span><span class='rparen'>)</span>

      <span class='kw'>case</span> <span class='id args'>args</span><span class='period'>.</span><span class='id first'>first</span>
      <span class='kw'>when</span> <span class='symbol'>:first</span><span class='comma'>,</span> <span class='symbol'>:last</span>
        <span class='id relation'>relation</span><span class='period'>.</span><span class='id send'>send</span><span class='lparen'>(</span><span class='id args'>args</span><span class='period'>.</span><span class='id first'>first</span><span class='rparen'>)</span>
      <span class='kw'>when</span> <span class='symbol'>:all</span>
        <span class='id records'>records</span> <span class='op'>=</span> <span class='id relation'>relation</span><span class='period'>.</span><span class='id all'>all</span>
        <span class='ivar'>@reflection</span><span class='period'>.</span><span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:uniq</span><span class='rbracket'>]</span> <span class='op'>?</span> <span class='id uniq'>uniq</span><span class='lparen'>(</span><span class='id records'>records</span><span class='rparen'>)</span> <span class='op'>:</span> <span class='id records'>records</span>
      <span class='kw'>else</span>
        <span class='id relation'>relation</span><span class='period'>.</span><span class='id find'>find</span><span class='lparen'>(</span><span class='op'>*</span><span class='id args'>args</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="first-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>first</strong>(*args) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Fetches the first one using SQL if possible.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


80
81
82
83
84
85
86
87</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/associations/association_collection.rb', line 80</span>

<span class='kw'>def</span> <span class='id first'>first</span><span class='lparen'>(</span><span class='op'>*</span><span class='id args'>args</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id fetch_first_or_last_using_find?'>fetch_first_or_last_using_find?</span><span class='lparen'>(</span><span class='id args'>args</span><span class='rparen'>)</span>
    <span class='id find'>find</span><span class='lparen'>(</span><span class='symbol'>:first</span><span class='comma'>,</span> <span class='op'>*</span><span class='id args'>args</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='id load_target'>load_target</span> <span class='kw'>unless</span> <span class='id loaded?'>loaded?</span>
    <span class='ivar'>@target</span><span class='period'>.</span><span class='id first'>first</span><span class='lparen'>(</span><span class='op'>*</span><span class='id args'>args</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="include?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>include?</strong>(record) 
  

  
</p><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


365
366
367
368
369
370</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/associations/association_collection.rb', line 365</span>

<span class='kw'>def</span> <span class='id include?'>include?</span><span class='lparen'>(</span><span class='id record'>record</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>unless</span> <span class='id record'>record</span><span class='period'>.</span><span class='id is_a?'>is_a?</span><span class='lparen'>(</span><span class='ivar'>@reflection</span><span class='period'>.</span><span class='id klass'>klass</span><span class='rparen'>)</span>
  <span class='id load_target'>load_target</span> <span class='kw'>if</span> <span class='ivar'>@reflection</span><span class='period'>.</span><span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:finder_sql</span><span class='rbracket'>]</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id loaded?'>loaded?</span>
  <span class='kw'>return</span> <span class='ivar'>@target</span><span class='period'>.</span><span class='id include?'>include?</span><span class='lparen'>(</span><span class='id record'>record</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id loaded?'>loaded?</span>
  <span class='id exists?'>exists?</span><span class='lparen'>(</span><span class='id record'>record</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="last-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>last</strong>(*args) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Fetches the last one using SQL if possible.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


90
91
92
93
94
95
96
97</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/associations/association_collection.rb', line 90</span>

<span class='kw'>def</span> <span class='id last'>last</span><span class='lparen'>(</span><span class='op'>*</span><span class='id args'>args</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id fetch_first_or_last_using_find?'>fetch_first_or_last_using_find?</span><span class='lparen'>(</span><span class='id args'>args</span><span class='rparen'>)</span>
    <span class='id find'>find</span><span class='lparen'>(</span><span class='symbol'>:last</span><span class='comma'>,</span> <span class='op'>*</span><span class='id args'>args</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='id load_target'>load_target</span> <span class='kw'>unless</span> <span class='id loaded?'>loaded?</span>
    <span class='ivar'>@target</span><span class='period'>.</span><span class='id last'>last</span><span class='lparen'>(</span><span class='op'>*</span><span class='id args'>args</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="length-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>length</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns the size of the collection calling <tt>size</tt> on the target.
</p>
<p>
If the collection has been already loaded <tt>length</tt> and <tt>size</tt>
are equivalent. If not and you are going to need the records anyway this
method will take one less query. Otherwise <tt>size</tt> is more efficient.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


311
312
313</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/associations/association_collection.rb', line 311</span>

<span class='kw'>def</span> <span class='id length'>length</span>
  <span class='id load_target'>load_target</span><span class='period'>.</span><span class='id size'>size</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="many?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>many?</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns true if the collection has more than 1 record. Equivalent to
collection.size > 1.
</p>


  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


331
332
333
334
335
336
337</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/associations/association_collection.rb', line 331</span>

<span class='kw'>def</span> <span class='id many?'>many?</span>
  <span class='kw'>if</span> <span class='id block_given?'>block_given?</span>
    <span class='id method_missing'>method_missing</span><span class='lparen'>(</span><span class='symbol'>:many?</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='op'>*</span><span class='id block_args'>block_args</span><span class='op'>|</span> <span class='kw'>yield</span><span class='lparen'>(</span><span class='op'>*</span><span class='id block_args'>block_args</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
  <span class='kw'>else</span>
    <span class='id size'>size</span> <span class='op'>&gt;</span> <span class='int'>1</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="proxy_respond_to?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>proxy_respond_to?</strong>(method, include_private = false) 
  

  
</p><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


372
373
374</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/associations/association_collection.rb', line 372</span>

<span class='kw'>def</span> <span class='id proxy_respond_to?'>proxy_respond_to?</span><span class='lparen'>(</span><span class='id method'>method</span><span class='comma'>,</span> <span class='id include_private'>include_private</span> <span class='op'>=</span> <span class='kw'>false</span><span class='rparen'>)</span>
  <span class='kw'>super</span> <span class='op'>||</span> <span class='ivar'>@reflection</span><span class='period'>.</span><span class='id klass'>klass</span><span class='period'>.</span><span class='id respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='id method'>method</span><span class='comma'>,</span> <span class='id include_private'>include_private</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="replace-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>replace</strong>(other_array) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Replace this collection with <tt>other_array</tt> This will perform a diff
and delete/add only records that have changed.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


352
353
354
355
356
357
358
359
360
361
362
363</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/associations/association_collection.rb', line 352</span>

<span class='kw'>def</span> <span class='id replace'>replace</span><span class='lparen'>(</span><span class='id other_array'>other_array</span><span class='rparen'>)</span>
  <span class='id other_array'>other_array</span><span class='period'>.</span><span class='id each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id val'>val</span><span class='op'>|</span> <span class='id raise_on_type_mismatch'>raise_on_type_mismatch</span><span class='lparen'>(</span><span class='id val'>val</span><span class='rparen'>)</span> <span class='rbrace'>}</span>

  <span class='id load_target'>load_target</span>
  <span class='id other'>other</span>   <span class='op'>=</span> <span class='id other_array'>other_array</span><span class='period'>.</span><span class='id size'>size</span> <span class='op'>&lt;</span> <span class='int'>100</span> <span class='op'>?</span> <span class='id other_array'>other_array</span> <span class='op'>:</span> <span class='id other_array'>other_array</span><span class='period'>.</span><span class='id to_set'>to_set</span>
  <span class='id current'>current</span> <span class='op'>=</span> <span class='ivar'>@target</span><span class='period'>.</span><span class='id size'>size</span> <span class='op'>&lt;</span> <span class='int'>100</span> <span class='op'>?</span> <span class='ivar'>@target</span> <span class='op'>:</span> <span class='ivar'>@target</span><span class='period'>.</span><span class='id to_set'>to_set</span>

  <span class='id transaction'>transaction</span> <span class='kw'>do</span>
    <span class='id delete'>delete</span><span class='lparen'>(</span><span class='ivar'>@target</span><span class='period'>.</span><span class='id select'>select</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id v'>v</span><span class='op'>|</span> <span class='op'>!</span><span class='id other'>other</span><span class='period'>.</span><span class='id include?'>include?</span><span class='lparen'>(</span><span class='id v'>v</span><span class='rparen'>)</span> <span class='rbrace'>}</span><span class='rparen'>)</span>
    <span class='id concat'>concat</span><span class='lparen'>(</span><span class='id other_array'>other_array</span><span class='period'>.</span><span class='id select'>select</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id v'>v</span><span class='op'>|</span> <span class='op'>!</span><span class='id current'>current</span><span class='period'>.</span><span class='id include?'>include?</span><span class='lparen'>(</span><span class='id v'>v</span><span class='rparen'>)</span> <span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="reset-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>reset</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


109
110
111
112
113</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/associations/association_collection.rb', line 109</span>

<span class='kw'>def</span> <span class='id reset'>reset</span>
  <span class='id reset_target!'>reset_target!</span>
  <span class='id reset_named_scopes_cache!'>reset_named_scopes_cache!</span>
  <span class='ivar'>@loaded</span> <span class='op'>=</span> <span class='kw'>false</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="scoped-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>scoped</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


38
39
40</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/associations/association_collection.rb', line 38</span>

<span class='kw'>def</span> <span class='id scoped'>scoped</span>
  <span class='id with_scope'>with_scope</span><span class='lparen'>(</span><span class='id construct_scope'>construct_scope</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='ivar'>@reflection</span><span class='period'>.</span><span class='id klass'>klass</span><span class='period'>.</span><span class='id scoped'>scoped</span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="select-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>select</strong>(select = nil) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


29
30
31
32
33
34
35
36</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/associations/association_collection.rb', line 29</span>

<span class='kw'>def</span> <span class='id select'>select</span><span class='lparen'>(</span><span class='id select'>select</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id block_given?'>block_given?</span>
    <span class='id load_target'>load_target</span>
    <span class='ivar'>@target</span><span class='period'>.</span><span class='id select'>select</span><span class='period'>.</span><span class='id each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id e'>e</span><span class='op'>|</span> <span class='kw'>yield</span> <span class='id e'>e</span> <span class='rbrace'>}</span>
  <span class='kw'>else</span>
    <span class='id scoped'>scoped</span><span class='period'>.</span><span class='id select'>select</span><span class='lparen'>(</span><span class='id select'>select</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="size-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>size</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns the size of the collection by executing a SELECT COUNT(*) query if
the collection hasn&#8217;t been loaded, and calling
<tt>collection.size</tt> if it has.
</p>
<p>
If the collection has been already loaded <tt>size</tt> and <tt>length</tt>
are equivalent. If not and you are going to need the records anyway
<tt>length</tt> will take one less query. Otherwise <tt>size</tt> is more
efficient.
</p>
<p>
This method is abstract in the sense that it relies on
<tt>count_records</tt>, which is a method descendants have to provide.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


293
294
295
296
297
298
299
300
301
302
303
304</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/associations/association_collection.rb', line 293</span>

<span class='kw'>def</span> <span class='id size'>size</span>
  <span class='kw'>if</span> <span class='ivar'>@owner</span><span class='period'>.</span><span class='id new_record?'>new_record?</span> <span class='op'>||</span> <span class='lparen'>(</span><span class='id loaded?'>loaded?</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='ivar'>@reflection</span><span class='period'>.</span><span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:uniq</span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='ivar'>@target</span><span class='period'>.</span><span class='id size'>size</span>
  <span class='kw'>elsif</span> <span class='op'>!</span><span class='id loaded?'>loaded?</span> <span class='op'>&amp;&amp;</span> <span class='ivar'>@reflection</span><span class='period'>.</span><span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:group</span><span class='rbracket'>]</span>
    <span class='id load_target'>load_target</span><span class='period'>.</span><span class='id size'>size</span>
  <span class='kw'>elsif</span> <span class='op'>!</span><span class='id loaded?'>loaded?</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='ivar'>@reflection</span><span class='period'>.</span><span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:uniq</span><span class='rbracket'>]</span> <span class='op'>&amp;&amp;</span> <span class='ivar'>@target</span><span class='period'>.</span><span class='id is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Array</span><span class='rparen'>)</span>
    <span class='id unsaved_records'>unsaved_records</span> <span class='op'>=</span> <span class='ivar'>@target</span><span class='period'>.</span><span class='id select'>select</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id r'>r</span><span class='op'>|</span> <span class='id r'>r</span><span class='period'>.</span><span class='id new_record?'>new_record?</span> <span class='rbrace'>}</span>
    <span class='id unsaved_records'>unsaved_records</span><span class='period'>.</span><span class='id size'>size</span> <span class='op'>+</span> <span class='id count_records'>count_records</span>
  <span class='kw'>else</span>
    <span class='id count_records'>count_records</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="sum-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>sum</strong>(*args) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Calculate sum using SQL, not Enumerable
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


173
174
175
176
177
178
179</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/associations/association_collection.rb', line 173</span>

<span class='kw'>def</span> <span class='id sum'>sum</span><span class='lparen'>(</span><span class='op'>*</span><span class='id args'>args</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id block_given?'>block_given?</span>
    <span class='id calculate'>calculate</span><span class='lparen'>(</span><span class='symbol'>:sum</span><span class='comma'>,</span> <span class='op'>*</span><span class='id args'>args</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='op'>*</span><span class='id block_args'>block_args</span><span class='op'>|</span> <span class='kw'>yield</span><span class='lparen'>(</span><span class='op'>*</span><span class='id block_args'>block_args</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
  <span class='kw'>else</span>
    <span class='id calculate'>calculate</span><span class='lparen'>(</span><span class='symbol'>:sum</span><span class='comma'>,</span> <span class='op'>*</span><span class='id args'>args</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="to_ary-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>to_ary</strong> 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='to_a-instance_method'>to_a</span></span>
    </span>
  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


99
100
101
102
103
104
105
106</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/associations/association_collection.rb', line 99</span>

<span class='kw'>def</span> <span class='id to_ary'>to_ary</span>
  <span class='id load_target'>load_target</span>
  <span class='kw'>if</span> <span class='ivar'>@target</span><span class='period'>.</span><span class='id is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Array</span><span class='rparen'>)</span>
    <span class='ivar'>@target</span><span class='period'>.</span><span class='id to_ary'>to_ary</span>
  <span class='kw'>else</span>
    <span class='const'>Array</span><span class='period'>.</span><span class='id wrap'>wrap</span><span class='lparen'>(</span><span class='ivar'>@target</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="transaction-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>transaction</strong>(*args) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Starts a transaction in the association class&#8217;s database connection.
</p>
<pre class="code">
  <span class='kw'>class</span> <span class='const'>Author</span> <span class='op'>&lt;</span> <span class='const'>ActiveRecord</span><span class='op'>::</span><span class='const'>Base</span>
    <span class='id has_many'>has_many</span> <span class='symbol'>:books</span>
  <span class='kw'>end</span>

  <span class='const'>Author</span><span class='period'>.</span><span class='id first'>first</span><span class='period'>.</span><span class='id books'>books</span><span class='period'>.</span><span class='id transaction'>transaction</span> <span class='kw'>do</span>
    <span class='comment'># same effect as calling Book.transaction
</span>  <span class='kw'>end</span></pre>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


156
157
158
159
160</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/associations/association_collection.rb', line 156</span>

<span class='kw'>def</span> <span class='id transaction'>transaction</span><span class='lparen'>(</span><span class='op'>*</span><span class='id args'>args</span><span class='rparen'>)</span>
  <span class='ivar'>@reflection</span><span class='period'>.</span><span class='id klass'>klass</span><span class='period'>.</span><span class='id transaction'>transaction</span><span class='lparen'>(</span><span class='op'>*</span><span class='id args'>args</span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='kw'>yield</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="uniq-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>uniq</strong>(collection = self) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


339
340
341
342
343
344
345
346
347
348</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/associations/association_collection.rb', line 339</span>

<span class='kw'>def</span> <span class='id uniq'>uniq</span><span class='lparen'>(</span><span class='id collection'>collection</span> <span class='op'>=</span> <span class='kw'>self</span><span class='rparen'>)</span>
  <span class='id seen'>seen</span> <span class='op'>=</span> <span class='const'>Set</span><span class='period'>.</span><span class='id new'>new</span>
  <span class='id collection'>collection</span><span class='period'>.</span><span class='id inject'>inject</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id kept'>kept</span><span class='comma'>,</span> <span class='id record'>record</span><span class='op'>|</span>
    <span class='kw'>unless</span> <span class='id seen'>seen</span><span class='period'>.</span><span class='id include?'>include?</span><span class='lparen'>(</span><span class='id record'>record</span><span class='period'>.</span><span class='id id'>id</span><span class='rparen'>)</span>
      <span class='id kept'>kept</span> <span class='op'>&lt;&lt;</span> <span class='id record'>record</span>
      <span class='id seen'>seen</span> <span class='op'>&lt;&lt;</span> <span class='id record'>record</span><span class='period'>.</span><span class='id id'>id</span>
    <span class='kw'>end</span>
    <span class='id kept'>kept</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>
    
    <div id="footer">
  Generated on Thu Nov  4 20:04:28 2010 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.6.1 (ruby-1.9.2).
</div>

  </body>
</html>