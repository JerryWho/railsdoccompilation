<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta name="Content-Type" content="text/html; charset=utf-8" />
<title>Module: ActiveRecord::Persistence</title>
<link rel="stylesheet" href="../css/style.css" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '..';
  if (relpath != '') relpath += '/';
</script>
<script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/app.js"></script>

  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="../_index.html">Index (P)</a> &raquo; 
    <span class='title'><span class='object_link'><a href="../ActiveRecord.html" title="ActiveRecord (module)">ActiveRecord</a></span></span>
     &raquo; 
    <span class="title">Persistence</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  <a id="class_list_link" href="#">Class List</a>
  <a id="method_list_link" href="#">Method List</a>
  <a id ="file_list_link" href="#">File List</a>
</div>

      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><h1>Module: ActiveRecord::Persistence
  
  
  
</h1>

<dl class="box">
  
  
    
  
    
  
  
  
    <dt class="r1 last">Defined in:</dt>
    <dd class="r1 last">activerecord/lib/active_record/persistence.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <h1>Active Record Persistence</h1>


  </div>
</div>
<div class="tags">
  
</div>


  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#becomes-instance_method" title="#becomes (instance method)">- (Object) <strong>becomes</strong>(klass) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns an instance of the specified <tt>klass</tt> with the attributes of
the current record.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#decrement-instance_method" title="#decrement (instance method)">- (Object) <strong>decrement</strong>(attribute, by = 1) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Initializes <tt>attribute</tt> to zero if <tt>nil</tt> and subtracts the
value passed as <tt>by</tt> (default is 1).
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#decrement%21-instance_method" title="#decrement! (instance method)">- (Object) <strong>decrement!</strong>(attribute, by = 1) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Wrapper around <tt>decrement</tt> that saves the record.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#delete-instance_method" title="#delete (instance method)">- (Object) <strong>delete</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Deletes the record in the database and freezes this instance to reflect
that no changes should be made (since they can&#8217;t be persisted).
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#destroy-instance_method" title="#destroy (instance method)">- (Object) <strong>destroy</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Deletes the record in the database and freezes this instance to reflect
that no changes should be made (since they can&#8217;t be persisted).
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#destroyed%3F-instance_method" title="#destroyed? (instance method)">- (Boolean) <strong>destroyed?</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns true if this object has been destroyed, otherwise returns false.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#increment-instance_method" title="#increment (instance method)">- (Object) <strong>increment</strong>(attribute, by = 1) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Initializes <tt>attribute</tt> to zero if <tt>nil</tt> and adds the value
passed as <tt>by</tt> (default is 1).
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#increment%21-instance_method" title="#increment! (instance method)">- (Object) <strong>increment!</strong>(attribute, by = 1) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Wrapper around <tt>increment</tt> that saves the record.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#new_record%3F-instance_method" title="#new_record? (instance method)">- (Boolean) <strong>new_record?</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns true if this object hasn&#8217;t been saved yet &#8212; that is, a
record for the object doesn&#8217;t exist in the data store yet; otherwise,
returns false.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#persisted%3F-instance_method" title="#persisted? (instance method)">- (Boolean) <strong>persisted?</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns if the record is persisted, i.e.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#reload-instance_method" title="#reload (instance method)">- (Object) <strong>reload</strong>(options = nil) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Reloads the attributes of this object from the database.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#save-instance_method" title="#save (instance method)">- (Object) <strong>save</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
:call-seq:.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#save%21-instance_method" title="#save! (instance method)">- (Object) <strong>save!</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Saves the model.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#toggle-instance_method" title="#toggle (instance method)">- (Object) <strong>toggle</strong>(attribute) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Assigns to <tt>attribute</tt> the boolean opposite of <tt>attribute?</tt>.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#toggle%21-instance_method" title="#toggle! (instance method)">- (Object) <strong>toggle!</strong>(attribute) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Wrapper around <tt>toggle</tt> that saves the record.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#touch-instance_method" title="#touch (instance method)">- (Object) <strong>touch</strong>(name = nil) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Saves the record with the updated_at/on attributes set to the current time.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#update_attribute-instance_method" title="#update_attribute (instance method)">- (Object) <strong>update_attribute</strong>(name, value) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Updates a single attribute and saves the record.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#update_attributes-instance_method" title="#update_attributes (instance method)">- (Object) <strong>update_attributes</strong>(attributes) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Updates the attributes of the model from the passed-in hash and saves the
record, all wrapped in a transaction.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#update_attributes%21-instance_method" title="#update_attributes! (instance method)">- (Object) <strong>update_attributes!</strong>(attributes) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Updates its receiver just like <tt>update_attributes</tt> but calls
<tt>save!</tt> instead of <tt>save</tt>, so an exception is raised if the
record is invalid.
</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="becomes-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>becomes</strong>(klass) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns an instance of the specified <tt>klass</tt> with the attributes of
the current record. This is mostly useful in relation to single-table
inheritance structures where you want a subclass to appear as the
superclass. This can be used along with record identification in Action
Pack to allow, say, <tt>Client &lt; Company</tt> to do something like
render <tt>:partial =&gt; @client.becomes(Company)</tt> to render that
instance using the companies/company partial instead of clients/client.
</p>
<p>
Note: The new instance will share a link to the same attributes as the
original class. So any change to the attributes in either instance will
affect the other.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


96
97
98
99
100
101
102
103</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/persistence.rb', line 96</span>

<span class='kw'>def</span> <span class='id becomes'>becomes</span><span class='lparen'>(</span><span class='id klass'>klass</span><span class='rparen'>)</span>
  <span class='id became'>became</span> <span class='op'>=</span> <span class='id klass'>klass</span><span class='period'>.</span><span class='id new'>new</span>
  <span class='id became'>became</span><span class='period'>.</span><span class='id instance_variable_set'>instance_variable_set</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>@attributes</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='ivar'>@attributes</span><span class='rparen'>)</span>
  <span class='id became'>became</span><span class='period'>.</span><span class='id instance_variable_set'>instance_variable_set</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>@attributes_cache</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='ivar'>@attributes_cache</span><span class='rparen'>)</span>
  <span class='id became'>became</span><span class='period'>.</span><span class='id instance_variable_set'>instance_variable_set</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>@new_record</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id new_record?'>new_record?</span><span class='rparen'>)</span>
  <span class='id became'>became</span><span class='period'>.</span><span class='id instance_variable_set'>instance_variable_set</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>@destroyed</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id destroyed?'>destroyed?</span><span class='rparen'>)</span>
  <span class='id became'>became</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="decrement-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>decrement</strong>(attribute, by = 1) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Initializes <tt>attribute</tt> to zero if <tt>nil</tt> and subtracts the
value passed as <tt>by</tt> (default is 1). The decrement is performed
directly on the underlying attribute, no setter is invoked. Only makes
sense for number-based attributes. Returns <tt>self</tt>.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


163
164
165
166
167</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/persistence.rb', line 163</span>

<span class='kw'>def</span> <span class='id decrement'>decrement</span><span class='lparen'>(</span><span class='id attribute'>attribute</span><span class='comma'>,</span> <span class='id by'>by</span> <span class='op'>=</span> <span class='int'>1</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='lbracket'>[</span><span class='id attribute'>attribute</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='int'>0</span>
  <span class='kw'>self</span><span class='lbracket'>[</span><span class='id attribute'>attribute</span><span class='rbracket'>]</span> <span class='op'>-=</span> <span class='id by'>by</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="decrement!-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>decrement!</strong>(attribute, by = 1) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Wrapper around <tt>decrement</tt> that saves the record. This method
differs from its non-bang version in that it passes through the attribute
setter. Saving is not subjected to validation checks. Returns <tt>true</tt>
if the record could be saved.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


173
174
175</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/persistence.rb', line 173</span>

<span class='kw'>def</span> <span class='id decrement!'>decrement!</span><span class='lparen'>(</span><span class='id attribute'>attribute</span><span class='comma'>,</span> <span class='id by'>by</span> <span class='op'>=</span> <span class='int'>1</span><span class='rparen'>)</span>
  <span class='id decrement'>decrement</span><span class='lparen'>(</span><span class='id attribute'>attribute</span><span class='comma'>,</span> <span class='id by'>by</span><span class='rparen'>)</span><span class='period'>.</span><span class='id update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='id attribute'>attribute</span><span class='comma'>,</span> <span class='kw'>self</span><span class='lbracket'>[</span><span class='id attribute'>attribute</span><span class='rbracket'>]</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="delete-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>delete</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Deletes the record in the database and freezes this instance to reflect
that no changes should be made (since they can&#8217;t be persisted).
Returns the frozen instance.
</p>
<p>
The row is simply removed with an SQL <tt>DELETE</tt> statement on the
record&#8217;s primary key, and no callbacks are executed.
</p>
<p>
To enforce the object&#8217;s <tt>before_destroy</tt> and
<tt>after_destroy</tt> callbacks, Observer methods, or any
<tt>:dependent</tt> association options, use <tt>#destroy</tt>.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


69
70
71
72
73</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/persistence.rb', line 69</span>

<span class='kw'>def</span> <span class='id delete'>delete</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id class'>class</span><span class='period'>.</span><span class='id delete'>delete</span><span class='lparen'>(</span><span class='id id'>id</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id persisted?'>persisted?</span>
  <span class='ivar'>@destroyed</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='id freeze'>freeze</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="destroy-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>destroy</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Deletes the record in the database and freezes this instance to reflect
that no changes should be made (since they can&#8217;t be persisted).
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


77
78
79
80
81
82
83
84</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/persistence.rb', line 77</span>

<span class='kw'>def</span> <span class='id destroy'>destroy</span>
  <span class='kw'>if</span> <span class='id persisted?'>persisted?</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id class'>class</span><span class='period'>.</span><span class='id unscoped'>unscoped</span><span class='period'>.</span><span class='id where'>where</span><span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id class'>class</span><span class='period'>.</span><span class='id arel_table'>arel_table</span><span class='lbracket'>[</span><span class='kw'>self</span><span class='period'>.</span><span class='id class'>class</span><span class='period'>.</span><span class='id primary_key'>primary_key</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id eq'>eq</span><span class='lparen'>(</span><span class='id id'>id</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='period'>.</span><span class='id delete_all'>delete_all</span>
  <span class='kw'>end</span>

  <span class='ivar'>@destroyed</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='id freeze'>freeze</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="destroyed?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>destroyed?</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns true if this object has been destroyed, otherwise returns false.
</p>


  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


11
12
13</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/persistence.rb', line 11</span>

<span class='kw'>def</span> <span class='id destroyed?'>destroyed?</span>
  <span class='ivar'>@destroyed</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="increment-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>increment</strong>(attribute, by = 1) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Initializes <tt>attribute</tt> to zero if <tt>nil</tt> and adds the value
passed as <tt>by</tt> (default is 1). The increment is performed directly
on the underlying attribute, no setter is invoked. Only makes sense for
number-based attributes. Returns <tt>self</tt>.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


146
147
148
149
150</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/persistence.rb', line 146</span>

<span class='kw'>def</span> <span class='id increment'>increment</span><span class='lparen'>(</span><span class='id attribute'>attribute</span><span class='comma'>,</span> <span class='id by'>by</span> <span class='op'>=</span> <span class='int'>1</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='lbracket'>[</span><span class='id attribute'>attribute</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='int'>0</span>
  <span class='kw'>self</span><span class='lbracket'>[</span><span class='id attribute'>attribute</span><span class='rbracket'>]</span> <span class='op'>+=</span> <span class='id by'>by</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="increment!-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>increment!</strong>(attribute, by = 1) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Wrapper around <tt>increment</tt> that saves the record. This method
differs from its non-bang version in that it passes through the attribute
setter. Saving is not subjected to validation checks. Returns <tt>true</tt>
if the record could be saved.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


156
157
158</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/persistence.rb', line 156</span>

<span class='kw'>def</span> <span class='id increment!'>increment!</span><span class='lparen'>(</span><span class='id attribute'>attribute</span><span class='comma'>,</span> <span class='id by'>by</span> <span class='op'>=</span> <span class='int'>1</span><span class='rparen'>)</span>
  <span class='id increment'>increment</span><span class='lparen'>(</span><span class='id attribute'>attribute</span><span class='comma'>,</span> <span class='id by'>by</span><span class='rparen'>)</span><span class='period'>.</span><span class='id update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='id attribute'>attribute</span><span class='comma'>,</span> <span class='kw'>self</span><span class='lbracket'>[</span><span class='id attribute'>attribute</span><span class='rbracket'>]</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="new_record?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>new_record?</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns true if this object hasn&#8217;t been saved yet &#8212; that is, a
record for the object doesn&#8217;t exist in the data store yet; otherwise,
returns false.
</p>


  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


6
7
8</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/persistence.rb', line 6</span>

<span class='kw'>def</span> <span class='id new_record?'>new_record?</span>
  <span class='ivar'>@new_record</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="persisted?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>persisted?</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns if the record is persisted, i.e. it&#8217;s not a new record and it
was not destroyed.
</p>


  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


17
18
19</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/persistence.rb', line 17</span>

<span class='kw'>def</span> <span class='id persisted?'>persisted?</span>
  <span class='op'>!</span><span class='lparen'>(</span><span class='id new_record?'>new_record?</span> <span class='op'>||</span> <span class='id destroyed?'>destroyed?</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="reload-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>reload</strong>(options = nil) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Reloads the attributes of this object from the database. The optional
options argument is passed to find when reloading so you may do e.g.
record.reload(:lock => true) to reload the same record with an exclusive
row lock.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


198
199
200
201
202
203
204</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/persistence.rb', line 198</span>

<span class='kw'>def</span> <span class='id reload'>reload</span><span class='lparen'>(</span><span class='id options'>options</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id clear_aggregation_cache'>clear_aggregation_cache</span>
  <span class='id clear_association_cache'>clear_association_cache</span>
  <span class='ivar'>@attributes</span><span class='period'>.</span><span class='id update'>update</span><span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id class'>class</span><span class='period'>.</span><span class='id unscoped'>unscoped</span> <span class='lbrace'>{</span> <span class='kw'>self</span><span class='period'>.</span><span class='id class'>class</span><span class='period'>.</span><span class='id find'>find</span><span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id id'>id</span><span class='comma'>,</span> <span class='id options'>options</span><span class='rparen'>)</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id instance_variable_get'>instance_variable_get</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>@attributes</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='ivar'>@attributes_cache</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="save-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>save</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
:call-seq:
</p>
<pre class="code">
  <span class='id save'>save</span><span class='lparen'>(</span><span class='id options'>options</span><span class='rparen'>)</span>
</pre>
<p>
Saves the model.
</p>
<p>
If the model is new a record gets created in the database, otherwise the
existing record gets updated.
</p>
<p>
By default, save always run validations. If any of them fail the action is
cancelled and <tt>save</tt> returns <tt>false</tt>. However, if you supply
:validate => false, validations are bypassed altogether. See
ActiveRecord::Validations for more information.
</p>
<p>
There&#8217;s a series of callbacks associated with <tt>save</tt>. If any
of the <tt>before_*</tt> callbacks return <tt>false</tt> the action is
cancelled and <tt>save</tt> returns <tt>false</tt>. See
ActiveRecord::Callbacks for further details.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


38
39
40</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/persistence.rb', line 38</span>

<span class='kw'>def</span> <span class='id save'>save</span><span class='lparen'>(</span><span class='op'>*</span><span class='rparen'>)</span>
  <span class='id create_or_update'>create_or_update</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="save!-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>save!</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Saves the model.
</p>
<p>
If the model is new a record gets created in the database, otherwise the
existing record gets updated.
</p>
<p>
With <tt>save!</tt> validations always run. If any of them fail
ActiveRecord::RecordInvalid gets raised. See ActiveRecord::Validations for
more information.
</p>
<p>
There&#8217;s a series of callbacks associated with <tt>save!</tt>. If any
of the <tt>before_*</tt> callbacks return <tt>false</tt> the action is
cancelled and <tt>save!</tt> raises ActiveRecord::RecordNotSaved. See
ActiveRecord::Callbacks for further details.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


55
56
57</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/persistence.rb', line 55</span>

<span class='kw'>def</span> <span class='id save!'>save!</span><span class='lparen'>(</span><span class='op'>*</span><span class='rparen'>)</span>
  <span class='id create_or_update'>create_or_update</span> <span class='op'>||</span> <span class='id raise'>raise</span><span class='lparen'>(</span><span class='const'>RecordNotSaved</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="toggle-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>toggle</strong>(attribute) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Assigns to <tt>attribute</tt> the boolean opposite of <tt>attribute?</tt>.
So if the predicate returns <tt>true</tt> the attribute will become
<tt>false</tt>. This method toggles directly the underlying value without
calling any setter. Returns <tt>self</tt>.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


181
182
183
184</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/persistence.rb', line 181</span>

<span class='kw'>def</span> <span class='id toggle'>toggle</span><span class='lparen'>(</span><span class='id attribute'>attribute</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='lbracket'>[</span><span class='id attribute'>attribute</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='op'>!</span><span class='id send'>send</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id attribute'>attribute</span><span class='rbrace'>}</span><span class='tstring_content'>?</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="toggle!-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>toggle!</strong>(attribute) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Wrapper around <tt>toggle</tt> that saves the record. This method differs
from its non-bang version in that it passes through the attribute setter.
Saving is not subjected to validation checks. Returns <tt>true</tt> if the
record could be saved.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


190
191
192</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/persistence.rb', line 190</span>

<span class='kw'>def</span> <span class='id toggle!'>toggle!</span><span class='lparen'>(</span><span class='id attribute'>attribute</span><span class='rparen'>)</span>
  <span class='id toggle'>toggle</span><span class='lparen'>(</span><span class='id attribute'>attribute</span><span class='rparen'>)</span><span class='period'>.</span><span class='id update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='id attribute'>attribute</span><span class='comma'>,</span> <span class='kw'>self</span><span class='lbracket'>[</span><span class='id attribute'>attribute</span><span class='rbracket'>]</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="touch-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>touch</strong>(name = nil) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Saves the record with the updated_at/on attributes set to the current time.
Please note that no validation is performed and no callbacks are executed.
If an attribute name is passed, that attribute is updated along with
updated_at/on attributes.
</p>
<pre class="code">
  <span class='id product'>product</span><span class='period'>.</span><span class='id touch'>touch</span>               <span class='comment'># updates updated_at/on
</span>  <span class='id product'>product</span><span class='period'>.</span><span class='id touch'>touch</span><span class='lparen'>(</span><span class='symbol'>:designed_at</span><span class='rparen'>)</span> <span class='comment'># updates the designed_at attribute and updated_at/on
</span></pre>
<p>
If used along with <tt>belongs_to</tt> then <tt>touch</tt> will invoke
<tt>touch</tt> method on associated object.
</p>
<pre class="code">
  <span class='kw'>class</span> <span class='const'>Brake</span> <span class='op'>&lt;</span> <span class='const'>ActiveRecord</span><span class='op'>::</span><span class='const'>Base</span>
    <span class='id belongs_to'>belongs_to</span> <span class='symbol'>:car</span><span class='comma'>,</span> <span class='symbol'>:touch</span> <span class='op'>=&gt;</span> <span class='kw'>true</span>
  <span class='kw'>end</span>

  <span class='kw'>class</span> <span class='const'>Car</span> <span class='op'>&lt;</span> <span class='const'>ActiveRecord</span><span class='op'>::</span><span class='const'>Base</span>
    <span class='id belongs_to'>belongs_to</span> <span class='symbol'>:corporation</span><span class='comma'>,</span> <span class='symbol'>:touch</span> <span class='op'>=&gt;</span> <span class='kw'>true</span>
  <span class='kw'>end</span>

  <span class='comment'># triggers @brake.car.touch and @brake.car.corporation.touch
</span>  <span class='ivar'>@brake</span><span class='period'>.</span><span class='id touch'>touch</span></pre>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/persistence.rb', line 226</span>

<span class='kw'>def</span> <span class='id touch'>touch</span><span class='lparen'>(</span><span class='id name'>name</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id attributes'>attributes</span> <span class='op'>=</span> <span class='id timestamp_attributes_for_update_in_model'>timestamp_attributes_for_update_in_model</span>
  <span class='kw'>unless</span> <span class='id attributes'>attributes</span><span class='period'>.</span><span class='id blank?'>blank?</span>
    <span class='id attributes'>attributes</span> <span class='op'>&lt;&lt;</span> <span class='id name'>name</span> <span class='kw'>if</span> <span class='id name'>name</span>

    <span class='id current_time'>current_time</span> <span class='op'>=</span> <span class='id current_time_from_proper_timezone'>current_time_from_proper_timezone</span>
    <span class='id changes'>changes</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>

    <span class='id attributes'>attributes</span><span class='period'>.</span><span class='id each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id column'>column</span><span class='op'>|</span>
      <span class='id changes'>changes</span><span class='lbracket'>[</span><span class='id column'>column</span><span class='period'>.</span><span class='id to_s'>to_s</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id write_attribute'>write_attribute</span><span class='lparen'>(</span><span class='id column'>column</span><span class='period'>.</span><span class='id to_s'>to_s</span><span class='comma'>,</span> <span class='id current_time'>current_time</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='ivar'>@changed_attributes</span><span class='period'>.</span><span class='id except!'>except!</span><span class='lparen'>(</span><span class='op'>*</span><span class='id changes'>changes</span><span class='period'>.</span><span class='id keys'>keys</span><span class='rparen'>)</span>
    <span class='id primary_key'>primary_key</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id class'>class</span><span class='period'>.</span><span class='id primary_key'>primary_key</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id class'>class</span><span class='period'>.</span><span class='id update_all'>update_all</span><span class='lparen'>(</span><span class='id changes'>changes</span><span class='comma'>,</span> <span class='lbrace'>{</span> <span class='id primary_key'>primary_key</span> <span class='op'>=&gt;</span> <span class='kw'>self</span><span class='lbracket'>[</span><span class='id primary_key'>primary_key</span><span class='rbracket'>]</span> <span class='rbrace'>}</span><span class='rparen'>)</span> <span class='op'>==</span> <span class='int'>1</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="update_attribute-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>update_attribute</strong>(name, value) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Updates a single attribute and saves the record. This is especially useful
for boolean flags on existing records. Also note that
</p>
<ul>
<li><p>
Validation is skipped.
</p>
</li>
<li><p>
Callbacks are invoked.
</p>
</li>
<li><p>
updated_at/updated_on column is updated if that column is available.
</p>
</li>
<li><p>
Updates all the attributes that are dirty in this object.
</p>
</li>
</ul>


  </div>
</div>
<div class="tags">
  <h3>Raises:</h3>
<ul class="raise">
  
    <li>
      
        <span class='type'>(<tt><span class='object_link'><a href="ActiveRecordError.html" title="ActiveRecord::ActiveRecordError (class)">ActiveRecordError</a></span></tt>)</span>
      
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


113
114
115
116
117
118</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/persistence.rb', line 113</span>

<span class='kw'>def</span> <span class='id update_attribute'>update_attribute</span><span class='lparen'>(</span><span class='id name'>name</span><span class='comma'>,</span> <span class='id value'>value</span><span class='rparen'>)</span>
  <span class='id name'>name</span> <span class='op'>=</span> <span class='id name'>name</span><span class='period'>.</span><span class='id to_s'>to_s</span>
  <span class='id raise'>raise</span> <span class='const'>ActiveRecordError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id name'>name</span><span class='rbrace'>}</span><span class='tstring_content'> is marked as readonly</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id class'>class</span><span class='period'>.</span><span class='id readonly_attributes'>readonly_attributes</span><span class='period'>.</span><span class='id include?'>include?</span><span class='lparen'>(</span><span class='id name'>name</span><span class='rparen'>)</span>
  <span class='id send'>send</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id name'>name</span><span class='rbrace'>}</span><span class='tstring_content'>=</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id value'>value</span><span class='rparen'>)</span>
  <span class='id save'>save</span><span class='lparen'>(</span><span class='symbol'>:validate</span> <span class='op'>=&gt;</span> <span class='kw'>false</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="update_attributes-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>update_attributes</strong>(attributes) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Updates the attributes of the model from the passed-in hash and saves the
record, all wrapped in a transaction. If the object is invalid, the saving
will fail and false will be returned.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


123
124
125
126
127
128
129
130</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/persistence.rb', line 123</span>

<span class='kw'>def</span> <span class='id update_attributes'>update_attributes</span><span class='lparen'>(</span><span class='id attributes'>attributes</span><span class='rparen'>)</span>
  <span class='comment'># The following transaction covers any possible database side-effects of the
</span>  <span class='comment'># attributes assignment. For example, setting the IDs of a child collection.
</span>  <span class='id with_transaction_returning_status'>with_transaction_returning_status</span> <span class='kw'>do</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id attributes'>attributes</span> <span class='op'>=</span> <span class='id attributes'>attributes</span>
    <span class='id save'>save</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="update_attributes!-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>update_attributes!</strong>(attributes) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Updates its receiver just like <tt>update_attributes</tt> but calls
<tt>save!</tt> instead of <tt>save</tt>, so an exception is raised if the
record is invalid.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


134
135
136
137
138
139
140
141</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/persistence.rb', line 134</span>

<span class='kw'>def</span> <span class='id update_attributes!'>update_attributes!</span><span class='lparen'>(</span><span class='id attributes'>attributes</span><span class='rparen'>)</span>
  <span class='comment'># The following transaction covers any possible database side-effects of the
</span>  <span class='comment'># attributes assignment. For example, setting the IDs of a child collection.
</span>  <span class='id with_transaction_returning_status'>with_transaction_returning_status</span> <span class='kw'>do</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id attributes'>attributes</span> <span class='op'>=</span> <span class='id attributes'>attributes</span>
    <span class='id save!'>save!</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>
    
    <div id="footer">
  Generated on Thu Nov  4 20:03:36 2010 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.6.1 (ruby-1.9.2).
</div>

  </body>
</html>