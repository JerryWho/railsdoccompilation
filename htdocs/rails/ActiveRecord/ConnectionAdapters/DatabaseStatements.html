<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta name="Content-Type" content="text/html; charset=utf-8" />
<title>Module: ActiveRecord::ConnectionAdapters::DatabaseStatements</title>
<link rel="stylesheet" href="../../css/style.css" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="../../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '../..';
  if (relpath != '') relpath += '/';
</script>
<script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>

  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="../../_index.html">Index (D)</a> &raquo; 
    <span class='title'><span class='object_link'><a href="../../ActiveRecord.html" title="ActiveRecord (module)">ActiveRecord</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../ConnectionAdapters.html" title="ActiveRecord::ConnectionAdapters (module)">ConnectionAdapters</a></span></span>
     &raquo; 
    <span class="title">DatabaseStatements</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  <a id="class_list_link" href="#">Class List</a>
  <a id="method_list_link" href="#">Method List</a>
  <a id ="file_list_link" href="#">File List</a>
</div>

      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><h1>Module: ActiveRecord::ConnectionAdapters::DatabaseStatements
  
  
  
</h1>

<dl class="box">
  
  
    
  
    
  
  
    <dt class="r1">Included in:</dt>
    <dd class="r1"><span class='object_link'><a href="AbstractAdapter.html" title="ActiveRecord::ConnectionAdapters::AbstractAdapter (class)">AbstractAdapter</a></span></dd>
    
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">activerecord/lib/active_record/connection_adapters/abstract/database_statements.rb</dd>
  
</dl>
<div class="clear"></div>




  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add_limit_offset%21-instance_method" title="#add_limit_offset! (instance method)">- (Object) <strong>add_limit_offset!</strong>(sql, options) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Appends <tt>LIMIT</tt> and <tt>OFFSET</tt> options to an SQL statement, or
some SQL fragment that has the same semantics as LIMIT and OFFSET.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add_transaction_record-instance_method" title="#add_transaction_record (instance method)">- (Object) <strong>add_transaction_record</strong>(record) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Register a record with the current transaction so that its after_commit and
after_rollback callbacks can be called.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#begin_db_transaction-instance_method" title="#begin_db_transaction (instance method)">- (Object) <strong>begin_db_transaction</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Begins the transaction (and turns off auto-committing).
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#case_sensitive_equality_operator-instance_method" title="#case_sensitive_equality_operator (instance method)">- (Object) <strong>case_sensitive_equality_operator</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#commit_db_transaction-instance_method" title="#commit_db_transaction (instance method)">- (Object) <strong>commit_db_transaction</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Commits the transaction (and turns on auto-committing).
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#default_sequence_name-instance_method" title="#default_sequence_name (instance method)">- (Object) <strong>default_sequence_name</strong>(table, column) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#delete-instance_method" title="#delete (instance method)">- (Object) <strong>delete</strong>(sql, name = nil) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Executes the delete statement and returns the number of rows affected.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#empty_insert_statement_value-instance_method" title="#empty_insert_statement_value (instance method)">- (Object) <strong>empty_insert_statement_value</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#execute-instance_method" title="#execute (instance method)">- (Object) <strong>execute</strong>(sql, name = nil, skip_logging = false) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Executes the SQL statement in the context of this connection.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#insert-instance_method" title="#insert (instance method)">- (Object) <strong>insert</strong>(sql, name = nil, pk = nil, id_value = nil, sequence_name = nil) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns the last auto-generated ID from the affected table.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#insert_fixture-instance_method" title="#insert_fixture (instance method)">- (Object) <strong>insert_fixture</strong>(fixture, table_name) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Inserts the given fixture into the table.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#limited_update_conditions-instance_method" title="#limited_update_conditions (instance method)">- (Object) <strong>limited_update_conditions</strong>(where_sql, quoted_table_name, quoted_primary_key) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#outside_transaction%3F-instance_method" title="#outside_transaction? (instance method)">- (Boolean) <strong>outside_transaction?</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Checks whether there is currently no transaction active.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#reset_sequence%21-instance_method" title="#reset_sequence! (instance method)">- (Object) <strong>reset_sequence!</strong>(table, column, sequence = nil) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Set the sequence to the max value of the table&#8217;s column.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#rollback_db_transaction-instance_method" title="#rollback_db_transaction (instance method)">- (Object) <strong>rollback_db_transaction</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Rolls back the transaction (and turns on auto-committing).
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#select_all-instance_method" title="#select_all (instance method)">- (Object) <strong>select_all</strong>(sql, name = nil) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns an array of record hashes with the column names as keys and column
values as values.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#select_one-instance_method" title="#select_one (instance method)">- (Object) <strong>select_one</strong>(sql, name = nil) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns a record hash with the column names as keys and column values as
values.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#select_rows-instance_method" title="#select_rows (instance method)">- (Object) <strong>select_rows</strong>(sql, name = nil) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns an array of arrays containing the field values.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#select_value-instance_method" title="#select_value (instance method)">- (Object) <strong>select_value</strong>(sql, name = nil) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns a single value from a record.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#select_values-instance_method" title="#select_values (instance method)">- (Object) <strong>select_values</strong>(sql, name = nil) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns an array of the values of the first column in a select:.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#transaction-instance_method" title="#transaction (instance method)">- (Object) <strong>transaction</strong>(options = {}) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Runs the given block in a database transaction, and returns the result of
the block.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#update-instance_method" title="#update (instance method)">- (Object) <strong>update</strong>(sql, name = nil) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Executes the update statement and returns the number of rows affected.
</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="add_limit_offset!-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>add_limit_offset!</strong>(sql, options) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Appends <tt>LIMIT</tt> and <tt>OFFSET</tt> options to an SQL statement, or
some SQL fragment that has the same semantics as LIMIT and OFFSET.
</p>
<p>
<tt>options</tt> must be a Hash which contains a <tt>:limit</tt> option and
an <tt>:offset</tt> option.
</p>
<p>
This method <b>modifies</b> the <tt>sql</tt> parameter.
</p>
<h5>Examples</h5>
<pre class="code">
 <span class='id add_limit_offset!'>add_limit_offset!</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>SELECT * FROM suppliers</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='lbrace'>{</span><span class='symbol'>:limit</span> <span class='op'>=&gt;</span> <span class='int'>10</span><span class='comma'>,</span> <span class='symbol'>:offset</span> <span class='op'>=&gt;</span> <span class='int'>50</span><span class='rbrace'>}</span><span class='rparen'>)</span>
</pre>
<p>
generates
</p>
<pre class="code">
 SELECT * FROM suppliers LIMIT 10 OFFSET 50</pre>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


217
218
219
220
221
222
223
224
225</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/abstract/database_statements.rb', line 217</span>

<span class='kw'>def</span> <span class='id add_limit_offset!'>add_limit_offset!</span><span class='lparen'>(</span><span class='id sql'>sql</span><span class='comma'>,</span> <span class='id options'>options</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id limit'>limit</span> <span class='op'>=</span> <span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:limit</span><span class='rbracket'>]</span>
    <span class='id sql'>sql</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> LIMIT </span><span class='embexpr_beg'>#{</span><span class='id sanitize_limit'>sanitize_limit</span><span class='lparen'>(</span><span class='id limit'>limit</span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='id offset'>offset</span> <span class='op'>=</span> <span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:offset</span><span class='rbracket'>]</span>
    <span class='id sql'>sql</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> OFFSET </span><span class='embexpr_beg'>#{</span><span class='id offset'>offset</span><span class='period'>.</span><span class='id to_i'>to_i</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='id sql'>sql</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="add_transaction_record-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>add_transaction_record</strong>(record) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Register a record with the current transaction so that its after_commit and
after_rollback callbacks can be called.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


189
190
191
192</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/abstract/database_statements.rb', line 189</span>

<span class='kw'>def</span> <span class='id add_transaction_record'>add_transaction_record</span><span class='lparen'>(</span><span class='id record'>record</span><span class='rparen'>)</span>
  <span class='id last_batch'>last_batch</span> <span class='op'>=</span> <span class='ivar'>@_current_transaction_records</span><span class='period'>.</span><span class='id last'>last</span>
  <span class='id last_batch'>last_batch</span> <span class='op'>&lt;&lt;</span> <span class='id record'>record</span> <span class='kw'>if</span> <span class='id last_batch'>last_batch</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="begin_db_transaction-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>begin_db_transaction</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Begins the transaction (and turns off auto-committing).
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


195</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/abstract/database_statements.rb', line 195</span>

<span class='kw'>def</span> <span class='id begin_db_transaction'>begin_db_transaction</span><span class='lparen'>(</span><span class='rparen'>)</span>    <span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="case_sensitive_equality_operator-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>case_sensitive_equality_operator</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


246
247
248</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/abstract/database_statements.rb', line 246</span>

<span class='kw'>def</span> <span class='id case_sensitive_equality_operator'>case_sensitive_equality_operator</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>=</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="commit_db_transaction-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>commit_db_transaction</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Commits the transaction (and turns on auto-committing).
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


198</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/abstract/database_statements.rb', line 198</span>

<span class='kw'>def</span> <span class='id commit_db_transaction'>commit_db_transaction</span><span class='lparen'>(</span><span class='rparen'>)</span>   <span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="default_sequence_name-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>default_sequence_name</strong>(table, column) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


227
228
229</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/abstract/database_statements.rb', line 227</span>

<span class='kw'>def</span> <span class='id default_sequence_name'>default_sequence_name</span><span class='lparen'>(</span><span class='id table'>table</span><span class='comma'>,</span> <span class='id column'>column</span><span class='rparen'>)</span>
  <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="delete-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>delete</strong>(sql, name = nil) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Executes the delete statement and returns the number of rows affected.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


53
54
55</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/abstract/database_statements.rb', line 53</span>

<span class='kw'>def</span> <span class='id delete'>delete</span><span class='lparen'>(</span><span class='id sql'>sql</span><span class='comma'>,</span> <span class='id name'>name</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id delete_sql'>delete_sql</span><span class='lparen'>(</span><span class='id sql'>sql</span><span class='comma'>,</span> <span class='id name'>name</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="empty_insert_statement_value-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>empty_insert_statement_value</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


242
243
244</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/abstract/database_statements.rb', line 242</span>

<span class='kw'>def</span> <span class='id empty_insert_statement_value'>empty_insert_statement_value</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>VALUES(DEFAULT)</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="execute-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>execute</strong>(sql, name = nil, skip_logging = false) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Executes the SQL statement in the context of this connection.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


38
39</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/abstract/database_statements.rb', line 38</span>

<span class='kw'>def</span> <span class='id execute'>execute</span><span class='lparen'>(</span><span class='id sql'>sql</span><span class='comma'>,</span> <span class='id name'>name</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id skip_logging'>skip_logging</span> <span class='op'>=</span> <span class='kw'>false</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="insert-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>insert</strong>(sql, name = nil, pk = nil, id_value = nil, sequence_name = nil) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns the last auto-generated ID from the affected table.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


43
44
45</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/abstract/database_statements.rb', line 43</span>

<span class='kw'>def</span> <span class='id insert'>insert</span><span class='lparen'>(</span><span class='id sql'>sql</span><span class='comma'>,</span> <span class='id name'>name</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id pk'>pk</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id id_value'>id_value</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id sequence_name'>sequence_name</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id insert_sql'>insert_sql</span><span class='lparen'>(</span><span class='id sql'>sql</span><span class='comma'>,</span> <span class='id name'>name</span><span class='comma'>,</span> <span class='id pk'>pk</span><span class='comma'>,</span> <span class='id id_value'>id_value</span><span class='comma'>,</span> <span class='id sequence_name'>sequence_name</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="insert_fixture-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>insert_fixture</strong>(fixture, table_name) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Inserts the given fixture into the table. Overridden in adapters that
require something beyond a simple insert (eg. Oracle).
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


238
239
240</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/abstract/database_statements.rb', line 238</span>

<span class='kw'>def</span> <span class='id insert_fixture'>insert_fixture</span><span class='lparen'>(</span><span class='id fixture'>fixture</span><span class='comma'>,</span> <span class='id table_name'>table_name</span><span class='rparen'>)</span>
  <span class='id execute'>execute</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>INSERT INTO </span><span class='embexpr_beg'>#{</span><span class='id quote_table_name'>quote_table_name</span><span class='lparen'>(</span><span class='id table_name'>table_name</span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='tstring_content'> (</span><span class='embexpr_beg'>#{</span><span class='id fixture'>fixture</span><span class='period'>.</span><span class='id key_list'>key_list</span><span class='rbrace'>}</span><span class='tstring_content'>) VALUES (</span><span class='embexpr_beg'>#{</span><span class='id fixture'>fixture</span><span class='period'>.</span><span class='id value_list'>value_list</span><span class='rbrace'>}</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>Fixture Insert</span><span class='tstring_end'>'</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="limited_update_conditions-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>limited_update_conditions</strong>(where_sql, quoted_table_name, quoted_primary_key) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


250
251
252</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/abstract/database_statements.rb', line 250</span>

<span class='kw'>def</span> <span class='id limited_update_conditions'>limited_update_conditions</span><span class='lparen'>(</span><span class='id where_sql'>where_sql</span><span class='comma'>,</span> <span class='id quoted_table_name'>quoted_table_name</span><span class='comma'>,</span> <span class='id quoted_primary_key'>quoted_primary_key</span><span class='rparen'>)</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>WHERE </span><span class='embexpr_beg'>#{</span><span class='id quoted_primary_key'>quoted_primary_key</span><span class='rbrace'>}</span><span class='tstring_content'> IN (SELECT </span><span class='embexpr_beg'>#{</span><span class='id quoted_primary_key'>quoted_primary_key</span><span class='rbrace'>}</span><span class='tstring_content'> FROM </span><span class='embexpr_beg'>#{</span><span class='id quoted_table_name'>quoted_table_name</span><span class='rbrace'>}</span><span class='tstring_content'> </span><span class='embexpr_beg'>#{</span><span class='id where_sql'>where_sql</span><span class='rbrace'>}</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="outside_transaction?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>outside_transaction?</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Checks whether there is currently no transaction active. This is done by
querying the database driver, and does not use the transaction
house-keeping information recorded by #increment_open_transactions and
friends.
</p>
<p>
Returns true if there is no transaction active, false if there is a
transaction active, and nil if this information is unknown.
</p>
<p>
Not all adapters supports transaction state introspection. Currently, only
the PostgreSQL adapter supports this.
</p>


  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


67
68
69</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/abstract/database_statements.rb', line 67</span>

<span class='kw'>def</span> <span class='id outside_transaction?'>outside_transaction?</span>
  <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="reset_sequence!-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>reset_sequence!</strong>(table, column, sequence = nil) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Set the sequence to the max value of the table&#8217;s column.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


232
233
234</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/abstract/database_statements.rb', line 232</span>

<span class='kw'>def</span> <span class='id reset_sequence!'>reset_sequence!</span><span class='lparen'>(</span><span class='id table'>table</span><span class='comma'>,</span> <span class='id column'>column</span><span class='comma'>,</span> <span class='id sequence'>sequence</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='comment'># Do nothing by default.  Implement for PostgreSQL, Oracle, ...
</span><span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="rollback_db_transaction-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>rollback_db_transaction</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Rolls back the transaction (and turns on auto-committing). Must be done if
the transaction block raises an exception or returns false.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


202</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/abstract/database_statements.rb', line 202</span>

<span class='kw'>def</span> <span class='id rollback_db_transaction'>rollback_db_transaction</span><span class='lparen'>(</span><span class='rparen'>)</span> <span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="select_all-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>select_all</strong>(sql, name = nil) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns an array of record hashes with the column names as keys and column
values as values.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


6
7
8</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/abstract/database_statements.rb', line 6</span>

<span class='kw'>def</span> <span class='id select_all'>select_all</span><span class='lparen'>(</span><span class='id sql'>sql</span><span class='comma'>,</span> <span class='id name'>name</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id select'>select</span><span class='lparen'>(</span><span class='id sql'>sql</span><span class='comma'>,</span> <span class='id name'>name</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="select_one-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>select_one</strong>(sql, name = nil) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns a record hash with the column names as keys and column values as
values.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


12
13
14
15</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/abstract/database_statements.rb', line 12</span>

<span class='kw'>def</span> <span class='id select_one'>select_one</span><span class='lparen'>(</span><span class='id sql'>sql</span><span class='comma'>,</span> <span class='id name'>name</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id result'>result</span> <span class='op'>=</span> <span class='id select_all'>select_all</span><span class='lparen'>(</span><span class='id sql'>sql</span><span class='comma'>,</span> <span class='id name'>name</span><span class='rparen'>)</span>
  <span class='id result'>result</span><span class='period'>.</span><span class='id first'>first</span> <span class='kw'>if</span> <span class='id result'>result</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="select_rows-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>select_rows</strong>(sql, name = nil) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns an array of arrays containing the field values. Order is the same
as that returned by <tt>columns</tt>.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


33
34</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/abstract/database_statements.rb', line 33</span>

<span class='kw'>def</span> <span class='id select_rows'>select_rows</span><span class='lparen'>(</span><span class='id sql'>sql</span><span class='comma'>,</span> <span class='id name'>name</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="select_value-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>select_value</strong>(sql, name = nil) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns a single value from a record
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


18
19
20
21
22</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/abstract/database_statements.rb', line 18</span>

<span class='kw'>def</span> <span class='id select_value'>select_value</span><span class='lparen'>(</span><span class='id sql'>sql</span><span class='comma'>,</span> <span class='id name'>name</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id result'>result</span> <span class='op'>=</span> <span class='id select_one'>select_one</span><span class='lparen'>(</span><span class='id sql'>sql</span><span class='comma'>,</span> <span class='id name'>name</span><span class='rparen'>)</span>
    <span class='id result'>result</span><span class='period'>.</span><span class='id values'>values</span><span class='period'>.</span><span class='id first'>first</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="select_values-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>select_values</strong>(sql, name = nil) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns an array of the values of the first column in a select:
</p>
<pre class="code">
  select_values(&quot;SELECT id FROM companies LIMIT 3&quot;) =&gt; [1,2,3]</pre>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


26
27
28
29</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/abstract/database_statements.rb', line 26</span>

<span class='kw'>def</span> <span class='id select_values'>select_values</span><span class='lparen'>(</span><span class='id sql'>sql</span><span class='comma'>,</span> <span class='id name'>name</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id result'>result</span> <span class='op'>=</span> <span class='id select_rows'>select_rows</span><span class='lparen'>(</span><span class='id sql'>sql</span><span class='comma'>,</span> <span class='id name'>name</span><span class='rparen'>)</span>
  <span class='id result'>result</span><span class='period'>.</span><span class='id map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id v'>v</span><span class='op'>|</span> <span class='id v'>v</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="transaction-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>transaction</strong>(options = {}) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Runs the given block in a database transaction, and returns the result of
the block.
</p>
<h2>Nested transactions support</h2>
<p>
Most databases don&#8217;t support true nested transactions. At the time of
writing, the only database that supports true nested transactions that
we&#8217;re aware of, is MS-SQL.
</p>
<p>
In order to get around this problem, #transaction will emulate the effect
of nested transactions, by using savepoints: <a
href="http://dev.mysql.com/doc/refman/5.0/en/savepoints.html">dev.mysql.com/doc/refman/5.0/en/savepoints.html</a>
Savepoints are supported by MySQL and PostgreSQL, but not SQLite3.
</p>
<p>
It is safe to call this method if a database transaction is already open,
i.e. if #transaction is called within another #transaction block. In case
of a nested call, #transaction will behave as follows:
</p>
<ul>
<li><p>
The block will be run without doing anything. All database statements that
happen within the block are effectively appended to the already open
database transaction.
</p>
</li>
<li><p>
However, if <tt>:requires_new</tt> is set, the block will be wrapped in a
database savepoint acting as a sub-transaction.
</p>
</li>
</ul>
<h3>Caveats</h3>
<p>
MySQL doesn&#8217;t support DDL transactions. If you perform a DDL
operation, then any created savepoints will be automatically released. For
example, if you&#8217;ve created a savepoint, then you execute a CREATE
TABLE statement, then the savepoint that was created will be automatically
released.
</p>
<p>
This means that, on MySQL, you shouldn&#8217;t execute DDL operations
inside a #transaction call that you know might create a savepoint.
Otherwise, #transaction will raise exceptions when it tries to release the
already-automatically-released savepoints:
</p>
<pre class="code">
  Model.connection.transaction do  # BEGIN
    Model.connection.transaction(:requires_new =&gt; true) do  # CREATE SAVEPOINT active_record_1
      Model.connection.create_table(...)
      # active_record_1 now automatically released
    end  # RELEASE SAVEPOINT active_record_1  &lt;--- BOOM! database error!
  end</pre>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/abstract/database_statements.rb', line 113</span>

<span class='kw'>def</span> <span class='id transaction'>transaction</span><span class='lparen'>(</span><span class='id options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id options'>options</span><span class='period'>.</span><span class='id assert_valid_keys'>assert_valid_keys</span> <span class='symbol'>:requires_new</span><span class='comma'>,</span> <span class='symbol'>:joinable</span>

  <span class='id last_transaction_joinable'>last_transaction_joinable</span> <span class='op'>=</span> <span class='kw'>defined?</span><span class='lparen'>(</span><span class='ivar'>@transaction_joinable</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='ivar'>@transaction_joinable</span> <span class='op'>:</span> <span class='kw'>nil</span>
  <span class='kw'>if</span> <span class='id options'>options</span><span class='period'>.</span><span class='id has_key?'>has_key?</span><span class='lparen'>(</span><span class='symbol'>:joinable</span><span class='rparen'>)</span>
    <span class='ivar'>@transaction_joinable</span> <span class='op'>=</span> <span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:joinable</span><span class='rbracket'>]</span>
  <span class='kw'>else</span>
    <span class='ivar'>@transaction_joinable</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='kw'>end</span>
  <span class='id requires_new'>requires_new</span> <span class='op'>=</span> <span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:requires_new</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='op'>!</span><span class='id last_transaction_joinable'>last_transaction_joinable</span>

  <span class='id transaction_open'>transaction_open</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='ivar'>@_current_transaction_records</span> <span class='op'>||=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

  <span class='kw'>begin</span>
    <span class='kw'>if</span> <span class='id block_given?'>block_given?</span>
      <span class='kw'>if</span> <span class='id requires_new'>requires_new</span> <span class='op'>||</span> <span class='id open_transactions'>open_transactions</span> <span class='op'>==</span> <span class='int'>0</span>
        <span class='kw'>if</span> <span class='id open_transactions'>open_transactions</span> <span class='op'>==</span> <span class='int'>0</span>
          <span class='id begin_db_transaction'>begin_db_transaction</span>
        <span class='kw'>elsif</span> <span class='id requires_new'>requires_new</span>
          <span class='id create_savepoint'>create_savepoint</span>
        <span class='kw'>end</span>
        <span class='id increment_open_transactions'>increment_open_transactions</span>
        <span class='id transaction_open'>transaction_open</span> <span class='op'>=</span> <span class='kw'>true</span>
        <span class='ivar'>@_current_transaction_records</span><span class='period'>.</span><span class='id push'>push</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='rbracket'>]</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
      <span class='kw'>yield</span>
    <span class='kw'>end</span>
  <span class='kw'>rescue</span> <span class='const'>Exception</span> <span class='op'>=&gt;</span> <span class='id database_transaction_rollback'>database_transaction_rollback</span>
    <span class='kw'>if</span> <span class='id transaction_open'>transaction_open</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id outside_transaction?'>outside_transaction?</span>
      <span class='id transaction_open'>transaction_open</span> <span class='op'>=</span> <span class='kw'>false</span>
      <span class='id decrement_open_transactions'>decrement_open_transactions</span>
      <span class='kw'>if</span> <span class='id open_transactions'>open_transactions</span> <span class='op'>==</span> <span class='int'>0</span>
        <span class='id rollback_db_transaction'>rollback_db_transaction</span>
        <span class='id rollback_transaction_records'>rollback_transaction_records</span><span class='lparen'>(</span><span class='kw'>true</span><span class='rparen'>)</span>
      <span class='kw'>else</span>
        <span class='id rollback_to_savepoint'>rollback_to_savepoint</span>
        <span class='id rollback_transaction_records'>rollback_transaction_records</span><span class='lparen'>(</span><span class='kw'>false</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='id raise'>raise</span> <span class='kw'>unless</span> <span class='id database_transaction_rollback'>database_transaction_rollback</span><span class='period'>.</span><span class='id is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>ActiveRecord</span><span class='op'>::</span><span class='const'>Rollback</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>ensure</span>
  <span class='ivar'>@transaction_joinable</span> <span class='op'>=</span> <span class='id last_transaction_joinable'>last_transaction_joinable</span>

  <span class='kw'>if</span> <span class='id outside_transaction?'>outside_transaction?</span>
    <span class='ivar'>@open_transactions</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='kw'>elsif</span> <span class='id transaction_open'>transaction_open</span>
    <span class='id decrement_open_transactions'>decrement_open_transactions</span>
    <span class='kw'>begin</span>
      <span class='kw'>if</span> <span class='id open_transactions'>open_transactions</span> <span class='op'>==</span> <span class='int'>0</span>
        <span class='id commit_db_transaction'>commit_db_transaction</span>
        <span class='id commit_transaction_records'>commit_transaction_records</span>
      <span class='kw'>else</span>
        <span class='id release_savepoint'>release_savepoint</span>
        <span class='id save_point_records'>save_point_records</span> <span class='op'>=</span> <span class='ivar'>@_current_transaction_records</span><span class='period'>.</span><span class='id pop'>pop</span>
        <span class='kw'>unless</span> <span class='id save_point_records'>save_point_records</span><span class='period'>.</span><span class='id blank?'>blank?</span>
          <span class='ivar'>@_current_transaction_records</span><span class='period'>.</span><span class='id push'>push</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='ivar'>@_current_transaction_records</span><span class='period'>.</span><span class='id empty?'>empty?</span>
          <span class='ivar'>@_current_transaction_records</span><span class='period'>.</span><span class='id last'>last</span><span class='period'>.</span><span class='id concat'>concat</span><span class='lparen'>(</span><span class='id save_point_records'>save_point_records</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='kw'>rescue</span> <span class='const'>Exception</span> <span class='op'>=&gt;</span> <span class='id database_transaction_rollback'>database_transaction_rollback</span>
      <span class='kw'>if</span> <span class='id open_transactions'>open_transactions</span> <span class='op'>==</span> <span class='int'>0</span>
        <span class='id rollback_db_transaction'>rollback_db_transaction</span>
        <span class='id rollback_transaction_records'>rollback_transaction_records</span><span class='lparen'>(</span><span class='kw'>true</span><span class='rparen'>)</span>
      <span class='kw'>else</span>
        <span class='id rollback_to_savepoint'>rollback_to_savepoint</span>
        <span class='id rollback_transaction_records'>rollback_transaction_records</span><span class='lparen'>(</span><span class='kw'>false</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
      <span class='id raise'>raise</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="update-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>update</strong>(sql, name = nil) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Executes the update statement and returns the number of rows affected.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


48
49
50</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/abstract/database_statements.rb', line 48</span>

<span class='kw'>def</span> <span class='id update'>update</span><span class='lparen'>(</span><span class='id sql'>sql</span><span class='comma'>,</span> <span class='id name'>name</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id update_sql'>update_sql</span><span class='lparen'>(</span><span class='id sql'>sql</span><span class='comma'>,</span> <span class='id name'>name</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>
    
    <div id="footer">
  Generated on Thu Nov  4 20:04:33 2010 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.6.1 (ruby-1.9.2).
</div>

  </body>
</html>