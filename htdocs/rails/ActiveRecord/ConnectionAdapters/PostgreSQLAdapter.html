<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta name="Content-Type" content="text/html; charset=utf-8" />
<title>Class: ActiveRecord::ConnectionAdapters::PostgreSQLAdapter</title>
<link rel="stylesheet" href="../../css/style.css" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="../../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '../..';
  if (relpath != '') relpath += '/';
</script>
<script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>

  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="../../_index.html">Index (P)</a> &raquo; 
    <span class='title'><span class='object_link'><a href="../../ActiveRecord.html" title="ActiveRecord (module)">ActiveRecord</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../ConnectionAdapters.html" title="ActiveRecord::ConnectionAdapters (module)">ConnectionAdapters</a></span></span>
     &raquo; 
    <span class="title">PostgreSQLAdapter</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  <a id="class_list_link" href="#">Class List</a>
  <a id="method_list_link" href="#">Method List</a>
  <a id ="file_list_link" href="#">File List</a>
</div>

      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><h1>Class: ActiveRecord::ConnectionAdapters::PostgreSQLAdapter
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName"><span class='object_link'><a href="AbstractAdapter.html" title="ActiveRecord::ConnectionAdapters::AbstractAdapter (class)">AbstractAdapter</a></span></span>
      
        <ul class="fullTree">
          <li><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></li>
          
            <li class="next"><span class='object_link'><a href="AbstractAdapter.html" title="ActiveRecord::ConnectionAdapters::AbstractAdapter (class)">AbstractAdapter</a></span></li>
          
            <li class="next">ActiveRecord::ConnectionAdapters::PostgreSQLAdapter</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>
The PostgreSQL adapter works both with the native C (<a
href="http://ruby.scripting.ca/postgres">ruby.scripting.ca/postgres</a>/)
and the pure Ruby (available both as gem and from <a
href="http://rubyforge.org/frs/?group_id=234&release_id=1944">rubyforge.org/frs/?group_id=234&release_id=1944</a>)
drivers.
</p>
<p>
Options:
</p>
<ul>
<li><p>
<tt>:host</tt> - Defaults to &#8220;localhost&#8221;.
</p>
</li>
<li><p>
<tt>:port</tt> - Defaults to 5432.
</p>
</li>
<li><p>
<tt>:username</tt> - Defaults to nothing.
</p>
</li>
<li><p>
<tt>:password</tt> - Defaults to nothing.
</p>
</li>
<li><p>
<tt>:database</tt> - The name of the database. No default, must be
provided.
</p>
</li>
<li><p>
<tt>:schema_search_path</tt> - An optional schema search path for the
connection given as a string of comma-separated schema names.  This is
backward-compatible with the <tt>:schema_order</tt> option.
</p>
</li>
<li><p>
<tt>:encoding</tt> - An optional client encoding that is used in a <tt>SET
client_encoding TO &lt;encoding&gt;</tt> call on the connection.
</p>
</li>
<li><p>
<tt>:min_messages</tt> - An optional client min messages that is used in a
<tt>SET client_min_messages TO &lt;min_messages&gt;</tt> call on the
connection.
</p>
</li>
<li><p>
<tt>:allow_concurrency</tt> - If true, use async query methods so Ruby
threads don&#8217;t deadlock; otherwise, use blocking query methods.
</p>
</li>
</ul>


  </div>
</div>
<div class="tags">
  
</div>
  <h2>Constant Summary</h2>
  
    <dl class="constants">
      
        <dt id="ADAPTER_NAME-constant" class="">ADAPTER_NAME =
          
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>PostgreSQL</span><span class='tstring_end'>'</span></span><span class='period'>.</span><span class='id freeze'>freeze</span></pre></dd>
      
        <dt id="NATIVE_DATABASE_TYPES-constant" class="">NATIVE_DATABASE_TYPES =
          
        </dt>
        <dd><pre class="code"><span class='lbrace'>{</span>
  <span class='symbol'>:primary_key</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>serial primary key</span><span class='tstring_end'>&quot;</span></span><span class='period'>.</span><span class='id freeze'>freeze</span><span class='comma'>,</span>
  <span class='symbol'>:string</span>      <span class='op'>=&gt;</span> <span class='lbrace'>{</span> <span class='symbol'>:name</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>character varying</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='symbol'>:limit</span> <span class='op'>=&gt;</span> <span class='int'>255</span> <span class='rbrace'>}</span><span class='comma'>,</span>
  <span class='symbol'>:text</span>        <span class='op'>=&gt;</span> <span class='lbrace'>{</span> <span class='symbol'>:name</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>text</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span><span class='comma'>,</span>
  <span class='symbol'>:integer</span>     <span class='op'>=&gt;</span> <span class='lbrace'>{</span> <span class='symbol'>:name</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>integer</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span><span class='comma'>,</span>
  <span class='symbol'>:float</span>       <span class='op'>=&gt;</span> <span class='lbrace'>{</span> <span class='symbol'>:name</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>float</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span><span class='comma'>,</span>
  <span class='symbol'>:decimal</span>     <span class='op'>=&gt;</span> <span class='lbrace'>{</span> <span class='symbol'>:name</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>decimal</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span><span class='comma'>,</span>
  <span class='symbol'>:datetime</span>    <span class='op'>=&gt;</span> <span class='lbrace'>{</span> <span class='symbol'>:name</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>timestamp</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span><span class='comma'>,</span>
  <span class='symbol'>:timestamp</span>   <span class='op'>=&gt;</span> <span class='lbrace'>{</span> <span class='symbol'>:name</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>timestamp</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span><span class='comma'>,</span>
  <span class='symbol'>:time</span>        <span class='op'>=&gt;</span> <span class='lbrace'>{</span> <span class='symbol'>:name</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>time</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span><span class='comma'>,</span>
  <span class='symbol'>:date</span>        <span class='op'>=&gt;</span> <span class='lbrace'>{</span> <span class='symbol'>:name</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>date</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span><span class='comma'>,</span>
  <span class='symbol'>:binary</span>      <span class='op'>=&gt;</span> <span class='lbrace'>{</span> <span class='symbol'>:name</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>bytea</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span><span class='comma'>,</span>
  <span class='symbol'>:boolean</span>     <span class='op'>=&gt;</span> <span class='lbrace'>{</span> <span class='symbol'>:name</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>boolean</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span><span class='comma'>,</span>
  <span class='symbol'>:xml</span>         <span class='op'>=&gt;</span> <span class='lbrace'>{</span> <span class='symbol'>:name</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>xml</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>
<span class='rbrace'>}</span></pre></dd>
      
        <dt id="MONEY_COLUMN_TYPE_OID-constant" class="">MONEY_COLUMN_TYPE_OID =
          <div class="docstring">
  <div class="discussion">
    <p>
The internal PostgreSQL identifier of the money data type.
</p>


  </div>
</div>
<div class="tags">
  
</div>
        </dt>
        <dd><pre class="code"><span class='int'>790</span></pre></dd>
      
        <dt id="BYTEA_COLUMN_TYPE_OID-constant" class="">BYTEA_COLUMN_TYPE_OID =
          <div class="docstring">
  <div class="discussion">
    <p>
:nodoc:
</p>


  </div>
</div>
<div class="tags">
  
</div>
        </dt>
        <dd><pre class="code"><span class='int'>17</span></pre></dd>
      
    </dl>
  


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  

  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#active%3F-instance_method" title="#active? (instance method)">- (Boolean) <strong>active?</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Is this connection alive and ready for queries?.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#adapter_name-instance_method" title="#adapter_name (instance method)">- (Object) <strong>adapter_name</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns &#8216;PostgreSQL&#8217; as adapter name for identification
purposes.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add_column-instance_method" title="#add_column (instance method)">- (Object) <strong>add_column</strong>(table_name, column_name, type, options = {}) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Adds a new column to the named table.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#begin_db_transaction-instance_method" title="#begin_db_transaction (instance method)">- (Object) <strong>begin_db_transaction</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Begins a transaction.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#change_column-instance_method" title="#change_column (instance method)">- (Object) <strong>change_column</strong>(table_name, column_name, type, options = {}) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Changes the column of a table.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#change_column_default-instance_method" title="#change_column_default (instance method)">- (Object) <strong>change_column_default</strong>(table_name, column_name, default) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Changes the default value of a table column.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#change_column_null-instance_method" title="#change_column_null (instance method)">- (Object) <strong>change_column_null</strong>(table_name, column_name, null, default = nil) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#client_min_messages-instance_method" title="#client_min_messages (instance method)">- (Object) <strong>client_min_messages</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns the current client message level.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#client_min_messages%3D-instance_method" title="#client_min_messages= (instance method)">- (Object) <strong>client_min_messages=</strong>(level) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Set the client message level.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#columns-instance_method" title="#columns (instance method)">- (Object) <strong>columns</strong>(table_name, name = nil) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns the list of all column definitions for a table.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#commit_db_transaction-instance_method" title="#commit_db_transaction (instance method)">- (Object) <strong>commit_db_transaction</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Commits a transaction.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create_database-instance_method" title="#create_database (instance method)">- (Object) <strong>create_database</strong>(name, options = {}) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Create a new PostgreSQL database.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create_savepoint-instance_method" title="#create_savepoint (instance method)">- (Object) <strong>create_savepoint</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#current_database-instance_method" title="#current_database (instance method)">- (Object) <strong>current_database</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns the current database name.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#default_sequence_name-instance_method" title="#default_sequence_name (instance method)">- (Object) <strong>default_sequence_name</strong>(table_name, pk = nil) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns the sequence name for a table&#8217;s primary key or some other
specified key.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#disable_referential_integrity-instance_method" title="#disable_referential_integrity (instance method)">- (Object) <strong>disable_referential_integrity</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
:nodoc:.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#disconnect%21-instance_method" title="#disconnect! (instance method)">- (Object) <strong>disconnect!</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Close the connection.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#distinct-instance_method" title="#distinct (instance method)">- (Object) <strong>distinct</strong>(columns, order_by) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns a SELECT DISTINCT clause for a given set of columns and a given
ORDER BY clause.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#drop_database-instance_method" title="#drop_database (instance method)">- (Object) <strong>drop_database</strong>(name) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Drops a PostgreSQL database.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#encoding-instance_method" title="#encoding (instance method)">- (Object) <strong>encoding</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns the current database encoding format.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#escape_bytea-instance_method" title="#escape_bytea (instance method)">- (Object) <strong>escape_bytea</strong>(value) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Escapes binary strings for bytea input to the database.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#execute-instance_method" title="#execute (instance method)">- (Object) <strong>execute</strong>(sql, name = nil) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Executes an SQL statement, returning a PGresult object on success or
raising a PGError exception otherwise.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#index_name_length-instance_method" title="#index_name_length (instance method)">- (Object) <strong>index_name_length</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#indexes-instance_method" title="#indexes (instance method)">- (Object) <strong>indexes</strong>(table_name, name = nil) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns the list of all indexes for a table.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">- (PostgreSQLAdapter) <strong>initialize</strong>(connection, logger, connection_parameters, config) </a>
    

    
  </span>
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Initializes and connects a PostgreSQL adapter.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#insert-instance_method" title="#insert (instance method)">- (Object) <strong>insert</strong>(sql, name = nil, pk = nil, id_value = nil, sequence_name = nil) </a>
    

    
      (also: #create)
    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Executes an INSERT query and returns the new record&#8217;s ID.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#native_database_types-instance_method" title="#native_database_types (instance method)">- (Object) <strong>native_database_types</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
:nodoc:.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#outside_transaction%3F-instance_method" title="#outside_transaction? (instance method)">- (Boolean) <strong>outside_transaction?</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#pk_and_sequence_for-instance_method" title="#pk_and_sequence_for (instance method)">- (Object) <strong>pk_and_sequence_for</strong>(table) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns a table&#8217;s primary key and belonging sequence.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#primary_key-instance_method" title="#primary_key (instance method)">- (Object) <strong>primary_key</strong>(table) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns just a table&#8217;s primary key.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#query-instance_method" title="#query (instance method)">- (Object) <strong>query</strong>(sql, name = nil) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Queries the database and returns the results in an Array-like object.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#quote-instance_method" title="#quote (instance method)">- (Object) <strong>quote</strong>(value, column = nil) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Quotes PostgreSQL-specific data types for SQL input.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#quote_column_name-instance_method" title="#quote_column_name (instance method)">- (Object) <strong>quote_column_name</strong>(name) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Quotes column names for use in SQL queries.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#quote_string-instance_method" title="#quote_string (instance method)">- (Object) <strong>quote_string</strong>(s) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Quotes strings for use in SQL input.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#quote_table_name-instance_method" title="#quote_table_name (instance method)">- (Object) <strong>quote_table_name</strong>(name) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Checks the following cases:.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#quoted_date-instance_method" title="#quoted_date (instance method)">- (Object) <strong>quoted_date</strong>(value) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Quote date/time values for use in SQL input.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#reconnect%21-instance_method" title="#reconnect! (instance method)">- (Object) <strong>reconnect!</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Close then reopen the connection.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#recreate_database-instance_method" title="#recreate_database (instance method)">- (Object) <strong>recreate_database</strong>(name) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
SCHEMA STATEMENTS ========================================.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#release_savepoint-instance_method" title="#release_savepoint (instance method)">- (Object) <strong>release_savepoint</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#remove_index%21-instance_method" title="#remove_index! (instance method)">- (Object) <strong>remove_index!</strong>(table_name, index_name) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
:nodoc:.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#rename_column-instance_method" title="#rename_column (instance method)">- (Object) <strong>rename_column</strong>(table_name, column_name, new_column_name) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Renames a column in a table.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#rename_table-instance_method" title="#rename_table (instance method)">- (Object) <strong>rename_table</strong>(name, new_name) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Renames a table.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#reset_pk_sequence%21-instance_method" title="#reset_pk_sequence! (instance method)">- (Object) <strong>reset_pk_sequence!</strong>(table, pk = nil, sequence = nil) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Resets the sequence of a table&#8217;s primary key to the maximum value.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#result_as_array-instance_method" title="#result_as_array (instance method)">- (Object) <strong>result_as_array</strong>(res) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
create a 2D array representing the result set.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#rollback_db_transaction-instance_method" title="#rollback_db_transaction (instance method)">- (Object) <strong>rollback_db_transaction</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Aborts a transaction.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#rollback_to_savepoint-instance_method" title="#rollback_to_savepoint (instance method)">- (Object) <strong>rollback_to_savepoint</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#schema_search_path-instance_method" title="#schema_search_path (instance method)">- (Object) <strong>schema_search_path</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns the active schema search path.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#schema_search_path%3D-instance_method" title="#schema_search_path= (instance method)">- (Object) <strong>schema_search_path=</strong>(schema_csv) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Sets the schema search path to a string of comma-separated schema names.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#select_rows-instance_method" title="#select_rows (instance method)">- (Object) <strong>select_rows</strong>(sql, name = nil) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Executes a SELECT query and returns an array of rows.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#set_standard_conforming_strings-instance_method" title="#set_standard_conforming_strings (instance method)">- (Object) <strong>set_standard_conforming_strings</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Enable standard-conforming strings if available.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#supports_ddl_transactions%3F-instance_method" title="#supports_ddl_transactions? (instance method)">- (Boolean) <strong>supports_ddl_transactions?</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#supports_disable_referential_integrity%3F-instance_method" title="#supports_disable_referential_integrity? (instance method)">- (Boolean) <strong>supports_disable_referential_integrity?</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
REFERENTIAL INTEGRITY ====================================.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#supports_insert_with_returning%3F-instance_method" title="#supports_insert_with_returning? (instance method)">- (Boolean) <strong>supports_insert_with_returning?</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#supports_migrations%3F-instance_method" title="#supports_migrations? (instance method)">- (Boolean) <strong>supports_migrations?</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Does PostgreSQL support migrations?.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#supports_primary_key%3F-instance_method" title="#supports_primary_key? (instance method)">- (Boolean) <strong>supports_primary_key?</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Does PostgreSQL support finding primary key on non-Active Record tables?.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#supports_savepoints%3F-instance_method" title="#supports_savepoints? (instance method)">- (Boolean) <strong>supports_savepoints?</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#table_alias_length-instance_method" title="#table_alias_length (instance method)">- (Object) <strong>table_alias_length</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns the configured supported identifier length supported by PostgreSQL,
or report the default of 63 on PostgreSQL 7.x.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#table_exists%3F-instance_method" title="#table_exists? (instance method)">- (Boolean) <strong>table_exists?</strong>(name) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#tables-instance_method" title="#tables (instance method)">- (Object) <strong>tables</strong>(name = nil) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns the list of all tables in the schema search path or a specified
schema.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#type_to_sql-instance_method" title="#type_to_sql (instance method)">- (Object) <strong>type_to_sql</strong>(type, limit = nil, precision = nil, scale = nil) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Maps logical Rails types to PostgreSQL-specific data types.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#unescape_bytea-instance_method" title="#unescape_bytea (instance method)">- (Object) <strong>unescape_bytea</strong>(value) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Unescapes bytea output from a database to the binary string it represents.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#update_sql-instance_method" title="#update_sql (instance method)">- (Object) <strong>update_sql</strong>(sql, name = nil) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Executes an UPDATE query and returns the number of affected tuples.
</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  <h3 class="inherited">Methods inherited from <span class='object_link'><a href="AbstractAdapter.html" title="ActiveRecord::ConnectionAdapters::AbstractAdapter (class)">AbstractAdapter</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="AbstractAdapter.html#current_savepoint_name-instance_method" title="ActiveRecord::ConnectionAdapters::AbstractAdapter#current_savepoint_name (method)">#current_savepoint_name</a></span>, <span class='object_link'><a href="AbstractAdapter.html#decrement_open_transactions-instance_method" title="ActiveRecord::ConnectionAdapters::AbstractAdapter#decrement_open_transactions (method)">#decrement_open_transactions</a></span>, <span class='object_link'><a href="AbstractAdapter.html#increment_open_transactions-instance_method" title="ActiveRecord::ConnectionAdapters::AbstractAdapter#increment_open_transactions (method)">#increment_open_transactions</a></span>, <span class='object_link'><a href="AbstractAdapter.html#open_transactions-instance_method" title="ActiveRecord::ConnectionAdapters::AbstractAdapter#open_transactions (method)">#open_transactions</a></span>, <span class='object_link'><a href="AbstractAdapter.html#prefetch_primary_key%3F-instance_method" title="ActiveRecord::ConnectionAdapters::AbstractAdapter#prefetch_primary_key? (method)">#prefetch_primary_key?</a></span>, <span class='object_link'><a href="AbstractAdapter.html#raw_connection-instance_method" title="ActiveRecord::ConnectionAdapters::AbstractAdapter#raw_connection (method)">#raw_connection</a></span>, <span class='object_link'><a href="AbstractAdapter.html#requires_reloading%3F-instance_method" title="ActiveRecord::ConnectionAdapters::AbstractAdapter#requires_reloading? (method)">#requires_reloading?</a></span>, <span class='object_link'><a href="AbstractAdapter.html#reset%21-instance_method" title="ActiveRecord::ConnectionAdapters::AbstractAdapter#reset! (method)">#reset!</a></span>, <span class='object_link'><a href="AbstractAdapter.html#supports_count_distinct%3F-instance_method" title="ActiveRecord::ConnectionAdapters::AbstractAdapter#supports_count_distinct? (method)">#supports_count_distinct?</a></span>, <span class='object_link'><a href="AbstractAdapter.html#transaction_joinable%3D-instance_method" title="ActiveRecord::ConnectionAdapters::AbstractAdapter#transaction_joinable= (method)">#transaction_joinable=</a></span>, <span class='object_link'><a href="AbstractAdapter.html#verify%21-instance_method" title="ActiveRecord::ConnectionAdapters::AbstractAdapter#verify! (method)">#verify!</a></span></p>

  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="../../ActiveSupport/Callbacks.html" title="ActiveSupport::Callbacks (module)">ActiveSupport::Callbacks</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../../ActiveSupport/Callbacks.html#callback-instance_method" title="ActiveSupport::Callbacks#callback (method)">#callback</a></span>, <span class='object_link'><a href="../../ActiveSupport/Callbacks.html#run_callbacks-instance_method" title="ActiveSupport::Callbacks#run_callbacks (method)">#run_callbacks</a></span></p>

  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="../../ActiveSupport/Concern.html" title="ActiveSupport::Concern (module)">ActiveSupport::Concern</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../../ActiveSupport/Concern.html#append_features-instance_method" title="ActiveSupport::Concern#append_features (method)">#append_features</a></span>, <span class='object_link'><a href="../../ActiveSupport/Concern.html#extended-class_method" title="ActiveSupport::Concern.extended (method)">extended</a></span>, <span class='object_link'><a href="../../ActiveSupport/Concern.html#included-instance_method" title="ActiveSupport::Concern#included (method)">#included</a></span></p>

  
  
  
  
  
  
  
  <h3 class="inherited">Methods inherited from <span class='object_link'><a href="../QueryCache.html" title="ActiveRecord::QueryCache (class)">QueryCache</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../QueryCache.html#call-instance_method" title="ActiveRecord::QueryCache#call (method)">#call</a></span></p>

  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="DatabaseLimits.html" title="ActiveRecord::ConnectionAdapters::DatabaseLimits (module)">DatabaseLimits</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="DatabaseLimits.html#column_name_length-instance_method" title="ActiveRecord::ConnectionAdapters::DatabaseLimits#column_name_length (method)">#column_name_length</a></span>, <span class='object_link'><a href="DatabaseLimits.html#columns_per_multicolumn_index-instance_method" title="ActiveRecord::ConnectionAdapters::DatabaseLimits#columns_per_multicolumn_index (method)">#columns_per_multicolumn_index</a></span>, <span class='object_link'><a href="DatabaseLimits.html#columns_per_table-instance_method" title="ActiveRecord::ConnectionAdapters::DatabaseLimits#columns_per_table (method)">#columns_per_table</a></span>, <span class='object_link'><a href="DatabaseLimits.html#in_clause_length-instance_method" title="ActiveRecord::ConnectionAdapters::DatabaseLimits#in_clause_length (method)">#in_clause_length</a></span>, <span class='object_link'><a href="DatabaseLimits.html#indexes_per_table-instance_method" title="ActiveRecord::ConnectionAdapters::DatabaseLimits#indexes_per_table (method)">#indexes_per_table</a></span>, <span class='object_link'><a href="DatabaseLimits.html#joins_per_query-instance_method" title="ActiveRecord::ConnectionAdapters::DatabaseLimits#joins_per_query (method)">#joins_per_query</a></span>, <span class='object_link'><a href="DatabaseLimits.html#sql_query_length-instance_method" title="ActiveRecord::ConnectionAdapters::DatabaseLimits#sql_query_length (method)">#sql_query_length</a></span>, <span class='object_link'><a href="DatabaseLimits.html#table_name_length-instance_method" title="ActiveRecord::ConnectionAdapters::DatabaseLimits#table_name_length (method)">#table_name_length</a></span></p>

  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="SchemaStatements.html" title="ActiveRecord::ConnectionAdapters::SchemaStatements (module)">SchemaStatements</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="SchemaStatements.html#add_column_options%21-instance_method" title="ActiveRecord::ConnectionAdapters::SchemaStatements#add_column_options! (method)">#add_column_options!</a></span>, <span class='object_link'><a href="SchemaStatements.html#add_index-instance_method" title="ActiveRecord::ConnectionAdapters::SchemaStatements#add_index (method)">#add_index</a></span>, <span class='object_link'><a href="SchemaStatements.html#add_timestamps-instance_method" title="ActiveRecord::ConnectionAdapters::SchemaStatements#add_timestamps (method)">#add_timestamps</a></span>, <span class='object_link'><a href="SchemaStatements.html#assume_migrated_upto_version-instance_method" title="ActiveRecord::ConnectionAdapters::SchemaStatements#assume_migrated_upto_version (method)">#assume_migrated_upto_version</a></span>, <span class='object_link'><a href="SchemaStatements.html#change_table-instance_method" title="ActiveRecord::ConnectionAdapters::SchemaStatements#change_table (method)">#change_table</a></span>, <span class='object_link'><a href="SchemaStatements.html#column_exists%3F-instance_method" title="ActiveRecord::ConnectionAdapters::SchemaStatements#column_exists? (method)">#column_exists?</a></span>, <span class='object_link'><a href="SchemaStatements.html#create_table-instance_method" title="ActiveRecord::ConnectionAdapters::SchemaStatements#create_table (method)">#create_table</a></span>, <span class='object_link'><a href="SchemaStatements.html#drop_table-instance_method" title="ActiveRecord::ConnectionAdapters::SchemaStatements#drop_table (method)">#drop_table</a></span>, <span class='object_link'><a href="SchemaStatements.html#dump_schema_information-instance_method" title="ActiveRecord::ConnectionAdapters::SchemaStatements#dump_schema_information (method)">#dump_schema_information</a></span>, <span class='object_link'><a href="SchemaStatements.html#index_exists%3F-instance_method" title="ActiveRecord::ConnectionAdapters::SchemaStatements#index_exists? (method)">#index_exists?</a></span>, <span class='object_link'><a href="SchemaStatements.html#index_name-instance_method" title="ActiveRecord::ConnectionAdapters::SchemaStatements#index_name (method)">#index_name</a></span>, <span class='object_link'><a href="SchemaStatements.html#index_name_exists%3F-instance_method" title="ActiveRecord::ConnectionAdapters::SchemaStatements#index_name_exists? (method)">#index_name_exists?</a></span>, <span class='object_link'><a href="SchemaStatements.html#initialize_schema_migrations_table-instance_method" title="ActiveRecord::ConnectionAdapters::SchemaStatements#initialize_schema_migrations_table (method)">#initialize_schema_migrations_table</a></span>, <span class='object_link'><a href="SchemaStatements.html#remove_column-instance_method" title="ActiveRecord::ConnectionAdapters::SchemaStatements#remove_column (method)">#remove_column</a></span>, <span class='object_link'><a href="SchemaStatements.html#remove_index-instance_method" title="ActiveRecord::ConnectionAdapters::SchemaStatements#remove_index (method)">#remove_index</a></span>, <span class='object_link'><a href="SchemaStatements.html#remove_timestamps-instance_method" title="ActiveRecord::ConnectionAdapters::SchemaStatements#remove_timestamps (method)">#remove_timestamps</a></span>, <span class='object_link'><a href="SchemaStatements.html#rename_index-instance_method" title="ActiveRecord::ConnectionAdapters::SchemaStatements#rename_index (method)">#rename_index</a></span>, <span class='object_link'><a href="SchemaStatements.html#structure_dump-instance_method" title="ActiveRecord::ConnectionAdapters::SchemaStatements#structure_dump (method)">#structure_dump</a></span>, <span class='object_link'><a href="SchemaStatements.html#table_alias_for-instance_method" title="ActiveRecord::ConnectionAdapters::SchemaStatements#table_alias_for (method)">#table_alias_for</a></span></p>

  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="DatabaseStatements.html" title="ActiveRecord::ConnectionAdapters::DatabaseStatements (module)">DatabaseStatements</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="DatabaseStatements.html#add_limit_offset%21-instance_method" title="ActiveRecord::ConnectionAdapters::DatabaseStatements#add_limit_offset! (method)">#add_limit_offset!</a></span>, <span class='object_link'><a href="DatabaseStatements.html#add_transaction_record-instance_method" title="ActiveRecord::ConnectionAdapters::DatabaseStatements#add_transaction_record (method)">#add_transaction_record</a></span>, <span class='object_link'><a href="DatabaseStatements.html#case_sensitive_equality_operator-instance_method" title="ActiveRecord::ConnectionAdapters::DatabaseStatements#case_sensitive_equality_operator (method)">#case_sensitive_equality_operator</a></span>, <span class='object_link'><a href="DatabaseStatements.html#delete-instance_method" title="ActiveRecord::ConnectionAdapters::DatabaseStatements#delete (method)">#delete</a></span>, <span class='object_link'><a href="DatabaseStatements.html#empty_insert_statement_value-instance_method" title="ActiveRecord::ConnectionAdapters::DatabaseStatements#empty_insert_statement_value (method)">#empty_insert_statement_value</a></span>, <span class='object_link'><a href="DatabaseStatements.html#insert_fixture-instance_method" title="ActiveRecord::ConnectionAdapters::DatabaseStatements#insert_fixture (method)">#insert_fixture</a></span>, <span class='object_link'><a href="DatabaseStatements.html#limited_update_conditions-instance_method" title="ActiveRecord::ConnectionAdapters::DatabaseStatements#limited_update_conditions (method)">#limited_update_conditions</a></span>, <span class='object_link'><a href="DatabaseStatements.html#reset_sequence%21-instance_method" title="ActiveRecord::ConnectionAdapters::DatabaseStatements#reset_sequence! (method)">#reset_sequence!</a></span>, <span class='object_link'><a href="DatabaseStatements.html#select_all-instance_method" title="ActiveRecord::ConnectionAdapters::DatabaseStatements#select_all (method)">#select_all</a></span>, <span class='object_link'><a href="DatabaseStatements.html#select_one-instance_method" title="ActiveRecord::ConnectionAdapters::DatabaseStatements#select_one (method)">#select_one</a></span>, <span class='object_link'><a href="DatabaseStatements.html#select_value-instance_method" title="ActiveRecord::ConnectionAdapters::DatabaseStatements#select_value (method)">#select_value</a></span>, <span class='object_link'><a href="DatabaseStatements.html#select_values-instance_method" title="ActiveRecord::ConnectionAdapters::DatabaseStatements#select_values (method)">#select_values</a></span>, <span class='object_link'><a href="DatabaseStatements.html#transaction-instance_method" title="ActiveRecord::ConnectionAdapters::DatabaseStatements#transaction (method)">#transaction</a></span>, <span class='object_link'><a href="DatabaseStatements.html#update-instance_method" title="ActiveRecord::ConnectionAdapters::DatabaseStatements#update (method)">#update</a></span></p>

  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Quoting.html" title="ActiveRecord::ConnectionAdapters::Quoting (module)">Quoting</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Quoting.html#quoted_false-instance_method" title="ActiveRecord::ConnectionAdapters::Quoting#quoted_false (method)">#quoted_false</a></span>, <span class='object_link'><a href="Quoting.html#quoted_true-instance_method" title="ActiveRecord::ConnectionAdapters::Quoting#quoted_true (method)">#quoted_true</a></span></p>
<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <p class="signature first" id="initialize-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="ActiveRecord::ConnectionAdapters::PostgreSQLAdapter (class)">PostgreSQLAdapter</a></span></tt>) <strong>initialize</strong>(connection, logger, connection_parameters, config) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Initializes and connects a PostgreSQL adapter.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


219
220
221
222
223
224
225
226
227
228
229
230</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 219</span>

<span class='kw'>def</span> <span class='id initialize'>initialize</span><span class='lparen'>(</span><span class='id connection'>connection</span><span class='comma'>,</span> <span class='id logger'>logger</span><span class='comma'>,</span> <span class='id connection_parameters'>connection_parameters</span><span class='comma'>,</span> <span class='id config'>config</span><span class='rparen'>)</span>
  <span class='kw'>super</span><span class='lparen'>(</span><span class='id connection'>connection</span><span class='comma'>,</span> <span class='id logger'>logger</span><span class='rparen'>)</span>
  <span class='ivar'>@connection_parameters</span><span class='comma'>,</span> <span class='ivar'>@config</span> <span class='op'>=</span> <span class='id connection_parameters'>connection_parameters</span><span class='comma'>,</span> <span class='id config'>config</span>

  <span class='comment'># @local_tz is initialized as nil to avoid warnings when connect tries to use it
</span>  <span class='ivar'>@local_tz</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@table_alias_length</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@postgresql_version</span> <span class='op'>=</span> <span class='kw'>nil</span>

  <span class='id connect'>connect</span>
  <span class='ivar'>@local_tz</span> <span class='op'>=</span> <span class='id execute'>execute</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>SHOW TIME ZONE</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id first'>first</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>TimeZone</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="active?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>active?</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Is this connection alive and ready for queries?
</p>


  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


233
234
235
236
237
238
239
240
241
242
243
244</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 233</span>

<span class='kw'>def</span> <span class='id active?'>active?</span>
  <span class='kw'>if</span> <span class='ivar'>@connection</span><span class='period'>.</span><span class='id respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:status</span><span class='rparen'>)</span>
    <span class='ivar'>@connection</span><span class='period'>.</span><span class='id status'>status</span> <span class='op'>==</span> <span class='const'>PGconn</span><span class='op'>::</span><span class='const'>CONNECTION_OK</span>
  <span class='kw'>else</span>
    <span class='comment'># We're asking the driver, not Active Record, so use @connection.query instead of #query
</span>    <span class='ivar'>@connection</span><span class='period'>.</span><span class='id query'>query</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>SELECT 1</span><span class='tstring_end'>'</span></span>
    <span class='kw'>true</span>
  <span class='kw'>end</span>
<span class='comment'># postgres-pr raises a NoMethodError when querying if no connection is available.
</span><span class='kw'>rescue</span> <span class='const'>PGError</span><span class='comma'>,</span> <span class='const'>NoMethodError</span>
  <span class='kw'>false</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="adapter_name-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>adapter_name</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns &#8216;PostgreSQL&#8217; as adapter name for identification
purposes.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


214
215
216</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 214</span>

<span class='kw'>def</span> <span class='id adapter_name'>adapter_name</span>
  <span class='const'>ADAPTER_NAME</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="add_column-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>add_column</strong>(table_name, column_name, type, options = {}) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Adds a new column to the named table. See TableDefinition#column for
details of the options you can use.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


795
796
797
798
799
800
801
802
803
804</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 795</span>

<span class='kw'>def</span> <span class='id add_column'>add_column</span><span class='lparen'>(</span><span class='id table_name'>table_name</span><span class='comma'>,</span> <span class='id column_name'>column_name</span><span class='comma'>,</span> <span class='id type'>type</span><span class='comma'>,</span> <span class='id options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id default'>default</span> <span class='op'>=</span> <span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:default</span><span class='rbracket'>]</span>
  <span class='id notnull'>notnull</span> <span class='op'>=</span> <span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:null</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='kw'>false</span>

  <span class='comment'># Add the column.
</span>  <span class='id execute'>execute</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ALTER TABLE </span><span class='embexpr_beg'>#{</span><span class='id quote_table_name'>quote_table_name</span><span class='lparen'>(</span><span class='id table_name'>table_name</span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='tstring_content'> ADD COLUMN </span><span class='embexpr_beg'>#{</span><span class='id quote_column_name'>quote_column_name</span><span class='lparen'>(</span><span class='id column_name'>column_name</span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='tstring_content'> </span><span class='embexpr_beg'>#{</span><span class='id type_to_sql'>type_to_sql</span><span class='lparen'>(</span><span class='id type'>type</span><span class='comma'>,</span> <span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:limit</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:precision</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:scale</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

  <span class='id change_column_default'>change_column_default</span><span class='lparen'>(</span><span class='id table_name'>table_name</span><span class='comma'>,</span> <span class='id column_name'>column_name</span><span class='comma'>,</span> <span class='id default'>default</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id options_include_default?'>options_include_default?</span><span class='lparen'>(</span><span class='id options'>options</span><span class='rparen'>)</span>
  <span class='id change_column_null'>change_column_null</span><span class='lparen'>(</span><span class='id table_name'>table_name</span><span class='comma'>,</span> <span class='id column_name'>column_name</span><span class='comma'>,</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='id default'>default</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id notnull'>notnull</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="begin_db_transaction-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>begin_db_transaction</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Begins a transaction.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


511
512
513</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 511</span>

<span class='kw'>def</span> <span class='id begin_db_transaction'>begin_db_transaction</span>
  <span class='id execute'>execute</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>BEGIN</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="change_column-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>change_column</strong>(table_name, column_name, type, options = {}) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Changes the column of a table.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


807
808
809
810
811
812
813
814
815
816
817
818
819
820
821
822
823
824
825
826
827
828
829
830</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 807</span>

<span class='kw'>def</span> <span class='id change_column'>change_column</span><span class='lparen'>(</span><span class='id table_name'>table_name</span><span class='comma'>,</span> <span class='id column_name'>column_name</span><span class='comma'>,</span> <span class='id type'>type</span><span class='comma'>,</span> <span class='id options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id quoted_table_name'>quoted_table_name</span> <span class='op'>=</span> <span class='id quote_table_name'>quote_table_name</span><span class='lparen'>(</span><span class='id table_name'>table_name</span><span class='rparen'>)</span>

  <span class='kw'>begin</span>
    <span class='id execute'>execute</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ALTER TABLE </span><span class='embexpr_beg'>#{</span><span class='id quoted_table_name'>quoted_table_name</span><span class='rbrace'>}</span><span class='tstring_content'> ALTER COLUMN </span><span class='embexpr_beg'>#{</span><span class='id quote_column_name'>quote_column_name</span><span class='lparen'>(</span><span class='id column_name'>column_name</span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='tstring_content'> TYPE </span><span class='embexpr_beg'>#{</span><span class='id type_to_sql'>type_to_sql</span><span class='lparen'>(</span><span class='id type'>type</span><span class='comma'>,</span> <span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:limit</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:precision</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:scale</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>rescue</span> <span class='const'>ActiveRecord</span><span class='op'>::</span><span class='const'>StatementInvalid</span> <span class='op'>=&gt;</span> <span class='id e'>e</span>
    <span class='id raise'>raise</span> <span class='id e'>e</span> <span class='kw'>if</span> <span class='id postgresql_version'>postgresql_version</span> <span class='op'>&gt;</span> <span class='int'>80000</span>
    <span class='comment'># This is PostgreSQL 7.x, so we have to use a more arcane way of doing it.
</span>    <span class='kw'>begin</span>
      <span class='id begin_db_transaction'>begin_db_transaction</span>
      <span class='id tmp_column_name'>tmp_column_name</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id column_name'>column_name</span><span class='rbrace'>}</span><span class='tstring_content'>_ar_tmp</span><span class='tstring_end'>&quot;</span></span>
      <span class='id add_column'>add_column</span><span class='lparen'>(</span><span class='id table_name'>table_name</span><span class='comma'>,</span> <span class='id tmp_column_name'>tmp_column_name</span><span class='comma'>,</span> <span class='id type'>type</span><span class='comma'>,</span> <span class='id options'>options</span><span class='rparen'>)</span>
      <span class='id execute'>execute</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>UPDATE </span><span class='embexpr_beg'>#{</span><span class='id quoted_table_name'>quoted_table_name</span><span class='rbrace'>}</span><span class='tstring_content'> SET </span><span class='embexpr_beg'>#{</span><span class='id quote_column_name'>quote_column_name</span><span class='lparen'>(</span><span class='id tmp_column_name'>tmp_column_name</span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='tstring_content'> = CAST(</span><span class='embexpr_beg'>#{</span><span class='id quote_column_name'>quote_column_name</span><span class='lparen'>(</span><span class='id column_name'>column_name</span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='tstring_content'> AS </span><span class='embexpr_beg'>#{</span><span class='id type_to_sql'>type_to_sql</span><span class='lparen'>(</span><span class='id type'>type</span><span class='comma'>,</span> <span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:limit</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:precision</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:scale</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span>
      <span class='id remove_column'>remove_column</span><span class='lparen'>(</span><span class='id table_name'>table_name</span><span class='comma'>,</span> <span class='id column_name'>column_name</span><span class='rparen'>)</span>
      <span class='id rename_column'>rename_column</span><span class='lparen'>(</span><span class='id table_name'>table_name</span><span class='comma'>,</span> <span class='id tmp_column_name'>tmp_column_name</span><span class='comma'>,</span> <span class='id column_name'>column_name</span><span class='rparen'>)</span>
      <span class='id commit_db_transaction'>commit_db_transaction</span>
    <span class='kw'>rescue</span>
      <span class='id rollback_db_transaction'>rollback_db_transaction</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id change_column_default'>change_column_default</span><span class='lparen'>(</span><span class='id table_name'>table_name</span><span class='comma'>,</span> <span class='id column_name'>column_name</span><span class='comma'>,</span> <span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:default</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id options_include_default?'>options_include_default?</span><span class='lparen'>(</span><span class='id options'>options</span><span class='rparen'>)</span>
  <span class='id change_column_null'>change_column_null</span><span class='lparen'>(</span><span class='id table_name'>table_name</span><span class='comma'>,</span> <span class='id column_name'>column_name</span><span class='comma'>,</span> <span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:null</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:default</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id options'>options</span><span class='period'>.</span><span class='id key?'>key?</span><span class='lparen'>(</span><span class='symbol'>:null</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="change_column_default-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>change_column_default</strong>(table_name, column_name, default) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Changes the default value of a table column.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


833
834
835</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 833</span>

<span class='kw'>def</span> <span class='id change_column_default'>change_column_default</span><span class='lparen'>(</span><span class='id table_name'>table_name</span><span class='comma'>,</span> <span class='id column_name'>column_name</span><span class='comma'>,</span> <span class='id default'>default</span><span class='rparen'>)</span>
  <span class='id execute'>execute</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ALTER TABLE </span><span class='embexpr_beg'>#{</span><span class='id quote_table_name'>quote_table_name</span><span class='lparen'>(</span><span class='id table_name'>table_name</span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='tstring_content'> ALTER COLUMN </span><span class='embexpr_beg'>#{</span><span class='id quote_column_name'>quote_column_name</span><span class='lparen'>(</span><span class='id column_name'>column_name</span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='tstring_content'> SET DEFAULT </span><span class='embexpr_beg'>#{</span><span class='id quote'>quote</span><span class='lparen'>(</span><span class='id default'>default</span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="change_column_null-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>change_column_null</strong>(table_name, column_name, null, default = nil) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


837
838
839
840
841
842</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 837</span>

<span class='kw'>def</span> <span class='id change_column_null'>change_column_null</span><span class='lparen'>(</span><span class='id table_name'>table_name</span><span class='comma'>,</span> <span class='id column_name'>column_name</span><span class='comma'>,</span> <span class='id null'>null</span><span class='comma'>,</span> <span class='id default'>default</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='kw'>unless</span> <span class='id null'>null</span> <span class='op'>||</span> <span class='id default'>default</span><span class='period'>.</span><span class='id nil?'>nil?</span>
    <span class='id execute'>execute</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>UPDATE </span><span class='embexpr_beg'>#{</span><span class='id quote_table_name'>quote_table_name</span><span class='lparen'>(</span><span class='id table_name'>table_name</span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='tstring_content'> SET </span><span class='embexpr_beg'>#{</span><span class='id quote_column_name'>quote_column_name</span><span class='lparen'>(</span><span class='id column_name'>column_name</span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='tstring_content'>=</span><span class='embexpr_beg'>#{</span><span class='id quote'>quote</span><span class='lparen'>(</span><span class='id default'>default</span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='tstring_content'> WHERE </span><span class='embexpr_beg'>#{</span><span class='id quote_column_name'>quote_column_name</span><span class='lparen'>(</span><span class='id column_name'>column_name</span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='tstring_content'> IS NULL</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id execute'>execute</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ALTER TABLE </span><span class='embexpr_beg'>#{</span><span class='id quote_table_name'>quote_table_name</span><span class='lparen'>(</span><span class='id table_name'>table_name</span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='tstring_content'> ALTER </span><span class='embexpr_beg'>#{</span><span class='id quote_column_name'>quote_column_name</span><span class='lparen'>(</span><span class='id column_name'>column_name</span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='tstring_content'> </span><span class='embexpr_beg'>#{</span><span class='id null'>null</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>DROP</span><span class='tstring_end'>'</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>SET</span><span class='tstring_end'>'</span></span><span class='rbrace'>}</span><span class='tstring_content'> NOT NULL</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="client_min_messages-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>client_min_messages</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns the current client message level.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


698
699
700</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 698</span>

<span class='kw'>def</span> <span class='id client_min_messages'>client_min_messages</span>
  <span class='id query'>query</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>SHOW client_min_messages</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="client_min_messages=-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>client_min_messages=</strong>(level) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Set the client message level.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


703
704
705</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 703</span>

<span class='kw'>def</span> <span class='id client_min_messages='>client_min_messages=</span><span class='lparen'>(</span><span class='id level'>level</span><span class='rparen'>)</span>
  <span class='id execute'>execute</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SET client_min_messages TO '</span><span class='embexpr_beg'>#{</span><span class='id level'>level</span><span class='rbrace'>}</span><span class='tstring_content'>'</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="columns-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>columns</strong>(table_name, name = nil) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns the list of all column definitions for a table.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


660
661
662
663
664
665</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 660</span>

<span class='kw'>def</span> <span class='id columns'>columns</span><span class='lparen'>(</span><span class='id table_name'>table_name</span><span class='comma'>,</span> <span class='id name'>name</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='comment'># Limit, precision, and scale are all handled by the superclass.
</span>  <span class='id column_definitions'>column_definitions</span><span class='lparen'>(</span><span class='id table_name'>table_name</span><span class='rparen'>)</span><span class='period'>.</span><span class='id collect'>collect</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id name'>name</span><span class='comma'>,</span> <span class='id type'>type</span><span class='comma'>,</span> <span class='id default'>default</span><span class='comma'>,</span> <span class='id notnull'>notnull</span><span class='op'>|</span>
    <span class='const'>PostgreSQLColumn</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span><span class='id name'>name</span><span class='comma'>,</span> <span class='id default'>default</span><span class='comma'>,</span> <span class='id type'>type</span><span class='comma'>,</span> <span class='id notnull'>notnull</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>f</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="commit_db_transaction-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>commit_db_transaction</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Commits a transaction.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


516
517
518</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 516</span>

<span class='kw'>def</span> <span class='id commit_db_transaction'>commit_db_transaction</span>
  <span class='id execute'>execute</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>COMMIT</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="create_database-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>create_database</strong>(name, options = {}) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Create a new PostgreSQL database.  Options include <tt>:owner</tt>,
<tt>:template</tt>, <tt>:encoding</tt>, <tt>:tablespace</tt>, and
<tt>:connection_limit</tt> (note that MySQL uses <tt>:charset</tt> while
PostgreSQL uses <tt>:encoding</tt>).
</p>
<p>
Example:
</p>
<pre class="code">
  <span class='id create_database'>create_database</span> <span class='id config'>config</span><span class='lbracket'>[</span><span class='symbol'>:database</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id config'>config</span>
  <span class='id create_database'>create_database</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>foo_development</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='symbol'>:encoding</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>unicode</span><span class='tstring_end'>'</span></span></pre>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


555
556
557
558
559
560
561
562
563
564
565
566
567
568
569
570
571
572
573
574
575
576</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 555</span>

<span class='kw'>def</span> <span class='id create_database'>create_database</span><span class='lparen'>(</span><span class='id name'>name</span><span class='comma'>,</span> <span class='id options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id options'>options</span> <span class='op'>=</span> <span class='id options'>options</span><span class='period'>.</span><span class='id reverse_merge'>reverse_merge</span><span class='lparen'>(</span><span class='symbol'>:encoding</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>utf8</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

  <span class='id option_string'>option_string</span> <span class='op'>=</span> <span class='id options'>options</span><span class='period'>.</span><span class='id symbolize_keys'>symbolize_keys</span><span class='period'>.</span><span class='id sum'>sum</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id key'>key</span><span class='comma'>,</span> <span class='id value'>value</span><span class='op'>|</span>
    <span class='kw'>case</span> <span class='id key'>key</span>
    <span class='kw'>when</span> <span class='symbol'>:owner</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> OWNER = \&quot;</span><span class='embexpr_beg'>#{</span><span class='id value'>value</span><span class='rbrace'>}</span><span class='tstring_content'>\&quot;</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='symbol'>:template</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> TEMPLATE = \&quot;</span><span class='embexpr_beg'>#{</span><span class='id value'>value</span><span class='rbrace'>}</span><span class='tstring_content'>\&quot;</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='symbol'>:encoding</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> ENCODING = '</span><span class='embexpr_beg'>#{</span><span class='id value'>value</span><span class='rbrace'>}</span><span class='tstring_content'>'</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='symbol'>:tablespace</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> TABLESPACE = \&quot;</span><span class='embexpr_beg'>#{</span><span class='id value'>value</span><span class='rbrace'>}</span><span class='tstring_content'>\&quot;</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='symbol'>:connection_limit</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> CONNECTION LIMIT = </span><span class='embexpr_beg'>#{</span><span class='id value'>value</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>else</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id execute'>execute</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>CREATE DATABASE </span><span class='embexpr_beg'>#{</span><span class='id quote_table_name'>quote_table_name</span><span class='lparen'>(</span><span class='id name'>name</span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='embexpr_beg'>#{</span><span class='id option_string'>option_string</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="create_savepoint-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>create_savepoint</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


529
530
531</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 529</span>

<span class='kw'>def</span> <span class='id create_savepoint'>create_savepoint</span>
  <span class='id execute'>execute</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SAVEPOINT </span><span class='embexpr_beg'>#{</span><span class='id current_savepoint_name'>current_savepoint_name</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="current_database-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>current_database</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns the current database name.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


668
669
670</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 668</span>

<span class='kw'>def</span> <span class='id current_database'>current_database</span>
  <span class='id query'>query</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>select current_database()</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="default_sequence_name-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>default_sequence_name</strong>(table_name, pk = nil) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns the sequence name for a table&#8217;s primary key or some other
specified key.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


708
709
710
711</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 708</span>

<span class='kw'>def</span> <span class='id default_sequence_name'>default_sequence_name</span><span class='lparen'>(</span><span class='id table_name'>table_name</span><span class='comma'>,</span> <span class='id pk'>pk</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span> <span class='comment'>#:nodoc:
</span>  <span class='id default_pk'>default_pk</span><span class='comma'>,</span> <span class='id default_seq'>default_seq</span> <span class='op'>=</span> <span class='id pk_and_sequence_for'>pk_and_sequence_for</span><span class='lparen'>(</span><span class='id table_name'>table_name</span><span class='rparen'>)</span>
  <span class='id default_seq'>default_seq</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id table_name'>table_name</span><span class='rbrace'>}</span><span class='tstring_content'>_</span><span class='embexpr_beg'>#{</span><span class='id pk'>pk</span> <span class='op'>||</span> <span class='id default_pk'>default_pk</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>id</span><span class='tstring_end'>'</span></span><span class='rbrace'>}</span><span class='tstring_content'>_seq</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="disable_referential_integrity-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>disable_referential_integrity</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
:nodoc:
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


387
388
389
390
391
392
393
394
395
396</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 387</span>

<span class='kw'>def</span> <span class='id disable_referential_integrity'>disable_referential_integrity</span> <span class='comment'>#:nodoc:
</span>  <span class='kw'>if</span> <span class='id supports_disable_referential_integrity?'>supports_disable_referential_integrity?</span><span class='lparen'>(</span><span class='rparen'>)</span> <span class='kw'>then</span>
    <span class='id execute'>execute</span><span class='lparen'>(</span><span class='id tables'>tables</span><span class='period'>.</span><span class='id collect'>collect</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id name'>name</span><span class='op'>|</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ALTER TABLE </span><span class='embexpr_beg'>#{</span><span class='id quote_table_name'>quote_table_name</span><span class='lparen'>(</span><span class='id name'>name</span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='tstring_content'> DISABLE TRIGGER ALL</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='kw'>yield</span>
<span class='kw'>ensure</span>
  <span class='kw'>if</span> <span class='id supports_disable_referential_integrity?'>supports_disable_referential_integrity?</span><span class='lparen'>(</span><span class='rparen'>)</span> <span class='kw'>then</span>
    <span class='id execute'>execute</span><span class='lparen'>(</span><span class='id tables'>tables</span><span class='period'>.</span><span class='id collect'>collect</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id name'>name</span><span class='op'>|</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ALTER TABLE </span><span class='embexpr_beg'>#{</span><span class='id quote_table_name'>quote_table_name</span><span class='lparen'>(</span><span class='id name'>name</span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='tstring_content'> ENABLE TRIGGER ALL</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="disconnect!-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>disconnect!</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Close the connection.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


258
259
260</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 258</span>

<span class='kw'>def</span> <span class='id disconnect!'>disconnect!</span>
  <span class='ivar'>@connection</span><span class='period'>.</span><span class='id close'>close</span> <span class='kw'>rescue</span> <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="distinct-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>distinct</strong>(columns, order_by) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns a SELECT DISTINCT clause for a given set of columns and a given
ORDER BY clause.
</p>
<p>
PostgreSQL requires the ORDER BY columns in the select list for distinct
queries, and requires that the ORDER BY include the distinct column.
</p>
<pre class="code">
  <span class='id distinct'>distinct</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>posts.id</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>posts.created_at desc</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span></pre>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


876
877
878
879
880
881
882
883
884
885
886
887
888
889</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 876</span>

<span class='kw'>def</span> <span class='id distinct'>distinct</span><span class='lparen'>(</span><span class='id columns'>columns</span><span class='comma'>,</span> <span class='id order_by'>order_by</span><span class='rparen'>)</span> <span class='comment'>#:nodoc:
</span>  <span class='kw'>return</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DISTINCT </span><span class='embexpr_beg'>#{</span><span class='id columns'>columns</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id order_by'>order_by</span><span class='period'>.</span><span class='id blank?'>blank?</span>

  <span class='comment'># Construct a clean list of column names from the ORDER BY clause, removing
</span>  <span class='comment'># any ASC/DESC modifiers
</span>  <span class='id order_columns'>order_columns</span> <span class='op'>=</span> <span class='id order_by'>order_by</span><span class='period'>.</span><span class='id split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>,</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id collect'>collect</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id s'>s</span><span class='op'>|</span> <span class='id s'>s</span><span class='period'>.</span><span class='id split'>split</span><span class='period'>.</span><span class='id first'>first</span> <span class='rbrace'>}</span>
  <span class='id order_columns'>order_columns</span><span class='period'>.</span><span class='id delete_if'>delete_if</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id c'>c</span><span class='op'>|</span> <span class='id c'>c</span><span class='period'>.</span><span class='id blank?'>blank?</span> <span class='rbrace'>}</span>
  <span class='id order_columns'>order_columns</span> <span class='op'>=</span> <span class='id order_columns'>order_columns</span><span class='period'>.</span><span class='id zip'>zip</span><span class='lparen'>(</span><span class='lparen'>(</span><span class='int'>0</span><span class='op'>...</span><span class='id order_columns'>order_columns</span><span class='period'>.</span><span class='id size'>size</span><span class='rparen'>)</span><span class='period'>.</span><span class='id to_a'>to_a</span><span class='rparen'>)</span><span class='period'>.</span><span class='id map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id s'>s</span><span class='comma'>,</span><span class='id i'>i</span><span class='op'>|</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id s'>s</span><span class='rbrace'>}</span><span class='tstring_content'> AS alias_</span><span class='embexpr_beg'>#{</span><span class='id i'>i</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>

  <span class='comment'># Return a DISTINCT ON() clause that's distinct on the columns we want but includes
</span>  <span class='comment'># all the required columns for the ORDER BY to work properly.
</span>  <span class='id sql'>sql</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DISTINCT ON (</span><span class='embexpr_beg'>#{</span><span class='id columns'>columns</span><span class='rbrace'>}</span><span class='tstring_content'>) </span><span class='embexpr_beg'>#{</span><span class='id columns'>columns</span><span class='rbrace'>}</span><span class='tstring_content'>, </span><span class='tstring_end'>&quot;</span></span>
  <span class='id sql'>sql</span> <span class='op'>&lt;&lt;</span> <span class='id order_columns'>order_columns</span> <span class='op'>*</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>, </span><span class='tstring_end'>'</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="drop_database-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>drop_database</strong>(name) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Drops a PostgreSQL database
</p>
<p>
Example:
</p>
<pre class="code">
  <span class='id drop_database'>drop_database</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>matt_development</span><span class='tstring_end'>'</span></span></pre>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


582
583
584
585
586
587
588
589
590
591
592</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 582</span>

<span class='kw'>def</span> <span class='id drop_database'>drop_database</span><span class='lparen'>(</span><span class='id name'>name</span><span class='rparen'>)</span> <span class='comment'>#:nodoc:
</span>  <span class='kw'>if</span> <span class='id postgresql_version'>postgresql_version</span> <span class='op'>&gt;=</span> <span class='int'>80200</span>
    <span class='id execute'>execute</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DROP DATABASE IF EXISTS </span><span class='embexpr_beg'>#{</span><span class='id quote_table_name'>quote_table_name</span><span class='lparen'>(</span><span class='id name'>name</span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>else</span>
    <span class='kw'>begin</span>
      <span class='id execute'>execute</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DROP DATABASE </span><span class='embexpr_beg'>#{</span><span class='id quote_table_name'>quote_table_name</span><span class='lparen'>(</span><span class='id name'>name</span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>rescue</span> <span class='const'>ActiveRecord</span><span class='op'>::</span><span class='const'>StatementInvalid</span>
      <span class='ivar'>@logger</span><span class='period'>.</span><span class='id warn'>warn</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id name'>name</span><span class='rbrace'>}</span><span class='tstring_content'> database doesn't exist.</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='ivar'>@logger</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="encoding-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>encoding</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns the current database encoding format.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


673
674
675
676
677
678</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 673</span>

<span class='kw'>def</span> <span class='id encoding'>encoding</span>
  <span class='id query'>query</span><span class='lparen'>(</span><span class='heredoc_beg'>&lt;&lt;-end_sql</span><span class='tstring_content'>    SELECT pg_encoding_to_char(pg_database.encoding) FROM pg_database
</span><span class='tstring_content'>    WHERE pg_database.datname LIKE '</span><span class='embexpr_beg'>#{</span><span class='id current_database'>current_database</span><span class='rbrace'>}</span><span class='tstring_content'>'
</span><span class='heredoc_end'>  end_sql
</span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="escape_bytea-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>escape_bytea</strong>(value) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Escapes binary strings for bytea input to the database.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


305
306
307</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 305</span>

<span class='kw'>def</span> <span class='id escape_bytea'>escape_bytea</span><span class='lparen'>(</span><span class='id value'>value</span><span class='rparen'>)</span>
  <span class='ivar'>@connection</span><span class='period'>.</span><span class='id escape_bytea'>escape_bytea</span><span class='lparen'>(</span><span class='id value'>value</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id value'>value</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="execute-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>execute</strong>(sql, name = nil) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Executes an SQL statement, returning a PGresult object on success or
raising a PGError exception otherwise.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


495
496
497
498
499
500
501
502
503</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 495</span>

<span class='kw'>def</span> <span class='id execute'>execute</span><span class='lparen'>(</span><span class='id sql'>sql</span><span class='comma'>,</span> <span class='id name'>name</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id log'>log</span><span class='lparen'>(</span><span class='id sql'>sql</span><span class='comma'>,</span> <span class='id name'>name</span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='kw'>if</span> <span class='ivar'>@async</span>
      <span class='ivar'>@connection</span><span class='period'>.</span><span class='id async_exec'>async_exec</span><span class='lparen'>(</span><span class='id sql'>sql</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='ivar'>@connection</span><span class='period'>.</span><span class='id exec'>exec</span><span class='lparen'>(</span><span class='id sql'>sql</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="index_name_length-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>index_name_length</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


853
854
855</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 853</span>

<span class='kw'>def</span> <span class='id index_name_length'>index_name_length</span>
  <span class='int'>63</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="indexes-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>indexes</strong>(table_name, name = nil) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns the list of all indexes for a table.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


626
627
628
629
630
631
632
633
634
635
636
637
638
639
640
641
642
643
644
645
646
647
648
649
650
651
652
653
654
655
656
657</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 626</span>

<span class='kw'>def</span> <span class='id indexes'>indexes</span><span class='lparen'>(</span><span class='id table_name'>table_name</span><span class='comma'>,</span> <span class='id name'>name</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
   <span class='id schemas'>schemas</span> <span class='op'>=</span> <span class='id schema_search_path'>schema_search_path</span><span class='period'>.</span><span class='id split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>,</span><span class='regexp_end'>/</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id p'>p</span><span class='op'>|</span> <span class='id quote'>quote</span><span class='lparen'>(</span><span class='id p'>p</span><span class='rparen'>)</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>,</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
   <span class='id result'>result</span> <span class='op'>=</span> <span class='id query'>query</span><span class='lparen'>(</span><span class='heredoc_beg'>&lt;&lt;-SQL</span><span class='tstring_content'>     SELECT distinct i.relname, d.indisunique, d.indkey, t.oid
       FROM pg_class t, pg_class i, pg_index d
     WHERE i.relkind = 'i'
       AND d.indexrelid = i.oid
       AND d.indisprimary = 'f'
       AND t.oid = d.indrelid
</span><span class='tstring_content'>       AND t.relname = '</span><span class='embexpr_beg'>#{</span><span class='id table_name'>table_name</span><span class='rbrace'>}</span><span class='tstring_content'>'
</span><span class='tstring_content'>       AND i.relnamespace IN (SELECT oid FROM pg_namespace WHERE nspname IN (</span><span class='embexpr_beg'>#{</span><span class='id schemas'>schemas</span><span class='rbrace'>}</span><span class='tstring_content'>) )
    ORDER BY i.relname
</span><span class='heredoc_end'>  SQL
</span><span class='comma'>,</span> <span class='id name'>name</span><span class='rparen'>)</span>


  <span class='id result'>result</span><span class='period'>.</span><span class='id map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id row'>row</span><span class='op'>|</span>
    <span class='id index_name'>index_name</span> <span class='op'>=</span> <span class='id row'>row</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
    <span class='id unique'>unique</span> <span class='op'>=</span> <span class='id row'>row</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>t</span><span class='tstring_end'>'</span></span>
    <span class='id indkey'>indkey</span> <span class='op'>=</span> <span class='id row'>row</span><span class='lbracket'>[</span><span class='int'>2</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> </span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='id oid'>oid</span> <span class='op'>=</span> <span class='id row'>row</span><span class='lbracket'>[</span><span class='int'>3</span><span class='rbracket'>]</span>

    <span class='id columns'>columns</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='lbracket'>[</span><span class='id query'>query</span><span class='lparen'>(</span><span class='heredoc_beg'>&lt;&lt;-SQL</span><span class='tstring_content'>    SELECT a.attnum, a.attname
    FROM pg_attribute a
</span><span class='tstring_content'>    WHERE a.attrelid = </span><span class='embexpr_beg'>#{</span><span class='id oid'>oid</span><span class='rbrace'>}</span><span class='tstring_content'>
</span><span class='tstring_content'>    AND a.attnum IN (</span><span class='embexpr_beg'>#{</span><span class='id indkey'>indkey</span><span class='period'>.</span><span class='id join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>,</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='tstring_content'>)
</span><span class='heredoc_end'>    SQL
</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Columns for index </span><span class='embexpr_beg'>#{</span><span class='id row'>row</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='rbrace'>}</span><span class='tstring_content'> on </span><span class='embexpr_beg'>#{</span><span class='id table_name'>table_name</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rbracket'>]</span>

    <span class='id column_names'>column_names</span> <span class='op'>=</span> <span class='id columns'>columns</span><span class='period'>.</span><span class='id values_at'>values_at</span><span class='lparen'>(</span><span class='op'>*</span><span class='id indkey'>indkey</span><span class='rparen'>)</span><span class='period'>.</span><span class='id compact'>compact</span>
    <span class='id column_names'>column_names</span><span class='period'>.</span><span class='id empty?'>empty?</span> <span class='op'>?</span> <span class='kw'>nil</span> <span class='op'>:</span> <span class='const'>IndexDefinition</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span><span class='id table_name'>table_name</span><span class='comma'>,</span> <span class='id index_name'>index_name</span><span class='comma'>,</span> <span class='id unique'>unique</span><span class='comma'>,</span> <span class='id column_names'>column_names</span><span class='rparen'>)</span>
  <span class='kw'>end</span><span class='period'>.</span><span class='id compact'>compact</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="insert-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>insert</strong>(sql, name = nil, pk = nil, id_value = nil, sequence_name = nil) 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='create-instance_method'>create</span></span>
    </span>
  
</p><div class="docstring">
  <div class="discussion">
    <p>
Executes an INSERT query and returns the new record&#8217;s ID
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 407</span>

<span class='kw'>def</span> <span class='id insert'>insert</span><span class='lparen'>(</span><span class='id sql'>sql</span><span class='comma'>,</span> <span class='id name'>name</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id pk'>pk</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id id_value'>id_value</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id sequence_name'>sequence_name</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='comment'># Extract the table from the insert sql. Yuck.
</span>  <span class='id table'>table</span> <span class='op'>=</span> <span class='id sql'>sql</span><span class='period'>.</span><span class='id split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> </span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>4</span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>2</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>&quot;</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>

  <span class='comment'># Try an insert with 'returning id' if available (PG &gt;= 8.2)
</span>  <span class='kw'>if</span> <span class='id supports_insert_with_returning?'>supports_insert_with_returning?</span>
    <span class='id pk'>pk</span><span class='comma'>,</span> <span class='id sequence_name'>sequence_name</span> <span class='op'>=</span> <span class='op'>*</span><span class='id pk_and_sequence_for'>pk_and_sequence_for</span><span class='lparen'>(</span><span class='id table'>table</span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id pk'>pk</span>
    <span class='kw'>if</span> <span class='id pk'>pk</span>
      <span class='id id'>id</span> <span class='op'>=</span> <span class='id select_value'>select_value</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id sql'>sql</span><span class='rbrace'>}</span><span class='tstring_content'> RETURNING </span><span class='embexpr_beg'>#{</span><span class='id quote_column_name'>quote_column_name</span><span class='lparen'>(</span><span class='id pk'>pk</span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='id clear_query_cache'>clear_query_cache</span>
      <span class='kw'>return</span> <span class='id id'>id</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='comment'># Otherwise, insert then grab last_insert_id.
</span>  <span class='kw'>if</span> <span class='id insert_id'>insert_id</span> <span class='op'>=</span> <span class='kw'>super</span>
    <span class='id insert_id'>insert_id</span>
  <span class='kw'>else</span>
    <span class='comment'># If neither pk nor sequence name is given, look them up.
</span>    <span class='kw'>unless</span> <span class='id pk'>pk</span> <span class='op'>||</span> <span class='id sequence_name'>sequence_name</span>
      <span class='id pk'>pk</span><span class='comma'>,</span> <span class='id sequence_name'>sequence_name</span> <span class='op'>=</span> <span class='op'>*</span><span class='id pk_and_sequence_for'>pk_and_sequence_for</span><span class='lparen'>(</span><span class='id table'>table</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='comment'># If a pk is given, fallback to default sequence name.
</span>    <span class='comment'># Don't fetch last insert id for a table without a pk.
</span>    <span class='kw'>if</span> <span class='id pk'>pk</span> <span class='op'>&amp;&amp;</span> <span class='id sequence_name'>sequence_name</span> <span class='op'>||=</span> <span class='id default_sequence_name'>default_sequence_name</span><span class='lparen'>(</span><span class='id table'>table</span><span class='comma'>,</span> <span class='id pk'>pk</span><span class='rparen'>)</span>
      <span class='id last_insert_id'>last_insert_id</span><span class='lparen'>(</span><span class='id table'>table</span><span class='comma'>,</span> <span class='id sequence_name'>sequence_name</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="native_database_types-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>native_database_types</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
:nodoc:
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


262
263
264</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 262</span>

<span class='kw'>def</span> <span class='id native_database_types'>native_database_types</span> <span class='comment'>#:nodoc:
</span>  <span class='const'>NATIVE_DATABASE_TYPES</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="outside_transaction?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>outside_transaction?</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


525
526
527</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 525</span>

<span class='kw'>def</span> <span class='id outside_transaction?'>outside_transaction?</span>
  <span class='ivar'>@connection</span><span class='period'>.</span><span class='id transaction_status'>transaction_status</span> <span class='op'>==</span> <span class='const'>PGconn</span><span class='op'>::</span><span class='const'>PQTRANS_IDLE</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="pk_and_sequence_for-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>pk_and_sequence_for</strong>(table) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns a table&#8217;s primary key and belonging sequence.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


734
735
736
737
738
739
740
741
742
743
744
745
746
747
748
749
750
751
752
753
754
755
756
757
758
759
760
761
762
763
764
765
766
767
768
769
770
771
772
773
774
775
776
777
778
779
780</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 734</span>

<span class='kw'>def</span> <span class='id pk_and_sequence_for'>pk_and_sequence_for</span><span class='lparen'>(</span><span class='id table'>table</span><span class='rparen'>)</span> <span class='comment'>#:nodoc:
</span>  <span class='comment'># First try looking for a sequence with a dependency on the
</span>  <span class='comment'># given table's primary key.
</span>  <span class='id result'>result</span> <span class='op'>=</span> <span class='id query'>query</span><span class='lparen'>(</span><span class='heredoc_beg'>&lt;&lt;-end_sql</span><span class='tstring_content'>    SELECT attr.attname, seq.relname
    FROM pg_class      seq,
         pg_attribute  attr,
         pg_depend     dep,
         pg_namespace  name,
         pg_constraint cons
    WHERE seq.oid           = dep.objid
      AND seq.relkind       = 'S'
      AND attr.attrelid     = dep.refobjid
      AND attr.attnum       = dep.refobjsubid
      AND attr.attrelid     = cons.conrelid
      AND attr.attnum       = cons.conkey[1]
      AND cons.contype      = 'p'
</span><span class='tstring_content'>      AND dep.refobjid      = '</span><span class='embexpr_beg'>#{</span><span class='id quote_table_name'>quote_table_name</span><span class='lparen'>(</span><span class='id table'>table</span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='tstring_content'>'::regclass
</span><span class='heredoc_end'>  end_sql
</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>PK and serial sequence</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>

  <span class='kw'>if</span> <span class='id result'>result</span><span class='period'>.</span><span class='id nil?'>nil?</span> <span class='kw'>or</span> <span class='id result'>result</span><span class='period'>.</span><span class='id empty?'>empty?</span>
    <span class='comment'># If that fails, try parsing the primary key's default value.
</span>    <span class='comment'># Support the 7.x and 8.0 nextval('foo'::text) as well as
</span>    <span class='comment'># the 8.1+ nextval('foo'::regclass).
</span>    <span class='id result'>result</span> <span class='op'>=</span> <span class='id query'>query</span><span class='lparen'>(</span><span class='heredoc_beg'>&lt;&lt;-end_sql</span><span class='tstring_content'>      SELECT attr.attname,
        CASE
          WHEN split_part(def.adsrc, '''', 2) ~ '.' THEN
            substr(split_part(def.adsrc, '''', 2),
                   strpos(split_part(def.adsrc, '''', 2), '.')+1)
          ELSE split_part(def.adsrc, '''', 2)
        END
      FROM pg_class       t
      JOIN pg_attribute   attr ON (t.oid = attrelid)
      JOIN pg_attrdef     def  ON (adrelid = attrelid AND adnum = attnum)
      JOIN pg_constraint  cons ON (conrelid = adrelid AND adnum = conkey[1])
</span><span class='tstring_content'>      WHERE t.oid = '</span><span class='embexpr_beg'>#{</span><span class='id quote_table_name'>quote_table_name</span><span class='lparen'>(</span><span class='id table'>table</span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='tstring_content'>'::regclass
        AND cons.contype = 'p'
        AND def.adsrc ~* 'nextval'
</span><span class='heredoc_end'>    end_sql
</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>PK and custom sequence</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='comment'># [primary_key, sequence]
</span>  <span class='lbracket'>[</span><span class='id result'>result</span><span class='period'>.</span><span class='id first'>first</span><span class='comma'>,</span> <span class='id result'>result</span><span class='period'>.</span><span class='id last'>last</span><span class='rbracket'>]</span>
<span class='kw'>rescue</span>
  <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="primary_key-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>primary_key</strong>(table) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns just a table&#8217;s primary key
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


783
784
785
786</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 783</span>

<span class='kw'>def</span> <span class='id primary_key'>primary_key</span><span class='lparen'>(</span><span class='id table'>table</span><span class='rparen'>)</span>
  <span class='id pk_and_sequence'>pk_and_sequence</span> <span class='op'>=</span> <span class='id pk_and_sequence_for'>pk_and_sequence_for</span><span class='lparen'>(</span><span class='id table'>table</span><span class='rparen'>)</span>
  <span class='id pk_and_sequence'>pk_and_sequence</span> <span class='op'>&amp;&amp;</span> <span class='id pk_and_sequence'>pk_and_sequence</span><span class='period'>.</span><span class='id first'>first</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="query-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>query</strong>(sql, name = nil) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Queries the database and returns the results in an Array-like object
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


482
483
484
485
486
487
488
489
490
491</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 482</span>

<span class='kw'>def</span> <span class='id query'>query</span><span class='lparen'>(</span><span class='id sql'>sql</span><span class='comma'>,</span> <span class='id name'>name</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span> <span class='comment'>#:nodoc:
</span>  <span class='id log'>log</span><span class='lparen'>(</span><span class='id sql'>sql</span><span class='comma'>,</span> <span class='id name'>name</span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='kw'>if</span> <span class='ivar'>@async</span>
      <span class='id res'>res</span> <span class='op'>=</span> <span class='ivar'>@connection</span><span class='period'>.</span><span class='id async_exec'>async_exec</span><span class='lparen'>(</span><span class='id sql'>sql</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='id res'>res</span> <span class='op'>=</span> <span class='ivar'>@connection</span><span class='period'>.</span><span class='id exec'>exec</span><span class='lparen'>(</span><span class='id sql'>sql</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='kw'>return</span> <span class='id result_as_array'>result_as_array</span><span class='lparen'>(</span><span class='id res'>res</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="quote-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>quote</strong>(value, column = nil) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Quotes PostgreSQL-specific data types for SQL input.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 317</span>

<span class='kw'>def</span> <span class='id quote'>quote</span><span class='lparen'>(</span><span class='id value'>value</span><span class='comma'>,</span> <span class='id column'>column</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span> <span class='comment'>#:nodoc:
</span>  <span class='kw'>return</span> <span class='kw'>super</span> <span class='kw'>unless</span> <span class='id column'>column</span>

  <span class='kw'>if</span> <span class='id value'>value</span><span class='period'>.</span><span class='id kind_of?'>kind_of?</span><span class='lparen'>(</span><span class='const'>String</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='id column'>column</span><span class='period'>.</span><span class='id type'>type</span> <span class='op'>==</span> <span class='symbol'>:binary</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>'</span><span class='embexpr_beg'>#{</span><span class='id escape_bytea'>escape_bytea</span><span class='lparen'>(</span><span class='id value'>value</span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='tstring_content'>'</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>elsif</span> <span class='id value'>value</span><span class='period'>.</span><span class='id kind_of?'>kind_of?</span><span class='lparen'>(</span><span class='const'>String</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='id column'>column</span><span class='period'>.</span><span class='id sql_type'>sql_type</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>xml</span><span class='tstring_end'>'</span></span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>xml '</span><span class='embexpr_beg'>#{</span><span class='id quote_string'>quote_string</span><span class='lparen'>(</span><span class='id value'>value</span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='tstring_content'>'</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>elsif</span> <span class='id value'>value</span><span class='period'>.</span><span class='id kind_of?'>kind_of?</span><span class='lparen'>(</span><span class='const'>Numeric</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='id column'>column</span><span class='period'>.</span><span class='id sql_type'>sql_type</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>money</span><span class='tstring_end'>'</span></span>
    <span class='comment'># Not truly string input, so doesn't require (or allow) escape string syntax.
</span>    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>'</span><span class='embexpr_beg'>#{</span><span class='id value'>value</span><span class='rbrace'>}</span><span class='tstring_content'>'</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>elsif</span> <span class='id value'>value</span><span class='period'>.</span><span class='id kind_of?'>kind_of?</span><span class='lparen'>(</span><span class='const'>String</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='id column'>column</span><span class='period'>.</span><span class='id sql_type'>sql_type</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^bit</span><span class='regexp_end'>/</span></span>
    <span class='kw'>case</span> <span class='id value'>value</span>
      <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^[01]*$</span><span class='regexp_end'>/</span></span>
        <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>B'</span><span class='embexpr_beg'>#{</span><span class='id value'>value</span><span class='rbrace'>}</span><span class='tstring_content'>'</span><span class='tstring_end'>&quot;</span></span> <span class='comment'># Bit-string notation
</span>      <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^[0-9A-F]*$</span><span class='regexp_end'>/i</span></span>
        <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>X'</span><span class='embexpr_beg'>#{</span><span class='id value'>value</span><span class='rbrace'>}</span><span class='tstring_content'>'</span><span class='tstring_end'>&quot;</span></span> <span class='comment'># Hexadecimal notation
</span>    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='kw'>super</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="quote_column_name-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>quote_column_name</strong>(name) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Quotes column names for use in SQL queries.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


364
365
366</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 364</span>

<span class='kw'>def</span> <span class='id quote_column_name'>quote_column_name</span><span class='lparen'>(</span><span class='id name'>name</span><span class='rparen'>)</span> <span class='comment'>#:nodoc:
</span>  <span class='const'>PGconn</span><span class='period'>.</span><span class='id quote_ident'>quote_ident</span><span class='lparen'>(</span><span class='id name'>name</span><span class='period'>.</span><span class='id to_s'>to_s</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="quote_string-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>quote_string</strong>(s) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Quotes strings for use in SQL input.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


340
341
342</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 340</span>

<span class='kw'>def</span> <span class='id quote_string'>quote_string</span><span class='lparen'>(</span><span class='id s'>s</span><span class='rparen'>)</span> <span class='comment'>#:nodoc:
</span>  <span class='ivar'>@connection</span><span class='period'>.</span><span class='id escape'>escape</span><span class='lparen'>(</span><span class='id s'>s</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="quote_table_name-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>quote_table_name</strong>(name) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Checks the following cases:
</p>
<ul>
<li><p>
table_name
</p>
</li>
<li><p>
&#8220;table.name&#8220;
</p>
</li>
<li><p>
schema_name.table_name
</p>
</li>
<li><p>
schema_name.&#8220;table.name&#8220;
</p>
</li>
<li><p>
&#8220;schema.name&#8221;.table_name
</p>
</li>
<li><p>
&#8220;schema.name&#8221;.&#8220;table.name&#8220;
</p>
</li>
</ul>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


352
353
354
355
356
357
358
359
360
361</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 352</span>

<span class='kw'>def</span> <span class='id quote_table_name'>quote_table_name</span><span class='lparen'>(</span><span class='id name'>name</span><span class='rparen'>)</span>
  <span class='id schema'>schema</span><span class='comma'>,</span> <span class='id name_part'>name_part</span> <span class='op'>=</span> <span class='id extract_pg_identifier_from_name'>extract_pg_identifier_from_name</span><span class='lparen'>(</span><span class='id name'>name</span><span class='period'>.</span><span class='id to_s'>to_s</span><span class='rparen'>)</span>

  <span class='kw'>unless</span> <span class='id name_part'>name_part</span>
    <span class='id quote_column_name'>quote_column_name</span><span class='lparen'>(</span><span class='id schema'>schema</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='id table_name'>table_name</span><span class='comma'>,</span> <span class='id name_part'>name_part</span> <span class='op'>=</span> <span class='id extract_pg_identifier_from_name'>extract_pg_identifier_from_name</span><span class='lparen'>(</span><span class='id name_part'>name_part</span><span class='rparen'>)</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id quote_column_name'>quote_column_name</span><span class='lparen'>(</span><span class='id schema'>schema</span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='tstring_content'>.</span><span class='embexpr_beg'>#{</span><span class='id quote_column_name'>quote_column_name</span><span class='lparen'>(</span><span class='id table_name'>table_name</span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="quoted_date-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>quoted_date</strong>(value) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Quote date/time values for use in SQL input. Includes microseconds if the
value is a Time responding to usec.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


370
371
372
373
374
375
376</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 370</span>

<span class='kw'>def</span> <span class='id quoted_date'>quoted_date</span><span class='lparen'>(</span><span class='id value'>value</span><span class='rparen'>)</span> <span class='comment'>#:nodoc:
</span>  <span class='kw'>if</span> <span class='id value'>value</span><span class='period'>.</span><span class='id acts_like?'>acts_like?</span><span class='lparen'>(</span><span class='symbol'>:time</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='id value'>value</span><span class='period'>.</span><span class='id respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:usec</span><span class='rparen'>)</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='kw'>super</span><span class='rbrace'>}</span><span class='tstring_content'>.</span><span class='embexpr_beg'>#{</span><span class='id sprintf'>sprintf</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%06d</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id value'>value</span><span class='period'>.</span><span class='id usec'>usec</span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>else</span>
    <span class='kw'>super</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="reconnect!-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>reconnect!</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Close then reopen the connection.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


247
248
249
250
251
252
253
254
255</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 247</span>

<span class='kw'>def</span> <span class='id reconnect!'>reconnect!</span>
  <span class='kw'>if</span> <span class='ivar'>@connection</span><span class='period'>.</span><span class='id respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:reset</span><span class='rparen'>)</span>
    <span class='ivar'>@connection</span><span class='period'>.</span><span class='id reset'>reset</span>
    <span class='id configure_connection'>configure_connection</span>
  <span class='kw'>else</span>
    <span class='id disconnect!'>disconnect!</span>
    <span class='id connect'>connect</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="recreate_database-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>recreate_database</strong>(name) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
SCHEMA STATEMENTS ========================================
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


543
544
545
546</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 543</span>

<span class='kw'>def</span> <span class='id recreate_database'>recreate_database</span><span class='lparen'>(</span><span class='id name'>name</span><span class='rparen'>)</span> <span class='comment'>#:nodoc:
</span>  <span class='id drop_database'>drop_database</span><span class='lparen'>(</span><span class='id name'>name</span><span class='rparen'>)</span>
  <span class='id create_database'>create_database</span><span class='lparen'>(</span><span class='id name'>name</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="release_savepoint-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>release_savepoint</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


537
538
539</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 537</span>

<span class='kw'>def</span> <span class='id release_savepoint'>release_savepoint</span>
  <span class='id execute'>execute</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>RELEASE SAVEPOINT </span><span class='embexpr_beg'>#{</span><span class='id current_savepoint_name'>current_savepoint_name</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="remove_index!-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>remove_index!</strong>(table_name, index_name) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
:nodoc:
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


849
850
851</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 849</span>

<span class='kw'>def</span> <span class='id remove_index!'>remove_index!</span><span class='lparen'>(</span><span class='id table_name'>table_name</span><span class='comma'>,</span> <span class='id index_name'>index_name</span><span class='rparen'>)</span> <span class='comment'>#:nodoc:
</span>  <span class='id execute'>execute</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DROP INDEX </span><span class='embexpr_beg'>#{</span><span class='id quote_table_name'>quote_table_name</span><span class='lparen'>(</span><span class='id index_name'>index_name</span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="rename_column-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>rename_column</strong>(table_name, column_name, new_column_name) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Renames a column in a table.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


845
846
847</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 845</span>

<span class='kw'>def</span> <span class='id rename_column'>rename_column</span><span class='lparen'>(</span><span class='id table_name'>table_name</span><span class='comma'>,</span> <span class='id column_name'>column_name</span><span class='comma'>,</span> <span class='id new_column_name'>new_column_name</span><span class='rparen'>)</span>
  <span class='id execute'>execute</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ALTER TABLE </span><span class='embexpr_beg'>#{</span><span class='id quote_table_name'>quote_table_name</span><span class='lparen'>(</span><span class='id table_name'>table_name</span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='tstring_content'> RENAME COLUMN </span><span class='embexpr_beg'>#{</span><span class='id quote_column_name'>quote_column_name</span><span class='lparen'>(</span><span class='id column_name'>column_name</span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='tstring_content'> TO </span><span class='embexpr_beg'>#{</span><span class='id quote_column_name'>quote_column_name</span><span class='lparen'>(</span><span class='id new_column_name'>new_column_name</span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="rename_table-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>rename_table</strong>(name, new_name) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Renames a table.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


789
790
791</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 789</span>

<span class='kw'>def</span> <span class='id rename_table'>rename_table</span><span class='lparen'>(</span><span class='id name'>name</span><span class='comma'>,</span> <span class='id new_name'>new_name</span><span class='rparen'>)</span>
  <span class='id execute'>execute</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ALTER TABLE </span><span class='embexpr_beg'>#{</span><span class='id quote_table_name'>quote_table_name</span><span class='lparen'>(</span><span class='id name'>name</span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='tstring_content'> RENAME TO </span><span class='embexpr_beg'>#{</span><span class='id quote_table_name'>quote_table_name</span><span class='lparen'>(</span><span class='id new_name'>new_name</span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="reset_pk_sequence!-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>reset_pk_sequence!</strong>(table, pk = nil, sequence = nil) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Resets the sequence of a table&#8217;s primary key to the maximum value.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


714
715
716
717
718
719
720
721
722
723
724
725
726
727
728
729
730
731</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 714</span>

<span class='kw'>def</span> <span class='id reset_pk_sequence!'>reset_pk_sequence!</span><span class='lparen'>(</span><span class='id table'>table</span><span class='comma'>,</span> <span class='id pk'>pk</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id sequence'>sequence</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span> <span class='comment'>#:nodoc:
</span>  <span class='kw'>unless</span> <span class='id pk'>pk</span> <span class='kw'>and</span> <span class='id sequence'>sequence</span>
    <span class='id default_pk'>default_pk</span><span class='comma'>,</span> <span class='id default_sequence'>default_sequence</span> <span class='op'>=</span> <span class='id pk_and_sequence_for'>pk_and_sequence_for</span><span class='lparen'>(</span><span class='id table'>table</span><span class='rparen'>)</span>
    <span class='id pk'>pk</span> <span class='op'>||=</span> <span class='id default_pk'>default_pk</span>
    <span class='id sequence'>sequence</span> <span class='op'>||=</span> <span class='id default_sequence'>default_sequence</span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='id pk'>pk</span>
    <span class='kw'>if</span> <span class='id sequence'>sequence</span>
      <span class='id quoted_sequence'>quoted_sequence</span> <span class='op'>=</span> <span class='id quote_column_name'>quote_column_name</span><span class='lparen'>(</span><span class='id sequence'>sequence</span><span class='rparen'>)</span>

      <span class='id select_value'>select_value</span> <span class='heredoc_beg'>&lt;&lt;-end_sql</span><span class='tstring_content'>        SELECT setval('</span><span class='embexpr_beg'>#{</span><span class='id quoted_sequence'>quoted_sequence</span><span class='rbrace'>}</span><span class='tstring_content'>', (SELECT COALESCE(MAX(</span><span class='embexpr_beg'>#{</span><span class='id quote_column_name'>quote_column_name</span> <span class='id pk'>pk</span><span class='rbrace'>}</span><span class='tstring_content'>)+(SELECT increment_by FROM </span><span class='embexpr_beg'>#{</span><span class='id quoted_sequence'>quoted_sequence</span><span class='rbrace'>}</span><span class='tstring_content'>), (SELECT min_value FROM </span><span class='embexpr_beg'>#{</span><span class='id quoted_sequence'>quoted_sequence</span><span class='rbrace'>}</span><span class='tstring_content'>)) FROM </span><span class='embexpr_beg'>#{</span><span class='id quote_table_name'>quote_table_name</span><span class='lparen'>(</span><span class='id table'>table</span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='tstring_content'>), false)
</span><span class='heredoc_end'>      end_sql
</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>Reset sequence</span><span class='tstring_end'>'</span></span>
    <span class='kw'>else</span>
      <span class='ivar'>@logger</span><span class='period'>.</span><span class='id warn'>warn</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id table'>table</span><span class='rbrace'>}</span><span class='tstring_content'> has primary key </span><span class='embexpr_beg'>#{</span><span class='id pk'>pk</span><span class='rbrace'>}</span><span class='tstring_content'> with no default sequence</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='ivar'>@logger</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="result_as_array-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>result_as_array</strong>(res) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
create a 2D array representing the result set
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 440</span>

<span class='kw'>def</span> <span class='id result_as_array'>result_as_array</span><span class='lparen'>(</span><span class='id res'>res</span><span class='rparen'>)</span> <span class='comment'>#:nodoc:
</span>  <span class='comment'># check if we have any binary column and if they need escaping
</span>  <span class='id unescape_col'>unescape_col</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id res'>res</span><span class='period'>.</span><span class='id nfields'>nfields</span><span class='period'>.</span><span class='id times'>times</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id j'>j</span><span class='op'>|</span>
    <span class='id unescape_col'>unescape_col</span> <span class='op'>&lt;&lt;</span> <span class='id res'>res</span><span class='period'>.</span><span class='id ftype'>ftype</span><span class='lparen'>(</span><span class='id j'>j</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id ary'>ary</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id res'>res</span><span class='period'>.</span><span class='id ntuples'>ntuples</span><span class='period'>.</span><span class='id times'>times</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id i'>i</span><span class='op'>|</span>
    <span class='id ary'>ary</span> <span class='op'>&lt;&lt;</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id res'>res</span><span class='period'>.</span><span class='id nfields'>nfields</span><span class='period'>.</span><span class='id times'>times</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id j'>j</span><span class='op'>|</span>
      <span class='id data'>data</span> <span class='op'>=</span> <span class='id res'>res</span><span class='period'>.</span><span class='id getvalue'>getvalue</span><span class='lparen'>(</span><span class='id i'>i</span><span class='comma'>,</span><span class='id j'>j</span><span class='rparen'>)</span>
      <span class='kw'>case</span> <span class='id unescape_col'>unescape_col</span><span class='lbracket'>[</span><span class='id j'>j</span><span class='rbracket'>]</span>

      <span class='comment'># unescape string passed BYTEA field (OID == 17)
</span>      <span class='kw'>when</span> <span class='const'>BYTEA_COLUMN_TYPE_OID</span>
        <span class='id data'>data</span> <span class='op'>=</span> <span class='id unescape_bytea'>unescape_bytea</span><span class='lparen'>(</span><span class='id data'>data</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='const'>String</span> <span class='op'>===</span> <span class='id data'>data</span>

      <span class='comment'># If this is a money type column and there are any currency symbols,
</span>      <span class='comment'># then strip them off. Indeed it would be prettier to do this in
</span>      <span class='comment'># PostgreSQLColumn.string_to_decimal but would break form input
</span>      <span class='comment'># fields that call value_before_type_cast.
</span>      <span class='kw'>when</span> <span class='const'>MONEY_COLUMN_TYPE_OID</span>
        <span class='comment'># Because money output is formatted according to the locale, there are two
</span>        <span class='comment'># cases to consider (note the decimal separators):
</span>        <span class='comment'>#  (1) $12,345,678.12
</span>        <span class='comment'>#  (2) $12.345.678,12
</span>        <span class='kw'>case</span> <span class='id data'>data</span>
        <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^-?\D+[\d,]+\.\d{2}$</span><span class='regexp_end'>/</span></span>  <span class='comment'># (1)
</span>          <span class='id data'>data</span><span class='period'>.</span><span class='id gsub!'>gsub!</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>[^-\d\.]</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
        <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^-?\D+[\d\.]+,\d{2}$</span><span class='regexp_end'>/</span></span>  <span class='comment'># (2)
</span>          <span class='id data'>data</span><span class='period'>.</span><span class='id gsub!'>gsub!</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>[^-\d,]</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id sub!'>sub!</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>,</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>.</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
      <span class='id ary'>ary</span><span class='lbracket'>[</span><span class='id i'>i</span><span class='rbracket'>]</span> <span class='op'>&lt;&lt;</span> <span class='id data'>data</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='id ary'>ary</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="rollback_db_transaction-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>rollback_db_transaction</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Aborts a transaction.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


521
522
523</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 521</span>

<span class='kw'>def</span> <span class='id rollback_db_transaction'>rollback_db_transaction</span>
  <span class='id execute'>execute</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ROLLBACK</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="rollback_to_savepoint-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>rollback_to_savepoint</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


533
534
535</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 533</span>

<span class='kw'>def</span> <span class='id rollback_to_savepoint'>rollback_to_savepoint</span>
  <span class='id execute'>execute</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ROLLBACK TO SAVEPOINT </span><span class='embexpr_beg'>#{</span><span class='id current_savepoint_name'>current_savepoint_name</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="schema_search_path-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>schema_search_path</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns the active schema search path.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


693
694
695</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 693</span>

<span class='kw'>def</span> <span class='id schema_search_path'>schema_search_path</span>
  <span class='ivar'>@schema_search_path</span> <span class='op'>||=</span> <span class='id query'>query</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>SHOW search_path</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="schema_search_path=-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>schema_search_path=</strong>(schema_csv) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Sets the schema search path to a string of comma-separated schema names.
Names beginning with $ have to be quoted (e.g. $user =>
&#8217;$user&#8217;). See: <a
href="http://www.postgresql.org/docs/current/static/ddl-schemas.html">www.postgresql.org/docs/current/static/ddl-schemas.html</a>
</p>
<p>
This should be not be called manually but set in database.yml.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


685
686
687
688
689
690</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 685</span>

<span class='kw'>def</span> <span class='id schema_search_path='>schema_search_path=</span><span class='lparen'>(</span><span class='id schema_csv'>schema_csv</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id schema_csv'>schema_csv</span>
    <span class='id execute'>execute</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SET search_path TO </span><span class='embexpr_beg'>#{</span><span class='id schema_csv'>schema_csv</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='ivar'>@schema_search_path</span> <span class='op'>=</span> <span class='id schema_csv'>schema_csv</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="select_rows-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>select_rows</strong>(sql, name = nil) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Executes a SELECT query and returns an array of rows. Each row is an array
of field values.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


402
403
404</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 402</span>

<span class='kw'>def</span> <span class='id select_rows'>select_rows</span><span class='lparen'>(</span><span class='id sql'>sql</span><span class='comma'>,</span> <span class='id name'>name</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id select_raw'>select_raw</span><span class='lparen'>(</span><span class='id sql'>sql</span><span class='comma'>,</span> <span class='id name'>name</span><span class='rparen'>)</span><span class='period'>.</span><span class='id last'>last</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="set_standard_conforming_strings-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>set_standard_conforming_strings</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Enable standard-conforming strings if available.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


277
278
279
280
281
282</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 277</span>

<span class='kw'>def</span> <span class='id set_standard_conforming_strings'>set_standard_conforming_strings</span>
  <span class='id old'>old</span><span class='comma'>,</span> <span class='kw'>self</span><span class='period'>.</span><span class='id client_min_messages'>client_min_messages</span> <span class='op'>=</span> <span class='id client_min_messages'>client_min_messages</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>panic</span><span class='tstring_end'>'</span></span>
  <span class='id execute'>execute</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>SET standard_conforming_strings = on</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span> <span class='kw'>rescue</span> <span class='kw'>nil</span>
<span class='kw'>ensure</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id client_min_messages'>client_min_messages</span> <span class='op'>=</span> <span class='id old'>old</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="supports_ddl_transactions?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>supports_ddl_transactions?</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


288
289
290</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 288</span>

<span class='kw'>def</span> <span class='id supports_ddl_transactions?'>supports_ddl_transactions?</span>
  <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="supports_disable_referential_integrity?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>supports_disable_referential_integrity?</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
REFERENTIAL INTEGRITY ====================================
</p>


  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


380
381
382
383
384
385</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 380</span>

<span class='kw'>def</span> <span class='id supports_disable_referential_integrity?'>supports_disable_referential_integrity?</span><span class='lparen'>(</span><span class='rparen'>)</span> <span class='comment'>#:nodoc:
</span>  <span class='id version'>version</span> <span class='op'>=</span> <span class='id query'>query</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SHOW server_version</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>.</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
  <span class='id version'>version</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id to_i'>to_i</span> <span class='op'>&gt;=</span> <span class='int'>8</span> <span class='op'>&amp;&amp;</span> <span class='id version'>version</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id to_i'>to_i</span> <span class='op'>&gt;=</span> <span class='int'>1</span>
<span class='kw'>rescue</span>
  <span class='kw'>return</span> <span class='kw'>false</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="supports_insert_with_returning?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>supports_insert_with_returning?</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


284
285
286</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 284</span>

<span class='kw'>def</span> <span class='id supports_insert_with_returning?'>supports_insert_with_returning?</span>
  <span class='id postgresql_version'>postgresql_version</span> <span class='op'>&gt;=</span> <span class='int'>80200</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="supports_migrations?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>supports_migrations?</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Does PostgreSQL support migrations?
</p>


  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


267
268
269</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 267</span>

<span class='kw'>def</span> <span class='id supports_migrations?'>supports_migrations?</span>
  <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="supports_primary_key?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>supports_primary_key?</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Does PostgreSQL support finding primary key on non-Active Record tables?
</p>


  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


272
273
274</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 272</span>

<span class='kw'>def</span> <span class='id supports_primary_key?'>supports_primary_key?</span> <span class='comment'>#:nodoc:
</span>  <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="supports_savepoints?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>supports_savepoints?</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


292
293
294</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 292</span>

<span class='kw'>def</span> <span class='id supports_savepoints?'>supports_savepoints?</span>
  <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="table_alias_length-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>table_alias_length</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns the configured supported identifier length supported by PostgreSQL,
or report the default of 63 on PostgreSQL 7.x.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


298
299
300</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 298</span>

<span class='kw'>def</span> <span class='id table_alias_length'>table_alias_length</span>
  <span class='ivar'>@table_alias_length</span> <span class='op'>||=</span> <span class='lparen'>(</span><span class='id postgresql_version'>postgresql_version</span> <span class='op'>&gt;=</span> <span class='int'>80000</span> <span class='op'>?</span> <span class='id query'>query</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>SHOW max_identifier_length</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id to_i'>to_i</span> <span class='op'>:</span> <span class='int'>63</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="table_exists?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>table_exists?</strong>(name) 
  

  
</p><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


603
604
605
606
607
608
609
610
611
612
613
614
615
616
617
618
619
620
621
622
623</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 603</span>

<span class='kw'>def</span> <span class='id table_exists?'>table_exists?</span><span class='lparen'>(</span><span class='id name'>name</span><span class='rparen'>)</span>
  <span class='id name'>name</span>          <span class='op'>=</span> <span class='id name'>name</span><span class='period'>.</span><span class='id to_s'>to_s</span>
  <span class='id schema'>schema</span><span class='comma'>,</span> <span class='id table'>table</span> <span class='op'>=</span> <span class='id name'>name</span><span class='period'>.</span><span class='id split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>.</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='int'>2</span><span class='rparen'>)</span>

  <span class='kw'>unless</span> <span class='id table'>table</span> <span class='comment'># A table was provided without a schema
</span>    <span class='id table'>table</span>  <span class='op'>=</span> <span class='id schema'>schema</span>
    <span class='id schema'>schema</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id name'>name</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^&quot;</span><span class='regexp_end'>/</span></span> <span class='comment'># Handle quoted table names
</span>    <span class='id table'>table</span>  <span class='op'>=</span> <span class='id name'>name</span>
    <span class='id schema'>schema</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='kw'>end</span>

  <span class='id query'>query</span><span class='lparen'>(</span><span class='heredoc_beg'>&lt;&lt;-SQL</span><span class='tstring_content'>      SELECT COUNT(*)
      FROM pg_tables
</span><span class='tstring_content'>      WHERE tablename = '</span><span class='embexpr_beg'>#{</span><span class='id table'>table</span><span class='period'>.</span><span class='id gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>(^&quot;|&quot;$)</span><span class='regexp_end'>/</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='tstring_content'>'
</span><span class='tstring_content'>      </span><span class='embexpr_beg'>#{</span><span class='id schema'>schema</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>AND schemaname = '</span><span class='embexpr_beg'>#{</span><span class='id schema'>schema</span><span class='rbrace'>}</span><span class='tstring_content'>'</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_end'>'</span></span><span class='rbrace'>}</span><span class='tstring_content'>
</span><span class='heredoc_end'>  SQL
</span><span class='rparen'>)</span><span class='period'>.</span><span class='id first'>first</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id to_i'>to_i</span> <span class='op'>&gt;</span> <span class='int'>0</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="tables-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>tables</strong>(name = nil) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns the list of all tables in the schema search path or a specified
schema.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


595
596
597
598
599
600
601</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 595</span>

<span class='kw'>def</span> <span class='id tables'>tables</span><span class='lparen'>(</span><span class='id name'>name</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id query'>query</span><span class='lparen'>(</span><span class='heredoc_beg'>&lt;&lt;-SQL</span><span class='tstring_content'>    SELECT tablename
    FROM pg_tables
    WHERE schemaname = ANY (current_schemas(false))
</span><span class='heredoc_end'>  SQL
</span><span class='comma'>,</span> <span class='id name'>name</span><span class='rparen'>)</span><span class='period'>.</span><span class='id map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id row'>row</span><span class='op'>|</span> <span class='id row'>row</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="type_to_sql-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>type_to_sql</strong>(type, limit = nil, precision = nil, scale = nil) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Maps logical Rails types to PostgreSQL-specific data types.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


858
859
860
861
862
863
864
865
866
867
868</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 858</span>

<span class='kw'>def</span> <span class='id type_to_sql'>type_to_sql</span><span class='lparen'>(</span><span class='id type'>type</span><span class='comma'>,</span> <span class='id limit'>limit</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id precision'>precision</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id scale'>scale</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>super</span> <span class='kw'>unless</span> <span class='id type'>type</span><span class='period'>.</span><span class='id to_s'>to_s</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>integer</span><span class='tstring_end'>'</span></span>
  <span class='kw'>return</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>integer</span><span class='tstring_end'>'</span></span> <span class='kw'>unless</span> <span class='id limit'>limit</span>

  <span class='kw'>case</span> <span class='id limit'>limit</span>
    <span class='kw'>when</span> <span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>smallint</span><span class='tstring_end'>'</span></span>
    <span class='kw'>when</span> <span class='int'>3</span><span class='comma'>,</span> <span class='int'>4</span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>integer</span><span class='tstring_end'>'</span></span>
    <span class='kw'>when</span> <span class='int'>5</span><span class='op'>..</span><span class='int'>8</span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>bigint</span><span class='tstring_end'>'</span></span>
    <span class='kw'>else</span> <span class='id raise'>raise</span><span class='lparen'>(</span><span class='const'>ActiveRecordError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>No integer type has byte size </span><span class='embexpr_beg'>#{</span><span class='id limit'>limit</span><span class='rbrace'>}</span><span class='tstring_content'>. Use a numeric with precision 0 instead.</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="unescape_bytea-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>unescape_bytea</strong>(value) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Unescapes bytea output from a database to the binary string it represents.
NOTE: This is NOT an inverse of escape_bytea! This is only to be used
</p>
<pre class="code">
      on escaped binary output from database drive.</pre>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


312
313
314</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 312</span>

<span class='kw'>def</span> <span class='id unescape_bytea'>unescape_bytea</span><span class='lparen'>(</span><span class='id value'>value</span><span class='rparen'>)</span>
  <span class='ivar'>@connection</span><span class='period'>.</span><span class='id unescape_bytea'>unescape_bytea</span><span class='lparen'>(</span><span class='id value'>value</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id value'>value</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="update_sql-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>update_sql</strong>(sql, name = nil) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Executes an UPDATE query and returns the number of affected tuples.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


506
507
508</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 506</span>

<span class='kw'>def</span> <span class='id update_sql'>update_sql</span><span class='lparen'>(</span><span class='id sql'>sql</span><span class='comma'>,</span> <span class='id name'>name</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='kw'>super</span><span class='period'>.</span><span class='id cmd_tuples'>cmd_tuples</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>
    
    <div id="footer">
  Generated on Thu Nov  4 20:04:31 2010 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.6.1 (ruby-1.9.2).
</div>

  </body>
</html>