  <div id="fileHeader">
    <h1>company_in_module.rb</h1>
    <table class="header-table">
    <tr class="top-aligned-row">
      <td><strong>Path:</strong></td>
      <td>activerecord/test/models/company_in_module.rb</td>
    </tr>
    <tr class="top-aligned-row">
      <td><strong>Last Update:</strong></td>
      <td>Fri Nov 27 16:38:16 +0100 2009</td>
    </tr>
    </table>
  </div>
 <!-- banner header -->

  <div id="bodyContent" >
    <h2>Source Code</h2>
    <pre>module MyApplication
  module Business
    class Company &lt; ActiveRecord::Base
      attr_protected :rating
    end

    class Firm &lt; Company
      has_many :clients, :order =&gt; &quot;id&quot;, :dependent =&gt; :destroy
      has_many :clients_sorted_desc, :class_name =&gt; &quot;Client&quot;, :order =&gt; &quot;id DESC&quot;
      has_many :clients_of_firm, :foreign_key =&gt; &quot;client_of&quot;, :class_name =&gt; &quot;Client&quot;, :order =&gt; &quot;id&quot;
      has_many :clients_like_ms, :conditions =&gt; &quot;name = 'Microsoft'&quot;, :class_name =&gt; &quot;Client&quot;, :order =&gt; &quot;id&quot;
      has_many :clients_using_sql, :class_name =&gt; &quot;Client&quot;, :finder_sql =&gt; 'SELECT * FROM companies WHERE client_of = #{id}'

      has_one :account, :class_name =&gt; 'MyApplication::Billing::Account', :dependent =&gt; :destroy
    end

    class Client &lt; Company
      belongs_to :firm, :foreign_key =&gt; &quot;client_of&quot;
      belongs_to :firm_with_other_name, :class_name =&gt; &quot;Firm&quot;, :foreign_key =&gt; &quot;client_of&quot;

      class Contact &lt; ActiveRecord::Base; end
    end

    class Developer &lt; ActiveRecord::Base
      has_and_belongs_to_many :projects
      validates_length_of :name, :within =&gt; (3..20)
    end

    class Project &lt; ActiveRecord::Base
      has_and_belongs_to_many :developers
    end

  end

  module Billing
    class Firm &lt; ActiveRecord::Base
      self.table_name = 'companies'
    end

    module Nested
      class Firm &lt; ActiveRecord::Base
        self.table_name = 'companies'
      end
    end

    class Account &lt; ActiveRecord::Base
      with_options(:foreign_key =&gt; :firm_id) do |i|
        i.belongs_to :firm, :class_name =&gt; 'MyApplication::Business::Firm'
        i.belongs_to :qualified_billing_firm, :class_name =&gt; 'MyApplication::Billing::Firm'
        i.belongs_to :unqualified_billing_firm, :class_name =&gt; 'Firm'
        i.belongs_to :nested_qualified_billing_firm, :class_name =&gt; 'MyApplication::Billing::Nested::Firm'
        i.belongs_to :nested_unqualified_billing_firm, :class_name =&gt; 'Nested::Firm'
      end

      protected
        def validate
          errors.add_on_empty &quot;credit_limit&quot;
        end
    end
  end
end
</pre>
    </div>