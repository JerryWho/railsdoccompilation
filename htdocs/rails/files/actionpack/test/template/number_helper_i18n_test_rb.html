  <div id="fileHeader">
    <h1>number_helper_i18n_test.rb</h1>
    <table class="header-table">
    <tr class="top-aligned-row">
      <td><strong>Path:</strong></td>
      <td>actionpack/test/template/number_helper_i18n_test.rb</td>
    </tr>
    <tr class="top-aligned-row">
      <td><strong>Last Update:</strong></td>
      <td>Mon Oct 12 14:59:08 +0200 2009</td>
    </tr>
    </table>
  </div>
 <!-- banner header -->

  <div id="bodyContent" >
    <h2>Source Code</h2>
    <pre>require 'abstract_unit'

class NumberHelperI18nTests &lt; Test::Unit::TestCase
  include ActionView::Helpers::NumberHelper

  attr_reader :request

  def setup
    @number_defaults = { :precision =&gt; 3, :delimiter =&gt; ',', :separator =&gt; '.' }
    @currency_defaults = { :unit =&gt; '$', :format =&gt; '%u%n', :precision =&gt; 2 }
    @human_defaults = { :precision =&gt; 1 }
    @human_storage_units_format_default = &quot;%n %u&quot;
    @human_storage_units_units_byte_other = &quot;Bytes&quot;
    @human_storage_units_units_kb_other = &quot;KB&quot;
    @percentage_defaults = { :delimiter =&gt; '' }
    @precision_defaults = { :delimiter =&gt; '' }

    I18n.backend.store_translations 'en', :number =&gt; { :format =&gt; @number_defaults,
      :currency =&gt; { :format =&gt; @currency_defaults }, :human =&gt; @human_defaults }
  end

  def test_number_to_currency_translates_currency_formats
    I18n.expects(:translate).with(:'number.format', :locale =&gt; 'en', :raise =&gt; true).returns(@number_defaults)
    I18n.expects(:translate).with(:'number.currency.format', :locale =&gt; 'en',
                                  :raise =&gt; true).returns(@currency_defaults)
    number_to_currency(1, :locale =&gt; 'en')
  end

  def test_number_with_precision_translates_number_formats
    I18n.expects(:translate).with(:'number.format', :locale =&gt; 'en', :raise =&gt; true).returns(@number_defaults)
    I18n.expects(:translate).with(:'number.precision.format', :locale =&gt; 'en',
                                  :raise =&gt; true).returns(@precision_defaults)
    number_with_precision(1, :locale =&gt; 'en')
  end

  def test_number_with_delimiter_translates_number_formats
    I18n.expects(:translate).with(:'number.format', :locale =&gt; 'en', :raise =&gt; true).returns(@number_defaults)
    number_with_delimiter(1, :locale =&gt; 'en')
  end

  def test_number_to_percentage_translates_number_formats
    I18n.expects(:translate).with(:'number.format', :locale =&gt; 'en', :raise =&gt; true).returns(@number_defaults)
    I18n.expects(:translate).with(:'number.percentage.format', :locale =&gt; 'en',
                                  :raise =&gt; true).returns(@percentage_defaults)
    number_to_percentage(1, :locale =&gt; 'en')
  end

  def test_number_to_human_size_translates_human_formats
    I18n.expects(:translate).with(:'number.format', :locale =&gt; 'en', :raise =&gt; true).returns(@number_defaults)
    I18n.expects(:translate).with(:'number.human.format', :locale =&gt; 'en',
                                  :raise =&gt; true).returns(@human_defaults)
    I18n.expects(:translate).with(:'number.human.storage_units.format', :locale =&gt; 'en',
                                  :raise =&gt; true).returns(@human_storage_units_format_default)
    I18n.expects(:translate).with(:'number.human.storage_units.units.kb', :locale =&gt; 'en', :count =&gt; 2,
                                  :raise =&gt; true).returns(@human_storage_units_units_kb_other)
    # 2KB
    number_to_human_size(2048, :locale =&gt; 'en')

    I18n.expects(:translate).with(:'number.format', :locale =&gt; 'en', :raise =&gt; true).returns(@number_defaults)
    I18n.expects(:translate).with(:'number.human.format', :locale =&gt; 'en',
                                  :raise =&gt; true).returns(@human_defaults)
    I18n.expects(:translate).with(:'number.human.storage_units.format', :locale =&gt; 'en',
                                  :raise =&gt; true).returns(@human_storage_units_format_default)
    I18n.expects(:translate).with(:'number.human.storage_units.units.byte', :locale =&gt; 'en', :count =&gt; 42,
                                  :raise =&gt; true).returns(@human_storage_units_units_byte_other)
    # 42 Bytes
    number_to_human_size(42, :locale =&gt; 'en')
  end
end
</pre>
    </div>