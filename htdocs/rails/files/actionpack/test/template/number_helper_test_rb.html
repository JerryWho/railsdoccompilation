  <div id="fileHeader">
    <h1>number_helper_test.rb</h1>
    <table class="header-table">
    <tr class="top-aligned-row">
      <td><strong>Path:</strong></td>
      <td>actionpack/test/template/number_helper_test.rb</td>
    </tr>
    <tr class="top-aligned-row">
      <td><strong>Last Update:</strong></td>
      <td>Mon Oct 12 19:55:10 +0200 2009</td>
    </tr>
    </table>
  </div>
 <!-- banner header -->

  <div id="bodyContent" >
    <h2>Source Code</h2>
    <pre>require 'abstract_unit'

class NumberHelperTest &lt; ActionView::TestCase
  tests ActionView::Helpers::NumberHelper

  def test_number_to_phone
    assert_equal(&quot;555-1234&quot;, number_to_phone(5551234))
    assert_equal(&quot;800-555-1212&quot;, number_to_phone(8005551212))
    assert_equal(&quot;(800) 555-1212&quot;, number_to_phone(8005551212, {:area_code =&gt; true}))
    assert_equal(&quot;800 555 1212&quot;, number_to_phone(8005551212, {:delimiter =&gt; &quot; &quot;}))
    assert_equal(&quot;(800) 555-1212 x 123&quot;, number_to_phone(8005551212, {:area_code =&gt; true, :extension =&gt; 123}))
    assert_equal(&quot;800-555-1212&quot;, number_to_phone(8005551212, :extension =&gt; &quot;  &quot;))
    assert_equal(&quot;800-555-1212&quot;, number_to_phone(&quot;8005551212&quot;))
    assert_equal(&quot;+1-800-555-1212&quot;, number_to_phone(8005551212, :country_code =&gt; 1))
    assert_equal(&quot;+18005551212&quot;, number_to_phone(8005551212, :country_code =&gt; 1, :delimiter =&gt; ''))
    assert_equal(&quot;22-555-1212&quot;, number_to_phone(225551212))
    assert_equal(&quot;+45-22-555-1212&quot;, number_to_phone(225551212, :country_code =&gt; 45))
    assert_equal(&quot;x&quot;, number_to_phone(&quot;x&quot;))
    assert_nil number_to_phone(nil)
  end

  def test_number_to_currency
    assert_equal(&quot;$1,234,567,890.50&quot;, number_to_currency(1234567890.50))
    assert_equal(&quot;$1,234,567,890.51&quot;, number_to_currency(1234567890.506))
    assert_equal(&quot;$1,234,567,892&quot;, number_to_currency(1234567891.50, {:precision =&gt; 0}))
    assert_equal(&quot;$1,234,567,890.5&quot;, number_to_currency(1234567890.50, {:precision =&gt; 1}))
    assert_equal(&quot;&amp;pound;1234567890,50&quot;, number_to_currency(1234567890.50, {:unit =&gt; &quot;&amp;pound;&quot;, :separator =&gt; &quot;,&quot;, :delimiter =&gt; &quot;&quot;}))
    assert_equal(&quot;$1,234,567,890.50&quot;, number_to_currency(&quot;1234567890.50&quot;))
    assert_equal(&quot;1,234,567,890.50 K&amp;#269;&quot;, number_to_currency(&quot;1234567890.50&quot;, {:unit =&gt; &quot;K&amp;#269;&quot;, :format =&gt; &quot;%n %u&quot;}))
    #assert_equal(&quot;$x.&quot;, number_to_currency(&quot;x&quot;)) # fails due to API consolidation
    assert_equal(&quot;$x&quot;, number_to_currency(&quot;x&quot;))
    assert_nil number_to_currency(nil)
  end

  def test_number_to_percentage
    assert_equal(&quot;100.000%&quot;, number_to_percentage(100))
    assert_equal(&quot;100%&quot;, number_to_percentage(100, {:precision =&gt; 0}))
    assert_equal(&quot;302.06%&quot;, number_to_percentage(302.0574, {:precision =&gt; 2}))
    assert_equal(&quot;100.000%&quot;, number_to_percentage(&quot;100&quot;))
    assert_equal(&quot;1000.000%&quot;, number_to_percentage(&quot;1000&quot;))
    assert_equal(&quot;x%&quot;, number_to_percentage(&quot;x&quot;))
    assert_equal(&quot;1.000,000%&quot;, number_to_percentage(1000, :delimiter =&gt; '.', :separator =&gt; ','))
    assert_nil number_to_percentage(nil)
  end

  def test_number_with_delimiter
    assert_equal(&quot;12,345,678&quot;, number_with_delimiter(12345678))
    assert_equal(&quot;0&quot;, number_with_delimiter(0))
    assert_equal(&quot;123&quot;, number_with_delimiter(123))
    assert_equal(&quot;123,456&quot;, number_with_delimiter(123456))
    assert_equal(&quot;123,456.78&quot;, number_with_delimiter(123456.78))
    assert_equal(&quot;123,456.789&quot;, number_with_delimiter(123456.789))
    assert_equal(&quot;123,456.78901&quot;, number_with_delimiter(123456.78901))
    assert_equal(&quot;123,456,789.78901&quot;, number_with_delimiter(123456789.78901))
    assert_equal(&quot;0.78901&quot;, number_with_delimiter(0.78901))
    assert_equal(&quot;123,456.78&quot;, number_with_delimiter(&quot;123456.78&quot;))
    assert_equal(&quot;x&quot;, number_with_delimiter(&quot;x&quot;))
    assert_nil number_with_delimiter(nil)
  end

  def test_number_with_delimiter_with_options_hash
    assert_equal '12 345 678', number_with_delimiter(12345678, :delimiter =&gt; ' ')
    assert_equal '12,345,678-05', number_with_delimiter(12345678.05, :separator =&gt; '-')
    assert_equal '12.345.678,05', number_with_delimiter(12345678.05, :separator =&gt; ',', :delimiter =&gt; '.')
    assert_equal '12.345.678,05', number_with_delimiter(12345678.05, :delimiter =&gt; '.', :separator =&gt; ',')
  end

  def test_number_with_precision
    assert_equal(&quot;111.235&quot;, number_with_precision(111.2346))
    assert_equal(&quot;31.83&quot;, number_with_precision(31.825, :precision =&gt; 2))
    assert_equal(&quot;111.23&quot;, number_with_precision(111.2346, :precision =&gt; 2))
    assert_equal(&quot;111.00&quot;, number_with_precision(111, :precision =&gt; 2))
    assert_equal(&quot;111.235&quot;, number_with_precision(&quot;111.2346&quot;))
    assert_equal(&quot;31.83&quot;, number_with_precision(&quot;31.825&quot;, :precision =&gt; 2))
    assert_equal(&quot;112&quot;, number_with_precision(111.50, :precision =&gt; 0))
    assert_equal(&quot;1234567892&quot;, number_with_precision(1234567891.50, :precision =&gt; 0))

    # Return non-numeric params unchanged.
    assert_equal(&quot;x&quot;, number_with_precision(&quot;x&quot;))
    assert_nil number_with_precision(nil)
  end

  def test_number_with_precision_with_custom_delimiter_and_separator
    assert_equal '31,83',       number_with_precision(31.825, :precision =&gt; 2, :separator =&gt; ',')
    assert_equal '1.231,83',    number_with_precision(1231.825, :precision =&gt; 2, :separator =&gt; ',', :delimiter =&gt; '.')
  end

  def test_number_to_human_size
    assert_equal '0 Bytes',   number_to_human_size(0)
    assert_equal '1 Byte',    number_to_human_size(1)
    assert_equal '3 Bytes',   number_to_human_size(3.14159265)
    assert_equal '123 Bytes', number_to_human_size(123.0)
    assert_equal '123 Bytes', number_to_human_size(123)
    assert_equal '1.2 KB',    number_to_human_size(1234)
    assert_equal '12.1 KB',   number_to_human_size(12345)
    assert_equal '1.2 MB',    number_to_human_size(1234567)
    assert_equal '1.1 GB',    number_to_human_size(1234567890)
    assert_equal '1.1 TB',    number_to_human_size(1234567890123)
    assert_equal '1025 TB',   number_to_human_size(1025.terabytes)
    assert_equal '444 KB',    number_to_human_size(444.kilobytes)
    assert_equal '1023 MB',   number_to_human_size(1023.megabytes)
    assert_equal '3 TB',      number_to_human_size(3.terabytes)
    assert_equal '1.18 MB',   number_to_human_size(1234567, :precision =&gt; 2)
    assert_equal '3 Bytes',   number_to_human_size(3.14159265, :precision =&gt; 4)
    assert_equal(&quot;123 Bytes&quot;, number_to_human_size(&quot;123&quot;))
    assert_equal '1.01 KB',   number_to_human_size(1.0123.kilobytes, :precision =&gt; 2)
    assert_equal '1.01 KB',   number_to_human_size(1.0100.kilobytes, :precision =&gt; 4)
    assert_equal '10 KB',   number_to_human_size(10.000.kilobytes, :precision =&gt; 4)
    assert_equal '1 Byte',   number_to_human_size(1.1)
    assert_equal '10 Bytes', number_to_human_size(10)
    #assert_nil number_to_human_size('x') # fails due to API consolidation
    assert_nil number_to_human_size(nil)
  end

  def test_number_to_human_size_with_options_hash
    assert_equal '1.18 MB',   number_to_human_size(1234567, :precision =&gt; 2)
    assert_equal '3 Bytes',   number_to_human_size(3.14159265, :precision =&gt; 4)
    assert_equal '1.01 KB',   number_to_human_size(1.0123.kilobytes, :precision =&gt; 2)
    assert_equal '1.01 KB',   number_to_human_size(1.0100.kilobytes, :precision =&gt; 4)
    assert_equal '10 KB',     number_to_human_size(10.000.kilobytes, :precision =&gt; 4)
  end

  def test_number_to_human_size_with_custom_delimiter_and_separator
    assert_equal '1,01 KB',     number_to_human_size(1.0123.kilobytes, :precision =&gt; 2, :separator =&gt; ',')
    assert_equal '1,01 KB',     number_to_human_size(1.0100.kilobytes, :precision =&gt; 4, :separator =&gt; ',')
    assert_equal '1.000,1 TB',  number_to_human_size(1000.1.terabytes, :delimiter =&gt; '.', :separator =&gt; ',')
  end
end
</pre>
    </div>