  <div id="fileHeader">
    <h1>capture_test.rb</h1>
    <table class="header-table">
    <tr class="top-aligned-row">
      <td><strong>Path:</strong></td>
      <td>actionpack/test/controller/capture_test.rb</td>
    </tr>
    <tr class="top-aligned-row">
      <td><strong>Last Update:</strong></td>
      <td>Sun Jul 25 11:32:53 +0200 2010</td>
    </tr>
    </table>
  </div>
 <!-- banner header -->

  <div id="bodyContent" >
    <h2>Source Code</h2>
    <pre>require 'abstract_unit'

class CaptureController &lt; ActionController::Base
  def self.controller_name; &quot;test&quot;; end
  def self.controller_path; &quot;test&quot;; end

  def content_for
    render :layout =&gt; &quot;talk_from_action&quot;
  end

  def content_for_with_parameter
    render :layout =&gt; &quot;talk_from_action&quot;
  end

  def content_for_concatenated
    render :layout =&gt; &quot;talk_from_action&quot;
  end

  def non_erb_block_content_for
    render :layout =&gt; &quot;talk_from_action&quot;
  end

  def rescue_action(e) raise end
end

class CaptureTest &lt; ActionController::TestCase
  tests CaptureController

  def setup
    # enable a logger so that (e.g.) the benchmarking stuff runs, so we can get
    # a more accurate simulation of what happens in &quot;real life&quot;.
    @controller.logger = Logger.new(nil)

    @request.host = &quot;www.nextangle.com&quot;
  end

  def test_simple_capture
    get :capturing
    assert_equal &quot;&lt;p&gt;Dreamy days&lt;/p&gt;&quot;, @response.body.strip
  end

  def test_content_for
    get :content_for
    assert_equal expected_content_for_output, @response.body
  end

  def test_should_concatentate_content_for
    get :content_for_concatenated
    assert_equal expected_content_for_output, @response.body
  end

  def test_should_set_content_for_with_parameter
    get :content_for_with_parameter
    assert_equal expected_content_for_output, @response.body
  end

  def test_non_erb_block_content_for
    get :non_erb_block_content_for
    assert_equal expected_content_for_output, @response.body
  end

  private
    def expected_content_for_output
      &quot;&lt;title&gt;Putting stuff in the title!&lt;/title&gt;\n\nGreat stuff!&quot;
    end
end
</pre>
    </div>