  <div id="fileHeader">
    <h1>helpers.rb</h1>
    <table class="header-table">
    <tr class="top-aligned-row">
      <td><strong>Path:</strong></td>
      <td>activesupport/lib/active_support/vendor/i18n-0.3.7/i18n/backend/helpers.rb</td>
    </tr>
    <tr class="top-aligned-row">
      <td><strong>Last Update:</strong></td>
      <td>Sun Jul 25 11:32:53 +0200 2010</td>
    </tr>
    </table>
  </div>
 <!-- banner header -->

  <div id="bodyContent" >
    <h2>Source Code</h2>
    <pre>module I18n
  module Backend
    module Helpers
      SEPARATOR_ESCAPE_CHAR = &quot;\001&quot;

      # Return a new hash with all keys and nested keys converted to symbols.
      def deep_symbolize_keys(hash)
        hash.inject({}) { |result, (key, value)|
          value = deep_symbolize_keys(value) if value.is_a?(Hash)
          result[(key.to_sym rescue key) || key] = value
          result
        }
      end

      # Flatten keys for nested Hashes by chaining up keys using the separator
      #   &gt;&gt; { &quot;a&quot; =&gt; { &quot;b&quot; =&gt; { &quot;c&quot; =&gt; &quot;d&quot;, &quot;e&quot; =&gt; &quot;f&quot; }, &quot;g&quot; =&gt; &quot;h&quot; }, &quot;i&quot; =&gt; &quot;j&quot;}.wind
      #   =&gt; { &quot;a.b.c&quot; =&gt; &quot;d&quot;, &quot;a.b.e&quot; =&gt; &quot;f&quot;, &quot;a.g&quot; =&gt; &quot;h&quot;, &quot;i&quot; =&gt; &quot;j&quot; }
      def wind_keys(hash, separator = nil, subtree = false, prev_key = nil, result = {}, orig_hash=hash)
        separator ||= I18n.default_separator

        hash.each_pair do |key, value|
          key = escape_default_separator(key, separator)
          curr_key = [prev_key, key].compact.join(separator).to_sym

          if value.is_a?(Hash)
            result[curr_key] = value if subtree
            wind_keys(value, separator, subtree, curr_key, result, orig_hash)
          else
            result[unescape_default_separator(curr_key)] = value
          end
        end

        result
      end

      def escape_default_separator(key, separator=nil)
        key.to_s.tr(separator || I18n.default_separator, SEPARATOR_ESCAPE_CHAR)
      end
      
      def unescape_default_separator(key, separator=nil)
        key.to_s.tr(SEPARATOR_ESCAPE_CHAR, separator || I18n.default_separator).to_sym
      end

      # Expand keys chained by the the given separator through nested Hashes
      #   &gt;&gt; { &quot;a.b.c&quot; =&gt; &quot;d&quot;, &quot;a.b.e&quot; =&gt; &quot;f&quot;, &quot;a.g&quot; =&gt; &quot;h&quot;, &quot;i&quot; =&gt; &quot;j&quot; }.unwind
      #   =&gt; { &quot;a&quot; =&gt; { &quot;b&quot; =&gt; { &quot;c&quot; =&gt; &quot;d&quot;, &quot;e&quot; =&gt; &quot;f&quot; }, &quot;g&quot; =&gt; &quot;h&quot; }, &quot;i&quot; =&gt; &quot;j&quot;}
      def unwind_keys(hash, separator = &quot;.&quot;)
        result = {}
        hash.each do |key, value|
          keys = key.to_s.split(separator)
          curr = result
          curr = curr[keys.shift] ||= {} while keys.size &gt; 1
          curr[keys.shift] = value
        end
        result
      end

      # # Flatten the given array once
      # def flatten_once(array)
      #   result = []
      #   for element in array # a little faster than each
      #     result.push(*element)
      #   end
      #   result
      # end
    end
  end
end
</pre>
    </div>