  <div id="fileHeader">
    <h1>i18n_exceptions_test.rb</h1>
    <table class="header-table">
    <tr class="top-aligned-row">
      <td><strong>Path:</strong></td>
      <td>activesupport/lib/active_support/vendor/i18n-0.1.3/test/i18n_exceptions_test.rb</td>
    </tr>
    <tr class="top-aligned-row">
      <td><strong>Last Update:</strong></td>
      <td>Mon Oct 12 14:59:08 +0200 2009</td>
    </tr>
    </table>
  </div>
 <!-- banner header -->

  <div id="bodyContent" >
    <h2>Source Code</h2>
    <pre>$:.unshift &quot;lib&quot;

require 'rubygems'
require 'test/unit'
require 'i18n'
require 'active_support'

class I18nExceptionsTest &lt; Test::Unit::TestCase
  def test_invalid_locale_stores_locale
    force_invalid_locale
  rescue I18n::ArgumentError =&gt; e
    assert_nil e.locale
  end

  def test_invalid_locale_message
    force_invalid_locale
  rescue I18n::ArgumentError =&gt; e
    assert_equal 'nil is not a valid locale', e.message
  end

  def test_missing_translation_data_stores_locale_key_and_options
    force_missing_translation_data
  rescue I18n::ArgumentError =&gt; e
    options = {:scope =&gt; :bar}
    assert_equal 'de', e.locale
    assert_equal :foo, e.key
    assert_equal options, e.options
  end

  def test_missing_translation_data_message
    force_missing_translation_data
  rescue I18n::ArgumentError =&gt; e
    assert_equal 'translation missing: de, bar, foo', e.message
  end

  def test_invalid_pluralization_data_stores_entry_and_count
    force_invalid_pluralization_data
  rescue I18n::ArgumentError =&gt; e
    assert_equal [:bar], e.entry
    assert_equal 1, e.count
  end

  def test_invalid_pluralization_data_message
    force_invalid_pluralization_data
  rescue I18n::ArgumentError =&gt; e
    assert_equal 'translation data [:bar] can not be used with :count =&gt; 1', e.message
  end

  def test_missing_interpolation_argument_stores_key_and_string
    force_missing_interpolation_argument
  rescue I18n::ArgumentError =&gt; e
    assert_equal 'bar', e.key
    assert_equal &quot;{{bar}}&quot;, e.string
  end

  def test_missing_interpolation_argument_message
    force_missing_interpolation_argument
  rescue I18n::ArgumentError =&gt; e
    assert_equal 'interpolation argument bar missing in &quot;{{bar}}&quot;', e.message
  end

  def test_reserved_interpolation_key_stores_key_and_string
    force_reserved_interpolation_key
  rescue I18n::ArgumentError =&gt; e
    assert_equal 'scope', e.key
    assert_equal &quot;{{scope}}&quot;, e.string
  end

  def test_reserved_interpolation_key_message
    force_reserved_interpolation_key
  rescue I18n::ArgumentError =&gt; e
    assert_equal 'reserved key &quot;scope&quot; used in &quot;{{scope}}&quot;', e.message
  end

  private
    def force_invalid_locale
      I18n.backend.translate nil, :foo
    end

    def force_missing_translation_data
      I18n.backend.store_translations 'de', :bar =&gt; nil
      I18n.backend.translate 'de', :foo, :scope =&gt; :bar
    end

    def force_invalid_pluralization_data
      I18n.backend.store_translations 'de', :foo =&gt; [:bar]
      I18n.backend.translate 'de', :foo, :count =&gt; 1
    end

    def force_missing_interpolation_argument
      I18n.backend.store_translations 'de', :foo =&gt; &quot;{{bar}}&quot;
      I18n.backend.translate 'de', :foo, :baz =&gt; 'baz'
    end

    def force_reserved_interpolation_key
      I18n.backend.store_translations 'de', :foo =&gt; &quot;{{scope}}&quot;
      I18n.backend.translate 'de', :foo, :baz =&gt; 'baz'
    end
end</pre>
    </div>