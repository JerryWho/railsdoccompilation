  <div id="fileHeader">
    <h1>message_verifier_test.rb</h1>
    <table class="header-table">
    <tr class="top-aligned-row">
      <td><strong>Path:</strong></td>
      <td>activesupport/test/message_verifier_test.rb</td>
    </tr>
    <tr class="top-aligned-row">
      <td><strong>Last Update:</strong></td>
      <td>Sun Jul 25 11:32:54 +0200 2010</td>
    </tr>
    </table>
  </div>
 <!-- banner header -->

  <div id="bodyContent" >
    <h2>Source Code</h2>
    <pre>require 'abstract_unit'

class MessageVerifierTest &lt; Test::Unit::TestCase
  def setup
    @verifier = ActiveSupport::MessageVerifier.new(&quot;Hey, I'm a secret!&quot;)
    @data = {:some=&gt;&quot;data&quot;, :now=&gt;Time.now}
  end
  
  def test_simple_round_tripping
    message = @verifier.generate(@data)
    assert_equal @data, @verifier.verify(message)
  end
  
  def test_missing_signature_raises
    assert_not_verified(nil)
    assert_not_verified(&quot;&quot;)
  end

  def test_tampered_data_raises
    data, hash = @verifier.generate(@data).split(&quot;--&quot;)
    assert_not_verified(&quot;#{data.reverse}--#{hash}&quot;)
    assert_not_verified(&quot;#{data}--#{hash.reverse}&quot;)
    assert_not_verified(&quot;purejunk&quot;)
  end
  
  def assert_not_verified(message)
    assert_raise(ActiveSupport::MessageVerifier::InvalidSignature) do
      @verifier.verify(message)
    end
  end
end
</pre>
    </div>