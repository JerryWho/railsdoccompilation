  <div id="fileHeader">
    <h1>have_selector.rb</h1>
    <table class="header-table">
    <tr class="top-aligned-row">
      <td><strong>Path:</strong></td>
      <td>lib/webrat/core/matchers/have_selector.rb</td>
    </tr>
    <tr class="top-aligned-row">
      <td><strong>Last Update:</strong></td>
      <td>Mon Oct 12 14:57:29 +0200 2009</td>
    </tr>
    </table>
  </div>
 <!-- banner header -->

  <div id="bodyContent" >
    <h2>Source Code</h2>
    <pre>require &quot;webrat/core/matchers/have_xpath&quot;

module Webrat
  module Matchers

    class HaveSelector &lt; HaveXpath #:nodoc:
      # ==== Returns
      # String:: The failure message.
      def failure_message
        &quot;expected following output to contain a #{tag_inspect} tag:\n#{@document}&quot;
      end

      # ==== Returns
      # String:: The failure message to be displayed in negative matches.
      def negative_failure_message
        &quot;expected following output to omit a #{tag_inspect}:\n#{@document}&quot;
      end

      def tag_inspect
        options = @options.dup
        count = options.delete(:count)
        content = options.delete(:content)

        html = &quot;&lt;#{@expected}&quot;
        options.each do |k,v|
          html &lt;&lt; &quot; #{k}='#{v}'&quot;
        end

        if content
          html &lt;&lt; &quot;&gt;#{content}&lt;/#{@expected}&gt;&quot;
        else
          html &lt;&lt; &quot;/&gt;&quot;
        end

        html
      end

      def query
        Nokogiri::CSS.parse(@expected.to_s).map do |ast|
          ast.to_xpath
        end.first
      end

    end

    # Matches HTML content against a CSS 3 selector.
    #
    # ==== Parameters
    # expected&lt;String&gt;:: The CSS selector to look for.
    #
    # ==== Returns
    # HaveSelector:: A new have selector matcher.
    def have_selector(name, attributes = {}, &amp;block)
      HaveSelector.new(name, attributes, &amp;block)
    end
    alias_method :match_selector, :have_selector


    # Asserts that the body of the response contains
    # the supplied selector
    def assert_have_selector(name, attributes = {}, &amp;block)
      matcher = HaveSelector.new(name, attributes, &amp;block)
      assert matcher.matches?(response_body), matcher.failure_message
    end

    # Asserts that the body of the response
    # does not contain the supplied string or regepx
    def assert_have_no_selector(name, attributes = {}, &amp;block)
      matcher = HaveSelector.new(name, attributes, &amp;block)
      assert !matcher.matches?(response_body), matcher.negative_failure_message
    end

  end
end
</pre>
    </div>