  <div id="fileHeader">
    <h1>have_tag.rb</h1>
    <table class="header-table">
    <tr class="top-aligned-row">
      <td><strong>Path:</strong></td>
      <td>lib/webrat/selenium/matchers/have_tag.rb</td>
    </tr>
    <tr class="top-aligned-row">
      <td><strong>Last Update:</strong></td>
      <td>Mon Oct 12 14:57:29 +0200 2009</td>
    </tr>
    </table>
  </div>
 <!-- banner header -->

  <div id="bodyContent" >
    <h2>Source Code</h2>
    <pre>module Webrat
  module Selenium
    module Matchers

      class HaveTag &lt; HaveSelector #:nodoc:
        # ==== Returns
        # String:: The failure message.
        def failure_message
          &quot;expected following output to contain a #{tag_inspect} tag:\n#{@document}&quot;
        end

        # ==== Returns
        # String:: The failure message to be displayed in negative matches.
        def negative_failure_message
          &quot;expected following output to omit a #{tag_inspect}:\n#{@document}&quot;
        end

        def tag_inspect
          options = @expected.last.dup
          content = options.delete(:content)

          html = &quot;&lt;#{@expected.first}&quot;
          options.each do |k,v|
            html &lt;&lt; &quot; #{k}='#{v}'&quot;
          end

          if content
            html &lt;&lt; &quot;&gt;#{content}&lt;/#{@expected.first}&gt;&quot;
          else
            html &lt;&lt; &quot;/&gt;&quot;
          end

          html
        end

        def query
          options  = @expected.last.dup
          selector = @expected.first.to_s

          selector &lt;&lt; &quot;:contains('#{options.delete(:content)}')&quot; if options[:content]

          options.each do |key, value|
            selector &lt;&lt; &quot;[#{key}='#{value}']&quot;
          end

          Nokogiri::CSS.parse(selector).map { |ast| ast.to_xpath }
        end
      end

      def have_tag(name, attributes = {}, &amp;block)
        HaveTag.new([name, attributes], &amp;block)
      end

      alias_method :match_tag, :have_tag

      # Asserts that the body of the response contains
      # the supplied tag with the associated selectors
      def assert_have_tag(name, attributes = {})
        ht = HaveTag.new([name, attributes])
        assert ht.matches?(response), ht.failure_message
      end

      # Asserts that the body of the response
      # does not contain the supplied string or regepx
      def assert_have_no_tag(name, attributes = {})
        ht = HaveTag.new([name, attributes])
        assert !ht.matches?(response), ht.negative_failure_message
      end

    end
  end
end
</pre>
    </div>