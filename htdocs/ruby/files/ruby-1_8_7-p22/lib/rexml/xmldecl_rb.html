  <div id="fileHeader">
    <h1>xmldecl.rb</h1>
    <table class="header-table">
    <tr class="top-aligned-row">
      <td><strong>Path:</strong></td>
      <td>ruby-1.8.7-p22/lib/rexml/xmldecl.rb
      </td>
    </tr>
    <tr class="top-aligned-row">
      <td><strong>Last Update:</strong></td>
      <td>Fri Apr 18 02:22:13 -0500 2008</td>
    </tr>
    </table>
  </div>
 <!-- banner header -->

  <div id="bodyContent" >
    <h2>Source Code</h2>
    <pre>require 'rexml/encoding'
require 'rexml/source'

module REXML
	# NEEDS DOCUMENTATION
	class XMLDecl &lt; Child
		include Encoding

		DEFAULT_VERSION = &quot;1.0&quot;;
		DEFAULT_ENCODING = &quot;UTF-8&quot;;
		DEFAULT_STANDALONE = &quot;no&quot;;
		START = '&lt;\?xml';
		STOP = '\?&gt;';

		attr_accessor :version, :standalone
    attr_reader :writeencoding, :writethis

		def initialize(version=DEFAULT_VERSION, encoding=nil, standalone=nil)
      @writethis = true
      @writeencoding = !encoding.nil?
			if version.kind_of? XMLDecl
				super()
				@version = version.version
				self.encoding = version.encoding
        @writeencoding = version.writeencoding
				@standalone = version.standalone
			else
				super()
				@version = version
				self.encoding = encoding
				@standalone = standalone
			end
			@version = DEFAULT_VERSION if @version.nil?
		end

		def clone
			XMLDecl.new(self)
		end

    # indent::
    #   Ignored.  There must be no whitespace before an XML declaration
    # transitive::
    #   Ignored
    # ie_hack::
    #   Ignored
		def write(writer, indent=-1, transitive=false, ie_hack=false)
      return nil unless @writethis or writer.kind_of? Output
			writer &lt;&lt; START.sub(/\\/u, '')
      if writer.kind_of? Output
        writer &lt;&lt; &quot; #{content writer.encoding}&quot;
      else
        writer &lt;&lt; &quot; #{content encoding}&quot;
      end
			writer &lt;&lt; STOP.sub(/\\/u, '')
		end

		def ==( other )
		  other.kind_of?(XMLDecl) and
		  other.version == @version and
		  other.encoding == self.encoding and
		  other.standalone == @standalone
		end

		def xmldecl version, encoding, standalone
			@version = version
			self.encoding = encoding
			@standalone = standalone
		end

		def node_type
			:xmldecl
		end

		alias :stand_alone? :standalone
    alias :old_enc= :encoding=

    def encoding=( enc )
      if enc.nil?
        self.old_enc = &quot;UTF-8&quot;
        @writeencoding = false
      else
        self.old_enc = enc
        @writeencoding = true
      end
      self.dowrite
    end

    # Only use this if you do not want the XML declaration to be written;
    # this object is ignored by the XML writer.  Otherwise, instantiate your
    # own XMLDecl and add it to the document.
    #
    # Note that XML 1.1 documents *must* include an XML declaration
    def XMLDecl.default
      rv = XMLDecl.new( &quot;1.0&quot; )
      rv.nowrite
      rv
    end

    def nowrite
      @writethis = false
    end

    def dowrite
      @writethis = true
    end

    def inspect
      START.sub(/\\/u, '') + &quot; ... &quot; + STOP.sub(/\\/u, '')
    end

		private
		def content(enc)
			rv = &quot;version='#@version'&quot;
			rv &lt;&lt; &quot; encoding='#{enc}'&quot; if @writeencoding || enc !~ /utf-8/i
			rv &lt;&lt; &quot; standalone='#@standalone'&quot; if @standalone
			rv
		end
	end
end
</pre>
    </div>