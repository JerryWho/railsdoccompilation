  <div id="fileHeader">
    <h1>ISO-8859-15.rb</h1>
    <table class="header-table">
    <tr class="top-aligned-row">
      <td><strong>Path:</strong></td>
      <td>ruby-1.8.7-p22/lib/rexml/encodings/ISO-8859-15.rb
      </td>
    </tr>
    <tr class="top-aligned-row">
      <td><strong>Last Update:</strong></td>
      <td>Fri Apr 18 02:22:13 -0500 2008</td>
    </tr>
    </table>
  </div>
 <!-- banner header -->

  <div id="bodyContent" >
    <h2>Source Code</h2>
    <pre>#
# This class was contributed by Mikko Tiihonen mikko DOT tiihonen AT hut DOT fi
#
module REXML
  module Encoding
  	register(&quot;ISO-8859-15&quot;) do |o|
  		alias encode to_iso_8859_15
      alias decode from_iso_8859_15
  	end

    # Convert from UTF-8
    def to_iso_8859_15(content)
      array_utf8 = content.unpack('U*')
      array_enc = []
      array_utf8.each do |num|
        case num
          # shortcut first bunch basic characters
        when 0..0xA3; array_enc &lt;&lt; num
          # characters removed compared to iso-8859-1
        when 0xA4; array_enc &lt;&lt; '&amp;#164;'
        when 0xA6; array_enc &lt;&lt; '&amp;#166;'
        when 0xA8; array_enc &lt;&lt; '&amp;#168;'
        when 0xB4; array_enc &lt;&lt; '&amp;#180;'
        when 0xB8; array_enc &lt;&lt; '&amp;#184;'
        when 0xBC; array_enc &lt;&lt; '&amp;#188;'
        when 0xBD; array_enc &lt;&lt; '&amp;#189;'
        when 0xBE; array_enc &lt;&lt; '&amp;#190;'
          # characters added compared to iso-8859-1
        when 0x20AC; array_enc &lt;&lt; 0xA4 # 0xe2 0x82 0xac
        when 0x0160; array_enc &lt;&lt; 0xA6 # 0xc5 0xa0
        when 0x0161; array_enc &lt;&lt; 0xA8 # 0xc5 0xa1
        when 0x017D; array_enc &lt;&lt; 0xB4 # 0xc5 0xbd
        when 0x017E; array_enc &lt;&lt; 0xB8 # 0xc5 0xbe
        when 0x0152; array_enc &lt;&lt; 0xBC # 0xc5 0x92
        when 0x0153; array_enc &lt;&lt; 0xBD # 0xc5 0x93
        when 0x0178; array_enc &lt;&lt; 0xBE # 0xc5 0xb8
        else
          # all remaining basic characters can be used directly
          if num &lt;= 0xFF
            array_enc &lt;&lt; num
          else
            # Numeric entity (&amp;#nnnn;); shard by  Stefan Scholl
            array_enc.concat &quot;&amp;\##{num};&quot;.unpack('C*')
          end
        end
      end
      array_enc.pack('C*')
    end
    
    # Convert to UTF-8
    def from_iso_8859_15(str)
      array_latin9 = str.unpack('C*')
      array_enc = []
      array_latin9.each do |num|
        case num
          # characters that differ compared to iso-8859-1
        when 0xA4; array_enc &lt;&lt; 0x20AC
        when 0xA6; array_enc &lt;&lt; 0x0160
        when 0xA8; array_enc &lt;&lt; 0x0161
        when 0xB4; array_enc &lt;&lt; 0x017D
        when 0xB8; array_enc &lt;&lt; 0x017E
        when 0xBC; array_enc &lt;&lt; 0x0152
        when 0xBD; array_enc &lt;&lt; 0x0153
        when 0xBE; array_enc &lt;&lt; 0x0178
        else
          array_enc &lt;&lt; num
        end
      end
      array_enc.pack('U*')
    end
  end
end
</pre>
    </div>