  <div id="fileHeader">
    <h1>xml-stylesheet.rb</h1>
    <table class="header-table">
    <tr class="top-aligned-row">
      <td><strong>Path:</strong></td>
      <td>ruby-1.8.7-p22/lib/rss/xml-stylesheet.rb
      </td>
    </tr>
    <tr class="top-aligned-row">
      <td><strong>Last Update:</strong></td>
      <td>Sun Oct 21 07:19:43 -0500 2007</td>
    </tr>
    </table>
  </div>
 <!-- banner header -->

  <div id="bodyContent" >
    <h2>Source Code</h2>
    <pre>require &quot;rss/utils&quot;

module RSS

  module XMLStyleSheetMixin
    attr_accessor :xml_stylesheets
    def initialize(*args)
      super
      @xml_stylesheets = []
    end
    
    private
    def xml_stylesheet_pi
      xsss = @xml_stylesheets.collect do |xss|
        pi = xss.to_s
        pi = nil if /\A\s*\z/ =~ pi
        pi
      end.compact
      xsss.push(&quot;&quot;) unless xsss.empty?
      xsss.join(&quot;\n&quot;)
    end
  end

  class XMLStyleSheet

    include Utils

    ATTRIBUTES = %w(href type title media charset alternate)

    GUESS_TABLE = {
      &quot;xsl&quot; =&gt; &quot;text/xsl&quot;,
      &quot;css&quot; =&gt; &quot;text/css&quot;,
    }

    attr_accessor(*ATTRIBUTES)
    attr_accessor(:do_validate)
    def initialize(*attrs)
      if attrs.size == 1 and
          (attrs.first.is_a?(Hash) or attrs.first.is_a?(Array))
        attrs = attrs.first
      end
      @do_validate = true
      ATTRIBUTES.each do |attr|
        __send__(&quot;#{attr}=&quot;, nil)
      end
      vars = ATTRIBUTES.dup
      vars.unshift(:do_validate)
      attrs.each do |name, value|
        if vars.include?(name.to_s)
          __send__(&quot;#{name}=&quot;, value)
        end
      end
    end

    def to_s
      rv = &quot;&quot;
      if @href
        rv &lt;&lt; %Q[&lt;?xml-stylesheet]
        ATTRIBUTES.each do |name|
          if __send__(name)
            rv &lt;&lt; %Q[ #{name}=&quot;#{h __send__(name)}&quot;]
          end
        end
        rv &lt;&lt; %Q[?&gt;]
      end
      rv
    end

    remove_method(:href=)
    def href=(value)
      @href = value
      if @href and @type.nil?
        @type = guess_type(@href)
      end
      @href
    end

    remove_method(:alternate=)
    def alternate=(value)
      if value.nil? or /\A(?:yes|no)\z/ =~ value
        @alternate = value
      else
        if @do_validate
          args = [&quot;?xml-stylesheet?&quot;, %Q[alternate=&quot;#{value}&quot;]]
          raise NotAvailableValueError.new(*args)
        end
      end
      @alternate
    end

    def setup_maker(maker)
      xss = maker.xml_stylesheets.new_xml_stylesheet
      ATTRIBUTES.each do |attr|
        xss.__send__(&quot;#{attr}=&quot;, __send__(attr))
      end
    end
    
    private
    def guess_type(filename)
      /\.([^.]+)$/ =~ filename
      GUESS_TABLE[$1]
    end

  end
end
</pre>
    </div>