  <div id="fileHeader">
    <h1>rexmlparser.rb</h1>
    <table class="header-table">
    <tr class="top-aligned-row">
      <td><strong>Path:</strong></td>
      <td>ruby-1.8.7-p22/lib/rss/rexmlparser.rb
      </td>
    </tr>
    <tr class="top-aligned-row">
      <td><strong>Last Update:</strong></td>
      <td>Mon Feb 12 17:01:19 -0600 2007</td>
    </tr>
    </table>
  </div>
 <!-- banner header -->

  <div id="bodyContent" >
    <h2>Source Code</h2>
    <pre>require &quot;rexml/document&quot;
require &quot;rexml/streamlistener&quot;

/\A(\d+)\.(\d+)(?:\.\d+)+\z/ =~ REXML::Version
if ([$1.to_i, $2.to_i] &lt;=&gt; [2, 5]) &lt; 0
  raise LoadError, &quot;needs REXML 2.5 or later (#{REXML::Version})&quot;
end

module RSS
  
  class REXMLParser &lt; BaseParser

    class &lt;&lt; self
      def listener
        REXMLListener
      end
    end
    
    private
    def _parse
      begin
        REXML::Document.parse_stream(@rss, @listener)
      rescue RuntimeError =&gt; e
        raise NotWellFormedError.new{e.message}
      rescue REXML::ParseException =&gt; e
        context = e.context
        line = context[0] if context
        raise NotWellFormedError.new(line){e.message}
      end
    end
    
  end
  
  class REXMLListener &lt; BaseListener

    include REXML::StreamListener
    include ListenerMixin

    class &lt;&lt; self
      def raise_for_undefined_entity?
        false
      end
    end
    
    def xmldecl(version, encoding, standalone)
      super(version, encoding, standalone == &quot;yes&quot;)
      # Encoding is converted to UTF-8 when REXML parse XML.
      @encoding = 'UTF-8'
    end

    alias_method(:cdata, :text)
  end

end
</pre>
    </div>