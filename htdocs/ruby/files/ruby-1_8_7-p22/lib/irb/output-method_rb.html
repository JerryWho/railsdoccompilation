  <div id="fileHeader">
    <h1>output-method.rb</h1>
    <table class="header-table">
    <tr class="top-aligned-row">
      <td><strong>Path:</strong></td>
      <td>ruby-1.8.7-p22/lib/irb/output-method.rb
      </td>
    </tr>
    <tr class="top-aligned-row">
      <td><strong>Last Update:</strong></td>
      <td>Mon Feb 12 17:01:19 -0600 2007</td>
    </tr>
    </table>
  </div>
 <!-- banner header -->

  <div id="bodyContent" >
    <h2>Source Code</h2>
    <pre>#
#   output-method.rb - optput methods used by irb 
#   	$Release Version: 0.9.5$
#   	$Revision: 11708 $
#   	$Date: 2007-02-13 08:01:19 +0900 (Tue, 13 Feb 2007) $
#   	by Keiju ISHITSUKA(keiju@ruby-lang.org)
#
# --
#
#   
#

require &quot;e2mmap&quot;

module IRB
  # OutputMethod
  #   StdioOutputMethod

  class OutputMethod
    @RCS_ID='-$Id: output-method.rb 11708 2007-02-12 23:01:19Z shyouhei $-'

    def print(*opts)
      IRB.fail NotImplementError, &quot;print&quot;
    end

    def printn(*opts)
      print opts.join(&quot; &quot;), &quot;\n&quot;
    end

    # extend printf
    def printf(format, *opts)
      if /(%*)%I/ =~ format
	format, opts = parse_printf_format(format, opts)
      end
      print sprintf(format, *opts)
    end

    # %
    # &lt;フラグ&gt;  [#0- +]
    # &lt;最小フィールド幅&gt; (\*|\*[1-9][0-9]*\$|[1-9][0-9]*)
    # &lt;精度&gt;.(\*|\*[1-9][0-9]*\$|[1-9][0-9]*|)?
    # #&lt;長さ修正文字&gt;(hh|h|l|ll|L|q|j|z|t)
    # &lt;変換修正文字&gt;[diouxXeEfgGcsb%] 
    def parse_printf_format(format, opts)
      return format, opts if $1.size % 2 == 1
    end

    def foo(format)
      pos = 0
      inspects = []
      format.scan(/%[#0\-+ ]?(\*(?=[^0-9])|\*[1-9][0-9]*\$|[1-9][0-9]*(?=[^0-9]))?(\.(\*(?=[^0-9])|\*[1-9][0-9]*\$|[1-9][0-9]*(?=[^0-9])))?(([1-9][0-9]*\$)*)([diouxXeEfgGcsb%])/) {|f, p, pp, pos, new_pos, c|
	puts [f, p, pp, pos, new_pos, c].join(&quot;!&quot;)
	pos = new_pos if new_pos
	if c == &quot;I&quot;
	  inspects.push pos.to_i 
	  (f||&quot;&quot;)+(p||&quot;&quot;)+(pp||&quot;&quot;)+(pos||&quot;&quot;)+&quot;s&quot;
	else
	  $&amp;
	end
      }
    end

    def puts(*objs)
      for obj in objs
	print(*obj)
	print &quot;\n&quot;
      end
    end

    def pp(*objs)
      puts(*objs.collect{|obj| obj.inspect})
    end

    def ppx(prefix, *objs)
      puts(*objs.collect{|obj| prefix+obj.inspect})
    end

  end

  class StdioOutputMethod&lt;OutputMethod
    def print(*opts)
      STDOUT.print(*opts)
    end
  end
end
</pre>
    </div>