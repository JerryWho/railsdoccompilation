  <div id="fileHeader">
    <h1>extconf.rb</h1>
    <table class="header-table">
    <tr class="top-aligned-row">
      <td><strong>Path:</strong></td>
      <td>ruby-1.8.7-p22/ext/win32ole/extconf.rb
      </td>
    </tr>
    <tr class="top-aligned-row">
      <td><strong>Last Update:</strong></td>
      <td>Mon Feb 12 17:01:19 -0600 2007</td>
    </tr>
    </table>
  </div>
 <!-- banner header -->

  <div id="bodyContent" >
    <h2>Source Code</h2>
    <pre>#----------------------------------
# extconf.rb
# $Revision: 11708 $
# $Date: 2007-02-13 08:01:19 +0900 (Tue, 13 Feb 2007) $
#----------------------------------
require 'mkmf'

dir_config(&quot;win32&quot;)

SRCFILES=&lt;&lt;SRC
win32ole.c
SRC

def create_docfile(src)
  open(File.expand_path($srcdir) + &quot;/.document&quot;, &quot;w&quot;) {|ofs|
    ofs.print src
  }
end

def create_win32ole_makefile
  if have_library(&quot;ole32&quot;) and
     have_library(&quot;oleaut32&quot;) and
     have_library(&quot;uuid&quot;) and 
     have_library(&quot;user32&quot;) and
     have_library(&quot;kernel32&quot;) and
     have_library(&quot;advapi32&quot;) and
     have_header(&quot;windows.h&quot;)
    create_makefile(&quot;win32ole&quot;)
    create_docfile(SRCFILES)
  else
    create_docfile(&quot;&quot;)
  end
end

case RUBY_PLATFORM
when /mswin32/
  $CFLAGS += ' /W3'
when /cygwin/, /mingw/
  $defs &lt;&lt; '-DNONAMELESSUNION'
end
create_win32ole_makefile
</pre>
    </div>