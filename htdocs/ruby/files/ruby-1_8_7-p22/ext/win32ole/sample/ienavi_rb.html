  <div id="fileHeader">
    <h1>ienavi.rb</h1>
    <table class="header-table">
    <tr class="top-aligned-row">
      <td><strong>Path:</strong></td>
      <td>ruby-1.8.7-p22/ext/win32ole/sample/ienavi.rb
      </td>
    </tr>
    <tr class="top-aligned-row">
      <td><strong>Last Update:</strong></td>
      <td>Mon Feb 12 17:01:19 -0600 2007</td>
    </tr>
    </table>
  </div>
 <!-- banner header -->

  <div id="bodyContent" >
    <h2>Source Code</h2>
    <pre>require 'win32ole'

$urls = []

def navigate(url)
  $urls &lt;&lt; url
end

def stop_msg_loop
  puts &quot;Now Stop IE...&quot;
  $LOOP = FALSE;
end

def default_handler(event, *args)
  case event
  when &quot;BeforeNavigate&quot;
    puts &quot;Now Navigate #{args[0]}...&quot;
  end
end

ie = WIN32OLE.new('InternetExplorer.Application')
ie.visible = TRUE
ie.gohome

ev = WIN32OLE_EVENT.new(ie, 'DWebBrowserEvents')

ev.on_event {|*args| default_handler(*args)}
ev.on_event(&quot;NavigateComplete&quot;) {|url| navigate(url)}
ev.on_event(&quot;Quit&quot;) {|*args| stop_msg_loop} 

$LOOP = TRUE
while ($LOOP)
  WIN32OLE_EVENT.message_loop
end

puts &quot;You Navigated the URLs ...&quot;
$urls.each_with_index do |url, i|
  puts &quot;(#{i+1}) #{url}&quot;
end

</pre>
    </div>