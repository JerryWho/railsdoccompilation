  <div id="C00001337">
<div class='banner'>
  <span class="file-title-prefix">Module</span><br />Unit<br/>
  In:
<a href="#" onclick="jsHref('files/ruby-1_8_7-p22/lib/test/unit/assertionfailederror_rb.html');">ruby-1.8.7-p22/lib/test/unit/assertionfailederror.rb</a>
<a href="#" onclick="jsHref('files/ruby-1_8_7-p22/lib/test/unit/assertions_rb.html');">ruby-1.8.7-p22/lib/test/unit/assertions.rb</a>
<a href="#" onclick="jsHref('files/ruby-1_8_7-p22/lib/test/unit/autorunner_rb.html');">ruby-1.8.7-p22/lib/test/unit/autorunner.rb</a>
<a href="#" onclick="jsHref('files/ruby-1_8_7-p22/lib/test/unit/collector/dir_rb.html');">ruby-1.8.7-p22/lib/test/unit/collector/dir.rb</a>
<a href="#" onclick="jsHref('files/ruby-1_8_7-p22/lib/test/unit/collector/objectspace_rb.html');">ruby-1.8.7-p22/lib/test/unit/collector/objectspace.rb</a>
<a href="#" onclick="jsHref('files/ruby-1_8_7-p22/lib/test/unit/collector_rb.html');">ruby-1.8.7-p22/lib/test/unit/collector.rb</a>
<a href="#" onclick="jsHref('files/ruby-1_8_7-p22/lib/test/unit/error_rb.html');">ruby-1.8.7-p22/lib/test/unit/error.rb</a>
<a href="#" onclick="jsHref('files/ruby-1_8_7-p22/lib/test/unit/failure_rb.html');">ruby-1.8.7-p22/lib/test/unit/failure.rb</a>
<a href="#" onclick="jsHref('files/ruby-1_8_7-p22/lib/test/unit/testcase_rb.html');">ruby-1.8.7-p22/lib/test/unit/testcase.rb</a>
<a href="#" onclick="jsHref('files/ruby-1_8_7-p22/lib/test/unit/testresult_rb.html');">ruby-1.8.7-p22/lib/test/unit/testresult.rb</a>
<a href="#" onclick="jsHref('files/ruby-1_8_7-p22/lib/test/unit/testsuite_rb.html');">ruby-1.8.7-p22/lib/test/unit/testsuite.rb</a>
<a href="#" onclick="jsHref('files/ruby-1_8_7-p22/lib/test/unit/ui/console/testrunner_rb.html');">ruby-1.8.7-p22/lib/test/unit/ui/console/testrunner.rb</a>
<a href="#" onclick="jsHref('files/ruby-1_8_7-p22/lib/test/unit/ui/fox/testrunner_rb.html');">ruby-1.8.7-p22/lib/test/unit/ui/fox/testrunner.rb</a>
<a href="#" onclick="jsHref('files/ruby-1_8_7-p22/lib/test/unit/ui/gtk/testrunner_rb.html');">ruby-1.8.7-p22/lib/test/unit/ui/gtk/testrunner.rb</a>
<a href="#" onclick="jsHref('files/ruby-1_8_7-p22/lib/test/unit/ui/gtk2/testrunner_rb.html');">ruby-1.8.7-p22/lib/test/unit/ui/gtk2/testrunner.rb</a>
<a href="#" onclick="jsHref('files/ruby-1_8_7-p22/lib/test/unit/ui/testrunnermediator_rb.html');">ruby-1.8.7-p22/lib/test/unit/ui/testrunnermediator.rb</a>
<a href="#" onclick="jsHref('files/ruby-1_8_7-p22/lib/test/unit/ui/testrunnerutilities_rb.html');">ruby-1.8.7-p22/lib/test/unit/ui/testrunnerutilities.rb</a>
<a href="#" onclick="jsHref('files/ruby-1_8_7-p22/lib/test/unit/ui/tk/testrunner_rb.html');">ruby-1.8.7-p22/lib/test/unit/ui/tk/testrunner.rb</a>
<a href="#" onclick="jsHref('files/ruby-1_8_7-p22/lib/test/unit/util/backtracefilter_rb.html');">ruby-1.8.7-p22/lib/test/unit/util/backtracefilter.rb</a>
<a href="#" onclick="jsHref('files/ruby-1_8_7-p22/lib/test/unit/util/observable_rb.html');">ruby-1.8.7-p22/lib/test/unit/util/observable.rb</a>
<a href="#" onclick="jsHref('files/ruby-1_8_7-p22/lib/test/unit/util/procwrapper_rb.html');">ruby-1.8.7-p22/lib/test/unit/util/procwrapper.rb</a>
<a href="#" onclick="jsHref('files/ruby-1_8_7-p22/lib/test/unit_rb.html');">ruby-1.8.7-p22/lib/test/unit.rb</a>

</div>
 <!-- banner header -->

  <div id="bodyContent" >
      <div id="content">

  <div class="description"><h1><a href="index.html?a=C00001337&name=Test::Unit">Test::Unit</a> - Ruby <a href="index.html?a=C00001337&name=Unit">Unit</a> Testing Framework</h1>
<h2>Introduction</h2>
<p>
<a href="index.html?a=C00001337&name=Unit">Unit</a> testing is making waves
all over the place, largely due to the fact that it is a core practice of
XP. While XP is great, unit testing has been around for a long time and has
always been a good idea. One of the keys to good unit testing, though, is
not just writing tests, but having tests. What&#8217;s the difference?
Well, if you just <em>write</em> a test and throw it away, you have no
guarantee that something won&#8217;t change later which breaks your code.
If, on the other hand, you <em>have</em> tests (obviously you have to write
them first), and run them as often as possible, you slowly build up a wall
of things that cannot break without you immediately knowing about it. This
is when unit testing hits its peak usefulness.
</p>
<p>
Enter <a href="index.html?a=C00001337&name=Test::Unit">Test::Unit</a>, a
framework for unit testing in Ruby, helping you to design, debug and
evaluate your code by making it easy to write and have tests for it.
</p>
<h2>Notes</h2>
<p>
<a href="index.html?a=C00001337&name=Test::Unit">Test::Unit</a> has grown
out of and superceded Lapidary.
</p>
<h2>Feedback</h2>
<p>
I like (and do my best to practice) XP, so I value early releases, user
feedback, and clean, simple, expressive code. There is always room for
improvement in everything I do, and <a
href="index.html?a=C00001337&name=Test::Unit">Test::Unit</a> is no
exception. Please, let me know what you think of <a
href="index.html?a=C00001337&name=Test::Unit">Test::Unit</a> as it stands,
and what you&#8217;d like to see expanded/changed/improved/etc. If you find
a bug, let me know ASAP; one good way to let me know what the bug is is to
submit a new test that catches it :-) Also, I&#8217;d love to hear about
any successes you have with <a
href="index.html?a=C00001337&name=Test::Unit">Test::Unit</a>, and any
documentation you might add will be greatly appreciated. My contact info is
below.
</p>
<h2>Contact Information</h2>
<p>
A lot of discussion happens about Ruby in general on the ruby-talk mailing
list (<a href="http://www.ruby-lang.org/en/ml.html"
target="_blank">http://www.ruby-lang.org/en/ml.html</a>), and you can ask
any questions you might have there. I monitor the list, as do many other
helpful Rubyists, and you&#8217;re sure to get a quick answer. Of course,
you&#8217;re also welcome to email me (Nathaniel Talbott) directly at <a
href="#"
onclick="jsHref('mailto:testunit@talbott.ws');">testunit@talbott.ws</a>,
and I&#8217;ll do my best to help you out.
</p>
<h2>Credits</h2>
<p>
I&#8217;d like to thank&#8230;
</p>
<p>
Matz, for a great language!
</p>
<p>
Masaki Suketa, for his work on RubyUnit, which filled a vital need in the
Ruby world for a very long time. I&#8217;m also grateful for his help in
polishing <a href="index.html?a=C00001337&name=Test::Unit">Test::Unit</a>
and getting the RubyUnit compatibility layer right. His graciousness in
allowing <a href="index.html?a=C00001337&name=Test::Unit">Test::Unit</a> to
supercede RubyUnit continues to be a challenge to me to be more willing to
defer my own rights.
</p>
<p>
Ken McKinlay, for his interest and work on unit testing, and for his
willingness to dialog about it. He was also a great help in pointing out
some of the holes in the RubyUnit compatibility layer.
</p>
<p>
Dave Thomas, for the original idea that led to the extremely simple
&quot;require &#8216;test/unit&#8217;&quot;, plus his code to improve it
even more by allowing the selection of tests from the command-line. Also,
without <a href="index.html?a=C00000966&name=RDoc">RDoc</a>, the
documentation for <a
href="index.html?a=C00001337&name=Test::Unit">Test::Unit</a> would stink a
lot more than it does now.
</p>
<p>
Everyone who&#8217;s helped out with bug reports, feature ideas,
encouragement to continue, etc. It&#8217;s a real privilege to be a part of
the Ruby community.
</p>
<p>
The guys at RoleModel Software, for putting up with me repeating, &quot;But
this would be so much easier in Ruby!&quot; whenever we&#8217;re coding in
Java.
</p>
<p>
My Creator, for giving me life, and giving it more abundantly.
</p>
<h2>License</h2>
<p>
<a href="index.html?a=C00001337&name=Test::Unit">Test::Unit</a> is
copyright &#169; 2000-2003 Nathaniel Talbott. It is free software, and is
distributed under the Ruby license. See the COPYING file in the standard
Ruby distribution for details.
</p>
<h2>Warranty</h2>
<p>
This software is provided &quot;as is&quot; and without any express or
implied warranties, including, without limitation, the implied warranties
of merchantibility and fitness for a particular purpose.
</p>
<h2>Author</h2>
<p>
Nathaniel Talbott. Copyright &#169; 2000-2003, Nathaniel Talbott
</p>
<hr size="2"></hr><h1>Usage</h1>
<p>
The general idea behind unit testing is that you write a <em>test</em>
<em>method</em> that makes certain <em>assertions</em> about your code,
working against a <em>test</em> <em>fixture</em>. A bunch of these
<em>test</em> <em>methods</em> are bundled up into a <em>test</em>
<em>suite</em> and can be run any time the developer wants. The results of
a run are gathered in a <em>test</em> <em>result</em> and displayed to the
user through some <a href="index.html?a=C00001345&name=UI">UI</a>. So, lets
break this down and see how <a
href="index.html?a=C00001337&name=Test::Unit">Test::Unit</a> provides each
of these necessary pieces.
</p>
<h2><a href="index.html?a=C00001364&name=Assertions">Assertions</a></h2>
<p>
These are the heart of the framework. Think of an assertion as a statement
of expected outcome, i.e. &quot;I assert that x should be equal to y&quot;.
If, when the assertion is executed, it turns out to be correct, nothing
happens, and life is good. If, on the other hand, your assertion turns out
to be false, an error is propagated with pertinent information so that you
can go back and make your assertion succeed, and, once again, life is good.
For an explanation of the current assertions, see <a
href="index.html?a=C00001364&name=Test::Unit::Assertions">Test::Unit::Assertions</a>.
</p>
<h2>Test <a href="index.html?a=C00000219&name=Method">Method</a> &amp; Test Fixture</h2>
<p>
Obviously, these assertions have to be called within a context that knows
about them and can do something meaningful with their pass/fail value.
Also, it&#8217;s handy to collect a bunch of related tests, each test
represented by a method, into a common test class that knows how to run
them. The tests will be in a separate class from the code they&#8217;re
testing for a couple of reasons. First of all, it allows your code to stay
uncluttered with test code, making it easier to maintain. Second, it allows
the tests to be stripped out for deployment, since they&#8217;re really
there for you, the developer, and your users don&#8217;t need them. Third,
and most importantly, it allows you to set up a common test fixture for
your tests to run against.
</p>
<p>
What&#8217;s a test fixture? Well, tests do not live in a vacuum; rather,
they&#8217;re run against the code they are testing. Often, a collection of
tests will run against a common set of data, also called a fixture. If
they&#8217;re all bundled into the same test class, they can all share the
setting up and tearing down of that data, eliminating unnecessary
duplication and making it much easier to add related tests.
</p>
<p>
<a
href="index.html?a=C00001365&name=Test::Unit::TestCase">Test::Unit::TestCase</a>
wraps up a collection of test methods together and allows you to easily set
up and tear down the same test fixture for each test. This is done by
overriding setup and/or teardown, which will be called before and after
each test method that is run. The <a
href="index.html?a=C00001365&name=TestCase">TestCase</a> also knows how to
collect the results of your assertions into a <a
href="index.html?a=C00001370&name=Test::Unit::TestResult">Test::Unit::TestResult</a>,
which can then be reported back to you&#8230; but I&#8217;m getting ahead
of myself. To write a test, follow these steps:
</p>
<ul>
<li>Make sure <a href="index.html?a=C00001337&name=Test::Unit">Test::Unit</a>
is in your library path.

</li>
<li>require &#8216;test/unit&#8217; in your test script.

</li>
<li>Create a class that subclasses <a
href="index.html?a=C00001365&name=Test::Unit::TestCase">Test::Unit::TestCase</a>.

</li>
<li>Add a method that begins with &quot;test&quot; to your class.

</li>
<li>Make assertions in your test method.

</li>
<li>Optionally define setup and/or teardown to set up and/or tear down your
common test fixture.

</li>
<li>You can now run your test as you would any other Ruby script&#8230; try it
and see!

</li>
</ul>
<p>
A really simple test might look like this (setup and teardown are commented
out to indicate that they are completely optional):
</p>
<pre>
    require 'test/unit'

    class TC_MyTest &lt; Test::Unit::TestCase
      # def setup
      # end

      # def teardown
      # end

      def test_fail
        assert(false, 'Assertion was false.')
      end
    end
</pre>
<h2>Test Runners</h2>
<p>
So, now you have this great test class, but you still need a way to run it
and view any failures that occur during the run. This is where <a
href="index.html?a=C00001352&name=Test::Unit::UI::Console::TestRunner">Test::Unit::UI::Console::TestRunner</a>
(and others, such as <a
href="index.html?a=C00001357&name=Test::Unit::UI::GTK::TestRunner">Test::Unit::UI::GTK::TestRunner</a>)
comes into play. The console test runner is automatically invoked for you
if you require &#8216;test/unit&#8217; and simply run the file. To use
another runner, or to manually invoke a runner, simply call its run class
method and pass in an object that responds to the suite message with a <a
href="index.html?a=C00001369&name=Test::Unit::TestSuite">Test::Unit::TestSuite</a>.
This can be as simple as passing in your <a
href="index.html?a=C00001365&name=TestCase">TestCase</a> class (which has a
class suite method). It might look something like this:
</p>
<pre>
   require 'test/unit/ui/console/testrunner'
   Test::Unit::UI::Console::TestRunner.run(TC_MyTest)
</pre>
<h2>Test Suite</h2>
<p>
As more and more unit tests accumulate for a given project, it becomes a
real drag running them one at a time, and it also introduces the potential
to overlook a failing test because you forget to run it. Suddenly it
becomes very handy that the TestRunners can take any object that returns a
<a
href="index.html?a=C00001369&name=Test::Unit::TestSuite">Test::Unit::TestSuite</a>
in response to a suite method. The <a
href="index.html?a=C00001369&name=TestSuite">TestSuite</a> can, in turn,
contain other TestSuites or individual tests (typically created by a <a
href="index.html?a=C00001365&name=TestCase">TestCase</a>). In other words,
you can easily wrap up a group of TestCases and TestSuites like this:
</p>
<pre>
 require 'test/unit/testsuite'
 require 'tc_myfirsttests'
 require 'tc_moretestsbyme'
 require 'ts_anothersetoftests'

 class TS_MyTests
   def self.suite
     suite = Test::Unit::TestSuite.new
     suite &lt;&lt; TC_MyFirstTests.suite
     suite &lt;&lt; TC_MoreTestsByMe.suite
     suite &lt;&lt; TS_AnotherSetOfTests.suite
     return suite
   end
 end
 Test::Unit::UI::Console::TestRunner.run(TS_MyTests)
</pre>
<p>
Now, this is a bit cumbersome, so <a
href="index.html?a=C00001337&name=Test::Unit">Test::Unit</a> does a little
bit more for you, by wrapping these up automatically when you require
&#8216;test/unit&#8217;. What does this mean? It means you could write the
above test case like this instead:
</p>
<pre>
 require 'test/unit'
 require 'tc_myfirsttests'
 require 'tc_moretestsbyme'
 require 'ts_anothersetoftests'
</pre>
<p>
<a href="index.html?a=C00001337&name=Test::Unit">Test::Unit</a> is smart
enough to find all the test cases existing in the <a
href="index.html?a=C00001383&name=ObjectSpace">ObjectSpace</a> and wrap
them up into a suite for you. It then runs the dynamic suite using the
console TestRunner.
</p>
<h2>Questions?</h2>
<p>
I&#8217;d really like to get feedback from all levels of Ruby practitioners
about typos, grammatical errors, unclear statements, missing points, etc.,
in this document (or any other).
</p>
</div>



  <div class="sectiontitle">Methods</div>
  <ul>
  <li><a href="index.html?a=M006836&name=run=" >run=</a></li>
  <li><a href="index.html?a=M006837&name=run?" >run?</a></li>
  </ul>



  <div class="sectiontitle">Classes and Modules</div>
  Module "<a href="#" onclick="jsHref('classes/Test/Unit/Assertions.html');" class="link">Test::Unit::Assertions</a>"<br />
Module "<a href="#" onclick="jsHref('classes/Test/Unit/Collector.html');" class="link">Test::Unit::Collector</a>"<br />
Module "<a href="#" onclick="jsHref('classes/Test/Unit/UI.html');" class="link">Test::Unit::UI</a>"<br />
Module "<a href="#" onclick="jsHref('classes/Test/Unit/Util.html');" class="link">Test::Unit::Util</a>"<br />
Class "<a href="#" onclick="jsHref('classes/Test/Unit/AssertionFailedError.html');" class="link">Test::Unit::AssertionFailedError</a>"<br />
Class "<a href="#" onclick="jsHref('classes/Test/Unit/AutoRunner.html');" class="link">Test::Unit::AutoRunner</a>"<br />
Class "<a href="#" onclick="jsHref('classes/Test/Unit/Error.html');" class="link">Test::Unit::Error</a>"<br />
Class "<a href="#" onclick="jsHref('classes/Test/Unit/Failure.html');" class="link">Test::Unit::Failure</a>"<br />
Class "<a href="#" onclick="jsHref('classes/Test/Unit/TestCase.html');" class="link">Test::Unit::TestCase</a>"<br />
Class "<a href="#" onclick="jsHref('classes/Test/Unit/TestResult.html');" class="link">Test::Unit::TestResult</a>"<br />
Class "<a href="#" onclick="jsHref('classes/Test/Unit/TestSuite.html');" class="link">Test::Unit::TestSuite</a>"<br />


  <div class="sectiontitle">Constants</div>
  <table border='0' cellpadding='5'>
  <tr valign='top'>
    <td class="attr-name">OUTPUT_LEVELS</td>
    <td>=</td>
    <td class="attr-value">[         [:silent, UI::SILENT],         [:progress, UI::PROGRESS_ONLY],         [:normal, UI::NORMAL],         [:verbose, UI::VERBOSE],       ]</td>
  </tr>
  <tr valign='top'>
    <td class="attr-name">COLLECTORS</td>
    <td>=</td>
    <td class="attr-value">{         :objectspace =&gt; proc do |r|           require 'test/unit/collector/objectspace'</td>
  </tr>
  </table>


<div class="sectiontitle">Public Class methods</div>
<div id="M006836" class="method">
  <div id="M006836_title" class="title">
    <b>run=</b>(flag)
  </div>
  <div class="description">
  <p>
If set to false <a
href="index.html?a=C00001337&name=Test::Unit">Test::Unit</a> will not
automatically run at exit.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006836_source')" id="l_M006836_source">show source</a> ]</p>
  <div id="M006836_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/test/unit.rb, line 265</span>
265:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">run=</span>(<span class="ruby-identifier">flag</span>)
266:       <span class="ruby-ivar">@run</span> = <span class="ruby-identifier">flag</span>
267:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006837" class="method">
  <div id="M006837_title" class="title">
    <b>run?</b>()
  </div>
  <div class="description">
  <p>
Automatically run tests at exit?
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006837_source')" id="l_M006837_source">show source</a> ]</p>
  <div id="M006837_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/test/unit.rb, line 270</span>
270:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">run?</span>
271:       <span class="ruby-ivar">@run</span> <span class="ruby-operator">||=</span> <span class="ruby-keyword kw">false</span>
272:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
</div>

  </div>