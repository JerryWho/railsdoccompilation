  <div id="C00000228">
<div class='banner'>
  <span class="file-title-prefix">Class</span><br />TestWin32OLE<br/>
  In:
<a href="#" onclick="jsHref('files/ruby-1_8_7-p22/ext/win32ole/tests/testWIN32OLE_rb.html');">ruby-1.8.7-p22/ext/win32ole/tests/testWIN32OLE.rb</a>

Parent:&nbsp;
RUNIT::TestCase
</div>
 <!-- banner header -->

  <div id="bodyContent" >
      <div id="content">




  <div class="sectiontitle">Methods</div>
  <ul>
  <li><a href="index.html?a=M001961&name=setup" >setup</a></li>
  <li><a href="index.html?a=M001992&name=teardown" >teardown</a></li>
  <li><a href="index.html?a=M001969&name=test_const_CP_ACP" >test_const_CP_ACP</a></li>
  <li><a href="index.html?a=M001971&name=test_const_CP_MACCP" >test_const_CP_MACCP</a></li>
  <li><a href="index.html?a=M001970&name=test_const_CP_OEMCP" >test_const_CP_OEMCP</a></li>
  <li><a href="index.html?a=M001973&name=test_const_CP_SYMBOL" >test_const_CP_SYMBOL</a></li>
  <li><a href="index.html?a=M001972&name=test_const_CP_THREAD_ACP" >test_const_CP_THREAD_ACP</a></li>
  <li><a href="index.html?a=M001974&name=test_const_CP_UTF7" >test_const_CP_UTF7</a></li>
  <li><a href="index.html?a=M001975&name=test_const_CP_UTF8" >test_const_CP_UTF8</a></li>
  <li><a href="index.html?a=M001980&name=test_convert_bignum" >test_convert_bignum</a></li>
  <li><a href="index.html?a=M001978&name=test_each" >test_each</a></li>
  <li><a href="index.html?a=M001977&name=test_get_win32ole_object" >test_get_win32ole_object</a></li>
  <li><a href="index.html?a=M001986&name=test_invoke" >test_invoke</a></li>
  <li><a href="index.html?a=M001984&name=test_no_exist_property" >test_no_exist_property</a></li>
  <li><a href="index.html?a=M001988&name=test_ole_func_methods" >test_ole_func_methods</a></li>
  <li><a href="index.html?a=M001990&name=test_ole_get_methods" >test_ole_get_methods</a></li>
  <li><a href="index.html?a=M001981&name=test_ole_invoke_with_named_arg" >test_ole_invoke_with_named_arg</a></li>
  <li><a href="index.html?a=M001982&name=test_ole_invoke_with_named_arg_last" >test_ole_invoke_with_named_arg_last</a></li>
  <li><a href="index.html?a=M001991&name=test_ole_method_help" >test_ole_method_help</a></li>
  <li><a href="index.html?a=M001987&name=test_ole_methods" >test_ole_methods</a></li>
  <li><a href="index.html?a=M001989&name=test_ole_put_methods" >test_ole_put_methods</a></li>
  <li><a href="index.html?a=M001967&name=test_s_codepage" >test_s_codepage</a></li>
  <li><a href="index.html?a=M001976&name=test_s_codepage_changed" >test_s_codepage_changed</a></li>
  <li><a href="index.html?a=M001968&name=test_s_codepage_set" >test_s_codepage_set</a></li>
  <li><a href="index.html?a=M001965&name=test_s_connect" >test_s_connect</a></li>
  <li><a href="index.html?a=M001966&name=test_s_const_load" >test_s_const_load</a></li>
  <li><a href="index.html?a=M001962&name=test_s_new" >test_s_new</a></li>
  <li><a href="index.html?a=M001963&name=test_s_new_DCOM" >test_s_new_DCOM</a></li>
  <li><a href="index.html?a=M001964&name=test_s_new_from_clsid" >test_s_new_from_clsid</a></li>
  <li><a href="index.html?a=M001983&name=test_setproperty" >test_setproperty</a></li>
  <li><a href="index.html?a=M001979&name=test_setproperty_bracket" >test_setproperty_bracket</a></li>
  <li><a href="index.html?a=M001985&name=test_setproperty_with_equal" >test_setproperty_with_equal</a></li>
  </ul>

<div class="sectiontitle">Included Modules</div>
<ul>
  <li><a href="#" onclick="jsHref('classes/OLESERVER.html');">OLESERVER</a></li>
</ul>





<div class="sectiontitle">Public Instance methods</div>
<div id="M001961" class="method">
  <div id="M001961_title" class="title">
    <b>setup</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001961_source')" id="l_M001961_source">show source</a> ]</p>
  <div id="M001961_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File ruby-1.8.7-p22/ext/win32ole/tests/testWIN32OLE.rb, line 23</span>
23:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">setup</span>
24:     <span class="ruby-ivar">@excel</span> = <span class="ruby-constant">WIN32OLE</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;Excel.Application&quot;</span>)
25:     <span class="ruby-ivar">@excel</span>.<span class="ruby-identifier">visible</span> = <span class="ruby-keyword kw">true</span>
26:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001992" class="method">
  <div id="M001992_title" class="title">
    <b>teardown</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001992_source')" id="l_M001992_source">show source</a> ]</p>
  <div id="M001992_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/ext/win32ole/tests/testWIN32OLE.rb, line 278</span>
278:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">teardown</span>
279:     <span class="ruby-ivar">@excel</span>.<span class="ruby-identifier">quit</span>
280:     <span class="ruby-ivar">@excel</span> = <span class="ruby-keyword kw">nil</span>
281:     <span class="ruby-constant">GC</span>.<span class="ruby-identifier">start</span>
282:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001969" class="method">
  <div id="M001969_title" class="title">
    <b>test_const_CP_ACP</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001969_source')" id="l_M001969_source">show source</a> ]</p>
  <div id="M001969_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File ruby-1.8.7-p22/ext/win32ole/tests/testWIN32OLE.rb, line 70</span>
70:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_const_CP_ACP</span>
71:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value">0</span>, <span class="ruby-constant">WIN32OLE</span><span class="ruby-operator">::</span><span class="ruby-constant">CP_ACP</span>)
72:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001971" class="method">
  <div id="M001971_title" class="title">
    <b>test_const_CP_MACCP</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001971_source')" id="l_M001971_source">show source</a> ]</p>
  <div id="M001971_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File ruby-1.8.7-p22/ext/win32ole/tests/testWIN32OLE.rb, line 78</span>
78:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_const_CP_MACCP</span>
79:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value">2</span>, <span class="ruby-constant">WIN32OLE</span><span class="ruby-operator">::</span><span class="ruby-constant">CP_MACCP</span>)
80:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001970" class="method">
  <div id="M001970_title" class="title">
    <b>test_const_CP_OEMCP</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001970_source')" id="l_M001970_source">show source</a> ]</p>
  <div id="M001970_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File ruby-1.8.7-p22/ext/win32ole/tests/testWIN32OLE.rb, line 74</span>
74:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_const_CP_OEMCP</span>
75:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value">1</span>, <span class="ruby-constant">WIN32OLE</span><span class="ruby-operator">::</span><span class="ruby-constant">CP_OEMCP</span>)
76:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001973" class="method">
  <div id="M001973_title" class="title">
    <b>test_const_CP_SYMBOL</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001973_source')" id="l_M001973_source">show source</a> ]</p>
  <div id="M001973_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File ruby-1.8.7-p22/ext/win32ole/tests/testWIN32OLE.rb, line 86</span>
86:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_const_CP_SYMBOL</span>
87:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value">42</span>, <span class="ruby-constant">WIN32OLE</span><span class="ruby-operator">::</span><span class="ruby-constant">CP_SYMBOL</span>)
88:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001972" class="method">
  <div id="M001972_title" class="title">
    <b>test_const_CP_THREAD_ACP</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001972_source')" id="l_M001972_source">show source</a> ]</p>
  <div id="M001972_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File ruby-1.8.7-p22/ext/win32ole/tests/testWIN32OLE.rb, line 82</span>
82:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_const_CP_THREAD_ACP</span>
83:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value">3</span>, <span class="ruby-constant">WIN32OLE</span><span class="ruby-operator">::</span><span class="ruby-constant">CP_THREAD_ACP</span>)
84:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001974" class="method">
  <div id="M001974_title" class="title">
    <b>test_const_CP_UTF7</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001974_source')" id="l_M001974_source">show source</a> ]</p>
  <div id="M001974_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File ruby-1.8.7-p22/ext/win32ole/tests/testWIN32OLE.rb, line 90</span>
90:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_const_CP_UTF7</span>
91:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value">65000</span>, <span class="ruby-constant">WIN32OLE</span><span class="ruby-operator">::</span><span class="ruby-constant">CP_UTF7</span>)
92:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001975" class="method">
  <div id="M001975_title" class="title">
    <b>test_const_CP_UTF8</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001975_source')" id="l_M001975_source">show source</a> ]</p>
  <div id="M001975_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File ruby-1.8.7-p22/ext/win32ole/tests/testWIN32OLE.rb, line 94</span>
94:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_const_CP_UTF8</span>
95:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value">65001</span>, <span class="ruby-constant">WIN32OLE</span><span class="ruby-operator">::</span><span class="ruby-constant">CP_UTF8</span>)
96:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001980" class="method">
  <div id="M001980_title" class="title">
    <b>test_convert_bignum</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001980_source')" id="l_M001980_source">show source</a> ]</p>
  <div id="M001980_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/ext/win32ole/tests/testWIN32OLE.rb, line 150</span>
150:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_convert_bignum</span>
151:     <span class="ruby-identifier">book</span> = <span class="ruby-ivar">@excel</span>.<span class="ruby-identifier">workbooks</span>.<span class="ruby-identifier">add</span>
152:     <span class="ruby-identifier">sheet</span> = <span class="ruby-identifier">book</span>.<span class="ruby-identifier">worksheets</span>(<span class="ruby-value">1</span>)
153:     <span class="ruby-keyword kw">begin</span>
154:       <span class="ruby-identifier">sheet</span>.<span class="ruby-identifier">range</span>(<span class="ruby-value str">&quot;A1&quot;</span>).<span class="ruby-identifier">value</span> = <span class="ruby-value">999999999</span>
155:       <span class="ruby-identifier">sheet</span>.<span class="ruby-identifier">range</span>(<span class="ruby-value str">&quot;A2&quot;</span>).<span class="ruby-identifier">value</span> = <span class="ruby-value">9999999999</span>
156:       <span class="ruby-identifier">sheet</span>.<span class="ruby-identifier">range</span>(<span class="ruby-value str">&quot;A3&quot;</span>).<span class="ruby-identifier">value</span> = <span class="ruby-value str">&quot;=A1*10 + 9&quot;</span>
157:       <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value">9999999999</span>, <span class="ruby-identifier">sheet</span>.<span class="ruby-identifier">range</span>(<span class="ruby-value str">&quot;A2&quot;</span>).<span class="ruby-identifier">value</span>)
158:       <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value">9999999999</span>, <span class="ruby-identifier">sheet</span>.<span class="ruby-identifier">range</span>(<span class="ruby-value str">&quot;A3&quot;</span>).<span class="ruby-identifier">value</span>)
159:      
160:     <span class="ruby-keyword kw">ensure</span>
161:       <span class="ruby-identifier">book</span>.<span class="ruby-identifier">saved</span> = <span class="ruby-keyword kw">true</span>
162:     <span class="ruby-keyword kw">end</span>
163:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001978" class="method">
  <div id="M001978_title" class="title">
    <b>test_each</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001978_source')" id="l_M001978_source">show source</a> ]</p>
  <div id="M001978_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/ext/win32ole/tests/testWIN32OLE.rb, line 118</span>
118:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_each</span>
119:     <span class="ruby-identifier">workbooks</span> = <span class="ruby-ivar">@excel</span>.<span class="ruby-constant">Workbooks</span>
120:     <span class="ruby-identifier">assert_no_exception</span> {
121:       <span class="ruby-identifier">i</span> = <span class="ruby-value">0</span>;
122:       <span class="ruby-identifier">workbooks</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">workbook</span><span class="ruby-operator">|</span>
123:         <span class="ruby-identifier">print</span> <span class="ruby-identifier">i</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
124:       <span class="ruby-keyword kw">end</span>
125:     }
126:     <span class="ruby-identifier">workbooks</span>.<span class="ruby-identifier">add</span>
127:     <span class="ruby-identifier">workbooks</span>.<span class="ruby-identifier">add</span>
128:     <span class="ruby-identifier">i</span> = <span class="ruby-value">0</span>
129:     <span class="ruby-identifier">workbooks</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">workbook</span><span class="ruby-operator">|</span>
130:       <span class="ruby-identifier">i</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>
131:     <span class="ruby-keyword kw">end</span>
132:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value">2</span>, <span class="ruby-identifier">i</span>)
133:     <span class="ruby-identifier">workbooks</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">workbook</span><span class="ruby-operator">|</span>
134:       <span class="ruby-identifier">workbook</span>.<span class="ruby-identifier">saved</span> = <span class="ruby-keyword kw">true</span>
135:     <span class="ruby-keyword kw">end</span>
136:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001977" class="method">
  <div id="M001977_title" class="title">
    <b>test_get_win32ole_object</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001977_source')" id="l_M001977_source">show source</a> ]</p>
  <div id="M001977_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/ext/win32ole/tests/testWIN32OLE.rb, line 114</span>
114:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_get_win32ole_object</span>
115:     <span class="ruby-identifier">workbooks</span> = <span class="ruby-ivar">@excel</span>.<span class="ruby-constant">Workbooks</span>;
116:     <span class="ruby-identifier">assert_instance_of</span>(<span class="ruby-constant">WIN32OLE</span>, <span class="ruby-identifier">workbooks</span>)
117:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001986" class="method">
  <div id="M001986_title" class="title">
    <b>test_invoke</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001986_source')" id="l_M001986_source">show source</a> ]</p>
  <div id="M001986_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/ext/win32ole/tests/testWIN32OLE.rb, line 236</span>
236:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_invoke</span>
237:     <span class="ruby-identifier">workbooks</span> = <span class="ruby-ivar">@excel</span>.<span class="ruby-identifier">invoke</span>( <span class="ruby-value str">'workbooks'</span> )
238:     <span class="ruby-identifier">assert_instance_of</span>(<span class="ruby-constant">WIN32OLE</span>, <span class="ruby-identifier">workbooks</span>)
239:     <span class="ruby-identifier">book</span> = <span class="ruby-identifier">workbooks</span>.<span class="ruby-identifier">invoke</span>( <span class="ruby-value str">'add'</span> )
240:     <span class="ruby-identifier">assert_instance_of</span>(<span class="ruby-constant">WIN32OLE</span>, <span class="ruby-identifier">book</span>)
241:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001984" class="method">
  <div id="M001984_title" class="title">
    <b>test_no_exist_property</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001984_source')" id="l_M001984_source">show source</a> ]</p>
  <div id="M001984_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/ext/win32ole/tests/testWIN32OLE.rb, line 205</span>
205:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_no_exist_property</span>
206:     <span class="ruby-identifier">isok</span> = <span class="ruby-keyword kw">false</span>
207:     <span class="ruby-keyword kw">begin</span>
208:       <span class="ruby-ivar">@excel</span>.<span class="ruby-identifier">unknown_prop</span> = <span class="ruby-value">1</span>
209:     <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">WIN32OLERuntimeError</span>
210:       <span class="ruby-identifier">isok</span> = <span class="ruby-keyword kw">true</span>
211:     <span class="ruby-keyword kw">end</span>
212:     <span class="ruby-identifier">assert</span>(<span class="ruby-identifier">isok</span>)
213: 
214:     <span class="ruby-identifier">isok</span> = <span class="ruby-keyword kw">false</span>
215:     <span class="ruby-keyword kw">begin</span>
216:       <span class="ruby-ivar">@excel</span>[<span class="ruby-value str">'unknown_prop'</span>] = <span class="ruby-value">2</span>
217:     <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">WIN32OLERuntimeError</span>
218:       <span class="ruby-identifier">isok</span> = <span class="ruby-keyword kw">true</span>
219:     <span class="ruby-keyword kw">end</span>
220:     <span class="ruby-identifier">assert</span>(<span class="ruby-identifier">isok</span>)
221:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001988" class="method">
  <div id="M001988_title" class="title">
    <b>test_ole_func_methods</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001988_source')" id="l_M001988_source">show source</a> ]</p>
  <div id="M001988_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/ext/win32ole/tests/testWIN32OLE.rb, line 247</span>
247:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_ole_func_methods</span>
248:     <span class="ruby-identifier">methods</span> = <span class="ruby-ivar">@excel</span>.<span class="ruby-identifier">ole_func_methods</span>
249:     <span class="ruby-identifier">assert</span>(<span class="ruby-identifier">methods</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>)
250:     <span class="ruby-identifier">method_names</span> = <span class="ruby-identifier">methods</span>.<span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">m</span><span class="ruby-operator">|</span> <span class="ruby-identifier">m</span>.<span class="ruby-identifier">name</span>}
251:     <span class="ruby-identifier">assert</span>(<span class="ruby-identifier">method_names</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-value str">&quot;Quit&quot;</span>))
252:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001990" class="method">
  <div id="M001990_title" class="title">
    <b>test_ole_get_methods</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001990_source')" id="l_M001990_source">show source</a> ]</p>
  <div id="M001990_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/ext/win32ole/tests/testWIN32OLE.rb, line 259</span>
259:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_ole_get_methods</span>
260:     <span class="ruby-identifier">methods</span> = <span class="ruby-ivar">@excel</span>.<span class="ruby-identifier">ole_get_methods</span>
261:     <span class="ruby-identifier">assert</span>(<span class="ruby-identifier">methods</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>)
262:     <span class="ruby-identifier">method_names</span> = <span class="ruby-identifier">methods</span>.<span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">m</span><span class="ruby-operator">|</span> <span class="ruby-identifier">m</span>.<span class="ruby-identifier">name</span>}
263:     <span class="ruby-identifier">assert</span>(<span class="ruby-identifier">method_names</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-value str">&quot;Visible&quot;</span>))
264:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001981" class="method">
  <div id="M001981_title" class="title">
    <b>test_ole_invoke_with_named_arg</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001981_source')" id="l_M001981_source">show source</a> ]</p>
  <div id="M001981_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/ext/win32ole/tests/testWIN32OLE.rb, line 165</span>
165:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_ole_invoke_with_named_arg</span>
166:     <span class="ruby-identifier">book</span> = <span class="ruby-ivar">@excel</span>.<span class="ruby-identifier">workbooks</span>.<span class="ruby-identifier">add</span>
167:     <span class="ruby-identifier">sheets</span> = <span class="ruby-identifier">book</span>.<span class="ruby-identifier">worksheets</span>
168:     <span class="ruby-identifier">sheet</span> = <span class="ruby-identifier">book</span>.<span class="ruby-identifier">worksheets</span>(<span class="ruby-value">1</span>)
169:     <span class="ruby-identifier">num</span> = <span class="ruby-identifier">sheets</span>.<span class="ruby-identifier">count</span>
170:     <span class="ruby-keyword kw">begin</span>
171:       <span class="ruby-identifier">sheets</span>.<span class="ruby-identifier">add</span>({<span class="ruby-value str">'count'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">2</span>, <span class="ruby-value str">'after'</span>=<span class="ruby-operator">&gt;</span><span class="ruby-identifier">sheet</span>})
172:       <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value">2</span>, <span class="ruby-identifier">sheets</span>.<span class="ruby-identifier">count</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">num</span>);
173:     <span class="ruby-keyword kw">ensure</span>
174:       <span class="ruby-identifier">book</span>.<span class="ruby-identifier">saved</span> = <span class="ruby-keyword kw">true</span>
175:     <span class="ruby-keyword kw">end</span>
176:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001982" class="method">
  <div id="M001982_title" class="title">
    <b>test_ole_invoke_with_named_arg_last</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001982_source')" id="l_M001982_source">show source</a> ]</p>
  <div id="M001982_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/ext/win32ole/tests/testWIN32OLE.rb, line 178</span>
178:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_ole_invoke_with_named_arg_last</span>
179:     <span class="ruby-identifier">book</span> = <span class="ruby-ivar">@excel</span>.<span class="ruby-identifier">workbooks</span>.<span class="ruby-identifier">add</span>
180:     <span class="ruby-identifier">sheets</span> = <span class="ruby-identifier">book</span>.<span class="ruby-identifier">worksheets</span>
181:     <span class="ruby-identifier">sheet</span> = <span class="ruby-identifier">book</span>.<span class="ruby-identifier">worksheets</span>(<span class="ruby-value">1</span>)
182:     <span class="ruby-identifier">num</span> = <span class="ruby-identifier">sheets</span>.<span class="ruby-identifier">count</span>
183:     <span class="ruby-keyword kw">begin</span>
184:       <span class="ruby-identifier">sheets</span>.<span class="ruby-identifier">add</span>(<span class="ruby-identifier">sheet</span>, {<span class="ruby-value str">'count'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">2</span>})
185:       <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value">2</span>, <span class="ruby-identifier">sheets</span>.<span class="ruby-identifier">count</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">num</span>);
186:     <span class="ruby-keyword kw">ensure</span>
187:       <span class="ruby-identifier">book</span>.<span class="ruby-identifier">saved</span> = <span class="ruby-keyword kw">true</span>
188:     <span class="ruby-keyword kw">end</span>
189:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001991" class="method">
  <div id="M001991_title" class="title">
    <b>test_ole_method_help</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001991_source')" id="l_M001991_source">show source</a> ]</p>
  <div id="M001991_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/ext/win32ole/tests/testWIN32OLE.rb, line 265</span>
265:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_ole_method_help</span>
266:     <span class="ruby-identifier">quit_info</span> = <span class="ruby-ivar">@excel</span>.<span class="ruby-identifier">ole_method_help</span>(<span class="ruby-value str">&quot;Quit&quot;</span>)
267:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value">0</span>, <span class="ruby-identifier">quit_info</span>.<span class="ruby-identifier">size_params</span>)
268:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value">0</span>, <span class="ruby-identifier">quit_info</span>.<span class="ruby-identifier">size_opt_params</span>)
269: 
270:     <span class="ruby-identifier">workbooks</span> = <span class="ruby-ivar">@excel</span>.<span class="ruby-constant">Workbooks</span>
271:     <span class="ruby-identifier">add_info</span> = <span class="ruby-identifier">workbooks</span>.<span class="ruby-identifier">ole_method_help</span>(<span class="ruby-value str">&quot;Add&quot;</span>)
272:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value">1</span>, <span class="ruby-identifier">add_info</span>.<span class="ruby-identifier">size_params</span>)
273:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value">1</span>, <span class="ruby-identifier">add_info</span>.<span class="ruby-identifier">size_opt_params</span>)
274:     <span class="ruby-identifier">assert</span>(<span class="ruby-identifier">add_info</span>.<span class="ruby-identifier">params</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">input?</span>)
275:     <span class="ruby-identifier">assert</span>(<span class="ruby-identifier">add_info</span>.<span class="ruby-identifier">params</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">optional?</span>)
276:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">'VARIANT'</span>, <span class="ruby-identifier">add_info</span>.<span class="ruby-identifier">params</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">ole_type</span>)
277:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001987" class="method">
  <div id="M001987_title" class="title">
    <b>test_ole_methods</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001987_source')" id="l_M001987_source">show source</a> ]</p>
  <div id="M001987_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/ext/win32ole/tests/testWIN32OLE.rb, line 242</span>
242:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_ole_methods</span>
243:     <span class="ruby-identifier">methods</span> = <span class="ruby-ivar">@excel</span>.<span class="ruby-identifier">ole_methods</span>
244:     <span class="ruby-identifier">method_names</span> = <span class="ruby-identifier">methods</span>.<span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">m</span><span class="ruby-operator">|</span> <span class="ruby-identifier">m</span>.<span class="ruby-identifier">name</span>}
245:     <span class="ruby-identifier">assert</span>(<span class="ruby-identifier">method_names</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-value str">&quot;Quit&quot;</span>))
246:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001989" class="method">
  <div id="M001989_title" class="title">
    <b>test_ole_put_methods</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001989_source')" id="l_M001989_source">show source</a> ]</p>
  <div id="M001989_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/ext/win32ole/tests/testWIN32OLE.rb, line 253</span>
253:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_ole_put_methods</span>
254:     <span class="ruby-identifier">methods</span> = <span class="ruby-ivar">@excel</span>.<span class="ruby-identifier">ole_put_methods</span>
255:     <span class="ruby-identifier">assert</span>(<span class="ruby-identifier">methods</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>)
256:     <span class="ruby-identifier">method_names</span> = <span class="ruby-identifier">methods</span>.<span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">m</span><span class="ruby-operator">|</span> <span class="ruby-identifier">m</span>.<span class="ruby-identifier">name</span>}
257:     <span class="ruby-identifier">assert</span>(<span class="ruby-identifier">method_names</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-value str">&quot;Visible&quot;</span>))
258:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001967" class="method">
  <div id="M001967_title" class="title">
    <b>test_s_codepage</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001967_source')" id="l_M001967_source">show source</a> ]</p>
  <div id="M001967_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File ruby-1.8.7-p22/ext/win32ole/tests/testWIN32OLE.rb, line 60</span>
60:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_s_codepage</span>
61:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-constant">WIN32OLE</span><span class="ruby-operator">::</span><span class="ruby-constant">CP_ACP</span>, <span class="ruby-constant">WIN32OLE</span>.<span class="ruby-identifier">codepage</span>)
62:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001976" class="method">
  <div id="M001976_title" class="title">
    <b>test_s_codepage_changed</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001976_source')" id="l_M001976_source">show source</a> ]</p>
  <div id="M001976_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/ext/win32ole/tests/testWIN32OLE.rb, line 98</span>
 98:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_s_codepage_changed</span>
 99:     <span class="ruby-identifier">book</span> = <span class="ruby-ivar">@excel</span>.<span class="ruby-identifier">workbooks</span>.<span class="ruby-identifier">add</span>
100:     <span class="ruby-identifier">sheet</span> = <span class="ruby-identifier">book</span>.<span class="ruby-identifier">worksheets</span>(<span class="ruby-value">1</span>)
101:     <span class="ruby-keyword kw">begin</span>
102:       <span class="ruby-constant">WIN32OLE</span>.<span class="ruby-identifier">codepage</span> = <span class="ruby-constant">WIN32OLE</span><span class="ruby-operator">::</span><span class="ruby-constant">CP_UTF8</span>
103:       <span class="ruby-identifier">sheet</span>.<span class="ruby-identifier">range</span>(<span class="ruby-value str">&quot;A1&quot;</span>).<span class="ruby-identifier">value</span> = [<span class="ruby-value">0x3042</span>].<span class="ruby-identifier">pack</span>(<span class="ruby-value str">&quot;U*&quot;</span>)
104:       <span class="ruby-identifier">val</span> = <span class="ruby-identifier">sheet</span>.<span class="ruby-identifier">range</span>(<span class="ruby-value str">&quot;A1&quot;</span>).<span class="ruby-identifier">value</span>
105:       <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;\343\201\202&quot;</span>, <span class="ruby-identifier">val</span>)
106:       <span class="ruby-constant">WIN32OLE</span>.<span class="ruby-identifier">codepage</span> = <span class="ruby-constant">WIN32OLE</span><span class="ruby-operator">::</span><span class="ruby-constant">CP_ACP</span>
107:       <span class="ruby-identifier">val</span> = <span class="ruby-identifier">sheet</span>.<span class="ruby-identifier">range</span>(<span class="ruby-value str">&quot;A1&quot;</span>).<span class="ruby-identifier">value</span>
108:       <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">&quot;\202\240&quot;</span>, <span class="ruby-identifier">val</span>)
109:     <span class="ruby-keyword kw">ensure</span>
110:       <span class="ruby-identifier">book</span>.<span class="ruby-identifier">saved</span> = <span class="ruby-keyword kw">true</span>
111:     <span class="ruby-keyword kw">end</span>
112:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001968" class="method">
  <div id="M001968_title" class="title">
    <b>test_s_codepage_set</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001968_source')" id="l_M001968_source">show source</a> ]</p>
  <div id="M001968_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File ruby-1.8.7-p22/ext/win32ole/tests/testWIN32OLE.rb, line 64</span>
64:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_s_codepage_set</span>
65:     <span class="ruby-constant">WIN32OLE</span>.<span class="ruby-identifier">codepage</span> = <span class="ruby-constant">WIN32OLE</span><span class="ruby-operator">::</span><span class="ruby-constant">CP_UTF8</span>
66:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-constant">WIN32OLE</span><span class="ruby-operator">::</span><span class="ruby-constant">CP_UTF8</span>, <span class="ruby-constant">WIN32OLE</span>.<span class="ruby-identifier">codepage</span>)
67:     <span class="ruby-constant">WIN32OLE</span>.<span class="ruby-identifier">codepage</span> = <span class="ruby-constant">WIN32OLE</span><span class="ruby-operator">::</span><span class="ruby-constant">CP_ACP</span>
68:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001965" class="method">
  <div id="M001965_title" class="title">
    <b>test_s_connect</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001965_source')" id="l_M001965_source">show source</a> ]</p>
  <div id="M001965_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File ruby-1.8.7-p22/ext/win32ole/tests/testWIN32OLE.rb, line 45</span>
45:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_s_connect</span>
46:     <span class="ruby-identifier">excel2</span> = <span class="ruby-constant">WIN32OLE</span>.<span class="ruby-identifier">connect</span>(<span class="ruby-value str">'Excel.Application'</span>)
47:     <span class="ruby-identifier">assert_instance_of</span>(<span class="ruby-constant">WIN32OLE</span>, <span class="ruby-identifier">excel2</span>)
48:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001966" class="method">
  <div id="M001966_title" class="title">
    <b>test_s_const_load</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001966_source')" id="l_M001966_source">show source</a> ]</p>
  <div id="M001966_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File ruby-1.8.7-p22/ext/win32ole/tests/testWIN32OLE.rb, line 50</span>
50:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_s_const_load</span>
51:     <span class="ruby-identifier">assert</span>(<span class="ruby-operator">!</span><span class="ruby-keyword kw">defined?</span>(<span class="ruby-constant">EXCEL_CONST</span><span class="ruby-operator">::</span><span class="ruby-constant">XlTop</span>))
52:     <span class="ruby-constant">WIN32OLE</span>.<span class="ruby-identifier">const_load</span>(<span class="ruby-ivar">@excel</span>, <span class="ruby-constant">EXCEL_CONST</span>)
53:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value">-4160</span>, <span class="ruby-constant">EXCEL_CONST</span><span class="ruby-operator">::</span><span class="ruby-constant">XlTop</span>)
54: 
55:     <span class="ruby-identifier">assert</span>(<span class="ruby-operator">!</span><span class="ruby-keyword kw">defined?</span>(<span class="ruby-constant">CONST1</span><span class="ruby-operator">::</span><span class="ruby-constant">XlTop</span>))
56:     <span class="ruby-constant">WIN32OLE</span>.<span class="ruby-identifier">const_load</span>(<span class="ruby-constant">MS_EXCEL_TYPELIB</span>, <span class="ruby-constant">CONST1</span>)
57:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value">-4160</span>, <span class="ruby-constant">CONST1</span><span class="ruby-operator">::</span><span class="ruby-constant">XlTop</span>)
58:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001962" class="method">
  <div id="M001962_title" class="title">
    <b>test_s_new</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001962_source')" id="l_M001962_source">show source</a> ]</p>
  <div id="M001962_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File ruby-1.8.7-p22/ext/win32ole/tests/testWIN32OLE.rb, line 27</span>
27:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_s_new</span>
28:     <span class="ruby-identifier">assert_instance_of</span>(<span class="ruby-constant">WIN32OLE</span>, <span class="ruby-ivar">@excel</span>)
29:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001963" class="method">
  <div id="M001963_title" class="title">
    <b>test_s_new_DCOM</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001963_source')" id="l_M001963_source">show source</a> ]</p>
  <div id="M001963_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File ruby-1.8.7-p22/ext/win32ole/tests/testWIN32OLE.rb, line 30</span>
30:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_s_new_DCOM</span>
31:     <span class="ruby-identifier">rexcel</span> = <span class="ruby-constant">WIN32OLE</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;Excel.Application&quot;</span>, <span class="ruby-value str">&quot;localhost&quot;</span>)
32:     <span class="ruby-identifier">assert_instance_of</span>(<span class="ruby-constant">WIN32OLE</span>, <span class="ruby-identifier">rexcel</span>)
33:     <span class="ruby-identifier">rexcel</span>.<span class="ruby-identifier">visible</span> = <span class="ruby-keyword kw">true</span>
34:     <span class="ruby-identifier">rexcel</span>.<span class="ruby-identifier">quit</span>
35:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001964" class="method">
  <div id="M001964_title" class="title">
    <b>test_s_new_from_clsid</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001964_source')" id="l_M001964_source">show source</a> ]</p>
  <div id="M001964_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File ruby-1.8.7-p22/ext/win32ole/tests/testWIN32OLE.rb, line 36</span>
36:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_s_new_from_clsid</span>
37:     <span class="ruby-identifier">excel</span> = <span class="ruby-constant">WIN32OLE</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;{00024500-0000-0000-C000-000000000046}&quot;</span>)
38:     <span class="ruby-identifier">assert_instance_of</span>(<span class="ruby-constant">WIN32OLE</span>, <span class="ruby-identifier">excel</span>)
39:     <span class="ruby-identifier">excel</span>.<span class="ruby-identifier">quit</span>
40:     <span class="ruby-identifier">exc</span> = <span class="ruby-identifier">assert_exception</span>(<span class="ruby-constant">WIN32OLERuntimeError</span>) {
41:       <span class="ruby-constant">WIN32OLE</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;{000}&quot;</span>)
42:     }
43:     <span class="ruby-identifier">assert_match</span>(<span class="ruby-regexp re">/unknown OLE server: `\{000\}'/</span>, <span class="ruby-identifier">exc</span>.<span class="ruby-identifier">message</span>)
44:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001983" class="method">
  <div id="M001983_title" class="title">
    <b>test_setproperty</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001983_source')" id="l_M001983_source">show source</a> ]</p>
  <div id="M001983_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/ext/win32ole/tests/testWIN32OLE.rb, line 191</span>
191:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_setproperty</span>
192:     <span class="ruby-ivar">@excel</span>.<span class="ruby-identifier">setproperty</span>(<span class="ruby-value str">'Visible'</span>, <span class="ruby-keyword kw">false</span>)
193:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-keyword kw">false</span>, <span class="ruby-ivar">@excel</span>.<span class="ruby-constant">Visible</span>)
194:     <span class="ruby-ivar">@excel</span>.<span class="ruby-identifier">setproperty</span>(<span class="ruby-value str">'Visible'</span>, <span class="ruby-keyword kw">true</span>)
195:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-keyword kw">true</span>, <span class="ruby-ivar">@excel</span>.<span class="ruby-constant">Visible</span>)
196:     <span class="ruby-identifier">book</span> = <span class="ruby-ivar">@excel</span>.<span class="ruby-identifier">workbooks</span>.<span class="ruby-identifier">add</span>
197:     <span class="ruby-identifier">sheet</span> = <span class="ruby-identifier">book</span>.<span class="ruby-identifier">worksheets</span>(<span class="ruby-value">1</span>)
198:     <span class="ruby-keyword kw">begin</span>
199:       <span class="ruby-identifier">sheet</span>.<span class="ruby-identifier">setproperty</span>(<span class="ruby-value str">'Cells'</span>, <span class="ruby-value">1</span>, <span class="ruby-value">2</span>, <span class="ruby-value">10</span>)
200:       <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value">10</span>, <span class="ruby-identifier">sheet</span>.<span class="ruby-identifier">range</span>(<span class="ruby-value str">&quot;B1&quot;</span>).<span class="ruby-identifier">value</span>)
201:     <span class="ruby-keyword kw">ensure</span>
202:       <span class="ruby-identifier">book</span>.<span class="ruby-identifier">saved</span> = <span class="ruby-keyword kw">true</span>
203:     <span class="ruby-keyword kw">end</span>
204:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001979" class="method">
  <div id="M001979_title" class="title">
    <b>test_setproperty_bracket</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001979_source')" id="l_M001979_source">show source</a> ]</p>
  <div id="M001979_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/ext/win32ole/tests/testWIN32OLE.rb, line 137</span>
137:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_setproperty_bracket</span>
138:     <span class="ruby-identifier">book</span> = <span class="ruby-ivar">@excel</span>.<span class="ruby-identifier">workbooks</span>.<span class="ruby-identifier">add</span>
139:     <span class="ruby-identifier">sheet</span> = <span class="ruby-identifier">book</span>.<span class="ruby-identifier">worksheets</span>(<span class="ruby-value">1</span>)
140:     <span class="ruby-keyword kw">begin</span>
141:       <span class="ruby-identifier">sheet</span>.<span class="ruby-identifier">range</span>(<span class="ruby-value str">&quot;A1&quot;</span>)[<span class="ruby-value str">'Value'</span>] = <span class="ruby-value">10</span>
142:       <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value">10</span>, <span class="ruby-identifier">sheet</span>.<span class="ruby-identifier">range</span>(<span class="ruby-value str">&quot;A1&quot;</span>).<span class="ruby-identifier">value</span>)
143:       <span class="ruby-identifier">sheet</span>[<span class="ruby-value str">'Cells'</span>, <span class="ruby-value">1</span>, <span class="ruby-value">2</span>] = <span class="ruby-value">10</span>
144:       <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value">10</span>, <span class="ruby-identifier">sheet</span>.<span class="ruby-identifier">range</span>(<span class="ruby-value str">&quot;B1&quot;</span>).<span class="ruby-identifier">value</span>)
145:       <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value">10</span>, <span class="ruby-identifier">sheet</span>[<span class="ruby-value str">'Cells'</span>, <span class="ruby-value">1</span>, <span class="ruby-value">2</span>].<span class="ruby-identifier">value</span>)
146:     <span class="ruby-keyword kw">ensure</span>
147:       <span class="ruby-identifier">book</span>.<span class="ruby-identifier">saved</span> = <span class="ruby-keyword kw">true</span>
148:     <span class="ruby-keyword kw">end</span>
149:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001985" class="method">
  <div id="M001985_title" class="title">
    <b>test_setproperty_with_equal</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001985_source')" id="l_M001985_source">show source</a> ]</p>
  <div id="M001985_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/ext/win32ole/tests/testWIN32OLE.rb, line 223</span>
223:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_setproperty_with_equal</span>
224:     <span class="ruby-identifier">book</span> = <span class="ruby-ivar">@excel</span>.<span class="ruby-identifier">workbooks</span>.<span class="ruby-identifier">add</span>
225:     <span class="ruby-identifier">sheet</span> = <span class="ruby-identifier">book</span>.<span class="ruby-identifier">worksheets</span>(<span class="ruby-value">1</span>)
226:     <span class="ruby-keyword kw">begin</span>
227:       <span class="ruby-identifier">sheet</span>.<span class="ruby-identifier">range</span>(<span class="ruby-value str">&quot;B1&quot;</span>).<span class="ruby-identifier">value</span> = <span class="ruby-value">10</span>
228:       <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value">10</span>, <span class="ruby-identifier">sheet</span>.<span class="ruby-identifier">range</span>(<span class="ruby-value str">&quot;B1&quot;</span>).<span class="ruby-identifier">value</span>)
229:       <span class="ruby-identifier">sheet</span>.<span class="ruby-identifier">range</span>(<span class="ruby-value str">&quot;C1:D1&quot;</span>).<span class="ruby-identifier">value</span> = [<span class="ruby-value">11</span>, <span class="ruby-value">12</span>]
230:       <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value">11</span>, <span class="ruby-identifier">sheet</span>.<span class="ruby-identifier">range</span>(<span class="ruby-value str">&quot;C1&quot;</span>).<span class="ruby-identifier">value</span>)
231:       <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value">12</span>, <span class="ruby-identifier">sheet</span>.<span class="ruby-identifier">range</span>(<span class="ruby-value str">&quot;D1&quot;</span>).<span class="ruby-identifier">value</span>)
232:     <span class="ruby-keyword kw">ensure</span>
233:       <span class="ruby-identifier">book</span>.<span class="ruby-identifier">saved</span> = <span class="ruby-keyword kw">true</span>
234:     <span class="ruby-keyword kw">end</span>
235:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
</div>

  </div>