  <div id="C00001109">
<div class='banner'>
  <span class="file-title-prefix">Class</span><br />Source<br/>
  In:
<a href="#" onclick="jsHref('files/ruby-1_8_7-p22/lib/rexml/source_rb.html');">ruby-1.8.7-p22/lib/rexml/source.rb</a>

Parent:&nbsp;
        <a href="#" onclick="jsHref('classes/YAML/Object.html');">
Object
         </a>
</div>
 <!-- banner header -->

  <div id="bodyContent" >
      <div id="content">

  <div class="description"><p>
A <a href="index.html?a=C00001109&name=Source">Source</a> can be searched
for patterns, and wraps buffers and other objects and provides consumption
of text
</p>
</div>



  <div class="sectiontitle">Methods</div>
  <ul>
  <li><a href="index.html?a=M005744&name=consume" >consume</a></li>
  <li><a href="index.html?a=M005750&name=current_line" >current_line</a></li>
  <li><a href="index.html?a=M005748&name=empty?" >empty?</a></li>
  <li><a href="index.html?a=M005741&name=encoding=" >encoding=</a></li>
  <li><a href="index.html?a=M005747&name=match" >match</a></li>
  <li><a href="index.html?a=M005745&name=match_to" >match_to</a></li>
  <li><a href="index.html?a=M005746&name=match_to_consume" >match_to_consume</a></li>
  <li><a href="index.html?a=M005740&name=new" >new</a></li>
  <li><a href="index.html?a=M005749&name=position" >position</a></li>
  <li><a href="index.html?a=M005743&name=read" >read</a></li>
  <li><a href="index.html?a=M005742&name=scan" >scan</a></li>
  </ul>

<div class="sectiontitle">Included Modules</div>
<ul>
  <li><a href="#" onclick="jsHref('classes/REXML/Encoding.html');">Encoding</a></li>
</ul>




  <div class="sectiontitle">Attributes</div>
  <table border='0' cellpadding='5'>
  <tr valign='top'>
    <td class='attr-rw'>
[R]
    </td>
    <td class='attr-name'>buffer</td>
    <td class='attr-desc'>
The current buffer (what we&#8217;re going to read next)

</td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[R]
    </td>
    <td class='attr-name'>encoding</td>
    <td class='attr-desc'></td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[R]
    </td>
    <td class='attr-name'>line</td>
    <td class='attr-desc'>
The line number of the last consumed text

</td>
  </tr>
  </table>

<div class="sectiontitle">Public Class methods</div>
<div id="M005740" class="method">
  <div id="M005740_title" class="title">
    <b>new</b>(arg, encoding=nil)
  </div>
  <div class="description">
  <p>
Constructor @param arg must be a <a
href="index.html?a=C00000055&name=String">String</a>, and should be a valid
<a href="index.html?a=C00000959&name=XML">XML</a> document @param encoding
if non-null, sets the encoding of the source to this value, overriding all
encoding detection
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005740_source')" id="l_M005740_source">show source</a> ]</p>
  <div id="M005740_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/rexml/source.rb, line 40</span>
40:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">arg</span>, <span class="ruby-identifier">encoding</span>=<span class="ruby-keyword kw">nil</span>)
41:       <span class="ruby-ivar">@orig</span> = <span class="ruby-ivar">@buffer</span> = <span class="ruby-identifier">arg</span>
42:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">encoding</span>
43:         <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">encoding</span> = <span class="ruby-identifier">encoding</span>
44:       <span class="ruby-keyword kw">else</span>
45:         <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">encoding</span> = <span class="ruby-identifier">check_encoding</span>( <span class="ruby-ivar">@buffer</span> )
46:       <span class="ruby-keyword kw">end</span>
47:       <span class="ruby-ivar">@line</span> = <span class="ruby-value">0</span>
48:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div class="sectiontitle">Public Instance methods</div>
<div id="M005744" class="method">
  <div id="M005744_title" class="title">
    <b>consume</b>( pattern )
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005744_source')" id="l_M005744_source">show source</a> ]</p>
  <div id="M005744_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/rexml/source.rb, line 90</span>
90:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">consume</span>( <span class="ruby-identifier">pattern</span> )
91:       <span class="ruby-ivar">@buffer</span> = <span class="ruby-identifier">$'</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">pattern</span>.<span class="ruby-identifier">match</span>( <span class="ruby-ivar">@buffer</span> )
92:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005750" class="method">
  <div id="M005750_title" class="title">
    <b>current_line</b>()
  </div>
  <div class="description">
  <p>
@return the current line in the source
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005750_source')" id="l_M005750_source">show source</a> ]</p>
  <div id="M005750_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/rexml/source.rb, line 120</span>
120:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">current_line</span>
121:       <span class="ruby-identifier">lines</span> = <span class="ruby-ivar">@orig</span>.<span class="ruby-identifier">split</span>
122:       <span class="ruby-identifier">res</span> = <span class="ruby-identifier">lines</span>.<span class="ruby-identifier">grep</span> <span class="ruby-ivar">@buffer</span>[<span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-value">30</span>]
123:       <span class="ruby-identifier">res</span> = <span class="ruby-identifier">res</span>[<span class="ruby-value">-1</span>] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">res</span>.<span class="ruby-identifier">kind_of?</span> <span class="ruby-constant">Array</span>
124:       <span class="ruby-identifier">lines</span>.<span class="ruby-identifier">index</span>( <span class="ruby-identifier">res</span> ) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">res</span>
125:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005748" class="method">
  <div id="M005748_title" class="title">
    <b>empty?</b>()
  </div>
  <div class="description">
  <p>
@return true if the <a href="index.html?a=C00001109&name=Source">Source</a>
is exhausted
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005748_source')" id="l_M005748_source">show source</a> ]</p>
  <div id="M005748_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/rexml/source.rb, line 111</span>
111:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">empty?</span>
112:       <span class="ruby-ivar">@buffer</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
113:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005741" class="method">
  <div id="M005741_title" class="title">
    <b>encoding=</b>(enc)
  </div>
  <div class="description">
  <p>
Inherited from <a href="index.html?a=C00001082&name=Encoding">Encoding</a>
Overridden to support optimized en/decoding
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005741_source')" id="l_M005741_source">show source</a> ]</p>
  <div id="M005741_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/rexml/source.rb, line 53</span>
53:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">encoding=</span>(<span class="ruby-identifier">enc</span>)
54:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-keyword kw">super</span>
55:       <span class="ruby-ivar">@line_break</span> = <span class="ruby-identifier">encode</span>( <span class="ruby-value str">'&gt;'</span> )
56:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">enc</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">UTF_8</span>
57:         <span class="ruby-ivar">@buffer</span> = <span class="ruby-identifier">decode</span>(<span class="ruby-ivar">@buffer</span>)
58:         <span class="ruby-ivar">@to_utf</span> = <span class="ruby-keyword kw">true</span>
59:       <span class="ruby-keyword kw">else</span>
60:         <span class="ruby-ivar">@to_utf</span> = <span class="ruby-keyword kw">false</span>
61:       <span class="ruby-keyword kw">end</span>
62:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005747" class="method">
  <div id="M005747_title" class="title">
    <b>match</b>(pattern, cons=false)
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005747_source')" id="l_M005747_source">show source</a> ]</p>
  <div id="M005747_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/rexml/source.rb, line 104</span>
104:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">match</span>(<span class="ruby-identifier">pattern</span>, <span class="ruby-identifier">cons</span>=<span class="ruby-keyword kw">false</span>)
105:       <span class="ruby-identifier">md</span> = <span class="ruby-identifier">pattern</span>.<span class="ruby-identifier">match</span>(<span class="ruby-ivar">@buffer</span>)
106:       <span class="ruby-ivar">@buffer</span> = <span class="ruby-identifier">$'</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">cons</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">md</span>
107:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">md</span>
108:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005745" class="method">
  <div id="M005745_title" class="title">
    <b>match_to</b>( char, pattern )
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005745_source')" id="l_M005745_source">show source</a> ]</p>
  <div id="M005745_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/rexml/source.rb, line 94</span>
94:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">match_to</span>( <span class="ruby-identifier">char</span>, <span class="ruby-identifier">pattern</span> )
95:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">pattern</span>.<span class="ruby-identifier">match</span>(<span class="ruby-ivar">@buffer</span>)
96:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005746" class="method">
  <div id="M005746_title" class="title">
    <b>match_to_consume</b>( char, pattern )
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005746_source')" id="l_M005746_source">show source</a> ]</p>
  <div id="M005746_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/rexml/source.rb, line 98</span>
 98:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">match_to_consume</span>( <span class="ruby-identifier">char</span>, <span class="ruby-identifier">pattern</span> )
 99:       <span class="ruby-identifier">md</span> = <span class="ruby-identifier">pattern</span>.<span class="ruby-identifier">match</span>(<span class="ruby-ivar">@buffer</span>)
100:       <span class="ruby-ivar">@buffer</span> = <span class="ruby-identifier">$'</span>
101:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">md</span>
102:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005749" class="method">
  <div id="M005749_title" class="title">
    <b>position</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005749_source')" id="l_M005749_source">show source</a> ]</p>
  <div id="M005749_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/rexml/source.rb, line 115</span>
115:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">position</span>
116:       <span class="ruby-ivar">@orig</span>.<span class="ruby-identifier">index</span>( <span class="ruby-ivar">@buffer</span> )
117:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005743" class="method">
  <div id="M005743_title" class="title">
    <b>read</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005743_source')" id="l_M005743_source">show source</a> ]</p>
  <div id="M005743_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/rexml/source.rb, line 87</span>
87:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">read</span>
88:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005742" class="method">
  <div id="M005742_title" class="title">
    <b>scan</b>(pattern, cons=false)
  </div>
  <div class="description">
  <p>
Scans the source for a given pattern. Note, that this is not your usual
scan() method. For one thing, the pattern argument has some requirements;
for another, the source can be consumed. You can easily confuse this
method. Originally, the patterns were easier to construct and this method
more robust, because this method generated search regexes on the fly;
however, this was computationally expensive and slowed down the entire <a
href="index.html?a=C00001051&name=REXML">REXML</a> package considerably,
since this is by far the most commonly called method. @param pattern must
be a <a href="index.html?a=C00000110&name=Regexp">Regexp</a>, and must be
in the form of /^\s*(#{your pattern, with no groups})(.*)/. The first group
will be returned; the second group is used if the consume flag is set.
@param consume if true, the pattern returned will be consumed, leaving
everything after it in the <a
href="index.html?a=C00001109&name=Source">Source</a>. @return the pattern,
if found, or nil if the <a
href="index.html?a=C00001109&name=Source">Source</a> is empty or the
pattern is not found.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005742_source')" id="l_M005742_source">show source</a> ]</p>
  <div id="M005742_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/rexml/source.rb, line 80</span>
80:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">scan</span>(<span class="ruby-identifier">pattern</span>, <span class="ruby-identifier">cons</span>=<span class="ruby-keyword kw">false</span>)
81:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@buffer</span>.<span class="ruby-identifier">nil?</span>
82:       <span class="ruby-identifier">rv</span> = <span class="ruby-ivar">@buffer</span>.<span class="ruby-identifier">scan</span>(<span class="ruby-identifier">pattern</span>)
83:       <span class="ruby-ivar">@buffer</span> = <span class="ruby-identifier">$'</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">cons</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">rv</span>.<span class="ruby-identifier">size</span><span class="ruby-operator">&gt;</span><span class="ruby-value">0</span>
84:       <span class="ruby-identifier">rv</span>
85:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
</div>

  </div>