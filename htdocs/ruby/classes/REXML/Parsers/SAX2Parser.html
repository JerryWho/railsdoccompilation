  <div id="C00001058">
<div class='banner'>
  <span class="file-title-prefix">Class</span><br />SAX2Parser<br/>
  In:
<a href="#" onclick="jsHref('files/ruby-1_8_7-p22/lib/rexml/parsers/sax2parser_rb.html');">ruby-1.8.7-p22/lib/rexml/parsers/sax2parser.rb</a>

Parent:&nbsp;
        <a href="#" onclick="jsHref('classes/YAML/Object.html');">
Object
         </a>
</div>
 <!-- banner header -->

  <div id="bodyContent" >
      <div id="content">

  <div class="description"><p>
<a href="index.html?a=C00001058&name=SAX2Parser">SAX2Parser</a>
</p>
</div>



  <div class="sectiontitle">Methods</div>
  <ul>
  <li><a href="index.html?a=M005400&name=add_listener" >add_listener</a></li>
  <li><a href="index.html?a=M005402&name=deafen" >deafen</a></li>
  <li><a href="index.html?a=M005401&name=listen" >listen</a></li>
  <li><a href="index.html?a=M005398&name=new" >new</a></li>
  <li><a href="index.html?a=M005403&name=parse" >parse</a></li>
  <li><a href="index.html?a=M005399&name=source" >source</a></li>
  </ul>






<div class="sectiontitle">Public Class methods</div>
<div id="M005398" class="method">
  <div id="M005398_title" class="title">
    <b>new</b>(source)
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005398_source')" id="l_M005398_source">show source</a> ]</p>
  <div id="M005398_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/rexml/parsers/sax2parser.rb, line 10</span>
10:                         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span> <span class="ruby-identifier">source</span>
11:                                 <span class="ruby-ivar">@parser</span> = <span class="ruby-constant">BaseParser</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">source</span>)
12:                                 <span class="ruby-ivar">@listeners</span> = []
13:                                 <span class="ruby-ivar">@procs</span> = []
14:                                 <span class="ruby-ivar">@namespace_stack</span> = []
15:                                 <span class="ruby-ivar">@has_listeners</span> = <span class="ruby-keyword kw">false</span>
16:                                 <span class="ruby-ivar">@tag_stack</span> = []
17:         <span class="ruby-ivar">@entities</span> = {}
18:                         <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div class="sectiontitle">Public Instance methods</div>
<div id="M005400" class="method">
  <div id="M005400_title" class="title">
    <b>add_listener</b>( listener )
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005400_source')" id="l_M005400_source">show source</a> ]</p>
  <div id="M005400_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/rexml/parsers/sax2parser.rb, line 24</span>
24:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">add_listener</span>( <span class="ruby-identifier">listener</span> )
25:         <span class="ruby-ivar">@parser</span>.<span class="ruby-identifier">add_listener</span>( <span class="ruby-identifier">listener</span> )
26:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005402" class="method">
  <div id="M005402_title" class="title">
    <b>deafen</b>( listener=nil, &amp;blok )
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005402_source')" id="l_M005402_source">show source</a> ]</p>
  <div id="M005402_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/rexml/parsers/sax2parser.rb, line 76</span>
76:                         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">deafen</span>( <span class="ruby-identifier">listener</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">blok</span> )
77:                                 <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">listener</span>
78:                                         <span class="ruby-ivar">@listeners</span>.<span class="ruby-identifier">delete_if</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">item</span><span class="ruby-operator">|</span> <span class="ruby-identifier">item</span>[<span class="ruby-value">-1</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">listener</span> }
79:                                         <span class="ruby-ivar">@has_listeners</span> = <span class="ruby-keyword kw">false</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@listeners</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
80:                                 <span class="ruby-keyword kw">else</span>
81:                                         <span class="ruby-ivar">@procs</span>.<span class="ruby-identifier">delete_if</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">item</span><span class="ruby-operator">|</span> <span class="ruby-identifier">item</span>[<span class="ruby-value">-1</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">blok</span> }
82:                                 <span class="ruby-keyword kw">end</span>
83:                         <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005401" class="method">
  <div id="M005401_title" class="title">
    <b>listen</b>( *args, &amp;blok )
  </div>
  <div class="description">
  <p>
Listen arguments:
</p>
<p>
<a href="index.html?a=C00000284&name=Symbol">Symbol</a>, <a
href="index.html?a=C00000243&name=Array">Array</a>, Block
</p>
<pre>
   Listen to Symbol events on Array elements
</pre>
<p>
<a href="index.html?a=C00000284&name=Symbol">Symbol</a>, Block
</p>
<pre>
  Listen to Symbol events
</pre>
<p>
<a href="index.html?a=C00000243&name=Array">Array</a>, Listener
</p>
<pre>
   Listen to all events on Array elements
</pre>
<p>
<a href="index.html?a=C00000243&name=Array">Array</a>, Block
</p>
<pre>
   Listen to :start_element events on Array elements
</pre>
<p>
Listener
</p>
<pre>
   Listen to All events
</pre>
<p>
<a href="index.html?a=C00000284&name=Symbol">Symbol</a> can be one of:
:start_element, :end_element, :start_prefix_mapping, :end_prefix_mapping,
:characters, :processing_instruction, :doctype, :attlistdecl, :elementdecl,
:entitydecl, :notationdecl, :cdata, :xmldecl, :comment
</p>
<p>
There is an additional symbol that can be listened for: :progress. This
will be called for every event generated, passing in the current stream
position.
</p>
<p>
<a href="index.html?a=C00000243&name=Array">Array</a> contains regular
expressions or strings which will be matched against fully qualified
element names.
</p>
<p>
Listener must implement the methods in <a
href="index.html?a=C00001068&name=SAX2Listener">SAX2Listener</a>
</p>
<p>
Block will be passed the same arguments as a <a
href="index.html?a=C00001068&name=SAX2Listener">SAX2Listener</a> method
would be, where the method name is the same as the matched <a
href="index.html?a=C00000284&name=Symbol">Symbol</a>. See the <a
href="index.html?a=C00001068&name=SAX2Listener">SAX2Listener</a> for more
information.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005401_source')" id="l_M005401_source">show source</a> ]</p>
  <div id="M005401_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/rexml/parsers/sax2parser.rb, line 58</span>
58:                         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">listen</span>( <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">blok</span> )
59:                                 <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">args</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">kind_of?</span> <span class="ruby-constant">Symbol</span>
60:                                         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">==</span> <span class="ruby-value">2</span>
61:                                                 <span class="ruby-identifier">args</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">match</span><span class="ruby-operator">|</span> <span class="ruby-ivar">@procs</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-identifier">args</span>[<span class="ruby-value">0</span>], <span class="ruby-identifier">match</span>, <span class="ruby-identifier">blok</span>] }
62:                                         <span class="ruby-keyword kw">else</span>
63:                                                 <span class="ruby-identifier">add</span>( [<span class="ruby-identifier">args</span>[<span class="ruby-value">0</span>], <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">blok</span>] )
64:                                         <span class="ruby-keyword kw">end</span>
65:                                 <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">args</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">kind_of?</span> <span class="ruby-constant">Array</span>
66:                                         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">==</span> <span class="ruby-value">2</span>
67:                                                 <span class="ruby-identifier">args</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">match</span><span class="ruby-operator">|</span> <span class="ruby-identifier">add</span>( [<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">match</span>, <span class="ruby-identifier">args</span>[<span class="ruby-value">1</span>]] ) }
68:                                         <span class="ruby-keyword kw">else</span>
69:                                                 <span class="ruby-identifier">args</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">match</span><span class="ruby-operator">|</span> <span class="ruby-identifier">add</span>( [ <span class="ruby-identifier">:start_element</span>, <span class="ruby-identifier">match</span>, <span class="ruby-identifier">blok</span> ] ) }
70:                                         <span class="ruby-keyword kw">end</span>
71:                                 <span class="ruby-keyword kw">else</span>
72:                                         <span class="ruby-identifier">add</span>([<span class="ruby-keyword kw">nil</span>, <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">args</span>[<span class="ruby-value">0</span>]])
73:                                 <span class="ruby-keyword kw">end</span>
74:                         <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005403" class="method">
  <div id="M005403_title" class="title">
    <b>parse</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005403_source')" id="l_M005403_source">show source</a> ]</p>
  <div id="M005403_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/rexml/parsers/sax2parser.rb, line 85</span>
 85:                         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">parse</span>
 86:                                 <span class="ruby-ivar">@procs</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">sym</span>,<span class="ruby-identifier">match</span>,<span class="ruby-identifier">block</span><span class="ruby-operator">|</span> <span class="ruby-identifier">block</span>.<span class="ruby-identifier">call</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">sym</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">:start_document</span> }
 87:                                 <span class="ruby-ivar">@listeners</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">sym</span>,<span class="ruby-identifier">match</span>,<span class="ruby-identifier">block</span><span class="ruby-operator">|</span> 
 88:                                         <span class="ruby-identifier">block</span>.<span class="ruby-identifier">start_document</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">sym</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">:start_document</span> <span class="ruby-keyword kw">or</span> <span class="ruby-identifier">sym</span>.<span class="ruby-identifier">nil?</span>
 89:                                 }
 90:                                 <span class="ruby-identifier">root</span> = <span class="ruby-identifier">context</span> = []
 91:                                 <span class="ruby-keyword kw">while</span> <span class="ruby-keyword kw">true</span>
 92:                                         <span class="ruby-identifier">event</span> = <span class="ruby-ivar">@parser</span>.<span class="ruby-identifier">pull</span>
 93:                                         <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">event</span>[<span class="ruby-value">0</span>]
 94:                                         <span class="ruby-keyword kw">when</span> <span class="ruby-identifier">:end_document</span>
 95:                                                 <span class="ruby-identifier">handle</span>( <span class="ruby-identifier">:end_document</span> )
 96:                                                 <span class="ruby-keyword kw">break</span>
 97:           <span class="ruby-keyword kw">when</span> <span class="ruby-identifier">:start_doctype</span>
 98:             <span class="ruby-identifier">handle</span>( <span class="ruby-identifier">:doctype</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">event</span>[<span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>])
 99:                                         <span class="ruby-keyword kw">when</span> <span class="ruby-identifier">:end_doctype</span>
100:                                                 <span class="ruby-identifier">context</span> = <span class="ruby-identifier">context</span>[<span class="ruby-value">1</span>]
101:                                         <span class="ruby-keyword kw">when</span> <span class="ruby-identifier">:start_element</span>
102:                                                 <span class="ruby-ivar">@tag_stack</span>.<span class="ruby-identifier">push</span>(<span class="ruby-identifier">event</span>[<span class="ruby-value">1</span>])
103:                                                 <span class="ruby-comment cmt"># find the observers for namespaces</span>
104:                                                 <span class="ruby-identifier">procs</span> = <span class="ruby-identifier">get_procs</span>( <span class="ruby-identifier">:start_prefix_mapping</span>, <span class="ruby-identifier">event</span>[<span class="ruby-value">1</span>] )
105:                                                 <span class="ruby-identifier">listeners</span> = <span class="ruby-identifier">get_listeners</span>( <span class="ruby-identifier">:start_prefix_mapping</span>, <span class="ruby-identifier">event</span>[<span class="ruby-value">1</span>] )
106:                                                 <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">procs</span> <span class="ruby-keyword kw">or</span> <span class="ruby-identifier">listeners</span>
107:                                                         <span class="ruby-comment cmt"># break out the namespace declarations</span>
108:                                                         <span class="ruby-comment cmt"># The attributes live in event[2]</span>
109:                                                         <span class="ruby-identifier">event</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">n</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">event</span>[<span class="ruby-value">2</span>][<span class="ruby-identifier">n</span>] = <span class="ruby-ivar">@parser</span>.<span class="ruby-identifier">normalize</span>(<span class="ruby-identifier">v</span>)}
110:                                                         <span class="ruby-identifier">nsdecl</span> = <span class="ruby-identifier">event</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">find_all</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">n</span>, <span class="ruby-identifier">value</span><span class="ruby-operator">|</span> <span class="ruby-identifier">n</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^xmlns(:|$)/</span> }
111:                                                         <span class="ruby-identifier">nsdecl</span>.<span class="ruby-identifier">collect!</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">n</span>, <span class="ruby-identifier">value</span><span class="ruby-operator">|</span> [ <span class="ruby-identifier">n</span>[<span class="ruby-value">6</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>], <span class="ruby-identifier">value</span> ] }
112:                                                         <span class="ruby-ivar">@namespace_stack</span>.<span class="ruby-identifier">push</span>({})
113:                                                         <span class="ruby-identifier">nsdecl</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">n</span>,<span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
114:                                                                 <span class="ruby-ivar">@namespace_stack</span>[<span class="ruby-value">-1</span>][<span class="ruby-identifier">n</span>] = <span class="ruby-identifier">v</span>
115:                                                                 <span class="ruby-comment cmt"># notify observers of namespaces</span>
116:                                                                 <span class="ruby-identifier">procs</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">ob</span><span class="ruby-operator">|</span> <span class="ruby-identifier">ob</span>.<span class="ruby-identifier">call</span>( <span class="ruby-identifier">n</span>, <span class="ruby-identifier">v</span> ) } <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">procs</span>
117:                                                                 <span class="ruby-identifier">listeners</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">ob</span><span class="ruby-operator">|</span> <span class="ruby-identifier">ob</span>.<span class="ruby-identifier">start_prefix_mapping</span>(<span class="ruby-identifier">n</span>, <span class="ruby-identifier">v</span>) } <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">listeners</span>
118:                                                         <span class="ruby-keyword kw">end</span>
119:                                                 <span class="ruby-keyword kw">end</span>
120:                                                 <span class="ruby-identifier">event</span>[<span class="ruby-value">1</span>] <span class="ruby-operator">=~</span> <span class="ruby-constant">Namespace</span><span class="ruby-operator">::</span><span class="ruby-constant">NAMESPLIT</span>
121:                                                 <span class="ruby-identifier">prefix</span> = <span class="ruby-identifier">$1</span>
122:                                                 <span class="ruby-identifier">local</span> = <span class="ruby-identifier">$2</span>
123:                                                 <span class="ruby-identifier">uri</span> = <span class="ruby-identifier">get_namespace</span>(<span class="ruby-identifier">prefix</span>)
124:                                                 <span class="ruby-comment cmt"># find the observers for start_element</span>
125:                                                 <span class="ruby-identifier">procs</span> = <span class="ruby-identifier">get_procs</span>( <span class="ruby-identifier">:start_element</span>, <span class="ruby-identifier">event</span>[<span class="ruby-value">1</span>] )
126:                                                 <span class="ruby-identifier">listeners</span> = <span class="ruby-identifier">get_listeners</span>( <span class="ruby-identifier">:start_element</span>, <span class="ruby-identifier">event</span>[<span class="ruby-value">1</span>] )
127:                                                 <span class="ruby-comment cmt"># notify observers</span>
128:                                                 <span class="ruby-identifier">procs</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">ob</span><span class="ruby-operator">|</span> <span class="ruby-identifier">ob</span>.<span class="ruby-identifier">call</span>( <span class="ruby-identifier">uri</span>, <span class="ruby-identifier">local</span>, <span class="ruby-identifier">event</span>[<span class="ruby-value">1</span>], <span class="ruby-identifier">event</span>[<span class="ruby-value">2</span>] ) } <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">procs</span>
129:                                                 <span class="ruby-identifier">listeners</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">ob</span><span class="ruby-operator">|</span> 
130:                                                         <span class="ruby-identifier">ob</span>.<span class="ruby-identifier">start_element</span>( <span class="ruby-identifier">uri</span>, <span class="ruby-identifier">local</span>, <span class="ruby-identifier">event</span>[<span class="ruby-value">1</span>], <span class="ruby-identifier">event</span>[<span class="ruby-value">2</span>] ) 
131:                                                 } <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">listeners</span>
132:                                         <span class="ruby-keyword kw">when</span> <span class="ruby-identifier">:end_element</span>
133:                                                 <span class="ruby-ivar">@tag_stack</span>.<span class="ruby-identifier">pop</span>
134:                                                 <span class="ruby-identifier">event</span>[<span class="ruby-value">1</span>] <span class="ruby-operator">=~</span> <span class="ruby-constant">Namespace</span><span class="ruby-operator">::</span><span class="ruby-constant">NAMESPLIT</span>
135:                                                 <span class="ruby-identifier">prefix</span> = <span class="ruby-identifier">$1</span>
136:                                                 <span class="ruby-identifier">local</span> = <span class="ruby-identifier">$2</span>
137:                                                 <span class="ruby-identifier">uri</span> = <span class="ruby-identifier">get_namespace</span>(<span class="ruby-identifier">prefix</span>)
138:                                                 <span class="ruby-comment cmt"># find the observers for start_element</span>
139:                                                 <span class="ruby-identifier">procs</span> = <span class="ruby-identifier">get_procs</span>( <span class="ruby-identifier">:end_element</span>, <span class="ruby-identifier">event</span>[<span class="ruby-value">1</span>] )
140:                                                 <span class="ruby-identifier">listeners</span> = <span class="ruby-identifier">get_listeners</span>( <span class="ruby-identifier">:end_element</span>, <span class="ruby-identifier">event</span>[<span class="ruby-value">1</span>] )
141:                                                 <span class="ruby-comment cmt"># notify observers</span>
142:                                                 <span class="ruby-identifier">procs</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">ob</span><span class="ruby-operator">|</span> <span class="ruby-identifier">ob</span>.<span class="ruby-identifier">call</span>( <span class="ruby-identifier">uri</span>, <span class="ruby-identifier">local</span>, <span class="ruby-identifier">event</span>[<span class="ruby-value">1</span>] ) } <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">procs</span>
143:                                                 <span class="ruby-identifier">listeners</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">ob</span><span class="ruby-operator">|</span> 
144:                                                         <span class="ruby-identifier">ob</span>.<span class="ruby-identifier">end_element</span>( <span class="ruby-identifier">uri</span>, <span class="ruby-identifier">local</span>, <span class="ruby-identifier">event</span>[<span class="ruby-value">1</span>] ) 
145:                                                 } <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">listeners</span>
146: 
147:                                                 <span class="ruby-identifier">namespace_mapping</span> = <span class="ruby-ivar">@namespace_stack</span>.<span class="ruby-identifier">pop</span>
148:                                                 <span class="ruby-comment cmt"># find the observers for namespaces</span>
149:                                                 <span class="ruby-identifier">procs</span> = <span class="ruby-identifier">get_procs</span>( <span class="ruby-identifier">:end_prefix_mapping</span>, <span class="ruby-identifier">event</span>[<span class="ruby-value">1</span>] )
150:                                                 <span class="ruby-identifier">listeners</span> = <span class="ruby-identifier">get_listeners</span>( <span class="ruby-identifier">:end_prefix_mapping</span>, <span class="ruby-identifier">event</span>[<span class="ruby-value">1</span>] )
151:                                                 <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">procs</span> <span class="ruby-keyword kw">or</span> <span class="ruby-identifier">listeners</span>
152:                                                         <span class="ruby-identifier">namespace_mapping</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">prefix</span>, <span class="ruby-identifier">uri</span><span class="ruby-operator">|</span>
153:                                                                 <span class="ruby-comment cmt"># notify observers of namespaces</span>
154:                                                                 <span class="ruby-identifier">procs</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">ob</span><span class="ruby-operator">|</span> <span class="ruby-identifier">ob</span>.<span class="ruby-identifier">call</span>( <span class="ruby-identifier">prefix</span> ) } <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">procs</span>
155:                                                                 <span class="ruby-identifier">listeners</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">ob</span><span class="ruby-operator">|</span> <span class="ruby-identifier">ob</span>.<span class="ruby-identifier">end_prefix_mapping</span>(<span class="ruby-identifier">prefix</span>) } <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">listeners</span>
156:                                                         <span class="ruby-keyword kw">end</span>
157:                                                 <span class="ruby-keyword kw">end</span>
158:                                         <span class="ruby-keyword kw">when</span> <span class="ruby-identifier">:text</span>
159:             <span class="ruby-comment cmt">#normalized = @parser.normalize( event[1] )</span>
160:             <span class="ruby-comment cmt">#handle( :characters, normalized )</span>
161:             <span class="ruby-identifier">copy</span> = <span class="ruby-identifier">event</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">clone</span>
162:             <span class="ruby-ivar">@entities</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span><span class="ruby-operator">|</span> <span class="ruby-identifier">copy</span> = <span class="ruby-identifier">copy</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-node">&quot;&amp;#{key};&quot;</span>, <span class="ruby-identifier">value</span>) }
163:             <span class="ruby-identifier">copy</span>.<span class="ruby-identifier">gsub!</span>( <span class="ruby-constant">Text</span><span class="ruby-operator">::</span><span class="ruby-constant">NUMERICENTITY</span> ) {<span class="ruby-operator">|</span><span class="ruby-identifier">m</span><span class="ruby-operator">|</span>
164:               <span class="ruby-identifier">m</span>=<span class="ruby-identifier">$1</span>
165:               <span class="ruby-identifier">m</span> = <span class="ruby-node">&quot;0#{m}&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">m</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">==</span> <span class="ruby-value">?x</span>
166:               [<span class="ruby-constant">Integer</span>(<span class="ruby-identifier">m</span>)].<span class="ruby-identifier">pack</span>(<span class="ruby-value str">'U*'</span>)
167:             }
168:             <span class="ruby-identifier">handle</span>( <span class="ruby-identifier">:characters</span>, <span class="ruby-identifier">copy</span> )
169:           <span class="ruby-keyword kw">when</span> <span class="ruby-identifier">:entitydecl</span>
170:             <span class="ruby-ivar">@entities</span>[ <span class="ruby-identifier">event</span>[<span class="ruby-value">1</span>] ] = <span class="ruby-identifier">event</span>[<span class="ruby-value">2</span>] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">event</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">==</span> <span class="ruby-value">3</span>
171:                                                 <span class="ruby-identifier">handle</span>( <span class="ruby-operator">*</span><span class="ruby-identifier">event</span> )
172:                                         <span class="ruby-keyword kw">when</span> <span class="ruby-identifier">:processing_instruction</span>, <span class="ruby-identifier">:comment</span>, <span class="ruby-identifier">:attlistdecl</span>, 
173:                                                 <span class="ruby-identifier">:elementdecl</span>, <span class="ruby-identifier">:cdata</span>, <span class="ruby-identifier">:notationdecl</span>, <span class="ruby-identifier">:xmldecl</span>
174:                                                 <span class="ruby-identifier">handle</span>( <span class="ruby-operator">*</span><span class="ruby-identifier">event</span> )
175:                                         <span class="ruby-keyword kw">end</span>
176:           <span class="ruby-identifier">handle</span>( <span class="ruby-identifier">:progress</span>, <span class="ruby-ivar">@parser</span>.<span class="ruby-identifier">position</span> )
177:                                 <span class="ruby-keyword kw">end</span>
178:                         <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005399" class="method">
  <div id="M005399_title" class="title">
    <b>source</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005399_source')" id="l_M005399_source">show source</a> ]</p>
  <div id="M005399_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/rexml/parsers/sax2parser.rb, line 20</span>
20:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">source</span>
21:         <span class="ruby-ivar">@parser</span>.<span class="ruby-identifier">source</span>
22:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
</div>

  </div>