  <div id="C00001098">
<div class='banner'>
  <span class="file-title-prefix">Class</span><br />Text<br/>
  In:
<a href="#" onclick="jsHref('files/ruby-1_8_7-p22/lib/rexml/text_rb.html');">ruby-1.8.7-p22/lib/rexml/text.rb</a>

Parent:&nbsp;
        <a href="#" onclick="jsHref('classes/REXML/Child.html');">
Child
         </a>
</div>
 <!-- banner header -->

  <div id="bodyContent" >
      <div id="content">

  <div class="description"><p>
Represents text nodes in an <a
href="index.html?a=C00000959&name=XML">XML</a> document
</p>
</div>



  <div class="sectiontitle">Methods</div>
  <ul>
  <li><a href="index.html?a=M005660&name=&lt;&lt;" >&lt;&lt;</a></li>
  <li><a href="index.html?a=M005661&name=&lt;=&gt;" >&lt;=&gt;</a></li>
  <li><a href="index.html?a=M005659&name=clone" >clone</a></li>
  <li><a href="index.html?a=M005658&name=empty?" >empty?</a></li>
  <li><a href="index.html?a=M005667&name=indent_text" >indent_text</a></li>
  <li><a href="index.html?a=M005663&name=inspect" >inspect</a></li>
  <li><a href="index.html?a=M005656&name=new" >new</a></li>
  <li><a href="index.html?a=M005657&name=node_type" >node_type</a></li>
  <li><a href="index.html?a=M005672&name=normalize" >normalize</a></li>
  <li><a href="index.html?a=M005671&name=read_with_substitution" >read_with_substitution</a></li>
  <li><a href="index.html?a=M005662&name=to_s" >to_s</a></li>
  <li><a href="index.html?a=M005673&name=unnormalize" >unnormalize</a></li>
  <li><a href="index.html?a=M005664&name=value" >value</a></li>
  <li><a href="index.html?a=M005665&name=value=" >value=</a></li>
  <li><a href="index.html?a=M005666&name=wrap" >wrap</a></li>
  <li><a href="index.html?a=M005668&name=write" >write</a></li>
  <li><a href="index.html?a=M005670&name=write_with_substitution" >write_with_substitution</a></li>
  <li><a href="index.html?a=M005669&name=xpath" >xpath</a></li>
  </ul>

<div class="sectiontitle">Included Modules</div>
<ul>
  <li><a href="#" onclick="jsHref('classes/Comparable.html');">Comparable</a></li>
</ul>



  <div class="sectiontitle">Constants</div>
  <table border='0' cellpadding='5'>
  <tr valign='top'>
    <td class="attr-name">SPECIALS</td>
    <td>=</td>
    <td class="attr-value">[ /&amp;(?!#?[\w-]+;)/u, /&lt;/u, /&gt;/u, /&quot;/u, /'/u, /\r/u ]</td>
  </tr>
  <tr valign='top'>
    <td>&nbsp;</td>
    <td colspan="2" class="attr-desc">
The order in which the substitutions occur

</td>
  </tr>
  <tr valign='top'>
    <td class="attr-name">SUBSTITUTES</td>
    <td>=</td>
    <td class="attr-value">['&amp;amp;', '&amp;lt;', '&amp;gt;', '&amp;quot;', '&amp;apos;', '&amp;#13;']</td>
  </tr>
  <tr valign='top'>
    <td class="attr-name">SLAICEPS</td>
    <td>=</td>
    <td class="attr-value">[ '&lt;', '&gt;', '&quot;', &quot;'&quot;, '&amp;' ]</td>
  </tr>
  <tr valign='top'>
    <td>&nbsp;</td>
    <td colspan="2" class="attr-desc">
Characters which are substituted in written strings

</td>
  </tr>
  <tr valign='top'>
    <td class="attr-name">SETUTITSBUS</td>
    <td>=</td>
    <td class="attr-value">[ /&amp;lt;/u, /&amp;gt;/u, /&amp;quot;/u, /&amp;apos;/u, /&amp;amp;/u ]</td>
  </tr>
  <tr valign='top'>
    <td class="attr-name">ILLEGAL</td>
    <td>=</td>
    <td class="attr-value">/(&lt;|&amp;(?!(#{Entity::NAME})|(#0*((?:\d+)|(?:x[a-fA-F0-9]+)));))/um</td>
  </tr>
  <tr valign='top'>
    <td class="attr-name">NUMERICENTITY</td>
    <td>=</td>
    <td class="attr-value">/&amp;#0*((?:\d+)|(?:x[a-fA-F0-9]+));/</td>
  </tr>
  <tr valign='top'>
    <td class="attr-name">REFERENCE</td>
    <td>=</td>
    <td class="attr-value">/#{Entity::REFERENCE}/</td>
  </tr>
  <tr valign='top'>
    <td class="attr-name">EREFERENCE</td>
    <td>=</td>
    <td class="attr-value">/&amp;(?!#{Entity::NAME};)/</td>
  </tr>
  </table>

  <div class="sectiontitle">Attributes</div>
  <table border='0' cellpadding='5'>
  <tr valign='top'>
    <td class='attr-rw'>
[RW]
    </td>
    <td class='attr-name'>raw</td>
    <td class='attr-desc'>
If <tt>raw</tt> is true, then <a
href="index.html?a=C00001051&name=REXML">REXML</a> leaves the value alone

</td>
  </tr>
  </table>

<div class="sectiontitle">Public Class methods</div>
<div id="M005656" class="method">
  <div id="M005656_title" class="title">
    <b>new</b>(arg, respect_whitespace=false, parent=nil, raw=nil, entity_filter=nil, illegal=ILLEGAL )
  </div>
  <div class="description">
  <p>
Constructor <tt>arg</tt> if a <a
href="index.html?a=C00000055&name=String">String</a>, the content is set to
the <a href="index.html?a=C00000055&name=String">String</a>. If a <a
href="index.html?a=C00001098&name=Text">Text</a>, the object is shallowly
cloned.
</p>
<p>
<tt>respect_whitespace</tt> (boolean, false) if true, whitespace is
respected
</p>
<p>
<tt>parent</tt> (nil) if this is a <a
href="index.html?a=C00001102&name=Parent">Parent</a> object, the parent
will be set to this.
</p>
<p>
<tt>raw</tt> (nil) This argument can be given three values. If true, then
the value of used to construct this object is expected to contain no
unescaped <a href="index.html?a=C00000959&name=XML">XML</a> markup, and <a
href="index.html?a=C00001051&name=REXML">REXML</a> will not change the
text. If this value is false, the string may contain any characters, and <a
href="index.html?a=C00001051&name=REXML">REXML</a> will escape any and all
defined entities whose values are contained in the text. If this value is
nil (the default), then the raw value of the parent will be used as the raw
value for this node. If there is no raw value for the parent, and no value
is supplied, the default is false. Use this field if you have entities
defined for some text, and you don&#8217;t want <a
href="index.html?a=C00001051&name=REXML">REXML</a> to escape that text in
output.
</p>
<pre>
  Text.new( &quot;&lt;&amp;&quot;, false, nil, false ) #-&gt; &quot;&amp;lt;&amp;amp;&quot;
  Text.new( &quot;&amp;lt;&amp;amp;&quot;, false, nil, false ) #-&gt; &quot;&amp;amp;lt;&amp;amp;amp;&quot;
  Text.new( &quot;&lt;&amp;&quot;, false, nil, true )  #-&gt; Parse exception
  Text.new( &quot;&amp;lt;&amp;amp;&quot;, false, nil, true )  #-&gt; &quot;&amp;lt;&amp;amp;&quot;
  # Assume that the entity &quot;s&quot; is defined to be &quot;sean&quot;
  # and that the entity    &quot;r&quot; is defined to be &quot;russell&quot;
  Text.new( &quot;sean russell&quot; )          #-&gt; &quot;&amp;s; &amp;r;&quot;
  Text.new( &quot;sean russell&quot;, false, nil, true ) #-&gt; &quot;sean russell&quot;
</pre>
<p>
<tt>entity_filter</tt> (nil) This can be an array of entities to match in
the supplied text. This argument is only useful if <tt>raw</tt> is set to
false.
</p>
<pre>
  Text.new( &quot;sean russell&quot;, false, nil, false, [&quot;s&quot;] ) #-&gt; &quot;&amp;s; russell&quot;
  Text.new( &quot;sean russell&quot;, false, nil, true, [&quot;s&quot;] ) #-&gt; &quot;sean russell&quot;
</pre>
<p>
In the last example, the <tt>entity_filter</tt> argument is ignored.
</p>
<p>
<tt>pattern</tt> INTERNAL USE ONLY
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005656_source')" id="l_M005656_source">show source</a> ]</p>
  <div id="M005656_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/rexml/text.rb, line 60</span>
60:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">arg</span>, <span class="ruby-identifier">respect_whitespace</span>=<span class="ruby-keyword kw">false</span>, <span class="ruby-identifier">parent</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">raw</span>=<span class="ruby-keyword kw">nil</span>, 
61:       <span class="ruby-identifier">entity_filter</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">illegal</span>=<span class="ruby-constant">ILLEGAL</span> )
62: 
63:       <span class="ruby-ivar">@raw</span> = <span class="ruby-keyword kw">false</span>
64: 
65:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">parent</span>
66:         <span class="ruby-keyword kw">super</span>( <span class="ruby-identifier">parent</span> )
67:         <span class="ruby-ivar">@raw</span> = <span class="ruby-identifier">parent</span>.<span class="ruby-identifier">raw</span> 
68:       <span class="ruby-keyword kw">else</span>
69:         <span class="ruby-ivar">@parent</span> = <span class="ruby-keyword kw">nil</span>
70:       <span class="ruby-keyword kw">end</span>
71: 
72:       <span class="ruby-ivar">@raw</span> = <span class="ruby-identifier">raw</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">raw</span>.<span class="ruby-identifier">nil?</span>
73:       <span class="ruby-ivar">@entity_filter</span> = <span class="ruby-identifier">entity_filter</span>
74:       <span class="ruby-ivar">@normalized</span> = <span class="ruby-ivar">@unnormalized</span> = <span class="ruby-keyword kw">nil</span>
75: 
76:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">arg</span>.<span class="ruby-identifier">kind_of?</span> <span class="ruby-constant">String</span>
77:         <span class="ruby-ivar">@string</span> = <span class="ruby-identifier">arg</span>.<span class="ruby-identifier">clone</span>
78:         <span class="ruby-ivar">@string</span>.<span class="ruby-identifier">squeeze!</span>(<span class="ruby-value str">&quot; \n\t&quot;</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">respect_whitespace</span>
79:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">arg</span>.<span class="ruby-identifier">kind_of?</span> <span class="ruby-constant">Text</span>
80:         <span class="ruby-ivar">@string</span> = <span class="ruby-identifier">arg</span>.<span class="ruby-identifier">to_s</span>
81:         <span class="ruby-ivar">@raw</span> = <span class="ruby-identifier">arg</span>.<span class="ruby-identifier">raw</span>
82:       <span class="ruby-keyword kw">elsif</span>
83:         <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;Illegal argument of type #{arg.type} for Text constructor (#{arg})&quot;</span>
84:       <span class="ruby-keyword kw">end</span>
85: 
86:       <span class="ruby-ivar">@string</span>.<span class="ruby-identifier">gsub!</span>( <span class="ruby-regexp re">/\r\n?/</span>, <span class="ruby-value str">&quot;\n&quot;</span> )
87: 
88:       <span class="ruby-comment cmt"># check for illegal characters</span>
89:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@raw</span>
90:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@string</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">illegal</span>
91:           <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;Illegal character '#{$1}' in raw string \&quot;#{@string}\&quot;&quot;</span>
92:         <span class="ruby-keyword kw">end</span>
93:       <span class="ruby-keyword kw">end</span>
94:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005672" class="method">
  <div id="M005672_title" class="title">
    <b>normalize</b>( input, doctype=nil, entity_filter=nil )
  </div>
  <div class="description">
  <p>
Escapes all possible entities
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005672_source')" id="l_M005672_source">show source</a> ]</p>
  <div id="M005672_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/rexml/text.rb, line 288</span>
288:     <span class="ruby-keyword kw">def</span> <span class="ruby-constant">Text</span><span class="ruby-operator">::</span><span class="ruby-identifier">normalize</span>( <span class="ruby-identifier">input</span>, <span class="ruby-identifier">doctype</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">entity_filter</span>=<span class="ruby-keyword kw">nil</span> )
289:       <span class="ruby-identifier">copy</span> = <span class="ruby-identifier">input</span>
290:       <span class="ruby-comment cmt"># Doing it like this rather than in a loop improves the speed</span>
291:       <span class="ruby-comment cmt">#copy = copy.gsub( EREFERENCE, '&amp;amp;' )</span>
292:       <span class="ruby-identifier">copy</span> = <span class="ruby-identifier">copy</span>.<span class="ruby-identifier">gsub</span>( <span class="ruby-value str">&quot;&amp;&quot;</span>, <span class="ruby-value str">&quot;&amp;amp;&quot;</span> )
293:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">doctype</span>
294:         <span class="ruby-comment cmt"># Replace all ampersands that aren't part of an entity</span>
295:         <span class="ruby-identifier">doctype</span>.<span class="ruby-identifier">entities</span>.<span class="ruby-identifier">each_value</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">entity</span><span class="ruby-operator">|</span>
296:           <span class="ruby-identifier">copy</span> = <span class="ruby-identifier">copy</span>.<span class="ruby-identifier">gsub</span>( <span class="ruby-identifier">entity</span>.<span class="ruby-identifier">value</span>, 
297:             <span class="ruby-node">&quot;&amp;#{entity.name};&quot;</span> ) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">entity</span>.<span class="ruby-identifier">value</span> <span class="ruby-keyword kw">and</span> 
298:               <span class="ruby-keyword kw">not</span>( <span class="ruby-identifier">entity_filter</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">entity_filter</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">entity</span>) )
299:         <span class="ruby-keyword kw">end</span>
300:       <span class="ruby-keyword kw">else</span>
301:         <span class="ruby-comment cmt"># Replace all ampersands that aren't part of an entity</span>
302:         <span class="ruby-constant">DocType</span><span class="ruby-operator">::</span><span class="ruby-constant">DEFAULT_ENTITIES</span>.<span class="ruby-identifier">each_value</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">entity</span><span class="ruby-operator">|</span>
303:           <span class="ruby-identifier">copy</span> = <span class="ruby-identifier">copy</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-identifier">entity</span>.<span class="ruby-identifier">value</span>, <span class="ruby-node">&quot;&amp;#{entity.name};&quot;</span> )
304:         <span class="ruby-keyword kw">end</span>
305:       <span class="ruby-keyword kw">end</span>
306:       <span class="ruby-identifier">copy</span>
307:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005671" class="method">
  <div id="M005671_title" class="title">
    <b>read_with_substitution</b>( input, illegal=nil )
  </div>
  <div class="description">
  <p>
Reads text, substituting entities
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005671_source')" id="l_M005671_source">show source</a> ]</p>
  <div id="M005671_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/rexml/text.rb, line 262</span>
262:     <span class="ruby-keyword kw">def</span> <span class="ruby-constant">Text</span><span class="ruby-operator">::</span><span class="ruby-identifier">read_with_substitution</span>( <span class="ruby-identifier">input</span>, <span class="ruby-identifier">illegal</span>=<span class="ruby-keyword kw">nil</span> )
263:       <span class="ruby-identifier">copy</span> = <span class="ruby-identifier">input</span>.<span class="ruby-identifier">clone</span>
264: 
265:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">copy</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">illegal</span>
266:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">ParseException</span>.<span class="ruby-identifier">new</span>( <span class="ruby-node">&quot;malformed text: Illegal character #$&amp; in \&quot;#{copy}\&quot;&quot;</span> )
267:       <span class="ruby-keyword kw">end</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">illegal</span>
268:       
269:       <span class="ruby-identifier">copy</span>.<span class="ruby-identifier">gsub!</span>( <span class="ruby-regexp re">/\r\n?/</span>, <span class="ruby-value str">&quot;\n&quot;</span> )
270:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">copy</span>.<span class="ruby-identifier">include?</span> <span class="ruby-operator">?</span><span class="ruby-operator">&amp;</span>
271:         <span class="ruby-identifier">copy</span>.<span class="ruby-identifier">gsub!</span>( <span class="ruby-constant">SETUTITSBUS</span>[<span class="ruby-value">0</span>], <span class="ruby-constant">SLAICEPS</span>[<span class="ruby-value">0</span>] )
272:         <span class="ruby-identifier">copy</span>.<span class="ruby-identifier">gsub!</span>( <span class="ruby-constant">SETUTITSBUS</span>[<span class="ruby-value">1</span>], <span class="ruby-constant">SLAICEPS</span>[<span class="ruby-value">1</span>] )
273:         <span class="ruby-identifier">copy</span>.<span class="ruby-identifier">gsub!</span>( <span class="ruby-constant">SETUTITSBUS</span>[<span class="ruby-value">2</span>], <span class="ruby-constant">SLAICEPS</span>[<span class="ruby-value">2</span>] )
274:         <span class="ruby-identifier">copy</span>.<span class="ruby-identifier">gsub!</span>( <span class="ruby-constant">SETUTITSBUS</span>[<span class="ruby-value">3</span>], <span class="ruby-constant">SLAICEPS</span>[<span class="ruby-value">3</span>] )
275:         <span class="ruby-identifier">copy</span>.<span class="ruby-identifier">gsub!</span>( <span class="ruby-constant">SETUTITSBUS</span>[<span class="ruby-value">4</span>], <span class="ruby-constant">SLAICEPS</span>[<span class="ruby-value">4</span>] )
276:         <span class="ruby-identifier">copy</span>.<span class="ruby-identifier">gsub!</span>( <span class="ruby-regexp re">/&amp;#0*((?:\d+)|(?:x[a-f0-9]+));/</span> ) {<span class="ruby-operator">|</span><span class="ruby-identifier">m</span><span class="ruby-operator">|</span>
277:           <span class="ruby-identifier">m</span>=<span class="ruby-identifier">$1</span>
278:           <span class="ruby-comment cmt">#m='0' if m==''</span>
279:           <span class="ruby-identifier">m</span> = <span class="ruby-node">&quot;0#{m}&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">m</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">==</span> <span class="ruby-value">?x</span>
280:           [<span class="ruby-constant">Integer</span>(<span class="ruby-identifier">m</span>)].<span class="ruby-identifier">pack</span>(<span class="ruby-value str">'U*'</span>)
281:         }
282:       <span class="ruby-keyword kw">end</span>
283:       <span class="ruby-identifier">copy</span>
284:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005673" class="method">
  <div id="M005673_title" class="title">
    <b>unnormalize</b>( string, doctype=nil, filter=nil, illegal=nil )
  </div>
  <div class="description">
  <p>
Unescapes all possible entities
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005673_source')" id="l_M005673_source">show source</a> ]</p>
  <div id="M005673_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/rexml/text.rb, line 310</span>
310:     <span class="ruby-keyword kw">def</span> <span class="ruby-constant">Text</span><span class="ruby-operator">::</span><span class="ruby-identifier">unnormalize</span>( <span class="ruby-identifier">string</span>, <span class="ruby-identifier">doctype</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">filter</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">illegal</span>=<span class="ruby-keyword kw">nil</span> )
311:       <span class="ruby-identifier">rv</span> = <span class="ruby-identifier">string</span>.<span class="ruby-identifier">clone</span>
312:       <span class="ruby-identifier">rv</span>.<span class="ruby-identifier">gsub!</span>( <span class="ruby-regexp re">/\r\n?/</span>, <span class="ruby-value str">&quot;\n&quot;</span> )
313:       <span class="ruby-identifier">matches</span> = <span class="ruby-identifier">rv</span>.<span class="ruby-identifier">scan</span>( <span class="ruby-constant">REFERENCE</span> )
314:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">rv</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">matches</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
315:       <span class="ruby-identifier">rv</span>.<span class="ruby-identifier">gsub!</span>( <span class="ruby-constant">NUMERICENTITY</span> ) {<span class="ruby-operator">|</span><span class="ruby-identifier">m</span><span class="ruby-operator">|</span>
316:         <span class="ruby-identifier">m</span>=<span class="ruby-identifier">$1</span>
317:         <span class="ruby-identifier">m</span> = <span class="ruby-node">&quot;0#{m}&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">m</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">==</span> <span class="ruby-value">?x</span>
318:         [<span class="ruby-constant">Integer</span>(<span class="ruby-identifier">m</span>)].<span class="ruby-identifier">pack</span>(<span class="ruby-value str">'U*'</span>)
319:       }
320:       <span class="ruby-identifier">matches</span>.<span class="ruby-identifier">collect!</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span><span class="ruby-identifier">x</span>[<span class="ruby-value">0</span>]}.<span class="ruby-identifier">compact!</span>
321:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">matches</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>
322:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">doctype</span>
323:           <span class="ruby-identifier">matches</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">entity_reference</span><span class="ruby-operator">|</span>
324:             <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">filter</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">filter</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">entity_reference</span>)
325:               <span class="ruby-identifier">entity_value</span> = <span class="ruby-identifier">doctype</span>.<span class="ruby-identifier">entity</span>( <span class="ruby-identifier">entity_reference</span> )
326:               <span class="ruby-identifier">re</span> = <span class="ruby-node">/&amp;#{entity_reference};/</span>
327:               <span class="ruby-identifier">rv</span>.<span class="ruby-identifier">gsub!</span>( <span class="ruby-identifier">re</span>, <span class="ruby-identifier">entity_value</span> ) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">entity_value</span>
328:             <span class="ruby-keyword kw">end</span>
329:           <span class="ruby-keyword kw">end</span>
330:         <span class="ruby-keyword kw">else</span>
331:           <span class="ruby-identifier">matches</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">entity_reference</span><span class="ruby-operator">|</span>
332:             <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">filter</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">filter</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">entity_reference</span>)
333:               <span class="ruby-identifier">entity_value</span> = <span class="ruby-constant">DocType</span><span class="ruby-operator">::</span><span class="ruby-constant">DEFAULT_ENTITIES</span>[ <span class="ruby-identifier">entity_reference</span> ]
334:               <span class="ruby-identifier">re</span> = <span class="ruby-node">/&amp;#{entity_reference};/</span>
335:               <span class="ruby-identifier">rv</span>.<span class="ruby-identifier">gsub!</span>( <span class="ruby-identifier">re</span>, <span class="ruby-identifier">entity_value</span>.<span class="ruby-identifier">value</span> ) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">entity_value</span>
336:             <span class="ruby-keyword kw">end</span>
337:           <span class="ruby-keyword kw">end</span>
338:         <span class="ruby-keyword kw">end</span>
339:         <span class="ruby-identifier">rv</span>.<span class="ruby-identifier">gsub!</span>( <span class="ruby-regexp re">/&amp;amp;/</span>, <span class="ruby-value str">'&amp;'</span> )
340:       <span class="ruby-keyword kw">end</span>
341:       <span class="ruby-identifier">rv</span>
342:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div class="sectiontitle">Public Instance methods</div>
<div id="M005660" class="method">
  <div id="M005660_title" class="title">
    <b>&lt;&lt;</b>( to_append )
  </div>
  <div class="description">
  <p>
Appends text to this text node. The text is appended in the <tt>raw</tt>
mode of this text node.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005660_source')" id="l_M005660_source">show source</a> ]</p>
  <div id="M005660_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/rexml/text.rb, line 112</span>
112:     <span class="ruby-keyword kw">def</span> <span class="ruby-operator">&lt;&lt;</span>( <span class="ruby-identifier">to_append</span> )
113:       <span class="ruby-ivar">@string</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">to_append</span>.<span class="ruby-identifier">gsub</span>( <span class="ruby-regexp re">/\r\n?/</span>, <span class="ruby-value str">&quot;\n&quot;</span> )
114:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005661" class="method">
  <div id="M005661_title" class="title">
    <b>&lt;=&gt;</b>( other )
  </div>
  <div class="description">
  <p>
<tt>other</tt> a <a href="index.html?a=C00000055&name=String">String</a> or
a <a href="index.html?a=C00001098&name=Text">Text</a> <tt>returns</tt> the
result of (<a href="index.html?a=M005662&name=to_s">to_s</a> &lt;=&gt;
arg.to_s)
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005661_source')" id="l_M005661_source">show source</a> ]</p>
  <div id="M005661_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/rexml/text.rb, line 119</span>
119:     <span class="ruby-keyword kw">def</span> <span class="ruby-operator">&lt;=&gt;</span>( <span class="ruby-identifier">other</span> )
120:       <span class="ruby-identifier">to_s</span>() <span class="ruby-operator">&lt;=&gt;</span> <span class="ruby-identifier">other</span>.<span class="ruby-identifier">to_s</span>
121:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005659" class="method">
  <div id="M005659_title" class="title">
    <b>clone</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005659_source')" id="l_M005659_source">show source</a> ]</p>
  <div id="M005659_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/rexml/text.rb, line 105</span>
105:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">clone</span>
106:       <span class="ruby-keyword kw">return</span> <span class="ruby-constant">Text</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword kw">self</span>)
107:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005658" class="method">
  <div id="M005658_title" class="title">
    <b>empty?</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005658_source')" id="l_M005658_source">show source</a> ]</p>
  <div id="M005658_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/rexml/text.rb, line 100</span>
100:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">empty?</span>
101:       <span class="ruby-ivar">@string</span>.<span class="ruby-identifier">size</span><span class="ruby-operator">==</span><span class="ruby-value">0</span>
102:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005667" class="method">
  <div id="M005667_title" class="title">
    <b>indent_text</b>(string, level=1, style=&quot;\t&quot;, indentfirstline=true)
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005667_source')" id="l_M005667_source">show source</a> ]</p>
  <div id="M005667_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/rexml/text.rb, line 202</span>
202:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">indent_text</span>(<span class="ruby-identifier">string</span>, <span class="ruby-identifier">level</span>=<span class="ruby-value">1</span>, <span class="ruby-identifier">style</span>=<span class="ruby-value str">&quot;\t&quot;</span>, <span class="ruby-identifier">indentfirstline</span>=<span class="ruby-keyword kw">true</span>)
203:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">string</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">level</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>
204:       <span class="ruby-identifier">new_string</span> = <span class="ruby-value str">''</span>
205:       <span class="ruby-identifier">string</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span>
206:         <span class="ruby-identifier">indent_string</span> = <span class="ruby-identifier">style</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">level</span>
207:         <span class="ruby-identifier">new_line</span> = (<span class="ruby-identifier">indent_string</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">line</span>).<span class="ruby-identifier">sub</span>(<span class="ruby-regexp re">/[\s]+$/</span>,<span class="ruby-value str">''</span>)
208:         <span class="ruby-identifier">new_string</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">new_line</span>
209:       }
210:       <span class="ruby-identifier">new_string</span>.<span class="ruby-identifier">strip!</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">indentfirstline</span>
211:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">new_string</span>
212:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005663" class="method">
  <div id="M005663_title" class="title">
    <b>inspect</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005663_source')" id="l_M005663_source">show source</a> ]</p>
  <div id="M005663_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/rexml/text.rb, line 150</span>
150:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">inspect</span>
151:       <span class="ruby-ivar">@string</span>.<span class="ruby-identifier">inspect</span>
152:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005657" class="method">
  <div id="M005657_title" class="title">
    <b>node_type</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005657_source')" id="l_M005657_source">show source</a> ]</p>
  <div id="M005657_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/rexml/text.rb, line 96</span>
96:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">node_type</span>
97:       <span class="ruby-identifier">:text</span>
98:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005662" class="method">
  <div id="M005662_title" class="title">
    <b>to_s</b>()
  </div>
  <div class="description">
  <p>
Returns the string value of this text node. This string is always escaped,
meaning that it is a valid <a
href="index.html?a=C00000959&name=XML">XML</a> text node string, and all
entities that can be escaped, have been inserted. This method respects the
entity filter set in the constructor.
</p>
<pre>
  # Assume that the entity &quot;s&quot; is defined to be &quot;sean&quot;, and that the
  # entity &quot;r&quot; is defined to be &quot;russell&quot;
  t = Text.new( &quot;&lt; &amp; sean russell&quot;, false, nil, false, ['s'] )
  t.to_s   #-&gt; &quot;&amp;lt; &amp;amp; &amp;s; russell&quot;
  t = Text.new( &quot;&lt; &amp; &amp;s; russell&quot;, false, nil, false )
  t.to_s   #-&gt; &quot;&amp;lt; &amp;amp; &amp;s; russell&quot;
  u = Text.new( &quot;sean russell&quot;, false, nil, true )
  u.to_s   #-&gt; &quot;sean russell&quot;
</pre>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005662_source')" id="l_M005662_source">show source</a> ]</p>
  <div id="M005662_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/rexml/text.rb, line 137</span>
137:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">to_s</span>
138:       <span class="ruby-keyword kw">return</span> <span class="ruby-ivar">@string</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@raw</span>
139:       <span class="ruby-keyword kw">return</span> <span class="ruby-ivar">@normalized</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@normalized</span>
140: 
141:       <span class="ruby-identifier">doctype</span> = <span class="ruby-keyword kw">nil</span>
142:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@parent</span>
143:         <span class="ruby-identifier">doc</span> = <span class="ruby-ivar">@parent</span>.<span class="ruby-identifier">document</span>
144:         <span class="ruby-identifier">doctype</span> = <span class="ruby-identifier">doc</span>.<span class="ruby-identifier">doctype</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">doc</span>
145:       <span class="ruby-keyword kw">end</span>
146: 
147:       <span class="ruby-ivar">@normalized</span> = <span class="ruby-constant">Text</span><span class="ruby-operator">::</span><span class="ruby-identifier">normalize</span>( <span class="ruby-ivar">@string</span>, <span class="ruby-identifier">doctype</span>, <span class="ruby-ivar">@entity_filter</span> )
148:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005664" class="method">
  <div id="M005664_title" class="title">
    <b>value</b>()
  </div>
  <div class="description">
  <p>
Returns the string value of this text. This is the text without entities,
as it might be used programmatically, or printed to the console. This
ignores the &#8216;raw&#8217; attribute setting, and any entity_filter.
</p>
<pre>
  # Assume that the entity &quot;s&quot; is defined to be &quot;sean&quot;, and that the
  # entity &quot;r&quot; is defined to be &quot;russell&quot;
  t = Text.new( &quot;&lt; &amp; sean russell&quot;, false, nil, false, ['s'] )
  t.value   #-&gt; &quot;&lt; &amp; sean russell&quot;
  t = Text.new( &quot;&lt; &amp; &amp;s; russell&quot;, false, nil, false )
  t.value   #-&gt; &quot;&lt; &amp; sean russell&quot;
  u = Text.new( &quot;sean russell&quot;, false, nil, true )
  u.value   #-&gt; &quot;sean russell&quot;
</pre>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005664_source')" id="l_M005664_source">show source</a> ]</p>
  <div id="M005664_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/rexml/text.rb, line 167</span>
167:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">value</span>
168:       <span class="ruby-ivar">@unnormalized</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@unnormalized</span>
169:       <span class="ruby-identifier">doctype</span> = <span class="ruby-keyword kw">nil</span>
170:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@parent</span>
171:         <span class="ruby-identifier">doc</span> = <span class="ruby-ivar">@parent</span>.<span class="ruby-identifier">document</span>
172:         <span class="ruby-identifier">doctype</span> = <span class="ruby-identifier">doc</span>.<span class="ruby-identifier">doctype</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">doc</span>
173:       <span class="ruby-keyword kw">end</span>
174:       <span class="ruby-ivar">@unnormalized</span> = <span class="ruby-constant">Text</span><span class="ruby-operator">::</span><span class="ruby-identifier">unnormalize</span>( <span class="ruby-ivar">@string</span>, <span class="ruby-identifier">doctype</span> )
175:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005665" class="method">
  <div id="M005665_title" class="title">
    <b>value=</b>( val )
  </div>
  <div class="description">
  <p>
Sets the contents of this text node. This expects the text to be
unnormalized. It returns self.
</p>
<pre>
  e = Element.new( &quot;a&quot; )
  e.add_text( &quot;foo&quot; )   # &lt;a&gt;foo&lt;/a&gt;
  e[0].value = &quot;bar&quot;    # &lt;a&gt;bar&lt;/a&gt;
  e[0].value = &quot;&lt;a&gt;&quot;    # &lt;a&gt;&amp;lt;a&amp;gt;&lt;/a&gt;
</pre>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005665_source')" id="l_M005665_source">show source</a> ]</p>
  <div id="M005665_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/rexml/text.rb, line 184</span>
184:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">value=</span>( <span class="ruby-identifier">val</span> )
185:       <span class="ruby-ivar">@string</span> = <span class="ruby-identifier">val</span>.<span class="ruby-identifier">gsub</span>( <span class="ruby-regexp re">/\r\n?/</span>, <span class="ruby-value str">&quot;\n&quot;</span> )
186:       <span class="ruby-ivar">@unnormalized</span> = <span class="ruby-keyword kw">nil</span>
187:       <span class="ruby-ivar">@normalized</span> = <span class="ruby-keyword kw">nil</span>
188:       <span class="ruby-ivar">@raw</span> = <span class="ruby-keyword kw">false</span>
189:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005666" class="method">
  <div id="M005666_title" class="title">
    <b>wrap</b>(string, width, addnewline=false)
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005666_source')" id="l_M005666_source">show source</a> ]</p>
  <div id="M005666_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/rexml/text.rb, line 191</span>
191:      <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">wrap</span>(<span class="ruby-identifier">string</span>, <span class="ruby-identifier">width</span>, <span class="ruby-identifier">addnewline</span>=<span class="ruby-keyword kw">false</span>)
192:        <span class="ruby-comment cmt"># Recursively wrap string at width.</span>
193:        <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">string</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">string</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-identifier">width</span>
194:        <span class="ruby-identifier">place</span> = <span class="ruby-identifier">string</span>.<span class="ruby-identifier">rindex</span>(<span class="ruby-value str">' '</span>, <span class="ruby-identifier">width</span>) <span class="ruby-comment cmt"># Position in string with last ' ' before cutoff</span>
195:        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">addnewline</span> <span class="ruby-keyword kw">then</span>
196:          <span class="ruby-keyword kw">return</span> <span class="ruby-value str">&quot;\n&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">string</span>[<span class="ruby-value">0</span>,<span class="ruby-identifier">place</span>] <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;\n&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">wrap</span>(<span class="ruby-identifier">string</span>[<span class="ruby-identifier">place</span><span class="ruby-operator">+</span><span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>], <span class="ruby-identifier">width</span>)
197:        <span class="ruby-keyword kw">else</span>
198:          <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">string</span>[<span class="ruby-value">0</span>,<span class="ruby-identifier">place</span>] <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;\n&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">wrap</span>(<span class="ruby-identifier">string</span>[<span class="ruby-identifier">place</span><span class="ruby-operator">+</span><span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>], <span class="ruby-identifier">width</span>)
199:        <span class="ruby-keyword kw">end</span>
200:      <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005668" class="method">
  <div id="M005668_title" class="title">
    <b>write</b>( writer, indent=-1, transitive=false, ie_hack=false )
  </div>
  <div class="description">
  <h2>DEPRECATED</h2>
<p>
See <a
href="index.html?a=C00001084&name=REXML::Formatters">REXML::Formatters</a>
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005668_source')" id="l_M005668_source">show source</a> ]</p>
  <div id="M005668_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/rexml/text.rb, line 217</span>
217:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">write</span>( <span class="ruby-identifier">writer</span>, <span class="ruby-identifier">indent</span>=<span class="ruby-value">-1</span>, <span class="ruby-identifier">transitive</span>=<span class="ruby-keyword kw">false</span>, <span class="ruby-identifier">ie_hack</span>=<span class="ruby-keyword kw">false</span> ) 
218:       <span class="ruby-constant">Kernel</span>.<span class="ruby-identifier">warn</span>(<span class="ruby-node">&quot;#{self.class.name}.write is deprecated.  See REXML::Formatters&quot;</span>)
219:       <span class="ruby-identifier">formatter</span> = <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">indent</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">-1</span>
220:           <span class="ruby-constant">REXML</span><span class="ruby-operator">::</span><span class="ruby-constant">Formatters</span><span class="ruby-operator">::</span><span class="ruby-constant">Pretty</span>.<span class="ruby-identifier">new</span>( <span class="ruby-identifier">indent</span> )
221:         <span class="ruby-keyword kw">else</span>
222:           <span class="ruby-constant">REXML</span><span class="ruby-operator">::</span><span class="ruby-constant">Formatters</span><span class="ruby-operator">::</span><span class="ruby-constant">Default</span>.<span class="ruby-identifier">new</span>
223:         <span class="ruby-keyword kw">end</span>
224:       <span class="ruby-identifier">formatter</span>.<span class="ruby-identifier">write</span>( <span class="ruby-keyword kw">self</span>, <span class="ruby-identifier">writer</span> )
225:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005670" class="method">
  <div id="M005670_title" class="title">
    <b>write_with_substitution</b>(out, input)
  </div>
  <div class="description">
  <p>
Writes out text, substituting special characters beforehand. <tt>out</tt> A
<a href="index.html?a=C00000055&name=String">String</a>, <a
href="index.html?a=C00000245&name=IO">IO</a>, or any other object
supporting &lt;&lt;( <a
href="index.html?a=C00000055&name=String">String</a> ) <tt>input</tt> the
text to substitute and the write out
</p>
<pre>
  z=utf8.unpack(&quot;U*&quot;)
  ascOut=&quot;&quot;
  z.each{|r|
    if r &lt;  0x100
      ascOut.concat(r.chr)
    else
      ascOut.concat(sprintf(&quot;&amp;#x%x;&quot;, r))
    end
  }
  puts ascOut
</pre>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005670_source')" id="l_M005670_source">show source</a> ]</p>
  <div id="M005670_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/rexml/text.rb, line 249</span>
249:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">write_with_substitution</span> <span class="ruby-identifier">out</span>, <span class="ruby-identifier">input</span>
250:       <span class="ruby-identifier">copy</span> = <span class="ruby-identifier">input</span>.<span class="ruby-identifier">clone</span>
251:       <span class="ruby-comment cmt"># Doing it like this rather than in a loop improves the speed</span>
252:       <span class="ruby-identifier">copy</span>.<span class="ruby-identifier">gsub!</span>( <span class="ruby-constant">SPECIALS</span>[<span class="ruby-value">0</span>], <span class="ruby-constant">SUBSTITUTES</span>[<span class="ruby-value">0</span>] )
253:       <span class="ruby-identifier">copy</span>.<span class="ruby-identifier">gsub!</span>( <span class="ruby-constant">SPECIALS</span>[<span class="ruby-value">1</span>], <span class="ruby-constant">SUBSTITUTES</span>[<span class="ruby-value">1</span>] )
254:       <span class="ruby-identifier">copy</span>.<span class="ruby-identifier">gsub!</span>( <span class="ruby-constant">SPECIALS</span>[<span class="ruby-value">2</span>], <span class="ruby-constant">SUBSTITUTES</span>[<span class="ruby-value">2</span>] )
255:       <span class="ruby-identifier">copy</span>.<span class="ruby-identifier">gsub!</span>( <span class="ruby-constant">SPECIALS</span>[<span class="ruby-value">3</span>], <span class="ruby-constant">SUBSTITUTES</span>[<span class="ruby-value">3</span>] )
256:       <span class="ruby-identifier">copy</span>.<span class="ruby-identifier">gsub!</span>( <span class="ruby-constant">SPECIALS</span>[<span class="ruby-value">4</span>], <span class="ruby-constant">SUBSTITUTES</span>[<span class="ruby-value">4</span>] )
257:       <span class="ruby-identifier">copy</span>.<span class="ruby-identifier">gsub!</span>( <span class="ruby-constant">SPECIALS</span>[<span class="ruby-value">5</span>], <span class="ruby-constant">SUBSTITUTES</span>[<span class="ruby-value">5</span>] )
258:       <span class="ruby-identifier">out</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">copy</span>
259:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005669" class="method">
  <div id="M005669_title" class="title">
    <b>xpath</b>()
  </div>
  <div class="description">
  <p>
FIXME This probably won&#8217;t work properly
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005669_source')" id="l_M005669_source">show source</a> ]</p>
  <div id="M005669_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/rexml/text.rb, line 229</span>
229:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">xpath</span>
230:       <span class="ruby-identifier">path</span> = <span class="ruby-ivar">@parent</span>.<span class="ruby-identifier">xpath</span>
231:       <span class="ruby-identifier">path</span> <span class="ruby-operator">+=</span> <span class="ruby-value str">&quot;/text()&quot;</span>
232:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">path</span>
233:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
</div>

  </div>