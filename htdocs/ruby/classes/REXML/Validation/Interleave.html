  <div id="C00001081">
<div class='banner'>
  <span class="file-title-prefix">Class</span><br />Interleave<br/>
  In:
<a href="#" onclick="jsHref('files/ruby-1_8_7-p22/lib/rexml/validation/relaxng_rb.html');">ruby-1.8.7-p22/lib/rexml/validation/relaxng.rb</a>

Parent:&nbsp;
        <a href="#" onclick="jsHref('classes/REXML/Validation/Choice.html');">
Choice
         </a>
</div>
 <!-- banner header -->

  <div id="bodyContent" >
      <div id="content">




  <div class="sectiontitle">Methods</div>
  <ul>
  <li><a href="index.html?a=M005536&name=expected" >expected</a></li>
  <li><a href="index.html?a=M005537&name=inspect" >inspect</a></li>
  <li><a href="index.html?a=M005535&name=matches?" >matches?</a></li>
  <li><a href="index.html?a=M005531&name=new" >new</a></li>
  <li><a href="index.html?a=M005534&name=next" >next</a></li>
  <li><a href="index.html?a=M005533&name=next_current" >next_current</a></li>
  <li><a href="index.html?a=M005532&name=reset" >reset</a></li>
  </ul>






<div class="sectiontitle">Public Class methods</div>
<div id="M005531" class="method">
  <div id="M005531_title" class="title">
    <b>new</b>(context)
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005531_source')" id="l_M005531_source">show source</a> ]</p>
  <div id="M005531_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/rexml/validation/relaxng.rb, line 449</span>
449:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span> <span class="ruby-identifier">context</span>
450:         <span class="ruby-keyword kw">super</span>
451:         <span class="ruby-ivar">@choice</span> = <span class="ruby-value">0</span>
452:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div class="sectiontitle">Public Instance methods</div>
<div id="M005536" class="method">
  <div id="M005536_title" class="title">
    <b>expected</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005536_source')" id="l_M005536_source">show source</a> ]</p>
  <div id="M005536_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/rexml/validation/relaxng.rb, line 529</span>
529:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">expected</span>
530:         <span class="ruby-comment cmt">#puts &quot;IN CHOICE EXPECTED&quot;</span>
531:         <span class="ruby-comment cmt">#puts &quot;EVENTS = #{@events.inspect}&quot;</span>
532:         <span class="ruby-keyword kw">return</span> [<span class="ruby-ivar">@events</span>[<span class="ruby-ivar">@current</span>]] <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@events</span>[<span class="ruby-ivar">@current</span>]
533:         <span class="ruby-keyword kw">return</span> <span class="ruby-ivar">@choices</span>[<span class="ruby-ivar">@choice</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>].<span class="ruby-identifier">collect</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> 
534:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">x</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">kind_of?</span> <span class="ruby-constant">State</span>
535:             <span class="ruby-identifier">x</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">expected</span>
536:           <span class="ruby-keyword kw">else</span>
537:             <span class="ruby-identifier">x</span>[<span class="ruby-value">0</span>]
538:           <span class="ruby-keyword kw">end</span>
539:         <span class="ruby-keyword kw">end</span>.<span class="ruby-identifier">flatten</span>
540:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005537" class="method">
  <div id="M005537_title" class="title">
    <b>inspect</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005537_source')" id="l_M005537_source">show source</a> ]</p>
  <div id="M005537_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/rexml/validation/relaxng.rb, line 542</span>
542:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">inspect</span>
543:         <span class="ruby-node">&quot;&lt; #{to_s} #{@choices.collect{|e| e.collect{|f|f.to_s}.join(', ')}.join(' and ')} &gt;&quot;</span>
544:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005535" class="method">
  <div id="M005535_title" class="title">
    <b>matches?</b>( event )
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005535_source')" id="l_M005535_source">show source</a> ]</p>
  <div id="M005535_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/rexml/validation/relaxng.rb, line 524</span>
524:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">matches?</span>( <span class="ruby-identifier">event</span> )
525:         <span class="ruby-keyword kw">return</span> <span class="ruby-ivar">@events</span>[<span class="ruby-ivar">@current</span>].<span class="ruby-identifier">matches?</span>( <span class="ruby-identifier">event</span> ) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@events</span>[<span class="ruby-ivar">@current</span>]
526:         <span class="ruby-operator">!</span><span class="ruby-ivar">@choices</span>[<span class="ruby-ivar">@choice</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>].<span class="ruby-identifier">find</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">evt</span><span class="ruby-operator">|</span> <span class="ruby-identifier">evt</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">matches?</span>(<span class="ruby-identifier">event</span>)}.<span class="ruby-identifier">nil?</span>
527:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005534" class="method">
  <div id="M005534_title" class="title">
    <b>next</b>( event )
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005534_source')" id="l_M005534_source">show source</a> ]</p>
  <div id="M005534_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/rexml/validation/relaxng.rb, line 488</span>
488:       <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">next</span>( <span class="ruby-identifier">event</span> )
489:         <span class="ruby-comment cmt"># Find the next series</span>
490:         <span class="ruby-identifier">next_current</span>(<span class="ruby-identifier">event</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@events</span>[<span class="ruby-ivar">@current</span>]
491:         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@events</span>[<span class="ruby-ivar">@current</span>]
492: 
493:         <span class="ruby-identifier">expand_ref_in</span>( <span class="ruby-ivar">@events</span>, <span class="ruby-ivar">@current</span> ) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@events</span>[<span class="ruby-ivar">@current</span>].<span class="ruby-identifier">class</span> <span class="ruby-operator">==</span> <span class="ruby-constant">Ref</span> 
494:        <span class="ruby-comment cmt">#puts &quot;In next with #{event.inspect}.&quot;</span>
495:        <span class="ruby-comment cmt">#puts &quot;Next (#@current) is #{@events[@current]}&quot;</span>
496:         <span class="ruby-keyword kw">if</span> ( <span class="ruby-ivar">@events</span>[<span class="ruby-ivar">@current</span>].<span class="ruby-identifier">kind_of?</span> <span class="ruby-constant">State</span> )
497:           <span class="ruby-ivar">@current</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
498:           <span class="ruby-ivar">@events</span>[<span class="ruby-ivar">@current</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>].<span class="ruby-identifier">previous</span> = <span class="ruby-keyword kw">self</span>
499:           <span class="ruby-keyword kw">return</span> <span class="ruby-ivar">@events</span>[<span class="ruby-ivar">@current</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>].<span class="ruby-identifier">next</span>( <span class="ruby-identifier">event</span> )
500:         <span class="ruby-keyword kw">end</span>
501:        <span class="ruby-comment cmt">#puts &quot;Current isn't a state&quot;</span>
502:         <span class="ruby-keyword kw">return</span> <span class="ruby-ivar">@previous</span>.<span class="ruby-identifier">pop</span>.<span class="ruby-identifier">next</span>( <span class="ruby-identifier">event</span> ) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@events</span>[<span class="ruby-ivar">@current</span>].<span class="ruby-identifier">nil?</span>
503:         <span class="ruby-keyword kw">if</span> ( <span class="ruby-ivar">@events</span>[<span class="ruby-ivar">@current</span>].<span class="ruby-identifier">matches?</span>(<span class="ruby-identifier">event</span>) )
504:           <span class="ruby-ivar">@current</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
505:           <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@events</span>[<span class="ruby-ivar">@current</span>].<span class="ruby-identifier">nil?</span>
506:            <span class="ruby-comment cmt">#puts &quot;#{inspect[0,5]} 1RETURNING self&quot; unless @choices[@choice].nil?</span>
507:             <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">self</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@choices</span>[<span class="ruby-ivar">@choice</span>].<span class="ruby-identifier">nil?</span>
508:            <span class="ruby-comment cmt">#puts &quot;#{inspect[0,5]} 1RETURNING #{@previous[-1].inspect[0,5]}&quot;</span>
509:             <span class="ruby-keyword kw">return</span> <span class="ruby-ivar">@previous</span>.<span class="ruby-identifier">pop</span>
510:           <span class="ruby-keyword kw">elsif</span> <span class="ruby-ivar">@events</span>[<span class="ruby-ivar">@current</span>].<span class="ruby-identifier">kind_of?</span> <span class="ruby-constant">State</span>
511:             <span class="ruby-ivar">@current</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
512:            <span class="ruby-comment cmt">#puts &quot;#{inspect[0,5]} 2RETURNING (#{@current-1}) #{@events[@current-1].inspect[0,5]}; on return, next is #{@events[@current]}&quot;</span>
513:             <span class="ruby-ivar">@events</span>[<span class="ruby-ivar">@current</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>].<span class="ruby-identifier">previous</span> = <span class="ruby-keyword kw">self</span>
514:             <span class="ruby-keyword kw">return</span> <span class="ruby-ivar">@events</span>[<span class="ruby-ivar">@current</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>]
515:           <span class="ruby-keyword kw">else</span>
516:            <span class="ruby-comment cmt">#puts &quot;#{inspect[0,5]} RETURNING self w/ next(#@current) = #{@events[@current]}&quot;</span>
517:             <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">self</span>
518:           <span class="ruby-keyword kw">end</span>
519:         <span class="ruby-keyword kw">else</span>
520:           <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span>
521:         <span class="ruby-keyword kw">end</span>
522:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005533" class="method">
  <div id="M005533_title" class="title">
    <b>next_current</b>( event )
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005533_source')" id="l_M005533_source">show source</a> ]</p>
  <div id="M005533_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/rexml/validation/relaxng.rb, line 458</span>
458:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">next_current</span>( <span class="ruby-identifier">event</span> )
459:         <span class="ruby-comment cmt"># Expand references</span>
460:         <span class="ruby-identifier">c</span> = <span class="ruby-value">0</span> ; <span class="ruby-identifier">max</span> = <span class="ruby-ivar">@choices</span>.<span class="ruby-identifier">size</span>
461:         <span class="ruby-keyword kw">while</span> <span class="ruby-identifier">c</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">max</span>
462:           <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@choices</span>[<span class="ruby-identifier">c</span>][<span class="ruby-value">0</span>].<span class="ruby-identifier">class</span> <span class="ruby-operator">==</span> <span class="ruby-constant">Ref</span>
463:             <span class="ruby-identifier">expand_ref_in</span>( <span class="ruby-ivar">@choices</span>[<span class="ruby-identifier">c</span>], <span class="ruby-value">0</span> )
464:             <span class="ruby-ivar">@choices</span> <span class="ruby-operator">+=</span> <span class="ruby-ivar">@choices</span>[<span class="ruby-identifier">c</span>]
465:             <span class="ruby-ivar">@choices</span>.<span class="ruby-identifier">delete</span>( <span class="ruby-ivar">@choices</span>[<span class="ruby-identifier">c</span>] )
466:             <span class="ruby-identifier">max</span> <span class="ruby-operator">-=</span> <span class="ruby-value">1</span>
467:           <span class="ruby-keyword kw">else</span>
468:             <span class="ruby-identifier">c</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
469:           <span class="ruby-keyword kw">end</span>
470:         <span class="ruby-keyword kw">end</span>
471:         <span class="ruby-ivar">@events</span> = <span class="ruby-ivar">@choices</span>[<span class="ruby-ivar">@choice</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>].<span class="ruby-identifier">find</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">evt</span><span class="ruby-operator">|</span> <span class="ruby-identifier">evt</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">matches?</span> <span class="ruby-identifier">event</span> }
472:         <span class="ruby-ivar">@current</span> = <span class="ruby-value">0</span>
473:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@events</span>
474:           <span class="ruby-comment cmt"># reorder the choices</span>
475:           <span class="ruby-identifier">old</span> = <span class="ruby-ivar">@choices</span>[<span class="ruby-ivar">@choice</span>]
476:           <span class="ruby-identifier">idx</span> = <span class="ruby-ivar">@choices</span>.<span class="ruby-identifier">index</span>( <span class="ruby-ivar">@events</span> )
477:           <span class="ruby-ivar">@choices</span>[<span class="ruby-ivar">@choice</span>] = <span class="ruby-ivar">@events</span>
478:           <span class="ruby-ivar">@choices</span>[<span class="ruby-identifier">idx</span>] = <span class="ruby-identifier">old</span>
479:           <span class="ruby-ivar">@choice</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
480:         <span class="ruby-keyword kw">end</span>
481:         
482:        <span class="ruby-comment cmt">#puts &quot;In next with #{event.inspect}.&quot;</span>
483:        <span class="ruby-comment cmt">#puts &quot;events is #{@events.inspect}&quot;</span>
484:         <span class="ruby-ivar">@events</span> = [] <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@events</span>
485:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005532" class="method">
  <div id="M005532_title" class="title">
    <b>reset</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005532_source')" id="l_M005532_source">show source</a> ]</p>
  <div id="M005532_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/rexml/validation/relaxng.rb, line 454</span>
454:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">reset</span>
455:         <span class="ruby-ivar">@choice</span> = <span class="ruby-value">0</span>
456:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
</div>

  </div>