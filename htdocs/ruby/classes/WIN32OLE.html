  <div id="C00000318">
<div class='banner'>
  <span class="file-title-prefix">Class</span><br />WIN32OLE<br/>
  In:
<a href="#" onclick="jsHref('files/ruby-1_8_7-p22/ext/win32ole/win32ole_c.html');">ruby-1.8.7-p22/ext/win32ole/win32ole.c</a>

Parent:&nbsp;
        <a href="#" onclick="jsHref('classes/YAML/Object.html');">
Object
         </a>
</div>
 <!-- banner header -->

  <div id="bodyContent" >
      <div id="content">

  <div class="description"><p>
<tt><a href="index.html?a=C00000318&name=WIN32OLE">WIN32OLE</a></tt>
objects represent OLE Automation object in Ruby.
</p>
</div>



  <div class="sectiontitle">Methods</div>
  <ul>
  <li><a href="index.html?a=M002763&name=[]" >[]</a></li>
  <li><a href="index.html?a=M002767&name=[]=" >[]=</a></li>
  <li><a href="index.html?a=M002765&name=_getproperty" >_getproperty</a></li>
  <li><a href="index.html?a=M002764&name=_invoke" >_invoke</a></li>
  <li><a href="index.html?a=M002766&name=_setproperty" >_setproperty</a></li>
  <li><a href="index.html?a=M002760&name=codepage" >codepage</a></li>
  <li><a href="index.html?a=M002761&name=codepage=" >codepage=</a></li>
  <li><a href="index.html?a=M002755&name=connect" >connect</a></li>
  <li><a href="index.html?a=M002756&name=const_load" >const_load</a></li>
  <li><a href="index.html?a=M002769&name=each" >each</a></li>
  <li><a href="index.html?a=M002762&name=invoke" >invoke</a></li>
  <li><a href="index.html?a=M002770&name=method_missing" >method_missing</a></li>
  <li><a href="index.html?a=M002754&name=new" >new</a></li>
  <li><a href="index.html?a=M002778&name=ole_activex_initialize" >ole_activex_initialize</a></li>
  <li><a href="index.html?a=M002768&name=ole_free" >ole_free</a></li>
  <li><a href="index.html?a=M002757&name=ole_free" >ole_free</a></li>
  <li><a href="index.html?a=M002775&name=ole_func_methods" >ole_func_methods</a></li>
  <li><a href="index.html?a=M002773&name=ole_get_methods" >ole_get_methods</a></li>
  <li><a href="index.html?a=M002776&name=ole_method" >ole_method</a></li>
  <li><a href="index.html?a=M002779&name=ole_method_help" >ole_method_help</a></li>
  <li><a href="index.html?a=M002772&name=ole_methods" >ole_methods</a></li>
  <li><a href="index.html?a=M002777&name=ole_obj_help" >ole_obj_help</a></li>
  <li><a href="index.html?a=M002774&name=ole_put_methods" >ole_put_methods</a></li>
  <li><a href="index.html?a=M002758&name=ole_reference_count" >ole_reference_count</a></li>
  <li><a href="index.html?a=M002759&name=ole_show_help" >ole_show_help</a></li>
  <li><a href="index.html?a=M002771&name=setproperty" >setproperty</a></li>
  </ul>



  <div class="sectiontitle">Classes and Modules</div>
  Module "<a href="#" onclick="jsHref('classes/WIN32OLE/VARIANT.html');" class="link">WIN32OLE::VARIANT</a>"<br />


  <div class="sectiontitle">Constants</div>
  <table border='0' cellpadding='5'>
  <tr valign='top'>
    <td class="attr-name">VERSION</td>
    <td>=</td>
    <td class="attr-value">rb_str_new2(WIN32OLE_VERSION)</td>
  </tr>
  <tr valign='top'>
    <td class="attr-name">ARGV</td>
    <td>=</td>
    <td class="attr-value">rb_ary_new()</td>
  </tr>
  <tr valign='top'>
    <td class="attr-name">CP_THREAD_ACP</td>
    <td>=</td>
    <td class="attr-value">INT2FIX(CP_THREAD_ACP)</td>
  </tr>
  </table>


<div class="sectiontitle">Public Class methods</div>
<div id="M002760" class="method">
  <div id="M002760_title" class="title">
    <b>WIN32OLE.codepage<br />
</b>
  </div>
  <div class="description">
  <p>
Returns current codepage.
</p>
<pre>
   WIN32OLE.codepage # =&gt; WIN32OLE::CP_ACP
</pre>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002760_source')" id="l_M002760_source">show source</a> ]</p>
  <div id="M002760_source" class="dyn-source">
<pre>
/* 
 *  call-seq:
 *     WIN32OLE.codepage
 * 
 *  Returns current codepage.
 *     WIN32OLE.codepage # =&gt; WIN32OLE::CP_ACP
 */
static VALUE
fole_s_get_code_page(self)
    VALUE self;
{
    return INT2FIX(cWIN32OLE_cp);
}
</pre>
  </div>
</div>
</div>
<div id="M002761" class="method">
  <div id="M002761_title" class="title">
    <b>WIN32OLE.codepage = CP<br />
</b>
  </div>
  <div class="description">
  <p>
Sets current codepage.
</p>
<pre>
   WIN32OLE.codepage = WIN32OLE::CP_UTF8
</pre>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002761_source')" id="l_M002761_source">show source</a> ]</p>
  <div id="M002761_source" class="dyn-source">
<pre>
/* 
 *  call-seq:
 *     WIN32OLE.codepage = CP
 * 
 *  Sets current codepage.
 *     WIN32OLE.codepage = WIN32OLE::CP_UTF8
 */
static VALUE
fole_s_set_code_page(self, vcp)
    VALUE self;
    VALUE vcp;
{
    UINT cp = FIX2INT(vcp);

    switch(cp) {
    case CP_ACP:
    case CP_OEMCP:
    case CP_MACCP:
    case CP_THREAD_ACP:
    case CP_SYMBOL:
    case CP_UTF7:
    case CP_UTF8:
        cWIN32OLE_cp = cp;
        break;
    default:
        rb_raise(eWIN32OLE_RUNTIME_ERROR, &quot;codepage should be WIN32OLE::CP_ACP, WIN32OLE::CP_OEMCP, WIN32OLE::CP_MACCP, WIN32OLE::CP_THREAD_ACP, WIN32OLE::CP_SYMBOL, WIN32OLE::CP_UTF7, WIN32OLE::CP_UTF8&quot;);
        break;
    }

    /*
     * Should this method return old codepage?
     */
    return Qnil;
}
</pre>
  </div>
</div>
</div>
<div id="M002755" class="method">
  <div id="M002755_title" class="title">
    <b>WIN32OLE.connect( ole ) -&rarr; aWIN32OLE<br />
</b>
  </div>
  <div class="description">
  <p>
Returns running OLE Automation object or <a
href="index.html?a=C00000318&name=WIN32OLE">WIN32OLE</a> object from
moniker. 1st argument should be OLE program id or class id or moniker.
</p>
<pre>
   WIN32OLE.connect('Excel.Application') # =&gt; WIN32OLE object which represents running Excel.
</pre>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002755_source')" id="l_M002755_source">show source</a> ]</p>
  <div id="M002755_source" class="dyn-source">
<pre>
/*
 *  call-seq:
 *     WIN32OLE.connect( ole ) --&gt; aWIN32OLE
 * 
 *  Returns running OLE Automation object or WIN32OLE object from moniker.
 *  1st argument should be OLE program id or class id or moniker.
 *     
 *     WIN32OLE.connect('Excel.Application') # =&gt; WIN32OLE object which represents running Excel.
 */
static VALUE
fole_s_connect(argc, argv, self)
    int argc;
    VALUE *argv;
    VALUE self;
{
    VALUE svr_name;
    VALUE others;
    HRESULT hr;
    CLSID   clsid;
    OLECHAR *pBuf;
    IDispatch *pDispatch;
    IUnknown *pUnknown;

    rb_secure(4);
    /* initialize to use OLE */
    ole_initialize();

    rb_scan_args(argc, argv, &quot;1*&quot;, &amp;svr_name, &amp;others);
    if (ruby_safe_level &gt; 0 &amp;&amp; OBJ_TAINTED(svr_name)) {
        rb_raise(rb_eSecurityError, &quot;Insecure Object Connection - %s&quot;,
                 StringValuePtr(svr_name));
    }

    /* get CLSID from OLE server name */
    pBuf  = ole_mb2wc(StringValuePtr(svr_name), -1);
    hr = CLSIDFromProgID(pBuf, &amp;clsid);
    if(FAILED(hr)) {
        hr = CLSIDFromString(pBuf, &amp;clsid);
    }
    SysFreeString(pBuf);
    if(FAILED(hr)) {
        return ole_bind_obj(svr_name, argc, argv, self);
    }

    hr = GetActiveObject(&amp;clsid, 0, &amp;pUnknown);
    if (FAILED(hr)) {
        ole_raise(hr, eWIN32OLE_RUNTIME_ERROR, 
                  &quot;OLE server `%s' not running&quot;, StringValuePtr(svr_name));
    }
    hr = pUnknown-&gt;lpVtbl-&gt;QueryInterface(pUnknown, &amp;IID_IDispatch,
                                             (void **)&amp;pDispatch);
    if(FAILED(hr)) {
        OLE_RELEASE(pUnknown);
        ole_raise(hr, eWIN32OLE_RUNTIME_ERROR, 
                  &quot;failed to create WIN32OLE server `%s'&quot;, 
                  StringValuePtr(svr_name));
    }

    OLE_RELEASE(pUnknown);

    return create_win32ole_object(self, pDispatch, argc, argv);
}
</pre>
  </div>
</div>
</div>
<div id="M002756" class="method">
  <div id="M002756_title" class="title">
    <b>WIN32OLE.const_load( ole, mod = WIN32OLE)<br />
</b>
  </div>
  <div class="description">
  <p>
Defines the constants of OLE Automation server as mod&#8217;s constants.
The first argument is <a
href="index.html?a=C00000318&name=WIN32OLE">WIN32OLE</a> object or type
library name. If 2nd argument is omitted, the default is <a
href="index.html?a=C00000318&name=WIN32OLE">WIN32OLE</a>. The first letter
of Ruby&#8217;s constant variable name is upper case, so constant variable
name of <a href="index.html?a=C00000318&name=WIN32OLE">WIN32OLE</a> object
is capitalized. For example, the &#8216;xlTop&#8217; constant of Excel is
changed to &#8216;XlTop&#8217; in <a
href="index.html?a=C00000318&name=WIN32OLE">WIN32OLE</a>. If the first
letter of constant variabl is not [A-Z], then the constant is defined as
CONSTANTS hash element.
</p>
<pre>
   module EXCEL_CONST
   end
   excel = WIN32OLE.new('Excel.Application')
   WIN32OLE.const_load(excel, EXCEL_CONST)
   puts EXCEL_CONST::XlTop # =&gt; -4160
   puts EXCEL_CONST::CONSTANTS['_xlDialogChartSourceData'] # =&gt; 541

   WIN32OLE.const_load(excel)
   puts WIN32OLE::XlTop # =&gt; -4160

   module MSO
   end
   WIN32OLE.const_load('Microsoft Office 9.0 Object Library', MSO)
   puts MSO::MsoLineSingle # =&gt; 1
</pre>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002756_source')" id="l_M002756_source">show source</a> ]</p>
  <div id="M002756_source" class="dyn-source">
<pre>
/* 
 *  call-seq:
 *     WIN32OLE.const_load( ole, mod = WIN32OLE)
 * 
 *  Defines the constants of OLE Automation server as mod's constants.
 *  The first argument is WIN32OLE object or type library name.
 *  If 2nd argument is omitted, the default is WIN32OLE.
 *  The first letter of Ruby's constant variable name is upper case,
 *  so constant variable name of WIN32OLE object is capitalized.
 *  For example, the 'xlTop' constant of Excel is changed to 'XlTop' 
 *  in WIN32OLE.
 *  If the first letter of constant variabl is not [A-Z], then
 *  the constant is defined as CONSTANTS hash element.
 *
 *     module EXCEL_CONST
 *     end
 *     excel = WIN32OLE.new('Excel.Application')
 *     WIN32OLE.const_load(excel, EXCEL_CONST)
 *     puts EXCEL_CONST::XlTop # =&gt; -4160
 *     puts EXCEL_CONST::CONSTANTS['_xlDialogChartSourceData'] # =&gt; 541
 *     
 *     WIN32OLE.const_load(excel)
 *     puts WIN32OLE::XlTop # =&gt; -4160
 *
 *     module MSO
 *     end
 *     WIN32OLE.const_load('Microsoft Office 9.0 Object Library', MSO)
 *     puts MSO::MsoLineSingle # =&gt; 1
 */
static VALUE
fole_s_const_load(argc, argv, self)
    int argc;
    VALUE *argv;
    VALUE self;
{
    VALUE ole;
    VALUE klass;
    struct oledata *pole;
    ITypeInfo *pTypeInfo;
    ITypeLib *pTypeLib;
    unsigned int index;
    HRESULT hr;
    OLECHAR *pBuf;
    VALUE file;
    LCID    lcid = LOCALE_SYSTEM_DEFAULT;
    
    rb_secure(4);
    rb_scan_args(argc, argv, &quot;11&quot;, &amp;ole, &amp;klass);
    if (TYPE(klass) != T_CLASS &amp;&amp;
        TYPE(klass) != T_MODULE &amp;&amp;
        TYPE(klass) != T_NIL) {
        rb_raise(rb_eTypeError, &quot;2nd parameter must be Class or Module&quot;);
    }
    if (rb_obj_is_kind_of(ole, cWIN32OLE)) {
        OLEData_Get_Struct(ole, pole);
        hr = pole-&gt;pDispatch-&gt;lpVtbl-&gt;GetTypeInfo(pole-&gt;pDispatch,
                                                  0, lcid, &amp;pTypeInfo);
        if(FAILED(hr)) {
            ole_raise(hr, rb_eRuntimeError, &quot;failed to GetTypeInfo&quot;);
        }
        hr = pTypeInfo-&gt;lpVtbl-&gt;GetContainingTypeLib(pTypeInfo, &amp;pTypeLib, &amp;index);
        if(FAILED(hr)) {
            OLE_RELEASE(pTypeInfo);
            ole_raise(hr, rb_eRuntimeError, &quot;failed to GetContainingTypeLib&quot;);
        }
        OLE_RELEASE(pTypeInfo);
        if(TYPE(klass) != T_NIL) {
            ole_const_load(pTypeLib, klass, self);
        }
        else {
            ole_const_load(pTypeLib, cWIN32OLE, self);
        }
        OLE_RELEASE(pTypeLib);
    }
    else if(TYPE(ole) == T_STRING) {
        file = typelib_file(ole);
        if (file == Qnil) {
            file = ole;
        }
        pBuf = ole_mb2wc(StringValuePtr(file), -1);
        hr = LoadTypeLibEx(pBuf, REGKIND_NONE, &amp;pTypeLib);
        SysFreeString(pBuf);
        if (FAILED(hr))
            ole_raise(hr, eWIN32OLE_RUNTIME_ERROR, &quot;failed to LoadTypeLibEx&quot;);
        if(TYPE(klass) != T_NIL) {
            ole_const_load(pTypeLib, klass, self);
        }
        else {
            ole_const_load(pTypeLib, cWIN32OLE, self);
        }
        OLE_RELEASE(pTypeLib);
    }
    else {
        rb_raise(rb_eTypeError, &quot;1st parameter must be WIN32OLE instance&quot;);
    }
    return Qnil;
}
</pre>
  </div>
</div>
</div>
<div id="M002754" class="method">
  <div id="M002754_title" class="title">
    <b>WIN32OLE.new(server, [host]) &rarr; WIN32OLE object<br />
</b>
  </div>
  <div class="description">
  <p>
Returns a new <a href="index.html?a=C00000318&name=WIN32OLE">WIN32OLE</a>
object(OLE Automation object). The first argument server specifies OLE
Automation server. The first argument should be CLSID or PROGID. If second
argument host specified, then returns OLE Automation object on host.
</p>
<pre>
    WIN32OLE.new('Excel.Application') # =&gt; Excel OLE Automation WIN32OLE object.
    WIN32OLE.new('{00024500-0000-0000-C000-000000000046}') # =&gt; Excel OLE Automation WIN32OLE object.
</pre>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002754_source')" id="l_M002754_source">show source</a> ]</p>
  <div id="M002754_source" class="dyn-source">
<pre>
/*
 *  call-seq:
 *     WIN32OLE.new(server, [host]) -&gt; WIN32OLE object
 * 
 *  Returns a new WIN32OLE object(OLE Automation object).
 *  The first argument server specifies OLE Automation server.
 *  The first argument should be CLSID or PROGID.
 *  If second argument host specified, then returns OLE Automation 
 *  object on host. 
 *
 *      WIN32OLE.new('Excel.Application') # =&gt; Excel OLE Automation WIN32OLE object.
 *      WIN32OLE.new('{00024500-0000-0000-C000-000000000046}') # =&gt; Excel OLE Automation WIN32OLE object.
 */
static VALUE
fole_initialize(argc, argv, self)
    int argc;
    VALUE *argv;
    VALUE self;
{
    VALUE svr_name;
    VALUE host;
    VALUE others;
    HRESULT hr;
    CLSID   clsid;
    OLECHAR *pBuf;
    IDispatch *pDispatch;

    rb_secure(4);
    rb_call_super(0, 0);
    rb_scan_args(argc, argv, &quot;11*&quot;, &amp;svr_name, &amp;host, &amp;others);

    if (ruby_safe_level &gt; 0 &amp;&amp; OBJ_TAINTED(svr_name)) {
        rb_raise(rb_eSecurityError, &quot;Insecure Object Creation - %s&quot;,
                 StringValuePtr(svr_name));
    }
    if (!NIL_P(host)) {
        if (ruby_safe_level &gt; 0 &amp;&amp; OBJ_TAINTED(host)) {
            rb_raise(rb_eSecurityError, &quot;Insecure Object Creation - %s&quot;,
                     StringValuePtr(svr_name));
        }
        return ole_create_dcom(argc, argv, self);
    }

    /* get CLSID from OLE server name */
    pBuf  = ole_mb2wc(StringValuePtr(svr_name), -1);
    hr = CLSIDFromProgID(pBuf, &amp;clsid);
    if(FAILED(hr)) {
        hr = CLSIDFromString(pBuf, &amp;clsid);
    }
    SysFreeString(pBuf);
    if(FAILED(hr)) {
        ole_raise(hr, eWIN32OLE_RUNTIME_ERROR, 
                  &quot;unknown OLE server: `%s'&quot;,
                  StringValuePtr(svr_name));
    }

    /* get IDispatch interface */
    hr = CoCreateInstance(&amp;clsid, NULL, CLSCTX_INPROC_SERVER | CLSCTX_LOCAL_SERVER,
                          &amp;IID_IDispatch, (void**)&amp;pDispatch);
    if(FAILED(hr)) {
        ole_raise(hr, eWIN32OLE_RUNTIME_ERROR,
                  &quot;failed to create WIN32OLE object from `%s'&quot;,
                  StringValuePtr(svr_name));
    }
    
    ole_set_member(self, pDispatch);
    return self;
}
</pre>
  </div>
</div>
</div>
<div id="M002757" class="method">
  <div id="M002757_title" class="title">
    <b>WIN32OLE.ole_free(aWIN32OLE) -&rarr; number<br />
</b>
  </div>
  <div class="description">
  <p>
Invokes Release method of Dispatch interface of <a
href="index.html?a=C00000318&name=WIN32OLE">WIN32OLE</a> object. You should
not use this method because this method exists only for debugging <a
href="index.html?a=C00000318&name=WIN32OLE">WIN32OLE</a>. The return value
is reference counter of OLE object.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002757_source')" id="l_M002757_source">show source</a> ]</p>
  <div id="M002757_source" class="dyn-source">
<pre>
/*
 *  call-seq:
 *     WIN32OLE.ole_free(aWIN32OLE) --&gt; number
 * 
 *  Invokes Release method of Dispatch interface of WIN32OLE object. 
 *  You should not use this method because this method
 *  exists only for debugging WIN32OLE.
 *  The return value is reference counter of OLE object.
 */
static VALUE
fole_s_free(self, obj)
    VALUE self;
    VALUE obj;
{
    ULONG n = 0;
    struct oledata * pole;
    OLEData_Get_Struct(obj, pole);
    if(pole-&gt;pDispatch) {
        if (reference_count(pole) &gt; 0) {
            n = OLE_RELEASE(pole-&gt;pDispatch);
        }
    }
    return INT2NUM(n);
}
</pre>
  </div>
</div>
</div>
<div id="M002758" class="method">
  <div id="M002758_title" class="title">
    <b>WIN32OLE.ole_reference_count(aWIN32OLE) -&rarr; number<br />
</b>
  </div>
  <div class="description">
  <p>
Returns reference counter of Dispatch interface of <a
href="index.html?a=C00000318&name=WIN32OLE">WIN32OLE</a> object. You should
not use this method because this method exists only for debugging <a
href="index.html?a=C00000318&name=WIN32OLE">WIN32OLE</a>.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002758_source')" id="l_M002758_source">show source</a> ]</p>
  <div id="M002758_source" class="dyn-source">
<pre>
/*
 *  call-seq:
 *     WIN32OLE.ole_reference_count(aWIN32OLE) --&gt; number
 * 
 *  Returns reference counter of Dispatch interface of WIN32OLE object. 
 *  You should not use this method because this method
 *  exists only for debugging WIN32OLE.
 */
static VALUE
fole_s_reference_count(self, obj)
    VALUE self;
    VALUE obj;
{
    struct oledata * pole;
    OLEData_Get_Struct(obj, pole);
    return INT2NUM(reference_count(pole));
}
</pre>
  </div>
</div>
</div>
<div id="M002759" class="method">
  <div id="M002759_title" class="title">
    <b>WIN32OLE.ole_show_help(obj [,helpcontext])<br />
</b>
  </div>
  <div class="description">
  <p>
Displays helpfile. The 1st argument specifies <a
href="index.html?a=C00000220&name=WIN32OLE_TYPE">WIN32OLE_TYPE</a> object
or <a
href="index.html?a=C00000112&name=WIN32OLE_METHOD">WIN32OLE_METHOD</a>
object or helpfile.
</p>
<pre>
   excel = WIN32OLE.new('Excel.Application')
   typeobj = excel.ole_type
   WIN32OLE.ole_show_help(typeobj)
</pre>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002759_source')" id="l_M002759_source">show source</a> ]</p>
  <div id="M002759_source" class="dyn-source">
<pre>
/*
 *  call-seq:
 *     WIN32OLE.ole_show_help(obj [,helpcontext])
 * 
 *  Displays helpfile. The 1st argument specifies WIN32OLE_TYPE
 *  object or WIN32OLE_METHOD object or helpfile.
 *
 *     excel = WIN32OLE.new('Excel.Application')
 *     typeobj = excel.ole_type
 *     WIN32OLE.ole_show_help(typeobj)
 */
static VALUE
fole_s_show_help(argc, argv, self)
    int argc;
    VALUE *argv;
    VALUE self;
{
    VALUE target;
    VALUE helpcontext;
    VALUE helpfile;
    VALUE name;
    HWND  hwnd;
    rb_scan_args(argc, argv, &quot;11&quot;, &amp;target, &amp;helpcontext);
    if (rb_obj_is_kind_of(target, cWIN32OLE_TYPE) ||
        rb_obj_is_kind_of(target, cWIN32OLE_METHOD)) {
        helpfile = rb_funcall(target, rb_intern(&quot;helpfile&quot;), 0);
        if(strlen(StringValuePtr(helpfile)) == 0) {
            name = rb_ivar_get(target, rb_intern(&quot;name&quot;));
            rb_raise(rb_eRuntimeError, &quot;no helpfile of `%s'&quot;,
                     StringValuePtr(name));
        }
        helpcontext = rb_funcall(target, rb_intern(&quot;helpcontext&quot;), 0);
    } else {
        helpfile = target;
    }
    if (TYPE(helpfile) != T_STRING) {
        rb_raise(rb_eTypeError, &quot;1st parameter must be (String|WIN32OLE_TYPE|WIN32OLE_METHOD)&quot;);
    }
    hwnd = ole_show_help(helpfile, helpcontext);
    if(hwnd == 0) {
        rb_raise(rb_eRuntimeError, &quot;failed to open help file `%s'&quot;,
                 StringValuePtr(helpfile));
    }
    return Qnil;
}
</pre>
  </div>
</div>
</div>
<div class="sectiontitle">Public Instance methods</div>
<div id="M002763" class="method">
  <div id="M002763_title" class="title">
    <b>WIN32OLE['property'] <br />
</b>
  </div>
  <div class="description">
  <p>
Returns property of OLE object.
</p>
<pre>
   excel = WIN32OLE.new('Excel.Application')
   puts excel['Visible'] # =&gt; false
</pre>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002763_source')" id="l_M002763_source">show source</a> ]</p>
  <div id="M002763_source" class="dyn-source">
<pre>
/*
 *  call-seq:
 *     WIN32OLE['property'] 
 * 
 *  Returns property of OLE object.
 *
 *     excel = WIN32OLE.new('Excel.Application')
 *     puts excel['Visible'] # =&gt; false
 */
static VALUE
fole_getproperty(argc, argv, self)
    int argc;
    VALUE *argv;
    VALUE self;
{
    return ole_invoke(argc, argv, self, DISPATCH_PROPERTYGET);
}
</pre>
  </div>
</div>
</div>
<div id="M002767" class="method">
  <div id="M002767_title" class="title">
    <b>WIN32OLE['property']=val <br />
WIN32OLE.setproperty('property', [arg1, arg2,...] val)<br />
</b>
  </div>
  <div class="description">
  <p>
Sets property of OLE object. When you want to set property with argument,
you can use this method.
</p>
<pre>
   excel = WIN32OLE.new('Excel.Application')
   excel['Visible'] = true
   book = excel.workbooks.add
   sheet = book.worksheets(1)
   sheet.setproperty('Cells', 1, 2, 10) # =&gt; The B1 cell value is 10.
</pre>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002767_source')" id="l_M002767_source">show source</a> ]</p>
  <div id="M002767_source" class="dyn-source">
<pre>
/*
 *  call-seq:
 *     WIN32OLE['property']=val 
 *     WIN32OLE.setproperty('property', [arg1, arg2,...] val)
 * 
 *  Sets property of OLE object.
 *  When you want to set property with argument, you can use this method.
 *
 *     excel = WIN32OLE.new('Excel.Application')
 *     excel['Visible'] = true
 *     book = excel.workbooks.add
 *     sheet = book.worksheets(1)
 *     sheet.setproperty('Cells', 1, 2, 10) # =&gt; The B1 cell value is 10.
 */
static VALUE
fole_setproperty(argc, argv, self)
    int argc;
    VALUE *argv;
    VALUE self;
{
    return ole_invoke(argc, argv, self, DISPATCH_PROPERTYPUT);
}
</pre>
  </div>
</div>
</div>
<div id="M002765" class="method">
  <div id="M002765_title" class="title">
    <b>WIN32OLE#_getproperty(dispid, args, types)<br />
</b>
  </div>
  <div class="description">
  <p>
Runs the early binding method to get property. The 1st argument specifies
dispatch ID, the 2nd argument specifies the array of arguments, the 3rd
argument specifies the array of the type of arguments.
</p>
<pre>
   excel = WIN32OLE.new('Excel.Application')
   puts excel._getproperty(558, [], []) # same effect as puts excel.visible
</pre>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002765_source')" id="l_M002765_source">show source</a> ]</p>
  <div id="M002765_source" class="dyn-source">
<pre>
/*
 *  call-seq:
 *     WIN32OLE#_getproperty(dispid, args, types)
 * 
 *  Runs the early binding method to get property.
 *  The 1st argument specifies dispatch ID, 
 *  the 2nd argument specifies the array of arguments,
 *  the 3rd argument specifies the array of the type of arguments.
 *
 *     excel = WIN32OLE.new('Excel.Application')
 *     puts excel._getproperty(558, [], []) # same effect as puts excel.visible
 */
static VALUE
fole_getproperty2(self, dispid, args, types)
    VALUE self;
    VALUE dispid;
    VALUE args;
    VALUE types;
{
    return ole_invoke2(self, dispid, args, types, DISPATCH_PROPERTYGET);
}
</pre>
  </div>
</div>
</div>
<div id="M002764" class="method">
  <div id="M002764_title" class="title">
    <b>WIN32OLE#_invoke(dispid, args, types)<br />
</b>
  </div>
  <div class="description">
  <p>
Runs the early binding method. The 1st argument specifies dispatch ID, the
2nd argument specifies the array of arguments, the 3rd argument specifies
the array of the type of arguments.
</p>
<pre>
   excel = WIN32OLE.new('Excel.Application')
   excel._invoke(302, [], []) #  same effect as excel.Quit
</pre>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002764_source')" id="l_M002764_source">show source</a> ]</p>
  <div id="M002764_source" class="dyn-source">
<pre>
/*
 *   call-seq:
 *      WIN32OLE#_invoke(dispid, args, types)
 * 
 *   Runs the early binding method.
 *   The 1st argument specifies dispatch ID, 
 *   the 2nd argument specifies the array of arguments,
 *   the 3rd argument specifies the array of the type of arguments.
 *
 *      excel = WIN32OLE.new('Excel.Application')
 *      excel._invoke(302, [], []) #  same effect as excel.Quit
 */
static VALUE
fole_invoke2(self, dispid, args, types)
    VALUE self;
    VALUE dispid;
    VALUE args;
    VALUE types;
{
    return ole_invoke2(self, dispid, args, types, DISPATCH_METHOD);
}
</pre>
  </div>
</div>
</div>
<div id="M002766" class="method">
  <div id="M002766_title" class="title">
    <b>WIN32OLE#_setproperty(dispid, args, types)<br />
</b>
  </div>
  <div class="description">
  <p>
Runs the early binding method to set property. The 1st argument specifies
dispatch ID, the 2nd argument specifies the array of arguments, the 3rd
argument specifies the array of the type of arguments.
</p>
<pre>
   excel = WIN32OLE.new('Excel.Application')
   excel._setproperty(558, [true], [WIN32OLE::VARIANT::VT_BOOL]) # same effect as excel.visible = true
</pre>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002766_source')" id="l_M002766_source">show source</a> ]</p>
  <div id="M002766_source" class="dyn-source">
<pre>
/*
 *   call-seq:
 *      WIN32OLE#_setproperty(dispid, args, types)
 * 
 *   Runs the early binding method to set property.
 *   The 1st argument specifies dispatch ID, 
 *   the 2nd argument specifies the array of arguments,
 *   the 3rd argument specifies the array of the type of arguments.
 *
 *      excel = WIN32OLE.new('Excel.Application')
 *      excel._setproperty(558, [true], [WIN32OLE::VARIANT::VT_BOOL]) # same effect as excel.visible = true
 */
static VALUE
fole_setproperty2(self, dispid, args, types)
    VALUE self;
    VALUE dispid;
    VALUE args;
    VALUE types;
{
    return ole_invoke2(self, dispid, args, types, DISPATCH_PROPERTYPUT);
}
</pre>
  </div>
</div>
</div>
<div id="M002769" class="method">
  <div id="M002769_title" class="title">
    <b>WIN32OLE#each {|i|...}<br />
</b>
  </div>
  <div class="description">
  <p>
Iterates over each item of OLE collection which has IEnumVARIANT interface.
</p>
<pre>
   excel = WIN32OLE.new('Excel.Application')
   book = excel.workbooks.add
   sheets = book.worksheets(1)
   cells = sheets.cells(&quot;A1:A5&quot;)
   cells.each do |cell|
     cell.value = 10
   end
</pre>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002769_source')" id="l_M002769_source">show source</a> ]</p>
  <div id="M002769_source" class="dyn-source">
<pre>
/*
 *  call-seq:
 *     WIN32OLE#each {|i|...}
 * 
 *  Iterates over each item of OLE collection which has IEnumVARIANT interface.
 *
 *     excel = WIN32OLE.new('Excel.Application')
 *     book = excel.workbooks.add
 *     sheets = book.worksheets(1)
 *     cells = sheets.cells(&quot;A1:A5&quot;)
 *     cells.each do |cell|
 *       cell.value = 10
 *     end
 */
static VALUE
fole_each(self)
    VALUE self;
{
    LCID    lcid = LOCALE_SYSTEM_DEFAULT;

    struct oledata *pole;

    unsigned int argErr;
    EXCEPINFO excepinfo;
    DISPPARAMS dispParams;
    VARIANT result;
    HRESULT hr;
    IEnumVARIANT *pEnum = NULL;

    VariantInit(&amp;result);
    dispParams.rgvarg = NULL;
    dispParams.rgdispidNamedArgs = NULL;
    dispParams.cNamedArgs = 0;
    dispParams.cArgs = 0;
    memset(&amp;excepinfo, 0, sizeof(excepinfo));
    
    OLEData_Get_Struct(self, pole);
    hr = pole-&gt;pDispatch-&gt;lpVtbl-&gt;Invoke(pole-&gt;pDispatch, DISPID_NEWENUM,
                                         &amp;IID_NULL, lcid,
                                         DISPATCH_METHOD | DISPATCH_PROPERTYGET,
                                         &amp;dispParams, &amp;result,
                                         &amp;excepinfo, &amp;argErr);

    if (FAILED(hr)) {
        VariantClear(&amp;result);
        ole_raise(hr, eWIN32OLE_RUNTIME_ERROR, &quot;failed to get IEnum Interface&quot;);
    }

    if (V_VT(&amp;result) == VT_UNKNOWN)
        hr = V_UNKNOWN(&amp;result)-&gt;lpVtbl-&gt;QueryInterface(V_UNKNOWN(&amp;result),
                                                        &amp;IID_IEnumVARIANT,
                                                        (void**)&amp;pEnum);
    else if (V_VT(&amp;result) == VT_DISPATCH)
        hr = V_DISPATCH(&amp;result)-&gt;lpVtbl-&gt;QueryInterface(V_DISPATCH(&amp;result),
                                                         &amp;IID_IEnumVARIANT,
                                                         (void**)&amp;pEnum);
    if (FAILED(hr) || !pEnum) {
        VariantClear(&amp;result);
        ole_raise(hr, rb_eRuntimeError, &quot;failed to get IEnum Interface&quot;);
    }

    VariantClear(&amp;result);
    rb_ensure(ole_each_sub, (VALUE)pEnum, ole_ienum_free, (VALUE)pEnum);
    return Qnil;
}
</pre>
  </div>
</div>
</div>
<div id="M002762" class="method">
  <div id="M002762_title" class="title">
    <b>WIN32OLE#invoke(method, [arg1,...])  => return value of method.<br />
</b>
  </div>
  <div class="description">
  <p>
Runs OLE method. The first argument specifies the method name of OLE
Automation object. The others specify argument of the <em>method</em>. If
you can not execute <em>method</em> directly, then use this method instead.
</p>
<pre>
  excel = WIN32OLE.new('Excel.Application')
  excel.invoke('Quit')  # =&gt; same as excel.Quit
</pre>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002762_source')" id="l_M002762_source">show source</a> ]</p>
  <div id="M002762_source" class="dyn-source">
<pre>
/*
 *  call-seq:
 *     WIN32OLE#invoke(method, [arg1,...])  =&gt; return value of method.
 *
 *  Runs OLE method. 
 *  The first argument specifies the method name of OLE Automation object.
 *  The others specify argument of the &lt;i&gt;method&lt;/i&gt;.
 *  If you can not execute &lt;i&gt;method&lt;/i&gt; directly, then use this method instead.
 *
 *    excel = WIN32OLE.new('Excel.Application')
 *    excel.invoke('Quit')  # =&gt; same as excel.Quit
 *
 */
static VALUE
fole_invoke(argc, argv, self)
    int argc;
    VALUE *argv;
    VALUE self;
{
    return ole_invoke(argc, argv, self, DISPATCH_METHOD|DISPATCH_PROPERTYGET);
}
</pre>
  </div>
</div>
</div>
<div id="M002770" class="method">
  <div id="M002770_title" class="title">
    <b>WIN32OLE#method_missing(id [,arg1, arg2, ...])<br />
</b>
  </div>
  <div class="description">
  <p>
Calls <a
href="index.html?a=M002762&name=WIN32OLE#invoke">WIN32OLE#invoke</a>
method.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002770_source')" id="l_M002770_source">show source</a> ]</p>
  <div id="M002770_source" class="dyn-source">
<pre>
/*
 *  call-seq:
 *     WIN32OLE#method_missing(id [,arg1, arg2, ...])
 * 
 *  Calls WIN32OLE#invoke method.
 */
static VALUE
fole_missing(argc, argv, self)
    int argc;
    VALUE *argv;
    VALUE self;
{
    ID id;
    char* mname;
    int n;
    id = rb_to_id(argv[0]);
    mname = rb_id2name(id);
    if(!mname) {
        rb_raise(rb_eRuntimeError, &quot;fail: unknown method or property&quot;);
    }
    n = strlen(mname);
    if(mname[n-1] == '=') {
        argv[0] = rb_str_new(mname, n-1);

        return ole_propertyput(self, argv[0], argv[1]);
    }
    else {
        argv[0] = rb_str_new2(mname);
        return ole_invoke(argc, argv, self, DISPATCH_METHOD|DISPATCH_PROPERTYGET);
    }
}
</pre>
  </div>
</div>
</div>
<div id="M002778" class="method">
  <div id="M002778_title" class="title">
    <b>WIN32OLE#ole_activex_initialize() &rarr; Qnil<br />
</b>
  </div>
  <div class="description">
  <p>
Initialize <a href="index.html?a=C00000318&name=WIN32OLE">WIN32OLE</a>
object(ActiveX Control) by calling IPersistMemory::InitNew.
</p>
<p>
Before calling OLE method, some kind of the ActiveX controls created with
MFC should be initialized by calling IPersistXXX::InitNew.
</p>
<p>
If and only if you recieved the exception &quot;HRESULT error code:
0x8000ffff catastrophic failure&quot;, try this method before invoking any
<a href="index.html?a=M002776&name=ole_method">ole_method</a>.
</p>
<pre>
   obj = WIN32OLE.new(&quot;ProgID_or_GUID_of_ActiveX_Control&quot;)
   obj.ole_activex_initialize
   obj.method(...)
</pre>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002778_source')" id="l_M002778_source">show source</a> ]</p>
  <div id="M002778_source" class="dyn-source">
<pre>
/*
 *  call-seq:
 *     WIN32OLE#ole_activex_initialize() -&gt; Qnil
 *
 *  Initialize WIN32OLE object(ActiveX Control) by calling 
 *  IPersistMemory::InitNew.
 *
 *  Before calling OLE method, some kind of the ActiveX controls 
 *  created with MFC should be initialized by calling 
 *  IPersistXXX::InitNew.
 *
 *  If and only if you recieved the exception &quot;HRESULT error code:
 *  0x8000ffff catastrophic failure&quot;, try this method before
 *  invoking any ole_method.
 *
 *     obj = WIN32OLE.new(&quot;ProgID_or_GUID_of_ActiveX_Control&quot;)
 *     obj.ole_activex_initialize
 *     obj.method(...)
 *  
 */ 
static VALUE
fole_activex_initialize(self)
    VALUE self; 
{
    struct oledata *pole;
    IPersistMemory *pPersistMemory;

    HRESULT hr = S_OK;

    OLEData_Get_Struct(self, pole);

    hr = pole-&gt;pDispatch-&gt;lpVtbl-&gt;QueryInterface(pole-&gt;pDispatch, &amp;IID_IPersistMemory,
                                                 (void **)&amp;pPersistMemory);
    if (SUCCEEDED(hr)) {
        hr = pPersistMemory-&gt;lpVtbl-&gt;InitNew(pPersistMemory);
        OLE_RELEASE(pPersistMemory);
        if (SUCCEEDED(hr)) {
            return Qnil;
        }
    }

    if (FAILED(hr)) {
        ole_raise(hr, eWIN32OLE_RUNTIME_ERROR, &quot;fail to initialize ActiveX control&quot;);
    }

    return Qnil;
}
</pre>
  </div>
</div>
</div>
<div id="M002768" class="method">
  <div id="M002768_title" class="title">
    <b>WIN32OLE#ole_free<br />
</b>
  </div>
  <div class="description">
  <p>
invokes Release method of Dispatch interface of <a
href="index.html?a=C00000318&name=WIN32OLE">WIN32OLE</a> object. Usually,
you do not need to call this method because Release method called
automatically when <a
href="index.html?a=C00000318&name=WIN32OLE">WIN32OLE</a> object garbaged.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002768_source')" id="l_M002768_source">show source</a> ]</p>
  <div id="M002768_source" class="dyn-source">
<pre>
/*
 *  call-seq:
 *     WIN32OLE#ole_free
 *
 *  invokes Release method of Dispatch interface of WIN32OLE object.
 *  Usually, you do not need to call this method because Release method
 *  called automatically when WIN32OLE object garbaged.
 *
 */
static VALUE
fole_free(self)
    VALUE self;
{
    struct oledata *pole;
    rb_secure(4);
    OLEData_Get_Struct(self, pole);
    OLE_FREE(pole-&gt;pDispatch);
    pole-&gt;pDispatch = NULL;
    return Qnil;
}
</pre>
  </div>
</div>
</div>
<div id="M002775" class="method">
  <div id="M002775_title" class="title">
    <b>WIN32OLE#ole_func_methods<br />
</b>
  </div>
  <div class="description">
  <p>
Returns the array of <a
href="index.html?a=C00000112&name=WIN32OLE_METHOD">WIN32OLE_METHOD</a>
object . The element of the array is functional method of <a
href="index.html?a=C00000318&name=WIN32OLE">WIN32OLE</a> object.
</p>
<pre>
   excel = WIN32OLE.new('Excel.Application')
   properties = excel.ole_func_methods
</pre>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002775_source')" id="l_M002775_source">show source</a> ]</p>
  <div id="M002775_source" class="dyn-source">
<pre>
/*
 *  call-seq:
 *     WIN32OLE#ole_func_methods
 * 
 *  Returns the array of WIN32OLE_METHOD object .
 *  The element of the array is functional method of WIN32OLE object.
 *
 *     excel = WIN32OLE.new('Excel.Application')
 *     properties = excel.ole_func_methods
 *
 */
static VALUE
fole_func_methods( self )
    VALUE self;
{
    return ole_methods( self, INVOKE_FUNC);
}
</pre>
  </div>
</div>
</div>
<div id="M002773" class="method">
  <div id="M002773_title" class="title">
    <b>WIN32OLE#ole_get_methods<br />
</b>
  </div>
  <div class="description">
  <p>
Returns the array of <a
href="index.html?a=C00000112&name=WIN32OLE_METHOD">WIN32OLE_METHOD</a>
object . The element of the array is property (gettable) of <a
href="index.html?a=C00000318&name=WIN32OLE">WIN32OLE</a> object.
</p>
<pre>
   excel = WIN32OLE.new('Excel.Application')
   properties = excel.ole_get_methods
</pre>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002773_source')" id="l_M002773_source">show source</a> ]</p>
  <div id="M002773_source" class="dyn-source">
<pre>
/*
 *  call-seq:
 *     WIN32OLE#ole_get_methods
 * 
 *  Returns the array of WIN32OLE_METHOD object .
 *  The element of the array is property (gettable) of WIN32OLE object.
 *
 *     excel = WIN32OLE.new('Excel.Application')
 *     properties = excel.ole_get_methods
 */
static VALUE
fole_get_methods( self )
    VALUE self;
{
    return ole_methods( self, INVOKE_PROPERTYGET);
}
</pre>
  </div>
</div>
</div>
<div id="M002776" class="method">
  <div id="M002776_title" class="title">
    <b>WIN32OLE#ole_method_help(method)<br />
</b>
  </div>
  <div class="description">
  <p>
Returns <a
href="index.html?a=C00000112&name=WIN32OLE_METHOD">WIN32OLE_METHOD</a>
object corresponding with method specified by 1st argument.
</p>
<pre>
   excel = WIN32OLE.new('Excel.Application')
   method = excel.ole_method_help('Quit')
</pre>
  </div>
<div class="aka">
  This method is also aliased as
  <a href="index.html?a=M002779&name=ole_method_help">ole_method_help</a>
</div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002776_source')" id="l_M002776_source">show source</a> ]</p>
  <div id="M002776_source" class="dyn-source">
<pre>
/*
 *   call-seq:
 *      WIN32OLE#ole_method_help(method)
 * 
 *   Returns WIN32OLE_METHOD object corresponding with method 
 *   specified by 1st argument.
 *
 *      excel = WIN32OLE.new('Excel.Application')
 *      method = excel.ole_method_help('Quit')
 *
 */
static VALUE
fole_method_help( self, cmdname )
    VALUE self;
    VALUE cmdname;
{
    ITypeInfo *pTypeInfo;
    HRESULT hr;
    struct oledata *pole;
    VALUE method, obj;
    LCID    lcid = LOCALE_SYSTEM_DEFAULT;

    Check_SafeStr(cmdname);
    OLEData_Get_Struct(self, pole);
    hr = typeinfo_from_ole(pole, &amp;pTypeInfo);
    if(FAILED(hr))
        ole_raise(hr, rb_eRuntimeError, &quot;failed to get ITypeInfo&quot;);
    method = folemethod_s_allocate(cWIN32OLE_METHOD);
    obj = olemethod_from_typeinfo(method, pTypeInfo, cmdname);
    OLE_RELEASE(pTypeInfo);
    if (obj == Qnil)
        rb_raise(eWIN32OLE_RUNTIME_ERROR, &quot;not found %s&quot;,
                 StringValuePtr(cmdname));
    return obj;
}
</pre>
  </div>
</div>
</div>
<div id="M002779" class="method">
  <div id="M002779_title" class="title">
    <b>ole_method_help</b>(p1)
  </div>
  <div class="description">
  <p>
Alias for <a href="index.html?a=M002776&name=ole_method">ole_method</a>
</p>
  </div>
</div>
<div id="M002772" class="method">
  <div id="M002772_title" class="title">
    <b>WIN32OLE#ole_methods<br />
</b>
  </div>
  <div class="description">
  <p>
Returns the array of <a
href="index.html?a=C00000112&name=WIN32OLE_METHOD">WIN32OLE_METHOD</a>
object. The element is OLE method of <a
href="index.html?a=C00000318&name=WIN32OLE">WIN32OLE</a> object.
</p>
<pre>
   excel = WIN32OLE.new('Excel.Application')
   methods = excel.ole_methods
</pre>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002772_source')" id="l_M002772_source">show source</a> ]</p>
  <div id="M002772_source" class="dyn-source">
<pre>
/*
 *  call-seq:
 *     WIN32OLE#ole_methods
 * 
 *  Returns the array of WIN32OLE_METHOD object. 
 *  The element is OLE method of WIN32OLE object.
 *
 *     excel = WIN32OLE.new('Excel.Application')
 *     methods = excel.ole_methods
 *     
 */
static VALUE
fole_methods( self )
    VALUE self;
{
    return ole_methods( self, INVOKE_FUNC | INVOKE_PROPERTYGET | INVOKE_PROPERTYPUT | INVOKE_PROPERTYPUTREF);
}
</pre>
  </div>
</div>
</div>
<div id="M002777" class="method">
  <div id="M002777_title" class="title">
    <b>WIN32OLE#ole_obj_help<br />
</b>
  </div>
  <div class="description">
  <p>
Returns <a
href="index.html?a=C00000220&name=WIN32OLE_TYPE">WIN32OLE_TYPE</a> object.
</p>
<pre>
   excel = WIN32OLE.new('Excel.Application')
   tobj = excel.ole_obj_help
</pre>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002777_source')" id="l_M002777_source">show source</a> ]</p>
  <div id="M002777_source" class="dyn-source">
<pre>
/*
 *   call-seq:
 *      WIN32OLE#ole_obj_help
 * 
 *   Returns WIN32OLE_TYPE object.
 *
 *      excel = WIN32OLE.new('Excel.Application')
 *      tobj = excel.ole_obj_help
 */
static VALUE
fole_obj_help( self )
    VALUE self;
{
    unsigned int index;
    ITypeInfo *pTypeInfo;
    ITypeLib *pTypeLib;
    HRESULT hr;
    struct oledata *pole;
    BSTR bstr;
    LCID  lcid = LOCALE_SYSTEM_DEFAULT;
    VALUE type = Qnil;

    OLEData_Get_Struct(self, pole);

    hr = pole-&gt;pDispatch-&gt;lpVtbl-&gt;GetTypeInfo( pole-&gt;pDispatch, 0, lcid, &amp;pTypeInfo );
    if(FAILED(hr)) {
        ole_raise(hr, rb_eRuntimeError, &quot;failed to GetTypeInfo&quot;);
    }
    hr = pTypeInfo-&gt;lpVtbl-&gt;GetContainingTypeLib( pTypeInfo, &amp;pTypeLib, &amp;index );
    if(FAILED(hr)) {
        OLE_RELEASE(pTypeInfo);
        ole_raise(hr, rb_eRuntimeError, &quot;failed to GetContainingTypeLib&quot;);
    }
    hr = pTypeLib-&gt;lpVtbl-&gt;GetDocumentation( pTypeLib, index,
                                             &amp;bstr, NULL, NULL, NULL);
    if (SUCCEEDED(hr)) {
        type = foletype_s_allocate(cWIN32OLE_TYPE);
        oletype_set_member(type, pTypeInfo, WC2VSTR(bstr));
    }
    OLE_RELEASE(pTypeLib);
    OLE_RELEASE(pTypeInfo);

    return type;
}
</pre>
  </div>
</div>
</div>
<div id="M002774" class="method">
  <div id="M002774_title" class="title">
    <b>WIN32OLE#ole_put_methods<br />
</b>
  </div>
  <div class="description">
  <p>
Returns the array of <a
href="index.html?a=C00000112&name=WIN32OLE_METHOD">WIN32OLE_METHOD</a>
object . The element of the array is property (settable) of <a
href="index.html?a=C00000318&name=WIN32OLE">WIN32OLE</a> object.
</p>
<pre>
   excel = WIN32OLE.new('Excel.Application')
   properties = excel.ole_put_methods
</pre>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002774_source')" id="l_M002774_source">show source</a> ]</p>
  <div id="M002774_source" class="dyn-source">
<pre>
/*
 *  call-seq:
 *     WIN32OLE#ole_put_methods
 * 
 *  Returns the array of WIN32OLE_METHOD object .
 *  The element of the array is property (settable) of WIN32OLE object.
 *
 *     excel = WIN32OLE.new('Excel.Application')
 *     properties = excel.ole_put_methods
 */
static VALUE
fole_put_methods( self )
    VALUE self;
{
    return ole_methods( self, INVOKE_PROPERTYPUT | INVOKE_PROPERTYPUTREF);
}
</pre>
  </div>
</div>
</div>
<div id="M002771" class="method">
  <div id="M002771_title" class="title">
    <b>WIN32OLE['property']=val <br />
WIN32OLE.setproperty('property', [arg1, arg2,...] val)<br />
</b>
  </div>
  <div class="description">
  <p>
Sets property of OLE object. When you want to set property with argument,
you can use this method.
</p>
<pre>
   excel = WIN32OLE.new('Excel.Application')
   excel['Visible'] = true
   book = excel.workbooks.add
   sheet = book.worksheets(1)
   sheet.setproperty('Cells', 1, 2, 10) # =&gt; The B1 cell value is 10.
</pre>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002771_source')" id="l_M002771_source">show source</a> ]</p>
  <div id="M002771_source" class="dyn-source">
<pre>
/*
 *  call-seq:
 *     WIN32OLE['property']=val 
 *     WIN32OLE.setproperty('property', [arg1, arg2,...] val)
 * 
 *  Sets property of OLE object.
 *  When you want to set property with argument, you can use this method.
 *
 *     excel = WIN32OLE.new('Excel.Application')
 *     excel['Visible'] = true
 *     book = excel.workbooks.add
 *     sheet = book.worksheets(1)
 *     sheet.setproperty('Cells', 1, 2, 10) # =&gt; The B1 cell value is 10.
 */
static VALUE
fole_setproperty(argc, argv, self)
    int argc;
    VALUE *argv;
    VALUE self;
{
    return ole_invoke(argc, argv, self, DISPATCH_PROPERTYPUT);
}
</pre>
  </div>
</div>
</div>
</div>

  </div>