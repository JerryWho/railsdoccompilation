  <div id="C00000335">
<div class='banner'>
  <span class="file-title-prefix">Class</span><br />NotifyTemplateEntry<br/>
  In:
<a href="#" onclick="jsHref('files/ruby-1_8_7-p22/lib/rinda/tuplespace_rb.html');">ruby-1.8.7-p22/lib/rinda/tuplespace.rb</a>

Parent:&nbsp;
        <a href="#" onclick="jsHref('classes/Rinda/TemplateEntry.html');">
TemplateEntry
         </a>
</div>
 <!-- banner header -->

  <div id="bodyContent" >
      <div id="content">

  <div class="description"><p>
A <a
href="index.html?a=C00000335&name=NotifyTemplateEntry">NotifyTemplateEntry</a>
is returned by <a
href="index.html?a=M002924&name=TupleSpace#notify">TupleSpace#notify</a>
and is notified of <a
href="index.html?a=C00000328&name=TupleSpace">TupleSpace</a> changes. You
may receive either your subscribed event or the &#8216;close&#8217; event
when iterating over notifications.
</p>
<p>
See TupleSpace#notify_event for valid notification types.
</p>
<h2>Example</h2>
<pre>
  ts = Rinda::TupleSpace.new
  observer = ts.notify 'write', [nil]

  Thread.start do
    observer.each { |t| p t }
  end

  3.times { |i| ts.write [i] }
</pre>
<p>
Outputs:
</p>
<pre>
  ['write', [0]]
  ['write', [1]]
  ['write', [2]]
</pre>
</div>



  <div class="sectiontitle">Methods</div>
  <ul>
  <li><a href="index.html?a=M002958&name=each" >each</a></li>
  <li><a href="index.html?a=M002955&name=new" >new</a></li>
  <li><a href="index.html?a=M002956&name=notify" >notify</a></li>
  <li><a href="index.html?a=M002957&name=pop" >pop</a></li>
  </ul>






<div class="sectiontitle">Public Class methods</div>
<div id="M002955" class="method">
  <div id="M002955_title" class="title">
    <b>new</b>(place, event, tuple, expires=nil)
  </div>
  <div class="description">
  <p>
Creates a new <a
href="index.html?a=C00000335&name=NotifyTemplateEntry">NotifyTemplateEntry</a>
that watches <tt>place</tt> for +event+s that match <tt>tuple</tt>.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002955_source')" id="l_M002955_source">show source</a> ]</p>
  <div id="M002955_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/rinda/tuplespace.rb, line 246</span>
246:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">place</span>, <span class="ruby-identifier">event</span>, <span class="ruby-identifier">tuple</span>, <span class="ruby-identifier">expires</span>=<span class="ruby-keyword kw">nil</span>)
247:       <span class="ruby-identifier">ary</span> = [<span class="ruby-identifier">event</span>, <span class="ruby-constant">Rinda</span><span class="ruby-operator">::</span><span class="ruby-constant">Template</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">tuple</span>)]
248:       <span class="ruby-keyword kw">super</span>(<span class="ruby-identifier">ary</span>, <span class="ruby-identifier">expires</span>)
249:       <span class="ruby-ivar">@queue</span> = <span class="ruby-constant">Queue</span>.<span class="ruby-identifier">new</span>
250:       <span class="ruby-ivar">@done</span> = <span class="ruby-keyword kw">false</span>
251:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div class="sectiontitle">Public Instance methods</div>
<div id="M002958" class="method">
  <div id="M002958_title" class="title">
    <b>each</b>( {|event, tuple| ...}
  </div>
  <div class="description">
  <p>
Yields event/tuple pairs until this <a
href="index.html?a=C00000335&name=NotifyTemplateEntry">NotifyTemplateEntry</a>
expires.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002958_source')" id="l_M002958_source">show source</a> ]</p>
  <div id="M002958_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/rinda/tuplespace.rb, line 274</span>
274:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">each</span> <span class="ruby-comment cmt"># :yields: event, tuple</span>
275:       <span class="ruby-keyword kw">while</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@done</span>
276:         <span class="ruby-identifier">it</span> = <span class="ruby-identifier">pop</span>
277:         <span class="ruby-keyword kw">yield</span>(<span class="ruby-identifier">it</span>)
278:       <span class="ruby-keyword kw">end</span>
279:     <span class="ruby-keyword kw">rescue</span> 
280:     <span class="ruby-keyword kw">ensure</span>
281:       <span class="ruby-identifier">cancel</span>
282:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002956" class="method">
  <div id="M002956_title" class="title">
    <b>notify</b>(ev)
  </div>
  <div class="description">
  <p>
Called by <a href="index.html?a=C00000328&name=TupleSpace">TupleSpace</a>
to notify this <a
href="index.html?a=C00000335&name=NotifyTemplateEntry">NotifyTemplateEntry</a>
of a new event.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002956_source')" id="l_M002956_source">show source</a> ]</p>
  <div id="M002956_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/rinda/tuplespace.rb, line 256</span>
256:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">notify</span>(<span class="ruby-identifier">ev</span>)
257:       <span class="ruby-ivar">@queue</span>.<span class="ruby-identifier">push</span>(<span class="ruby-identifier">ev</span>)
258:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M002957" class="method">
  <div id="M002957_title" class="title">
    <b>pop</b>()
  </div>
  <div class="description">
  <p>
Retrieves a notification. Raises <a
href="index.html?a=C00000326&name=RequestExpiredError">RequestExpiredError</a>
when this <a
href="index.html?a=C00000335&name=NotifyTemplateEntry">NotifyTemplateEntry</a>
expires.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M002957_source')" id="l_M002957_source">show source</a> ]</p>
  <div id="M002957_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/rinda/tuplespace.rb, line 264</span>
264:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">pop</span>
265:       <span class="ruby-identifier">raise</span> <span class="ruby-constant">RequestExpiredError</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@done</span>
266:       <span class="ruby-identifier">it</span> = <span class="ruby-ivar">@queue</span>.<span class="ruby-identifier">pop</span>
267:       <span class="ruby-ivar">@done</span> = <span class="ruby-keyword kw">true</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">it</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">'close'</span>
268:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">it</span>
269:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
</div>

  </div>