  <div id="C00000206">
<div class='banner'>
  <span class="file-title-prefix">Class</span><br />TestWin32OLE_WITH_MSI<br/>
  In:
<a href="#" onclick="jsHref('files/ruby-1_8_7-p22/ext/win32ole/tests/testWIN32OLE_rb.html');">ruby-1.8.7-p22/ext/win32ole/tests/testWIN32OLE.rb</a>

Parent:&nbsp;
RUNIT::TestCase
</div>
 <!-- banner header -->

  <div id="bodyContent" >
      <div id="content">




  <div class="sectiontitle">Methods</div>
  <ul>
  <li><a href="index.html?a=M001694&name=setup" >setup</a></li>
  <li><a href="index.html?a=M001697&name=test__invoke" >test__invoke</a></li>
  <li><a href="index.html?a=M001696&name=test_bracket_equal_with_arg" >test_bracket_equal_with_arg</a></li>
  <li><a href="index.html?a=M001695&name=test_setproperty" >test_setproperty</a></li>
  </ul>






<div class="sectiontitle">Public Instance methods</div>
<div id="M001694" class="method">
  <div id="M001694_title" class="title">
    <b>setup</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001694_source')" id="l_M001694_source">show source</a> ]</p>
  <div id="M001694_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/ext/win32ole/tests/testWIN32OLE.rb, line 286</span>
286:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">setup</span>
287:     <span class="ruby-identifier">installer</span> = <span class="ruby-constant">WIN32OLE</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;WindowsInstaller.Installer&quot;</span>)
288:     <span class="ruby-ivar">@record</span> = <span class="ruby-identifier">installer</span>.<span class="ruby-constant">CreateRecord</span>(<span class="ruby-value">2</span>)
289:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001697" class="method">
  <div id="M001697_title" class="title">
    <b>test__invoke</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001697_source')" id="l_M001697_source">show source</a> ]</p>
  <div id="M001697_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/ext/win32ole/tests/testWIN32OLE.rb, line 308</span>
308:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test__invoke</span>
309:     <span class="ruby-identifier">shell</span>=<span class="ruby-constant">WIN32OLE</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">'Shell.Application'</span>)
310:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-identifier">shell</span>.<span class="ruby-constant">NameSpace</span>(<span class="ruby-value">0</span>).<span class="ruby-identifier">title</span>, <span class="ruby-identifier">shell</span>.<span class="ruby-identifier">_invoke</span>(<span class="ruby-value">0x60020002</span>, [<span class="ruby-value">0</span>], [<span class="ruby-constant">WIN32OLE</span><span class="ruby-operator">::</span><span class="ruby-constant">VARIANT</span><span class="ruby-operator">::</span><span class="ruby-constant">VT_VARIANT</span>]).<span class="ruby-identifier">title</span>)
311:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001696" class="method">
  <div id="M001696_title" class="title">
    <b>test_bracket_equal_with_arg</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001696_source')" id="l_M001696_source">show source</a> ]</p>
  <div id="M001696_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/ext/win32ole/tests/testWIN32OLE.rb, line 303</span>
303:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_bracket_equal_with_arg</span>
304:     <span class="ruby-ivar">@record</span>[ <span class="ruby-value str">&quot;StringData&quot;</span>, <span class="ruby-value">1</span> ] =  <span class="ruby-value str">'ffff'</span>
305:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">'ffff'</span>, <span class="ruby-ivar">@record</span>.<span class="ruby-constant">StringData</span>(<span class="ruby-value">1</span>))
306:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001695" class="method">
  <div id="M001695_title" class="title">
    <b>test_setproperty</b>()
  </div>
  <div class="description">
  <p>
Sorry, this test fails. Win32OLE does not support this style to set
property. Use Win32OLE#setproperty or Win32OLE#[]= . def test_invoke
</p>
<pre>
  @record.invoke(&quot;StringData&quot;, 1, 'cccc')
  assert_equal('cccc', @record.StringData(1))
</pre>
<p>
end
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001695_source')" id="l_M001695_source">show source</a> ]</p>
  <div id="M001695_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/ext/win32ole/tests/testWIN32OLE.rb, line 299</span>
299:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_setproperty</span>
300:     <span class="ruby-ivar">@record</span>.<span class="ruby-identifier">setproperty</span>( <span class="ruby-value str">&quot;StringData&quot;</span>, <span class="ruby-value">1</span>, <span class="ruby-value str">'dddd'</span>)
301:     <span class="ruby-identifier">assert_equal</span>(<span class="ruby-value str">'dddd'</span>, <span class="ruby-ivar">@record</span>.<span class="ruby-constant">StringData</span>(<span class="ruby-value">1</span>))
302:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
</div>

  </div>