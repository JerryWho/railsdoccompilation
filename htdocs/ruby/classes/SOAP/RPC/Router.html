  <div id="C00001238">
<div class='banner'>
  <span class="file-title-prefix">Class</span><br />Router<br/>
  In:
<a href="#" onclick="jsHref('files/ruby-1_8_7-p22/lib/soap/rpc/router_rb.html');">ruby-1.8.7-p22/lib/soap/rpc/router.rb</a>

Parent:&nbsp;
        <a href="#" onclick="jsHref('classes/YAML/Object.html');">
Object
         </a>
</div>
 <!-- banner header -->

  <div id="bodyContent" >
      <div id="content">




  <div class="sectiontitle">Methods</div>
  <ul>
  <li><a href="index.html?a=M006554&name=add_document_method" >add_document_method</a></li>
  <li><a href="index.html?a=M006553&name=add_document_operation" >add_document_operation</a></li>
  <li><a href="index.html?a=M006555&name=add_document_request_operation" >add_document_request_operation</a></li>
  <li><a href="index.html?a=M006545&name=add_headerhandler" >add_headerhandler</a></li>
  <li><a href="index.html?a=M006550&name=add_method" >add_method</a></li>
  <li><a href="index.html?a=M006544&name=add_request_headerhandler" >add_request_headerhandler</a></li>
  <li><a href="index.html?a=M006551&name=add_rpc_method" >add_rpc_method</a></li>
  <li><a href="index.html?a=M006549&name=add_rpc_operation" >add_rpc_operation</a></li>
  <li><a href="index.html?a=M006552&name=add_rpc_request_operation" >add_rpc_request_operation</a></li>
  <li><a href="index.html?a=M006546&name=add_rpc_request_servant" >add_rpc_request_servant</a></li>
  <li><a href="index.html?a=M006547&name=add_rpc_servant" >add_rpc_servant</a></li>
  <li><a href="index.html?a=M006548&name=add_servant" >add_servant</a></li>
  <li><a href="index.html?a=M006557&name=create_fault_response" >create_fault_response</a></li>
  <li><a href="index.html?a=M006543&name=new" >new</a></li>
  <li><a href="index.html?a=M006556&name=route" >route</a></li>
  </ul>

<div class="sectiontitle">Included Modules</div>
<ul>
  <li><a href="#" onclick="jsHref('classes/SOAP.html');">SOAP</a></li>
</ul>


  <div class="sectiontitle">Classes and Modules</div>
  Class "<a href="#" onclick="jsHref('classes/SOAP/RPC/Router/ApplicationScopeOperation.html');" class="link">SOAP::RPC::Router::ApplicationScopeOperation</a>"<br />
Class "<a href="#" onclick="jsHref('classes/SOAP/RPC/Router/Operation.html');" class="link">SOAP::RPC::Router::Operation</a>"<br />
Class "<a href="#" onclick="jsHref('classes/SOAP/RPC/Router/RequestScopeOperation.html');" class="link">SOAP::RPC::Router::RequestScopeOperation</a>"<br />



  <div class="sectiontitle">Attributes</div>
  <table border='0' cellpadding='5'>
  <tr valign='top'>
    <td class='attr-rw'>
[R]
    </td>
    <td class='attr-name'>actor</td>
    <td class='attr-desc'></td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[RW]
    </td>
    <td class='attr-name'>external_ces</td>
    <td class='attr-desc'></td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[RW]
    </td>
    <td class='attr-name'>generate_explicit_type</td>
    <td class='attr-desc'></td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[RW]
    </td>
    <td class='attr-name'>literal_mapping_registry</td>
    <td class='attr-desc'></td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[RW]
    </td>
    <td class='attr-name'>mapping_registry</td>
    <td class='attr-desc'></td>
  </tr>
  </table>

<div class="sectiontitle">Public Class methods</div>
<div id="M006543" class="method">
  <div id="M006543_title" class="title">
    <b>new</b>(actor)
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006543_source')" id="l_M006543_source">show source</a> ]</p>
  <div id="M006543_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/soap/rpc/router.rb, line 33</span>
33:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">actor</span>)
34:     <span class="ruby-ivar">@actor</span> = <span class="ruby-identifier">actor</span>
35:     <span class="ruby-ivar">@mapping_registry</span> = <span class="ruby-keyword kw">nil</span>
36:     <span class="ruby-ivar">@headerhandler</span> = <span class="ruby-constant">Header</span><span class="ruby-operator">::</span><span class="ruby-constant">HandlerSet</span>.<span class="ruby-identifier">new</span>
37:     <span class="ruby-ivar">@literal_mapping_registry</span> = <span class="ruby-operator">::</span><span class="ruby-constant">SOAP</span><span class="ruby-operator">::</span><span class="ruby-constant">Mapping</span><span class="ruby-operator">::</span><span class="ruby-constant">WSDLLiteralRegistry</span>.<span class="ruby-identifier">new</span>
38:     <span class="ruby-ivar">@generate_explicit_type</span> = <span class="ruby-keyword kw">true</span>
39:     <span class="ruby-ivar">@external_ces</span> = <span class="ruby-keyword kw">nil</span>
40:     <span class="ruby-ivar">@operation_by_soapaction</span> = {}
41:     <span class="ruby-ivar">@operation_by_qname</span> = {}
42:     <span class="ruby-ivar">@headerhandlerfactory</span> = []
43:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div class="sectiontitle">Public Instance methods</div>
<div id="M006554" class="method">
  <div id="M006554_title" class="title">
    <b>add_document_method</b>(receiver, soapaction, name, param_def, opt = {})
  </div>
  <div class="description">
  <p>
Alias for <a
href="index.html?a=M006553&name=add_document_operation">add_document_operation</a>
</p>
  </div>
</div>
<div id="M006553" class="method">
  <div id="M006553_title" class="title">
    <b>add_document_operation</b>(receiver, soapaction, name, param_def, opt = {})
  </div>
<div class="aka">
  This method is also aliased as
  <a href="index.html?a=M006554&name=add_document_method">add_document_method</a>
</div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006553_source')" id="l_M006553_source">show source</a> ]</p>
  <div id="M006553_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/soap/rpc/router.rb, line 119</span>
119:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">add_document_operation</span>(<span class="ruby-identifier">receiver</span>, <span class="ruby-identifier">soapaction</span>, <span class="ruby-identifier">name</span>, <span class="ruby-identifier">param_def</span>, <span class="ruby-identifier">opt</span> = {})
120:     <span class="ruby-comment cmt">#</span>
121:     <span class="ruby-comment cmt"># adopt workaround for doc/lit wrapper method</span>
122:     <span class="ruby-comment cmt"># (you should consider to simply use rpc/lit service)</span>
123:     <span class="ruby-comment cmt">#</span>
124:     <span class="ruby-comment cmt">#unless soapaction</span>
125:     <span class="ruby-comment cmt">#  raise RPCRoutingError.new(&quot;soapaction is a must for document method&quot;)</span>
126:     <span class="ruby-comment cmt">#end</span>
127:     <span class="ruby-identifier">ensure_styleuse_option</span>(<span class="ruby-identifier">opt</span>, <span class="ruby-identifier">:document</span>, <span class="ruby-identifier">:literal</span>)
128:     <span class="ruby-identifier">op</span> = <span class="ruby-constant">ApplicationScopeOperation</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">soapaction</span>, <span class="ruby-identifier">receiver</span>, <span class="ruby-identifier">name</span>, <span class="ruby-identifier">param_def</span>,
129:       <span class="ruby-identifier">opt</span>)
130:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">opt</span>[<span class="ruby-identifier">:request_style</span>] <span class="ruby-operator">!=</span> <span class="ruby-identifier">:document</span>
131:       <span class="ruby-identifier">raise</span> <span class="ruby-constant">RPCRoutingError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;illegal request_style given&quot;</span>)
132:     <span class="ruby-keyword kw">end</span>
133:     <span class="ruby-identifier">assign_operation</span>(<span class="ruby-identifier">soapaction</span>, <span class="ruby-identifier">first_input_part_qname</span>(<span class="ruby-identifier">param_def</span>), <span class="ruby-identifier">op</span>)
134:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006555" class="method">
  <div id="M006555_title" class="title">
    <b>add_document_request_operation</b>(factory, soapaction, name, param_def, opt = {})
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006555_source')" id="l_M006555_source">show source</a> ]</p>
  <div id="M006555_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/soap/rpc/router.rb, line 137</span>
137:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">add_document_request_operation</span>(<span class="ruby-identifier">factory</span>, <span class="ruby-identifier">soapaction</span>, <span class="ruby-identifier">name</span>, <span class="ruby-identifier">param_def</span>, <span class="ruby-identifier">opt</span> = {})
138:     <span class="ruby-comment cmt">#</span>
139:     <span class="ruby-comment cmt"># adopt workaround for doc/lit wrapper method</span>
140:     <span class="ruby-comment cmt"># (you should consider to simply use rpc/lit service)</span>
141:     <span class="ruby-comment cmt">#</span>
142:     <span class="ruby-comment cmt">#unless soapaction</span>
143:     <span class="ruby-comment cmt">#  raise RPCRoutingError.new(&quot;soapaction is a must for document method&quot;)</span>
144:     <span class="ruby-comment cmt">#end</span>
145:     <span class="ruby-identifier">ensure_styleuse_option</span>(<span class="ruby-identifier">opt</span>, <span class="ruby-identifier">:document</span>, <span class="ruby-identifier">:literal</span>)
146:     <span class="ruby-identifier">op</span> = <span class="ruby-constant">RequestScopeOperation</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">soapaction</span>, <span class="ruby-identifier">receiver</span>, <span class="ruby-identifier">name</span>, <span class="ruby-identifier">param_def</span>, <span class="ruby-identifier">opt</span>)
147:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">opt</span>[<span class="ruby-identifier">:request_style</span>] <span class="ruby-operator">!=</span> <span class="ruby-identifier">:document</span>
148:       <span class="ruby-identifier">raise</span> <span class="ruby-constant">RPCRoutingError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;illegal request_style given&quot;</span>)
149:     <span class="ruby-keyword kw">end</span>
150:     <span class="ruby-identifier">assign_operation</span>(<span class="ruby-identifier">soapaction</span>, <span class="ruby-identifier">first_input_part_qname</span>(<span class="ruby-identifier">param_def</span>), <span class="ruby-identifier">op</span>)
151:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006545" class="method">
  <div id="M006545_title" class="title">
    <b>add_headerhandler</b>(handler)
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006545_source')" id="l_M006545_source">show source</a> ]</p>
  <div id="M006545_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/soap/rpc/router.rb, line 55</span>
55:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">add_headerhandler</span>(<span class="ruby-identifier">handler</span>)
56:     <span class="ruby-ivar">@headerhandler</span>.<span class="ruby-identifier">add</span>(<span class="ruby-identifier">handler</span>)
57:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006550" class="method">
  <div id="M006550_title" class="title">
    <b>add_method</b>(receiver, qname, soapaction, name, param_def, opt = {})
  </div>
  <div class="description">
  <p>
Alias for <a
href="index.html?a=M006549&name=add_rpc_operation">add_rpc_operation</a>
</p>
  </div>
</div>
<div id="M006544" class="method">
  <div id="M006544_title" class="title">
    <b>add_request_headerhandler</b>(factory)
  </div>
  <div class="description">
  <p>
header handler interface
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006544_source')" id="l_M006544_source">show source</a> ]</p>
  <div id="M006544_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/soap/rpc/router.rb, line 48</span>
48:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">add_request_headerhandler</span>(<span class="ruby-identifier">factory</span>)
49:     <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">factory</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:create</span>)
50:       <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;factory must respond to 'create'&quot;</span>)
51:     <span class="ruby-keyword kw">end</span>
52:     <span class="ruby-ivar">@headerhandlerfactory</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">factory</span>
53:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006551" class="method">
  <div id="M006551_title" class="title">
    <b>add_rpc_method</b>(receiver, qname, soapaction, name, param_def, opt = {})
  </div>
  <div class="description">
  <p>
Alias for <a
href="index.html?a=M006549&name=add_rpc_operation">add_rpc_operation</a>
</p>
  </div>
</div>
<div id="M006549" class="method">
  <div id="M006549_title" class="title">
    <b>add_rpc_operation</b>(receiver, qname, soapaction, name, param_def, opt = {})
  </div>
  <div class="description">
  <p>
operation definition interface
</p>
  </div>
<div class="aka">
  This method is also aliased as
  <a href="index.html?a=M006550&name=add_method">add_method</a>
  <a href="index.html?a=M006551&name=add_rpc_method">add_rpc_method</a>
</div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006549_source')" id="l_M006549_source">show source</a> ]</p>
  <div id="M006549_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/soap/rpc/router.rb, line 96</span>
 96:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">add_rpc_operation</span>(<span class="ruby-identifier">receiver</span>, <span class="ruby-identifier">qname</span>, <span class="ruby-identifier">soapaction</span>, <span class="ruby-identifier">name</span>, <span class="ruby-identifier">param_def</span>, <span class="ruby-identifier">opt</span> = {})
 97:     <span class="ruby-identifier">ensure_styleuse_option</span>(<span class="ruby-identifier">opt</span>, <span class="ruby-identifier">:rpc</span>, <span class="ruby-identifier">:encoded</span>)
 98:     <span class="ruby-identifier">opt</span>[<span class="ruby-identifier">:request_qname</span>] = <span class="ruby-identifier">qname</span>
 99:     <span class="ruby-identifier">op</span> = <span class="ruby-constant">ApplicationScopeOperation</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">soapaction</span>, <span class="ruby-identifier">receiver</span>, <span class="ruby-identifier">name</span>, <span class="ruby-identifier">param_def</span>,
100:       <span class="ruby-identifier">opt</span>)
101:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">opt</span>[<span class="ruby-identifier">:request_style</span>] <span class="ruby-operator">!=</span> <span class="ruby-identifier">:rpc</span>
102:       <span class="ruby-identifier">raise</span> <span class="ruby-constant">RPCRoutingError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;illegal request_style given&quot;</span>)
103:     <span class="ruby-keyword kw">end</span>
104:     <span class="ruby-identifier">assign_operation</span>(<span class="ruby-identifier">soapaction</span>, <span class="ruby-identifier">qname</span>, <span class="ruby-identifier">op</span>)
105:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006552" class="method">
  <div id="M006552_title" class="title">
    <b>add_rpc_request_operation</b>(factory, qname, soapaction, name, param_def, opt = {})
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006552_source')" id="l_M006552_source">show source</a> ]</p>
  <div id="M006552_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/soap/rpc/router.rb, line 109</span>
109:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">add_rpc_request_operation</span>(<span class="ruby-identifier">factory</span>, <span class="ruby-identifier">qname</span>, <span class="ruby-identifier">soapaction</span>, <span class="ruby-identifier">name</span>, <span class="ruby-identifier">param_def</span>, <span class="ruby-identifier">opt</span> = {})
110:     <span class="ruby-identifier">ensure_styleuse_option</span>(<span class="ruby-identifier">opt</span>, <span class="ruby-identifier">:rpc</span>, <span class="ruby-identifier">:encoded</span>)
111:     <span class="ruby-identifier">opt</span>[<span class="ruby-identifier">:request_qname</span>] = <span class="ruby-identifier">qname</span>
112:     <span class="ruby-identifier">op</span> = <span class="ruby-constant">RequestScopeOperation</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">soapaction</span>, <span class="ruby-identifier">factory</span>, <span class="ruby-identifier">name</span>, <span class="ruby-identifier">param_def</span>, <span class="ruby-identifier">opt</span>)
113:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">opt</span>[<span class="ruby-identifier">:request_style</span>] <span class="ruby-operator">!=</span> <span class="ruby-identifier">:rpc</span>
114:       <span class="ruby-identifier">raise</span> <span class="ruby-constant">RPCRoutingError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;illegal request_style given&quot;</span>)
115:     <span class="ruby-keyword kw">end</span>
116:     <span class="ruby-identifier">assign_operation</span>(<span class="ruby-identifier">soapaction</span>, <span class="ruby-identifier">qname</span>, <span class="ruby-identifier">op</span>)
117:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006546" class="method">
  <div id="M006546_title" class="title">
    <b>add_rpc_request_servant</b>(factory, namespace)
  </div>
  <div class="description">
  <p>
servant definition interface
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006546_source')" id="l_M006546_source">show source</a> ]</p>
  <div id="M006546_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/soap/rpc/router.rb, line 62</span>
62:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">add_rpc_request_servant</span>(<span class="ruby-identifier">factory</span>, <span class="ruby-identifier">namespace</span>)
63:     <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">factory</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:create</span>)
64:       <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;factory must respond to 'create'&quot;</span>)
65:     <span class="ruby-keyword kw">end</span>
66:     <span class="ruby-identifier">obj</span> = <span class="ruby-identifier">factory</span>.<span class="ruby-identifier">create</span>        <span class="ruby-comment cmt"># a dummy instance for introspection</span>
67:     <span class="ruby-operator">::</span><span class="ruby-constant">SOAP</span><span class="ruby-operator">::</span><span class="ruby-constant">RPC</span>.<span class="ruby-identifier">defined_methods</span>(<span class="ruby-identifier">obj</span>).<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">name</span><span class="ruby-operator">|</span>
68:       <span class="ruby-keyword kw">begin</span>
69:         <span class="ruby-identifier">qname</span> = <span class="ruby-constant">XSD</span><span class="ruby-operator">::</span><span class="ruby-constant">QName</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">namespace</span>, <span class="ruby-identifier">name</span>)
70:         <span class="ruby-identifier">param_def</span> = <span class="ruby-operator">::</span><span class="ruby-constant">SOAP</span><span class="ruby-operator">::</span><span class="ruby-constant">RPC</span><span class="ruby-operator">::</span><span class="ruby-constant">SOAPMethod</span>.<span class="ruby-identifier">derive_rpc_param_def</span>(<span class="ruby-identifier">obj</span>, <span class="ruby-identifier">name</span>)
71:         <span class="ruby-identifier">opt</span> = <span class="ruby-identifier">create_styleuse_option</span>(<span class="ruby-identifier">:rpc</span>, <span class="ruby-identifier">:encoded</span>)
72:         <span class="ruby-identifier">add_rpc_request_operation</span>(<span class="ruby-identifier">factory</span>, <span class="ruby-identifier">qname</span>, <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">name</span>, <span class="ruby-identifier">param_def</span>, <span class="ruby-identifier">opt</span>)
73:       <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">SOAP</span><span class="ruby-operator">::</span><span class="ruby-constant">RPC</span><span class="ruby-operator">::</span><span class="ruby-constant">MethodDefinitionError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
74:         <span class="ruby-identifier">p</span> <span class="ruby-identifier">e</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">$DEBUG</span>
75:       <span class="ruby-keyword kw">end</span>
76:     <span class="ruby-keyword kw">end</span>
77:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006547" class="method">
  <div id="M006547_title" class="title">
    <b>add_rpc_servant</b>(obj, namespace)
  </div>
<div class="aka">
  This method is also aliased as
  <a href="index.html?a=M006548&name=add_servant">add_servant</a>
</div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006547_source')" id="l_M006547_source">show source</a> ]</p>
  <div id="M006547_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/soap/rpc/router.rb, line 79</span>
79:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">add_rpc_servant</span>(<span class="ruby-identifier">obj</span>, <span class="ruby-identifier">namespace</span>)
80:     <span class="ruby-operator">::</span><span class="ruby-constant">SOAP</span><span class="ruby-operator">::</span><span class="ruby-constant">RPC</span>.<span class="ruby-identifier">defined_methods</span>(<span class="ruby-identifier">obj</span>).<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">name</span><span class="ruby-operator">|</span>
81:       <span class="ruby-keyword kw">begin</span>
82:         <span class="ruby-identifier">qname</span> = <span class="ruby-constant">XSD</span><span class="ruby-operator">::</span><span class="ruby-constant">QName</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">namespace</span>, <span class="ruby-identifier">name</span>)
83:         <span class="ruby-identifier">param_def</span> = <span class="ruby-operator">::</span><span class="ruby-constant">SOAP</span><span class="ruby-operator">::</span><span class="ruby-constant">RPC</span><span class="ruby-operator">::</span><span class="ruby-constant">SOAPMethod</span>.<span class="ruby-identifier">derive_rpc_param_def</span>(<span class="ruby-identifier">obj</span>, <span class="ruby-identifier">name</span>)
84:         <span class="ruby-identifier">opt</span> = <span class="ruby-identifier">create_styleuse_option</span>(<span class="ruby-identifier">:rpc</span>, <span class="ruby-identifier">:encoded</span>)
85:         <span class="ruby-identifier">add_rpc_operation</span>(<span class="ruby-identifier">obj</span>, <span class="ruby-identifier">qname</span>, <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">name</span>, <span class="ruby-identifier">param_def</span>, <span class="ruby-identifier">opt</span>)
86:       <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">SOAP</span><span class="ruby-operator">::</span><span class="ruby-constant">RPC</span><span class="ruby-operator">::</span><span class="ruby-constant">MethodDefinitionError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
87:         <span class="ruby-identifier">p</span> <span class="ruby-identifier">e</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">$DEBUG</span>
88:       <span class="ruby-keyword kw">end</span>
89:     <span class="ruby-keyword kw">end</span>
90:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006548" class="method">
  <div id="M006548_title" class="title">
    <b>add_servant</b>(obj, namespace)
  </div>
  <div class="description">
  <p>
Alias for <a
href="index.html?a=M006547&name=add_rpc_servant">add_rpc_servant</a>
</p>
  </div>
</div>
<div id="M006557" class="method">
  <div id="M006557_title" class="title">
    <b>create_fault_response</b>(e)
  </div>
  <div class="description">
  <p>
Create fault response string.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006557_source')" id="l_M006557_source">show source</a> ]</p>
  <div id="M006557_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/soap/rpc/router.rb, line 183</span>
183:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">create_fault_response</span>(<span class="ruby-identifier">e</span>)
184:     <span class="ruby-identifier">env</span> = <span class="ruby-constant">SOAPEnvelope</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">SOAPHeader</span>.<span class="ruby-identifier">new</span>, <span class="ruby-constant">SOAPBody</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">fault</span>(<span class="ruby-identifier">e</span>)))
185:     <span class="ruby-identifier">opt</span> = {}
186:     <span class="ruby-identifier">opt</span>[<span class="ruby-identifier">:external_content</span>] = <span class="ruby-keyword kw">nil</span>
187:     <span class="ruby-identifier">response_string</span> = <span class="ruby-constant">Processor</span>.<span class="ruby-identifier">marshal</span>(<span class="ruby-identifier">env</span>, <span class="ruby-identifier">opt</span>)
188:     <span class="ruby-identifier">conn_data</span> = <span class="ruby-constant">StreamHandler</span><span class="ruby-operator">::</span><span class="ruby-constant">ConnectionData</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">response_string</span>)
189:     <span class="ruby-identifier">conn_data</span>.<span class="ruby-identifier">is_fault</span> = <span class="ruby-keyword kw">true</span>
190:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">ext</span> = <span class="ruby-identifier">opt</span>[<span class="ruby-identifier">:external_content</span>]
191:       <span class="ruby-identifier">mimeize</span>(<span class="ruby-identifier">conn_data</span>, <span class="ruby-identifier">ext</span>)
192:     <span class="ruby-keyword kw">end</span>
193:     <span class="ruby-identifier">conn_data</span>
194:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M006556" class="method">
  <div id="M006556_title" class="title">
    <b>route</b>(conn_data)
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006556_source')" id="l_M006556_source">show source</a> ]</p>
  <div id="M006556_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/soap/rpc/router.rb, line 153</span>
153:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">route</span>(<span class="ruby-identifier">conn_data</span>)
154:     <span class="ruby-comment cmt"># we cannot set request_default_encodingsyle before parsing the content.</span>
155:     <span class="ruby-identifier">env</span> = <span class="ruby-identifier">unmarshal</span>(<span class="ruby-identifier">conn_data</span>)
156:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">env</span>.<span class="ruby-identifier">nil?</span>
157:       <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;illegal SOAP marshal format&quot;</span>)
158:     <span class="ruby-keyword kw">end</span>
159:     <span class="ruby-identifier">op</span> = <span class="ruby-identifier">lookup_operation</span>(<span class="ruby-identifier">conn_data</span>.<span class="ruby-identifier">soapaction</span>, <span class="ruby-identifier">env</span>.<span class="ruby-identifier">body</span>)
160:     <span class="ruby-identifier">headerhandler</span> = <span class="ruby-ivar">@headerhandler</span>.<span class="ruby-identifier">dup</span>
161:     <span class="ruby-ivar">@headerhandlerfactory</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>
162:       <span class="ruby-identifier">headerhandler</span>.<span class="ruby-identifier">add</span>(<span class="ruby-identifier">f</span>.<span class="ruby-identifier">create</span>)
163:     <span class="ruby-keyword kw">end</span>
164:     <span class="ruby-identifier">receive_headers</span>(<span class="ruby-identifier">headerhandler</span>, <span class="ruby-identifier">env</span>.<span class="ruby-identifier">header</span>)
165:     <span class="ruby-identifier">soap_response</span> = <span class="ruby-identifier">default_encodingstyle</span> = <span class="ruby-keyword kw">nil</span>
166:     <span class="ruby-keyword kw">begin</span>
167:       <span class="ruby-identifier">soap_response</span> =
168:         <span class="ruby-identifier">op</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">env</span>.<span class="ruby-identifier">body</span>, <span class="ruby-ivar">@mapping_registry</span>, <span class="ruby-ivar">@literal_mapping_registry</span>,
169:           <span class="ruby-identifier">create_mapping_opt</span>)
170:       <span class="ruby-identifier">default_encodingstyle</span> = <span class="ruby-identifier">op</span>.<span class="ruby-identifier">response_default_encodingstyle</span>
171:     <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">Exception</span>
172:       <span class="ruby-identifier">soap_response</span> = <span class="ruby-identifier">fault</span>(<span class="ruby-identifier">$!</span>)
173:       <span class="ruby-identifier">default_encodingstyle</span> = <span class="ruby-keyword kw">nil</span>
174:     <span class="ruby-keyword kw">end</span>
175:     <span class="ruby-identifier">conn_data</span>.<span class="ruby-identifier">is_fault</span> = <span class="ruby-keyword kw">true</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">soap_response</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">SOAPFault</span>)
176:     <span class="ruby-identifier">header</span> = <span class="ruby-identifier">call_headers</span>(<span class="ruby-identifier">headerhandler</span>)
177:     <span class="ruby-identifier">body</span> = <span class="ruby-constant">SOAPBody</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">soap_response</span>)
178:     <span class="ruby-identifier">env</span> = <span class="ruby-constant">SOAPEnvelope</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">header</span>, <span class="ruby-identifier">body</span>)
179:     <span class="ruby-identifier">marshal</span>(<span class="ruby-identifier">conn_data</span>, <span class="ruby-identifier">env</span>, <span class="ruby-identifier">default_encodingstyle</span>)
180:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
</div>

  </div>