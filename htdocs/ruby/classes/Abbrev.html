  <div id="C00001372">
<div class='banner'>
  <span class="file-title-prefix">Module</span><br />Abbrev<br/>
  In:
<a href="#" onclick="jsHref('files/ruby-1_8_7-p22/lib/abbrev_rb.html');">ruby-1.8.7-p22/lib/abbrev.rb</a>

</div>
 <!-- banner header -->

  <div id="bodyContent" >
      <div id="content">

  <div class="description"><p>
Calculate the set of unique abbreviations for a given set of strings.
</p>
<pre>
  require 'abbrev'
  require 'pp'

  pp Abbrev::abbrev(['ruby', 'rules']).sort
</pre>
<p>
<em>Generates:</em>
</p>
<pre>
  [[&quot;rub&quot;, &quot;ruby&quot;],
   [&quot;ruby&quot;, &quot;ruby&quot;],
   [&quot;rul&quot;, &quot;rules&quot;],
   [&quot;rule&quot;, &quot;rules&quot;],
   [&quot;rules&quot;, &quot;rules&quot;]]
</pre>
<p>
Also adds an <tt>abbrev</tt> method to class <tt><a
href="index.html?a=C00000243&name=Array">Array</a></tt>.
</p>
</div>



  <div class="sectiontitle">Methods</div>
  <ul>
  <li><a href="index.html?a=M006979&name=abbrev" >abbrev</a></li>
  </ul>






<div class="sectiontitle">Public Instance methods</div>
<div id="M006979" class="method">
  <div id="M006979_title" class="title">
    <b>abbrev</b>(words, pattern = nil)
  </div>
  <div class="description">
  <p>
Given a set of strings, calculate the set of unambiguous abbreviations for
those strings, and return a hash where the keys are all the possible
abbreviations and the values are the full strings. Thus, given input of
&quot;car&quot; and &quot;cone&quot;, the keys pointing to &quot;car&quot;
would be &quot;ca&quot; and &quot;car&quot;, while those pointing to
&quot;cone&quot; would be &quot;co&quot;, &quot;con&quot;, and
&quot;cone&quot;.
</p>
<p>
The optional <tt>pattern</tt> parameter is a pattern or a string. Only
those input strings matching the pattern, or begging the string, are
considered for inclusion in the output hash
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M006979_source')" id="l_M006979_source">show source</a> ]</p>
  <div id="M006979_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/abbrev.rb, line 44</span>
44:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">abbrev</span>(<span class="ruby-identifier">words</span>, <span class="ruby-identifier">pattern</span> = <span class="ruby-keyword kw">nil</span>)
45:     <span class="ruby-identifier">table</span> = {}
46:     <span class="ruby-identifier">seen</span> = <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">0</span>)
47: 
48:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">pattern</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">String</span>)
49:       <span class="ruby-identifier">pattern</span> = <span class="ruby-node">/^#{Regexp.quote(pattern)}/</span>     <span class="ruby-comment cmt"># regard as a prefix</span>
50:     <span class="ruby-keyword kw">end</span>
51: 
52:     <span class="ruby-identifier">words</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">word</span><span class="ruby-operator">|</span>
53:       <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">abbrev</span> = <span class="ruby-identifier">word</span>).<span class="ruby-identifier">empty?</span>
54:       <span class="ruby-keyword kw">while</span> (<span class="ruby-identifier">len</span> = <span class="ruby-identifier">abbrev</span>.<span class="ruby-identifier">rindex</span>(<span class="ruby-regexp re">/[\w\W]\z/</span>)) <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>
55:         <span class="ruby-identifier">abbrev</span> = <span class="ruby-identifier">word</span>[<span class="ruby-value">0</span>,<span class="ruby-identifier">len</span>]
56: 
57:         <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">pattern</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">pattern</span> <span class="ruby-operator">!~</span> <span class="ruby-identifier">abbrev</span>
58: 
59:         <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">seen</span>[<span class="ruby-identifier">abbrev</span>] <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
60:         <span class="ruby-keyword kw">when</span> <span class="ruby-value">1</span>
61:           <span class="ruby-identifier">table</span>[<span class="ruby-identifier">abbrev</span>] = <span class="ruby-identifier">word</span>
62:         <span class="ruby-keyword kw">when</span> <span class="ruby-value">2</span>
63:           <span class="ruby-identifier">table</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">abbrev</span>)
64:         <span class="ruby-keyword kw">else</span>
65:           <span class="ruby-keyword kw">break</span>
66:         <span class="ruby-keyword kw">end</span>
67:       <span class="ruby-keyword kw">end</span>
68:     <span class="ruby-keyword kw">end</span>
69: 
70:     <span class="ruby-identifier">words</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">word</span><span class="ruby-operator">|</span>
71:       <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">pattern</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">pattern</span> <span class="ruby-operator">!~</span> <span class="ruby-identifier">word</span>
72: 
73:       <span class="ruby-identifier">table</span>[<span class="ruby-identifier">word</span>] = <span class="ruby-identifier">word</span>
74:     <span class="ruby-keyword kw">end</span>
75: 
76:     <span class="ruby-identifier">table</span>
77:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
</div>

  </div>