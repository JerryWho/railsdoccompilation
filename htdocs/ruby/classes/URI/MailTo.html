  <div id="C00001000">
<div class='banner'>
  <span class="file-title-prefix">Class</span><br />MailTo<br/>
  In:
<a href="#" onclick="jsHref('files/ruby-1_8_7-p22/lib/uri/mailto_rb.html');">ruby-1.8.7-p22/lib/uri/mailto.rb</a>

Parent:&nbsp;
        <a href="#" onclick="jsHref('classes/URI/Generic.html');">
Generic
         </a>
</div>
 <!-- banner header -->

  <div id="bodyContent" >
      <div id="content">

  <div class="description"><p>
RFC2368, The mailto URL scheme
</p>
</div>



  <div class="sectiontitle">Methods</div>
  <ul>
  <li><a href="index.html?a=M005068&name=build" >build</a></li>
  <li><a href="index.html?a=M005073&name=headers=" >headers=</a></li>
  <li><a href="index.html?a=M005069&name=new" >new</a></li>
  <li><a href="index.html?a=M005072&name=set_headers" >set_headers</a></li>
  <li><a href="index.html?a=M005070&name=set_to" >set_to</a></li>
  <li><a href="index.html?a=M005071&name=to=" >to=</a></li>
  <li><a href="index.html?a=M005075&name=to_mailtext" >to_mailtext</a></li>
  <li><a href="index.html?a=M005076&name=to_rfc822text" >to_rfc822text</a></li>
  <li><a href="index.html?a=M005074&name=to_s" >to_s</a></li>
  </ul>

<div class="sectiontitle">Included Modules</div>
<ul>
  <li><a href="#" onclick="jsHref('classes/URI/REGEXP.html');">REGEXP</a></li>
</ul>



  <div class="sectiontitle">Constants</div>
  <table border='0' cellpadding='5'>
  <tr valign='top'>
    <td class="attr-name">DEFAULT_PORT</td>
    <td>=</td>
    <td class="attr-value">nil</td>
  </tr>
  <tr valign='top'>
    <td class="attr-name">COMPONENT</td>
    <td>=</td>
    <td class="attr-value">[ :scheme, :to, :headers ].freeze</td>
  </tr>
  </table>

  <div class="sectiontitle">Attributes</div>
  <table border='0' cellpadding='5'>
  <tr valign='top'>
    <td class='attr-rw'>
[R]
    </td>
    <td class='attr-name'>headers</td>
    <td class='attr-desc'>
E-mail headers set by the URL, as an <a
href="index.html?a=C00000243&name=Array">Array</a> of Arrays

</td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[R]
    </td>
    <td class='attr-name'>to</td>
    <td class='attr-desc'>
The primary e-mail address of the URL, as a <a
href="index.html?a=C00000055&name=String">String</a>

</td>
  </tr>
  </table>

<div class="sectiontitle">Public Class methods</div>
<div id="M005068" class="method">
  <div id="M005068_title" class="title">
    <b>build</b>(args)
  </div>
  <div class="description">
  <h2>Description</h2>
<p>
Creates a new <a
href="index.html?a=C00001000&name=URI::MailTo">URI::MailTo</a> object from
components, with syntax checking.
</p>
<p>
Components can be provided as an <a
href="index.html?a=C00000243&name=Array">Array</a> or <a
href="index.html?a=C00000320&name=Hash">Hash</a>. If an <a
href="index.html?a=C00000243&name=Array">Array</a> is used, the components
must be supplied as [to, headers].
</p>
<p>
If a <a href="index.html?a=C00000320&name=Hash">Hash</a> is used, the keys
are the component names preceded by colons.
</p>
<p>
The headers can be supplied as a pre-encoded string, such as
&quot;subject=subscribe&amp;cc=address&quot;, or as an <a
href="index.html?a=C00000243&name=Array">Array</a> of Arrays like
[[&#8216;subject&#8217;, &#8216;subscribe&#8217;], [&#8216;cc&#8217;,
&#8216;address&#8217;]]
</p>
<p>
Examples:
</p>
<pre>
   require 'uri'

   m1 = URI::MailTo.build(['joe@example.com', 'subject=Ruby'])
   puts m1.to_s  -&gt;  mailto:joe@example.com?subject=Ruby

   m2 = URI::MailTo.build(['john@example.com', [['Subject', 'Ruby'], ['Cc', 'jack@example.com']]])
   puts m2.to_s  -&gt;  mailto:john@example.com?Subject=Ruby&amp;Cc=jack@example.com

   m3 = URI::MailTo.build({:to =&gt; 'listman@example.com', :headers =&gt; [['subject', 'subscribe']]})
   puts m3.to_s  -&gt;  mailto:listman@example.com?subject=subscribe
</pre>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005068_source')" id="l_M005068_source">show source</a> ]</p>
  <div id="M005068_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/uri/mailto.rb, line 88</span>
 88:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">build</span>(<span class="ruby-identifier">args</span>)
 89:       <span class="ruby-identifier">tmp</span> = <span class="ruby-constant">Util</span><span class="ruby-operator">::</span><span class="ruby-identifier">make_components_hash</span>(<span class="ruby-keyword kw">self</span>, <span class="ruby-identifier">args</span>)
 90: 
 91:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">tmp</span>[<span class="ruby-identifier">:to</span>]
 92:         <span class="ruby-identifier">tmp</span>[<span class="ruby-identifier">:opaque</span>] = <span class="ruby-identifier">tmp</span>[<span class="ruby-identifier">:to</span>]
 93:       <span class="ruby-keyword kw">else</span>
 94:         <span class="ruby-identifier">tmp</span>[<span class="ruby-identifier">:opaque</span>] = <span class="ruby-value str">''</span>
 95:       <span class="ruby-keyword kw">end</span>
 96: 
 97:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">tmp</span>[<span class="ruby-identifier">:headers</span>]
 98:         <span class="ruby-identifier">tmp</span>[<span class="ruby-identifier">:opaque</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">'?'</span>
 99: 
100:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">tmp</span>[<span class="ruby-identifier">:headers</span>].<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">Array</span>)
101:           <span class="ruby-identifier">tmp</span>[<span class="ruby-identifier">:opaque</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">tmp</span>[<span class="ruby-identifier">:headers</span>].<span class="ruby-identifier">collect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span>
102:             <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">x</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">Array</span>)
103:               <span class="ruby-identifier">x</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">+</span> <span class="ruby-value str">'='</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">x</span>[<span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>].<span class="ruby-identifier">to_s</span>
104:             <span class="ruby-keyword kw">else</span>
105:               <span class="ruby-identifier">x</span>.<span class="ruby-identifier">to_s</span>
106:             <span class="ruby-keyword kw">end</span>
107:           }.<span class="ruby-identifier">join</span>(<span class="ruby-value str">'&amp;'</span>)
108: 
109:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">tmp</span>[<span class="ruby-identifier">:headers</span>].<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">Hash</span>)
110:           <span class="ruby-identifier">tmp</span>[<span class="ruby-identifier">:opaque</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">tmp</span>[<span class="ruby-identifier">:headers</span>].<span class="ruby-identifier">collect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">h</span>,<span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
111:             <span class="ruby-identifier">h</span> <span class="ruby-operator">+</span> <span class="ruby-value str">'='</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">v</span>
112:           }.<span class="ruby-identifier">join</span>(<span class="ruby-value str">'&amp;'</span>)
113: 
114:         <span class="ruby-keyword kw">else</span>
115:           <span class="ruby-identifier">tmp</span>[<span class="ruby-identifier">:opaque</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">tmp</span>[<span class="ruby-identifier">:headers</span>].<span class="ruby-identifier">to_s</span>
116:         <span class="ruby-keyword kw">end</span>
117:       <span class="ruby-keyword kw">end</span>
118: 
119:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">super</span>(<span class="ruby-identifier">tmp</span>)
120:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005069" class="method">
  <div id="M005069_title" class="title">
    <b>new</b>(*arg)
  </div>
  <div class="description">
  <h2>Description</h2>
<p>
Creates a new <a
href="index.html?a=C00001000&name=URI::MailTo">URI::MailTo</a> object from
generic URL components with no syntax checking.
</p>
<p>
This method is usually called from URI::parse, which checks the validity of
each component.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005069_source')" id="l_M005069_source">show source</a> ]</p>
  <div id="M005069_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/uri/mailto.rb, line 131</span>
131:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">arg</span>)
132:       <span class="ruby-keyword kw">super</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">arg</span>)
133: 
134:       <span class="ruby-ivar">@to</span> = <span class="ruby-keyword kw">nil</span>
135:       <span class="ruby-ivar">@headers</span> = []
136: 
137:       <span class="ruby-keyword kw">if</span> <span class="ruby-constant">MAILTO_REGEXP</span> <span class="ruby-operator">=~</span> <span class="ruby-ivar">@opaque</span>
138:          <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">arg</span>[<span class="ruby-value">-1</span>]
139:           <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">to</span> = <span class="ruby-identifier">$1</span>
140:           <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">headers</span> = <span class="ruby-identifier">$2</span>
141:         <span class="ruby-keyword kw">else</span>
142:           <span class="ruby-identifier">set_to</span>(<span class="ruby-identifier">$1</span>)
143:           <span class="ruby-identifier">set_headers</span>(<span class="ruby-identifier">$2</span>)
144:         <span class="ruby-keyword kw">end</span>
145: 
146:       <span class="ruby-keyword kw">else</span>
147:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">InvalidComponentError</span>,
148:           <span class="ruby-node">&quot;unrecognised opaque part for mailtoURL: #{@opaque}&quot;</span>
149:       <span class="ruby-keyword kw">end</span>
150:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div class="sectiontitle">Public Instance methods</div>
<div id="M005073" class="method">
  <div id="M005073_title" class="title">
    <b>headers=</b>(v)
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005073_source')" id="l_M005073_source">show source</a> ]</p>
  <div id="M005073_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/uri/mailto.rb, line 206</span>
206:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">headers=</span>(<span class="ruby-identifier">v</span>)
207:       <span class="ruby-identifier">check_headers</span>(<span class="ruby-identifier">v</span>)
208:       <span class="ruby-identifier">set_headers</span>(<span class="ruby-identifier">v</span>)
209:       <span class="ruby-identifier">v</span>
210:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005071" class="method">
  <div id="M005071_title" class="title">
    <b>to=</b>(v)
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005071_source')" id="l_M005071_source">show source</a> ]</p>
  <div id="M005071_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/uri/mailto.rb, line 176</span>
176:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">to=</span>(<span class="ruby-identifier">v</span>)
177:       <span class="ruby-identifier">check_to</span>(<span class="ruby-identifier">v</span>)
178:       <span class="ruby-identifier">set_to</span>(<span class="ruby-identifier">v</span>)
179:       <span class="ruby-identifier">v</span>
180:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005075" class="method">
  <div id="M005075_title" class="title">
    <b>to_mailtext</b>()
  </div>
  <div class="description">
  <p>
Returns the RFC822 e-mail text equivalent of the URL, as a <a
href="index.html?a=C00000055&name=String">String</a>.
</p>
<p>
Example:
</p>
<pre>
  require 'uri'

  uri = URI.parse(&quot;mailto:ruby-list@ruby-lang.org?Subject=subscribe&amp;cc=myaddr&quot;)
  uri.to_mailtext
  # =&gt; &quot;To: ruby-list@ruby-lang.org\nSubject: subscribe\nCc: myaddr\n\n\n&quot;
</pre>
  </div>
<div class="aka">
  This method is also aliased as
  <a href="index.html?a=M005076&name=to_rfc822text">to_rfc822text</a>
</div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005075_source')" id="l_M005075_source">show source</a> ]</p>
  <div id="M005075_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/uri/mailto.rb, line 241</span>
241:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">to_mailtext</span>
242:       <span class="ruby-identifier">to</span> = <span class="ruby-constant">URI</span><span class="ruby-operator">::</span><span class="ruby-identifier">unescape</span>(<span class="ruby-ivar">@to</span>)
243:       <span class="ruby-identifier">head</span> = <span class="ruby-value str">''</span>
244:       <span class="ruby-identifier">body</span> = <span class="ruby-value str">''</span>
245:       <span class="ruby-ivar">@headers</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span>
246:         <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">x</span>[<span class="ruby-value">0</span>]
247:         <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'body'</span>
248:           <span class="ruby-identifier">body</span> = <span class="ruby-constant">URI</span><span class="ruby-operator">::</span><span class="ruby-identifier">unescape</span>(<span class="ruby-identifier">x</span>[<span class="ruby-value">1</span>])
249:         <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'to'</span>
250:           <span class="ruby-identifier">to</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">', '</span> <span class="ruby-operator">+</span> <span class="ruby-constant">URI</span><span class="ruby-operator">::</span><span class="ruby-identifier">unescape</span>(<span class="ruby-identifier">x</span>[<span class="ruby-value">1</span>])
251:         <span class="ruby-keyword kw">else</span>
252:           <span class="ruby-identifier">head</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">URI</span><span class="ruby-operator">::</span><span class="ruby-identifier">unescape</span>(<span class="ruby-identifier">x</span>[<span class="ruby-value">0</span>]).<span class="ruby-identifier">capitalize</span> <span class="ruby-operator">+</span> <span class="ruby-value str">': '</span> <span class="ruby-operator">+</span>
253:             <span class="ruby-constant">URI</span><span class="ruby-operator">::</span><span class="ruby-identifier">unescape</span>(<span class="ruby-identifier">x</span>[<span class="ruby-value">1</span>])  <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;\n&quot;</span>
254:         <span class="ruby-keyword kw">end</span>
255:       <span class="ruby-keyword kw">end</span>
256: 
257:       <span class="ruby-keyword kw">return</span> <span class="ruby-node">&quot;To: #{to}
258: #{head}
259: #{body}
260: &quot;</span>
261:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005076" class="method">
  <div id="M005076_title" class="title">
    <b>to_rfc822text</b>()
  </div>
  <div class="description">
  <p>
Alias for <a href="index.html?a=M005075&name=to_mailtext">to_mailtext</a>
</p>
  </div>
</div>
<div id="M005074" class="method">
  <div id="M005074_title" class="title">
    <b>to_s</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005074_source')" id="l_M005074_source">show source</a> ]</p>
  <div id="M005074_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/uri/mailto.rb, line 212</span>
212:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">to_s</span>
213:       <span class="ruby-ivar">@scheme</span> <span class="ruby-operator">+</span> <span class="ruby-value str">':'</span> <span class="ruby-operator">+</span> 
214:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@to</span> 
215:           <span class="ruby-ivar">@to</span>
216:         <span class="ruby-keyword kw">else</span>
217:           <span class="ruby-value str">''</span>
218:         <span class="ruby-keyword kw">end</span> <span class="ruby-operator">+</span> 
219:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@headers</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>
220:           <span class="ruby-value str">'?'</span> <span class="ruby-operator">+</span> <span class="ruby-ivar">@headers</span>.<span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">x</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">'='</span>)}.<span class="ruby-identifier">join</span>(<span class="ruby-value str">'&amp;'</span>)
221:         <span class="ruby-keyword kw">else</span>
222:           <span class="ruby-value str">''</span>
223:         <span class="ruby-keyword kw">end</span> <span class="ruby-operator">+</span>
224:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@fragment</span>
225:           <span class="ruby-value str">'#'</span> <span class="ruby-operator">+</span> <span class="ruby-ivar">@fragment</span>
226:         <span class="ruby-keyword kw">else</span>
227:           <span class="ruby-value str">''</span>
228:         <span class="ruby-keyword kw">end</span>
229:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div class="sectiontitle">Protected Instance methods</div>
<div id="M005072" class="method">
  <div id="M005072_title" class="title">
    <b>set_headers</b>(v)
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005072_source')" id="l_M005072_source">show source</a> ]</p>
  <div id="M005072_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/uri/mailto.rb, line 196</span>
196:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">set_headers</span>(<span class="ruby-identifier">v</span>)
197:       <span class="ruby-ivar">@headers</span> = []
198:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">v</span>
199:         <span class="ruby-identifier">v</span>.<span class="ruby-identifier">scan</span>(<span class="ruby-constant">HEADER_REGEXP</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span>
200:           <span class="ruby-ivar">@headers</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">x</span>.<span class="ruby-identifier">split</span>(<span class="ruby-regexp re">/=/o</span>, <span class="ruby-value">2</span>)
201:         <span class="ruby-keyword kw">end</span>
202:       <span class="ruby-keyword kw">end</span>
203:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M005070" class="method">
  <div id="M005070_title" class="title">
    <b>set_to</b>(v)
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M005070_source')" id="l_M005070_source">show source</a> ]</p>
  <div id="M005070_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/uri/mailto.rb, line 171</span>
171:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">set_to</span>(<span class="ruby-identifier">v</span>)
172:       <span class="ruby-ivar">@to</span> = <span class="ruby-identifier">v</span>
173:     <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
</div>

  </div>