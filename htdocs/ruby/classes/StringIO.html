  <div id="C00000027">
<div class='banner'>
  <span class="file-title-prefix">Class</span><br />StringIO<br/>
  In:
<a href="#" onclick="jsHref('files/ruby-1_8_7-p22/lib/yaml/stringio_rb.html');">ruby-1.8.7-p22/lib/yaml/stringio.rb</a>
<a href="#" onclick="jsHref('files/ruby-1_8_7-p22/ext/stringio/stringio_c.html');">ruby-1.8.7-p22/ext/stringio/stringio.c</a>

Parent:&nbsp;
        <a href="#" onclick="jsHref('classes/YAML/Object.html');">
Object
         </a>
</div>
 <!-- banner header -->

  <div id="bodyContent" >
      <div id="content">

  <div class="description"><p>
Pseudo I/O on <a href="index.html?a=C00000055&name=String">String</a>
object.
</p>
</div>



  <div class="sectiontitle">Methods</div>
  <ul>
  <li><a href="index.html?a=M000401&name=&lt;&lt;" >&lt;&lt;</a></li>
  <li><a href="index.html?a=M000363&name=binmode" >binmode</a></li>
  <li><a href="index.html?a=M000387&name=bytes" >bytes</a></li>
  <li><a href="index.html?a=M000389&name=chars" >chars</a></li>
  <li><a href="index.html?a=M000364&name=close" >close</a></li>
  <li><a href="index.html?a=M000365&name=close_read" >close_read</a></li>
  <li><a href="index.html?a=M000366&name=close_write" >close_write</a></li>
  <li><a href="index.html?a=M000367&name=closed?" >closed?</a></li>
  <li><a href="index.html?a=M000368&name=closed_read?" >closed_read?</a></li>
  <li><a href="index.html?a=M000369&name=closed_write?" >closed_write?</a></li>
  <li><a href="index.html?a=M000383&name=each" >each</a></li>
  <li><a href="index.html?a=M000386&name=each_byte" >each_byte</a></li>
  <li><a href="index.html?a=M000388&name=each_char" >each_char</a></li>
  <li><a href="index.html?a=M000384&name=each_line" >each_line</a></li>
  <li><a href="index.html?a=M000351&name=eof" >eof</a></li>
  <li><a href="index.html?a=M000370&name=eof" >eof</a></li>
  <li><a href="index.html?a=M000371&name=eof?" >eof?</a></li>
  <li><a href="index.html?a=M000352&name=eof?" >eof?</a></li>
  <li><a href="index.html?a=M000372&name=fcntl" >fcntl</a></li>
  <li><a href="index.html?a=M000410&name=fileno" >fileno</a></li>
  <li><a href="index.html?a=M000373&name=flush" >flush</a></li>
  <li><a href="index.html?a=M000374&name=fsync" >fsync</a></li>
  <li><a href="index.html?a=M000391&name=getbyte" >getbyte</a></li>
  <li><a href="index.html?a=M000390&name=getc" >getc</a></li>
  <li><a href="index.html?a=M000395&name=gets" >gets</a></li>
  <li><a href="index.html?a=M000407&name=isatty" >isatty</a></li>
  <li><a href="index.html?a=M000412&name=length" >length</a></li>
  <li><a href="index.html?a=M000361&name=lineno" >lineno</a></li>
  <li><a href="index.html?a=M000362&name=lineno=" >lineno=</a></li>
  <li><a href="index.html?a=M000385&name=lines" >lines</a></li>
  <li><a href="index.html?a=M000349&name=new" >new</a></li>
  <li><a href="index.html?a=M000357&name=new" >new</a></li>
  <li><a href="index.html?a=M000356&name=open" >open</a></li>
  <li><a href="index.html?a=M000382&name=path" >path</a></li>
  <li><a href="index.html?a=M000409&name=pid" >pid</a></li>
  <li><a href="index.html?a=M000350&name=pos" >pos</a></li>
  <li><a href="index.html?a=M000375&name=pos" >pos</a></li>
  <li><a href="index.html?a=M000376&name=pos=" >pos=</a></li>
  <li><a href="index.html?a=M000402&name=print" >print</a></li>
  <li><a href="index.html?a=M000403&name=printf" >printf</a></li>
  <li><a href="index.html?a=M000404&name=putc" >putc</a></li>
  <li><a href="index.html?a=M000405&name=puts" >puts</a></li>
  <li><a href="index.html?a=M000398&name=read" >read</a></li>
  <li><a href="index.html?a=M000394&name=readbyte" >readbyte</a></li>
  <li><a href="index.html?a=M000393&name=readchar" >readchar</a></li>
  <li><a href="index.html?a=M000353&name=readline" >readline</a></li>
  <li><a href="index.html?a=M000396&name=readline" >readline</a></li>
  <li><a href="index.html?a=M000397&name=readlines" >readlines</a></li>
  <li><a href="index.html?a=M000358&name=reopen" >reopen</a></li>
  <li><a href="index.html?a=M000377&name=rewind" >rewind</a></li>
  <li><a href="index.html?a=M000354&name=rewind" >rewind</a></li>
  <li><a href="index.html?a=M000355&name=seek" >seek</a></li>
  <li><a href="index.html?a=M000378&name=seek" >seek</a></li>
  <li><a href="index.html?a=M000411&name=size" >size</a></li>
  <li><a href="index.html?a=M000359&name=string" >string</a></li>
  <li><a href="index.html?a=M000360&name=string=" >string=</a></li>
  <li><a href="index.html?a=M000379&name=sync" >sync</a></li>
  <li><a href="index.html?a=M000380&name=sync=" >sync=</a></li>
  <li><a href="index.html?a=M000399&name=sysread" >sysread</a></li>
  <li><a href="index.html?a=M000406&name=syswrite" >syswrite</a></li>
  <li><a href="index.html?a=M000381&name=tell" >tell</a></li>
  <li><a href="index.html?a=M000413&name=truncate" >truncate</a></li>
  <li><a href="index.html?a=M000408&name=tty?" >tty?</a></li>
  <li><a href="index.html?a=M000392&name=ungetc" >ungetc</a></li>
  <li><a href="index.html?a=M000400&name=write" >write</a></li>
  </ul>

<div class="sectiontitle">Included Modules</div>
<ul>
  <li><a href="#" onclick="jsHref('classes/Enumerable.html');">Enumerable</a></li>
</ul>





<div class="sectiontitle">Public Class methods</div>
<div id="M000349" class="method">
  <div id="M000349_title" class="title">
    <b>new</b>(string=&quot;&quot;)
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000349_source')" id="l_M000349_source">show source</a> ]</p>
  <div id="M000349_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/yaml/stringio.rb, line 9</span>
 9:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">string</span>=<span class="ruby-value str">&quot;&quot;</span>)
10:             <span class="ruby-ivar">@string</span>=<span class="ruby-identifier">string</span>
11:             <span class="ruby-ivar">@pos</span>=<span class="ruby-value">0</span>
12:             <span class="ruby-ivar">@eof</span>=(<span class="ruby-identifier">string</span>.<span class="ruby-identifier">size</span><span class="ruby-operator">==</span><span class="ruby-value">0</span>)
13:         <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000357" class="method">
  <div id="M000357_title" class="title">
    <b> StringIO.new(string=""[, mode])<br />
</b>
  </div>
  <div class="description">
  <p>
Creates new <a href="index.html?a=C00000027&name=StringIO">StringIO</a>
instance from with <em>string</em> and <em>mode</em>.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000357_source')" id="l_M000357_source">show source</a> ]</p>
  <div id="M000357_source" class="dyn-source">
<pre>
/*
 * call-seq: StringIO.new(string=&quot;&quot;[, mode])
 *
 * Creates new StringIO instance from with _string_ and _mode_.
 */
static VALUE
strio_initialize(argc, argv, self)
    int argc;
    VALUE *argv;
    VALUE self;
{
    struct StringIO *ptr = check_strio(self);

    if (!ptr) {
        DATA_PTR(self) = ptr = strio_alloc();
    }
    rb_call_super(0, 0);
    strio_init(argc, argv, ptr);
    return self;
}
</pre>
  </div>
</div>
</div>
<div id="M000356" class="method">
  <div id="M000356_title" class="title">
    <b> StringIO.open(string=""[, mode]) {|strio| ...}<br />
</b>
  </div>
  <div class="description">
  <p>
Equivalent to <a
href="index.html?a=M000349&name=StringIO.new">StringIO.new</a> except that
when it is called with a block, it yields with the new instance and closes
it, and returns the result which returned from the block.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000356_source')" id="l_M000356_source">show source</a> ]</p>
  <div id="M000356_source" class="dyn-source">
<pre>
/*
 * call-seq: StringIO.open(string=&quot;&quot;[, mode]) {|strio| ...}
 *
 * Equivalent to StringIO.new except that when it is called with a block, it
 * yields with the new instance and closes it, and returns the result which
 * returned from the block.
 */
static VALUE
strio_s_open(argc, argv, klass)
    int argc;
    VALUE *argv;
    VALUE klass;
{
    VALUE obj = rb_class_new_instance(argc, argv, klass);
    if (!rb_block_given_p()) return obj;
    return rb_ensure(rb_yield, obj, strio_finalize, obj);
}
</pre>
  </div>
</div>
</div>
<div class="sectiontitle">Public Instance methods</div>
<div id="M000401" class="method">
  <div id="M000401_title" class="title">
    <b>strio << obj     &rarr; strio<br />
</b>
  </div>
  <div class="description">
  <p>
See <a href="index.html?a=C00000245&name=IO">IO</a>#&lt;&lt;.
</p>
  </div>
</div>
<div id="M000363" class="method">
  <div id="M000363_title" class="title">
    <b> strio.binmode &rarr; true </b>
  </div>
  <div class="description">
  <p>
Returns <b>strio</b> itself. Just for compatibility to <a
href="index.html?a=C00000245&name=IO">IO</a>.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000363_source')" id="l_M000363_source">show source</a> ]</p>
  <div id="M000363_source" class="dyn-source">
<pre>
/*
 * Returns *strio* itself.  Just for compatibility to IO.
 */
static VALUE
strio_self(self)
    VALUE self;
{
    StringIO(self);
    return self;
}
</pre>
  </div>
</div>
</div>
<div id="M000387" class="method">
  <div id="M000387_title" class="title">
    <b>strio.each_byte {|byte| block }  &rarr; strio<br />
</b>
  </div>
  <div class="description">
  <p>
See <a href="index.html?a=M002174&name=IO#each_byte">IO#each_byte</a>.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000387_source')" id="l_M000387_source">show source</a> ]</p>
  <div id="M000387_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   strio.each_byte {|byte| block }  -&gt; strio
 *
 * See IO#each_byte.
 */
static VALUE
strio_each_byte(self)
    VALUE self;
{
    struct StringIO *ptr = readable(StringIO(self));

    RETURN_ENUMERATOR(self, 0, 0);

    while (ptr-&gt;pos &lt; RSTRING_LEN(ptr-&gt;string)) {
        char c = RSTRING_PTR(ptr-&gt;string)[ptr-&gt;pos++];
        rb_yield(CHR2FIX(c));
    }
    return self;
}
</pre>
  </div>
</div>
</div>
<div id="M000389" class="method">
  <div id="M000389_title" class="title">
    <b>strio.each_char {|char| block }  &rarr; strio<br />
</b>
  </div>
  <div class="description">
  <p>
See <a href="index.html?a=M002175&name=IO#each_char">IO#each_char</a>.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000389_source')" id="l_M000389_source">show source</a> ]</p>
  <div id="M000389_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   strio.each_char {|char| block }  -&gt; strio
 *
 * See IO#each_char.
 */
static VALUE
strio_each_char(self)
    VALUE self;
{
    struct StringIO *sio;
    VALUE str;
    const char *ptr;
    size_t len;

    RETURN_ENUMERATOR(self, 0, 0);

    sio = readable(StringIO(self));
    str = sio-&gt;string;
    ptr = RSTRING_PTR(str);
    len = RSTRING_LEN(str);

    while (sio-&gt;pos &lt; len) {
        int pos = sio-&gt;pos;
        char c = ptr[pos];
        int n = mbclen(c);

        if (len &lt; pos + n) n = len - pos;

        sio-&gt;pos += n;
        rb_yield(rb_str_substr(str, pos, n));
    }
    return self;
}
</pre>
  </div>
</div>
</div>
<div id="M000364" class="method">
  <div id="M000364_title" class="title">
    <b>strio.close  &rarr; nil<br />
</b>
  </div>
  <div class="description">
  <p>
Closes strio. The <b>strio</b> is unavailable for any further data
operations; an <tt><a
href="index.html?a=C00000285&name=IOError">IOError</a></tt> is raised if
such an attempt is made.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000364_source')" id="l_M000364_source">show source</a> ]</p>
  <div id="M000364_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   strio.close  -&gt; nil
 *
 * Closes strio.  The *strio* is unavailable for any further data 
 * operations; an +IOError+ is raised if such an attempt is made.
 */
static VALUE
strio_close(self)
    VALUE self;
{
    struct StringIO *ptr = StringIO(self);
    if (CLOSED(ptr)) {
        rb_raise(rb_eIOError, &quot;closed stream&quot;);
    }
    ptr-&gt;flags &amp;= ~FMODE_READWRITE;
    return Qnil;
}
</pre>
  </div>
</div>
</div>
<div id="M000365" class="method">
  <div id="M000365_title" class="title">
    <b>strio.close_read    &rarr; nil<br />
</b>
  </div>
  <div class="description">
  <p>
Closes the read end of a <a
href="index.html?a=C00000027&name=StringIO">StringIO</a>. Will raise an
<tt><a href="index.html?a=C00000285&name=IOError">IOError</a></tt> if the
<b>strio</b> is not readable.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000365_source')" id="l_M000365_source">show source</a> ]</p>
  <div id="M000365_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   strio.close_read    -&gt; nil
 *
 * Closes the read end of a StringIO.  Will raise an +IOError+ if the
 * *strio* is not readable.
 */
static VALUE
strio_close_read(self)
    VALUE self;
{
    struct StringIO *ptr = StringIO(self);
    if (!READABLE(ptr)) {
        rb_raise(rb_eIOError, &quot;closing non-duplex IO for reading&quot;);
    }
    ptr-&gt;flags &amp;= ~FMODE_READABLE;
    return Qnil;
}
</pre>
  </div>
</div>
</div>
<div id="M000366" class="method">
  <div id="M000366_title" class="title">
    <b>strio.close_write    &rarr; nil<br />
</b>
  </div>
  <div class="description">
  <p>
Closes the write end of a <a
href="index.html?a=C00000027&name=StringIO">StringIO</a>. Will raise an
<tt><a href="index.html?a=C00000285&name=IOError">IOError</a></tt> if the
<b>strio</b> is not writeable.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000366_source')" id="l_M000366_source">show source</a> ]</p>
  <div id="M000366_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   strio.close_write    -&gt; nil
 *
 * Closes the write end of a StringIO.  Will raise an  +IOError+ if the
 * *strio* is not writeable.
 */
static VALUE
strio_close_write(self)
    VALUE self;
{
    struct StringIO *ptr = StringIO(self);
    if (!WRITABLE(ptr)) {
        rb_raise(rb_eIOError, &quot;closing non-duplex IO for writing&quot;);
    }
    ptr-&gt;flags &amp;= ~FMODE_WRITABLE;
    return Qnil;
}
</pre>
  </div>
</div>
</div>
<div id="M000367" class="method">
  <div id="M000367_title" class="title">
    <b>strio.closed?    &rarr; true or false<br />
</b>
  </div>
  <div class="description">
  <p>
Returns <tt>true</tt> if <b>strio</b> is completely closed, <tt>false</tt>
otherwise.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000367_source')" id="l_M000367_source">show source</a> ]</p>
  <div id="M000367_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   strio.closed?    -&gt; true or false
 *
 * Returns +true+ if *strio* is completely closed, +false+ otherwise.
 */
static VALUE
strio_closed(self)
    VALUE self;
{
    struct StringIO *ptr = StringIO(self);
    if (!CLOSED(ptr)) return Qfalse;
    return Qtrue;
}
</pre>
  </div>
</div>
</div>
<div id="M000368" class="method">
  <div id="M000368_title" class="title">
    <b>strio.closed_read?    &rarr; true or false<br />
</b>
  </div>
  <div class="description">
  <p>
Returns <tt>true</tt> if <b>strio</b> is not readable, <tt>false</tt>
otherwise.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000368_source')" id="l_M000368_source">show source</a> ]</p>
  <div id="M000368_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   strio.closed_read?    -&gt; true or false
 *
 * Returns +true+ if *strio* is not readable, +false+ otherwise.
 */
static VALUE
strio_closed_read(self)
    VALUE self;
{
    struct StringIO *ptr = StringIO(self);
    if (READABLE(ptr)) return Qfalse;
    return Qtrue;
}
</pre>
  </div>
</div>
</div>
<div id="M000369" class="method">
  <div id="M000369_title" class="title">
    <b>strio.closed_write?    &rarr; true or false<br />
</b>
  </div>
  <div class="description">
  <p>
Returns <tt>true</tt> if <b>strio</b> is not writable, <tt>false</tt>
otherwise.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000369_source')" id="l_M000369_source">show source</a> ]</p>
  <div id="M000369_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   strio.closed_write?    -&gt; true or false
 *
 * Returns +true+ if *strio* is not writable, +false+ otherwise.
 */
static VALUE
strio_closed_write(self)
    VALUE self;
{
    struct StringIO *ptr = StringIO(self);
    if (WRITABLE(ptr)) return Qfalse;
    return Qtrue;
}
</pre>
  </div>
</div>
</div>
<div id="M000383" class="method">
  <div id="M000383_title" class="title">
    <b>strio.each(sep_string=$/)      {|line| block }  &rarr; strio<br />
strio.each_line(sep_string=$/) {|line| block }  &rarr; strio<br />
</b>
  </div>
  <div class="description">
  <p>
See <a href="index.html?a=M002172&name=IO#each">IO#each</a>.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000383_source')" id="l_M000383_source">show source</a> ]</p>
  <div id="M000383_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   strio.each(sep_string=$/)      {|line| block }  -&gt; strio
 *   strio.each_line(sep_string=$/) {|line| block }  -&gt; strio
 *
 * See IO#each.
 */
static VALUE
strio_each(argc, argv, self)
    int argc;
    VALUE *argv;
    VALUE self;
{
    struct StringIO *ptr = StringIO(self);
    VALUE line;

    RETURN_ENUMERATOR(self, argc, argv);

    while (!NIL_P(line = strio_getline(argc, argv, readable(ptr)))) {
        rb_yield(line);
    }
    return self;
}
</pre>
  </div>
</div>
</div>
<div id="M000386" class="method">
  <div id="M000386_title" class="title">
    <b>strio.each_byte {|byte| block }  &rarr; strio<br />
</b>
  </div>
  <div class="description">
  <p>
See <a href="index.html?a=M002174&name=IO#each_byte">IO#each_byte</a>.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000386_source')" id="l_M000386_source">show source</a> ]</p>
  <div id="M000386_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   strio.each_byte {|byte| block }  -&gt; strio
 *
 * See IO#each_byte.
 */
static VALUE
strio_each_byte(self)
    VALUE self;
{
    struct StringIO *ptr = readable(StringIO(self));

    RETURN_ENUMERATOR(self, 0, 0);

    while (ptr-&gt;pos &lt; RSTRING_LEN(ptr-&gt;string)) {
        char c = RSTRING_PTR(ptr-&gt;string)[ptr-&gt;pos++];
        rb_yield(CHR2FIX(c));
    }
    return self;
}
</pre>
  </div>
</div>
</div>
<div id="M000388" class="method">
  <div id="M000388_title" class="title">
    <b>strio.each_char {|char| block }  &rarr; strio<br />
</b>
  </div>
  <div class="description">
  <p>
See <a href="index.html?a=M002175&name=IO#each_char">IO#each_char</a>.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000388_source')" id="l_M000388_source">show source</a> ]</p>
  <div id="M000388_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   strio.each_char {|char| block }  -&gt; strio
 *
 * See IO#each_char.
 */
static VALUE
strio_each_char(self)
    VALUE self;
{
    struct StringIO *sio;
    VALUE str;
    const char *ptr;
    size_t len;

    RETURN_ENUMERATOR(self, 0, 0);

    sio = readable(StringIO(self));
    str = sio-&gt;string;
    ptr = RSTRING_PTR(str);
    len = RSTRING_LEN(str);

    while (sio-&gt;pos &lt; len) {
        int pos = sio-&gt;pos;
        char c = ptr[pos];
        int n = mbclen(c);

        if (len &lt; pos + n) n = len - pos;

        sio-&gt;pos += n;
        rb_yield(rb_str_substr(str, pos, n));
    }
    return self;
}
</pre>
  </div>
</div>
</div>
<div id="M000384" class="method">
  <div id="M000384_title" class="title">
    <b>strio.each(sep_string=$/)      {|line| block }  &rarr; strio<br />
strio.each_line(sep_string=$/) {|line| block }  &rarr; strio<br />
</b>
  </div>
  <div class="description">
  <p>
See <a href="index.html?a=M002172&name=IO#each">IO#each</a>.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000384_source')" id="l_M000384_source">show source</a> ]</p>
  <div id="M000384_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   strio.each(sep_string=$/)      {|line| block }  -&gt; strio
 *   strio.each_line(sep_string=$/) {|line| block }  -&gt; strio
 *
 * See IO#each.
 */
static VALUE
strio_each(argc, argv, self)
    int argc;
    VALUE *argv;
    VALUE self;
{
    struct StringIO *ptr = StringIO(self);
    VALUE line;

    RETURN_ENUMERATOR(self, argc, argv);

    while (!NIL_P(line = strio_getline(argc, argv, readable(ptr)))) {
        rb_yield(line);
    }
    return self;
}
</pre>
  </div>
</div>
</div>
<div id="M000351" class="method">
  <div id="M000351_title" class="title">
    <b>eof</b>()
  </div>
<div class="aka">
  This method is also aliased as
  <a href="index.html?a=M000352&name=eof?">eof?</a>
</div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000351_source')" id="l_M000351_source">show source</a> ]</p>
  <div id="M000351_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/yaml/stringio.rb, line 17</span>
17:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">eof</span>
18:             <span class="ruby-ivar">@eof</span>
19:         <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000370" class="method">
  <div id="M000370_title" class="title">
    <b>strio.eof     &rarr; true or false<br />
strio.eof?    &rarr; true or false<br />
</b>
  </div>
  <div class="description">
  <p>
Returns true if <b>strio</b> is at end of file. The stringio must be opened
for reading or an <tt><a
href="index.html?a=C00000285&name=IOError">IOError</a></tt> will be raised.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000370_source')" id="l_M000370_source">show source</a> ]</p>
  <div id="M000370_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   strio.eof     -&gt; true or false
 *   strio.eof?    -&gt; true or false
 *
 * Returns true if *strio* is at end of file. The stringio must be  
 * opened for reading or an +IOError+ will be raised.
 */
static VALUE
strio_eof(self)
    VALUE self;
{
    struct StringIO *ptr = readable(StringIO(self));
    if (ptr-&gt;pos &lt; RSTRING(ptr-&gt;string)-&gt;len) return Qfalse;
    return Qtrue;
}
</pre>
  </div>
</div>
</div>
<div id="M000371" class="method">
  <div id="M000371_title" class="title">
    <b>strio.eof     &rarr; true or false<br />
strio.eof?    &rarr; true or false<br />
</b>
  </div>
  <div class="description">
  <p>
Returns true if <b>strio</b> is at end of file. The stringio must be opened
for reading or an <tt><a
href="index.html?a=C00000285&name=IOError">IOError</a></tt> will be raised.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000371_source')" id="l_M000371_source">show source</a> ]</p>
  <div id="M000371_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   strio.eof     -&gt; true or false
 *   strio.eof?    -&gt; true or false
 *
 * Returns true if *strio* is at end of file. The stringio must be  
 * opened for reading or an +IOError+ will be raised.
 */
static VALUE
strio_eof(self)
    VALUE self;
{
    struct StringIO *ptr = readable(StringIO(self));
    if (ptr-&gt;pos &lt; RSTRING(ptr-&gt;string)-&gt;len) return Qfalse;
    return Qtrue;
}
</pre>
  </div>
</div>
</div>
<div id="M000352" class="method">
  <div id="M000352_title" class="title">
    <b>eof?</b>()
  </div>
  <div class="description">
  <p>
Alias for <a href="index.html?a=M000351&name=eof">eof</a>
</p>
  </div>
</div>
<div id="M000372" class="method">
  <div id="M000372_title" class="title">
    <b> strio.fcntl </b>
  </div>
  <div class="description">
  <p>
Raises <a
href="index.html?a=C00000028&name=NotImplementedError">NotImplementedError</a>.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000372_source')" id="l_M000372_source">show source</a> ]</p>
  <div id="M000372_source" class="dyn-source">
<pre>
/*
 * Raises NotImplementedError.
 */
static VALUE
strio_unimpl(argc, argv, self)
    int argc;
    VALUE *argv;
    VALUE self;
{
    StringIO(self);
    rb_notimplement();
    return Qnil;                /* not reached */
}
</pre>
  </div>
</div>
</div>
<div id="M000410" class="method">
  <div id="M000410_title" class="title">
    <b> strio.fileno &rarr; nil </b>
  </div>
  <div class="description">
  <p>
Returns <tt>nil</tt>. Just for compatibility to <a
href="index.html?a=C00000245&name=IO">IO</a>.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000410_source')" id="l_M000410_source">show source</a> ]</p>
  <div id="M000410_source" class="dyn-source">
<pre>
/*
 * Returns +nil+.  Just for compatibility to IO.
 */
static VALUE
strio_nil(self)
    VALUE self;
{
    StringIO(self);
    return Qnil;
}
</pre>
  </div>
</div>
</div>
<div id="M000373" class="method">
  <div id="M000373_title" class="title">
    <b> strio.flush &rarr; strio </b>
  </div>
  <div class="description">
  <p>
Returns <b>strio</b> itself. Just for compatibility to <a
href="index.html?a=C00000245&name=IO">IO</a>.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000373_source')" id="l_M000373_source">show source</a> ]</p>
  <div id="M000373_source" class="dyn-source">
<pre>
/*
 * Returns *strio* itself.  Just for compatibility to IO.
 */
static VALUE
strio_self(self)
    VALUE self;
{
    StringIO(self);
    return self;
}
</pre>
  </div>
</div>
</div>
<div id="M000374" class="method">
  <div id="M000374_title" class="title">
    <b> strio.fsync &rarr; 0 </b>
  </div>
  <div class="description">
  <p>
Returns 0. Just for compatibility to <a
href="index.html?a=C00000245&name=IO">IO</a>.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000374_source')" id="l_M000374_source">show source</a> ]</p>
  <div id="M000374_source" class="dyn-source">
<pre>
/*
 * Returns 0.  Just for compatibility to IO.
 */
static VALUE
strio_0(self)
    VALUE self;
{
    StringIO(self);
    return INT2FIX(0);
}
</pre>
  </div>
</div>
</div>
<div id="M000391" class="method">
  <div id="M000391_title" class="title">
    <b>strio.getc   &rarr; fixnum or nil<br />
</b>
  </div>
  <div class="description">
  <p>
See <a href="index.html?a=M002196&name=IO#getc">IO#getc</a>.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000391_source')" id="l_M000391_source">show source</a> ]</p>
  <div id="M000391_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   strio.getc   -&gt; fixnum or nil
 *
 * See IO#getc.
 */
static VALUE
strio_getc(self)
    VALUE self;
{
    struct StringIO *ptr = readable(StringIO(self));
    int c;
    if (ptr-&gt;pos &gt;= RSTRING(ptr-&gt;string)-&gt;len) {
        ptr-&gt;flags |= STRIO_EOF;
        return Qnil;
    }
    c = RSTRING(ptr-&gt;string)-&gt;ptr[ptr-&gt;pos++];
    return CHR2FIX(c);
}
</pre>
  </div>
</div>
</div>
<div id="M000390" class="method">
  <div id="M000390_title" class="title">
    <b>strio.getc   &rarr; fixnum or nil<br />
</b>
  </div>
  <div class="description">
  <p>
See <a href="index.html?a=M002196&name=IO#getc">IO#getc</a>.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000390_source')" id="l_M000390_source">show source</a> ]</p>
  <div id="M000390_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   strio.getc   -&gt; fixnum or nil
 *
 * See IO#getc.
 */
static VALUE
strio_getc(self)
    VALUE self;
{
    struct StringIO *ptr = readable(StringIO(self));
    int c;
    if (ptr-&gt;pos &gt;= RSTRING(ptr-&gt;string)-&gt;len) {
        ptr-&gt;flags |= STRIO_EOF;
        return Qnil;
    }
    c = RSTRING(ptr-&gt;string)-&gt;ptr[ptr-&gt;pos++];
    return CHR2FIX(c);
}
</pre>
  </div>
</div>
</div>
<div id="M000395" class="method">
  <div id="M000395_title" class="title">
    <b>strio.gets(sep_string=$/)   &rarr; string or nil<br />
</b>
  </div>
  <div class="description">
  <p>
See <a href="index.html?a=M002194&name=IO#gets">IO#gets</a>.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000395_source')" id="l_M000395_source">show source</a> ]</p>
  <div id="M000395_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   strio.gets(sep_string=$/)   -&gt; string or nil
 *
 * See IO#gets.
 */
static VALUE
strio_gets(argc, argv, self)
    int argc;
    VALUE *argv;
    VALUE self;
{
    VALUE str = strio_getline(argc, argv, readable(StringIO(self)));

    rb_lastline_set(str);
    return str;
}
</pre>
  </div>
</div>
</div>
<div id="M000407" class="method">
  <div id="M000407_title" class="title">
    <b>strio.isatty &rarr; nil<br />
strio.tty? &rarr; nil<br />
</b>
  </div>
  <div class="description">
  <p>
Returns <tt>false</tt>. Just for compatibility to <a
href="index.html?a=C00000245&name=IO">IO</a>.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000407_source')" id="l_M000407_source">show source</a> ]</p>
  <div id="M000407_source" class="dyn-source">
<pre>
/*
 * Returns +false+.  Just for compatibility to IO.
 */
static VALUE
strio_false(self)
    VALUE self;
{
    StringIO(self);
    return Qfalse;
}
</pre>
  </div>
</div>
</div>
<div id="M000412" class="method">
  <div id="M000412_title" class="title">
    <b>strio.size   &rarr; integer<br />
</b>
  </div>
  <div class="description">
  <p>
Returns the size of the buffer string.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000412_source')" id="l_M000412_source">show source</a> ]</p>
  <div id="M000412_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   strio.size   -&gt; integer
 *
 * Returns the size of the buffer string.
 */
static VALUE
strio_size(self)
    VALUE self;
{
    VALUE string = StringIO(self)-&gt;string;
    if (NIL_P(string)) {
        rb_raise(rb_eIOError, &quot;not opened&quot;);
    }
    return ULONG2NUM(RSTRING(string)-&gt;len);
}
</pre>
  </div>
</div>
</div>
<div id="M000361" class="method">
  <div id="M000361_title" class="title">
    <b>strio.lineno    &rarr; integer<br />
</b>
  </div>
  <div class="description">
  <p>
Returns the current line number in <b>strio</b>. The stringio must be
opened for reading. <tt>lineno</tt> counts the number of times
<tt>gets</tt> is called, rather than the number of newlines encountered.
The two values will differ if <tt>gets</tt> is called with a separator
other than newline. See also the <tt>$.</tt> variable.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000361_source')" id="l_M000361_source">show source</a> ]</p>
  <div id="M000361_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   strio.lineno    -&gt; integer
 *
 * Returns the current line number in *strio*. The stringio must be
 * opened for reading. +lineno+ counts the number of times  +gets+ is
 * called, rather than the number of newlines  encountered. The two
 * values will differ if +gets+ is  called with a separator other than
 * newline.  See also the  &lt;code&gt;$.&lt;/code&gt; variable.
 */
static VALUE
strio_get_lineno(self)
    VALUE self;
{
    return LONG2NUM(StringIO(self)-&gt;lineno);
}
</pre>
  </div>
</div>
</div>
<div id="M000362" class="method">
  <div id="M000362_title" class="title">
    <b>strio.lineno = integer    &rarr; integer<br />
</b>
  </div>
  <div class="description">
  <p>
Manually sets the current line number to the given value. <tt>$.</tt> is
updated only on the next read.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000362_source')" id="l_M000362_source">show source</a> ]</p>
  <div id="M000362_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   strio.lineno = integer    -&gt; integer
 *
 * Manually sets the current line number to the given value.
 * &lt;code&gt;$.&lt;/code&gt; is updated only on the next read.
 */
static VALUE
strio_set_lineno(self, lineno)
    VALUE self, lineno;
{
    StringIO(self)-&gt;lineno = NUM2LONG(lineno);
    return lineno;
}
</pre>
  </div>
</div>
</div>
<div id="M000385" class="method">
  <div id="M000385_title" class="title">
    <b>strio.each(sep_string=$/)      {|line| block }  &rarr; strio<br />
strio.each_line(sep_string=$/) {|line| block }  &rarr; strio<br />
</b>
  </div>
  <div class="description">
  <p>
See <a href="index.html?a=M002172&name=IO#each">IO#each</a>.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000385_source')" id="l_M000385_source">show source</a> ]</p>
  <div id="M000385_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   strio.each(sep_string=$/)      {|line| block }  -&gt; strio
 *   strio.each_line(sep_string=$/) {|line| block }  -&gt; strio
 *
 * See IO#each.
 */
static VALUE
strio_each(argc, argv, self)
    int argc;
    VALUE *argv;
    VALUE self;
{
    struct StringIO *ptr = StringIO(self);
    VALUE line;

    RETURN_ENUMERATOR(self, argc, argv);

    while (!NIL_P(line = strio_getline(argc, argv, readable(ptr)))) {
        rb_yield(line);
    }
    return self;
}
</pre>
  </div>
</div>
</div>
<div id="M000382" class="method">
  <div id="M000382_title" class="title">
    <b> strio.path &rarr; nil </b>
  </div>
  <div class="description">
  <p>
Returns <tt>nil</tt>. Just for compatibility to <a
href="index.html?a=C00000245&name=IO">IO</a>.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000382_source')" id="l_M000382_source">show source</a> ]</p>
  <div id="M000382_source" class="dyn-source">
<pre>
/*
 * Returns +nil+.  Just for compatibility to IO.
 */
static VALUE
strio_nil(self)
    VALUE self;
{
    StringIO(self);
    return Qnil;
}
</pre>
  </div>
</div>
</div>
<div id="M000409" class="method">
  <div id="M000409_title" class="title">
    <b> strio.pid &rarr; nil </b>
  </div>
  <div class="description">
  <p>
Returns <tt>nil</tt>. Just for compatibility to <a
href="index.html?a=C00000245&name=IO">IO</a>.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000409_source')" id="l_M000409_source">show source</a> ]</p>
  <div id="M000409_source" class="dyn-source">
<pre>
/*
 * Returns +nil+.  Just for compatibility to IO.
 */
static VALUE
strio_nil(self)
    VALUE self;
{
    StringIO(self);
    return Qnil;
}
</pre>
  </div>
</div>
</div>
<div id="M000350" class="method">
  <div id="M000350_title" class="title">
    <b>pos</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000350_source')" id="l_M000350_source">show source</a> ]</p>
  <div id="M000350_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/yaml/stringio.rb, line 14</span>
14:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">pos</span>
15:             <span class="ruby-ivar">@pos</span>
16:         <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000375" class="method">
  <div id="M000375_title" class="title">
    <b>strio.pos     &rarr; integer<br />
strio.tell    &rarr; integer<br />
</b>
  </div>
  <div class="description">
  <p>
Returns the current offset (in bytes) of <b>strio</b>.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000375_source')" id="l_M000375_source">show source</a> ]</p>
  <div id="M000375_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   strio.pos     -&gt; integer
 *   strio.tell    -&gt; integer
 *
 * Returns the current offset (in bytes) of *strio*.
 */
static VALUE
strio_get_pos(self)
    VALUE self;
{
    return LONG2NUM(StringIO(self)-&gt;pos);
}
</pre>
  </div>
</div>
</div>
<div id="M000376" class="method">
  <div id="M000376_title" class="title">
    <b>strio.pos = integer    &rarr; integer<br />
</b>
  </div>
  <div class="description">
  <p>
Seeks to the given position (in bytes) in <b>strio</b>.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000376_source')" id="l_M000376_source">show source</a> ]</p>
  <div id="M000376_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   strio.pos = integer    -&gt; integer
 *
 * Seeks to the given position (in bytes) in *strio*.
 */
static VALUE
strio_set_pos(self, pos)
    VALUE self;
    VALUE pos;
{
    struct StringIO *ptr = StringIO(self);
    long p = NUM2LONG(pos);
    if (p &lt; 0) {
        error_inval(0);
    }
    ptr-&gt;pos = p;
    ptr-&gt;flags &amp;= ~STRIO_EOF;
    return pos;
}
</pre>
  </div>
</div>
</div>
<div id="M000402" class="method">
  <div id="M000402_title" class="title">
    <b>strio.print()             &rarr; nil<br />
strio.print(obj, ...)     &rarr; nil<br />
</b>
  </div>
  <div class="description">
  <p>
See <a href="index.html?a=M002168&name=IO#print">IO#print</a>.
</p>
  </div>
</div>
<div id="M000403" class="method">
  <div id="M000403_title" class="title">
    <b>strio.printf(format_string [, obj, ...] )   &rarr; nil<br />
</b>
  </div>
  <div class="description">
  <p>
See <a href="index.html?a=M002171&name=IO#printf">IO#printf</a>.
</p>
  </div>
</div>
<div id="M000404" class="method">
  <div id="M000404_title" class="title">
    <b>strio.putc(obj)    &rarr; obj<br />
</b>
  </div>
  <div class="description">
  <p>
See <a href="index.html?a=M002169&name=IO#putc">IO#putc</a>.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000404_source')" id="l_M000404_source">show source</a> ]</p>
  <div id="M000404_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   strio.putc(obj)    -&gt; obj
 *
 * See IO#putc.
 */
static VALUE
strio_putc(self, ch)
    VALUE self, ch;
{
    struct StringIO *ptr = writable(StringIO(self));
    int c = NUM2CHR(ch);
    long olen;

    check_modifiable(ptr);
    olen = RSTRING(ptr-&gt;string)-&gt;len;
    if (ptr-&gt;flags &amp; FMODE_APPEND) {
        ptr-&gt;pos = olen;
    }
    strio_extend(ptr, ptr-&gt;pos, 1);
    RSTRING(ptr-&gt;string)-&gt;ptr[ptr-&gt;pos++] = c;
    OBJ_INFECT(ptr-&gt;string, self);
    return ch;
}
</pre>
  </div>
</div>
</div>
<div id="M000405" class="method">
  <div id="M000405_title" class="title">
    <b>strio.puts(obj, ...)    &rarr; nil<br />
</b>
  </div>
  <div class="description">
  <p>
See <a href="index.html?a=M002170&name=IO#puts">IO#puts</a>.
</p>
  </div>
</div>
<div id="M000398" class="method">
  <div id="M000398_title" class="title">
    <b>strio.read([length [, buffer]])    &rarr; string, buffer, or nil<br />
</b>
  </div>
  <div class="description">
  <p>
See <a href="index.html?a=M002163&name=IO#read">IO#read</a>.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000398_source')" id="l_M000398_source">show source</a> ]</p>
  <div id="M000398_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   strio.read([length [, buffer]])    -&gt; string, buffer, or nil
 *
 * See IO#read.
 */
static VALUE
strio_read(argc, argv, self)
    int argc;
    VALUE *argv;
    VALUE self;
{
    struct StringIO *ptr = readable(StringIO(self));
    VALUE str = Qnil;
    long len, olen;

    switch (argc) {
      case 2:
        str = argv[1];
        StringValue(str);
        rb_str_modify(str);
      case 1:
        if (!NIL_P(argv[0])) {
            len = olen = NUM2LONG(argv[0]);
            if (len &lt; 0) {
                rb_raise(rb_eArgError, &quot;negative length %ld given&quot;, len);
            }
            if (len &gt; 0 &amp;&amp; ptr-&gt;pos &gt;= RSTRING(ptr-&gt;string)-&gt;len) {
                ptr-&gt;flags |= STRIO_EOF;
                if (!NIL_P(str)) rb_str_resize(str, 0);
                return Qnil;
            }
            else if (ptr-&gt;flags &amp; STRIO_EOF) {
                if (!NIL_P(str)) rb_str_resize(str, 0);
                return Qnil;
            }
            break;
        }
        /* fall through */
      case 0:
        olen = -1;
        len = RSTRING(ptr-&gt;string)-&gt;len;
        if (len &lt;= ptr-&gt;pos) {
            ptr-&gt;flags |= STRIO_EOF;
            if (NIL_P(str)) {
                str = rb_str_new(0, 0);
            }
            else {
                rb_str_resize(str, 0);
            }
            return str;
        }
        else {
            len -= ptr-&gt;pos;
        }
        break;
      default:
        rb_raise(rb_eArgError, &quot;wrong number of arguments (%d for 0)&quot;, argc);
    }
    if (NIL_P(str)) {
        str = rb_str_substr(ptr-&gt;string, ptr-&gt;pos, len);
    }
    else {
        long rest = RSTRING(ptr-&gt;string)-&gt;len - ptr-&gt;pos;
        if (len &gt; rest) len = rest;
        rb_str_resize(str, len);
        MEMCPY(RSTRING(str)-&gt;ptr, RSTRING(ptr-&gt;string)-&gt;ptr + ptr-&gt;pos, char, len);
    }
    if (NIL_P(str)) {
        if (!(ptr-&gt;flags &amp; STRIO_EOF)) str = rb_str_new(0, 0);
        len = 0;
    }
    else {
        ptr-&gt;pos += len = RSTRING(str)-&gt;len;
    }
    if (olen &lt; 0 || olen &gt; len) ptr-&gt;flags |= STRIO_EOF;
    return str;
}
</pre>
  </div>
</div>
</div>
<div id="M000394" class="method">
  <div id="M000394_title" class="title">
    <b>strio.readchar   &rarr; fixnum<br />
</b>
  </div>
  <div class="description">
  <p>
See <a href="index.html?a=M002198&name=IO#readchar">IO#readchar</a>.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000394_source')" id="l_M000394_source">show source</a> ]</p>
  <div id="M000394_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   strio.readchar   -&gt; fixnum
 *
 * See IO#readchar.
 */
static VALUE
strio_readchar(self)
    VALUE self;
{
    VALUE c = strio_getc(self);
    if (NIL_P(c)) rb_eof_error();
    return c;
}
</pre>
  </div>
</div>
</div>
<div id="M000393" class="method">
  <div id="M000393_title" class="title">
    <b>strio.readchar   &rarr; fixnum<br />
</b>
  </div>
  <div class="description">
  <p>
See <a href="index.html?a=M002198&name=IO#readchar">IO#readchar</a>.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000393_source')" id="l_M000393_source">show source</a> ]</p>
  <div id="M000393_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   strio.readchar   -&gt; fixnum
 *
 * See IO#readchar.
 */
static VALUE
strio_readchar(self)
    VALUE self;
{
    VALUE c = strio_getc(self);
    if (NIL_P(c)) rb_eof_error();
    return c;
}
</pre>
  </div>
</div>
</div>
<div id="M000353" class="method">
  <div id="M000353_title" class="title">
    <b>readline</b>(rs=$/)
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000353_source')" id="l_M000353_source">show source</a> ]</p>
  <div id="M000353_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/yaml/stringio.rb, line 21</span>
21:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">readline</span>(<span class="ruby-identifier">rs</span>=<span class="ruby-identifier">$/</span>)
22:             <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@eof</span>
23:                 <span class="ruby-identifier">raise</span> <span class="ruby-constant">EOFError</span>
24:             <span class="ruby-keyword kw">else</span>
25:                 <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">p</span> = <span class="ruby-ivar">@string</span>[<span class="ruby-ivar">@pos</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>]<span class="ruby-operator">=~</span><span class="ruby-identifier">rs</span>
26:                     <span class="ruby-identifier">line</span> = <span class="ruby-ivar">@string</span>[<span class="ruby-ivar">@pos</span>,<span class="ruby-identifier">p</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>]
27:                 <span class="ruby-keyword kw">else</span>
28:                     <span class="ruby-identifier">line</span> = <span class="ruby-ivar">@string</span>[<span class="ruby-ivar">@pos</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>]
29:                 <span class="ruby-keyword kw">end</span>
30:                 <span class="ruby-ivar">@pos</span><span class="ruby-operator">+=</span><span class="ruby-identifier">line</span>.<span class="ruby-identifier">size</span>
31:                 <span class="ruby-ivar">@eof</span> =<span class="ruby-keyword kw">true</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@pos</span><span class="ruby-operator">==</span><span class="ruby-ivar">@string</span>.<span class="ruby-identifier">size</span>
32:                 <span class="ruby-identifier">$_</span> = <span class="ruby-identifier">line</span>
33:             <span class="ruby-keyword kw">end</span>
34:         <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000396" class="method">
  <div id="M000396_title" class="title">
    <b>strio.readline(sep_string=$/)   &rarr; string<br />
</b>
  </div>
  <div class="description">
  <p>
See <a href="index.html?a=M002195&name=IO#readline">IO#readline</a>.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000396_source')" id="l_M000396_source">show source</a> ]</p>
  <div id="M000396_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   strio.readline(sep_string=$/)   -&gt; string
 *
 * See IO#readline.
 */
static VALUE
strio_readline(argc, argv, self)
    int argc;
    VALUE *argv;
    VALUE self;
{
    VALUE line = strio_getline(argc, argv, readable(StringIO(self)));
    if (NIL_P(line)) rb_eof_error();
    return line;
}
</pre>
  </div>
</div>
</div>
<div id="M000397" class="method">
  <div id="M000397_title" class="title">
    <b>strio.readlines(sep_string=$/)  &rarr;   array<br />
</b>
  </div>
  <div class="description">
  <p>
See <a href="index.html?a=M002162&name=IO#readlines">IO#readlines</a>.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000397_source')" id="l_M000397_source">show source</a> ]</p>
  <div id="M000397_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   strio.readlines(sep_string=$/)  -&gt;   array
 *
 * See IO#readlines.
 */
static VALUE
strio_readlines(argc, argv, self)
    int argc;
    VALUE *argv;
    VALUE self;
{
    struct StringIO *ptr = StringIO(self);
    VALUE ary = rb_ary_new(), line;
    while (!NIL_P(line = strio_getline(argc, argv, readable(ptr)))) {
        rb_ary_push(ary, line);
    }
    return ary;
}
</pre>
  </div>
</div>
</div>
<div id="M000358" class="method">
  <div id="M000358_title" class="title">
    <b>strio.reopen(other_StrIO)     &rarr; strio<br />
strio.reopen(string, mode)    &rarr; strio<br />
</b>
  </div>
  <div class="description">
  <p>
Reinitializes <b>strio</b> with the given <em>other_StrIO</em> or
<em>string</em> and <em>mode</em> (see <a
href="index.html?a=M000349&name=StringIO#new">StringIO#new</a>).
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000358_source')" id="l_M000358_source">show source</a> ]</p>
  <div id="M000358_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   strio.reopen(other_StrIO)     -&gt; strio
 *   strio.reopen(string, mode)    -&gt; strio
 *
 * Reinitializes *strio* with the given &lt;i&gt;other_StrIO&lt;/i&gt; or _string_ 
 * and _mode_ (see StringIO#new).
 */
static VALUE
strio_reopen(argc, argv, self)
    int argc;
    VALUE *argv;
    VALUE self;
{
    if (!OBJ_TAINTED(self)) rb_secure(4);
    if (argc == 1 &amp;&amp; TYPE(*argv) != T_STRING) {
        return strio_copy(self, *argv);
    }
    strio_init(argc, argv, StringIO(self));
    return self;
}
</pre>
  </div>
</div>
</div>
<div id="M000377" class="method">
  <div id="M000377_title" class="title">
    <b>strio.rewind    &rarr; 0<br />
</b>
  </div>
  <div class="description">
  <p>
Positions <b>strio</b> to the beginning of input, resetting <tt>lineno</tt>
to zero.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000377_source')" id="l_M000377_source">show source</a> ]</p>
  <div id="M000377_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   strio.rewind    -&gt; 0
 *
 * Positions *strio* to the beginning of input, resetting
 * +lineno+ to zero.
 */
static VALUE
strio_rewind(self)
    VALUE self;
{
    struct StringIO *ptr = StringIO(self);
    ptr-&gt;pos = 0;
    ptr-&gt;lineno = 0;
    ptr-&gt;flags &amp;= ~STRIO_EOF;
    return INT2FIX(0);
}
</pre>
  </div>
</div>
</div>
<div id="M000354" class="method">
  <div id="M000354_title" class="title">
    <b>rewind</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000354_source')" id="l_M000354_source">show source</a> ]</p>
  <div id="M000354_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/yaml/stringio.rb, line 35</span>
35:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">rewind</span>
36:             <span class="ruby-identifier">seek</span>(<span class="ruby-value">0</span>,<span class="ruby-value">0</span>)
37:         <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000355" class="method">
  <div id="M000355_title" class="title">
    <b>seek</b>(offset,whence)
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000355_source')" id="l_M000355_source">show source</a> ]</p>
  <div id="M000355_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File ruby-1.8.7-p22/lib/yaml/stringio.rb, line 38</span>
38:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">seek</span>(<span class="ruby-identifier">offset</span>,<span class="ruby-identifier">whence</span>)
39:             <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">whence</span>
40:             <span class="ruby-keyword kw">when</span> <span class="ruby-value">0</span>
41:                 <span class="ruby-ivar">@pos</span>=<span class="ruby-identifier">offset</span>
42:             <span class="ruby-keyword kw">when</span> <span class="ruby-value">1</span>
43:                 <span class="ruby-ivar">@pos</span><span class="ruby-operator">+=</span><span class="ruby-identifier">offset</span>
44:             <span class="ruby-keyword kw">when</span> <span class="ruby-value">2</span>
45:                 <span class="ruby-ivar">@pos</span>=<span class="ruby-ivar">@string</span>.<span class="ruby-identifier">size</span><span class="ruby-operator">+</span><span class="ruby-identifier">offset</span>
46:             <span class="ruby-keyword kw">end</span>
47:             <span class="ruby-ivar">@eof</span>=(<span class="ruby-ivar">@pos</span><span class="ruby-operator">&gt;=</span><span class="ruby-ivar">@string</span>.<span class="ruby-identifier">size</span>)
48:             <span class="ruby-value">0</span>
49:         <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000378" class="method">
  <div id="M000378_title" class="title">
    <b>strio.seek(amount, whence=SEEK_SET) &rarr; 0<br />
</b>
  </div>
  <div class="description">
  <p>
Seeks to a given offset <em>amount</em> in the stream according to the
value of <em>whence</em> (see <a
href="index.html?a=M002204&name=IO#seek">IO#seek</a>).
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000378_source')" id="l_M000378_source">show source</a> ]</p>
  <div id="M000378_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   strio.seek(amount, whence=SEEK_SET) -&gt; 0
 *
 * Seeks to a given offset _amount_ in the stream according to
 * the value of _whence_ (see IO#seek).
 */
static VALUE
strio_seek(argc, argv, self)
    int argc;
    VALUE *argv;
    VALUE self;
{
    VALUE whence;
    struct StringIO *ptr = StringIO(self);
    long offset;

    rb_scan_args(argc, argv, &quot;11&quot;, NULL, &amp;whence);
    offset = NUM2LONG(argv[0]);
    if (CLOSED(ptr)) {
        rb_raise(rb_eIOError, &quot;closed stream&quot;);
    }
    switch (NIL_P(whence) ? 0 : NUM2LONG(whence)) {
      case 0:
        break;
      case 1:
        offset += ptr-&gt;pos;
        break;
      case 2:
        offset += RSTRING(ptr-&gt;string)-&gt;len;
        break;
      default:
        error_inval(&quot;invalid whence&quot;);
    }
    if (offset &lt; 0) {
        error_inval(0);
    }
    ptr-&gt;pos = offset;
    ptr-&gt;flags &amp;= ~STRIO_EOF;
    return INT2FIX(0);
}
</pre>
  </div>
</div>
</div>
<div id="M000411" class="method">
  <div id="M000411_title" class="title">
    <b>strio.size   &rarr; integer<br />
</b>
  </div>
  <div class="description">
  <p>
Returns the size of the buffer string.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000411_source')" id="l_M000411_source">show source</a> ]</p>
  <div id="M000411_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   strio.size   -&gt; integer
 *
 * Returns the size of the buffer string.
 */
static VALUE
strio_size(self)
    VALUE self;
{
    VALUE string = StringIO(self)-&gt;string;
    if (NIL_P(string)) {
        rb_raise(rb_eIOError, &quot;not opened&quot;);
    }
    return ULONG2NUM(RSTRING(string)-&gt;len);
}
</pre>
  </div>
</div>
</div>
<div id="M000359" class="method">
  <div id="M000359_title" class="title">
    <b> strio.string     &rarr; string<br />
</b>
  </div>
  <div class="description">
  <p>
Returns underlying <a href="index.html?a=C00000055&name=String">String</a>
object, the subject of <a href="index.html?a=C00000245&name=IO">IO</a>.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000359_source')" id="l_M000359_source">show source</a> ]</p>
  <div id="M000359_source" class="dyn-source">
<pre>
/*
 * call-seq: strio.string     -&gt; string
 *
 * Returns underlying String object, the subject of IO.
 */
static VALUE
strio_get_string(self)
    VALUE self;
{
    return StringIO(self)-&gt;string;
}
</pre>
  </div>
</div>
</div>
<div id="M000360" class="method">
  <div id="M000360_title" class="title">
    <b>strio.string = string  &rarr; string<br />
</b>
  </div>
  <div class="description">
  <p>
Changes underlying <a href="index.html?a=C00000055&name=String">String</a>
object, the subject of <a href="index.html?a=C00000245&name=IO">IO</a>.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000360_source')" id="l_M000360_source">show source</a> ]</p>
  <div id="M000360_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   strio.string = string  -&gt; string
 *
 * Changes underlying String object, the subject of IO.
 */
static VALUE
strio_set_string(self, string)
    VALUE self, string;
{
    struct StringIO *ptr = StringIO(self);

    if (!OBJ_TAINTED(self)) rb_secure(4);
    ptr-&gt;flags &amp;= ~FMODE_READWRITE;
    StringValue(string);
    ptr-&gt;flags = OBJ_FROZEN(string) ? FMODE_READABLE : FMODE_READWRITE;
    ptr-&gt;pos = 0;
    ptr-&gt;lineno = 0;
    return ptr-&gt;string = string;
}
</pre>
  </div>
</div>
</div>
<div id="M000379" class="method">
  <div id="M000379_title" class="title">
    <b>strio.sync    &rarr; true<br />
</b>
  </div>
  <div class="description">
  <p>
Returns <tt>true</tt> always.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000379_source')" id="l_M000379_source">show source</a> ]</p>
  <div id="M000379_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   strio.sync    -&gt; true
 *
 * Returns +true+ always.
 */
static VALUE
strio_get_sync(self)
    VALUE self;
{
    StringIO(self);
    return Qtrue;
}
</pre>
  </div>
</div>
</div>
<div id="M000380" class="method">
  <div id="M000380_title" class="title">
    <b> strio.sync = boolean &rarr; boolean </b>
  </div>
  <div class="description">
  <p>
Returns the argument unchanged. Just for compatibility to <a
href="index.html?a=C00000245&name=IO">IO</a>.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000380_source')" id="l_M000380_source">show source</a> ]</p>
  <div id="M000380_source" class="dyn-source">
<pre>
/*
 * Returns the argument unchanged.  Just for compatibility to IO.
 */
static VALUE
strio_first(self, arg)
    VALUE self, arg;
{
    StringIO(self);
    return arg;
}
</pre>
  </div>
</div>
</div>
<div id="M000399" class="method">
  <div id="M000399_title" class="title">
    <b>strio.sysread(integer[, outbuf])    &rarr; string<br />
</b>
  </div>
  <div class="description">
  <p>
Similar to <a href="index.html?a=M000398&name=read">read</a>, but raises
<tt><a href="index.html?a=C00000298&name=EOFError">EOFError</a></tt> at end
of string instead of returning <tt>nil</tt>, as well as <a
href="index.html?a=M002180&name=IO#sysread">IO#sysread</a> does.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000399_source')" id="l_M000399_source">show source</a> ]</p>
  <div id="M000399_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   strio.sysread(integer[, outbuf])    -&gt; string
 *
 * Similar to #read, but raises +EOFError+ at end of string instead of
 * returning +nil+, as well as IO#sysread does.
 */
static VALUE
strio_sysread(argc, argv, self)
    int argc;
    VALUE *argv;
    VALUE self;
{
    VALUE val = strio_read(argc, argv, self);
    if (NIL_P(val) || RSTRING(val)-&gt;len == 0) {
        rb_eof_error();
    }
    return val;
}
</pre>
  </div>
</div>
</div>
<div id="M000406" class="method">
  <div id="M000406_title" class="title">
    <b>strio.write(string)    &rarr; integer<br />
strio.syswrite(string) &rarr; integer<br />
</b>
  </div>
  <div class="description">
  <p>
Appends the given string to the underlying buffer string of <b>strio</b>.
The stream must be opened for writing. If the argument is not a string, it
will be converted to a string using <tt>to_s</tt>. Returns the number of
bytes written. See <a
href="index.html?a=M002193&name=IO#write">IO#write</a>.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000406_source')" id="l_M000406_source">show source</a> ]</p>
  <div id="M000406_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   strio.write(string)    -&gt; integer
 *   strio.syswrite(string) -&gt; integer
 *
 * Appends the given string to the underlying buffer string of *strio*.
 * The stream must be opened for writing.  If the argument is not a
 * string, it will be converted to a string using &lt;code&gt;to_s&lt;/code&gt;.
 * Returns the number of bytes written.  See IO#write.
 */
static VALUE
strio_write(self, str)
    VALUE self, str;
{
    struct StringIO *ptr = writable(StringIO(self));
    long len, olen;

    if (TYPE(str) != T_STRING)
        str = rb_obj_as_string(str);
    len = RSTRING(str)-&gt;len;
    if (!len) return INT2FIX(0);
    check_modifiable(ptr);
    olen = RSTRING(ptr-&gt;string)-&gt;len;
    if (ptr-&gt;flags &amp; FMODE_APPEND) {
        ptr-&gt;pos = olen;
    }
    if (ptr-&gt;pos == olen) {
        rb_str_cat(ptr-&gt;string, RSTRING(str)-&gt;ptr, len);
    }
    else {
        strio_extend(ptr, ptr-&gt;pos, len);
        rb_str_update(ptr-&gt;string, ptr-&gt;pos, len, str);
    }
    OBJ_INFECT(ptr-&gt;string, self);
    ptr-&gt;pos += len;
    return LONG2NUM(len);
}
</pre>
  </div>
</div>
</div>
<div id="M000381" class="method">
  <div id="M000381_title" class="title">
    <b>strio.pos     &rarr; integer<br />
strio.tell    &rarr; integer<br />
</b>
  </div>
  <div class="description">
  <p>
Returns the current offset (in bytes) of <b>strio</b>.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000381_source')" id="l_M000381_source">show source</a> ]</p>
  <div id="M000381_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   strio.pos     -&gt; integer
 *   strio.tell    -&gt; integer
 *
 * Returns the current offset (in bytes) of *strio*.
 */
static VALUE
strio_get_pos(self)
    VALUE self;
{
    return LONG2NUM(StringIO(self)-&gt;pos);
}
</pre>
  </div>
</div>
</div>
<div id="M000413" class="method">
  <div id="M000413_title" class="title">
    <b>strio.truncate(integer)    &rarr; 0<br />
</b>
  </div>
  <div class="description">
  <p>
Truncates the buffer string to at most <em>integer</em> bytes. The
<b>strio</b> must be opened for writing.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000413_source')" id="l_M000413_source">show source</a> ]</p>
  <div id="M000413_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   strio.truncate(integer)    -&gt; 0
 *
 * Truncates the buffer string to at most _integer_ bytes. The *strio*
 * must be opened for writing.
 */
static VALUE
strio_truncate(self, len)
    VALUE self, len;
{
    VALUE string = writable(StringIO(self))-&gt;string;
    long l = NUM2LONG(len);
    long plen = RSTRING(string)-&gt;len;
    if (l &lt; 0) {
        error_inval(&quot;negative legnth&quot;);
    }
    rb_str_resize(string, l);
    if (plen &lt; l) {
        MEMZERO(RSTRING(string)-&gt;ptr + plen, char, l - plen);
    }
    return len;
}
</pre>
  </div>
</div>
</div>
<div id="M000408" class="method">
  <div id="M000408_title" class="title">
    <b>strio.isatty &rarr; nil<br />
strio.tty? &rarr; nil<br />
</b>
  </div>
  <div class="description">
  <p>
Returns <tt>false</tt>. Just for compatibility to <a
href="index.html?a=C00000245&name=IO">IO</a>.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000408_source')" id="l_M000408_source">show source</a> ]</p>
  <div id="M000408_source" class="dyn-source">
<pre>
/*
 * Returns +false+.  Just for compatibility to IO.
 */
static VALUE
strio_false(self)
    VALUE self;
{
    StringIO(self);
    return Qfalse;
}
</pre>
  </div>
</div>
</div>
<div id="M000392" class="method">
  <div id="M000392_title" class="title">
    <b>strio.ungetc(integer)   &rarr; nil<br />
</b>
  </div>
  <div class="description">
  <p>
Pushes back one character (passed as a parameter) onto <b>strio</b> such
that a subsequent buffered read will return it. Pushing back behind the
beginning of the buffer string is not possible. Nothing will be done if
such an attempt is made. In other case, there is no limitation for multiple
pushbacks.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000392_source')" id="l_M000392_source">show source</a> ]</p>
  <div id="M000392_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   strio.ungetc(integer)   -&gt; nil
 *
 * Pushes back one character (passed as a parameter) onto *strio*
 * such that a subsequent buffered read will return it.  Pushing back 
 * behind the beginning of the buffer string is not possible.  Nothing
 * will be done if such an attempt is made.
 * In other case, there is no limitation for multiple pushbacks.
 */
static VALUE
strio_ungetc(self, ch)
    VALUE self, ch;
{
    struct StringIO *ptr = readable(StringIO(self));
    int cc = NUM2INT(ch);
    long len, pos = ptr-&gt;pos;

    if (cc != EOF &amp;&amp; pos &gt; 0) {
        if ((len = RSTRING(ptr-&gt;string)-&gt;len) &lt; pos-- ||
            (unsigned char)RSTRING(ptr-&gt;string)-&gt;ptr[pos] !=
            (unsigned char)cc) {
            strio_extend(ptr, pos, 1);
            RSTRING(ptr-&gt;string)-&gt;ptr[pos] = cc;
            OBJ_INFECT(ptr-&gt;string, self);
        }
        --ptr-&gt;pos;
        ptr-&gt;flags &amp;= ~STRIO_EOF;
    }
    return Qnil;
}
</pre>
  </div>
</div>
</div>
<div id="M000400" class="method">
  <div id="M000400_title" class="title">
    <b>strio.write(string)    &rarr; integer<br />
strio.syswrite(string) &rarr; integer<br />
</b>
  </div>
  <div class="description">
  <p>
Appends the given string to the underlying buffer string of <b>strio</b>.
The stream must be opened for writing. If the argument is not a string, it
will be converted to a string using <tt>to_s</tt>. Returns the number of
bytes written. See <a
href="index.html?a=M002193&name=IO#write">IO#write</a>.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000400_source')" id="l_M000400_source">show source</a> ]</p>
  <div id="M000400_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   strio.write(string)    -&gt; integer
 *   strio.syswrite(string) -&gt; integer
 *
 * Appends the given string to the underlying buffer string of *strio*.
 * The stream must be opened for writing.  If the argument is not a
 * string, it will be converted to a string using &lt;code&gt;to_s&lt;/code&gt;.
 * Returns the number of bytes written.  See IO#write.
 */
static VALUE
strio_write(self, str)
    VALUE self, str;
{
    struct StringIO *ptr = writable(StringIO(self));
    long len, olen;

    if (TYPE(str) != T_STRING)
        str = rb_obj_as_string(str);
    len = RSTRING(str)-&gt;len;
    if (!len) return INT2FIX(0);
    check_modifiable(ptr);
    olen = RSTRING(ptr-&gt;string)-&gt;len;
    if (ptr-&gt;flags &amp; FMODE_APPEND) {
        ptr-&gt;pos = olen;
    }
    if (ptr-&gt;pos == olen) {
        rb_str_cat(ptr-&gt;string, RSTRING(str)-&gt;ptr, len);
    }
    else {
        strio_extend(ptr, ptr-&gt;pos, len);
        rb_str_update(ptr-&gt;string, ptr-&gt;pos, len, str);
    }
    OBJ_INFECT(ptr-&gt;string, self);
    ptr-&gt;pos += len;
    return LONG2NUM(len);
}
</pre>
  </div>
</div>
</div>
</div>

  </div>