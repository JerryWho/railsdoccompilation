  <div id="C00000114">
<div class='banner'>
  <span class="file-title-prefix">Class</span><br />Stylesheet<br/>
  In:
<a href="#" onclick="jsHref('files/lib/nokogiri/ffi/xslt/stylesheet_rb.html');">lib/nokogiri/ffi/xslt/stylesheet.rb</a>
<a href="#" onclick="jsHref('files/lib/nokogiri/xslt/stylesheet_rb.html');">lib/nokogiri/xslt/stylesheet.rb</a>
<a href="#" onclick="jsHref('files/ext/nokogiri/xslt_stylesheet_c.html');">ext/nokogiri/xslt_stylesheet.c</a>

Parent:&nbsp;
Object
</div>
 <!-- banner header -->

  <div id="bodyContent" >
      <div id="content">

  <div class="description"><p>
call-seq:
</p>
<pre>
  transform(document, params = [])
</pre>
<p>
Apply an <a href="index.html?a=C00000113&name=XSLT">XSLT</a> stylesheet to
an <a href="index.html?a=C00000074&name=XML::Document">XML::Document</a>.
<tt>params</tt> is an array of strings used as <a
href="index.html?a=C00000113&name=XSLT">XSLT</a> parameters. returns <a
href="index.html?a=C00000074&name=Nokogiri::XML::Document">Nokogiri::XML::Document</a>
</p>
<p>
Example:
</p>
<pre>
  doc   = Nokogiri::XML(File.read(ARGV[0]))
  xslt  = Nokogiri::XSLT(File.read(ARGV[1]))
  puts xslt.transform(doc, ['key', 'value'])
</pre>
</div>



  <div class="sectiontitle">Methods</div>
  <ul>
  <li><a href="index.html?a=M001056&name=apply_to" >apply_to</a></li>
  <li><a href="index.html?a=M001057&name=parse_stylesheet_doc" >parse_stylesheet_doc</a></li>
  <li><a href="index.html?a=M001058&name=serialize" >serialize</a></li>
  <li><a href="index.html?a=M001059&name=transform" >transform</a></li>
  </ul>






<div class="sectiontitle">Public Class methods</div>
<div id="M001057" class="method">
  <div id="M001057_title" class="title">
    <b>parse_stylesheet_doc(document)<br />
</b>
  </div>
  <div class="description">
  <p>
Parse a stylesheet from <tt>document</tt>.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001057_source')" id="l_M001057_source">show source</a> ]</p>
  <div id="M001057_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   parse_stylesheet_doc(document)
 *
 * Parse a stylesheet from +document+.
 */
static VALUE parse_stylesheet_doc(VALUE klass, VALUE xmldocobj)
{
    xmlDocPtr xml ;
    xsltStylesheetPtr ss ;
    Data_Get_Struct(xmldocobj, xmlDoc, xml);
    exsltRegisterAll();

    xsltSetGenericErrorFunc(NULL, xslt_generic_error_handler);

    ss = xsltParseStylesheetDoc(xmlCopyDoc(xml, 1)); /* 1 =&gt; recursive */

    xsltSetGenericErrorFunc(NULL, NULL);

    return Data_Wrap_Struct(klass, NULL, dealloc, ss);
}
</pre>
  </div>
</div>
</div>
<div class="sectiontitle">Public Instance methods</div>
<div id="M001056" class="method">
  <div id="M001056_title" class="title">
    <b>apply_to</b>(document, params = [])
  </div>
  <div class="description">
  <p>
Apply an <a href="index.html?a=C00000113&name=XSLT">XSLT</a> stylesheet to
an <a href="index.html?a=C00000074&name=XML::Document">XML::Document</a>.
<tt>params</tt> is an array of strings used as <a
href="index.html?a=C00000113&name=XSLT">XSLT</a> parameters. returns
serialized document
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001056_source')" id="l_M001056_source">show source</a> ]</p>
  <div id="M001056_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File lib/nokogiri/xslt/stylesheet.rb, line 20</span>
20:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">apply_to</span> <span class="ruby-identifier">document</span>, <span class="ruby-identifier">params</span> = []
21:         <span class="ruby-identifier">serialize</span>(<span class="ruby-identifier">transform</span>(<span class="ruby-identifier">document</span>, <span class="ruby-identifier">params</span>))
22:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001058" class="method">
  <div id="M001058_title" class="title">
    <b>serialize(document)<br />
</b>
  </div>
  <div class="description">
  <p>
Serialize <tt>document</tt> to an xml string.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001058_source')" id="l_M001058_source">show source</a> ]</p>
  <div id="M001058_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   serialize(document)
 *
 * Serialize +document+ to an xml string.
 */
static VALUE serialize(VALUE self, VALUE xmlobj)
{
    xmlDocPtr xml ;
    xsltStylesheetPtr ss ;
    xmlChar* doc_ptr ;
    int doc_len ;
    VALUE rval ;

    Data_Get_Struct(xmlobj, xmlDoc, xml);
    Data_Get_Struct(self, xsltStylesheet, ss);
    xsltSaveResultToString(&amp;doc_ptr, &amp;doc_len, xml, ss);
    rval = NOKOGIRI_STR_NEW(doc_ptr, doc_len, xml-&gt;encoding);
    xmlFree(doc_ptr);
    return rval ;
}
</pre>
  </div>
</div>
</div>
<div id="M001059" class="method">
  <div id="M001059_title" class="title">
    <b>transform(document, params = [])<br />
</b>
  </div>
  <div class="description">
  <p>
Apply an <a href="index.html?a=C00000113&name=XSLT">XSLT</a> stylesheet to
an <a href="index.html?a=C00000074&name=XML::Document">XML::Document</a>.
<tt>params</tt> is an array of strings used as <a
href="index.html?a=C00000113&name=XSLT">XSLT</a> parameters. returns <a
href="index.html?a=C00000074&name=Nokogiri::XML::Document">Nokogiri::XML::Document</a>
</p>
<p>
Example:
</p>
<pre>
  doc   = Nokogiri::XML(File.read(ARGV[0]))
  xslt  = Nokogiri::XSLT(File.read(ARGV[1]))
  puts xslt.transform(doc, ['key', 'value'])
</pre>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001059_source')" id="l_M001059_source">show source</a> ]</p>
  <div id="M001059_source" class="dyn-source">
<pre>
/*
 *  call-seq:
 *    transform(document, params = [])
 *
 *  Apply an XSLT stylesheet to an XML::Document.
 *  +params+ is an array of strings used as XSLT parameters.
 *  returns Nokogiri::XML::Document
 *
 *  Example:
 * 
 *    doc   = Nokogiri::XML(File.read(ARGV[0]))
 *    xslt  = Nokogiri::XSLT(File.read(ARGV[1]))
 *    puts xslt.transform(doc, ['key', 'value'])
 *
 */
static VALUE transform(int argc, VALUE* argv, VALUE self)
{
    VALUE xmldoc, paramobj ;
    xmlDocPtr xml ;
    xmlDocPtr result ;
    xsltStylesheetPtr ss ;
    const char** params ;
    int param_len, j ;

    rb_scan_args(argc, argv, &quot;11&quot;, &amp;xmldoc, &amp;paramobj);
    if (paramobj == Qnil) { paramobj = rb_ary_new2(0) ; }

    Data_Get_Struct(xmldoc, xmlDoc, xml);
    Data_Get_Struct(self, xsltStylesheet, ss);

    param_len = NUM2INT(rb_funcall(paramobj, rb_intern(&quot;length&quot;), 0));
    params = calloc((size_t)param_len+1, sizeof(char*));
    for (j = 0 ; j &lt; param_len ; j++) {
      VALUE entry = rb_ary_entry(paramobj, j);
      const char * ptr = StringValuePtr(entry);
      params[j] = ptr;
    }
    params[param_len] = 0 ;

    result = xsltApplyStylesheet(ss, xml, params);
    free(params);

    if (!result) rb_raise(rb_eRuntimeError, &quot;could not perform xslt transform on document&quot;);

    return Nokogiri_wrap_xml_document(0, result) ;
}
</pre>
  </div>
</div>
</div>
</div>

  </div>