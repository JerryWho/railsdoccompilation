  <div id="C00000069">
<div class='banner'>
  <span class="file-title-prefix">Class</span><br />Document<br/>
  In:
<a href="#" onclick="jsHref('files/ext/nokogiri/html_document_c.html');">ext/nokogiri/html_document.c</a>
<a href="#" onclick="jsHref('files/lib/nokogiri/ffi/html/document_rb.html');">lib/nokogiri/ffi/html/document.rb</a>
<a href="#" onclick="jsHref('files/lib/nokogiri/html/document_rb.html');">lib/nokogiri/html/document.rb</a>

Parent:&nbsp;
Nokogiri::XML::Document
</div>
 <!-- banner header -->

  <div id="bodyContent" >
      <div id="content">

  <div class="description"><p>
call-seq:
</p>
<pre>
 type
</pre>
<p>
The type for this document
</p>
</div>



  <div class="sectiontitle">Methods</div>
  <ul>
  <li><a href="index.html?a=M001024&name=fragment" >fragment</a></li>
  <li><a href="index.html?a=M001021&name=meta_encoding" >meta_encoding</a></li>
  <li><a href="index.html?a=M001022&name=meta_encoding=" >meta_encoding=</a></li>
  <li><a href="index.html?a=M001019&name=new" >new</a></li>
  <li><a href="index.html?a=M001025&name=parse" >parse</a></li>
  <li><a href="index.html?a=M001018&name=read_io" >read_io</a></li>
  <li><a href="index.html?a=M001017&name=read_memory" >read_memory</a></li>
  <li><a href="index.html?a=M001023&name=serialize" >serialize</a></li>
  <li><a href="index.html?a=M001020&name=type" >type</a></li>
  </ul>






<div class="sectiontitle">Public Class methods</div>
<div id="M001019" class="method">
  <div id="M001019_title" class="title">
    <b>new<br />
</b>
  </div>
  <div class="description">
  <p>
Create a new document
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001019_source')" id="l_M001019_source">show source</a> ]</p>
  <div id="M001019_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *  new
 *
 * Create a new document
 */
static VALUE new(int argc, VALUE *argv, VALUE klass)
{
  VALUE uri, external_id, rest, rb_doc;
  htmlDocPtr doc;

  rb_scan_args(argc, argv, &quot;0*&quot;, &amp;rest);
  uri         = rb_ary_entry(rest, (long)0);
  external_id = rb_ary_entry(rest, (long)1);

  doc = htmlNewDoc(
      RTEST(uri) ? (const xmlChar *)StringValuePtr(uri) : NULL,
      RTEST(external_id) ? (const xmlChar *)StringValuePtr(external_id) : NULL
  );
  rb_doc = Nokogiri_wrap_xml_document(klass, doc);
  rb_obj_call_init(rb_doc, argc, argv);
  return rb_doc ;
}
</pre>
  </div>
</div>
</div>
<div id="M001025" class="method">
  <div id="M001025_title" class="title">
    <b>parse</b>(string_or_io, url = nil, encoding = nil, options = XML::ParseOptions::DEFAULT_HTML) {|options if block_given?| ...}
  </div>
  <div class="description">
  <p>
Parse <a href="index.html?a=C00000057&name=HTML">HTML</a>. <tt>thing</tt>
may be a String, or any object that responds to <em>read</em> and
<em>close</em> such as an IO, or StringIO. <tt>url</tt> is resource where
this document is located. <tt>encoding</tt> is the encoding that should be
used when processing the document. <tt>options</tt> is a number that sets
options in the parser, such as Nokogiri::XML::ParseOptions::RECOVER. See
the constants in Nokogiri::XML::ParseOptions.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001025_source')" id="l_M001025_source">show source</a> ]</p>
  <div id="M001025_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File lib/nokogiri/html/document.rb, line 64</span>
64:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">parse</span> <span class="ruby-identifier">string_or_io</span>, <span class="ruby-identifier">url</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">encoding</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">options</span> = <span class="ruby-constant">XML</span><span class="ruby-operator">::</span><span class="ruby-constant">ParseOptions</span><span class="ruby-operator">::</span><span class="ruby-constant">DEFAULT_HTML</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>
65: 
66:           <span class="ruby-identifier">options</span> = <span class="ruby-constant">Nokogiri</span><span class="ruby-operator">::</span><span class="ruby-constant">XML</span><span class="ruby-operator">::</span><span class="ruby-constant">ParseOptions</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">options</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-constant">Fixnum</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">options</span>
67:           <span class="ruby-comment cmt"># Give the options to the user</span>
68:           <span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">options</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block_given?</span>
69: 
70:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">string_or_io</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:encoding</span>)
71:             <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">string_or_io</span>.<span class="ruby-identifier">encoding</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;ASCII-8BIT&quot;</span>
72:               <span class="ruby-identifier">encoding</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">string_or_io</span>.<span class="ruby-identifier">encoding</span>.<span class="ruby-identifier">name</span>
73:             <span class="ruby-keyword kw">end</span>
74:           <span class="ruby-keyword kw">end</span>
75: 
76:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">string_or_io</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:read</span>)
77:             <span class="ruby-identifier">url</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">string_or_io</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:path</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">string_or_io</span>.<span class="ruby-identifier">path</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span>
78:             <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">read_io</span>(<span class="ruby-identifier">string_or_io</span>, <span class="ruby-identifier">url</span>, <span class="ruby-identifier">encoding</span>, <span class="ruby-identifier">options</span>.<span class="ruby-identifier">to_i</span>)
79:           <span class="ruby-keyword kw">end</span>
80: 
81:           <span class="ruby-comment cmt"># read_memory pukes on empty docs</span>
82:           <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">new</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">string_or_io</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-keyword kw">or</span> <span class="ruby-identifier">string_or_io</span>.<span class="ruby-identifier">empty?</span>
83: 
84:           <span class="ruby-identifier">read_memory</span>(<span class="ruby-identifier">string_or_io</span>, <span class="ruby-identifier">url</span>, <span class="ruby-identifier">encoding</span>, <span class="ruby-identifier">options</span>.<span class="ruby-identifier">to_i</span>)
85:         <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001018" class="method">
  <div id="M001018_title" class="title">
    <b>read_io(io, url, encoding, options)<br />
</b>
  </div>
  <div class="description">
  <p>
Read the <a href="index.html?a=C00000057&name=HTML">HTML</a> document from
<tt>io</tt> with given <tt>url</tt>, <tt>encoding</tt>, and
<tt>options</tt>. See <a
href="index.html?a=M000867&name=Nokogiri::HTML.parse">Nokogiri::HTML.parse</a>
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001018_source')" id="l_M001018_source">show source</a> ]</p>
  <div id="M001018_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *  read_io(io, url, encoding, options)
 *
 * Read the HTML document from +io+ with given +url+, +encoding+,
 * and +options+.  See Nokogiri::HTML.parse
 */
static VALUE read_io( VALUE klass,
                      VALUE io,
                      VALUE url,
                      VALUE encoding,
                      VALUE options )
{
  const char * c_url    = NIL_P(url)      ? NULL : StringValuePtr(url);
  const char * c_enc    = NIL_P(encoding) ? NULL : StringValuePtr(encoding);
  VALUE error_list      = rb_ary_new();
  VALUE document;
  htmlDocPtr doc;

  xmlResetLastError();
  xmlSetStructuredErrorFunc((void *)error_list, Nokogiri_error_array_pusher);

  doc = htmlReadIO(
      io_read_callback,
      io_close_callback,
      (void *)io,
      c_url,
      c_enc,
      (int)NUM2INT(options)
  );
  xmlSetStructuredErrorFunc(NULL, NULL);

  if(doc == NULL) {
    xmlErrorPtr error;

    xmlFreeDoc(doc);

    error = xmlGetLastError();
    if(error)
      rb_exc_raise(Nokogiri_wrap_xml_syntax_error((VALUE)NULL, error));
    else
      rb_raise(rb_eRuntimeError, &quot;Could not parse document&quot;);

    return Qnil;
  }

  document = Nokogiri_wrap_xml_document(klass, doc);
  rb_iv_set(document, &quot;@errors&quot;, error_list);
  return document;
}
</pre>
  </div>
</div>
</div>
<div id="M001017" class="method">
  <div id="M001017_title" class="title">
    <b>read_memory(string, url, encoding, options)<br />
</b>
  </div>
  <div class="description">
  <p>
Read the <a href="index.html?a=C00000057&name=HTML">HTML</a> document
contained in <tt>string</tt> with given <tt>url</tt>, <tt>encoding</tt>,
and <tt>options</tt>. See <a
href="index.html?a=M000867&name=Nokogiri::HTML.parse">Nokogiri::HTML.parse</a>
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001017_source')" id="l_M001017_source">show source</a> ]</p>
  <div id="M001017_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *  read_memory(string, url, encoding, options)
 *
 * Read the HTML document contained in +string+ with given +url+, +encoding+,
 * and +options+.  See Nokogiri::HTML.parse
 */
static VALUE read_memory( VALUE klass,
                          VALUE string,
                          VALUE url,
                          VALUE encoding,
                          VALUE options )
{
  const char * c_buffer = StringValuePtr(string);
  const char * c_url    = NIL_P(url)      ? NULL : StringValuePtr(url);
  const char * c_enc    = NIL_P(encoding) ? NULL : StringValuePtr(encoding);
  int len               = (int)RSTRING_LEN(string);
  VALUE error_list      = rb_ary_new();
  VALUE document;
  htmlDocPtr doc;

  xmlResetLastError();
  xmlSetStructuredErrorFunc((void *)error_list, Nokogiri_error_array_pusher);

  doc = htmlReadMemory(c_buffer, len, c_url, c_enc, (int)NUM2INT(options));
  xmlSetStructuredErrorFunc(NULL, NULL);

  if(doc == NULL) {
    xmlErrorPtr error;

    xmlFreeDoc(doc);

    error = xmlGetLastError();
    if(error)
      rb_exc_raise(Nokogiri_wrap_xml_syntax_error((VALUE)NULL, error));
    else
      rb_raise(rb_eRuntimeError, &quot;Could not parse document&quot;);

    return Qnil;
  }

  document = Nokogiri_wrap_xml_document(klass, doc);
  rb_iv_set(document, &quot;@errors&quot;, error_list);
  return document;
}
</pre>
  </div>
</div>
</div>
<div class="sectiontitle">Public Instance methods</div>
<div id="M001024" class="method">
  <div id="M001024_title" class="title">
    <b>fragment</b>(tags = nil)
  </div>
  <div class="description">
  <p>
Create a <a
href="index.html?a=C00000018&name=Nokogiri::XML::DocumentFragment">Nokogiri::XML::DocumentFragment</a>
from <tt>tags</tt>
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001024_source')" id="l_M001024_source">show source</a> ]</p>
  <div id="M001024_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File lib/nokogiri/html/document.rb, line 51</span>
51:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">fragment</span> <span class="ruby-identifier">tags</span> = <span class="ruby-keyword kw">nil</span>
52:         <span class="ruby-constant">DocumentFragment</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword kw">self</span>, <span class="ruby-identifier">tags</span>, <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">root</span>)
53:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001021" class="method">
  <div id="M001021_title" class="title">
    <b>meta_encoding</b>()
  </div>
  <div class="description">
  <p>
Get the meta tag encoding for this document. If there is no meta tag, then
nil is returned
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001021_source')" id="l_M001021_source">show source</a> ]</p>
  <div id="M001021_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File lib/nokogiri/html/document.rb, line 7</span>
 7:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">meta_encoding</span>
 8:         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">meta</span> = <span class="ruby-identifier">css</span>(<span class="ruby-value str">'meta'</span>).<span class="ruby-identifier">find</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">node</span><span class="ruby-operator">|</span>
 9:           <span class="ruby-identifier">node</span>[<span class="ruby-value str">'http-equiv'</span>] <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/Content-Type/i</span>
10:         }
11: 
12:         <span class="ruby-regexp re">/charset\s*=\s*([\w-]+)/i</span>.<span class="ruby-identifier">match</span>(<span class="ruby-identifier">meta</span>[<span class="ruby-value str">'content'</span>])[<span class="ruby-value">1</span>]
13:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001022" class="method">
  <div id="M001022_title" class="title">
    <b>meta_encoding=</b>(encoding)
  </div>
  <div class="description">
  <p>
Set the meta tag encoding for this document. If there is no meta content
tag, nil is returned and the encoding is not set.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001022_source')" id="l_M001022_source">show source</a> ]</p>
  <div id="M001022_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File lib/nokogiri/html/document.rb, line 18</span>
18:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">meta_encoding=</span> <span class="ruby-identifier">encoding</span>
19:         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">meta</span> = <span class="ruby-identifier">css</span>(<span class="ruby-value str">'meta'</span>).<span class="ruby-identifier">find</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">node</span><span class="ruby-operator">|</span>
20:           <span class="ruby-identifier">node</span>[<span class="ruby-value str">'http-equiv'</span>] <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/Content-Type/i</span>
21:         }
22: 
23:         <span class="ruby-identifier">meta</span>[<span class="ruby-value str">'content'</span>] = <span class="ruby-value str">&quot;text/html; charset=%s&quot;</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">encoding</span>
24:         <span class="ruby-identifier">encoding</span>
25:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001023" class="method">
  <div id="M001023_title" class="title">
    <b>serialize</b>(options = {})
  </div>
  <div class="description">
  <p>
Serialize Node using <tt>options</tt>. Save options can also be set using a
block. See SaveOptions.
</p>
<p>
These two statements are equivalent:
</p>
<pre>
 node.serialize(:encoding =&gt; 'UTF-8', :save_with =&gt; FORMAT | AS_XML)
</pre>
<p>
or
</p>
<pre>
  node.serialize(:encoding =&gt; 'UTF-8') do |config|
    config.format.as_xml
  end
</pre>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001023_source')" id="l_M001023_source">show source</a> ]</p>
  <div id="M001023_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File lib/nokogiri/html/document.rb, line 41</span>
41:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">serialize</span> <span class="ruby-identifier">options</span> = {}, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>
42:         <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:save_with</span>] <span class="ruby-operator">||=</span> <span class="ruby-constant">XML</span><span class="ruby-operator">::</span><span class="ruby-constant">Node</span><span class="ruby-operator">::</span><span class="ruby-constant">SaveOptions</span><span class="ruby-operator">::</span><span class="ruby-constant">FORMAT</span> <span class="ruby-operator">|</span>
43:             <span class="ruby-constant">XML</span><span class="ruby-operator">::</span><span class="ruby-constant">Node</span><span class="ruby-operator">::</span><span class="ruby-constant">SaveOptions</span><span class="ruby-operator">::</span><span class="ruby-constant">AS_HTML</span> <span class="ruby-operator">|</span>
44:             <span class="ruby-constant">XML</span><span class="ruby-operator">::</span><span class="ruby-constant">Node</span><span class="ruby-operator">::</span><span class="ruby-constant">SaveOptions</span><span class="ruby-operator">::</span><span class="ruby-constant">NO_DECLARATION</span> <span class="ruby-operator">|</span>
45:             <span class="ruby-constant">XML</span><span class="ruby-operator">::</span><span class="ruby-constant">Node</span><span class="ruby-operator">::</span><span class="ruby-constant">SaveOptions</span><span class="ruby-operator">::</span><span class="ruby-constant">NO_EMPTY_TAGS</span>
46:         <span class="ruby-keyword kw">super</span>
47:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M001020" class="method">
  <div id="M001020_title" class="title">
    <b>type<br />
</b>
  </div>
  <div class="description">
  <p>
The type for this document
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M001020_source')" id="l_M001020_source">show source</a> ]</p>
  <div id="M001020_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *  type
 *
 * The type for this document
 */
static VALUE type(VALUE self)
{
  htmlDocPtr doc;
  Data_Get_Struct(self, xmlDoc, doc);
  return INT2NUM((long)doc-&gt;type);
}
</pre>
  </div>
</div>
</div>
</div>

  </div>