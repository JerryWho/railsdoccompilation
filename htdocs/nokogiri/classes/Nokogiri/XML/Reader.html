  <div id="C00000047">
<div class='banner'>
  <span class="file-title-prefix">Class</span><br />Reader<br/>
  In:
<a href="#" onclick="jsHref('files/lib/nokogiri/xml/reader_rb.html');">lib/nokogiri/xml/reader.rb</a>
<a href="#" onclick="jsHref('files/ext/nokogiri/xml_xpath_context_c.html');">ext/nokogiri/xml_xpath_context.c</a>

Parent:&nbsp;
Object
</div>
 <!-- banner header -->

  <div id="bodyContent" >
      <div id="content">

  <div class="description"><p>
The <a href="index.html?a=C00000047&name=Reader">Reader</a> parser allows
you to effectively pull parse an <a
href="index.html?a=C00000018&name=XML">XML</a> document. Once instantiated,
call <a
href="index.html?a=M000404&name=Nokogiri::XML::Reader#each">Nokogiri::XML::Reader#each</a>
to iterate over each node. Note that you may only iterate over the document
once!
</p>
</div>



  <div class="sectiontitle">Methods</div>
  <ul>
  <li><a href="index.html?a=M000417&name=attribute" >attribute</a></li>
  <li><a href="index.html?a=M000419&name=attribute_at" >attribute_at</a></li>
  <li><a href="index.html?a=M000416&name=attribute_count" >attribute_count</a></li>
  <li><a href="index.html?a=M000420&name=attribute_nodes" >attribute_nodes</a></li>
  <li><a href="index.html?a=M000403&name=attributes" >attributes</a></li>
  <li><a href="index.html?a=M000421&name=attributes?" >attributes?</a></li>
  <li><a href="index.html?a=M000423&name=default?" >default?</a></li>
  <li><a href="index.html?a=M000415&name=depth" >depth</a></li>
  <li><a href="index.html?a=M000404&name=each" >each</a></li>
  <li><a href="index.html?a=M000405&name=from_memory" >from_memory</a></li>
  <li><a href="index.html?a=M000413&name=lang" >lang</a></li>
  <li><a href="index.html?a=M000409&name=local_name" >local_name</a></li>
  <li><a href="index.html?a=M000408&name=name" >name</a></li>
  <li><a href="index.html?a=M000410&name=namespace_uri" >namespace_uri</a></li>
  <li><a href="index.html?a=M000418&name=namespaces" >namespaces</a></li>
  <li><a href="index.html?a=M000402&name=new" >new</a></li>
  <li><a href="index.html?a=M000411&name=prefix" >prefix</a></li>
  <li><a href="index.html?a=M000406&name=read" >read</a></li>
  <li><a href="index.html?a=M000407&name=state" >state</a></li>
  <li><a href="index.html?a=M000412&name=value" >value</a></li>
  <li><a href="index.html?a=M000422&name=value?" >value?</a></li>
  <li><a href="index.html?a=M000414&name=xml_version" >xml_version</a></li>
  </ul>

<div class="sectiontitle">Included Modules</div>
<ul>
  <li><a href="#" onclick="jsHref('');">Enumerable</a></li>
</ul>




  <div class="sectiontitle">Attributes</div>
  <table border='0' cellpadding='5'>
  <tr valign='top'>
    <td class='attr-rw'>
[R]
    </td>
    <td class='attr-name'>encoding</td>
    <td class='attr-desc'></td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[RW]
    </td>
    <td class='attr-name'>errors</td>
    <td class='attr-desc'></td>
  </tr>
  </table>

<div class="sectiontitle">Public Class methods</div>
<div id="M000405" class="method">
  <div id="M000405_title" class="title">
    <b>from_memory(string, url = nil, encoding = nil, options = 0)<br />
</b>
  </div>
  <div class="description">
  <p>
Create a new reader that parses <tt>string</tt>
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000405_source')" id="l_M000405_source">show source</a> ]</p>
  <div id="M000405_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   from_memory(string, url = nil, encoding = nil, options = 0)
 *
 * Create a new reader that parses +string+
 */
static VALUE from_memory(int argc, VALUE *argv, VALUE klass)
{
  VALUE rb_buffer, rb_url, encoding, rb_options;

  const char * c_url      = NULL;
  const char * c_encoding = NULL;
  int c_options           = 0; 

  rb_scan_args(argc, argv, &quot;13&quot;, &amp;rb_buffer, &amp;rb_url, &amp;encoding, &amp;rb_options);

  rb_buffer = StringValue(rb_buffer) ;
  if (RTEST(rb_url)) c_url = StringValuePtr(rb_url);
  if (RTEST(encoding)) c_encoding = StringValuePtr(encoding);
  if (RTEST(rb_options)) c_options = NUM2INT(rb_options);

  xmlTextReaderPtr reader = xmlReaderForMemory(
      StringValuePtr(rb_buffer),
      RSTRING_LEN(rb_buffer),
      c_url,
      c_encoding,
      c_options
  );

  if(reader == NULL) {
    xmlFreeTextReader(reader);
    rb_raise(rb_eRuntimeError, &quot;couldn't create a parser&quot;);
  }

  VALUE rb_reader = Data_Wrap_Struct(klass, NULL, dealloc, reader);
  rb_funcall(rb_reader, rb_intern(&quot;initialize&quot;), 2, rb_url, encoding);

  return rb_reader;
}
</pre>
  </div>
</div>
</div>
<div id="M000402" class="method">
  <div id="M000402_title" class="title">
    <b>new</b>(url = nil, encoding = nil)
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000402_source')" id="l_M000402_source">show source</a> ]</p>
  <div id="M000402_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File lib/nokogiri/xml/reader.rb, line 8</span>
 8:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span> <span class="ruby-identifier">url</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">encoding</span> = <span class="ruby-keyword kw">nil</span>
 9:         <span class="ruby-ivar">@errors</span> = []
10:         <span class="ruby-ivar">@encoding</span> = <span class="ruby-identifier">encoding</span>
11:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div class="sectiontitle">Public Instance methods</div>
<div id="M000417" class="method">
  <div id="M000417_title" class="title">
    <b>attribute(name)<br />
</b>
  </div>
  <div class="description">
  <p>
Get the value of attribute named <tt>name</tt>
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000417_source')" id="l_M000417_source">show source</a> ]</p>
  <div id="M000417_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   attribute(name)
 *
 * Get the value of attribute named +name+
 */
static VALUE reader_attribute(VALUE self, VALUE name)
{
  xmlTextReaderPtr reader;
  xmlChar *value ;
  Data_Get_Struct(self, xmlTextReader, reader);

  if(name == Qnil) return Qnil;
  name = StringValue(name) ;

  value = xmlTextReaderGetAttribute(reader, (xmlChar*)StringValuePtr(name));
  if(value == NULL) {
    /* this section is an attempt to workaround older versions of libxml that
       don't handle namespaces properly in all attribute-and-friends functions */
    xmlChar *prefix = NULL ;
    xmlChar *localname = xmlSplitQName2((xmlChar*)StringValuePtr(name), &amp;prefix);
    if (localname != NULL) {
      value = xmlTextReaderLookupNamespace(reader, localname);
      xmlFree(localname) ;
    } else {
      value = xmlTextReaderLookupNamespace(reader, prefix);
    }
    xmlFree(prefix);
  }
  if(value == NULL) return Qnil;

  VALUE MAYBE_UNUSED(enc) = rb_iv_get(self, &quot;@encoding&quot;);
  VALUE rb_value = NOKOGIRI_STR_NEW2(value,
      RTEST(enc) ? StringValuePtr(enc) : NULL);
  xmlFree(value);
  return rb_value;
}
</pre>
  </div>
</div>
</div>
<div id="M000419" class="method">
  <div id="M000419_title" class="title">
    <b>attribute_at(index)<br />
</b>
  </div>
  <div class="description">
  <p>
Get the value of attribute at <tt>index</tt>
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000419_source')" id="l_M000419_source">show source</a> ]</p>
  <div id="M000419_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   attribute_at(index)
 *
 * Get the value of attribute at +index+
 */
static VALUE attribute_at(VALUE self, VALUE index)
{
  xmlTextReaderPtr reader;
  Data_Get_Struct(self, xmlTextReader, reader);

  if(index == Qnil) return Qnil;
  index = rb_funcall(index, rb_intern(&quot;to_i&quot;), 0);

  xmlChar * value = xmlTextReaderGetAttributeNo(
      reader,
      NUM2INT(index)
  );
  if(value == NULL) return Qnil;

  VALUE MAYBE_UNUSED(enc) = rb_iv_get(self, &quot;@encoding&quot;);
  VALUE rb_value = NOKOGIRI_STR_NEW2(value,
      RTEST(enc) ? StringValuePtr(enc) : NULL);
  xmlFree(value);
  return rb_value;
}
</pre>
  </div>
</div>
</div>
<div id="M000416" class="method">
  <div id="M000416_title" class="title">
    <b>attribute_count<br />
</b>
  </div>
  <div class="description">
  <p>
Get the number of attributes for the current node
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000416_source')" id="l_M000416_source">show source</a> ]</p>
  <div id="M000416_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   attribute_count
 *
 * Get the number of attributes for the current node
 */
static VALUE attribute_count(VALUE self)
{
  xmlTextReaderPtr reader;
  Data_Get_Struct(self, xmlTextReader, reader);
  int count = xmlTextReaderAttributeCount(reader);
  if(count == -1) return Qnil;

  return INT2NUM(count);
}
</pre>
  </div>
</div>
</div>
<div id="M000420" class="method">
  <div id="M000420_title" class="title">
    <b>attribute_nodes<br />
</b>
  </div>
  <div class="description">
  <p>
Get a list of attributes for this <a
href="index.html?a=C00000042&name=Node">Node</a>
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000420_source')" id="l_M000420_source">show source</a> ]</p>
  <div id="M000420_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   attribute_nodes
 *
 * Get a list of attributes for this Node
 */
static VALUE attribute_nodes(VALUE self)
{
  xmlTextReaderPtr reader;
  VALUE attr ;

  Data_Get_Struct(self, xmlTextReader, reader);

  attr = rb_ary_new() ;

  if (! has_attributes(reader))
    return attr ;

  xmlNodePtr ptr = xmlTextReaderExpand(reader);
  if(ptr == NULL) return Qnil;

  // FIXME I'm not sure if this is correct.....  I don't really like pointing
  // at this document, but I have to because of the assertions in
  // the node wrapping code.
  if(! DOC_RUBY_OBJECT_TEST(ptr-&gt;doc)) {
    VALUE rb_doc = Data_Wrap_Struct(cNokogiriXmlDocument, 0, 0, ptr-&gt;doc);
    ptr-&gt;doc-&gt;_private = malloc(sizeof(nokogiriTuple));
    rb_iv_set(rb_doc, &quot;@decorators&quot;, Qnil);
    ((nokogiriTuplePtr)(ptr-&gt;doc-&gt;_private))-&gt;doc = (void *)rb_doc;
    ((nokogiriTuplePtr)(ptr-&gt;doc-&gt;_private))-&gt;unlinkedNodes = xmlXPathNodeSetCreate(NULL);
  }
  VALUE enc = rb_iv_get(self, &quot;@encoding&quot;);

  if(enc != Qnil &amp;&amp; NULL == ptr-&gt;doc-&gt;encoding) {
    ptr-&gt;doc-&gt;encoding = calloc((size_t)RSTRING_LEN(enc), sizeof(char));
    strncpy(
      (char *)ptr-&gt;doc-&gt;encoding,
      StringValuePtr(enc),
      (size_t)RSTRING_LEN(enc)
    );
  }

  Nokogiri_xml_node_properties(ptr, attr);

  return attr ;
}
</pre>
  </div>
</div>
</div>
<div id="M000403" class="method">
  <div id="M000403_title" class="title">
    <b>attributes</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000403_source')" id="l_M000403_source">show source</a> ]</p>
  <div id="M000403_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File lib/nokogiri/xml/reader.rb, line 13</span>
13:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">attributes</span>
14:         <span class="ruby-constant">Hash</span>[<span class="ruby-operator">*</span>(<span class="ruby-identifier">attribute_nodes</span>.<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">node</span><span class="ruby-operator">|</span>
15:           [<span class="ruby-identifier">node</span>.<span class="ruby-identifier">name</span>, <span class="ruby-identifier">node</span>.<span class="ruby-identifier">to_s</span>]
16:         }.<span class="ruby-identifier">flatten</span>)].<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">namespaces</span> <span class="ruby-operator">||</span> {})
17:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000421" class="method">
  <div id="M000421_title" class="title">
    <b>attributes?<br />
</b>
  </div>
  <div class="description">
  <p>
Does this node have attributes?
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000421_source')" id="l_M000421_source">show source</a> ]</p>
  <div id="M000421_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   attributes?
 *
 * Does this node have attributes?
 */
static VALUE attributes_eh(VALUE self)
{
  xmlTextReaderPtr reader;
  Data_Get_Struct(self, xmlTextReader, reader);
  int eh = has_attributes(reader);
  if(eh == 0) return Qfalse;
  if(eh == 1) return Qtrue;

  return Qnil;
}
</pre>
  </div>
</div>
</div>
<div id="M000423" class="method">
  <div id="M000423_title" class="title">
    <b>default?<br />
</b>
  </div>
  <div class="description">
  <p>
Was an attribute generated from the default value in the <a
href="index.html?a=C00000063&name=DTD">DTD</a> or schema?
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000423_source')" id="l_M000423_source">show source</a> ]</p>
  <div id="M000423_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   default?
 *
 * Was an attribute generated from the default value in the DTD or schema?
 */
static VALUE default_eh(VALUE self)
{
  xmlTextReaderPtr reader;
  Data_Get_Struct(self, xmlTextReader, reader);
  int eh = xmlTextReaderIsDefault(reader);
  if(eh == 0) return Qfalse;
  if(eh == 1) return Qtrue;

  return Qnil;
}
</pre>
  </div>
</div>
</div>
<div id="M000415" class="method">
  <div id="M000415_title" class="title">
    <b>depth<br />
</b>
  </div>
  <div class="description">
  <p>
Get the depth of the node
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000415_source')" id="l_M000415_source">show source</a> ]</p>
  <div id="M000415_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   depth
 *
 * Get the depth of the node
 */
static VALUE depth(VALUE self)
{
  xmlTextReaderPtr reader;
  Data_Get_Struct(self, xmlTextReader, reader);
  int depth = xmlTextReaderDepth(reader);
  if(depth == -1) return Qnil;

  return INT2NUM(depth);
}
</pre>
  </div>
</div>
</div>
<div id="M000404" class="method">
  <div id="M000404_title" class="title">
    <b>each</b>(&amp;block)
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000404_source')" id="l_M000404_source">show source</a> ]</p>
  <div id="M000404_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File lib/nokogiri/xml/reader.rb, line 19</span>
19:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">each</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
20:         <span class="ruby-keyword kw">while</span> <span class="ruby-identifier">node</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">read</span>
21:           <span class="ruby-identifier">block</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">node</span>)
22:         <span class="ruby-keyword kw">end</span>
23:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000413" class="method">
  <div id="M000413_title" class="title">
    <b>lang<br />
</b>
  </div>
  <div class="description">
  <p>
Get the xml:lang scope within which the node resides.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000413_source')" id="l_M000413_source">show source</a> ]</p>
  <div id="M000413_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   lang
 *
 * Get the xml:lang scope within which the node resides.
 */
static VALUE lang(VALUE self)
{
  xmlTextReaderPtr reader;
  Data_Get_Struct(self, xmlTextReader, reader);
  const char * lang = (const char *)xmlTextReaderConstXmlLang(reader);
  if(lang == NULL) return Qnil;

  VALUE MAYBE_UNUSED(enc) = rb_iv_get(self, &quot;@encoding&quot;);
  return NOKOGIRI_STR_NEW2(lang,
      RTEST(enc) ? StringValuePtr(enc) : NULL);
}
</pre>
  </div>
</div>
</div>
<div id="M000409" class="method">
  <div id="M000409_title" class="title">
    <b>local_name<br />
</b>
  </div>
  <div class="description">
  <p>
Get the local name of the node
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000409_source')" id="l_M000409_source">show source</a> ]</p>
  <div id="M000409_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   local_name
 *
 * Get the local name of the node
 */
static VALUE local_name(VALUE self)
{
  xmlTextReaderPtr reader;
  Data_Get_Struct(self, xmlTextReader, reader);
  const char * name = (const char *)xmlTextReaderConstLocalName(reader);
  if(name == NULL) return Qnil;

  VALUE MAYBE_UNUSED(enc) = rb_iv_get(self, &quot;@encoding&quot;);
  return NOKOGIRI_STR_NEW2(name,
      RTEST(enc) ? StringValuePtr(enc) : NULL);
}
</pre>
  </div>
</div>
</div>
<div id="M000408" class="method">
  <div id="M000408_title" class="title">
    <b>name<br />
</b>
  </div>
  <div class="description">
  <p>
Get the name of the node
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000408_source')" id="l_M000408_source">show source</a> ]</p>
  <div id="M000408_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   name
 *
 * Get the name of the node
 */
static VALUE name(VALUE self)
{
  xmlTextReaderPtr reader;
  Data_Get_Struct(self, xmlTextReader, reader);
  const char * name = (const char *)xmlTextReaderConstName(reader);
  if(name == NULL) return Qnil;

  VALUE MAYBE_UNUSED(enc) = rb_iv_get(self, &quot;@encoding&quot;);
  return NOKOGIRI_STR_NEW2(name,
      RTEST(enc) ? StringValuePtr(enc) : NULL);
}
</pre>
  </div>
</div>
</div>
<div id="M000410" class="method">
  <div id="M000410_title" class="title">
    <b>namespace_uri<br />
</b>
  </div>
  <div class="description">
  <p>
Get the URI defining the namespace associated with the node
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000410_source')" id="l_M000410_source">show source</a> ]</p>
  <div id="M000410_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   namespace_uri
 *
 * Get the URI defining the namespace associated with the node
 */
static VALUE namespace_uri(VALUE self)
{
  xmlTextReaderPtr reader;
  Data_Get_Struct(self, xmlTextReader, reader);
  const char * uri = (const char *)xmlTextReaderConstNamespaceUri(reader);
  if(uri == NULL) return Qnil;

  VALUE MAYBE_UNUSED(enc) = rb_iv_get(self, &quot;@encoding&quot;);
  return NOKOGIRI_STR_NEW2(uri,
      RTEST(enc) ? StringValuePtr(enc) : NULL);
}
</pre>
  </div>
</div>
</div>
<div id="M000418" class="method">
  <div id="M000418_title" class="title">
    <b>namespaces<br />
</b>
  </div>
  <div class="description">
  <p>
Get a hash of namespaces for this <a
href="index.html?a=C00000042&name=Node">Node</a>
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000418_source')" id="l_M000418_source">show source</a> ]</p>
  <div id="M000418_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   namespaces
 *
 * Get a hash of namespaces for this Node
 */
static VALUE namespaces(VALUE self)
{
  xmlTextReaderPtr reader;
  VALUE attr ;

  Data_Get_Struct(self, xmlTextReader, reader);

  attr = rb_hash_new() ;

  if (! has_attributes(reader))
    return attr ;

  xmlNodePtr ptr = xmlTextReaderExpand(reader);
  if(ptr == NULL) return Qnil;

  Nokogiri_xml_node_namespaces(ptr, attr);

  return attr ;
}
</pre>
  </div>
</div>
</div>
<div id="M000411" class="method">
  <div id="M000411_title" class="title">
    <b>prefix<br />
</b>
  </div>
  <div class="description">
  <p>
Get the shorthand reference to the namespace associated with the node.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000411_source')" id="l_M000411_source">show source</a> ]</p>
  <div id="M000411_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   prefix
 *
 * Get the shorthand reference to the namespace associated with the node.
 */
static VALUE prefix(VALUE self)
{
  xmlTextReaderPtr reader;
  Data_Get_Struct(self, xmlTextReader, reader);
  const char * prefix = (const char *)xmlTextReaderConstPrefix(reader);
  if(prefix == NULL) return Qnil;

  VALUE MAYBE_UNUSED(enc) = rb_iv_get(self, &quot;@encoding&quot;);
  return NOKOGIRI_STR_NEW2(prefix,
      RTEST(enc) ? StringValuePtr(enc) : NULL);
}
</pre>
  </div>
</div>
</div>
<div id="M000406" class="method">
  <div id="M000406_title" class="title">
    <b>read<br />
</b>
  </div>
  <div class="description">
  <p>
Move the <a href="index.html?a=C00000047&name=Reader">Reader</a> forward
through the <a href="index.html?a=C00000018&name=XML">XML</a> document.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000406_source')" id="l_M000406_source">show source</a> ]</p>
  <div id="M000406_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   read
 *
 * Move the Reader forward through the XML document.
 */
static VALUE read_more(VALUE self)
{
  xmlTextReaderPtr reader;
  Data_Get_Struct(self, xmlTextReader, reader);

  VALUE error_list = rb_funcall(self, rb_intern(&quot;errors&quot;), 0);

  xmlSetStructuredErrorFunc((void *)error_list, Nokogiri_error_array_pusher);
  int ret = xmlTextReaderRead(reader);
  xmlSetStructuredErrorFunc(NULL, NULL);

  if(ret == 1) return self;
  if(ret == 0) return Qnil;

  xmlErrorPtr error = xmlGetLastError();
  if(error)
    rb_funcall(rb_mKernel, rb_intern(&quot;raise&quot;), 1,
        Nokogiri_wrap_xml_syntax_error((VALUE)NULL, error)
    );
  else
    rb_raise(rb_eRuntimeError, &quot;Error pulling: %d&quot;, ret);

  return Qnil;
}
</pre>
  </div>
</div>
</div>
<div id="M000407" class="method">
  <div id="M000407_title" class="title">
    <b>state<br />
</b>
  </div>
  <div class="description">
  <p>
Get the state of the reader
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000407_source')" id="l_M000407_source">show source</a> ]</p>
  <div id="M000407_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   state
 *
 * Get the state of the reader
 */
static VALUE state(VALUE self)
{
  xmlTextReaderPtr reader;
  Data_Get_Struct(self, xmlTextReader, reader);
  return INT2NUM(xmlTextReaderReadState(reader));
}
</pre>
  </div>
</div>
</div>
<div id="M000412" class="method">
  <div id="M000412_title" class="title">
    <b>value<br />
</b>
  </div>
  <div class="description">
  <p>
Get the text value of the node if present
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000412_source')" id="l_M000412_source">show source</a> ]</p>
  <div id="M000412_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   value
 *
 * Get the text value of the node if present
 */
static VALUE value(VALUE self)
{
  xmlTextReaderPtr reader;
  Data_Get_Struct(self, xmlTextReader, reader);
  const char * value = (const char *)xmlTextReaderConstValue(reader);
  if(value == NULL) return Qnil;

  VALUE MAYBE_UNUSED(enc) = rb_iv_get(self, &quot;@encoding&quot;);
  return NOKOGIRI_STR_NEW2(value,
      RTEST(enc) ? StringValuePtr(enc) : NULL);
}
</pre>
  </div>
</div>
</div>
<div id="M000422" class="method">
  <div id="M000422_title" class="title">
    <b>value?<br />
</b>
  </div>
  <div class="description">
  <p>
Does this node have a text value?
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000422_source')" id="l_M000422_source">show source</a> ]</p>
  <div id="M000422_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   value?
 *
 * Does this node have a text value?
 */
static VALUE value_eh(VALUE self)
{
  xmlTextReaderPtr reader;
  Data_Get_Struct(self, xmlTextReader, reader);
  int eh = xmlTextReaderHasValue(reader);
  if(eh == 0) return Qfalse;
  if(eh == 1) return Qtrue;

  return Qnil;
}
</pre>
  </div>
</div>
</div>
<div id="M000414" class="method">
  <div id="M000414_title" class="title">
    <b>xml_version<br />
</b>
  </div>
  <div class="description">
  <p>
Get the <a href="index.html?a=C00000018&name=XML">XML</a> version of the
document being read
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000414_source')" id="l_M000414_source">show source</a> ]</p>
  <div id="M000414_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *   xml_version
 *
 * Get the XML version of the document being read
 */
static VALUE xml_version(VALUE self)
{
  xmlTextReaderPtr reader;
  Data_Get_Struct(self, xmlTextReader, reader);
  const char * version = (const char *)xmlTextReaderConstXmlVersion(reader);
  if(version == NULL) return Qnil;

  return NOKOGIRI_STR_NEW2(version, &quot;UTF-8&quot;);
}
</pre>
  </div>
</div>
</div>
</div>

  </div>