  <div id="C00000039">
<div class='banner'>
  <span class="file-title-prefix">Class</span><br />NodeSet<br/>
  In:
<a href="#" onclick="jsHref('files/lib/nokogiri/xml/node_set_rb.html');">lib/nokogiri/xml/node_set.rb</a>
<a href="#" onclick="jsHref('files/ext/nokogiri/xml_xpath_context_c.html');">ext/nokogiri/xml_xpath_context.c</a>

Parent:&nbsp;
Object
</div>
 <!-- banner header -->

  <div id="bodyContent" >
      <div id="content">

  <div class="description"><p>
xmlXPathFreeNodeSet() contains an implicit assumption that it is being
called before any of its pointed-to nodes have been free()d. this
assumption lies in the operation where it dereferences nodeTab pointers
while searching for namespace nodes to free.
</p>
<p>
however, since Ruby&#8217;s GC mechanism cannot guarantee the strict order
in which ruby objects will be GC&#8216;d, nodes may be garbage collected
before a nodeset containing pointers to those nodes. (this is true
regardless of how we declare dependencies between objects with
rb_gc_mark().)
</p>
<p>
as a result, xmlXPathFreeNodeSet() will perform unsafe memory operations,
and calling it would be evil.
</p>
<p>
on the bright side, though, <a
href="index.html?a=C00000016&name=Nokogiri">Nokogiri</a>&#8217;s API
currently does not cause namespace nodes to be included in node sets, ever.
</p>
<p>
armed with that fact, we examined xmlXPathFreeNodeSet() and related libxml
code and determined that, within the <a
href="index.html?a=C00000016&name=Nokogiri">Nokogiri</a> abstraction, we
will not leak memory if we simply free the node set&#8217;s memory
directly. that&#8217;s only quasi-evil!
</p>
<p>
there&#8217;s probably a lesson in here somewhere about intermingling,
within a single array, structs with different memory-ownership semantics.
or more generally, a lesson about building an API in C/C++ that does not
contain assumptions about the strict order in which memory will be
released. hey, that sounds like a great idea for a blog post! get to it!
</p>
<p>
&quot;In Valgrind We Trust.&quot; seriously.
</p>
</div>



  <div class="sectiontitle">Methods</div>
  <ul>
  <li><a href="index.html?a=M000278&name=/" >/</a></li>
  <li><a href="index.html?a=M000297&name=[]" >[]</a></li>
  <li><a href="index.html?a=M000282&name=add_class" >add_class</a></li>
  <li><a href="index.html?a=M000276&name=after" >after</a></li>
  <li><a href="index.html?a=M000281&name=at" >at</a></li>
  <li><a href="index.html?a=M000284&name=attr" >attr</a></li>
  <li><a href="index.html?a=M000275&name=before" >before</a></li>
  <li><a href="index.html?a=M000280&name=css" >css</a></li>
  <li><a href="index.html?a=M000301&name=dup" >dup</a></li>
  <li><a href="index.html?a=M000287&name=each" >each</a></li>
  <li><a href="index.html?a=M000274&name=empty?" >empty?</a></li>
  <li><a href="index.html?a=M000272&name=first" >first</a></li>
  <li><a href="index.html?a=M000290&name=inner_html" >inner_html</a></li>
  <li><a href="index.html?a=M000288&name=inner_text" >inner_text</a></li>
  <li><a href="index.html?a=M000273&name=last" >last</a></li>
  <li><a href="index.html?a=M000296&name=length" >length</a></li>
  <li><a href="index.html?a=M000271&name=new" >new</a></li>
  <li><a href="index.html?a=M000298&name=push" >push</a></li>
  <li><a href="index.html?a=M000286&name=remove_attr" >remove_attr</a></li>
  <li><a href="index.html?a=M000283&name=remove_class" >remove_class</a></li>
  <li><a href="index.html?a=M000277&name=search" >search</a></li>
  <li><a href="index.html?a=M000285&name=set" >set</a></li>
  <li><a href="index.html?a=M000289&name=text" >text</a></li>
  <li><a href="index.html?a=M000300&name=to_a" >to_a</a></li>
  <li><a href="index.html?a=M000293&name=to_html" >to_html</a></li>
  <li><a href="index.html?a=M000292&name=to_s" >to_s</a></li>
  <li><a href="index.html?a=M000294&name=to_xhtml" >to_xhtml</a></li>
  <li><a href="index.html?a=M000295&name=to_xml" >to_xml</a></li>
  <li><a href="index.html?a=M000299&name=unlink" >unlink</a></li>
  <li><a href="index.html?a=M000291&name=wrap" >wrap</a></li>
  <li><a href="index.html?a=M000279&name=xpath" >xpath</a></li>
  </ul>

<div class="sectiontitle">Included Modules</div>
<ul>
  <li><a href="#" onclick="jsHref('');">Enumerable</a></li>
</ul>




  <div class="sectiontitle">Attributes</div>
  <table border='0' cellpadding='5'>
  <tr valign='top'>
    <td class='attr-rw'>
[RW]
    </td>
    <td class='attr-name'>document</td>
    <td class='attr-desc'>
The <a href="index.html?a=C00000064&name=Document">Document</a> this <a
href="index.html?a=C00000039&name=NodeSet">NodeSet</a> is associated with

</td>
  </tr>
  </table>

<div class="sectiontitle">Public Class methods</div>
<div id="M000271" class="method">
  <div id="M000271_title" class="title">
    <b>new</b>(document, list = []) {|self if block_given?| ...}
  </div>
  <div class="description">
  <p>
Create a <a href="index.html?a=C00000039&name=NodeSet">NodeSet</a> with
<tt>document</tt> defaulting to <tt>list</tt>
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000271_source')" id="l_M000271_source">show source</a> ]</p>
  <div id="M000271_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File lib/nokogiri/xml/node_set.rb, line 14</span>
14:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span> <span class="ruby-identifier">document</span>, <span class="ruby-identifier">list</span> = []
15:         <span class="ruby-ivar">@document</span> = <span class="ruby-identifier">document</span>
16:         <span class="ruby-identifier">list</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-keyword kw">self</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">x</span> }
17:         <span class="ruby-keyword kw">yield</span> <span class="ruby-keyword kw">self</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block_given?</span>
18:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div class="sectiontitle">Public Instance methods</div>
<div id="M000278" class="method">
  <div id="M000278_title" class="title">
    <b>/</b>(*paths)
  </div>
  <div class="description">
  <p>
Alias for <a href="index.html?a=M000277&name=search">search</a>
</p>
  </div>
</div>
<div id="M000297" class="method">
  <div id="M000297_title" class="title">
    <b>[](i)<br />
</b>
  </div>
  <div class="description">
  <p>
Get the node at index <tt>i</tt>
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000297_source')" id="l_M000297_source">show source</a> ]</p>
  <div id="M000297_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *  [](i)
 *
 * Get the node at index +i+
 */
static VALUE index_at(VALUE self, VALUE number)
{
  int i = NUM2INT(number);
  xmlNodeSetPtr node_set;
  Data_Get_Struct(self, xmlNodeSet, node_set);

  if(i &gt;= node_set-&gt;nodeNr || abs(i) &gt; node_set-&gt;nodeNr)
    return Qnil;

  if(i &lt; 0)
    i = i + node_set-&gt;nodeNr;

  return Nokogiri_wrap_xml_node(node_set-&gt;nodeTab[i]);
}
</pre>
  </div>
</div>
</div>
<div id="M000282" class="method">
  <div id="M000282_title" class="title">
    <b>add_class</b>(name)
  </div>
  <div class="description">
  <p>
Append the class attribute <tt>name</tt> to all <a
href="index.html?a=C00000042&name=Node">Node</a> objects in the <a
href="index.html?a=C00000039&name=NodeSet">NodeSet</a>.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000282_source')" id="l_M000282_source">show source</a> ]</p>
  <div id="M000282_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File lib/nokogiri/xml/node_set.rb, line 83</span>
83:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">add_class</span> <span class="ruby-identifier">name</span>
84:         <span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">el</span><span class="ruby-operator">|</span>
85:           <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">el</span>.<span class="ruby-identifier">respond_to?</span> <span class="ruby-identifier">:get_attribute</span>
86:           <span class="ruby-identifier">classes</span> = <span class="ruby-identifier">el</span>.<span class="ruby-identifier">get_attribute</span>(<span class="ruby-value str">'class'</span>).<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot; &quot;</span>)
87:           <span class="ruby-identifier">el</span>.<span class="ruby-identifier">set_attribute</span>(<span class="ruby-value str">'class'</span>, <span class="ruby-identifier">classes</span>.<span class="ruby-identifier">push</span>(<span class="ruby-identifier">name</span>).<span class="ruby-identifier">uniq</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot; &quot;</span>))
88:         <span class="ruby-keyword kw">end</span>
89:         <span class="ruby-keyword kw">self</span>
90:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000276" class="method">
  <div id="M000276_title" class="title">
    <b>after</b>(datum)
  </div>
  <div class="description">
  <p>
Insert <tt>datum</tt> after the last <a
href="index.html?a=C00000042&name=Node">Node</a> in this <a
href="index.html?a=C00000039&name=NodeSet">NodeSet</a>
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000276_source')" id="l_M000276_source">show source</a> ]</p>
  <div id="M000276_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File lib/nokogiri/xml/node_set.rb, line 46</span>
46:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">after</span> <span class="ruby-identifier">datum</span>
47:         <span class="ruby-identifier">last</span>.<span class="ruby-identifier">after</span> <span class="ruby-identifier">datum</span>
48:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000281" class="method">
  <div id="M000281_title" class="title">
    <b>at</b>(path, ns = document.root ? document.root.namespaces : {})
  </div>
  <div class="description">
  <p>
If path is a string, search this document for <tt>path</tt> returning the
first <a href="index.html?a=C00000042&name=Node">Node</a>. Otherwise, index
in to the array with <tt>path</tt>.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000281_source')" id="l_M000281_source">show source</a> ]</p>
  <div id="M000281_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File lib/nokogiri/xml/node_set.rb, line 76</span>
76:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">at</span> <span class="ruby-identifier">path</span>, <span class="ruby-identifier">ns</span> = <span class="ruby-identifier">document</span>.<span class="ruby-identifier">root</span> <span class="ruby-value">? </span><span class="ruby-identifier">document</span>.<span class="ruby-identifier">root</span>.<span class="ruby-identifier">namespaces</span> <span class="ruby-operator">:</span> {}
77:         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">self</span>[<span class="ruby-identifier">path</span>] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">path</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Numeric</span>)
78:         <span class="ruby-identifier">search</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">ns</span>).<span class="ruby-identifier">first</span>
79:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000284" class="method">
  <div id="M000284_title" class="title">
    <b>attr</b>(key, value = nil, &amp;blk)
  </div>
  <div class="description">
  <p>
Set the attribute <tt>key</tt> to <tt>value</tt> or the return value of
<tt>blk</tt> on all <a href="index.html?a=C00000042&name=Node">Node</a>
objects in the <a href="index.html?a=C00000039&name=NodeSet">NodeSet</a>.
</p>
  </div>
<div class="aka">
  This method is also aliased as
  <a href="index.html?a=M000285&name=set">set</a>
</div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000284_source')" id="l_M000284_source">show source</a> ]</p>
  <div id="M000284_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File lib/nokogiri/xml/node_set.rb, line 110</span>
110:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">attr</span> <span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">blk</span>
111:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">value</span> <span class="ruby-keyword kw">or</span> <span class="ruby-identifier">blk</span>
112:           <span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">el</span><span class="ruby-operator">|</span>
113:             <span class="ruby-identifier">el</span>.<span class="ruby-identifier">set_attribute</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">blk</span>[<span class="ruby-identifier">el</span>])
114:           <span class="ruby-keyword kw">end</span>
115:           <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">self</span>      
116:         <span class="ruby-keyword kw">end</span>    
117:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">key</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">Hash</span>
118:           <span class="ruby-identifier">key</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>,<span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">attr</span>(<span class="ruby-identifier">k</span>,<span class="ruby-identifier">v</span>) }
119:           <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">self</span>
120:         <span class="ruby-keyword kw">else</span>
121:           <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">self</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">get_attribute</span>(<span class="ruby-identifier">key</span>)
122:         <span class="ruby-keyword kw">end</span>
123:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000275" class="method">
  <div id="M000275_title" class="title">
    <b>before</b>(datum)
  </div>
  <div class="description">
  <p>
Insert <tt>datum</tt> before the first <a
href="index.html?a=C00000042&name=Node">Node</a> in this <a
href="index.html?a=C00000039&name=NodeSet">NodeSet</a>
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000275_source')" id="l_M000275_source">show source</a> ]</p>
  <div id="M000275_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File lib/nokogiri/xml/node_set.rb, line 40</span>
40:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">before</span> <span class="ruby-identifier">datum</span>
41:         <span class="ruby-identifier">first</span>.<span class="ruby-identifier">before</span> <span class="ruby-identifier">datum</span>
42:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000280" class="method">
  <div id="M000280_title" class="title">
    <b>css</b>(*paths)
  </div>
  <div class="description">
  <p>
Alias for <a href="index.html?a=M000277&name=search">search</a>
</p>
  </div>
</div>
<div id="M000301" class="method">
  <div id="M000301_title" class="title">
    <b>dup<br />
</b>
  </div>
  <div class="description">
  <p>
Duplicate this node set
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000301_source')" id="l_M000301_source">show source</a> ]</p>
  <div id="M000301_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *  dup
 *
 * Duplicate this node set
 */
static VALUE duplicate(VALUE self)
{
  xmlNodeSetPtr node_set;
  Data_Get_Struct(self, xmlNodeSet, node_set);

  xmlNodeSetPtr dupl = xmlXPathNodeSetCreate(NULL);
  int i;
  for(i = 0; i &lt; node_set-&gt;nodeNr; i++) {
    xmlXPathNodeSetAdd(dupl, node_set-&gt;nodeTab[i]);
  }

  return Nokogiri_wrap_xml_node_set(dupl);
}
</pre>
  </div>
</div>
</div>
<div id="M000287" class="method">
  <div id="M000287_title" class="title">
    <b>each</b>() {|self[x]| ...}
  </div>
  <div class="description">
  <p>
Iterate over each node, yielding to <tt>block</tt>
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000287_source')" id="l_M000287_source">show source</a> ]</p>
  <div id="M000287_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File lib/nokogiri/xml/node_set.rb, line 138</span>
138:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">each</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
139:         <span class="ruby-value">0</span>.<span class="ruby-identifier">upto</span>(<span class="ruby-identifier">length</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span>
140:           <span class="ruby-keyword kw">yield</span> <span class="ruby-keyword kw">self</span>[<span class="ruby-identifier">x</span>]
141:         <span class="ruby-keyword kw">end</span>
142:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000274" class="method">
  <div id="M000274_title" class="title">
    <b>empty?</b>()
  </div>
  <div class="description">
  <p>
Is this <a href="index.html?a=C00000039&name=NodeSet">NodeSet</a> empty?
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000274_source')" id="l_M000274_source">show source</a> ]</p>
  <div id="M000274_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File lib/nokogiri/xml/node_set.rb, line 34</span>
34:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">empty?</span>
35:         <span class="ruby-identifier">length</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
36:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000272" class="method">
  <div id="M000272_title" class="title">
    <b>first</b>()
  </div>
  <div class="description">
  <p>
Get the first element of the <a
href="index.html?a=C00000039&name=NodeSet">NodeSet</a>.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000272_source')" id="l_M000272_source">show source</a> ]</p>
  <div id="M000272_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File lib/nokogiri/xml/node_set.rb, line 22</span>
22:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">first</span>
23:         <span class="ruby-keyword kw">self</span>[<span class="ruby-value">0</span>]
24:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000290" class="method">
  <div id="M000290_title" class="title">
    <b>inner_html</b>()
  </div>
  <div class="description">
  <p>
Get the inner html of all contained <a
href="index.html?a=C00000042&name=Node">Node</a> objects
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000290_source')" id="l_M000290_source">show source</a> ]</p>
  <div id="M000290_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File lib/nokogiri/xml/node_set.rb, line 153</span>
153:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">inner_html</span>
154:         <span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">j</span><span class="ruby-operator">|</span> <span class="ruby-identifier">j</span>.<span class="ruby-identifier">inner_html</span>}.<span class="ruby-identifier">join</span>(<span class="ruby-value str">''</span>)
155:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000288" class="method">
  <div id="M000288_title" class="title">
    <b>inner_text</b>()
  </div>
  <div class="description">
  <p>
Get the inner text of all contained <a
href="index.html?a=C00000042&name=Node">Node</a> objects
</p>
  </div>
<div class="aka">
  This method is also aliased as
  <a href="index.html?a=M000289&name=text">text</a>
</div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000288_source')" id="l_M000288_source">show source</a> ]</p>
  <div id="M000288_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File lib/nokogiri/xml/node_set.rb, line 146</span>
146:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">inner_text</span>
147:         <span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">j</span><span class="ruby-operator">|</span> <span class="ruby-identifier">j</span>.<span class="ruby-identifier">inner_text</span>}.<span class="ruby-identifier">join</span>(<span class="ruby-value str">''</span>)
148:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000273" class="method">
  <div id="M000273_title" class="title">
    <b>last</b>()
  </div>
  <div class="description">
  <p>
Get the last element of the <a
href="index.html?a=C00000039&name=NodeSet">NodeSet</a>.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000273_source')" id="l_M000273_source">show source</a> ]</p>
  <div id="M000273_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File lib/nokogiri/xml/node_set.rb, line 28</span>
28:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">last</span>
29:         <span class="ruby-keyword kw">self</span>[<span class="ruby-identifier">length</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>]
30:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000296" class="method">
  <div id="M000296_title" class="title">
    <b>length<br />
</b>
  </div>
  <div class="description">
  <p>
Get the length of the node set
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000296_source')" id="l_M000296_source">show source</a> ]</p>
  <div id="M000296_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *  length
 *
 * Get the length of the node set
 */
static VALUE length(VALUE self)
{
  xmlNodeSetPtr node_set;
  Data_Get_Struct(self, xmlNodeSet, node_set);

  if(node_set)
    return INT2NUM(node_set-&gt;nodeNr);

  return INT2NUM(0);
}
</pre>
  </div>
</div>
</div>
<div id="M000298" class="method">
  <div id="M000298_title" class="title">
    <b>push(node)<br />
</b>
  </div>
  <div class="description">
  <p>
Append <tt>node</tt> to the <a
href="index.html?a=C00000039&name=NodeSet">NodeSet</a>.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000298_source')" id="l_M000298_source">show source</a> ]</p>
  <div id="M000298_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *  push(node)
 *
 * Append +node+ to the NodeSet.
 */
static VALUE push(VALUE self, VALUE rb_node)
{
  xmlNodeSetPtr node_set;
  xmlNodePtr node;

  if(! rb_funcall(rb_node, rb_intern(&quot;is_a?&quot;), 1, cNokogiriXmlNode))
    rb_raise(rb_eArgError, &quot;node must be a Nokogiri::XML::Node&quot;);

  Data_Get_Struct(self, xmlNodeSet, node_set);
  Data_Get_Struct(rb_node, xmlNode, node);
  xmlXPathNodeSetAdd(node_set, node);
  return self;
}
</pre>
  </div>
</div>
</div>
<div id="M000286" class="method">
  <div id="M000286_title" class="title">
    <b>remove_attr</b>(name)
  </div>
  <div class="description">
  <p>
Remove the attributed named <tt>name</tt> from all <a
href="index.html?a=C00000042&name=Node">Node</a> objects in the <a
href="index.html?a=C00000039&name=NodeSet">NodeSet</a>
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000286_source')" id="l_M000286_source">show source</a> ]</p>
  <div id="M000286_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File lib/nokogiri/xml/node_set.rb, line 128</span>
128:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">remove_attr</span> <span class="ruby-identifier">name</span>
129:         <span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">el</span><span class="ruby-operator">|</span>
130:           <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">el</span>.<span class="ruby-identifier">respond_to?</span> <span class="ruby-identifier">:remove_attribute</span>
131:           <span class="ruby-identifier">el</span>.<span class="ruby-identifier">remove_attribute</span>(<span class="ruby-identifier">name</span>)
132:         <span class="ruby-keyword kw">end</span>
133:         <span class="ruby-keyword kw">self</span>      
134:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000283" class="method">
  <div id="M000283_title" class="title">
    <b>remove_class</b>(name = nil)
  </div>
  <div class="description">
  <p>
Remove the class attribute <tt>name</tt> from all <a
href="index.html?a=C00000042&name=Node">Node</a> objects in the <a
href="index.html?a=C00000039&name=NodeSet">NodeSet</a>.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000283_source')" id="l_M000283_source">show source</a> ]</p>
  <div id="M000283_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File lib/nokogiri/xml/node_set.rb, line 94</span>
 94:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">remove_class</span> <span class="ruby-identifier">name</span> = <span class="ruby-keyword kw">nil</span>
 95:         <span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">el</span><span class="ruby-operator">|</span>
 96:           <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">el</span>.<span class="ruby-identifier">respond_to?</span> <span class="ruby-identifier">:get_attribute</span>
 97:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">name</span>
 98:             <span class="ruby-identifier">classes</span> = <span class="ruby-identifier">el</span>.<span class="ruby-identifier">get_attribute</span>(<span class="ruby-value str">'class'</span>).<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot; &quot;</span>)
 99:             <span class="ruby-identifier">el</span>.<span class="ruby-identifier">set_attribute</span>(<span class="ruby-value str">'class'</span>, (<span class="ruby-identifier">classes</span> <span class="ruby-operator">-</span> [<span class="ruby-identifier">name</span>]).<span class="ruby-identifier">uniq</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot; &quot;</span>))
100:           <span class="ruby-keyword kw">else</span>
101:             <span class="ruby-identifier">el</span>.<span class="ruby-identifier">remove_attribute</span>(<span class="ruby-value str">&quot;class&quot;</span>)
102:           <span class="ruby-keyword kw">end</span>
103:         <span class="ruby-keyword kw">end</span>
104:         <span class="ruby-keyword kw">self</span>
105:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000277" class="method">
  <div id="M000277_title" class="title">
    <b>search</b>(*paths)
  </div>
  <div class="description">
  <p>
Search this document for <tt>paths</tt>
</p>
<p>
For more information see <a
href="index.html?a=M000307&name=Nokogiri::XML::Node#css">Nokogiri::XML::Node#css</a>
and <a
href="index.html?a=M000306&name=Nokogiri::XML::Node#xpath">Nokogiri::XML::Node#xpath</a>
</p>
  </div>
<div class="aka">
  This method is also aliased as
  <a href="index.html?a=M000278&name=/">/</a>
  <a href="index.html?a=M000279&name=xpath">xpath</a>
  <a href="index.html?a=M000280&name=css">css</a>
</div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000277_source')" id="l_M000277_source">show source</a> ]</p>
  <div id="M000277_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File lib/nokogiri/xml/node_set.rb, line 58</span>
58:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">search</span> <span class="ruby-operator">*</span><span class="ruby-identifier">paths</span>
59:         <span class="ruby-identifier">ns</span> = <span class="ruby-identifier">paths</span>.<span class="ruby-identifier">last</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">paths</span>.<span class="ruby-identifier">pop</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">document</span>.<span class="ruby-identifier">root</span>.<span class="ruby-identifier">namespaces</span>
60:         <span class="ruby-identifier">sub_set</span> = <span class="ruby-constant">NodeSet</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">document</span>)
61:         <span class="ruby-identifier">document</span>.<span class="ruby-identifier">decorate</span>(<span class="ruby-identifier">sub_set</span>)
62:         <span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">node</span><span class="ruby-operator">|</span>
63:           <span class="ruby-identifier">node</span>.<span class="ruby-identifier">search</span>(<span class="ruby-operator">*</span>(<span class="ruby-identifier">paths</span> <span class="ruby-operator">+</span> [<span class="ruby-identifier">ns</span>])).<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">sub_node</span><span class="ruby-operator">|</span>
64:             <span class="ruby-identifier">sub_set</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">sub_node</span>
65:           <span class="ruby-keyword kw">end</span>
66:         <span class="ruby-keyword kw">end</span>
67:         <span class="ruby-identifier">sub_set</span>
68:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000285" class="method">
  <div id="M000285_title" class="title">
    <b>set</b>(key, value = nil, &amp;blk)
  </div>
  <div class="description">
  <p>
Alias for <a href="index.html?a=M000284&name=attr">attr</a>
</p>
  </div>
</div>
<div id="M000289" class="method">
  <div id="M000289_title" class="title">
    <b>text</b>()
  </div>
  <div class="description">
  <p>
Alias for <a href="index.html?a=M000288&name=inner_text">inner_text</a>
</p>
  </div>
</div>
<div id="M000300" class="method">
  <div id="M000300_title" class="title">
    <b>to_a<br />
</b>
  </div>
  <div class="description">
  <p>
Return this list as an Array
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000300_source')" id="l_M000300_source">show source</a> ]</p>
  <div id="M000300_source" class="dyn-source">
<pre>
/*
 * call-seq:
 *  to_a
 *
 * Return this list as an Array
 */
static VALUE to_array(VALUE self, VALUE rb_node)
{
  xmlNodeSetPtr set;
  Data_Get_Struct(self, xmlNodeSet, set);

  VALUE *elts = calloc((size_t)set-&gt;nodeNr, sizeof(VALUE *));
  int i;
  for(i = 0; i &lt; set-&gt;nodeNr; i++) {
    if(set-&gt;nodeTab[i]-&gt;_private) {
      elts[i] = (VALUE)set-&gt;nodeTab[i]-&gt;_private;
    } else {
      elts[i] = Nokogiri_wrap_xml_node(set-&gt;nodeTab[i]);
    }
  }

  VALUE list = rb_ary_new4(set-&gt;nodeNr, elts);

  free(elts);

  return list;
}
</pre>
  </div>
</div>
</div>
<div id="M000293" class="method">
  <div id="M000293_title" class="title">
    <b>to_html</b>(*args)
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000293_source')" id="l_M000293_source">show source</a> ]</p>
  <div id="M000293_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File lib/nokogiri/xml/node_set.rb, line 172</span>
172:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">to_html</span> <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>
173:         <span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">x</span>.<span class="ruby-identifier">to_html</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>) }.<span class="ruby-identifier">join</span>(<span class="ruby-value str">''</span>)
174:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000292" class="method">
  <div id="M000292_title" class="title">
    <b>to_s</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000292_source')" id="l_M000292_source">show source</a> ]</p>
  <div id="M000292_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File lib/nokogiri/xml/node_set.rb, line 168</span>
168:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">to_s</span>
169:         <span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">x</span>.<span class="ruby-identifier">to_s</span> }.<span class="ruby-identifier">join</span>
170:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000294" class="method">
  <div id="M000294_title" class="title">
    <b>to_xhtml</b>(*args)
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000294_source')" id="l_M000294_source">show source</a> ]</p>
  <div id="M000294_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File lib/nokogiri/xml/node_set.rb, line 176</span>
176:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">to_xhtml</span> <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>
177:         <span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">x</span>.<span class="ruby-identifier">to_xhtml</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>) }.<span class="ruby-identifier">join</span>(<span class="ruby-value str">''</span>)
178:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000295" class="method">
  <div id="M000295_title" class="title">
    <b>to_xml</b>(*args)
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000295_source')" id="l_M000295_source">show source</a> ]</p>
  <div id="M000295_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File lib/nokogiri/xml/node_set.rb, line 180</span>
180:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">to_xml</span> <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>
181:         <span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">x</span>.<span class="ruby-identifier">to_xml</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>) }.<span class="ruby-identifier">join</span>(<span class="ruby-value str">''</span>)
182:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000299" class="method">
  <div id="M000299_title" class="title">
    <b>unlink<br />
</b>
  </div>
  <div class="description">
  <p>
Unlink this <a href="index.html?a=C00000039&name=NodeSet">NodeSet</a> and
all <a href="index.html?a=C00000042&name=Node">Node</a> objects it contains
from their current context.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000299_source')" id="l_M000299_source">show source</a> ]</p>
  <div id="M000299_source" class="dyn-source">
<pre>
/*
 *  call-seq:
 *    unlink
 *
 * Unlink this NodeSet and all Node objects it contains from their current context.
 */
static VALUE unlink_nodeset(VALUE self)
{
  xmlNodeSetPtr node_set;
  int j, nodeNr ;

  Data_Get_Struct(self, xmlNodeSet, node_set);
  nodeNr = node_set-&gt;nodeNr ;
  for (j = 0 ; j &lt; nodeNr ; j++) {
    VALUE node ;
    xmlNodePtr node_ptr;
    node = Nokogiri_wrap_xml_node(node_set-&gt;nodeTab[j]);
    rb_funcall(node, rb_intern(&quot;unlink&quot;), 0); /* modifies the C struct out from under the object */
    Data_Get_Struct(node, xmlNode, node_ptr);
    node_set-&gt;nodeTab[j] = node_ptr ;
  }
  return self ;
}
</pre>
  </div>
</div>
</div>
<div id="M000291" class="method">
  <div id="M000291_title" class="title">
    <b>wrap</b>(html, &amp;blk)
  </div>
  <div class="description">
  <p>
Wrap this <a href="index.html?a=C00000039&name=NodeSet">NodeSet</a> with
<tt>html</tt> or the results of the builder in <tt>blk</tt>
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000291_source')" id="l_M000291_source">show source</a> ]</p>
  <div id="M000291_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File lib/nokogiri/xml/node_set.rb, line 159</span>
159:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">wrap</span>(<span class="ruby-identifier">html</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">blk</span>)
160:         <span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">j</span><span class="ruby-operator">|</span>
161:           <span class="ruby-identifier">new_parent</span> = <span class="ruby-constant">Nokogiri</span>.<span class="ruby-identifier">make</span>(<span class="ruby-identifier">html</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">blk</span>)
162:           <span class="ruby-identifier">j</span>.<span class="ruby-identifier">parent</span>.<span class="ruby-identifier">add_child</span>(<span class="ruby-identifier">new_parent</span>)
163:           <span class="ruby-identifier">new_parent</span>.<span class="ruby-identifier">add_child</span>(<span class="ruby-identifier">j</span>)
164:         <span class="ruby-keyword kw">end</span>
165:         <span class="ruby-keyword kw">self</span>
166:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000279" class="method">
  <div id="M000279_title" class="title">
    <b>xpath</b>(*paths)
  </div>
  <div class="description">
  <p>
Alias for <a href="index.html?a=M000277&name=search">search</a>
</p>
  </div>
</div>
</div>

  </div>