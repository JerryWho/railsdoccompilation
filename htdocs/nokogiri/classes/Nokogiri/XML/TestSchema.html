  <div id="C00000075">
<div class='banner'>
  <span class="file-title-prefix">Class</span><br />TestSchema<br/>
  In:
<a href="#" onclick="jsHref('files/test/xml/test_schema_rb.html');">test/xml/test_schema.rb</a>

Parent:&nbsp;
Nokogiri::TestCase
</div>
 <!-- banner header -->

  <div id="bodyContent" >
      <div id="content">




  <div class="sectiontitle">Methods</div>
  <ul>
  <li><a href="index.html?a=M000765&name=setup" >setup</a></li>
  <li><a href="index.html?a=M000770&name=test_new" >test_new</a></li>
  <li><a href="index.html?a=M000772&name=test_parse_with_errors" >test_parse_with_errors</a></li>
  <li><a href="index.html?a=M000771&name=test_parse_with_io" >test_parse_with_io</a></li>
  <li><a href="index.html?a=M000769&name=test_parse_with_memory" >test_parse_with_memory</a></li>
  <li><a href="index.html?a=M000766&name=test_schema_from_document" >test_schema_from_document</a></li>
  <li><a href="index.html?a=M000767&name=test_schema_from_document_node" >test_schema_from_document_node</a></li>
  <li><a href="index.html?a=M000768&name=test_schema_validates_with_relative_paths" >test_schema_validates_with_relative_paths</a></li>
  <li><a href="index.html?a=M000776&name=test_valid?" >test_valid?</a></li>
  <li><a href="index.html?a=M000773&name=test_validate_document" >test_validate_document</a></li>
  <li><a href="index.html?a=M000774&name=test_validate_file" >test_validate_file</a></li>
  <li><a href="index.html?a=M000775&name=test_validate_invalid_document" >test_validate_invalid_document</a></li>
  </ul>






<div class="sectiontitle">Public Instance methods</div>
<div id="M000765" class="method">
  <div id="M000765_title" class="title">
    <b>setup</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000765_source')" id="l_M000765_source">show source</a> ]</p>
  <div id="M000765_source" class="dyn-source">
<pre>
   <span class="ruby-comment cmt"># File test/xml/test_schema.rb, line 6</span>
6:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">setup</span>
7:         <span class="ruby-identifier">assert</span> <span class="ruby-ivar">@xsd</span> = <span class="ruby-constant">Nokogiri</span><span class="ruby-operator">::</span><span class="ruby-constant">XML</span><span class="ruby-operator">::</span><span class="ruby-constant">Schema</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span>(<span class="ruby-constant">PO_SCHEMA_FILE</span>))
8:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000770" class="method">
  <div id="M000770_title" class="title">
    <b>test_new</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000770_source')" id="l_M000770_source">show source</a> ]</p>
  <div id="M000770_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File test/xml/test_schema.rb, line 39</span>
39:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_new</span>
40:         <span class="ruby-identifier">assert</span> <span class="ruby-identifier">xsd</span> = <span class="ruby-constant">Nokogiri</span><span class="ruby-operator">::</span><span class="ruby-constant">XML</span><span class="ruby-operator">::</span><span class="ruby-constant">Schema</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span>(<span class="ruby-constant">PO_SCHEMA_FILE</span>))
41:         <span class="ruby-identifier">assert_instance_of</span> <span class="ruby-constant">Nokogiri</span><span class="ruby-operator">::</span><span class="ruby-constant">XML</span><span class="ruby-operator">::</span><span class="ruby-constant">Schema</span>, <span class="ruby-identifier">xsd</span>
42:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000772" class="method">
  <div id="M000772_title" class="title">
    <b>test_parse_with_errors</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000772_source')" id="l_M000772_source">show source</a> ]</p>
  <div id="M000772_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File test/xml/test_schema.rb, line 52</span>
52:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_parse_with_errors</span>
53:         <span class="ruby-identifier">xml</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span>(<span class="ruby-constant">PO_SCHEMA_FILE</span>).<span class="ruby-identifier">sub</span>(<span class="ruby-regexp re">/name=&quot;/</span>, <span class="ruby-value str">'name='</span>)
54:         <span class="ruby-identifier">assert_raises</span>(<span class="ruby-constant">Nokogiri</span><span class="ruby-operator">::</span><span class="ruby-constant">XML</span><span class="ruby-operator">::</span><span class="ruby-constant">SyntaxError</span>) {
55:           <span class="ruby-constant">Nokogiri</span><span class="ruby-operator">::</span><span class="ruby-constant">XML</span><span class="ruby-operator">::</span><span class="ruby-constant">Schema</span>(<span class="ruby-identifier">xml</span>)
56:         }
57:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000771" class="method">
  <div id="M000771_title" class="title">
    <b>test_parse_with_io</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000771_source')" id="l_M000771_source">show source</a> ]</p>
  <div id="M000771_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File test/xml/test_schema.rb, line 44</span>
44:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_parse_with_io</span>
45:         <span class="ruby-identifier">xsd</span> = <span class="ruby-keyword kw">nil</span>
46:         <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-constant">PO_SCHEMA_FILE</span>, <span class="ruby-value str">'rb'</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>
47:           <span class="ruby-identifier">assert</span> <span class="ruby-identifier">xsd</span> = <span class="ruby-constant">Nokogiri</span><span class="ruby-operator">::</span><span class="ruby-constant">XML</span><span class="ruby-operator">::</span><span class="ruby-constant">Schema</span>(<span class="ruby-identifier">f</span>)
48:         }
49:         <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-identifier">xsd</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">length</span>
50:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000769" class="method">
  <div id="M000769_title" class="title">
    <b>test_parse_with_memory</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000769_source')" id="l_M000769_source">show source</a> ]</p>
  <div id="M000769_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File test/xml/test_schema.rb, line 34</span>
34:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_parse_with_memory</span>
35:         <span class="ruby-identifier">assert_instance_of</span> <span class="ruby-constant">Nokogiri</span><span class="ruby-operator">::</span><span class="ruby-constant">XML</span><span class="ruby-operator">::</span><span class="ruby-constant">Schema</span>, <span class="ruby-ivar">@xsd</span>
36:         <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-ivar">@xsd</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">length</span>
37:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000766" class="method">
  <div id="M000766_title" class="title">
    <b>test_schema_from_document</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000766_source')" id="l_M000766_source">show source</a> ]</p>
  <div id="M000766_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File test/xml/test_schema.rb, line 10</span>
10:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_schema_from_document</span>
11:         <span class="ruby-identifier">doc</span> = <span class="ruby-constant">Nokogiri</span><span class="ruby-operator">::</span><span class="ruby-constant">XML</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-constant">PO_SCHEMA_FILE</span>))
12:         <span class="ruby-identifier">assert</span> <span class="ruby-identifier">doc</span>
13:         <span class="ruby-identifier">xsd</span> = <span class="ruby-constant">Nokogiri</span><span class="ruby-operator">::</span><span class="ruby-constant">XML</span><span class="ruby-operator">::</span><span class="ruby-constant">Schema</span>.<span class="ruby-identifier">from_document</span> <span class="ruby-identifier">doc</span>
14:         <span class="ruby-identifier">assert_instance_of</span> <span class="ruby-constant">Nokogiri</span><span class="ruby-operator">::</span><span class="ruby-constant">XML</span><span class="ruby-operator">::</span><span class="ruby-constant">Schema</span>, <span class="ruby-identifier">xsd</span>
15:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000767" class="method">
  <div id="M000767_title" class="title">
    <b>test_schema_from_document_node</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000767_source')" id="l_M000767_source">show source</a> ]</p>
  <div id="M000767_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File test/xml/test_schema.rb, line 17</span>
17:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_schema_from_document_node</span>
18:         <span class="ruby-identifier">doc</span> = <span class="ruby-constant">Nokogiri</span><span class="ruby-operator">::</span><span class="ruby-constant">XML</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-constant">PO_SCHEMA_FILE</span>))
19:         <span class="ruby-identifier">assert</span> <span class="ruby-identifier">doc</span>
20:         <span class="ruby-identifier">xsd</span> = <span class="ruby-constant">Nokogiri</span><span class="ruby-operator">::</span><span class="ruby-constant">XML</span><span class="ruby-operator">::</span><span class="ruby-constant">Schema</span>.<span class="ruby-identifier">from_document</span> <span class="ruby-identifier">doc</span>.<span class="ruby-identifier">root</span>
21:         <span class="ruby-identifier">assert_instance_of</span> <span class="ruby-constant">Nokogiri</span><span class="ruby-operator">::</span><span class="ruby-constant">XML</span><span class="ruby-operator">::</span><span class="ruby-constant">Schema</span>, <span class="ruby-identifier">xsd</span>
22:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000768" class="method">
  <div id="M000768_title" class="title">
    <b>test_schema_validates_with_relative_paths</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000768_source')" id="l_M000768_source">show source</a> ]</p>
  <div id="M000768_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File test/xml/test_schema.rb, line 24</span>
24:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_schema_validates_with_relative_paths</span>
25:         <span class="ruby-identifier">xsd</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-constant">ASSETS_DIR</span>, <span class="ruby-value str">'foo'</span>, <span class="ruby-value str">'foo.xsd'</span>)
26:         <span class="ruby-identifier">xml</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-constant">ASSETS_DIR</span>, <span class="ruby-value str">'valid_bar.xml'</span>)
27:         <span class="ruby-identifier">doc</span> = <span class="ruby-constant">Nokogiri</span><span class="ruby-operator">::</span><span class="ruby-constant">XML</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">xsd</span>))
28:         <span class="ruby-identifier">xsd</span> = <span class="ruby-constant">Nokogiri</span><span class="ruby-operator">::</span><span class="ruby-constant">XML</span><span class="ruby-operator">::</span><span class="ruby-constant">Schema</span>.<span class="ruby-identifier">from_document</span> <span class="ruby-identifier">doc</span>
29: 
30:         <span class="ruby-identifier">doc</span> = <span class="ruby-constant">Nokogiri</span><span class="ruby-operator">::</span><span class="ruby-constant">XML</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">xml</span>))
31:         <span class="ruby-identifier">assert</span> <span class="ruby-identifier">xsd</span>.<span class="ruby-identifier">valid?</span>(<span class="ruby-identifier">doc</span>)
32:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000776" class="method">
  <div id="M000776_title" class="title">
    <b>test_valid?</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000776_source')" id="l_M000776_source">show source</a> ]</p>
  <div id="M000776_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File test/xml/test_schema.rb, line 77</span>
77:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_valid?</span>
78:         <span class="ruby-identifier">valid_doc</span> = <span class="ruby-constant">Nokogiri</span><span class="ruby-operator">::</span><span class="ruby-constant">XML</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span>(<span class="ruby-constant">PO_XML_FILE</span>))
79: 
80:         <span class="ruby-identifier">invalid_doc</span> = <span class="ruby-constant">Nokogiri</span><span class="ruby-operator">::</span><span class="ruby-constant">XML</span>(
81:           <span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span>(<span class="ruby-constant">PO_XML_FILE</span>).<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/&lt;city&gt;[^&lt;]*&lt;\/city&gt;/</span>, <span class="ruby-value str">''</span>)
82:         )
83: 
84:         <span class="ruby-identifier">assert</span>(<span class="ruby-ivar">@xsd</span>.<span class="ruby-identifier">valid?</span>(<span class="ruby-identifier">valid_doc</span>))
85:         <span class="ruby-identifier">assert</span>(<span class="ruby-operator">!</span><span class="ruby-ivar">@xsd</span>.<span class="ruby-identifier">valid?</span>(<span class="ruby-identifier">invalid_doc</span>))
86:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000773" class="method">
  <div id="M000773_title" class="title">
    <b>test_validate_document</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000773_source')" id="l_M000773_source">show source</a> ]</p>
  <div id="M000773_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File test/xml/test_schema.rb, line 59</span>
59:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_document</span>
60:         <span class="ruby-identifier">doc</span> = <span class="ruby-constant">Nokogiri</span><span class="ruby-operator">::</span><span class="ruby-constant">XML</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span>(<span class="ruby-constant">PO_XML_FILE</span>))
61:         <span class="ruby-identifier">assert</span> <span class="ruby-identifier">errors</span> = <span class="ruby-ivar">@xsd</span>.<span class="ruby-identifier">validate</span>(<span class="ruby-identifier">doc</span>)
62:         <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-identifier">errors</span>.<span class="ruby-identifier">length</span>
63:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000774" class="method">
  <div id="M000774_title" class="title">
    <b>test_validate_file</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000774_source')" id="l_M000774_source">show source</a> ]</p>
  <div id="M000774_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File test/xml/test_schema.rb, line 65</span>
65:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_file</span>
66:         <span class="ruby-identifier">assert</span> <span class="ruby-identifier">errors</span> = <span class="ruby-ivar">@xsd</span>.<span class="ruby-identifier">validate</span>(<span class="ruby-constant">PO_XML_FILE</span>)
67:         <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">0</span>, <span class="ruby-identifier">errors</span>.<span class="ruby-identifier">length</span>
68:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000775" class="method">
  <div id="M000775_title" class="title">
    <b>test_validate_invalid_document</b>()
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000775_source')" id="l_M000775_source">show source</a> ]</p>
  <div id="M000775_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File test/xml/test_schema.rb, line 70</span>
70:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_validate_invalid_document</span>
71:         <span class="ruby-identifier">read_doc</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span>(<span class="ruby-constant">PO_XML_FILE</span>).<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/&lt;city&gt;[^&lt;]*&lt;\/city&gt;/</span>, <span class="ruby-value str">''</span>)
72: 
73:         <span class="ruby-identifier">assert</span> <span class="ruby-identifier">errors</span> = <span class="ruby-ivar">@xsd</span>.<span class="ruby-identifier">validate</span>(<span class="ruby-constant">Nokogiri</span><span class="ruby-operator">::</span><span class="ruby-constant">XML</span>(<span class="ruby-identifier">read_doc</span>))
74:         <span class="ruby-identifier">assert_equal</span> <span class="ruby-value">2</span>, <span class="ruby-identifier">errors</span>.<span class="ruby-identifier">length</span>
75:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
</div>

  </div>