  <div id="fileHeader">
    <h1>parser_context.rb</h1>
    <table class="header-table">
    <tr class="top-aligned-row">
      <td><strong>Path:</strong></td>
      <td>lib/nokogiri/ffi/xml/sax/parser_context.rb</td>
    </tr>
    <tr class="top-aligned-row">
      <td><strong>Last Update:</strong></td>
      <td>Thu Nov 26 17:53:40 +0100 2009</td>
    </tr>
    </table>
  </div>
 <!-- banner header -->

  <div id="bodyContent" >
    <h2>Source Code</h2>
    <pre># :stopdoc:
module Nokogiri
  module XML
    module SAX
      class ParserContext
        attr_accessor :cstruct
        attr_accessor :reader_callback

        def self.memory data
          raise(ArgumentError, 'data cannot be nil') if data.nil?
          raise('data cannot be empty') if data.length == 0
          ctx = LibXML::XmlParserContext.new(
            LibXML.xmlCreateMemoryParserCtxt data, data.length
          )
          pc = allocate
          pc.cstruct = ctx
          pc
        end

        def self.io io, encoding
          reader_callback = IoCallbacks.reader(io) # keep a reference to prevent it from being GC'd
          sax_ctx = LibXML.xmlCreateIOParserCtxt(
            nil,
            nil,
            reader_callback,
            nil,
            nil,
            encoding
          )
          pc = allocate
          pc.cstruct = LibXML::XmlParserContext.new sax_ctx
          pc.reader_callback = reader_callback
          pc
        end

        def self.file filename
          ctx = LibXML.xmlCreateFileParserCtxt filename
          pc = allocate
          pc.cstruct = LibXML::XmlParserContext.new ctx
          pc
        end

        def parse_with sax_handler, type = :xml
          raise ArgumentError unless XML::SAX::Parser === sax_handler
          sax = sax_handler.cstruct
          cstruct[:sax] = sax

          sax_handler.instance_variable_set(:@ctxt, cstruct)

          LibXML.send(:&quot;#{type}ParseDocument&quot;, cstruct)

          cstruct[:sax] = nil
          LibXML.xmlFreeDoc cstruct[:myDoc] unless cstruct[:myDoc].null?
        end

        def replace_entities=(value)
          self.cstruct[:replaceEntities] = value ? 1 : 0
        end

        def replace_entities
          self.cstruct[:replaceEntities] == 0 ? false : true
        end
      end
    end
  end
end
# :startdoc:
</pre>
    </div>