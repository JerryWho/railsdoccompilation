  <div id="fileHeader">
    <h1>xml_namespace.c</h1>
    <table class="header-table">
    <tr class="top-aligned-row">
      <td><strong>Path:</strong></td>
      <td>ext/nokogiri/xml_namespace.c</td>
    </tr>
    <tr class="top-aligned-row">
      <td><strong>Last Update:</strong></td>
      <td>Fri Dec 11 22:20:49 +0100 2009</td>
    </tr>
    </table>
  </div>
 <!-- banner header -->

  <div id="bodyContent" >
    <h2>Source Code</h2>
    <pre>#include &lt;xml_namespace.h&gt;

VALUE cNokogiriXmlNamespace ;

/*
 * call-seq:
 *  prefix
 *
 * Get the prefix for this namespace.  Returns +nil+ if there is no prefix.
 */
static VALUE prefix(VALUE self)
{
  xmlNsPtr ns;
  xmlDocPtr doc;

  Data_Get_Struct(self, xmlNs, ns);
  if(!ns-&gt;prefix) return Qnil;

  Data_Get_Struct(rb_iv_get(self, &quot;@document&quot;), xmlDoc, doc);

  return NOKOGIRI_STR_NEW2(ns-&gt;prefix);
}

/*
 * call-seq:
 *  href
 *
 * Get the href for this namespace
 */
static VALUE href(VALUE self)
{
  xmlNsPtr ns;
  xmlDocPtr doc;

  Data_Get_Struct(self, xmlNs, ns);
  if(!ns-&gt;href) return Qnil;

  Data_Get_Struct(rb_iv_get(self, &quot;@document&quot;), xmlDoc, doc);

  return NOKOGIRI_STR_NEW2(ns-&gt;href);
}

VALUE Nokogiri_wrap_xml_namespace(xmlDocPtr doc, xmlNsPtr node)
{
  assert(doc-&gt;_private);

  if(node-&gt;_private)
    return (VALUE)node-&gt;_private;

  VALUE ns = Data_Wrap_Struct(cNokogiriXmlNamespace, 0, 0, node);

  VALUE document = DOC_RUBY_OBJECT(doc);

  VALUE node_cache = rb_iv_get(document, &quot;@node_cache&quot;);
  rb_ary_push(node_cache, ns);

  rb_iv_set(ns, &quot;@document&quot;, DOC_RUBY_OBJECT(doc));

  node-&gt;_private = (void *)ns;

  return ns;
}

VALUE Nokogiri_wrap_xml_namespace2(VALUE document, xmlNsPtr node)
{
  xmlDocPtr doc;
  Data_Get_Struct(document, xmlDoc, doc) ;
  return Nokogiri_wrap_xml_namespace(doc, node);
}


void init_xml_namespace()
{
  VALUE nokogiri  = rb_define_module(&quot;Nokogiri&quot;);
  VALUE xml       = rb_define_module_under(nokogiri, &quot;XML&quot;);
  VALUE klass     = rb_define_class_under(xml, &quot;Namespace&quot;, rb_cObject);

  cNokogiriXmlNamespace = klass;

  rb_define_method(klass, &quot;prefix&quot;, prefix, 0);
  rb_define_method(klass, &quot;href&quot;, href, 0);
}
</pre>
    </div>