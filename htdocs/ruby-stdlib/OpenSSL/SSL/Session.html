<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta name="Content-Type" content="text/html; charset=utf-8" />
<title>Class: OpenSSL::SSL::Session</title>
<link rel="stylesheet" href="../../css/style.css" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="../../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '../..';
  if (relpath != '') relpath += '/';
</script>
<script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>

  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="../../_index.html">Index (S)</a> &raquo; 
    <span class='title'><span class='object_link'><a href="../../OpenSSL.html" title="OpenSSL (module)">OpenSSL</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../SSL.html" title="OpenSSL::SSL (module)">SSL</a></span></span>
     &raquo; 
    <span class="title">Session</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  <a id="class_list_link" href="#">Class List</a>
  <a id="method_list_link" href="#">Method List</a>
  <a id ="file_list_link" href="#">File List</a>
</div>

      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><h1>Class: OpenSSL::SSL::Session
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName"><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></span>
      
        <ul class="fullTree">
          <li><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></li>
          
            <li class="next">OpenSSL::SSL::Session</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">ext/openssl/ossl_ssl_session.c</dd>
  
</dl>
<div class="clear"></div>

<h2>Defined Under Namespace</h2>
<p class="children">
   
    
   
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="Session/SessionError.html" title="OpenSSL::SSL::Session::SessionError (class)">SessionError</a></span>
    
  
</p>



  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#%3D%3D-instance_method" title="#== (instance method)">- (Boolean) <strong>==</strong>(session2) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#id-instance_method" title="#id (instance method)">- (Object) <strong>id</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns the Session ID.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#new-instance_method" title="#new (instance method)">- (Object) <strong>new</strong>(SSLSocket|string) </a>
    

    
  </span>
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><h3>Parameters</h3>
<p>
<tt>SSLSocket</tt> is an OpenSSL::SSL::SSLSocket <tt>string</tt> must be a
DER or PEM encoded Session.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#time-instance_method" title="#time (instance method)">- (Object) <strong>time</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#time%3D-instance_method" title="#time= (instance method)">- (Object) <strong>time=</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#timeout-instance_method" title="#timeout (instance method)">- (Integer) <strong>timeout</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
How long until the session expires in seconds.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#timeout%3D-instance_method" title="#timeout= (instance method)">- (Object) <strong>timeout=</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#to_der-instance_method" title="#to_der (instance method)">- (Object) <strong>to_der</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns an ASN1 encoded String that contains the Session object.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#to_pem-instance_method" title="#to_pem (instance method)">- (Object) <strong>to_pem</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns a PEM encoded String that contains the Session object.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#to_text-instance_method" title="#to_text (instance method)">- (Object) <strong>to_text</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Shows everything in the Session object.
</p>
</div></span>
  
</li>

      
    </ul>
  

<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <p class="signature first" id="initialize-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>new</strong>(SSLSocket|string) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <h3>Parameters</h3>
<p>
<tt>SSLSocket</tt> is an OpenSSL::SSL::SSLSocket <tt>string</tt> must be a
DER or PEM encoded Session.
</p>


  </div>
</div>
<div class="tags">
  
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/openssl/ossl_ssl_session.c'</span>

/*
 * call-seq:
 *    Session.new(SSLSocket | string) =&gt; session
 *
 * === Parameters
 * +SSLSocket+ is an OpenSSL::SSL::SSLSocket
 * +string+ must be a DER or PEM encoded Session.
*/
static VALUE ossl_ssl_session_initialize(VALUE self, VALUE arg1)
{
    SSL_SESSION *ctx = NULL;

    if (RDATA(self)-&gt;data)
        ossl_raise(eSSLSession, &quot;SSL Session already initialized&quot;);

    if (rb_obj_is_instance_of(arg1, cSSLSocket)) {
        SSL *ssl;

        Data_Get_Struct(arg1, SSL, ssl);

        if (!ssl || (ctx = SSL_get1_session(ssl)) == NULL)
            ossl_raise(eSSLSession, &quot;no session available&quot;);
    } else {
        BIO *in = ossl_obj2bio(arg1);

        ctx = PEM_read_bio_SSL_SESSION(in, NULL, NULL, NULL);

        if (!ctx) {
            (void)BIO_reset(in);
            ctx = d2i_SSL_SESSION_bio(in, NULL);
        }

        BIO_free(in);

        if (!ctx)
            ossl_raise(rb_eArgError, &quot;unknown type&quot;);
    }

    /* should not happen */
    if (ctx == NULL)
        ossl_raise(eSSLSession, &quot;ctx not set - internal error&quot;);

    RDATA(self)-&gt;data = ctx;

    return self;
}</pre>
    </td>
  </tr>
</table>
</div>
  
</div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="==-instance_method">
  
    - (<tt>Boolean</tt>) <strong>==</strong>(session2) 
  

  
</p><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
  <div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
      
    </li>
  
</ul>

</div>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/openssl/ossl_ssl_session.c'</span>

/*
 * call-seq:
 *    session1 == session2 -&gt; boolean
 *
*/
static VALUE ossl_ssl_session_eq(VALUE val1, VALUE val2)
{
    SSL_SESSION *ctx1, *ctx2;

    GetSSLSession(val1, ctx1);
    SafeGetSSLSession(val2, ctx2);

    switch (SSL_SESSION_cmp(ctx1, ctx2)) {
    case 0:        return Qtrue;
    default:   return Qfalse;
    }
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="id-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>id</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns the Session ID.
</p>


  </div>
</div>
<div class="tags">
  
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/openssl/ossl_ssl_session.c'</span>

/*
 * call-seq:
 *    session.id -&gt; aString
 *
 * Returns the Session ID.
*/
static VALUE ossl_ssl_session_get_id(VALUE self)
{
    SSL_SESSION *ctx;
    const unsigned char *p = NULL;
    unsigned int i = 0;

    GetSSLSession(self, ctx);

    p = SSL_SESSION_get_id(ctx, &amp;i);

    return rb_str_new((const char *) p, i);
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="time-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>time</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/openssl/ossl_ssl_session.c'</span>

/*
 * call-seq:
 *    session.time -&gt; Time
 *
*/
static VALUE ossl_ssl_session_get_time(VALUE self)
{
    SSL_SESSION *ctx;
    time_t t;

    GetSSLSession(self, ctx);

    t = SSL_SESSION_get_time(ctx);

    if (t == 0)
        return Qnil;

    return rb_funcall(rb_cTime, rb_intern(&quot;at&quot;), 1, TIMET2NUM(t));
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="time=-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>time=</strong> 
  

  
</p>
</div>
    
      <div class="method_details ">
  <p class="signature " id="timeout-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Integer.html" title="Integer (class)">Integer</a></span></tt>) <strong>timeout</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
How long until the session expires in seconds.
</p>


  </div>
</div>
<div class="tags">
  
  <div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Integer.html" title="Integer (class)">Integer</a></span></tt>)</span>
      
      
      
      
    </li>
  
</ul>

</div>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/openssl/ossl_ssl_session.c'</span>

/*
 * call-seq:
 *    session.timeout -&gt; integer
 *
 * How long until the session expires in seconds.
 *
*/
static VALUE ossl_ssl_session_get_timeout(VALUE self)
{
    SSL_SESSION *ctx;
    time_t t;

    GetSSLSession(self, ctx);

    t = SSL_SESSION_get_timeout(ctx);

    return TIMET2NUM(t);
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="timeout=-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>timeout=</strong> 
  

  
</p>
</div>
    
      <div class="method_details ">
  <p class="signature " id="to_der-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>to_der</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns an ASN1 encoded String that contains the Session object.
</p>


  </div>
</div>
<div class="tags">
  
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/openssl/ossl_ssl_session.c'</span>

/*
 * call-seq:
 *    session.to_der -&gt; aString
 *
 * Returns an ASN1 encoded String that contains the Session object.
*/
static VALUE ossl_ssl_session_to_der(VALUE self)
{
    SSL_SESSION *ctx;
    unsigned char buf[1024*10], *p;
    int len;

    GetSSLSession(self, ctx);

    p = buf;
    len = i2d_SSL_SESSION(ctx, &amp;p);

    if (len &lt;= 0)
        ossl_raise(eSSLSession, &quot;i2d_SSL_SESSION&quot;);
    else if (len &gt;= sizeof(buf))
        ossl_raise(eSSLSession, &quot;i2d_SSL_SESSION too large&quot;);

    return rb_str_new((const char *) p, len);
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="to_pem-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>to_pem</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns a PEM encoded String that contains the Session object.
</p>


  </div>
</div>
<div class="tags">
  
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/openssl/ossl_ssl_session.c'</span>

/*
 * call-seq:
 *    session.to_pem -&gt; String
 *
 * Returns a PEM encoded String that contains the Session object.
*/
static VALUE ossl_ssl_session_to_pem(VALUE self)
{
    SSL_SESSION *ctx;
    BIO *out;
    BUF_MEM *buf;
    VALUE str;
    int i;

    GetSSLSession(self, ctx);

    if (!(out = BIO_new(BIO_s_mem()))) {
        ossl_raise(eSSLSession, &quot;BIO_s_mem()&quot;);
    }

    if (!(i=PEM_write_bio_SSL_SESSION(out, ctx))) {
        BIO_free(out);
        ossl_raise(eSSLSession, &quot;SSL_SESSION_print()&quot;);
    }

    BIO_get_mem_ptr(out, &amp;buf);
    str = rb_str_new(buf-&gt;data, buf-&gt;length);
    BIO_free(out);

    return str;
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="to_text-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>to_text</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Shows everything in the Session object.
</p>


  </div>
</div>
<div class="tags">
  
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/openssl/ossl_ssl_session.c'</span>

/*
 * call-seq:
 *    session.to_text -&gt; String
 *
 * Shows everything in the Session object.
*/
static VALUE ossl_ssl_session_to_text(VALUE self)
{
    SSL_SESSION *ctx;
    BIO *out;
    BUF_MEM *buf;
    VALUE str;

    GetSSLSession(self, ctx);

    if (!(out = BIO_new(BIO_s_mem()))) {
        ossl_raise(eSSLSession, &quot;BIO_s_mem()&quot;);
    }

    if (!SSL_SESSION_print(out, ctx)) {
        BIO_free(out);
        ossl_raise(eSSLSession, &quot;SSL_SESSION_print()&quot;);
    }

    BIO_get_mem_ptr(out, &amp;buf);
    str = rb_str_new(buf-&gt;data, buf-&gt;length);
    BIO_free(out);

    return str;
}</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>
    
    <div id="footer">
  Generated on Thu Oct 14 00:02:56 2010 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.6.1 (ruby-1.9.2).
</div>

  </body>
</html>