<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta name="Content-Type" content="text/html; charset=utf-8" />
<title>Class: OpenSSL::PKey::EC</title>
<link rel="stylesheet" href="../../css/style.css" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="../../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '../..';
  if (relpath != '') relpath += '/';
</script>
<script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>

  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="../../_index.html">Index (E)</a> &raquo; 
    <span class='title'><span class='object_link'><a href="../../OpenSSL.html" title="OpenSSL (module)">OpenSSL</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../PKey.html" title="OpenSSL::PKey (module)">PKey</a></span></span>
     &raquo; 
    <span class="title">EC</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  <a id="class_list_link" href="#">Class List</a>
  <a id="method_list_link" href="#">Method List</a>
  <a id ="file_list_link" href="#">File List</a>
</div>

      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><h1>Class: OpenSSL::PKey::EC
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName"><span class='object_link'><a href="PKey.html" title="OpenSSL::PKey::PKey (class)">PKey</a></span></span>
      
        <ul class="fullTree">
          <li><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></li>
          
            <li class="next"><span class='object_link'><a href="PKey.html" title="OpenSSL::PKey::PKey (class)">PKey</a></span></li>
          
            <li class="next">OpenSSL::PKey::EC</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">ext/openssl/ossl_pkey_ec.c</dd>
  
</dl>
<div class="clear"></div>

<h2>Defined Under Namespace</h2>
<p class="children">
   
    
   
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="EC/Group.html" title="OpenSSL::PKey::EC::Group (class)">Group</a></span>, <span class='object_link'><a href="EC/Point.html" title="OpenSSL::PKey::EC::Point (class)">Point</a></span>
    
  
</p>


  
  
  
  

  
    <h2>
      Class Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#builtin_curves-class_method" title="builtin_curves (class method)">+ (Array) <strong>builtin_curves</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
See the OpenSSL documentation for EC_builtin_curves().
</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#check_key-instance_method" title="#check_key (instance method)">- (true) <strong>check_key</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Raises an exception if the key is invalid.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#dh_compute_key-instance_method" title="#dh_compute_key (instance method)">- (Object) <strong>dh_compute_key</strong>(pubkey) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
See the OpenSSL documentation for ECDH_compute_key().
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#dsa_sign_asn1-instance_method" title="#dsa_sign_asn1 (instance method)">- (Object) <strong>dsa_sign_asn1</strong>(data) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
See the OpenSSL documentation for ECDSA_sign().
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#dsa_verify_asn1-instance_method" title="#dsa_verify_asn1 (instance method)">- (Boolean) <strong>dsa_verify_asn1</strong>(data, sig) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
See the OpenSSL documentation for ECDSA_verify().
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#generate_key-instance_method" title="#generate_key (instance method)">- (EC) <strong>generate_key</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
See the OpenSSL documentation for EC_KEY_generate_key().
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#group-instance_method" title="#group (instance method)">- (Object) <strong>group</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns a constant <tt>OpenSSL::EC::Group</tt> that is tied to the key.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#group%3D-instance_method" title="#group= (instance method)">- (Object) <strong>group=</strong>(group) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns the same object passed, not the group object associated with the
key.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">- (Object) <strong>initialize</strong> </a>
    

    
  </span>
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
See the OpenSSL documentation for:.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#private_key-instance_method" title="#private_key (instance method)">- (Object) <strong>private_key</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
See the OpenSSL documentation for EC_KEY_get0_private_key().
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#private_key%3D-instance_method" title="#private_key= (instance method)">- (Object) <strong>private_key=</strong>(openssl_bn) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
See the OpenSSL documentation for EC_KEY_set_private_key().
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#private_key%3F-instance_method" title="#private_key? (instance method)">- (Boolean) <strong>private_key?</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Both public_key? and private_key? may return false at the same time unlike
other PKey classes.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#public_key-instance_method" title="#public_key (instance method)">- (Object) <strong>public_key</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
See the OpenSSL documentation for EC_KEY_get0_public_key().
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#public_key%3D-instance_method" title="#public_key= (instance method)">- (Object) <strong>public_key=</strong>(ec_point) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
See the OpenSSL documentation for EC_KEY_set_public_key().
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#public_key%3F-instance_method" title="#public_key? (instance method)">- (Boolean) <strong>public_key?</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Both public_key? and private_key? may return false at the same time unlike
other PKey classes.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#to_der-instance_method" title="#to_der (instance method)">- (Object) <strong>to_der</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
See the OpenSSL documentation for i2d_ECPrivateKey_bio().
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#to_pem-instance_method" title="#to_pem (instance method)">- (Object) <strong>to_pem</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
See the OpenSSL documentation for PEM_write_bio_ECPrivateKey().
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#to_text-instance_method" title="#to_text (instance method)">- (Object) <strong>to_text</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
See the OpenSSL documentation for EC_KEY_print().
</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  <h3 class="inherited">Methods inherited from <span class='object_link'><a href="PKey.html" title="OpenSSL::PKey::PKey (class)">PKey</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="PKey.html#sign-instance_method" title="OpenSSL::PKey::PKey#sign (method)">#sign</a></span>, <span class='object_link'><a href="PKey.html#verify-instance_method" title="OpenSSL::PKey::PKey#verify (method)">#verify</a></span></p>
<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <p class="signature first" id="initialize-instance_method">
  
    
      <span class="overload">- (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>OpenSSL::PKey::EC.new</strong> </span>
    
      <span class="overload">- (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>OpenSSL::PKey::EC.new</strong>(ec_key) </span>
    
      <span class="overload">- (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>OpenSSL::PKey::EC.new</strong>(ec_group) </span>
    
      <span class="overload">- (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>OpenSSL::PKey::EC.new</strong>(&quot;secp112r1&quot;) </span>
    
      <span class="overload">- (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>OpenSSL::PKey::EC.new</strong>(pem_string) </span>
    
      <span class="overload">- (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>OpenSSL::PKey::EC.new</strong>(der_string) </span>
    
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
See the OpenSSL documentation for:
</p>
<pre class="code">
   EC_KEY_*</pre>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/openssl/ossl_pkey_ec.c'</span>

/*  call-seq:
 *     OpenSSL::PKey::EC.new()
 *     OpenSSL::PKey::EC.new(ec_key)
 *     OpenSSL::PKey::EC.new(ec_group)
 *     OpenSSL::PKey::EC.new(&quot;secp112r1&quot;)
 *     OpenSSL::PKey::EC.new(pem_string)
 *     OpenSSL::PKey::EC.new(der_string)
 *
 *  See the OpenSSL documentation for:
 *     EC_KEY_*
 */
static VALUE ossl_ec_key_initialize(int argc, VALUE *argv, VALUE self)
{
    EVP_PKEY *pkey;
    EC_KEY *ec = NULL;
    VALUE arg, pass;
    VALUE group = Qnil;

    GetPKey(self, pkey);
    if (pkey-&gt;pkey.ec)
        rb_raise(eECError, &quot;EC_KEY already initialized&quot;);

    rb_scan_args(argc, argv, &quot;02&quot;, &amp;arg, &amp;pass);

    if (NIL_P(arg)) {
        ec = EC_KEY_new();
    } else {
        if (rb_obj_is_kind_of(arg, cEC)) {
            EC_KEY *other_ec = NULL;

            SafeRequire_EC_KEY(arg, other_ec);
            ec = EC_KEY_dup(other_ec);
        } else if (rb_obj_is_kind_of(arg, cEC_GROUP)) {
            ec = EC_KEY_new();
            group = arg;
        } else {
            BIO *in = ossl_obj2bio(arg);

            ec = PEM_read_bio_ECPrivateKey(in, NULL, NULL, NULL);
            if (!ec) {
                (void)BIO_reset(in);
                ec = PEM_read_bio_EC_PUBKEY(in, NULL, NULL, NULL);
            }
            if (!ec) {
                (void)BIO_reset(in);
                ec = d2i_ECPrivateKey_bio(in, NULL);
            }
            if (!ec) {
                (void)BIO_reset(in);
                ec = d2i_EC_PUBKEY_bio(in, NULL);
            }

            BIO_free(in);

            if (ec == NULL) {
                const char *name = StringValueCStr(arg);
                int nid = OBJ_sn2nid(name);

                if (nid == NID_undef)
                    ossl_raise(eECError, &quot;unknown curve name (%s)\n&quot;, name);

                if ((ec = EC_KEY_new_by_curve_name(nid)) == NULL)
                    ossl_raise(eECError, &quot;unable to create curve (%s)\n&quot;, name);

                EC_KEY_set_asn1_flag(ec, OPENSSL_EC_NAMED_CURVE);
                EC_KEY_set_conv_form(ec, POINT_CONVERSION_UNCOMPRESSED);
            }
        }
    }

    if (ec == NULL)
        ossl_raise(eECError, NULL);

    if (!EVP_PKEY_assign_EC_KEY(pkey, ec)) {
    EC_KEY_free(ec);
    ossl_raise(eECError, &quot;EVP_PKEY_assign_EC_KEY&quot;);
    }

    rb_iv_set(self, &quot;@group&quot;, Qnil);

    if (!NIL_P(group))
        rb_funcall(self, rb_intern(&quot;group=&quot;), 1, arg);

    return self;
}</pre>
    </td>
  </tr>
</table>
</div>
  
</div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="builtin_curves-class_method">
  
    + (<tt><span class='object_link'><a href="../../Array.html" title="Array (class)">Array</a></span></tt>) <strong>builtin_curves</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
See the OpenSSL documentation for EC_builtin_curves()
</p>


  </div>
</div>
<div class="tags">
  
  <div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Array.html" title="Array (class)">Array</a></span></tt>)</span>
      
      
      
      
    </li>
  
</ul>

</div>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/openssl/ossl_pkey_ec.c'</span>

/*  call-seq:
 *     EC.builtin_curves =&gt; [[name, comment], ...]
 *
 *  See the OpenSSL documentation for EC_builtin_curves()
 */
static VALUE ossl_s_builtin_curves(VALUE self)
{
    EC_builtin_curve *curves = NULL;
    int n;
    int crv_len = EC_get_builtin_curves(NULL, 0);
    VALUE ary, ret;

    curves = ALLOCA_N(EC_builtin_curve, crv_len);
    if (curves == NULL)
        return Qnil;
    if (!EC_get_builtin_curves(curves, crv_len))
        ossl_raise(rb_eRuntimeError, &quot;EC_get_builtin_curves&quot;);

    ret = rb_ary_new2(crv_len);

    for (n = 0; n &lt; crv_len; n++) {
        const char *sname = OBJ_nid2sn(curves[n].nid);
        const char *comment = curves[n].comment;

        ary = rb_ary_new2(2);
        rb_ary_push(ary, rb_str_new2(sname));
        rb_ary_push(ary, comment ? rb_str_new2(comment) : Qnil);
        rb_ary_push(ret, ary);
    }

    return ret;
}</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="check_key-instance_method">
  
    - (<tt>true</tt>) <strong>check_key</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Raises an exception if the key is invalid.
</p>
<p>
See the OpenSSL documentation for EC_KEY_check_key()
</p>


  </div>
</div>
<div class="tags">
  
  <div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>true</tt>)</span>
      
      
      
      
    </li>
  
</ul>

</div>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/openssl/ossl_pkey_ec.c'</span>

/*
 *  call-seq:
 *     key.check_key   =&gt; true
 *
 *  Raises an exception if the key is invalid.
 *
 *  See the OpenSSL documentation for EC_KEY_check_key()
 */
static VALUE ossl_ec_key_check_key(VALUE self)
{
    EC_KEY *ec;

    Require_EC_KEY(self, ec);

    if (EC_KEY_check_key(ec) != 1)
    ossl_raise(eECError, &quot;EC_KEY_check_key&quot;);

    return Qtrue;
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="dh_compute_key-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>dh_compute_key</strong>(pubkey) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
See the OpenSSL documentation for ECDH_compute_key()
</p>


  </div>
</div>
<div class="tags">
  
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/openssl/ossl_pkey_ec.c'</span>

/*
 *  call-seq:
 *     key.dh_compute_key(pubkey)   =&gt; String
 *
 *  See the OpenSSL documentation for ECDH_compute_key()
 */
static VALUE ossl_ec_key_dh_compute_key(VALUE self, VALUE pubkey)
{
    EC_KEY *ec;
    EC_POINT *point;
    int buf_len;
    VALUE str;

    Require_EC_KEY(self, ec);
    SafeRequire_EC_POINT(pubkey, point);

/* BUG: need a way to figure out the maximum string size */
    buf_len = 1024;
    str = rb_str_new(0, buf_len);
/* BUG: take KDF as a block */
    buf_len = ECDH_compute_key(RSTRING_PTR(str), buf_len, point, ec, NULL);
    if (buf_len &lt; 0)
         ossl_raise(eECError, &quot;ECDH_compute_key&quot;);

    rb_str_resize(str, buf_len);

    return str;
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="dsa_sign_asn1-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>dsa_sign_asn1</strong>(data) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
See the OpenSSL documentation for ECDSA_sign()
</p>


  </div>
</div>
<div class="tags">
  
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/openssl/ossl_pkey_ec.c'</span>

/*
 *  call-seq:
 *     key.dsa_sign_asn1(data)   =&gt; String
 *
 *  See the OpenSSL documentation for ECDSA_sign()
 */
static VALUE ossl_ec_key_dsa_sign_asn1(VALUE self, VALUE data)
{
    EC_KEY *ec;
    unsigned int buf_len;
    VALUE str;

    Require_EC_KEY(self, ec);
    StringValue(data);

    if (EC_KEY_get0_private_key(ec) == NULL)
    ossl_raise(eECError, &quot;Private EC key needed!&quot;);

    str = rb_str_new(0, ECDSA_size(ec) + 16);
    if (ECDSA_sign(0, (unsigned char *) RSTRING_PTR(data), RSTRING_LEN(data), (unsigned char *) RSTRING_PTR(str), &amp;buf_len, ec) != 1)
         ossl_raise(eECError, &quot;ECDSA_sign&quot;);

    rb_str_resize(str, buf_len);

    return str;
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="dsa_verify_asn1-instance_method">
  
    - (<tt>Boolean</tt>) <strong>dsa_verify_asn1</strong>(data, sig) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
See the OpenSSL documentation for ECDSA_verify()
</p>


  </div>
</div>
<div class="tags">
  
  <div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
      
    </li>
  
</ul>

</div>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/openssl/ossl_pkey_ec.c'</span>

/*
 *  call-seq:
 *     key.dsa_verify_asn1(data, sig)   =&gt; true or false
 *
 *  See the OpenSSL documentation for ECDSA_verify()
 */
static VALUE ossl_ec_key_dsa_verify_asn1(VALUE self, VALUE data, VALUE sig)
{
    EC_KEY *ec;

    Require_EC_KEY(self, ec);
    StringValue(data);
    StringValue(sig);

    switch (ECDSA_verify(0, (unsigned char *) RSTRING_PTR(data), RSTRING_LEN(data), (unsigned char *) RSTRING_PTR(sig), RSTRING_LEN(sig), ec)) {
    case 1: return Qtrue;
    case 0: return Qfalse;
    default:    break;
    }

    ossl_raise(eECError, &quot;ECDSA_verify&quot;);
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="generate_key-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="OpenSSL::PKey::EC (class)">EC</a></span></tt>) <strong>generate_key</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
See the OpenSSL documentation for EC_KEY_generate_key()
</p>


  </div>
</div>
<div class="tags">
  
  <div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt><span class='object_link'><a href="" title="OpenSSL::PKey::EC (class)">EC</a></span></tt>)</span>
      
      
      
      
    </li>
  
</ul>

</div>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/openssl/ossl_pkey_ec.c'</span>

/*
 *  call-seq:
 *     key.generate_key   =&gt; self
 *
 *  See the OpenSSL documentation for EC_KEY_generate_key()
 */
static VALUE ossl_ec_key_generate_key(VALUE self)
{
    EC_KEY *ec;

    Require_EC_KEY(self, ec);

    if (EC_KEY_generate_key(ec) != 1)
    ossl_raise(eECError, &quot;EC_KEY_generate_key&quot;);

    return self;
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="group-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>group</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns a constant <tt>OpenSSL::EC::Group</tt> that is tied to the key.
Modifying the returned group can make the key invalid.
</p>


  </div>
</div>
<div class="tags">
  
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/openssl/ossl_pkey_ec.c'</span>

/*
 *  call-seq:
 *     key.group   =&gt; group
 *
 *  Returns a constant &lt;code&gt;OpenSSL::EC::Group&lt;/code&gt; that is tied to the key.
 *  Modifying the returned group can make the key invalid.
 */
static VALUE ossl_ec_key_get_group(VALUE self)
{
    VALUE group_v;
    EC_KEY *ec;
    ossl_ec_group *ec_group;
    EC_GROUP *group;

    Require_EC_KEY(self, ec);

    group_v = rb_iv_get(self, &quot;@group&quot;);
    if (!NIL_P(group_v))
        return group_v;

    if ((group = (EC_GROUP *)EC_KEY_get0_group(ec)) != NULL) {
        group_v = rb_obj_alloc(cEC_GROUP);
        SafeGet_ec_group(group_v, ec_group);
        ec_group-&gt;group = group;
        ec_group-&gt;dont_free = 1;
        rb_iv_set(group_v, &quot;@key&quot;, self);
        rb_iv_set(self, &quot;@group&quot;, group_v);
        return group_v;
    }

    return Qnil;
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="group=-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>group=</strong>(group) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns the same object passed, not the group object associated with the
key. If you wish to access the group object tied to the key call key.group
after setting the group.
</p>
<p>
Setting the group will immediately destroy any previously assigned group
object. The group is internally copied by OpenSSL.  Modifying the original
group after assignment will not effect the internal key structure. (your
changes may be lost).  BE CAREFUL.
</p>
<p>
EC_KEY_set_group calls EC_GROUP_free(key->group) then EC_GROUP_dup(), not
EC_GROUP_copy. This documentation is accurate for OpenSSL 0.9.8b.
</p>


  </div>
</div>
<div class="tags">
  
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/openssl/ossl_pkey_ec.c'</span>

/*
 *  call-seq:
 *     key.group = group   =&gt; group
 *
 *  Returns the same object passed, not the group object associated with the key.
 *  If you wish to access the group object tied to the key call key.group after setting
 *  the group.
 *
 *  Setting the group will immediately destroy any previously assigned group object.
 *  The group is internally copied by OpenSSL.  Modifying the original group after
 *  assignment will not effect the internal key structure.
 *  (your changes may be lost).  BE CAREFUL.
 *
 *  EC_KEY_set_group calls EC_GROUP_free(key-&gt;group) then EC_GROUP_dup(), not EC_GROUP_copy.
 *  This documentation is accurate for OpenSSL 0.9.8b.
 */
static VALUE ossl_ec_key_set_group(VALUE self, VALUE group_v)
{
    VALUE old_group_v;
    EC_KEY *ec;
    EC_GROUP *group;

    Require_EC_KEY(self, ec);
    SafeRequire_EC_GROUP(group_v, group);

    old_group_v = rb_iv_get(self, &quot;@group&quot;);
    if (!NIL_P(old_group_v)) {
        ossl_ec_group *old_ec_group;
        SafeGet_ec_group(old_group_v, old_ec_group);

        old_ec_group-&gt;group = NULL;
        old_ec_group-&gt;dont_free = 0;
        rb_iv_set(old_group_v, &quot;@key&quot;, Qnil);
    }

    rb_iv_set(self, &quot;@group&quot;, Qnil);

    if (EC_KEY_set_group(ec, group) != 1)
        ossl_raise(eECError, &quot;EC_KEY_set_group&quot;);

    return group_v;
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="private_key-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>private_key</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
See the OpenSSL documentation for EC_KEY_get0_private_key()
</p>


  </div>
</div>
<div class="tags">
  
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/openssl/ossl_pkey_ec.c'</span>

/*
 *  call-seq:
 *     key.private_key   =&gt; OpenSSL::BN
 *
 *  See the OpenSSL documentation for EC_KEY_get0_private_key()
 */
static VALUE ossl_ec_key_get_private_key(VALUE self)
{
    EC_KEY *ec;
    const BIGNUM *bn;

    Require_EC_KEY(self, ec);

    if ((bn = EC_KEY_get0_private_key(ec)) == NULL)
        return Qnil;

    return ossl_bn_new(bn);
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="private_key=-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>private_key=</strong>(openssl_bn) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
See the OpenSSL documentation for EC_KEY_set_private_key()
</p>


  </div>
</div>
<div class="tags">
  
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/openssl/ossl_pkey_ec.c'</span>

/*
 *  call-seq:
 *     key.private_key = openssl_bn
 *
 *  See the OpenSSL documentation for EC_KEY_set_private_key()
 */
static VALUE ossl_ec_key_set_private_key(VALUE self, VALUE private_key)
{
    EC_KEY *ec;
    BIGNUM *bn = NULL;

    Require_EC_KEY(self, ec);
    if (!NIL_P(private_key))
        bn = GetBNPtr(private_key);

    switch (EC_KEY_set_private_key(ec, bn)) {
    case 1:
        break;
    case 0:
        if (bn == NULL)
            break;
    default:
        ossl_raise(eECError, &quot;EC_KEY_set_private_key&quot;);
    }

    return private_key;
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="private_key?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>private_key?</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Both public_key? and private_key? may return false at the same time unlike
other PKey classes.
</p>


  </div>
</div>
<div class="tags">
  
  <div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
      
    </li>
  
</ul>

</div>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/openssl/ossl_pkey_ec.c'</span>

/*
 *  call-seq:
 *     key.private_key? =&gt; true or false
 *
 *  Both public_key? and private_key? may return false at the same time unlike other PKey classes.
 */
static VALUE ossl_ec_key_is_private_key(VALUE self)
{
    EC_KEY *ec;

    Require_EC_KEY(self, ec);

    return (EC_KEY_get0_private_key(ec) ? Qtrue : Qfalse);
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="public_key-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>public_key</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
See the OpenSSL documentation for EC_KEY_get0_public_key()
</p>


  </div>
</div>
<div class="tags">
  
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/openssl/ossl_pkey_ec.c'</span>

/*
 *  call-seq:
 *     key.public_key   =&gt; OpenSSL::PKey::EC::Point
 *
 *  See the OpenSSL documentation for EC_KEY_get0_public_key()
 */
static VALUE ossl_ec_key_get_public_key(VALUE self)
{
    EC_KEY *ec;
    const EC_POINT *point;
    VALUE group;

    Require_EC_KEY(self, ec);

    if ((point = EC_KEY_get0_public_key(ec)) == NULL)
        return Qnil;

    group = rb_funcall(self, rb_intern(&quot;group&quot;), 0);
    if (NIL_P(group))
        ossl_raise(eECError, &quot;EC_KEY_get0_get0_group (has public_key but no group???&quot;);

    return ossl_ec_point_dup(point, group);
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="public_key=-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>public_key=</strong>(ec_point) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
See the OpenSSL documentation for EC_KEY_set_public_key()
</p>


  </div>
</div>
<div class="tags">
  
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/openssl/ossl_pkey_ec.c'</span>

/*
 *  call-seq:
 *     key.public_key = ec_point
 *
 *  See the OpenSSL documentation for EC_KEY_set_public_key()
 */
static VALUE ossl_ec_key_set_public_key(VALUE self, VALUE public_key)
{
    EC_KEY *ec;
    EC_POINT *point = NULL;

    Require_EC_KEY(self, ec);
    if (!NIL_P(public_key))
        SafeRequire_EC_POINT(public_key, point);

    switch (EC_KEY_set_public_key(ec, point)) {
    case 1:
        break;
    case 0:
        if (point == NULL)
            break;
    default:
        ossl_raise(eECError, &quot;EC_KEY_set_public_key&quot;);
    }

    return public_key;
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="public_key?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>public_key?</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Both public_key? and private_key? may return false at the same time unlike
other PKey classes.
</p>


  </div>
</div>
<div class="tags">
  
  <div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
      
    </li>
  
</ul>

</div>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/openssl/ossl_pkey_ec.c'</span>

/*
 *  call-seq:
 *     key.public_key? =&gt; true or false
 *
 *  Both public_key? and private_key? may return false at the same time unlike other PKey classes.
 */
static VALUE ossl_ec_key_is_public_key(VALUE self)
{
    EC_KEY *ec;

    Require_EC_KEY(self, ec);

    return (EC_KEY_get0_public_key(ec) ? Qtrue : Qfalse);
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="to_der-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>to_der</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
See the OpenSSL documentation for i2d_ECPrivateKey_bio()
</p>


  </div>
</div>
<div class="tags">
  
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/openssl/ossl_pkey_ec.c'</span>

/*
 *  call-seq:
 *     key.to_der   =&gt; String
 *
 *  See the OpenSSL documentation for i2d_ECPrivateKey_bio()
 */
static VALUE ossl_ec_key_to_der(VALUE self)
{
    return ossl_ec_key_to_string(self, EXPORT_DER);
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="to_pem-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>to_pem</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
See the OpenSSL documentation for PEM_write_bio_ECPrivateKey()
</p>


  </div>
</div>
<div class="tags">
  
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/openssl/ossl_pkey_ec.c'</span>

/*
 *  call-seq:
 *     key.to_pem   =&gt; String
 *
 *  See the OpenSSL documentation for PEM_write_bio_ECPrivateKey()
 */
static VALUE ossl_ec_key_to_pem(VALUE self)
{
    return ossl_ec_key_to_string(self, EXPORT_PEM);
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="to_text-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>to_text</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
See the OpenSSL documentation for EC_KEY_print()
</p>


  </div>
</div>
<div class="tags">
  
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/openssl/ossl_pkey_ec.c'</span>

/*
 *  call-seq:
 *     key.to_text   =&gt; String
 *
 *  See the OpenSSL documentation for EC_KEY_print()
 */
static VALUE ossl_ec_key_to_text(VALUE self)
{
    EC_KEY *ec;
    BIO *out;
    VALUE str;

    Require_EC_KEY(self, ec);
    if (!(out = BIO_new(BIO_s_mem()))) {
    ossl_raise(eECError, &quot;BIO_new(BIO_s_mem())&quot;);
    }
    if (!EC_KEY_print(out, ec, 0)) {
    BIO_free(out);
    ossl_raise(eECError, &quot;EC_KEY_print&quot;);
    }
    str = ossl_membio2str(out);

    return str;
}</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>
    
    <div id="footer">
  Generated on Thu Oct 14 00:02:30 2010 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.6.1 (ruby-1.9.2).
</div>

  </body>
</html>