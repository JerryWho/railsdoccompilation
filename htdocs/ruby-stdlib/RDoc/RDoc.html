<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta name="Content-Type" content="text/html; charset=utf-8" />
<title>Class: RDoc::RDoc</title>
<link rel="stylesheet" href="../css/style.css" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '..';
  if (relpath != '') relpath += '/';
</script>
<script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/app.js"></script>

  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="../_index.html">Index (R)</a> &raquo; 
    <span class='title'><span class='object_link'><a href="../RDoc.html" title="RDoc (module)">RDoc</a></span></span>
     &raquo; 
    <span class="title">RDoc</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  <a id="class_list_link" href="#">Class List</a>
  <a id="method_list_link" href="#">Method List</a>
  <a id ="file_list_link" href="#">File List</a>
</div>

      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><h1>Class: RDoc::RDoc
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName"><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></span>
      
        <ul class="fullTree">
          <li><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></li>
          
            <li class="next">RDoc::RDoc</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">lib/rdoc/rdoc.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>
Encapsulate the production of rdoc documentation. Basically you can use
this as you would invoke rdoc from the command line:
</p>
<pre class="code">
  <span class='id rdoc'>rdoc</span> <span class='op'>=</span> <span class='const'>RDoc</span><span class='op'>::</span><span class='const'>RDoc</span><span class='period'>.</span><span class='id new'>new</span>
  <span class='id rdoc'>rdoc</span><span class='period'>.</span><span class='id document'>document</span><span class='lparen'>(</span><span class='id args'>args</span><span class='rparen'>)</span>
</pre>
<p>
Where <tt>args</tt> is an array of strings, each corresponding to an
argument you&#8217;d give rdoc on the command line. See rdoc/rdoc.rb for
details.
</p>


  </div>
</div>
<div class="tags">
  
</div>
  <h2>Constant Summary</h2>
  
    <dl class="constants">
      
        <dt id="GENERATORS-constant" class="">GENERATORS =
          <div class="docstring">
  <div class="discussion">
    <p>
This is the list of supported output generators
</p>


  </div>
</div>
<div class="tags">
  
</div>
        </dt>
        <dd><pre class="code"><span class='lbrace'>{</span><span class='rbrace'>}</span></pre></dd>
      
    </dl>
  


  <h2>Instance Attribute Summary <small>(<a href="#" class="summary_toggle">collapse</a>)</small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#exclude-instance_method" title="#exclude (instance method)">- (Object) <strong>exclude</strong> </a>
    

    
  </span>
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
File pattern to exclude.
</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#generator-instance_method" title="#generator (instance method)">- (Object) <strong>generator</strong> </a>
    

    
  </span>
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Generator instance used for creating output.
</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#last_modified-instance_method" title="#last_modified (instance method)">- (Object) <strong>last_modified</strong> </a>
    

    
  </span>
  
  
    <span class="note title readonly">readonly</span>
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Hash of files and their last modified times.
</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#options-instance_method" title="#options (instance method)">- (Object) <strong>options</strong> </a>
    

    
  </span>
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
RDoc options.
</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#stats-instance_method" title="#stats (instance method)">- (Object) <strong>stats</strong> </a>
    

    
  </span>
  
  
    <span class="note title readonly">readonly</span>
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Accessor for statistics.
</p>
</div></span>
  
</li>

    
  </ul>


  
    <h2>
      Class Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add_generator-class_method" title="add_generator (class method)">+ (Object) <strong>add_generator</strong>(klass) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Add <tt>klass</tt> that can generate output after parsing.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#current-class_method" title="current (class method)">+ (Object) <strong>current</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Active RDoc::RDoc instance.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#current%3D-class_method" title="current= (class method)">+ (Object) <strong>current=</strong>(rdoc) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Sets the active RDoc::RDoc instance.
</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#document-instance_method" title="#document (instance method)">- (Object) <strong>document</strong>(argv) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Format up one or more files according to the given arguments.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#error-instance_method" title="#error (instance method)">- (Object) <strong>error</strong>(msg) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Report an error message and exit.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#gather_files-instance_method" title="#gather_files (instance method)">- (Object) <strong>gather_files</strong>(files) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Gathers a set of parseable files from the files and directories listed in
<tt>files</tt>.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#handle_pipe-instance_method" title="#handle_pipe (instance method)">- (Object) <strong>handle_pipe</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Turns RDoc from stdin into HTML.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">- (RDoc) <strong>initialize</strong> </a>
    

    
  </span>
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
A new instance of RDoc.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#install_siginfo_handler-instance_method" title="#install_siginfo_handler (instance method)">- (Object) <strong>install_siginfo_handler</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Installs a siginfo handler that prints the current filename.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#list_files_in_directory-instance_method" title="#list_files_in_directory (instance method)">- (Object) <strong>list_files_in_directory</strong>(dir) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Return a list of the files to be processed in a directory.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#normalized_file_list-instance_method" title="#normalized_file_list (instance method)">- (Object) <strong>normalized_file_list</strong>(relative_files, force_doc = false, exclude_pattern = nil) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Given a list of files and directories, create a list of all the Ruby files
they contain.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#output_flag_file-instance_method" title="#output_flag_file (instance method)">- (Object) <strong>output_flag_file</strong>(op_dir) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Return the path name of the flag file in an output directory.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#parse_dot_doc_file-instance_method" title="#parse_dot_doc_file (instance method)">- (Object) <strong>parse_dot_doc_file</strong>(in_dir, filename) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
The .document file contains a list of file and directory name patterns,
representing candidates for documentation.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#parse_file-instance_method" title="#parse_file (instance method)">- (Object) <strong>parse_file</strong>(filename) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Parses <tt>filename</tt> and returns an RDoc::TopLevel.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#parse_files-instance_method" title="#parse_files (instance method)">- (Object) <strong>parse_files</strong>(files) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Parse each file on the command line, recursively entering directories.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#read_file_contents-instance_method" title="#read_file_contents (instance method)">- (Object) <strong>read_file_contents</strong>(filename) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#remove_siginfo_handler-instance_method" title="#remove_siginfo_handler (instance method)">- (Object) <strong>remove_siginfo_handler</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Removes a siginfo handler and replaces the previous.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#remove_unparseable-instance_method" title="#remove_unparseable (instance method)">- (Object) <strong>remove_unparseable</strong>(files) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Removes file extensions known to be unparseable from <tt>files</tt>.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#setup_output_dir-instance_method" title="#setup_output_dir (instance method)">- (Object) <strong>setup_output_dir</strong>(dir, force) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Create an output dir if it doesn&#8217;t exist.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#update_output_dir-instance_method" title="#update_output_dir (instance method)">- (Object) <strong>update_output_dir</strong>(op_dir, time, last = {}) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Update the flag file in an output directory.
</p>
</div></span>
  
</li>

      
    </ul>
  

<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <p class="signature first" id="initialize-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="RDoc::RDoc (class)">RDoc</a></span></tt>) <strong>initialize</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
A new instance of RDoc
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


82
83
84
85
86
87
88
89
90</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rdoc/rdoc.rb', line 82</span>

<span class='kw'>def</span> <span class='id initialize'>initialize</span>
  <span class='ivar'>@current</span>       <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@exclude</span>       <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@generator</span>     <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@last_modified</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='ivar'>@old_siginfo</span>   <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@options</span>       <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@stats</span>         <span class='op'>=</span> <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id="exclude=-instance_method"></span>
      <span id="exclude-instance_method"></span>
      <div class="method_details first">
  <p class="signature first" id="exclude-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>exclude</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
File pattern to exclude
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


33
34
35</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rdoc/rdoc.rb', line 33</span>

<span class='kw'>def</span> <span class='id exclude'>exclude</span>
  <span class='ivar'>@exclude</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="generator=-instance_method"></span>
      <span id="generator-instance_method"></span>
      <div class="method_details ">
  <p class="signature " id="generator-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>generator</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Generator instance used for creating output
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


38
39
40</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rdoc/rdoc.rb', line 38</span>

<span class='kw'>def</span> <span class='id generator'>generator</span>
  <span class='ivar'>@generator</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <span id="last_modified-instance_method"></span>
      <div class="method_details ">
  <p class="signature " id="last_modified-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>last_modified</strong>  <span class="extras">(readonly)</span>
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Hash of files and their last modified times.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


43
44
45</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rdoc/rdoc.rb', line 43</span>

<span class='kw'>def</span> <span class='id last_modified'>last_modified</span>
  <span class='ivar'>@last_modified</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="options=-instance_method"></span>
      <span id="options-instance_method"></span>
      <div class="method_details ">
  <p class="signature " id="options-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>options</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
RDoc options
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


48
49
50</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rdoc/rdoc.rb', line 48</span>

<span class='kw'>def</span> <span class='id options'>options</span>
  <span class='ivar'>@options</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <span id="stats-instance_method"></span>
      <div class="method_details ">
  <p class="signature " id="stats-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>stats</strong>  <span class="extras">(readonly)</span>
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Accessor for statistics.  Available after each call to parse_files
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


53
54
55</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rdoc/rdoc.rb', line 53</span>

<span class='kw'>def</span> <span class='id stats'>stats</span>
  <span class='ivar'>@stats</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="add_generator-class_method">
  
    + (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>add_generator</strong>(klass) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Add <tt>klass</tt> that can generate output after parsing
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


63
64
65
66</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rdoc/rdoc.rb', line 63</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id add_generator'>add_generator</span><span class='lparen'>(</span><span class='id klass'>klass</span><span class='rparen'>)</span>
  <span class='id name'>name</span> <span class='op'>=</span> <span class='id klass'>klass</span><span class='period'>.</span><span class='id name'>name</span><span class='period'>.</span><span class='id sub'>sub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^RDoc::Generator::</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id downcase'>downcase</span>
  <span class='const'>GENERATORS</span><span class='lbracket'>[</span><span class='id name'>name</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id klass'>klass</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="current-class_method">
  
    + (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>current</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Active RDoc::RDoc instance
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


71
72
73</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rdoc/rdoc.rb', line 71</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id current'>current</span>
  <span class='ivar'>@current</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="current=-class_method">
  
    + (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>current=</strong>(rdoc) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Sets the active RDoc::RDoc instance
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


78
79
80</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rdoc/rdoc.rb', line 78</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id current='>current=</span><span class='lparen'>(</span><span class='id rdoc'>rdoc</span><span class='rparen'>)</span>
  <span class='ivar'>@current</span> <span class='op'>=</span> <span class='id rdoc'>rdoc</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="document-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>document</strong>(argv) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Format up one or more files according to the given arguments.
</p>
<p>
For simplicity, <tt>argv</tt> is an array of strings, equivalent to the
strings that would be passed on the command line. (This isn&#8217;t a
coincidence, as we <em>do</em> pass in ARGV when running interactively).
For a list of options, see rdoc/rdoc.rb. By default, output will be stored
in a directory called <tt>doc</tt> below the current directory, so make
sure you&#8217;re somewhere writable before invoking.
</p>
<p>
Throws: RDoc::Error on error
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rdoc/rdoc.rb', line 353</span>

<span class='kw'>def</span> <span class='id document'>document</span><span class='lparen'>(</span><span class='id argv'>argv</span><span class='rparen'>)</span>
  <span class='const'>RDoc</span><span class='op'>::</span><span class='const'>TopLevel</span><span class='period'>.</span><span class='id reset'>reset</span>
  <span class='const'>RDoc</span><span class='op'>::</span><span class='const'>Parser</span><span class='op'>::</span><span class='const'>C</span><span class='period'>.</span><span class='id reset'>reset</span>

  <span class='ivar'>@options</span> <span class='op'>=</span> <span class='const'>RDoc</span><span class='op'>::</span><span class='const'>Options</span><span class='period'>.</span><span class='id new'>new</span>
  <span class='ivar'>@options</span><span class='period'>.</span><span class='id parse'>parse</span> <span class='id argv'>argv</span>

  <span class='kw'>if</span> <span class='ivar'>@options</span><span class='period'>.</span><span class='id pipe'>pipe</span> <span class='kw'>then</span>
    <span class='id handle_pipe'>handle_pipe</span>
    <span class='id exit'>exit</span>
  <span class='kw'>end</span>

  <span class='ivar'>@exclude</span> <span class='op'>=</span> <span class='ivar'>@options</span><span class='period'>.</span><span class='id exclude'>exclude</span>

  <span class='ivar'>@last_modified</span> <span class='op'>=</span> <span class='id setup_output_dir'>setup_output_dir</span> <span class='ivar'>@options</span><span class='period'>.</span><span class='id op_dir'>op_dir</span><span class='comma'>,</span> <span class='ivar'>@options</span><span class='period'>.</span><span class='id force_update'>force_update</span>

  <span class='id start_time'>start_time</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id now'>now</span>

  <span class='id file_info'>file_info</span> <span class='op'>=</span> <span class='id parse_files'>parse_files</span> <span class='ivar'>@options</span><span class='period'>.</span><span class='id files'>files</span>

  <span class='ivar'>@options</span><span class='period'>.</span><span class='id title'>title</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>RDoc Documentation</span><span class='tstring_end'>&quot;</span></span>

  <span class='kw'>if</span> <span class='id file_info'>file_info</span><span class='period'>.</span><span class='id empty?'>empty?</span>
    <span class='gvar'>$stderr</span><span class='period'>.</span><span class='id puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\nNo newer files.</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='ivar'>@options</span><span class='period'>.</span><span class='id quiet'>quiet</span>
  <span class='kw'>else</span>
    <span class='id gen_klass'>gen_klass</span> <span class='op'>=</span> <span class='ivar'>@options</span><span class='period'>.</span><span class='id generator'>generator</span>

    <span class='kw'>unless</span> <span class='ivar'>@options</span><span class='period'>.</span><span class='id quiet'>quiet</span> <span class='kw'>then</span>
      <span class='gvar'>$stderr</span><span class='period'>.</span><span class='id puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\nGenerating </span><span class='embexpr_beg'>#{</span><span class='id gen_klass'>gen_klass</span><span class='period'>.</span><span class='id name'>name</span><span class='period'>.</span><span class='id sub'>sub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^.*::</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='tstring_content'>...</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>

    <span class='ivar'>@generator</span> <span class='op'>=</span> <span class='id gen_klass'>gen_klass</span><span class='period'>.</span><span class='id for'>for</span> <span class='ivar'>@options</span>

    <span class='id pwd'>pwd</span> <span class='op'>=</span> <span class='const'>Dir</span><span class='period'>.</span><span class='id pwd'>pwd</span>

    <span class='const'>Dir</span><span class='period'>.</span><span class='id chdir'>chdir</span> <span class='ivar'>@options</span><span class='period'>.</span><span class='id op_dir'>op_dir</span> <span class='kw'>do</span>
      <span class='kw'>begin</span>
        <span class='kw'>self</span><span class='period'>.</span><span class='id class'>class</span><span class='period'>.</span><span class='id current'>current</span> <span class='op'>=</span> <span class='kw'>self</span>

        <span class='ivar'>@generator</span><span class='period'>.</span><span class='id generate'>generate</span> <span class='id file_info'>file_info</span>
        <span class='id update_output_dir'>update_output_dir</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>.</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id start_time'>start_time</span><span class='comma'>,</span> <span class='ivar'>@last_modified</span>
      <span class='kw'>ensure</span>
        <span class='kw'>self</span><span class='period'>.</span><span class='id class'>class</span><span class='period'>.</span><span class='id current'>current</span> <span class='op'>=</span> <span class='kw'>nil</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='kw'>unless</span> <span class='ivar'>@options</span><span class='period'>.</span><span class='id quiet'>quiet</span> <span class='kw'>or</span> <span class='kw'>not</span> <span class='ivar'>@stats</span> <span class='kw'>then</span>
    <span class='id puts'>puts</span>
    <span class='ivar'>@stats</span><span class='period'>.</span><span class='id print'>print</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="error-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>error</strong>(msg) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Report an error message and exit
</p>


  </div>
</div>
<div class="tags">
  <h3>Raises:</h3>
<ul class="raise">
  
    <li>
      
        <span class='type'>(<tt><span class='object_link'><a href="Error.html" title="RDoc::Error (class)">RDoc::Error</a></span></tt>)</span>
      
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


95
96
97</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rdoc/rdoc.rb', line 95</span>

<span class='kw'>def</span> <span class='id error'>error</span><span class='lparen'>(</span><span class='id msg'>msg</span><span class='rparen'>)</span>
  <span class='id raise'>raise</span> <span class='const'>RDoc</span><span class='op'>::</span><span class='const'>Error</span><span class='comma'>,</span> <span class='id msg'>msg</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="gather_files-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>gather_files</strong>(files) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Gathers a set of parseable files from the files and directories listed in
<tt>files</tt>.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


103
104
105
106
107
108
109
110
111</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rdoc/rdoc.rb', line 103</span>

<span class='kw'>def</span> <span class='id gather_files'>gather_files</span> <span class='id files'>files</span>
  <span class='id files'>files</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>.</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='id files'>files</span><span class='period'>.</span><span class='id empty?'>empty?</span>

  <span class='id file_list'>file_list</span> <span class='op'>=</span> <span class='id normalized_file_list'>normalized_file_list</span> <span class='id files'>files</span><span class='comma'>,</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='ivar'>@exclude</span>

  <span class='id file_list'>file_list</span> <span class='op'>=</span> <span class='id file_list'>file_list</span><span class='period'>.</span><span class='id uniq'>uniq</span>

  <span class='id file_list'>file_list</span> <span class='op'>=</span> <span class='id remove_unparseable'>remove_unparseable</span> <span class='id file_list'>file_list</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="handle_pipe-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>handle_pipe</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Turns RDoc from stdin into HTML
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


116
117
118
119
120
121
122</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rdoc/rdoc.rb', line 116</span>

<span class='kw'>def</span> <span class='id handle_pipe'>handle_pipe</span>
  <span class='ivar'>@html</span> <span class='op'>=</span> <span class='const'>RDoc</span><span class='op'>::</span><span class='const'>Markup</span><span class='op'>::</span><span class='const'>ToHtml</span><span class='period'>.</span><span class='id new'>new</span>

  <span class='id out'>out</span> <span class='op'>=</span> <span class='ivar'>@html</span><span class='period'>.</span><span class='id convert'>convert</span> <span class='gvar'>$stdin</span><span class='period'>.</span><span class='id read'>read</span>

  <span class='gvar'>$stdout</span><span class='period'>.</span><span class='id write'>write</span> <span class='id out'>out</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="install_siginfo_handler-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>install_siginfo_handler</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Installs a siginfo handler that prints the current filename.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


127
128
129
130
131
132
133</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rdoc/rdoc.rb', line 127</span>

<span class='kw'>def</span> <span class='id install_siginfo_handler'>install_siginfo_handler</span>
  <span class='kw'>return</span> <span class='kw'>unless</span> <span class='const'>Signal</span><span class='period'>.</span><span class='id list'>list</span><span class='period'>.</span><span class='id include?'>include?</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>INFO</span><span class='tstring_end'>'</span></span>

  <span class='ivar'>@old_siginfo</span> <span class='op'>=</span> <span class='id trap'>trap</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>INFO</span><span class='tstring_end'>'</span></span> <span class='kw'>do</span>
    <span class='id puts'>puts</span> <span class='ivar'>@current</span> <span class='kw'>if</span> <span class='ivar'>@current</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="list_files_in_directory-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>list_files_in_directory</strong>(dir) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Return a list of the files to be processed in a directory. We know that
this directory doesn&#8217;t have a .document file, so we&#8217;re looking
for real files. However we may well contain subdirectories which must be
tested for .document files.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


269
270
271
272
273</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rdoc/rdoc.rb', line 269</span>

<span class='kw'>def</span> <span class='id list_files_in_directory'>list_files_in_directory</span> <span class='id dir'>dir</span>
  <span class='id files'>files</span> <span class='op'>=</span> <span class='const'>Dir</span><span class='period'>.</span><span class='id glob'>glob</span> <span class='const'>File</span><span class='period'>.</span><span class='id join'>join</span><span class='lparen'>(</span><span class='id dir'>dir</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>*</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

  <span class='id normalized_file_list'>normalized_file_list</span> <span class='id files'>files</span><span class='comma'>,</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='ivar'>@options</span><span class='period'>.</span><span class='id exclude'>exclude</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="normalized_file_list-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>normalized_file_list</strong>(relative_files, force_doc = false, exclude_pattern = nil) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Given a list of files and directories, create a list of all the Ruby files
they contain.
</p>
<p>
If <tt>force_doc</tt> is true we always add the given files, if false, only
add files that we guarantee we can parse.  It is true when looking at files
given on the command line, false when recursing through subdirectories.
</p>
<p>
The effect of this is that if you want a file with a non-standard extension
parsed, you must name it explicitly.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rdoc/rdoc.rb', line 228</span>

<span class='kw'>def</span> <span class='id normalized_file_list'>normalized_file_list</span><span class='lparen'>(</span><span class='id relative_files'>relative_files</span><span class='comma'>,</span> <span class='id force_doc'>force_doc</span> <span class='op'>=</span> <span class='kw'>false</span><span class='comma'>,</span>
                         <span class='id exclude_pattern'>exclude_pattern</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id file_list'>file_list</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

  <span class='id relative_files'>relative_files</span><span class='period'>.</span><span class='id each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id rel_file_name'>rel_file_name</span><span class='op'>|</span>
    <span class='kw'>next</span> <span class='kw'>if</span> <span class='id exclude_pattern'>exclude_pattern</span> <span class='op'>&amp;&amp;</span> <span class='id exclude_pattern'>exclude_pattern</span> <span class='op'>=~</span> <span class='id rel_file_name'>rel_file_name</span>
    <span class='id stat'>stat</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id stat'>stat</span> <span class='id rel_file_name'>rel_file_name</span> <span class='kw'>rescue</span> <span class='kw'>next</span>

    <span class='kw'>case</span> <span class='id type'>type</span> <span class='op'>=</span> <span class='id stat'>stat</span><span class='period'>.</span><span class='id ftype'>ftype</span>
    <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>file</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>then</span>
      <span class='kw'>next</span> <span class='kw'>if</span> <span class='id last_modified'>last_modified</span> <span class='op'>=</span> <span class='ivar'>@last_modified</span><span class='lbracket'>[</span><span class='id rel_file_name'>rel_file_name</span><span class='rbracket'>]</span> <span class='kw'>and</span>
              <span class='id stat'>stat</span><span class='period'>.</span><span class='id mtime'>mtime</span><span class='period'>.</span><span class='id to_i'>to_i</span> <span class='op'>&lt;=</span> <span class='id last_modified'>last_modified</span><span class='period'>.</span><span class='id to_i'>to_i</span>

      <span class='kw'>if</span> <span class='id force_doc'>force_doc</span> <span class='kw'>or</span> <span class='const'>RDoc</span><span class='op'>::</span><span class='const'>Parser</span><span class='period'>.</span><span class='id can_parse'>can_parse</span><span class='lparen'>(</span><span class='id rel_file_name'>rel_file_name</span><span class='rparen'>)</span> <span class='kw'>then</span>
        <span class='id file_list'>file_list</span> <span class='op'>&lt;&lt;</span> <span class='id rel_file_name'>rel_file_name</span><span class='period'>.</span><span class='id sub'>sub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^\.\/</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
        <span class='ivar'>@last_modified</span><span class='lbracket'>[</span><span class='id rel_file_name'>rel_file_name</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id stat'>stat</span><span class='period'>.</span><span class='id mtime'>mtime</span>
      <span class='kw'>end</span>
    <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>directory</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>then</span>
      <span class='kw'>next</span> <span class='kw'>if</span> <span class='id rel_file_name'>rel_file_name</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>CVS</span><span class='tstring_end'>&quot;</span></span> <span class='op'>||</span> <span class='id rel_file_name'>rel_file_name</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>.svn</span><span class='tstring_end'>&quot;</span></span>

      <span class='id dot_doc'>dot_doc</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id join'>join</span> <span class='id rel_file_name'>rel_file_name</span><span class='comma'>,</span> <span class='const'>RDoc</span><span class='op'>::</span><span class='const'>DOT_DOC_FILENAME</span>

      <span class='kw'>if</span> <span class='const'>File</span><span class='period'>.</span><span class='id file?'>file?</span> <span class='id dot_doc'>dot_doc</span> <span class='kw'>then</span>
        <span class='id file_list'>file_list</span> <span class='op'>&lt;&lt;</span> <span class='id parse_dot_doc_file'>parse_dot_doc_file</span><span class='lparen'>(</span><span class='id rel_file_name'>rel_file_name</span><span class='comma'>,</span> <span class='id dot_doc'>dot_doc</span><span class='rparen'>)</span>
      <span class='kw'>else</span>
        <span class='id file_list'>file_list</span> <span class='op'>&lt;&lt;</span> <span class='id list_files_in_directory'>list_files_in_directory</span><span class='lparen'>(</span><span class='id rel_file_name'>rel_file_name</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>else</span>
      <span class='id raise'>raise</span> <span class='const'>RDoc</span><span class='op'>::</span><span class='const'>Error</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>I can't deal with a </span><span class='embexpr_beg'>#{</span><span class='id type'>type</span><span class='rbrace'>}</span><span class='tstring_content'> </span><span class='embexpr_beg'>#{</span><span class='id rel_file_name'>rel_file_name</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id file_list'>file_list</span><span class='period'>.</span><span class='id flatten'>flatten</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="output_flag_file-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>output_flag_file</strong>(op_dir) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Return the path name of the flag file in an output directory.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


193
194
195</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rdoc/rdoc.rb', line 193</span>

<span class='kw'>def</span> <span class='id output_flag_file'>output_flag_file</span><span class='lparen'>(</span><span class='id op_dir'>op_dir</span><span class='rparen'>)</span>
  <span class='const'>File</span><span class='period'>.</span><span class='id join'>join</span> <span class='id op_dir'>op_dir</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>created.rid</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="parse_dot_doc_file-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>parse_dot_doc_file</strong>(in_dir, filename) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
The .document file contains a list of file and directory name patterns,
representing candidates for documentation. It may also contain comments
(starting with &#8217;#&#8217;)
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


202
203
204
205
206
207
208
209
210
211
212
213
214</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rdoc/rdoc.rb', line 202</span>

<span class='kw'>def</span> <span class='id parse_dot_doc_file'>parse_dot_doc_file</span> <span class='id in_dir'>in_dir</span><span class='comma'>,</span> <span class='id filename'>filename</span>
  <span class='comment'># read and strip comments
</span>  <span class='id patterns'>patterns</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id read'>read</span><span class='lparen'>(</span><span class='id filename'>filename</span><span class='rparen'>)</span><span class='period'>.</span><span class='id gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>#.*</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>

  <span class='id result'>result</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

  <span class='id patterns'>patterns</span><span class='period'>.</span><span class='id split'>split</span><span class='period'>.</span><span class='id each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id patt'>patt</span><span class='op'>|</span>
    <span class='id candidates'>candidates</span> <span class='op'>=</span> <span class='const'>Dir</span><span class='period'>.</span><span class='id glob'>glob</span><span class='lparen'>(</span><span class='const'>File</span><span class='period'>.</span><span class='id join'>join</span><span class='lparen'>(</span><span class='id in_dir'>in_dir</span><span class='comma'>,</span> <span class='id patt'>patt</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='id result'>result</span><span class='period'>.</span><span class='id concat'>concat</span> <span class='id normalized_file_list'>normalized_file_list</span><span class='lparen'>(</span><span class='id candidates'>candidates</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id result'>result</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="parse_file-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>parse_file</strong>(filename) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Parses <tt>filename</tt> and returns an RDoc::TopLevel
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rdoc/rdoc.rb', line 278</span>

<span class='kw'>def</span> <span class='id parse_file'>parse_file</span> <span class='id filename'>filename</span>
  <span class='ivar'>@stats</span><span class='period'>.</span><span class='id add_file'>add_file</span> <span class='id filename'>filename</span>
  <span class='id content'>content</span> <span class='op'>=</span> <span class='id read_file_contents'>read_file_contents</span> <span class='id filename'>filename</span>

  <span class='kw'>return</span> <span class='kw'>unless</span> <span class='id content'>content</span>

  <span class='id top_level'>top_level</span> <span class='op'>=</span> <span class='const'>RDoc</span><span class='op'>::</span><span class='const'>TopLevel</span><span class='period'>.</span><span class='id new'>new</span> <span class='id filename'>filename</span>

  <span class='id parser'>parser</span> <span class='op'>=</span> <span class='const'>RDoc</span><span class='op'>::</span><span class='const'>Parser</span><span class='period'>.</span><span class='id for'>for</span> <span class='id top_level'>top_level</span><span class='comma'>,</span> <span class='id filename'>filename</span><span class='comma'>,</span> <span class='id content'>content</span><span class='comma'>,</span> <span class='ivar'>@options</span><span class='comma'>,</span> <span class='ivar'>@stats</span>

  <span class='kw'>return</span> <span class='kw'>unless</span> <span class='id parser'>parser</span>

  <span class='id parser'>parser</span><span class='period'>.</span><span class='id scan'>scan</span>
<span class='kw'>rescue</span> <span class='op'>=&gt;</span> <span class='id e'>e</span>
  <span class='gvar'>$stderr</span><span class='period'>.</span><span class='id puts'>puts</span> <span class='heredoc_beg'>&lt;&lt;-EOF</span><span class='tstring_content'>Before reporting this, could you check that the file you're documenting
compiles cleanly--RDoc is not a full Ruby parser, and gets confused easily if
fed invalid programs.

The internal error was:

</span><span class='tstring_content'>\t(</span><span class='embexpr_beg'>#{</span><span class='id e'>e</span><span class='period'>.</span><span class='id class'>class</span><span class='rbrace'>}</span><span class='tstring_content'>) </span><span class='embexpr_beg'>#{</span><span class='id e'>e</span><span class='period'>.</span><span class='id message'>message</span><span class='rbrace'>}</span><span class='tstring_content'>

</span><span class='heredoc_end'>  EOF
</span>

  <span class='gvar'>$stderr</span><span class='period'>.</span><span class='id puts'>puts</span> <span class='id e'>e</span><span class='period'>.</span><span class='id backtrace'>backtrace</span><span class='period'>.</span><span class='id join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n\t</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='gvar'>$RDOC_DEBUG</span>

  <span class='id raise'>raise</span> <span class='id e'>e</span>
  <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="parse_files-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>parse_files</strong>(files) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Parse each file on the command line, recursively entering directories.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rdoc/rdoc.rb', line 312</span>

<span class='kw'>def</span> <span class='id parse_files'>parse_files</span> <span class='id files'>files</span>
  <span class='id file_list'>file_list</span> <span class='op'>=</span> <span class='id gather_files'>gather_files</span> <span class='id files'>files</span>

  <span class='kw'>return</span> <span class='lbracket'>[</span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='id file_list'>file_list</span><span class='period'>.</span><span class='id empty?'>empty?</span>

  <span class='id file_info'>file_info</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

  <span class='ivar'>@stats</span> <span class='op'>=</span> <span class='const'>RDoc</span><span class='op'>::</span><span class='const'>Stats</span><span class='period'>.</span><span class='id new'>new</span> <span class='id file_list'>file_list</span><span class='period'>.</span><span class='id size'>size</span><span class='comma'>,</span> <span class='ivar'>@options</span><span class='period'>.</span><span class='id verbosity'>verbosity</span>
  <span class='ivar'>@stats</span><span class='period'>.</span><span class='id begin_adding'>begin_adding</span>

  <span class='id file_info'>file_info</span> <span class='op'>=</span> <span class='id file_list'>file_list</span><span class='period'>.</span><span class='id map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id filename'>filename</span><span class='op'>|</span>
    <span class='ivar'>@current</span> <span class='op'>=</span> <span class='id filename'>filename</span>
    <span class='id parse_file'>parse_file</span> <span class='id filename'>filename</span>
  <span class='kw'>end</span><span class='period'>.</span><span class='id compact'>compact</span>

  <span class='ivar'>@stats</span><span class='period'>.</span><span class='id done_adding'>done_adding</span>

  <span class='id file_info'>file_info</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="read_file_contents-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>read_file_contents</strong>(filename) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rdoc/rdoc.rb', line 406</span>

<span class='kw'>def</span> <span class='id read_file_contents'>read_file_contents</span><span class='lparen'>(</span><span class='id filename'>filename</span><span class='rparen'>)</span>
  <span class='id content'>content</span> <span class='op'>=</span> <span class='id open'>open</span> <span class='id filename'>filename</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>rb</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id f'>f</span><span class='op'>|</span> <span class='id f'>f</span><span class='period'>.</span><span class='id read'>read</span> <span class='kw'>end</span>

  <span class='id utf8'>utf8</span> <span class='op'>=</span> <span class='id content'>content</span><span class='period'>.</span><span class='id sub!'>sub!</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\A\xef\xbb\xbf</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='kw'>defined?</span> <span class='const'>Encoding</span> <span class='kw'>then</span>
    <span class='kw'>if</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>coding[=:]\s*([^\s;]+)</span><span class='regexp_end'>/i</span></span> <span class='op'>=~</span> <span class='id content'>content</span><span class='lbracket'>[</span><span class='tstring'><span class='regexp_beg'>%r&quot;</span><span class='tstring_content'>\A(?:#!.*\n)?.*\n</span><span class='regexp_end'>&quot;</span></span><span class='rbracket'>]</span>
      <span class='id enc'>enc</span> <span class='op'>=</span> <span class='op'>::</span><span class='const'>Encoding</span><span class='period'>.</span><span class='id find'>find</span><span class='lparen'>(</span><span class='backref'>$1</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='kw'>if</span> <span class='id enc'>enc</span> <span class='op'>||=</span> <span class='lparen'>(</span><span class='const'>Encoding</span><span class='op'>::</span><span class='const'>UTF_8</span> <span class='kw'>if</span> <span class='id utf8'>utf8</span><span class='rparen'>)</span>
      <span class='id content'>content</span><span class='period'>.</span><span class='id force_encoding'>force_encoding</span><span class='lparen'>(</span><span class='id enc'>enc</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id content'>content</span>
<span class='kw'>rescue</span> <span class='const'>Errno</span><span class='op'>::</span><span class='const'>EISDIR</span><span class='comma'>,</span> <span class='const'>Errno</span><span class='op'>::</span><span class='const'>ENOENT</span>
  <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="remove_siginfo_handler-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>remove_siginfo_handler</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Removes a siginfo handler and replaces the previous
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


427
428
429
430
431
432
433</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rdoc/rdoc.rb', line 427</span>

<span class='kw'>def</span> <span class='id remove_siginfo_handler'>remove_siginfo_handler</span>
  <span class='kw'>return</span> <span class='kw'>unless</span> <span class='const'>Signal</span><span class='period'>.</span><span class='id list'>list</span><span class='period'>.</span><span class='id key?'>key?</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>INFO</span><span class='tstring_end'>'</span></span>

  <span class='id handler'>handler</span> <span class='op'>=</span> <span class='ivar'>@old_siginfo</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>DEFAULT</span><span class='tstring_end'>'</span></span>

  <span class='id trap'>trap</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>INFO</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='id handler'>handler</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="remove_unparseable-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>remove_unparseable</strong>(files) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Removes file extensions known to be unparseable from <tt>files</tt>
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


335
336
337
338
339</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rdoc/rdoc.rb', line 335</span>

<span class='kw'>def</span> <span class='id remove_unparseable'>remove_unparseable</span> <span class='id files'>files</span>
  <span class='id files'>files</span><span class='period'>.</span><span class='id reject'>reject</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id file'>file</span><span class='op'>|</span>
    <span class='id file'>file</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\.(?:class|eps|erb|scpt\.txt|ttf|yml)$</span><span class='regexp_end'>/i</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="setup_output_dir-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>setup_output_dir</strong>(dir, force) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Create an output dir if it doesn&#8217;t exist. If it does exist, but
doesn&#8217;t contain the flag file <tt>created.rid</tt> then we refuse to
use it, as we may clobber some manually generated documentation
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rdoc/rdoc.rb', line 140</span>

<span class='kw'>def</span> <span class='id setup_output_dir'>setup_output_dir</span><span class='lparen'>(</span><span class='id dir'>dir</span><span class='comma'>,</span> <span class='id force'>force</span><span class='rparen'>)</span>
  <span class='id flag_file'>flag_file</span> <span class='op'>=</span> <span class='id output_flag_file'>output_flag_file</span> <span class='id dir'>dir</span>

  <span class='id last'>last</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>

  <span class='kw'>if</span> <span class='const'>File</span><span class='period'>.</span><span class='id exist?'>exist?</span> <span class='id dir'>dir</span> <span class='kw'>then</span>
    <span class='id error'>error</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id dir'>dir</span><span class='rbrace'>}</span><span class='tstring_content'> exists and is not a directory</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='const'>File</span><span class='period'>.</span><span class='id directory?'>directory?</span> <span class='id dir'>dir</span>

    <span class='kw'>begin</span>
      <span class='id open'>open</span> <span class='id flag_file'>flag_file</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id io'>io</span><span class='op'>|</span>
        <span class='kw'>unless</span> <span class='id force'>force</span> <span class='kw'>then</span>
          <span class='const'>Time</span><span class='period'>.</span><span class='id parse'>parse</span> <span class='id io'>io</span><span class='period'>.</span><span class='id gets'>gets</span>

          <span class='id io'>io</span><span class='period'>.</span><span class='id each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id line'>line</span><span class='op'>|</span>
            <span class='id file'>file</span><span class='comma'>,</span> <span class='id time'>time</span> <span class='op'>=</span> <span class='id line'>line</span><span class='period'>.</span><span class='id split'>split</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\t</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>2</span>
            <span class='id time'>time</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id parse'>parse</span><span class='lparen'>(</span><span class='id time'>time</span><span class='rparen'>)</span> <span class='kw'>rescue</span> <span class='kw'>next</span>
            <span class='id last'>last</span><span class='lbracket'>[</span><span class='id file'>file</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id time'>time</span>
          <span class='kw'>end</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='kw'>rescue</span> <span class='const'>SystemCallError</span><span class='comma'>,</span> <span class='const'>TypeError</span>
      <span class='id error'>error</span> <span class='heredoc_beg'>&lt;&lt;-ERROR</span><span class='tstring_content'>
</span><span class='tstring_content'>Directory </span><span class='embexpr_beg'>#{</span><span class='id dir'>dir</span><span class='rbrace'>}</span><span class='tstring_content'> already exists, but it looks like it isn't an RDoc directory.

Because RDoc doesn't want to risk destroying any of your existing files,
you'll need to specify a different output directory name (using the --op &lt;dir&gt;
option)

</span><span class='heredoc_end'>      ERROR
</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='const'>FileUtils</span><span class='period'>.</span><span class='id mkdir_p'>mkdir_p</span> <span class='id dir'>dir</span>
  <span class='kw'>end</span>

  <span class='id last'>last</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="update_output_dir-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>update_output_dir</strong>(op_dir, time, last = {}) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Update the flag file in an output directory.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


181
182
183
184
185
186
187
188</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rdoc/rdoc.rb', line 181</span>

<span class='kw'>def</span> <span class='id update_output_dir'>update_output_dir</span><span class='lparen'>(</span><span class='id op_dir'>op_dir</span><span class='comma'>,</span> <span class='id time'>time</span><span class='comma'>,</span> <span class='id last'>last</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id open'>open</span> <span class='id output_flag_file'>output_flag_file</span><span class='lparen'>(</span><span class='id op_dir'>op_dir</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>w</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id f'>f</span><span class='op'>|</span>
    <span class='id f'>f</span><span class='period'>.</span><span class='id puts'>puts</span> <span class='id time'>time</span><span class='period'>.</span><span class='id rfc2822'>rfc2822</span>
    <span class='id last'>last</span><span class='period'>.</span><span class='id each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id n'>n</span><span class='comma'>,</span> <span class='id t'>t</span><span class='op'>|</span>
      <span class='id f'>f</span><span class='period'>.</span><span class='id puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id n'>n</span><span class='rbrace'>}</span><span class='tstring_content'>\t</span><span class='embexpr_beg'>#{</span><span class='id t'>t</span><span class='period'>.</span><span class='id rfc2822'>rfc2822</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>
    
    <div id="footer">
  Generated on Thu Oct 14 00:01:55 2010 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.6.1 (ruby-1.9.2).
</div>

  </body>
</html>