  <div id="fileHeader">
    <h1>drb_client.rb</h1>
    <table class="header-table">
    <tr class="top-aligned-row">
      <td><strong>Path:</strong></td>
      <td>lib/cucumber/cli/drb_client.rb</td>
    </tr>
    <tr class="top-aligned-row">
      <td><strong>Last Update:</strong></td>
      <td>Mon Oct 12 14:58:05 +0200 2009</td>
    </tr>
    </table>
  </div>
 <!-- banner header -->

  <div id="bodyContent" >
    <h2>Source Code</h2>
    <pre>require &quot;drb/drb&quot;
# This code was taken from the RSpec project and slightly modified.

module Cucumber
  module Cli
    class DRbClientError &lt; StandardError
    end
    # Runs features on a DRB server, originally created with Spork compatibility in mind.
    class DRbClient
      DEFAULT_PORT = 8990

      def self.run(args, error_stream, out_stream, port = nil)
        port ||= ENV[&quot;CUCUMBER_DRB&quot;] || DEFAULT_PORT

        # See http://redmine.ruby-lang.org/issues/show/496 as to why we specify localhost:0
        begin
          DRb.start_service(&quot;druby://localhost:0&quot;)
        rescue SocketError
        # Ruby-1.8.7 on snow leopard doesn't like localhost:0 - but just :0
        # seems to work just fine
          DRb.start_service(&quot;druby://:0&quot;)
        end
        feature_server = DRbObject.new_with_uri(&quot;druby://127.0.0.1:#{port}&quot;)
        cloned_args = [] # I have no idea why this is needed, but if the regular args are sent then DRb magically transforms it into a DRb object - not an array
        args.each { |arg| cloned_args &lt;&lt; arg }
        feature_server.run(cloned_args, error_stream, out_stream)
      rescue DRb::DRbConnError =&gt; e
        raise DRbClientError, &quot;No DRb server is running.&quot;
      end
    end
  end
end
</pre>
    </div>