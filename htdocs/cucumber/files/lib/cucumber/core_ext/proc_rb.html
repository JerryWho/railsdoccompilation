  <div id="fileHeader">
    <h1>proc.rb</h1>
    <table class="header-table">
    <tr class="top-aligned-row">
      <td><strong>Path:</strong></td>
      <td>lib/cucumber/core_ext/proc.rb</td>
    </tr>
    <tr class="top-aligned-row">
      <td><strong>Last Update:</strong></td>
      <td>Sat Mar 28 20:11:24 +0100 2009</td>
    </tr>
    </table>
  </div>
 <!-- banner header -->

  <div id="bodyContent" >
    <h2>Source Code</h2>
    <pre># Proc extension to get more location info out of a proc
class Proc
  PROC_PATTERN = /[\d\w]+@(.*):(.*)&gt;/
  
  if Proc.new{}.to_s =~ PROC_PATTERN
    def backtrace_line(name)
      &quot;#{file_colon_line}:in `#{name}'&quot;
    end

    def to_comment_line
      &quot;# #{file_colon_line}&quot;
    end

    def file_colon_line
      path, line = *to_s.match(PROC_PATTERN)[1..2]
      path = File.expand_path(path)
      pwd = Dir.pwd
      path = path[pwd.length+1..-1]
      &quot;#{path}:#{line}&quot;
    end
  else
    # This Ruby implementation doesn't implement Proc#to_s correctly
    STDERR.puts &quot;*** THIS RUBY IMPLEMENTATION DOESN'T REPORT FILE AND LINE FOR PROCS ***&quot;
    
    def backtrace_line
      nil
    end

    def to_comment_line
      &quot;&quot;
    end
  end
end 
</pre>
    </div>