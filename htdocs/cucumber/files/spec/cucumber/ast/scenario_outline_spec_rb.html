  <div id="fileHeader">
    <h1>scenario_outline_spec.rb</h1>
    <table class="header-table">
    <tr class="top-aligned-row">
      <td><strong>Path:</strong></td>
      <td>spec/cucumber/ast/scenario_outline_spec.rb</td>
    </tr>
    <tr class="top-aligned-row">
      <td><strong>Last Update:</strong></td>
      <td>Sun Jul 25 18:21:09 +0200 2010</td>
    </tr>
    </table>
  </div>
 <!-- banner header -->

  <div id="bodyContent" >
    <h2>Source Code</h2>
    <pre>require File.expand_path(File.dirname(__FILE__) + '/../../spec_helper')
require 'cucumber/step_mother'
require 'cucumber/ast'
require 'cucumber/core_ext/string'
require 'cucumber/rb_support/rb_language'

module Cucumber
  module Ast
    describe ScenarioOutline do
      before do
        @step_mother = Cucumber::StepMother.new
        @step_mother.load_programming_language('rb')
        @dsl = Object.new
        @dsl.extend(Cucumber::RbSupport::RbDsl)

        @dsl.Given(/^there are (\d+) cucumbers$/) do |n|
          @initial = n.to_i
        end
        @dsl.When(/^I eat (\d+) cucumbers$/) do |n|
          @eaten = n.to_i
        end
        @dsl.Then(/^I should have (\d+) cucumbers$/) do |n|
          (@initial - @eaten).should == n.to_i
        end
        @dsl.Then(/^I should have (\d+) cucumbers in my belly$/) do |n|
          @eaten.should == n.to_i
        end

        @scenario_outline = ScenarioOutline.new(
          background=nil,
          Comment.new(&quot;&quot;),
          Tags.new(18, []),
          19,
          &quot;Scenario:&quot;, &quot;My outline&quot;,
          [
            Step.new(20, 'Given', 'there are &lt;start&gt; cucumbers'),
            Step.new(21, 'When',  'I eat &lt;eat&gt; cucumbers'),
            Step.new(22, 'Then',  'I should have &lt;left&gt; cucumbers'),
            Step.new(23, 'And',   'I should have &lt;eat&gt; cucumbers in my belly')
          ],
          [
            [
              Comment.new(&quot;#Mmmm... cucumbers\n&quot;),
              24,
              'Examples:',
              'First table',
              [
                %w{start eat left},
                %w{12 5 7},
                %w{20 6 14}
              ]
            ]
          ]

        )
      end

      it &quot;should replace all variables and call outline once for each table row&quot; do
        visitor = TreeWalker.new(@step_mother)
        visitor.should_receive(:visit_table_row).exactly(3).times
        visitor.visit_feature_element(@scenario_outline)
      end
    end
  end
end
</pre>
    </div>