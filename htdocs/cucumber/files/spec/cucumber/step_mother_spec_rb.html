  <div id="fileHeader">
    <h1>step_mother_spec.rb</h1>
    <table class="header-table">
    <tr class="top-aligned-row">
      <td><strong>Path:</strong></td>
      <td>spec/cucumber/step_mother_spec.rb</td>
    </tr>
    <tr class="top-aligned-row">
      <td><strong>Last Update:</strong></td>
      <td>Sat Mar 28 20:14:35 +0100 2009</td>
    </tr>
    </table>
  </div>
 <!-- banner header -->

  <div id="bodyContent" >
    <h2>Source Code</h2>
    <pre>require File.dirname(__FILE__) + '/../spec_helper'

require 'cucumber/step_mother'

module Cucumber
  describe StepMother do
    before do
      @step_mother = Object.new
      @step_mother.extend(StepMother)
      @visitor = mock('Visitor')
    end

    it &quot;should format step names&quot; do
      @step_mother.Given(/it (.*) in (.*)/) do |what, month|
      end
      @step_mother.Given(/nope something else/) do |what, month|
      end
      format = @step_mother.step_match(&quot;it snows in april&quot;).format_args(&quot;[%s]&quot;)
      format.should == &quot;it [snows] in [april]&quot;
    end

    it &quot;should raise Ambiguous error when multiple step definitions match&quot; do
      @step_mother.Given(/Three (.*) mice/) {|disability|}
      @step_mother.Given(/Three blind (.*)/) {|animal|}

      lambda do
        @step_mother.step_match(&quot;Three blind mice&quot;)
      end.should raise_error(Ambiguous, %{Ambiguous match of &quot;Three blind mice&quot;:

spec/cucumber/step_mother_spec.rb:23:in `/Three (.*) mice/'
spec/cucumber/step_mother_spec.rb:24:in `/Three blind (.*)/'

})
    end

    it &quot;should not raise Ambiguous error when multiple step definitions match, but --guess is enabled&quot; do
      @step_mother.options = {:guess =&gt; true}
      @step_mother.Given(/Three (.*) mice/) {|disability|}
      @step_mother.Given(/Three (.*)/) {|animal|}

      lambda do
        @step_mother.step_match(&quot;Three blind mice&quot;)
      end.should_not raise_error
    end
    
    it &quot;should pick right step definition when --guess is enabled and equal number of capture groups&quot; do
      @step_mother.options = {:guess =&gt; true}
      right = @step_mother.Given(/Three (.*) mice/) {|disability|}
      wrong = @step_mother.Given(/Three (.*)/) {|animal|}
      @step_mother.step_match(&quot;Three blind mice&quot;).step_definition.should == right
    end
    
    it &quot;should pick right step definition when --guess is enabled and unequal number of capture groups&quot; do
      @step_mother.options = {:guess =&gt; true}
      right = @step_mother.Given(/Three (.*) mice ran (.*)/) {|disability|}
      wrong = @step_mother.Given(/Three (.*)/) {|animal|}
      @step_mother.step_match(&quot;Three blind mice ran far&quot;).step_definition.should == right
    end
    
    it &quot;should raise Undefined error when no step definitions match&quot; do
      lambda do
        @step_mother.step_match(&quot;Three blind mice&quot;)
      end.should raise_error(Undefined)
    end

    it &quot;should raise Redundant error when same regexp is registered twice&quot; do
      @step_mother.Given(/Three (.*) mice/) {|disability|}
      lambda do
        @step_mother.Given(/Three (.*) mice/) {|disability|}
      end.should raise_error(Redundant)
    end
  end
end
</pre>
    </div>