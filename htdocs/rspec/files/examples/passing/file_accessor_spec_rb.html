  <div id="fileHeader">
    <h1>file_accessor_spec.rb</h1>
    <table class="header-table">
    <tr class="top-aligned-row">
      <td><strong>Path:</strong></td>
      <td>examples/passing/file_accessor_spec.rb</td>
    </tr>
    <tr class="top-aligned-row">
      <td><strong>Last Update:</strong></td>
      <td>Mon Dec 29 13:11:11 +0100 2008</td>
    </tr>
    </table>
  </div>
 <!-- banner header -->

  <div id="bodyContent" >
    <h2>Source Code</h2>
    <pre>require File.dirname(__FILE__) + '/spec_helper'
require File.dirname(__FILE__) + '/file_accessor'
require 'stringio'

describe &quot;A FileAccessor&quot; do
  # This sequence diagram illustrates what this spec specifies.
  #
  #                  +--------------+     +----------+     +-------------+
  #                  | FileAccessor |     | Pathname |     | IoProcessor |
  #                  +--------------+     +----------+     +-------------+
  #                         |                  |                  |
  #   open_and_handle_with  |                  |                  |
  #   --------------------&gt;| |           open  |                  |
  #                        | |---------------&gt;| |                 |
  #                        | | io             | |                 |
  #                        | |&lt;...............| |                 |
  #                        | |                 |     process(io)  |
  #                        | |----------------------------------&gt;| |
  #                        | |                 |                 | |
  #                        | |&lt;..................................| |
  #                         |                  |                  |
  #
  it &quot;should open a file and pass it to the processor's process method&quot; do
    # This is the primary actor
    accessor = FileAccessor.new

    # These are the primary actor's neighbours, which we mock.
    file = mock &quot;Pathname&quot;
    io_processor = mock &quot;IoProcessor&quot;
    
    io = StringIO.new &quot;whatever&quot;
    file.should_receive(:open).and_yield io
    io_processor.should_receive(:process).with(io)
    
    accessor.open_and_handle_with(file, io_processor)
  end

end
</pre>
    </div>