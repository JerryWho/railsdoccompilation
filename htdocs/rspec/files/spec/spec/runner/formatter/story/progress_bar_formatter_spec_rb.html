  <div id="fileHeader">
    <h1>progress_bar_formatter_spec.rb</h1>
    <table class="header-table">
    <tr class="top-aligned-row">
      <td><strong>Path:</strong></td>
      <td>spec/spec/runner/formatter/story/progress_bar_formatter_spec.rb</td>
    </tr>
    <tr class="top-aligned-row">
      <td><strong>Last Update:</strong></td>
      <td>Mon Dec 29 13:11:11 +0100 2008</td>
    </tr>
    </table>
  </div>
 <!-- banner header -->

  <div id="bodyContent" >
    <h2>Source Code</h2>
    <pre>require File.dirname(__FILE__) + '/../../../../spec_helper'
require 'spec/runner/formatter/story/progress_bar_formatter'

module Spec
  module Runner
    module Formatter
      module Story
        describe ProgressBarFormatter do
          before :each do
            # given
            @out = StringIO.new
            @out.stub!(:tty?).and_return(true)
            @tweaker = mock('tweaker')
            @tweaker.stub!(:tweak_backtrace)
            @options = mock('options')
            @options.stub!(:colour).and_return(true)
            @options.stub!(:backtrace_tweaker).and_return(@tweaker)

            @formatter = ProgressBarFormatter.new(@options, @out)
          end

          it 'should print some white space before test summary' do
            #when
            @formatter.run_started(1)
            @formatter.run_ended

            #then
            @out.string.should =~ /^\n{2}/
          end

          it &quot;should print how long tests took to complete&quot; do
            #when
            now = Time.now
            future = now+1
            Time.stub!(:now).and_return(now)
            @formatter.run_started(1)
            Time.stub!(:now).and_return(future)
            @formatter.run_ended

            #then
            @out.string.should include(&quot;Finished in %f seconds&quot; % (future-now))
          end


          it &quot;should push green dot for passing scenario&quot; do
            #when
            @formatter.scenario_started('','')
            @formatter.step_succeeded('', '')
            @formatter.scenario_ended
            @formatter.story_ended '', ''

            #then
            @out.string.should eql(&quot;\e[32m.\e[0m&quot;)
          end

          it &quot;should push red F for failure scenario&quot; do
            #when
            @formatter.scenario_started('','')
            @formatter.step_failed('', '')
            @formatter.scenario_failed('', '', '')
            @formatter.story_ended '', ''

            #then
            @out.string.should eql(&quot;\e[31mF\e[0m&quot;)
          end

          it &quot;should push yellow P for pending scenario&quot; do
            #when
            @formatter.scenario_started('','')
            @formatter.step_pending('', '')
            @formatter.scenario_pending('story', '', '')
            @formatter.story_ended '', ''

            #then
            @out.string.should eql(&quot;\e[33mP\e[0m&quot;)
          end

        end
      end
    end
  end
end
</pre>
    </div>