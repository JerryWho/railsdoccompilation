  <div id="fileHeader">
    <h1>step_group_spec.rb</h1>
    <table class="header-table">
    <tr class="top-aligned-row">
      <td><strong>Path:</strong></td>
      <td>spec/spec/story/step_group_spec.rb</td>
    </tr>
    <tr class="top-aligned-row">
      <td><strong>Last Update:</strong></td>
      <td>Mon Dec 29 13:11:11 +0100 2008</td>
    </tr>
    </table>
  </div>
 <!-- banner header -->

  <div id="bodyContent" >
    <h2>Source Code</h2>
    <pre>require File.dirname(__FILE__) + '/story_helper'

module Spec
  module Story
    describe StepGroup do
      before(:each) do
        @step_group = StepGroup.new
      end
      
      it &quot;should not find a matcher if empty&quot; do
        @step_group.find(:given, &quot;this and that&quot;).should be_nil
      end
      
      it &quot;should create a given_scenario matcher&quot; do
        step = @step_group.given_scenario(&quot;this and that&quot;) {}
        @step_group.find(:given_scenario, &quot;this and that&quot;).should_not be_nil
        @step_group.find(:given_scenario, &quot;this and that&quot;).should equal(step)
      end
      
      it &quot;should create a given matcher&quot; do
        step = @step_group.given(&quot;this and that&quot;) {}
        @step_group.find(:given, &quot;this and that&quot;).should equal(step)
      end
      
      it &quot;should create a when matcher&quot; do
        step = @step_group.when(&quot;this and that&quot;) {}
        @step_group.find(:when, &quot;this and that&quot;).should equal(step)
      end
      
      it &quot;should create a them matcher&quot; do
        step = @step_group.then(&quot;this and that&quot;) {}
        @step_group.find(:then, &quot;this and that&quot;).should equal(step)
      end
      
      it &quot;should add a matcher object&quot; do
        step = Step.new(&quot;this and that&quot;) {}
        @step_group.add(:given, step)
        @step_group.find(:given, &quot;this and that&quot;).should equal(step)
      end
      
      it &quot;should add it matchers to another StepGroup (with one given)&quot; do
        source = StepGroup.new
        target = StepGroup.new
        step = source.given(&quot;this and that&quot;) {}
        source.add_to target
        target.find(:given, &quot;this and that&quot;).should equal(step)
      end
      
      it &quot;should add it matchers to another StepGroup (with some of each type)&quot; do
        source = StepGroup.new
        target = StepGroup.new
        given_scenario = source.given_scenario(&quot;1&quot;) {}
        given = source.given(&quot;1&quot;) {}
        when1 = source.when(&quot;1&quot;) {}
        when2 = source.when(&quot;2&quot;) {}
        then1 = source.then(&quot;1&quot;) {}
        then2 = source.then(&quot;2&quot;) {}
        then3 = source.then(&quot;3&quot;) {}
        source.add_to target
        target.find(:given_scenario, &quot;1&quot;).should equal(given_scenario)
        target.find(:given, &quot;1&quot;).should equal(given)
        target.find(:when, &quot;1&quot;).should equal(when1)
        target.find(:when, &quot;2&quot;).should equal(when2)
        target.find(:then, &quot;1&quot;).should equal(then1)
        target.find(:then, &quot;2&quot;).should equal(then2)
        target.find(:then, &quot;3&quot;).should equal(then3)
      end
      
      it &quot;should append another collection&quot; do
        matchers_to_append = StepGroup.new
        step = matchers_to_append.given(&quot;this and that&quot;) {}
        @step_group &lt;&lt; matchers_to_append
        @step_group.find(:given, &quot;this and that&quot;).should equal(step)
      end
      
      it &quot;should append several other collections&quot; do
        matchers_to_append = StepGroup.new
        more_matchers_to_append = StepGroup.new
        first_matcher = matchers_to_append.given(&quot;this and that&quot;) {}
        second_matcher = more_matchers_to_append.given(&quot;and the other&quot;) {}
        @step_group &lt;&lt; matchers_to_append
        @step_group &lt;&lt; more_matchers_to_append
        @step_group.find(:given, &quot;this and that&quot;).should equal(first_matcher)
        @step_group.find(:given, &quot;and the other&quot;).should equal(second_matcher)
      end
      
      it &quot;should yield itself on initialization&quot; do
        begin
          $step_group_spec_step = nil
          matchers = StepGroup.new do |matchers|
            $step_group_spec_step = matchers.given(&quot;foo&quot;) {}
          end
          $step_group_spec_step.matches?(&quot;foo&quot;).should be_true
        ensure
          $step_group_spec_step = nil
        end
      end
      
      it &quot;should support defaults&quot; do
        class StepGroupSubclass &lt; StepGroup
          steps do |add|
            add.given(&quot;foo&quot;) {}
          end
        end
        StepGroupSubclass.new.find(:given, &quot;foo&quot;).should_not be_nil
      end
      
      it &quot;should create a Given&quot; do
        sub = Class.new(StepGroup).new
        step = sub.Given(&quot;foo&quot;) {}
        sub.find(:given, &quot;foo&quot;).should == step
      end
      
      it &quot;should create a When&quot; do
        sub = Class.new(StepGroup).new
        step = sub.When(&quot;foo&quot;) {}
        sub.find(:when, &quot;foo&quot;).should == step
      end
      
      it &quot;should create a Then&quot; do
        sub = Class.new(StepGroup).new
        step = sub.Then(&quot;foo&quot;) {}
        sub.find(:then, &quot;foo&quot;).should == step
      end
      
      it &quot;should create steps in a block&quot; do
        sub = Class.new(StepGroup).new do
          Given(&quot;a given&quot;) {}
          When(&quot;a when&quot;) {}
          Then(&quot;a then&quot;) {}
        end
        sub.find(:given, &quot;a given&quot;).should_not be_nil
        sub.find(:when, &quot;a when&quot;).should_not be_nil
        sub.find(:then, &quot;a then&quot;).should_not be_nil
      end
      
      it &quot;should clear itself&quot; do
        step = @step_group.given(&quot;this and that&quot;) {}
        @step_group.clear
        @step_group.find(:given, &quot;this and that&quot;).should be_nil
      end
      
      it &quot;should tell you when it is empty&quot; do
        @step_group.should be_empty
      end
      
      it &quot;should tell you when it is not empty&quot; do
        @step_group.given(&quot;this and that&quot;) {}
        @step_group.should_not be_empty
      end
      
      it &quot;should handle &lt;&lt; nil&quot; do
        @step_group &lt;&lt; nil
      end
    end
  end
end
</pre>
    </div>