  <div id="fileHeader">
    <h1>raise_error_spec.rb</h1>
    <table class="header-table">
    <tr class="top-aligned-row">
      <td><strong>Path:</strong></td>
      <td>spec/spec/matchers/raise_error_spec.rb</td>
    </tr>
    <tr class="top-aligned-row">
      <td><strong>Last Update:</strong></td>
      <td>Mon Dec 29 13:11:11 +0100 2008</td>
    </tr>
    </table>
  </div>
 <!-- banner header -->

  <div id="bodyContent" >
    <h2>Source Code</h2>
    <pre>require File.dirname(__FILE__) + '/../../spec_helper.rb'

describe &quot;should raise_error&quot; do
  it &quot;should pass if anything is raised&quot; do
    lambda {raise}.should raise_error
  end
  
  it &quot;should fail if nothing is raised&quot; do
    lambda {
      lambda {}.should raise_error
    }.should fail_with(&quot;expected Exception but nothing was raised&quot;)
  end
end

describe &quot;should raise_error {|err| ... }&quot; do
  it &quot;passes if there is an error&quot; do
    ran = false
    lambda { non_existent_method }.should raise_error {|e|
      ran = true
    }
    ran.should be_true
  end

  it &quot;passes the error to the block&quot; do
    error = nil
    lambda { non_existent_method }.should raise_error {|e|
      error = e
    }
    error.should be_an_instance_of(NameError)
  end
end

describe &quot;should_not raise_error&quot; do
  it &quot;should pass if nothing is raised&quot; do
    lambda {}.should_not raise_error
  end
  
  it &quot;should fail if anything is raised&quot; do
    lambda {
      lambda {raise}.should_not raise_error
    }.should fail_with(&quot;expected no Exception, got RuntimeError&quot;)
  end
end

describe &quot;should raise_error(message)&quot; do
  it &quot;should pass if RuntimeError is raised with the right message&quot; do
    lambda {raise 'blah'}.should raise_error('blah')
  end
  it &quot;should pass if RuntimeError is raised with a matching message&quot; do
    lambda {raise 'blah'}.should raise_error(/blah/)
  end
  it &quot;should pass if any other error is raised with the right message&quot; do
    lambda {raise NameError.new('blah')}.should raise_error('blah')
  end
  it &quot;should fail if RuntimeError error is raised with the wrong message&quot; do
    lambda do
      lambda {raise 'blarg'}.should raise_error('blah')
    end.should fail_with(&quot;expected Exception with \&quot;blah\&quot;, got #&lt;RuntimeError: blarg&gt;&quot;)
  end
  it &quot;should fail if any other error is raised with the wrong message&quot; do
    lambda do
      lambda {raise NameError.new('blarg')}.should raise_error('blah')
    end.should fail_with(&quot;expected Exception with \&quot;blah\&quot;, got #&lt;NameError: blarg&gt;&quot;)
  end
end

describe &quot;should_not raise_error(message)&quot; do
  it &quot;should pass if RuntimeError error is raised with the different message&quot; do
    lambda {raise 'blarg'}.should_not raise_error('blah')
  end
  it &quot;should pass if any other error is raised with the wrong message&quot; do
    lambda {raise NameError.new('blarg')}.should_not raise_error('blah')
  end
  it &quot;should fail if RuntimeError is raised with message&quot; do
    lambda do
      lambda {raise 'blah'}.should_not raise_error('blah')
    end.should fail_with(%Q|expected no Exception with &quot;blah&quot;, got #&lt;RuntimeError: blah&gt;|)
  end
  it &quot;should fail if any other error is raised with message&quot; do
    lambda do
      lambda {raise NameError.new('blah')}.should_not raise_error('blah')
    end.should fail_with(%Q|expected no Exception with &quot;blah&quot;, got #&lt;NameError: blah&gt;|)
  end
end

describe &quot;should raise_error(NamedError)&quot; do
  it &quot;should pass if named error is raised&quot; do
    lambda { non_existent_method }.should raise_error(NameError)
  end
  
  it &quot;should fail if nothing is raised&quot; do
    lambda {
      lambda { }.should raise_error(NameError)
    }.should fail_with(&quot;expected NameError but nothing was raised&quot;)
  end
  
  it &quot;should fail if another error is raised (NameError)&quot; do
    lambda {
      lambda { raise }.should raise_error(NameError)
    }.should fail_with(&quot;expected NameError, got RuntimeError&quot;)
  end
  
  it &quot;should fail if another error is raised (NameError)&quot; do
    lambda {
      lambda { load &quot;non/existent/file&quot; }.should raise_error(NameError)
    }.should fail_with(/expected NameError, got #&lt;LoadError/)
  end
end

describe &quot;should_not raise_error(NamedError)&quot; do
  it &quot;should pass if nothing is raised&quot; do
    lambda { }.should_not raise_error(NameError)
  end
  
  it &quot;should pass if another error is raised&quot; do
    lambda { raise }.should_not raise_error(NameError)
  end
  
  it &quot;should fail if named error is raised&quot; do
    lambda {
      lambda { non_existent_method }.should_not raise_error(NameError)
    }.should fail_with(/expected no NameError, got #&lt;NameError: undefined/)
  end  
end

describe &quot;should raise_error(NamedError, error_message) with String&quot; do
  it &quot;should pass if named error is raised with same message&quot; do
    lambda { raise &quot;example message&quot; }.should raise_error(RuntimeError, &quot;example message&quot;)
  end
  
  it &quot;should fail if nothing is raised&quot; do
    lambda {
      lambda {}.should raise_error(RuntimeError, &quot;example message&quot;)
    }.should fail_with(&quot;expected RuntimeError with \&quot;example message\&quot; but nothing was raised&quot;)
  end
  
  it &quot;should fail if incorrect error is raised&quot; do
    lambda {
      lambda { raise }.should raise_error(NameError, &quot;example message&quot;)
    }.should fail_with(&quot;expected NameError with \&quot;example message\&quot;, got RuntimeError&quot;)
  end
  
  it &quot;should fail if correct error is raised with incorrect message&quot; do
    lambda {
      lambda { raise RuntimeError.new(&quot;not the example message&quot;) }.should raise_error(RuntimeError, &quot;example message&quot;)
    }.should fail_with(/expected RuntimeError with \&quot;example message\&quot;, got #&lt;RuntimeError: not the example message/)
  end
end

describe &quot;should raise_error(NamedError, error_message) { |err| ... }&quot; do
  it &quot;should yield exception if named error is raised with same message&quot; do
    ran = false

    lambda {
      raise &quot;example message&quot;
    }.should raise_error(RuntimeError, &quot;example message&quot;) { |err|
      ran = true
      err.class.should == RuntimeError
      err.message.should == &quot;example message&quot;
    }

    ran.should == true
  end

  it &quot;yielded block should be able to fail on it's own right&quot; do
    ran, passed = false, false

    lambda {
      lambda {
        raise &quot;example message&quot;
      }.should raise_error(RuntimeError, &quot;example message&quot;) { |err|
        ran = true
        5.should == 4
        passed = true
      }
    }.should fail_with(/expected: 4/m)

    ran.should == true
    passed.should == false
  end

  it &quot;should NOT yield exception if no error was thrown&quot; do
    ran = false

    lambda {
      lambda {}.should raise_error(RuntimeError, &quot;example message&quot;) { |err|
        ran = true
      }
    }.should fail_with(&quot;expected RuntimeError with \&quot;example message\&quot; but nothing was raised&quot;)

    ran.should == false
  end

  it &quot;should not yield exception if error class is not matched&quot; do
    ran = false

    lambda {
      lambda {
        raise &quot;example message&quot;
      }.should raise_error(SyntaxError, &quot;example message&quot;) { |err|
        ran = true
      }
    }.should fail_with(&quot;expected SyntaxError with \&quot;example message\&quot;, got #&lt;RuntimeError: example message&gt;&quot;)

    ran.should == false
  end

  it &quot;should NOT yield exception if error message is not matched&quot; do
    ran = false

    lambda {
      lambda {
        raise &quot;example message&quot;
      }.should raise_error(RuntimeError, &quot;different message&quot;) { |err|
        ran = true
      }
    }.should fail_with(&quot;expected RuntimeError with \&quot;different message\&quot;, got #&lt;RuntimeError: example message&gt;&quot;)

    ran.should == false
  end
end

describe &quot;should_not raise_error(NamedError, error_message) { |err| ... }&quot; do
  it &quot;should pass if nothing is raised&quot; do
    ran = false

    lambda {}.should_not raise_error(RuntimeError, &quot;example message&quot;) { |err|
      ran = true
    }

    ran.should == false
  end

  it &quot;should pass if a different error is raised&quot; do
    ran = false

    lambda { raise }.should_not raise_error(NameError, &quot;example message&quot;) { |err|
      ran = true
    }

    ran.should == false
  end

  it &quot;should pass if same error is raised with different message&quot; do
    ran = false

    lambda {
      raise RuntimeError.new(&quot;not the example message&quot;)
    }.should_not raise_error(RuntimeError, &quot;example message&quot;) { |err|
      ran = true
    }

    ran.should == false
  end

  it &quot;should fail if named error is raised with same message&quot; do
    ran = false

    lambda {
      lambda {
        raise &quot;example message&quot;
      }.should_not raise_error(RuntimeError, &quot;example message&quot;) { |err|
        ran = true
      }
    }.should fail_with(&quot;expected no RuntimeError with \&quot;example message\&quot;, got #&lt;RuntimeError: example message&gt;&quot;)

    ran.should == false
  end
end

describe &quot;should_not raise_error(NamedError, error_message) with String&quot; do
  it &quot;should pass if nothing is raised&quot; do
    lambda {}.should_not raise_error(RuntimeError, &quot;example message&quot;)
  end
  
  it &quot;should pass if a different error is raised&quot; do
    lambda { raise }.should_not raise_error(NameError, &quot;example message&quot;)
  end
  
  it &quot;should pass if same error is raised with different message&quot; do
    lambda { raise RuntimeError.new(&quot;not the example message&quot;) }.should_not raise_error(RuntimeError, &quot;example message&quot;)
  end
  
  it &quot;should fail if named error is raised with same message&quot; do
    lambda {
      lambda { raise &quot;example message&quot; }.should_not raise_error(RuntimeError, &quot;example message&quot;)
    }.should fail_with(&quot;expected no RuntimeError with \&quot;example message\&quot;, got #&lt;RuntimeError: example message&gt;&quot;)
  end
end

describe &quot;should raise_error(NamedError, error_message) with Regexp&quot; do
  it &quot;should pass if named error is raised with matching message&quot; do
    lambda { raise &quot;example message&quot; }.should raise_error(RuntimeError, /ample mess/)
  end
  
  it &quot;should fail if nothing is raised&quot; do
    lambda {
      lambda {}.should raise_error(RuntimeError, /ample mess/)
    }.should fail_with(&quot;expected RuntimeError with message matching /ample mess/ but nothing was raised&quot;)
  end
  
  it &quot;should fail if incorrect error is raised&quot; do
    lambda {
      lambda { raise }.should raise_error(NameError, /ample mess/)
    }.should fail_with(&quot;expected NameError with message matching /ample mess/, got RuntimeError&quot;)
  end
  
  it &quot;should fail if correct error is raised with incorrect message&quot; do
    lambda {
      lambda { raise RuntimeError.new(&quot;not the example message&quot;) }.should raise_error(RuntimeError, /less than ample mess/)
    }.should fail_with(&quot;expected RuntimeError with message matching /less than ample mess/, got #&lt;RuntimeError: not the example message&gt;&quot;)
  end
end

describe &quot;should_not raise_error(NamedError, error_message) with Regexp&quot; do
  it &quot;should pass if nothing is raised&quot; do
    lambda {}.should_not raise_error(RuntimeError, /ample mess/)
  end
  
  it &quot;should pass if a different error is raised&quot; do
    lambda { raise }.should_not raise_error(NameError, /ample mess/)
  end
  
  it &quot;should pass if same error is raised with non-matching message&quot; do
    lambda { raise RuntimeError.new(&quot;non matching message&quot;) }.should_not raise_error(RuntimeError, /ample mess/)
  end
  
  it &quot;should fail if named error is raised with matching message&quot; do
    lambda {
      lambda { raise &quot;example message&quot; }.should_not raise_error(RuntimeError, /ample mess/)
    }.should fail_with(&quot;expected no RuntimeError with message matching /ample mess/, got #&lt;RuntimeError: example message&gt;&quot;)
  end
end
</pre>
    </div>