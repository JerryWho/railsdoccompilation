  <div id="fileHeader">
    <h1>wrap_expectation.rb</h1>
    <table class="header-table">
    <tr class="top-aligned-row">
      <td><strong>Path:</strong></td>
      <td>lib/spec/matchers/wrap_expectation.rb</td>
    </tr>
    <tr class="top-aligned-row">
      <td><strong>Last Update:</strong></td>
      <td>Sat Mar 28 20:06:25 +0100 2009</td>
    </tr>
    </table>
  </div>
 <!-- banner header -->

  <div id="bodyContent" >
    <h2>Source Code</h2>
    <pre>module Spec
  module Matchers
    # wraps an expectation in a block that will return true if the
    # expectation passes and false if it fails (without bubbling up
    # the failure).
    #     
    # This is intended to be used in the context of a simple matcher,
    # and is especially useful for wrapping multiple expectations or
    # one or more assertions from test/unit extensions when running
    # with test/unit.
    #
    # == Examples
    #
    #   def eat_cheese(cheese)
    #     simple_matcher do |mouse, matcher|
    #       matcher.failure_message = &quot;expected #{mouse} to eat cheese&quot;
    #       wrap_expectation do |matcher|
    #         assert_eats_cheese(mouse)
    #       end
    #     end
    #   end
    #
    #   describe Mouse do
    #     it &quot;eats cheese&quot; do
    #       Mouse.new.should eat_cheese
    #     end
    #   end
    #
    # You might be wondering &quot;why would I do this if I could just say&quot;
    # assert_eats_cheese?&quot;, a fair question, indeed. You might prefer
    # to replace the word assert with something more aligned with the
    # rest of your code examples. You are using rspec, after all.
    #
    # The other benefit you get is that you can use the negative version
    # of the matcher:
    #
    #   describe Cat do
    #     it &quot;does not eat cheese&quot; do
    #       Cat.new.should_not eat_cheese
    #     end
    #   end
    #
    # So in the event there is no assert_does_not_eat_cheese available,
    # you're all set!
    def wrap_expectation(matcher, &amp;block)
      begin
        block.call(matcher)
        return true
      rescue Exception =&gt; e
        matcher.failure_message = e.message
        return false
      end
    end
  end
end
</pre>
    </div>