  <div id="C00000129">
<div class='banner'>
  <span class="file-title-prefix">Class</span><br />SpecTask<br/>
  In:
<a href="#" onclick="jsHref('files/lib/spec/rake/spectask_rb.html');">lib/spec/rake/spectask.rb</a>

Parent:&nbsp;
::Rake::TaskLib
</div>
 <!-- banner header -->

  <div id="bodyContent" >
      <div id="content">

  <div class="description"><p>
A <a href="index.html?a=C00000128&name=Rake">Rake</a> task that runs a set
of specs.
</p>
<p>
<a href="index.html?a=C00000062&name=Example">Example</a>:
</p>
<pre>
  Spec::Rake::SpecTask.new do |t|
    t.warning = true
    t.rcov = true
  end
</pre>
<p>
This will create a task that can be run with:
</p>
<pre>
  rake spec
</pre>
<p>
If rake is invoked with a &quot;SPEC=filename&quot; command line option,
then the list of spec files will be overridden to include only the filename
specified on the command line. This provides an easy way to run just one
spec.
</p>
<p>
If rake is invoked with a &quot;SPEC_OPTS=options&quot; command line
option, then the given options will override the value of the
<tt>spec_opts</tt> attribute.
</p>
<p>
If rake is invoked with a &quot;RCOV_OPTS=options&quot; command line
option, then the given options will override the value of the
<tt>rcov_opts</tt> attribute.
</p>
<p>
Examples:
</p>
<pre>
  rake spec                                      # run specs normally
  rake spec SPEC=just_one_file.rb                # run just one spec file.
  rake spec SPEC_OPTS=&quot;--diff&quot;                   # enable diffing
  rake spec RCOV_OPTS=&quot;--aggregate myfile.txt&quot;   # see rcov --help for details
</pre>
<p>
Each attribute of this task may be a proc. This allows for lazy evaluation,
which is sometimes handy if you want to defer the evaluation of an
attribute value until the task is run (as opposed to when it is defined).
</p>
<p>
This task can also be used to run existing <a
href="index.html?a=C00000127&name=Test::Unit">Test::Unit</a> tests and get
RSpec output, for example like this:
</p>
<pre>
  require 'spec/rake/spectask'
  Spec::Rake::SpecTask.new do |t|
    t.ruby_opts = ['-rtest/unit']
    t.spec_files = FileList['test/**/*_test.rb']
  end
</pre>
</div>



  <div class="sectiontitle">Methods</div>
  <ul>
  <li><a href="index.html?a=M000505&name=attr_accessor" >attr_accessor</a></li>
  <li><a href="index.html?a=M000506&name=new" >new</a></li>
  </ul>





  <div class="sectiontitle">Attributes</div>
  <table border='0' cellpadding='5'>
  <tr valign='top'>
    <td class='attr-rw'>
[RW]
    </td>
    <td class='attr-name'>fail_on_error</td>
    <td class='attr-desc'>
Whether or not to fail <a href="index.html?a=C00000128&name=Rake">Rake</a>
when an error occurs (typically when specs fail). Defaults to true.

</td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[RW]
    </td>
    <td class='attr-name'>failure_message</td>
    <td class='attr-desc'>
A message to print to stderr when there are failures.

</td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[RW]
    </td>
    <td class='attr-name'>libs</td>
    <td class='attr-desc'>
Array of directories to be added to $LOAD_PATH before running the specs.
Defaults to [&#8217;&lt;the absolute path to RSpec&#8217;s lib
directory&gt;&#8217;]

</td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[RW]
    </td>
    <td class='attr-name'>name</td>
    <td class='attr-desc'>
Name of spec task. (default is :spec)

</td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[RW]
    </td>
    <td class='attr-name'>out</td>
    <td class='attr-desc'>
Where RSpec&#8217;s output is written. Defaults to $stdout. DEPRECATED. Use
&#8212;format FORMAT:WHERE in spec_opts.

</td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[RW]
    </td>
    <td class='attr-name'>pattern</td>
    <td class='attr-desc'>
Glob pattern to match spec files. (default is
&#8216;spec/**/*_spec.rb&#8217;) Setting the SPEC environment variable
overrides this.

</td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[RW]
    </td>
    <td class='attr-name'>rcov</td>
    <td class='attr-desc'>
Whether or not to use <a href="index.html?a=C00000005&name=RCov">RCov</a>
(default is false) See <a href="http://eigenclass.org/hiki.rb?rcov"
target="_blank">http://eigenclass.org/hiki.rb?rcov</a>

</td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[RW]
    </td>
    <td class='attr-name'>rcov_dir</td>
    <td class='attr-desc'>
Directory where the <a href="index.html?a=C00000005&name=RCov">RCov</a>
report is written. Defaults to &quot;coverage&quot; Ignored if rcov=false

</td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[RW]
    </td>
    <td class='attr-name'>rcov_opts</td>
    <td class='attr-desc'>
Array of commandline options to pass to <a
href="index.html?a=C00000005&name=RCov">RCov</a>. Defaults to
[&#8217;&#8212;exclude&#8217;, &#8216;lib\/spec,bin\/spec&#8217;]. Ignored
if rcov=false Setting the RCOV_OPTS environment variable overrides this.

</td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[RW]
    </td>
    <td class='attr-name'>ruby_cmd</td>
    <td class='attr-desc'>
Explicitly define the path to the ruby binary, or its proxy (e.g.
multiruby)

</td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[RW]
    </td>
    <td class='attr-name'>ruby_opts</td>
    <td class='attr-desc'>
Array of commandline options to pass to ruby. Defaults to [].

</td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[RW]
    </td>
    <td class='attr-name'>spec_files</td>
    <td class='attr-desc'>
Explicitly define the list of spec files to be included in a spec.
<tt>spec_files</tt> is expected to be an array of file names (a FileList is
acceptable). If both <tt>pattern</tt> and <tt>spec_files</tt> are used,
then the list of spec files is the union of the two. Setting the SPEC
environment variable overrides this.

</td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[RW]
    </td>
    <td class='attr-name'>spec_opts</td>
    <td class='attr-desc'>
Array of commandline options to pass to RSpec. Defaults to []. Setting the
SPEC_OPTS environment variable overrides this.

</td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[RW]
    </td>
    <td class='attr-name'>verbose</td>
    <td class='attr-desc'>
Use verbose output. If this is set to true, the task will print the
executed spec command to stdout. Defaults to false.

</td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[RW]
    </td>
    <td class='attr-name'>warning</td>
    <td class='attr-desc'>
If true, requests that the specs be run with the warning flag set. E.g.
warning=true implies &quot;ruby -w&quot; used to run the specs. Defaults to
false.

</td>
  </tr>
  </table>

<div class="sectiontitle">Public Class methods</div>
<div id="M000505" class="method">
  <div id="M000505_title" class="title">
    <b>attr_accessor</b>(*names)
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000505_source')" id="l_M000505_source">show source</a> ]</p>
  <div id="M000505_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File lib/spec/rake/spectask.rb, line 58</span>
58:       <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">attr_accessor</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">names</span>)
59:         <span class="ruby-keyword kw">super</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">names</span>)
60:         <span class="ruby-identifier">names</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">name</span><span class="ruby-operator">|</span>
61:           <span class="ruby-identifier">module_eval</span> <span class="ruby-node">&quot;def #{name}() evaluate(@#{name}) end&quot;</span> <span class="ruby-comment cmt"># Allows use of procs</span>
62:         <span class="ruby-keyword kw">end</span>
63:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div id="M000506" class="method">
  <div id="M000506_title" class="title">
    <b>new</b>(name=:spec) {|self if block_given?| ...}
  </div>
  <div class="description">
  <p>
Defines a new task, using the name <tt>name</tt>.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000506_source')" id="l_M000506_source">show source</a> ]</p>
  <div id="M000506_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File lib/spec/rake/spectask.rb, line 126</span>
126:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">name</span>=<span class="ruby-identifier">:spec</span>)
127:         <span class="ruby-ivar">@name</span> = <span class="ruby-identifier">name</span>
128:         <span class="ruby-ivar">@libs</span> = [<span class="ruby-value str">'lib'</span>]
129:         <span class="ruby-ivar">@pattern</span> = <span class="ruby-keyword kw">nil</span>
130:         <span class="ruby-ivar">@spec_files</span> = <span class="ruby-keyword kw">nil</span>
131:         <span class="ruby-ivar">@spec_opts</span> = []
132:         <span class="ruby-ivar">@warning</span> = <span class="ruby-keyword kw">false</span>
133:         <span class="ruby-ivar">@ruby_opts</span> = []
134:         <span class="ruby-ivar">@fail_on_error</span> = <span class="ruby-keyword kw">true</span>
135:         <span class="ruby-ivar">@rcov</span> = <span class="ruby-keyword kw">false</span>
136:         <span class="ruby-ivar">@rcov_opts</span> = [<span class="ruby-value str">'--exclude'</span>, <span class="ruby-value str">'lib\/spec,bin\/spec,config\/boot.rb'</span>]
137:         <span class="ruby-ivar">@rcov_dir</span> = <span class="ruby-value str">&quot;coverage&quot;</span>
138: 
139:         <span class="ruby-keyword kw">yield</span> <span class="ruby-keyword kw">self</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block_given?</span>
140:         <span class="ruby-ivar">@pattern</span> = <span class="ruby-value str">'spec/**/*_spec.rb'</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">pattern</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">spec_files</span>.<span class="ruby-identifier">nil?</span>
141:         <span class="ruby-identifier">define</span>
142:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
</div>

  </div>